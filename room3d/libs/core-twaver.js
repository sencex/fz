!function(a,b){function c(a,b,c){null!=a&&("number"==typeof a?this.fromNumber(a,b,c):null==b&&"string"!=typeof a?this.fromString(a,256):this.fromString(a,b))}function d(){return new c(null)}function e(a,b,c,d,e,f){for(;--f>=0;){var g=b*this[a++]+c[d]+e;e=Math.floor(g/67108864),c[d++]=67108863&g}return e}function f(a,b,c,d,e,f){for(var g=32767&b,h=b>>15;--f>=0;){var i=32767&this[a],j=this[a++]>>15,k=h*i+j*g;i=g*i+((32767&k)<<15)+c[d]+(1073741823&e),e=(i>>>30)+(k>>>15)+h*j+(e>>>30),c[d++]=1073741823&i}return e}function g(a,b,c,d,e,f){for(var g=16383&b,h=b>>14;--f>=0;){var i=16383&this[a],j=this[a++]>>14,k=h*i+j*g;i=g*i+((16383&k)<<14)+c[d]+e,e=(i>>28)+(k>>14)+h*j,c[d++]=268435455&i}return e}function h(a){return dc.charAt(a)}function j(a,b){var c=ec[a.charCodeAt(b)];return null==c?-1:c}function k(a){for(var b=this.t-1;b>=0;--b)a[b]=this[b];a.t=this.t,a.s=this.s}function l(a){this.t=1,this.s=0>a?-1:0,a>0?this[0]=a:-1>a?this[0]=a+DV:this.t=0}function m(a){var b=d();return b.fromInt(a),b}function n(a,b){var d;if(16==b)d=4;else if(8==b)d=3;else if(256==b)d=8;else if(2==b)d=1;else if(32==b)d=5;else{if(4!=b)return void this.fromRadix(a,b);d=2}this.t=0,this.s=0;for(var e=a.length,f=!1,g=0;--e>=0;){var h=8==d?255&a[e]:j(a,e);0>h?"-"==a.charAt(e)&&(f=!0):(f=!1,0==g?this[this.t++]=h:g+d>this.DB?(this[this.t-1]|=(h&(1<<this.DB-g)-1)<<g,this[this.t++]=h>>this.DB-g):this[this.t-1]|=h<<g,g+=d,g>=this.DB&&(g-=this.DB))}8==d&&0!=(128&a[0])&&(this.s=-1,g>0&&(this[this.t-1]|=(1<<this.DB-g)-1<<g)),this.clamp(),f&&c.ZERO.subTo(this,this)}function o(){for(var a=this.s&this.DM;this.t>0&&this[this.t-1]==a;)--this.t}function p(a){if(this.s<0)return"-"+this.negate().toString(a);var b;if(16==a)b=4;else if(8==a)b=3;else if(2==a)b=1;else if(32==a)b=5;else{if(4!=a)return this.toRadix(a);b=2}var c,d=(1<<b)-1,e=!1,f="",g=this.t,i=this.DB-g*this.DB%b;if(g-->0)for(i<this.DB&&(c=this[g]>>i)>0&&(e=!0,f=h(c));g>=0;)b>i?(c=(this[g]&(1<<i)-1)<<b-i,c|=this[--g]>>(i+=this.DB-b)):(c=this[g]>>(i-=b)&d,0>=i&&(i+=this.DB,--g)),c>0&&(e=!0),e&&(f+=h(c));return e?f:"0"}function q(){var a=d();return c.ZERO.subTo(this,a),a}function r(){return this.s<0?this.negate():this}function s(a){var b=this.s-a.s;if(0!=b)return b;var c=this.t;if(b=c-a.t,0!=b)return b;for(;--c>=0;)if(0!=(b=this[c]-a[c]))return b;return 0}function t(a){var b,c=1;return 0!=(b=a>>>16)&&(a=b,c+=16),0!=(b=a>>8)&&(a=b,c+=8),0!=(b=a>>4)&&(a=b,c+=4),0!=(b=a>>2)&&(a=b,c+=2),0!=(b=a>>1)&&(a=b,c+=1),c}function u(){return this.t<=0?0:this.DB*(this.t-1)+t(this[this.t-1]^this.s&this.DM)}function v(a,b){var c;for(c=this.t-1;c>=0;--c)b[c+a]=this[c];for(c=a-1;c>=0;--c)b[c]=0;b.t=this.t+a,b.s=this.s}function w(a,b){for(var c=a;c<this.t;++c)b[c-a]=this[c];b.t=Math.max(this.t-a,0),b.s=this.s}function x(a,b){var c,d=a%this.DB,e=this.DB-d,f=(1<<e)-1,g=Math.floor(a/this.DB),h=this.s<<d&this.DM;for(c=this.t-1;c>=0;--c)b[c+g+1]=this[c]>>e|h,h=(this[c]&f)<<d;for(c=g-1;c>=0;--c)b[c]=0;b[g]=h,b.t=this.t+g+1,b.s=this.s,b.clamp()}function y(a,b){b.s=this.s;var c=Math.floor(a/this.DB);if(c>=this.t)return void(b.t=0);var d=a%this.DB,e=this.DB-d,f=(1<<d)-1;b[0]=this[c]>>d;for(var g=c+1;g<this.t;++g)b[g-c-1]|=(this[g]&f)<<e,b[g-c]=this[g]>>d;d>0&&(b[this.t-c-1]|=(this.s&f)<<e),b.t=this.t-c,b.clamp()}function z(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);e>c;)d+=this[c]-a[c],b[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d-=a.s;c<this.t;)d+=this[c],b[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d-=a[c],b[c++]=d&this.DM,d>>=this.DB;d-=a.s}b.s=0>d?-1:0,-1>d?b[c++]=this.DV+d:d>0&&(b[c++]=d),b.t=c,b.clamp()}function A(a,b){var d=this.abs(),e=a.abs(),f=d.t;for(b.t=f+e.t;--f>=0;)b[f]=0;for(f=0;f<e.t;++f)b[f+d.t]=d.am(0,e[f],b,f,0,d.t);b.s=0,b.clamp(),this.s!=a.s&&c.ZERO.subTo(b,b)}function B(a){for(var b=this.abs(),c=a.t=2*b.t;--c>=0;)a[c]=0;for(c=0;c<b.t-1;++c){var d=b.am(c,b[c],a,2*c,0,1);(a[c+b.t]+=b.am(c+1,2*b[c],a,2*c+1,d,b.t-c-1))>=b.DV&&(a[c+b.t]-=b.DV,a[c+b.t+1]=1)}a.t>0&&(a[a.t-1]+=b.am(c,b[c],a,2*c,0,1)),a.s=0,a.clamp()}function C(a,b,e){var f=a.abs();if(!(f.t<=0)){var g=this.abs();if(g.t<f.t)return null!=b&&b.fromInt(0),void(null!=e&&this.copyTo(e));null==e&&(e=d());var h=d(),i=this.s,j=a.s,k=this.DB-t(f[f.t-1]);k>0?(f.lShiftTo(k,h),g.lShiftTo(k,e)):(f.copyTo(h),g.copyTo(e));var l=h.t,m=h[l-1];if(0!=m){var n=m*(1<<this.F1)+(l>1?h[l-2]>>this.F2:0),o=this.FV/n,p=(1<<this.F1)/n,q=1<<this.F2,r=e.t,s=r-l,u=null==b?d():b;for(h.dlShiftTo(s,u),e.compareTo(u)>=0&&(e[e.t++]=1,e.subTo(u,e)),c.ONE.dlShiftTo(l,u),u.subTo(h,h);h.t<l;)h[h.t++]=0;for(;--s>=0;){var v=e[--r]==m?this.DM:Math.floor(e[r]*o+(e[r-1]+q)*p);if((e[r]+=h.am(0,v,e,s,0,l))<v)for(h.dlShiftTo(s,u),e.subTo(u,e);e[r]<--v;)e.subTo(u,e)}null!=b&&(e.drShiftTo(l,b),i!=j&&c.ZERO.subTo(b,b)),e.t=l,e.clamp(),k>0&&e.rShiftTo(k,e),0>i&&c.ZERO.subTo(e,e)}}}function D(a){var b=d();return this.abs().divRemTo(a,null,b),this.s<0&&b.compareTo(c.ZERO)>0&&a.subTo(b,b),b}function E(a){this.m=a}function F(a){return a.s<0||a.compareTo(this.m)>=0?a.mod(this.m):a}function G(a){return a}function H(a){a.divRemTo(this.m,null,a)}function I(a,b,c){a.multiplyTo(b,c),this.reduce(c)}function J(a,b){a.squareTo(b),this.reduce(b)}function K(){if(this.t<1)return 0;var a=this[0];if(0==(1&a))return 0;var b=3&a;return b=b*(2-(15&a)*b)&15,b=b*(2-(255&a)*b)&255,b=b*(2-((65535&a)*b&65535))&65535,b=b*(2-a*b%this.DV)%this.DV,b>0?this.DV-b:-b}function L(a){this.m=a,this.mp=a.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<a.DB-15)-1,this.mt2=2*a.t}function M(a){var b=d();return a.abs().dlShiftTo(this.m.t,b),b.divRemTo(this.m,null,b),a.s<0&&b.compareTo(c.ZERO)>0&&this.m.subTo(b,b),b}function N(a){var b=d();return a.copyTo(b),this.reduce(b),b}function O(a){for(;a.t<=this.mt2;)a[a.t++]=0;for(var b=0;b<this.m.t;++b){var c=32767&a[b],d=c*this.mpl+((c*this.mph+(a[b]>>15)*this.mpl&this.um)<<15)&a.DM;for(c=b+this.m.t,a[c]+=this.m.am(0,d,a,b,0,this.m.t);a[c]>=a.DV;)a[c]-=a.DV,a[++c]++}a.clamp(),a.drShiftTo(this.m.t,a),a.compareTo(this.m)>=0&&a.subTo(this.m,a)}function P(a,b){a.squareTo(b),this.reduce(b)}function Q(a,b,c){a.multiplyTo(b,c),this.reduce(c)}function R(){return 0==(this.t>0?1&this[0]:this.s)}function S(a,b){if(a>4294967295||1>a)return c.ONE;var e=d(),f=d(),g=b.convert(this),h=t(a)-1;for(g.copyTo(e);--h>=0;)if(b.sqrTo(e,f),(a&1<<h)>0)b.mulTo(f,g,e);else{var i=e;e=f,f=i}return b.revert(e)}function T(a,b){var c;return c=256>a||b.isEven()?new E(b):new L(b),this.exp(a,c)}function U(){var a=d();return this.copyTo(a),a}function V(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function W(){return 0==this.t?this.s:this[0]<<24>>24}function X(){return 0==this.t?this.s:this[0]<<16>>16}function Y(a){return Math.floor(Math.LN2*this.DB/Math.log(a))}function Z(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1}function $(a){if(null==a&&(a=10),0==this.signum()||2>a||a>36)return"0";var b=this.chunkSize(a),c=Math.pow(a,b),e=m(c),f=d(),g=d(),h="";for(this.divRemTo(e,f,g);f.signum()>0;)h=(c+g.intValue()).toString(a).substr(1)+h,f.divRemTo(e,f,g);return g.intValue().toString(a)+h}function _(a,b){this.fromInt(0),null==b&&(b=10);for(var d=this.chunkSize(b),e=Math.pow(b,d),f=!1,g=0,h=0,i=0;i<a.length;++i){var k=j(a,i);0>k?"-"==a.charAt(i)&&0==this.signum()&&(f=!0):(h=b*h+k,++g>=d&&(this.dMultiply(e),this.dAddOffset(h,0),g=0,h=0))}g>0&&(this.dMultiply(Math.pow(b,g)),this.dAddOffset(h,0)),f&&c.ZERO.subTo(this,this)}function aa(a,b,d){if("number"==typeof b)if(2>a)this.fromInt(1);else for(this.fromNumber(a,d),this.testBit(a-1)||this.bitwiseTo(c.ONE.shiftLeft(a-1),ia,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(b);)this.dAddOffset(2,0),this.bitLength()>a&&this.subTo(c.ONE.shiftLeft(a-1),this);else{var e=new Array,f=7&a;e.length=(a>>3)+1,b.nextBytes(e),f>0?e[0]&=(1<<f)-1:e[0]=0,this.fromString(e,256)}}function ba(){var a=this.t,b=new Array;b[0]=this.s;var c,d=this.DB-a*this.DB%8,e=0;if(a-->0)for(d<this.DB&&(c=this[a]>>d)!=(this.s&this.DM)>>d&&(b[e++]=c|this.s<<this.DB-d);a>=0;)8>d?(c=(this[a]&(1<<d)-1)<<8-d,c|=this[--a]>>(d+=this.DB-8)):(c=this[a]>>(d-=8)&255,0>=d&&(d+=this.DB,--a)),0!=(128&c)&&(c|=-256),0==e&&(128&this.s)!=(128&c)&&++e,(e>0||c!=this.s)&&(b[e++]=c);return b}function ca(a){return 0==this.compareTo(a)}function da(a){return this.compareTo(a)<0?this:a}function ea(a){return this.compareTo(a)>0?this:a}function fa(a,b,c){var d,e,f=Math.min(a.t,this.t);for(d=0;f>d;++d)c[d]=b(this[d],a[d]);if(a.t<this.t){for(e=a.s&this.DM,d=f;d<this.t;++d)c[d]=b(this[d],e);c.t=this.t}else{for(e=this.s&this.DM,d=f;d<a.t;++d)c[d]=b(e,a[d]);c.t=a.t}c.s=b(this.s,a.s),c.clamp()}function ga(a,b){return a&b}function ha(a){var b=d();return this.bitwiseTo(a,ga,b),b}function ia(a,b){return a|b}function ja(a){var b=d();return this.bitwiseTo(a,ia,b),b}function ka(a,b){return a^b}function la(a){var b=d();return this.bitwiseTo(a,ka,b),b}function ma(a,b){return a&~b}function na(a){var b=d();return this.bitwiseTo(a,ma,b),b}function oa(){for(var a=d(),b=0;b<this.t;++b)a[b]=this.DM&~this[b];return a.t=this.t,a.s=~this.s,a}function pa(a){var b=d();return 0>a?this.rShiftTo(-a,b):this.lShiftTo(a,b),b}function qa(a){var b=d();return 0>a?this.lShiftTo(-a,b):this.rShiftTo(a,b),b}function ra(a){if(0==a)return-1;var b=0;return 0==(65535&a)&&(a>>=16,b+=16),0==(255&a)&&(a>>=8,b+=8),0==(15&a)&&(a>>=4,b+=4),0==(3&a)&&(a>>=2,b+=2),0==(1&a)&&++b,b}function sa(){for(var a=0;a<this.t;++a)if(0!=this[a])return a*this.DB+ra(this[a]);return this.s<0?this.t*this.DB:-1}function ta(a){for(var b=0;0!=a;)a&=a-1,++b;return b}function ua(){for(var a=0,b=this.s&this.DM,c=0;c<this.t;++c)a+=ta(this[c]^b);return a}function va(a){var b=Math.floor(a/this.DB);return b>=this.t?0!=this.s:0!=(this[b]&1<<a%this.DB)}function wa(a,b){var d=c.ONE.shiftLeft(a);return this.bitwiseTo(d,b,d),d}function xa(a){return this.changeBit(a,ia)}function ya(a){return this.changeBit(a,ma)}function za(a){return this.changeBit(a,ka)}function Aa(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);e>c;)d+=this[c]+a[c],b[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d+=a.s;c<this.t;)d+=this[c],b[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d+=a[c],b[c++]=d&this.DM,d>>=this.DB;d+=a.s}b.s=0>d?-1:0,d>0?b[c++]=d:-1>d&&(b[c++]=this.DV+d),b.t=c,b.clamp()}function Ba(a){var b=d();return this.addTo(a,b),b}function Ca(a){var b=d();return this.subTo(a,b),b}function Da(a){var b=d();return this.multiplyTo(a,b),b}function Ea(){var a=d();return this.squareTo(a),a}function Fa(a){var b=d();return this.divRemTo(a,b,null),b}function Ga(a){var b=d();return this.divRemTo(a,null,b),b}function Ha(a){var b=d(),c=d();return this.divRemTo(a,b,c),new Array(b,c)}function Ia(a){this[this.t]=this.am(0,a-1,this,0,0,this.t),++this.t,this.clamp()}function Ja(a,b){if(0!=a){for(;this.t<=b;)this[this.t++]=0;for(this[b]+=a;this[b]>=this.DV;)this[b]-=this.DV,++b>=this.t&&(this[this.t++]=0),++this[b]}}function Ka(){}function La(a){return a}function Ma(a,b,c){a.multiplyTo(b,c)}function Na(a,b){a.squareTo(b)}function Oa(a){return this.exp(a,new Ka)}function Pa(a,b,c){var d=Math.min(this.t+a.t,b);for(c.s=0,c.t=d;d>0;)c[--d]=0;var e;for(e=c.t-this.t;e>d;++d)c[d+this.t]=this.am(0,a[d],c,d,0,this.t);for(e=Math.min(a.t,b);e>d;++d)this.am(0,a[d],c,d,0,b-d);c.clamp()}function Qa(a,b,c){--b;var d=c.t=this.t+a.t-b;for(c.s=0;--d>=0;)c[d]=0;for(d=Math.max(b-this.t,0);d<a.t;++d)c[this.t+d-b]=this.am(b-d,a[d],c,0,0,this.t+d-b);c.clamp(),c.drShiftTo(1,c)}function Ra(a){this.r2=d(),this.q3=d(),c.ONE.dlShiftTo(2*a.t,this.r2),this.mu=this.r2.divide(a),this.m=a}function Sa(a){if(a.s<0||a.t>2*this.m.t)return a.mod(this.m);if(a.compareTo(this.m)<0)return a;var b=d();return a.copyTo(b),this.reduce(b),b}function Ta(a){return a}function Ua(a){for(a.drShiftTo(this.m.t-1,this.r2),a.t>this.m.t+1&&(a.t=this.m.t+1,a.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);a.compareTo(this.r2)<0;)a.dAddOffset(1,this.m.t+1);for(a.subTo(this.r2,a);a.compareTo(this.m)>=0;)a.subTo(this.m,a)}function Va(a,b){a.squareTo(b),this.reduce(b)}function Wa(a,b,c){a.multiplyTo(b,c),this.reduce(c)}function Xa(a,b){var c,e,f=a.bitLength(),g=m(1);if(0>=f)return g;c=18>f?1:48>f?3:144>f?4:768>f?5:6,e=8>f?new E(b):b.isEven()?new Ra(b):new L(b);var h=new Array,i=3,j=c-1,k=(1<<c)-1;if(h[1]=e.convert(this),c>1){var l=d();for(e.sqrTo(h[1],l);k>=i;)h[i]=d(),e.mulTo(l,h[i-2],h[i]),i+=2}var n,o,p=a.t-1,q=!0,r=d();for(f=t(a[p])-1;p>=0;){for(f>=j?n=a[p]>>f-j&k:(n=(a[p]&(1<<f+1)-1)<<j-f,p>0&&(n|=a[p-1]>>this.DB+f-j)),i=c;0==(1&n);)n>>=1,--i;if((f-=i)<0&&(f+=this.DB,--p),q)h[n].copyTo(g),q=!1;else{for(;i>1;)e.sqrTo(g,r),e.sqrTo(r,g),i-=2;i>0?e.sqrTo(g,r):(o=g,g=r,r=o),e.mulTo(r,h[n],g)}for(;p>=0&&0==(a[p]&1<<f);)e.sqrTo(g,r),o=g,g=r,r=o,--f<0&&(f=this.DB-1,--p)}return e.revert(g)}function Ya(a){var b=this.s<0?this.negate():this.clone(),c=a.s<0?a.negate():a.clone();if(b.compareTo(c)<0){var d=b;b=c,c=d}var e=b.getLowestSetBit(),f=c.getLowestSetBit();if(0>f)return b;for(f>e&&(f=e),f>0&&(b.rShiftTo(f,b),c.rShiftTo(f,c));b.signum()>0;)(e=b.getLowestSetBit())>0&&b.rShiftTo(e,b),(e=c.getLowestSetBit())>0&&c.rShiftTo(e,c),b.compareTo(c)>=0?(b.subTo(c,b),b.rShiftTo(1,b)):(c.subTo(b,c),c.rShiftTo(1,c));return f>0&&c.lShiftTo(f,c),c}function Za(a){if(0>=a)return 0;var b=this.DV%a,c=this.s<0?a-1:0;if(this.t>0)if(0==b)c=this[0]%a;else for(var d=this.t-1;d>=0;--d)c=(b*c+this[d])%a;return c}function $a(a){var b=a.isEven();if(this.isEven()&&b||0==a.signum())return c.ZERO;for(var d=a.clone(),e=this.clone(),f=m(1),g=m(0),h=m(0),i=m(1);0!=d.signum();){for(;d.isEven();)d.rShiftTo(1,d),b?(f.isEven()&&g.isEven()||(f.addTo(this,f),g.subTo(a,g)),f.rShiftTo(1,f)):g.isEven()||g.subTo(a,g),g.rShiftTo(1,g);for(;e.isEven();)e.rShiftTo(1,e),b?(h.isEven()&&i.isEven()||(h.addTo(this,h),i.subTo(a,i)),h.rShiftTo(1,h)):i.isEven()||i.subTo(a,i),i.rShiftTo(1,i);d.compareTo(e)>=0?(d.subTo(e,d),b&&f.subTo(h,f),g.subTo(i,g)):(e.subTo(d,e),b&&h.subTo(f,h),i.subTo(g,i))}return 0!=e.compareTo(c.ONE)?c.ZERO:i.compareTo(a)>=0?i.subtract(a):i.signum()<0?(i.addTo(a,i),i.signum()<0?i.add(a):i):i}function _a(a){var b,c=this.abs();if(1==c.t&&c[0]<=fc[fc.length-1]){for(b=0;b<fc.length;++b)if(c[0]==fc[b])return!0;return!1}if(c.isEven())return!1;for(b=1;b<fc.length;){for(var d=fc[b],e=b+1;e<fc.length&&gc>d;)d*=fc[e++];for(d=c.modInt(d);e>b;)if(d%fc[b++]==0)return!1}return c.millerRabin(a)}function ab(a){var b=this.subtract(c.ONE),e=b.getLowestSetBit();if(0>=e)return!1;var f=b.shiftRight(e);a=a+1>>1,a>fc.length&&(a=fc.length);for(var g=d(),h=0;a>h;++h){g.fromInt(fc[Math.floor(Ib.Util.random()*fc.length)]);var i=g.modPow(f,this);if(0!=i.compareTo(c.ONE)&&0!=i.compareTo(b)){for(var j=1;j++<e&&0!=i.compareTo(b);)if(i=i.modPowInt(2,this),0==i.compareTo(c.ONE))return!1;if(0!=i.compareTo(b))return!1}}return!0}function bb(){this.i=0,this.j=0,this.S=new Array}function cb(a){var b,c,d;for(b=0;256>b;++b)this.S[b]=b;for(c=0,b=0;256>b;++b)c=c+this.S[b]+a[b%a.length]&255,d=this.S[b],this.S[b]=this.S[c],this.S[c]=d;this.i=0,this.j=0}function db(){var a;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,a=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=a,this.S[a+this.S[this.i]&255]}function eb(){return new bb}function fb(a){ic[jc++]^=255&a,ic[jc++]^=a>>8&255,ic[jc++]^=a>>16&255,ic[jc++]^=a>>24&255,jc>=kc&&(jc-=kc)}function gb(){fb((new Date).getTime())}function hb(){if(null==hc){for(gb(),hc=eb(),hc.init(ic),jc=0;jc<ic.length;++jc)ic[jc]=0;jc=0}return hc.next()}function ib(a){var b;for(b=0;b<a.length;++b)a[b]=hb()}function jb(){}function kb(a,b){return new c(a,b)}function lb(a,b){if(b<a.length+11)return null;for(var d=new Array,e=a.length-1;e>=0&&b>0;){var f=a.charCodeAt(e--);128>f?d[--b]=f:f>127&&2048>f?(d[--b]=63&f|128,d[--b]=f>>6|192):(d[--b]=63&f|128,d[--b]=f>>6&63|128,d[--b]=f>>12|224)}d[--b]=0;for(var g=new jb,h=new Array;b>2;){for(h[0]=0;0==h[0];)g.nextBytes(h);d[--b]=h[0]}return d[--b]=2,d[--b]=0,new c(d)}function mb(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function nb(a,b){this.n=kb(a,16),this.e=parseInt(b,16)}function ob(a){return a.modPowInt(this.e,this.n)}function pb(a){var b=lb(a,this.n.bitLength()+7>>3);if(null==b)return null;var c=this.doPrivate(b);if(null==c)return null;var d=c.toString(16);return 0==(1&d.length)?d:"0"+d}function qb(a,b){for(var c=a.toByteArray(),d=0;d<c.length&&0==c[d];)++d;if(c.length-d!=b-1||2!=c[d])return null;for(++d;0!=c[d];)if(++d>=c.length)return null;for(var e="";++d<c.length;){var f=255&c[d];128>f?e+=String.fromCharCode(f):f>191&&224>f?(e+=String.fromCharCode((31&f)<<6|63&c[d+1]),++d):(e+=String.fromCharCode((15&f)<<12|(63&c[d+1])<<6|63&c[d+2]),d+=2)}return e}function rb(a,b,c){this.n=kb(a,16),this.e=parseInt(b,16),this.d=kb(c,16)}function sb(a,b,c,d,e,f,g,h){this.n=kb(a,16),this.e=parseInt(b,16),this.d=kb(c,16),this.p=kb(d,16),this.q=kb(e,16),this.dmp1=kb(f,16),this.dmq1=kb(g,16),this.coeff=kb(h,16)}function tb(a){if(null==this.p||null==this.q)return a.modPow(this.d,this.n);for(var b=a.mod(this.p).modPow(this.dmp1,this.p),c=a.mod(this.q).modPow(this.dmq1,this.q);b.compareTo(c)<0;)b=b.add(this.p);return b.subtract(c).multiply(this.coeff).mod(this.p).multiply(this.q).add(c)}function ub(a){var b=kb(a,16),c=this.doPublic(b);return null==c?null:qb(c,this.n.bitLength()+7>>3)}function vb(a,b,c){var d=0,e=0,f=b.split("\n"),g=2*a.measureText("e").width;return f.forEach(function(b){if(c){var f,h,i,j,k,l=b.split(" "),m=l.length,n="";for(i=0;m>i;i++)if(f=l[i]+(i===m-1?"":" "),h=n+f,j=a.measureText(h).width,c>j)n=h;else if(j==c)n="",e+=g;else{for(k=0;k<f.length;k++)if(h=n+f.substr(0,k+1),a.measureText(h).width>c){n=f.substring(k,f.length),e+=g;break}for(;n.length>0&&a.measureText(n).width>c;)for(k=0;k<n.length;k++)if(h=n.substr(0,k+1),a.measureText(h).width>c){n=n.substring(k,n.length),e+=g;break}}}else j=a.measureText(b).width,d=j>d?j:d;e+=g}),d=c?c:d,{w:d,h:e}}function wb(a,b,c,d){var e,f=a.animate,g=d._now,h=d._shapeDataIndex,i=c._animates;if(i||(i=c._animates={}),h.length)for(var j=0;j<h.length;j++){e=h[j];var k=i[e];k||(k=i[e]={}),i=k}else e=h;var l=i[e];l||(l=i[e]={},f.forEach(function(e){var f,h=e.attr,i=l[h];e={attr:h,to:e.to,type:e.type||"number",delay:e.delay||0,dur:e.dur||1e3,interval:e.interval||0,finish:e.finish,repeat:e.repeat||1,reverse:null==e.reverse?!0:e.reverse,onDone:e.onDone,easing:e.easing,trigger:null==e.to,start:g,time:0,total:0,count:0,started:!1,stopped:!1,current:null},Array.isArray(e.dur)&&(e.groupDur=e.dur.slice(0,e.dur.length-1),e.dur=e.dur[e.dur.length-1],e.groupDurTotal=e.groupDur.reduce(function(a,b,c){return e.groupDur[c]=a+b},0),e.groupIndex=0,e.groupTime=0,e.groupStart=g),null==e.finish&&(e.finish=e.delay+e.dur+e.interval),i?Array.isArray(i)?(i.push(e),i=i[i.length-2]):l[h]=[i,e]:(f=Yc(c,b,a,h,d),l[h]=e),i&&(f=i.to,"group_set"===i.type&&(f=f[f.length-1])),e.from=f,e.trigger||(e.started=!0,Fb(e),Gb(e))})),f=l,Object.keys(f).forEach(function(e){var h=f[e];if(Array.isArray(h)){var i=h[h.length-1];i.count+1===i.repeat?h.forEach(function(e){xb(e,a,b,c,d,!0)}):i.count+1<i.repeat&&(i.total>=i.finish&&h.forEach(function(a){a.trigger||(a.started=!0),a.stopped=!1,a.time=0,a.start=g,a.total=0,"group_set"===a.type&&(a.groupIndex=0,a.groupTime=0,a.groupStart=g)}),h.forEach(function(e){xb(e,a,b,c,d,!1)}))}else xb(h,a,b,c,d,!0)})}function xb(a,b,c,d,e,f){if(a.trigger){var g=Yc(d,c,b,a.attr,e,null,!1);if(!a.started){if(g===a.from)return;a.started=!0,a.start=e._now,a.to=g,Fb(a),Gb(a)}a.started&&g!==a.to&&(a.start=e._now,a.from=a.current,a.to=g,a.time=0,a.total=0,a.count=0,Fb(a),Gb(a))}if(a.started&&!a.stopped){var h=e._now,i=h-a.start;if(i>=a.delay&&(a.total=i,i-=a.delay,a.time=i>a.dur?a.dur:i,"group_set"===a.type&&(a.groupTime=h-a.groupStart,a.groupStart===a.start&&(a.groupTime-=a.delay),a.groupTime>=a.groupDur[a.groupIndex]&&a.groupIndex++,a.groupTime>=a.groupDurTotal&&(a.groupIndex=0,a.groupTime=a.groupTime-a.groupDurTotal,a.groupStart=h)),a.total>=a.finish))if(a.count++,"group_set"===a.type,a.count>=a.repeat)a.time=a.dur,a.stopped=!0,a.trigger&&(a.from=a.to,a.to=null,a.start=null,a.time=0,a.total=0,a.count=0,a.started=!1,a.stopped=!1),a.onDone&&a.onDone.call(c,d,e);else if(f&&(a.time=0,a.start=h,a.total=0,a.reverse)){var j=a.from;a.from=a.to,a.to=j,Gb(a)}e&&!e._invalidate&&(e._invalidate=!0)}}function yb(a){if(!hd[a.id]){if(jd=!0,hd[a.id]=a,null==a.from&&a.attr&&a.source){var b;a.from=(b=a.attr.match(/^S[:@](.*)/i))?a.source.getStyle(b[1]):(b=a.attr.match(/^C[:@](.*)/i))?a.source.getClient(b[1]):Ib.Util.getValue(a.source,a.attr)}Fb(a),Gb(a)}return a.resume(),a}function zb(a,b){return hd[a.id]&&(null==b&&(b=!0),b&&Eb(a,a.to),a.onStop&&a.onStop(),a.time=0,a.total=0,a.start=null,a.count=0,a.started=!1,a.stopped=!1,a.paused=!1,a.pausedTime=null,a.pausedTotal=0,a._oldSpeed=null,a._speedTotal=0,a._speedTime=null,a._percent=0,a._percentSet=null,a._percentDiff=0,delete hd[a.id]),a}function Ab(a){null==a&&(a=!0),Object.keys(hd).forEach(function(b){var c=hd[b];c&&(a&&Eb(c,c.to),c.onStop&&c.onStop())}),hd={}}function Bb(){Object.keys(hd).forEach(function(a){var b=hd[a];b&&b.pause()})}function Cb(){Object.keys(hd).forEach(function(a){var b=hd[a];b&&b.resume()})}function Db(a){Object.keys(hd).forEach(function(b){var c=hd[b];if(c&&(null==c.start&&(c._speedTime=c.start=a),null!=c._percentSet&&(c._percentDiff+=(c._percentSet-c._percent)*c.finish),!c.paused||(c.pausedTime||(c.pausedTime=a),null!=c._percentSet))){if(null==c._percentSet&&c.pausedTime&&(c.pausedTotal+=(a-c.pausedTime)*(c._oldSpeed||c._speed),c.pausedTime=null),c._oldSpeed&&!c.pausedTime&&(c._speedTotal=(a-c._speedTime)*c._oldSpeed-c.pausedTotal+c._percentDiff+c._speedTotal,c._percentDiff=0,c.pausedTotal=0,c._speedTime=a,c._oldSpeed=null),c.total=(a-c._speedTime)*c._speed-c.pausedTotal+c._percentDiff+c._speedTotal,null!=c._percentSet&&c.pausedTime&&(c.total-=(a-c.pausedTime)*(c._oldSpeed||c._speed)),c._percent=c.total>=c.finish?1:c.total/c.finish,c.total>c.delay){c.time=c.total-c.delay;var d=!1;if(c.time>=c.dur&&(c.time=c.dur,c.total>=c.finish&&(d=!0)),!c.stopped&&Eb(c,Hb(c)),c.stopped=d,c.total>=c.finish)if(c.count++,c.count>=c.repeat)zb(c,!1),c.onDone&&c.onDone();else if(c.time=0,c.total=0,c.start=null,c.stopped=!1,c.reverse){var e=c.from;c.from=c.to,c.to=e,Gb(c)}}c.paused||!jd&&(jd=!0),null!=c._percentSet&&(c._percentSet=null)}})}function Eb(a,b){if(a.started||(a.started=!0,a.onPlay&&a.onPlay()),a.filter&&(b=a.filter(b)),a.attr&&a.source){var c;(c=a.attr.match(/^S[:@](.*)/i))?a.source.setStyle(c[1],b):(c=a.attr.match(/^C[:@](.*)/i))?a.source.setClient(c[1],b):Ib.Util.setValue(a.source,a.attr,b)}a.onUpdate&&a.onUpdate(b)}function Fb(a){var b=a.type,c=a.from,d=a.to;"number"===b?(a.from=c||0,a.to=d||0):"point"===b?(c?c.length&&(a.from={x:c[0],y:c[1]}):a.from="scale"===a.attr?{x:1,y:1}:{x:0,y:0},d?d.length&&(a.to={x:d[0],y:d[1]}):a.to="scale"===a.attr?{x:1,y:1}:{x:0,y:0}):"rect"===b?(c?c.length&&(a.from={x:c[0],y:c[1],w:c[2],h:c[3]}):a.from={x:0,y:0,w:0,h:0},d?d.length&&(a.to={x:d[0],y:d[1],w:d[2],h:d[3]}):a.to={x:0,y:0,w:0,h:0}):"color"===b&&(a.from=sd(c),a.to=sd(d)),a.current=a.from}function Gb(a){var b=a.type,c=a.from,d=a.to;"number"===b?a.delta=d-c:"point"===b?a.delta={x:d.x-c.x,y:d.y-c.y}:"rect"===b?a.delta={x:d.x-c.x,y:d.y-c.y,w:d.w-c.w,h:d.h-c.h}:"color"===b&&(a.delta={r:d.r-c.r,g:d.g-c.g,b:d.b-c.b,a:d.a-c.a})}function Hb(a,b){var c=a.type,d=a.delta,e=a.from,f=a.time,g=a.dur,h=kd[a.easing||"easeNone"];return h||(h=kd.easeNone),"number"===c?b=h(f,e,d,g):"point"===c?b={x:h(f,e.x,d.x,g),y:h(f,e.y,d.y,g)}:"rect"===c?b={x:h(f,e.x,d.x,g),y:h(f,e.y,d.y,g),w:h(f,e.w,d.w,g),h:h(f,e.h,d.h,g)}:"color"===c?b="rgba("+Math.floor(h(f,e.r,d.r,g))+","+Math.floor(h(f,e.g,d.g,g))+","+Math.floor(h(f,e.b,d.b,g))+","+Math.floor(h(f,e.a,d.a,g))+")":"set"===c?a.time&&(b=a.to):"group_set"===c&&(b=a.to[a.groupIndex]),a.current=b,b}a.twaver&&(a.twaver.animateLoopId&&cancelAnimationFrame(a.twaver.animateLoopId),a.twaver.animateLoopId=null);var Ib={};Ib._isInitializing=!1;var Jb={isDeserializing:!1,isCalculatingBus:!1,images:{},registerImage:function(a,b,c,d,e){Jb.images[a]=new Ib.ImageAsset(a,b,c,d,e),yd(a)},getRegisteredImageNames:function(){return Object.keys(Jb.images)},unregisterImage:function(a){delete Jb.images[a]},getImageAsset:function(a){if("string"==typeof a){var b=Jb.images[a];return b}},showVersion:function(a){Jb.isCtrlDown(a)&&a.shiftKey&&76==a.keyCode&&alert("TWaver HTML5 "+Ib.Util.getVersion()+"\n"+Kb)},callLater:function(a,b,c,d){return setTimeout(function(){a.apply(b,c)},d||Ed.CALL_LATER_DELAY)},isEmptyObject:function(a){for(var b in a)return!1;return!0},xml:function(b){if(a.DOMParser)return(new DOMParser).parseFromString(b,"text/xml");var c=new ActiveXObject("Microsoft.XmlDOM");return c.async=!1,c.loadXml(b),c},num:function(a){return"number"==typeof a&&!isNaN(a)&&isFinite(a)},getter:function(a){var b=a.charAt(0).toUpperCase()+a.slice(1),c=/ble$/.test(a)||/ed$/.test(a)?"is":"get";return c+b},setter:function(a){var b=a.charAt(0).toUpperCase()+a.slice(1);return"set"+b},_id:["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"],id:function(){for(var a=[],b=0;32>b;b++)a[b]=this._id[Math.floor(16*Ib.Util.random())];return a[12]="4",a[16]=this._id[3&a[16]|8],a.join("")},keys:function(a){var b=new nd;for(var c in a)b.add(c);return b},es:["toString","toLocaleString","valueOf"],ip:function(a,b){var c="_"+b;a[Jb.getter(b)]=function(){return this[c]},a[Jb.setter(b)]=function(a){var d=this[c];this[c]=a,this.firePropertyChange(b,d,a)}},validateLicense:function(a){Kb=a,nc()},ibool:function(a,b){var c="_"+b,d=b.charAt(0).toUpperCase()+b.slice(1);a["is"+d]=function(){return this[c]},a[Jb.setter(b)]=function(a){var d=this[c];this[c]=a,this.firePropertyChange(b,d,a)}},getValue:function(a,b,c){var d=b.charAt(0).toUpperCase()+b.slice(1),e="get"+d,f="is"+d;return c?"boolean"===c?a[f]():a[e]():a[e]?a[e]():a[f]?a[f]():a[b]},setValue:function(a,b,c){a["set"+b.charAt(0).toUpperCase()+b.slice(1)](c)},clone:function(a){if(!a)return null;var b={};for(var c in a)b[c]=a[c];return b},cloneRect:function(a){return a?{x:a.x,y:a.y,width:a.width,height:a.height}:null},classCache:{},getClass:function(b){var c=Jb.classCache[b];if(!c){var d=b.split("."),e=d.length;c=a;for(var f=0;e>f;f++)c=c[d[f]],c||"twaver"===d[f]&&(c=Ib);Jb.classCache[b]=c}return c},newInstance:function(b){var c=Jb.getClass(b)||a[b];if(!c)return null;var d=arguments.length,e=arguments;if(1===d)return new c;if(2===d)return new c(e[1]);if(3===d)return new c(e[1],e[2]);if(4===d)return new c(e[1],e[2],e[3]);if(5===d)return new c(e[1],e[2],e[3],e[4]);if(6===d)return new c(e[1],e[2],e[3],e[4],e[5]);if(7===d)return new c(e[1],e[2],e[3],e[4],e[5],e[6]);if(8===d)return new c(e[1],e[2],e[3],e[4],e[5],e[6],e[7]);throw"don't support args more than 7"},addMethod:function(a,b){var c=a.prototype;for(var d in b)c[d]=b[d]},ext:function(a,b,c){var d;if("string"==typeof a&&(d=a,a=Jb.getClass(a)),b){var e=function(){};e.prototype=b.prototype,a.prototype=new e,a.prototype.constructor=a,a.superClass=b.prototype,b.prototype.constructor==Object.prototype.constructor&&(b.prototype.constructor=b)}if(d&&(a.prototype.getClassName=function(){return d}),c){var f=a.prototype;for(var g in c)Rb.ext(g,f,c);for(var h=Jb.es.length,i=0;h>i;i++)g=Jb.es[i],c.hasOwnProperty(g)&&!c.propertyIsEnumerable(g)&&(f[g]=c[g])}},setViewBounds:function(a,b){if(a)if(a.adjustBounds)a.adjustBounds(b);else{var c=a.style;!c&&a.getView()&&(c=a.getView().style),c&&(c.position="absolute",c.left=b.x+"px",c.top=b.y+"px",c.width=b.width+"px",c.height=b.height+"px")}},getImageSrc:function(a){var b=Jb.getImageAsset(a);return b?b.getSrc()?b.getSrc():b.getImage().getAttribute("src"):a},nextColorCount:0,nextColor:function(){return Jb.nextColorCount>=Ed.COLORS.length&&(Jb.nextColorCount=0),Ed.COLORS[Jb.nextColorCount++]},isCtrlDown:function(a){return a.ctrlKey||a.metaKey},isShiftDown:function(a){return a.shiftKey},isAltDown:function(a){return a.altKey},setText:function(a,b,c){c?Qb.isFirefox?a.textContent=b:a.innerText=b:a.innerHTML=b},fillDescendant:function(a,b){b.add(a),a.hasChildren()&&a.getChildren().forEach(function(a){Jb.fillDescendant(a,b)})}},Kb=(Date,"l=1.0\ntype=1\ngis=1\n3d=0\nstart=2015-10-21\nend=2016-10-31\nnote=This license applies to the evaluation version of TWaver. The License is limited to noncommercial use. Noncommercial use relates only to educational, research, personal or evaluation purposes. Any other use is commercial use. You may not use the Software in connection with any business activities.And You are not permitted to modify the software or attempt to decipher, decompile, disassemble or reverse engineer this Software.\nsignature=2e5ea3fc421c82faefdd5adb7f4cc1292bb315bf7a6ae5f14eaf81bf518344eb30899e3f2e8d1905d281d303ccf9f944ed98ee268cb7052503c879d9bc2479b2285d51fca10e872a7971c3f17b8494b31ef2e7b0988f6ff5c57d5a869f3af37d994321a3dcad3eba0adc0d83c84f50e9d71022bafaffb04a645aa1de657bb8ba49ae0ecb2f9838aaa9d601cdcc49e3ed7770fa84e0cd341dfdad6895ed1535c920f96075a6df4b045500f7d9ea7dfd85ad6c7ef697818090543728102de1c1151a8def3f01b092df43ec585d98f98f26731caf61b294b80e8fb5723b52fbd1301b34036a1a6e2b42bb5a30fe4fc51f569f4544443dd6cbe6ee5983f96cc71038688b4e38630ea6b93e45f6316560da5f6cd77c425eb90b3efb31b2f2ff23856da7d44b52b24c91de9a45064acba360cb3eeb6174a9b1fc4482cf77985e49a336029c2ed2b70d4336b71afca09cb3a086859c708f42680d5431f8ad1230b93b6b343c6237337c62af3242da3cc635a0ca623f822f2a2044e9e6c4598b2761ecc44348e47ec8d989e74526cf7fc34fb229621d761f708a32387c8a4e3f4a1b049be86dd7546559b7bfaa4da0fcd7b6f414bbdbcf8a80b8ef0f7947ae150a0a5027fd33b79ab5f85bfb7760ea6fb79da60d1f12386826f363a6e8b63d0fb3f6319c2f74314fc75a2de2156052418c8581a3565f645ccdf2e0429a9f7e413cd917c1250483f72408d6ccfff0e418bd280696d34358d30236319fda6e1802ad00f015978f4a2db435feb68b8875f962fe9518de30fd841b9dd5f5c394cd5705268e7748f1874880ea25f05b667b3e390b251cd7a1ae9a2ed33963b6088cd771d7be3d1daacf4b6c2a1ba5f822d4319c652e9f29c01a9ef9f76f9811fe258daf3feb5e");a.twaver=Ib,a._twaver=Jb,Ib.animate={},Ib.network={},Ib.network.interaction={},Ib.controls={},Ib.charts={},Ib.layout={};var Lb,Mb,Nb=a.navigator,Ob=a.document,Pb=a.Image;a.document||(Mb=!0,Lb=require("canvas"),Pb=Lb.Image,Nb={userAgent:""},Ob={});var Qb=function(){var a={},b=Nb.userAgent.toLowerCase();return a.isOpera=/opera/.test(b),a.isIE=/msie/.test(b)||/trident/.test(b)||/edge/.test(b),a.isFirefox=/firefox/i.test(b),a.isChrome=/chrome/i.test(b),a.isSafari=!a.isChrome&&/safari/i.test(b),a.isIPhone=/iphone/.test(b),a.isIPod=/ipod/.test(b),a.isIPad=/ipad/.test(b),a.isAndroid=/android/i.test(b),a.isWebOS=/webos/i.test(b),a.isMSTouchable=a.isIE&&(Nb.msMaxTouchPoints&&Nb.msMaxTouchPoints>1||Nb.maxTouchPoints&&Nb.maxTouchPoints>1),a.isTouchable="ontouchend"in Ob||a.isMSTouchable,a}();Jb.ua=Qb;var Rb={__accessor:function(a,b){for(var c=b.__accessor,d=c.length,e=0;d>e;e++)Jb.ip(a,c[e])},__bool:function(a,b){for(var c=b.__bool,d=c.length,e=0;d>e;e++)Jb.ibool(a,c[e])},__client:function(a,b){a.getClient=function(a){return this._clientMap[a]},a.setClient=function(a,b){var c=this._clientMap[a];return null==b?delete this._clientMap[a]:this._clientMap[a]=b,this.firePropertyChange("C:"+a,c,b)&&this.onClientChanged(a,c,b),this},a.getClientProperties=function(){return Jb.keys(this._clientMap)},a.getClientMap=function(){return this._clientMap},a.onClientChanged=function(a,b,c){}},__style:function(a,c){a.getStyle=function(a,c){var d=this._styleMap[a];return c===b&&(c=!0),null==d&&c?Ib.Styles.getStyle(a):d},a.setStyle=function(a,b){var c=this._styleMap[a];return null==b?delete this._styleMap[a]:this._styleMap[a]=b,this.firePropertyChange("S:"+a,c,b)&&this.onStyleChanged(a,c,b),this},a.getStyleProperties=function(){return Jb.keys(this._styleMap)},a.onStyleChanged=function(a,b,c){}},__new:function(a,b){a.newInstance=function(){var a=Jb.getClass(this.getClassName());if(!a)return null;var b=arguments.length,c=arguments;if(0===b)return new a;if(1===b)return new a(c[0]);
if(2===b)return new a(c[0],c[1]);if(3===b)return new a(c[0],c[1],c[2]);if(4===b)return new a(c[0],c[1],c[2],c[3]);if(5===b)return new a(c[0],c[1],c[2],c[3],c[4]);if(6===b)return new a(c[0],c[1],c[2],c[3],c[4],c[5]);if(7===b)return new a(c[0],c[1],c[2],c[3],c[4],c[5],c[6]);throw"don't support args more than 7"}},__property:function(a,b){a.getValue=function(a,b){return"accessor"===this._propertyType?Jb.getValue(a,this._propertyName):"style"===this._propertyType&&a.getStyle?a.getStyle(this._propertyName):"client"===this._propertyType&&a.getClient?a.getClient(this._propertyName):"field"===this._propertyType?a[this._propertyName]:null},a.setValue=function(a,b,c){if("accessor"===this._propertyType)a[Jb.setter(this._propertyName)](b);else{if("style"===this._propertyType&&a.setStyle)return a.setStyle(this._propertyName,b);if("client"===this._propertyType&&a.setClient)return a.setClient(this._propertyName,b);"field"===this._propertyType&&(a[this._propertyName]=b)}}},map:{__accessor:1,__bool:1,__client:1,__style:1,__new:1,__tree:1,__property:1},ext:function(a,b,c){1===Rb.map[a]?Rb[a](b,c):b[a]=c[a]}};Jb.extend=Rb;var Sb=Jb.Matrix=function(a,b,c,d,e,f){this.setMatrix(a,b,c,d,e,f)};Sb.identity=function(){return new Sb(1,0,0,1,0,0)},Sb.prototype.setMatrix=function(a,b,c,d,e,f){this._m11=a,this._m12=b,this._m21=c,this._m22=d,this._offsetX=e,this._offsetY=f,this._type=0,0!=this._m21||0!=this._m12?this._type=4:((1!=this._m11||1!=this._m22)&&(this._type=2),(0!=this._offsetX||0!=this._offsetY)&&(this._type|=1),0==(3&this._type)&&(this._type=0))},Sb.prototype.transform=function(){var a;if(a=2===arguments.length?{x:arguments[0],y:arguments[1]}:arguments[0],!a||!Jb.num(a.x)||!Jb.num(a.y))throw"arguments should contain x, y";switch(this._type){case 0:return{x:a.x,y:a.y};case 1:return{x:this._offsetX+a.x,y:this._offsetY+a.y};case 2:return{x:a.x*this._m11,y:a.y*this._m22};case 3:return{x:a.x*this._m11+this._offsetX,y:a.y*this._m22+this._offsetY}}return{x:this._m11*a.x+a.y*this._m21+this._offsetX,y:this._m22*a.y+a.x*this._m12+this._offsetY}},Sb.prototype.translate=function(a,b){this.multiply(new Sb(1,0,0,1,a,b))},Sb.prototype.scale=function(a,b){this.multiply(new Sb(a,0,0,b,0,0))},Sb.prototype.rotate=function(a,b,c){a=a*Math.PI/180;var d=Math.sin(a),e=Math.cos(a),f=b*(1-e)+c*d,g=c*(1-e)-b*d;this.multiply(new Sb(e,d,-d,e,f,g))},Sb.prototype.skew=function(a,b){this.multiply(new Sb(1,Math.tan(b*Math.PI/180),Math.tan(a*Math.PI/180),1,0,0))},Sb.prototype.multiply=function(a){var b=this,c=a,d=b._type,e=c._type;if(0!=e)if(0==d)b.setMatrix(c._m11,c._m12,c._m21,c._m22,c._offsetX,c._offsetY);else if(1==e)b._offsetX+=c._offsetX,b._offsetY+=c._offsetY,4!=d&&(b._type|=1);else if(1==d){var f=b._offsetX,g=b._offsetY;b.setMatrix(c._m11,c._m12,c._m21,c._m22,c._offsetX,c._offsetY),b._offsetX=f*c._m11+g*c._m21+c._offsetX,b._offsetY=f*c._m12+g*c._m22+c._offsetY,b._type=4==e?4:3}else switch(d<<4|e){case 34:return b._m11*=c._m11,void(b._m22*=c._m22);case 35:return b._m11*=c._m11,b._m22*=c._m22,b._offsetX=c._offsetX,b._offsetY=c._offsetY,void(b._type=3);case 36:case 52:case 66:case 67:case 68:return void b.setMatrix(b._m11*c._m11+b._m12*c._m21,b._m11*c._m12+b._m12*c._m22,b._m21*c._m11+b._m22*c._m21,b._m21*c._m12+b._m22*c._m22,b._offsetX*c._m11+b._offsetY*c._m21+c._offsetX,b._offsetX*c._m12+b._offsetY*c._m22+c._offsetY);case 50:return b._m11*=c._m11,b._m22*=c._m22,b._offsetX*=c._m11,void(b._offsetY*=c._m22);case 51:return b._m11*=c._m11,b._m22*=c._m22,b._offsetX=c._m11*b._offsetX+c._offsetX,void(b._offsetY=c._m22*b._offsetY+c._offsetY);default:console.log("Matrix multiply hit an invalid case: "+combinedType)}};var Tb={getDistance:function(a,b){var c=b.x-a.x,d=b.y-a.y;return Math.sqrt(c*c+d*d)},getCenterPoint:function(a,b){return a&&b?{x:(a.x+b.x)/2,y:(a.y+b.y)/2}:null==b&&a.width?{x:a.x+a.width/2,y:a.y+a.height/2}:void 0},isPointInPolygon:function(a,b){a=a._as?a._as:a;var c=0,d=0,e=!1,f=a.length;for(c=0,d=f-1;f>c;d=c++){var g=a[c],h=a[d];g.y>b.y!=h.y>b.y&&b.x<(h.x-g.x)*(b.y-g.y)/(h.y-g.y)+g.x&&(e=!e)}return e},unionRect:function(a,b){if(a&&!b)return Jb.cloneRect(a);if(!a&&b)return Jb.cloneRect(b);if(a&&b){var c={};return c.x=Math.min(a.x,b.x),c.y=Math.min(a.y,b.y),c.width=Math.max(a.x+a.width,b.x+b.width)-c.x,c.height=Math.max(a.y+a.height,b.y+b.height)-c.y,c}return null},intersects:function(a,b){if(!a||!b)return!1;var c=b.width,d=b.height,e=a.width,f=a.height;if(0>=e||0>=f||0>=c||0>=d)return!1;var g=b.x,h=b.y,i=a.x,j=a.y;return e+=i,f+=j,c+=g,d+=h,(i>e||e>g)&&(j>f||f>h)&&(g>c||c>i)&&(h>d||d>j)},intersection:function(a,b){if(!a||!b)return!1;var c=b.x,d=b.y,e=a.x,f=a.y,g=c;g+=b.width;var h=d;h+=b.height;var i=e;i+=a.width;var j=f;return j+=a.height,e>c&&(c=e),f>d&&(d=f),g>i&&(g=i),h>j&&(h=j),g-=c,h-=d,0===g||0===h?null:{x:c,y:d,width:g,height:h}},contains:function(a,b){var c=b.x,d=b.y,e=b.width,f=b.height,g=a.width,h=a.height;if(0>(g|h|e|f))return!1;var i=a.x,j=a.y;if(i>c||j>d)return!1;if(g+=i,e+=c,c>=e){if(g>=i||e>g)return!1}else if(g>=i&&e>g)return!1;if(h+=j,f+=d,d>=f){if(h>=j||f>h)return!1}else if(h>=j&&f>h)return!1;return!0},getLinePoints:function(a){if(!a)return null;var b=new nd;return a.forEach(function(a){b.addAll(a)}),b},getLineRect:function(a){var b=Tb.getLinePoints(a);return Tb.getRect(b)},getRect:function(a,b){if(!a)return null;a._as&&(a=a._as);var c=a.length;if(0>=c)return null;var d=a[0];b=b||{x:null,y:null,width:0,height:0};for(var e=0;c>e;e++)if(d=a[e],d instanceof nd)Tb.getRect(d,b);else{null==b.x&&(b.x=d.x,b.y=d.y);var f=Math.min(b.x,d.x),g=Math.min(b.y,d.y),h=Math.max(b.x+b.width,d.x),i=Math.max(b.y+b.height,d.y);b.x=f,b.y=g,b.width=h-f,b.height=i-g}return b},addPadding:function(a,b,c,d){d=d||-1;var e=b.getStyle(c)*d;0!=e&&Tb.grow(a,e,e),e=b.getStyle(c+".left")*d,0!=e&&(a.x-=e,a.width+=e),e=b.getStyle(c+".right")*d,0!=e&&(a.width+=e),e=b.getStyle(c+".top")*d,0!=e&&(a.y-=e,a.height+=e),e=b.getStyle(c+".bottom")*d,0!=e&&(a.height+=e),a.width<0&&(a.width=-a.width,a.x-=a.width),a.height<0&&(a.height=-a.height,a.y-=a.height)},grow:function(a,b,c){if(null==a)return null;null==c&&(c=b);var d=a.width+b+b;if(!(0>d)){var e=a.height+c+c;if(!(0>e))return a.x-=b,a.y-=c,a.width=d,a.height=e,a}},containsPoint:function(a,b,c){return arguments.length<3&&(c=b.y,b=b.x),!a||b<a.x||c<a.y||b>a.x+a.width||c>a.y+a.height?!1:!0},getHotSpot:function(a,b,c,d,e){if("oval"===e){var f=.35;return{x:a+.5*c+c*f,y:b+d/2-Math.sqrt(.25-f*f)*d}}if("circle"===e){var g=a+c/2,h=b+d/2,i=Math.min(c,d)/2;a=g-i,b=h-i,c=2*i,d=2*i;var j=c/2,k=d/2,l=j*k/Math.sqrt(j*j+k*k);return{x:a+c/2+l,y:b+d/2-l}}var m={x:a+c,y:b};return c>3&&(m.x-=3),d>3&&(m.y+=3),m},getCircleRect:function(a){var b=Math.min(a.width,a.height)/2;return{x:a.x+a.width/2-b,y:a.y+a.height/2-b,width:2*b,height:2*b}},getEllipsePoint:function(a,b){if(!a||!b)return null;var c=a.x+a.width/2,d=a.y+a.height/2,e=b.x-c,f=b.y-d,g=a.width/2,h=a.height/2,i=Math.sqrt(1/(1/g/g+f*f/e/e/h/h));0>e&&(i=-i);var j;return j=0==e?f>0?h:-h:i*f/e,{x:c+i,y:d+j}},createMatrix:function(a,b,c){var d=Math.sin(a),e=Math.cos(a),f=b*(1-e)+c*d,g=c*(1-e)-b*d;return new Sb(e,d,-d,e,f,g)},calculatePointInfoAlongLineBySegments:function(a,b,c,d,e){return Tb.calculatePointInfoAlongLine(Tb.getPointObject(a,b),c,d,e)},calculatePointInfoAlongLine:function(a,c,d,e){if(c=c===b?!0:c,d=d||0,e=e||0,!a||a.size()<2)throw"must more than two points";if(!c){var f=Tb.reversePath(a);return Tb.calculatePointInfoAlongLine(f,!0,d,e)}a._as&&(a=a._as);var g,h,i,j,k,l=0,m=0,n=a.length;for(j=0;n>j;j++)if(k=a[j],0!=j){if(0>=d){i=Tb.calculatePointInfoOnStraightLine(Tb._getPoint(h),Tb._getControlPoint(k),d,e),g=i;break}if(m=Tb._getLength(k,h),l+m>d){i=Tb.getPathInfo(k,h,d-l,e,m),g=i;break}l+=m,h=k}else h=k;if(null==g){var o,p;h=a[n-1],p=Tb._getPoint(h),h instanceof nd&&(h=h._as),o=h instanceof Array?Tb._getControlPoint(h):Tb._getPoint(a[n-2]);var q=Math.atan2(p.y-o.y,p.x-o.x);i=Tb.transformPoint(p,q,d-l,e),i.angle=q,g=i}return g},reversePath:function(a){var b,c=new nd,d=null;a._as&&(a=a._as);for(var e=a.length-1;e>=0;e--)b=a[e],c.add(Tb._getReversePath(b,d)),d=b;return c},_getPoint:function(a){return a._as&&(a=a._as),a instanceof Array?a[a.length-1]:a},_getControlPoint:function(a){return a._as&&(a=a._as),a instanceof Array?a[a.length-2]:a},_getReversePath:function(a,b){var c=Tb._getPoint(a);return b&&b._as&&(b=b._as),null!=b&&b instanceof Array?new nd(2==b.length?[b[0],c]:[b[1],b[0],c]):c},_getLength:function(a,b){var c=Tb._getPoint(b),d=Tb._getPoint(a);if(a instanceof nd&&(a=a._as),a instanceof Array)return Tb.calculateCurveLength(c,a,1);var e=d.y-c.y,f=d.x-c.x;return Math.sqrt(f*f+e*e)},getPathInfo:function(a,b,c,d,e){var f,g=Tb._getPoint(b),h=Tb._getPoint(a);if(a instanceof nd&&(a=a._as),a instanceof Array){0>e&&(e=Tb._getLength(a,b));var i=c/e,j=Tb.calculatePointInfoOnCurveLine(g,a,i);g=j.point,f=j.angle,c=0}else f=Math.atan2(h.y-g.y,h.x-g.x);return Tb.transformPoint(g,f,c,d)},transformPoint:function(a,b,c,d){var e={x:c,y:d},f=Tb.createMatrix(b,0,0);return e=f.transform(e),e.x+=a.x,e.y+=a.y,{point:e,angle:b}},calculatePointInfoOnStraightLine:function(a,b,c,d){var e=Math.atan2(b.y-a.y,b.x-a.x);return Tb.transformPoint(a,e,c,d)},calculatePointInfoOnCurveLine:function(a,b,c){if(0>c||c>1)throw"Illegal arguments";return b._as&&(b=b._as),2==b.length?Tb._calculatePointInfoOnCurveLine2(a,b[0],b[1],c):Tb._calculatePointInfoOnCurveLine3(a,b[0],b[1],b[2],c)},_calculatePointInfoOnCurveLine2:function(a,b,c,d){var e=2*(a.x+c.x-2*b.x)*d+2*b.x-2*a.x,f=2*(a.y+c.y-2*b.y)*d+2*b.y-2*a.y,g=Math.atan2(f,e),h=(a.x+c.x-2*b.x)*d*d+(2*b.x-2*a.x)*d+a.x,i=(a.y+c.y-2*b.y)*d*d+(2*b.y-2*a.y)*d+a.y;return{point:{x:h,y:i},angle:g}},_calculatePointInfoOnCurveLine3:function(a,b,c,d,e){var f,g,h;f=1-e,g=f*f*f,h=e*e*e;var i=g*a.x+3*e*f*f*b.x+3*e*e*f*c.x+h*d.x,j=g*a.y+3*e*f*f*b.y+3*e*e*f*c.y+h*d.y;return{point:{x:i,y:j},angle:Math.atan2(Tb._bezeSpeedY(a,b,c,d,e),Tb._bezeSpeedX(a,b,c,d,e))}},calculateCurveLength:function(a,b,c){return b._as&&(b=b._as),2==b.length?Tb._calculateCurveLength(a,b[0],b[1],c):Tb._calculateBezierCurveLength(a,b[0],b[1],b[2],c)},_calculateCurveLength:function(a,b,c,d){if(0>=d||d>1)return 0;var e=Math.floor(d*(Math.sqrt((a.x-b.x)*(a.x-b.x)+(a.y-b.y)*(a.y-b.y))+Math.sqrt((c.x-b.x)*(c.x-b.x)+(c.y-b.y)*(c.y-b.y)))/2),f=0;0>=e&&(e=1);for(var g,h,i=d/e,j=0,k=0;e>k;k++)j=i*k,g=2*(a.x+c.x-2*b.x)*j+2*b.x-2*a.x,h=2*(a.y+c.y-2*b.y)*j+2*b.y-2*a.y,g*=i,h*=i,f+=Math.sqrt(g*g+h*h);return f},_calculateBezierCurveLength:function(a,b,c,d,e){if(0>=e||e>1)return 0;var f=1e4,g=Math.floor(f*e);if(1==(1&g)&&g++,0==g)return 0;var h,i=Math.floor(g/2),j=0,k=0,l=e/g;for(h=0;i>h;h++)j+=Tb._bezeSpeed(a,b,c,d,(2*h+1)*l);for(h=1;i>h;h++)k+=Tb._bezeSpeed(a,b,c,d,2*h*l);return(Tb._bezeSpeed(a,b,c,d,0)+Tb._bezeSpeed(a,b,c,d,1)+2*k+4*j)*l/3},_bezeSpeedX:function(a,b,c,d,e){var f=1-e;return-3*a.x*f*f+3*b.x*f*f-6*b.x*f*e+6*c.x*f*e-3*c.x*e*e+3*d.x*e*e},_bezeSpeedY:function(a,b,c,d,e){var f=1-e;return-3*a.y*f*f+3*b.y*f*f-6*b.y*f*e+6*c.y*f*e-3*c.y*e*e+3*d.y*e*e},_bezeSpeed:function(a,b,c,d,e){var f=Tb._bezeSpeedX(a,b,c,d,e),g=Tb._bezeSpeedY(a,b,c,d,e);return Math.sqrt(f*f+g*g)},getPointObject:function(a,b){if(b&&0!=b.size()){var c=new nd;b=b._as,a=a._as;var d,e,f=0,g=b.length,h=a.length;for(d=0;g>d&&(e=b[d],f!=h);d++)"cubicto"===e?h-2>f&&c.add([a[f++],a[f++],a[f++]]):"quadto"===e?h-1>f&&c.add([a[f++],a[f++]]):h>f&&c.add(a[f++]);for(;h>f;f++)c.add(a[f]);return c}return a},calculateLineLength:function(a,b){if(!a||a.size()<2)return 0;if(b)return Tb.calculateLineLength(Tb.getPointObject(a,b));a=a._as;var c,d,e,f,g,h,i,j=a.length,k=0;for(c=0;j>c;c++)f=a[c],0!=c?(e=f,e instanceof nd&&(e=e._as),e instanceof Array?(g=Tb.calculateCurveLength(d,e,1),d=e[e.length-1]):(i=f.y-d.y,h=f.x-d.x,g=Math.sqrt(h*h+i*i),d=e),k+=g):d=f;return k},toDegrees:function(a){return 180*a/Math.PI},toRadians:function(a){return a/180*Math.PI},getRadiansBetweenLines:function(a,b){return Math.atan2(b.y-a.y,b.x-a.x)},getAngle:function(a,b){return a.x===b.x?b.y===a.y?0:b.y>a.y?Math.PI/2:-Math.PI/2:Math.atan((b.y-a.y)/(b.x-a.x))}};Jb.math=Tb;var Ub={getPoints:function(a){var b=new nd;return a.forEach(function(a){b.add({x:a.x,y:a.y}),b.add({x:a.x+a.width,y:a.y+a.height}),b.add({x:a.x+a.width,y:a.y}),b.add({x:a.x,y:a.y+a.height})}),b},rectangle:function(a){var b;return a.forEach(function(a){b=Tb.unionRect(b,a)}),b},oval:function(a){var b=Ub.rectangle(a),c=0,d=b.height/b.width,e=d*d,f=b.x+b.width/2,g=b.y+b.height/2,h=Ub.getPoints(a);h.forEach(function(a){var b=a.x-f,d=a.y-g,h=b*b+d*d/e;h>c&&(c=h)}),c=Math.sqrt(c);var i=d*c;return{x:f-c,y:g-i,width:2*c,height:2*i}},circle:function(a){var b=Ub.rectangle(a),c=0,d=b.x+b.width/2,e=b.y+b.height/2,f=Ub.getPoints(a);return f.forEach(function(a){var b=a.x-d,f=a.y-e,g=b*b+f*f;g>c&&(c=g)}),c=Math.sqrt(c),{x:d-c,y:e-c,width:2*c,height:2*c}},roundrect:function(a){var b=Ub.rectangle(a),c=Math.min(b.width,b.height)/16;return Tb.grow(b,c,c),b},star:function(a){var b=Ub.rectangle(a);return Tb.grow(b,b.width,b.height),b},triangle:function(a){var b=Ub.rectangle(a);return b.x-=b.width/2,b.width*=2,b.y-=b.height,b.height*=2,b},hexagon:function(a){var b=Ub.rectangle(a);return b.x-=b.width/2,b.width*=2,b},pentagon:function(a){var b=Ub.rectangle(a);return b.x-=b.width/6,b.width+=b.width/3,b.y-=b.height/4,b.height+=b.height/4,b},diamond:function(a){var b=Ub.rectangle(a);return b.x-=b.width/2,b.width+=b.width,b.y-=b.height/2,b.height+=b.height,b},trapezoidal:function(a){var b=Ub.rectangle(a);return b.x-=b.width/2,b.width+=b.width,b.y-=b.height/2,b.height+=b.height,b}};Jb.group=Ub;var Vb={"topleft.topleft":function(a,b){return{x:a.x-b.width,y:a.y-b.height}},"topleft.topright":function(a,b){return{x:a.x,y:a.y-b.height}},"top.top":function(a,b){return{x:a.x+a.width/2-b.width/2,y:a.y-b.height}},"topright.topleft":function(a,b){return{x:a.x+a.width-b.width,y:a.y-b.height}},"topright.topright":function(a,b){return{x:a.x+a.width,y:a.y-b.height}},topleft:function(a,b){return{x:a.x-b.width/2,y:a.y-b.height/2}},top:function(a,b){return{x:a.x-b.width/2+a.width/2,y:a.y-b.height/2}},topright:function(a,b){return{x:a.x-b.width/2+a.width,y:a.y-b.height/2}},"topleft.bottomleft":function(a,b){return{x:a.x-b.width,y:a.y}},"topleft.bottomright":function(a,b){return{x:a.x,y:a.y}},"top.bottom":function(a,b){return{x:a.x+a.width/2-b.width/2,y:a.y}},"topright.bottomleft":function(a,b){return{x:a.x-b.width+a.width,y:a.y}},"topright.bottomright":function(a,b){return{x:a.x+a.width,y:a.y}},"left.left":function(a,b){return{x:a.x-b.width,y:a.y+a.height/2-b.height/2}},left:function(a,b){return{x:a.x-b.width/2,y:a.y+a.height/2-b.height/2}},"left.right":function(a,b){return{x:a.x,y:a.y+a.height/2-b.height/2}},center:function(a,b){return{x:a.x+a.width/2-b.width/2,y:a.y+a.height/2-b.height/2}},"right.left":function(a,b){return{x:a.x+a.width-b.width,y:a.y+a.height/2-b.height/2}},right:function(a,b){return{x:a.x+a.width-b.width/2,y:a.y+a.height/2-b.height/2}},"right.right":function(a,b){return{x:a.x+a.width,y:a.y+a.height/2-b.height/2}},"bottomleft.topleft":function(a,b){return{x:a.x-b.width,y:a.y+a.height-b.height}},"bottomleft.topright":function(a,b){return{x:a.x,y:a.y+a.height-b.height}},"bottom.top":function(a,b){return{x:a.x+a.width/2-b.width/2,y:a.y+a.height-b.height}},"bottomright.topleft":function(a,b){return{x:a.x+a.width-b.width,y:a.y+a.height-b.height}},"bottomright.topright":function(a,b){return{x:a.x+a.width,y:a.y+a.height-b.height}},bottomleft:function(a,b){return{x:a.x-b.width/2,y:a.y+a.height-b.height/2}},bottom:function(a,b){return{x:a.x+a.width/2-b.width/2,y:a.y+a.height-b.height/2}},bottomright:function(a,b){return{x:a.x+a.width-b.width/2,y:a.y+a.height-b.height/2}},"bottomleft.bottomleft":function(a,b){return{x:a.x-b.width,y:a.y+a.height}},"bottomleft.bottomright":function(a,b){return{x:a.x,y:a.y+a.height}},"bottom.bottom":function(a,b){return{x:a.x+a.width/2-b.width/2,y:a.y+a.height}},"bottomright.bottomleft":function(a,b){return{x:a.x+a.width-b.width,y:a.y+a.height}},"bottomright.bottomright":function(a,b){return{x:a.x+a.width,y:a.y+a.height}},get:function(a,b,c){if(!b)throw"refRect can not be null";c||(c={width:0,height:0});var d=Vb[a];if(d)return d(b,c);throw"Can not resolve '"+a+"' position"}};Jb.position=Vb;var Wb={preventDefault:function(a){Ed.KEEP_DEFAULT_FUNCTION(a)||(a.preventDefault?a.preventDefault():a.preventManipulation?a.preventManipulation():a.returnValue=!1)},insertAfter:function(a,b){return b?b.parentNode.insertBefore(a,b.nextSibling):a.parentNode.insertBefore(a,a.parentNode.firstChild),a},forEach:function(a,b,c){if(Wb.isVisible(a)){for(var d=a.childNodes.length,e=0;d>e;e++)Wb.forEach(a.childNodes[e],b,c);c?b.call(c,a):b(a)}},setVisible:function(a,b){a.style.display=b?"block":"none"},isVisible:function(a){return"style"in a&&"none"!==a.style.display},release:function(a){for(var b=a.childNodes.length,c=0;b>c;c++)Wb.release(a.childNodes[c]);b>0&&Wb.clear(a),a._pool&&a._pool.release(a)},clear:function(a){for(;a.firstChild;)a.removeChild(a.firstChild)},setZoom:function(a,b){var c=a.style;if(c.setProperty)if(Qb.isFirefox)c.setProperty("-moz-transform","scale("+b+")",null),c.setProperty("-moz-transform-origin","0 0",null);else if(Qb.isOpera)c.setProperty("-o-transform","scale("+b+")",null),c.setProperty("-o-transform-origin","0 0",null);else if(Qb.isChrome||Qb.isSafari){c.setProperty("-webkit-transform","scale("+b+")",null),c.setProperty("-webkit-transform-origin","0 0",null);var d=null;a._webkitInvaildateDiv?d=a._webkitInvaildateDiv:(d=Ob.createElement("div"),a._webkitInvaildateDiv=d),d.parentNode&&d.parentNode==a?a.removeChild(d):a.appendChild(d)}else Qb.isIE?(c.setProperty("-ms-transform","scale("+b+")",null),c.setProperty("-ms-transform-origin","0 0",null)):(c.setProperty("transform","scale("+b+")",null),c.setProperty("transform-origin","0 0",null))},setRotate:function(a,b){var c=a.style;if(c.setProperty)if(Qb.isFirefox)c.setProperty("-moz-transform","scale("+b+")",null),c.setProperty("-moz-transform-origin","0 0",null);else if(Qb.isOpera)c.setProperty("-o-transform","scale("+b+")",null),c.setProperty("-o-transform-origin","0 0",null);else if(Qb.isChrome||Qb.isSafari){c.setProperty("-webkit-transform","scale("+b+")",null),c.setProperty("-webkit-transform-origin","0 0",null);var d=null;a._webkitInvaildateDiv?d=a._webkitInvaildateDiv:(d=Ob.createElement("div"),a._webkitInvaildateDiv=d),d.parentNode&&d.parentNode==a?a.removeChild(d):a.appendChild(d)}else Qb.isIE?(c.setProperty("-ms-transform","scale("+b+")",null),c.setProperty("-ms-transform-origin","0 0",null)):(c.setProperty("transform","scale("+b+")",null),c.setProperty("transform-origin","0 0",null))},setCSSStyle:function(a,b,c){a.style.setProperty(b,c,null)},removeCSSStyle:function(a,b){a.style.removeProperty(b)},getCSSStyle:function(a,b){return a.style.getPropertyValue(b)},setBorderRaidus:function(a,b){Qb.isFirefox?a.style.MozBorderRadius=b:a.style.borderRadius=b},createSelect:function(a,b){var c,d,e,f=Ob.createElement("select");if(Array.isArray(a))for(c=0;c<a.length;c++)d=a[c],e=Ob.createElement("option"),e.innerHTML=d,e.setAttribute("value",d),d===b&&e.setAttribute("selected","true"),f.appendChild(e);else for(c=0;c<a.values.length;c++)d=a.values[c],e=Ob.createElement("option"),e.innerHTML=a.map[d],e.setAttribute("value",d),d===b&&e.setAttribute("selected","true"),f.appendChild(e);return f},createImg:function(a){var b=Ob.createElement("img");return b.style.position="absolute","string"==typeof a&&b.setAttribute("src",a),b},createView:function(a,b){var c=Ob.createElement("div");return c.style.position=Ed.VIEW_POSITION,c.style.fontSize=Ed.VIEW_FONT_SIZE,c.style.fontFamily=Ed.VIEW_FONT_FAMILY,c.style.cursor="default",c.style.outline="none",c.style.textAlign="left",c.style.msTouchAction="none",c.style.touchAction="none",c.tabIndex=0,b||(c.onmousedown=Wb.preventDefault),c.style.setProperty&&(c.style.setProperty("-khtml-user-select","none",null),c.style.setProperty("-webkit-user-select","none",null),c.style.setProperty("-moz-user-select","none",null),c.style.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",null)),a&&(c.style.overflow=a),c},createDiv:function(){var a=Ob.createElement("div");return a.style.position="absolute",a.style.msTouchAction="none",a.style.touchAction="none",a},createCanvas:function(a,b){if(a=a||0,b=b||0,Mb){var c=require("canvas");return new c(a,b)}var d=Ob.createElement("canvas");return d.style.position="absolute",d.style.msTouchAction="none",d.style.touchAction="none",d.width=a,d.height=b,d},setCanvas:function(a,b,c,d,e){2===arguments.length&&(c=b.y,d=b.width,e=b.height,b=b.x),a.style.left=b+"px",a.style.top=c+"px",a.setAttribute("width",d),a.setAttribute("height",e),a._viewRect={x:b,y:c,width:d,height:e};var f=a.getContext("2d");return 0!==f.shadowBlur&&(f.shadowOffsetX=0,f.shadowOffsetY=0,f.shadowBlur=0,f.shadowColor="rgba(0,0,0,0.0)"),f.clearRect(0,0,d,e),f.translate(-b,-c),f},setImg:function(a,b,c){a.setAttribute("src",b),a.style.left=c.x+"px",a.style.top=c.y+"px",a.style.width=c.width+"px",a.style.height=c.height+"px",a._viewRect=Jb.clone(c)},setDiv:function(a,b,c,d,e){d=Jb.num(d)?d:0,a.style.left=b.x-d+"px",a.style.top=b.y-d+"px",a.style.width=b.width+"px",a.style.height=b.height+"px",a._viewRect=Jb.clone(b),a.style.backgroundColor=c?c:"",a.style.border=d>0?d+"px "+e+" solid":""},changeTypeForMS:function(b){var c=b;if(0===b.indexOf("MSPointer")||0===b.indexOf("pointer")){var d;0===b.indexOf("MSPointer")?(d=b.substring(9,10).toLowerCase(),d+=b.substring(10)):d=b.substring(7,8),a.MSPointerEvent?c="MSPointer"+d.substring(0,1).toUpperCase()+d.substring(1):a.PointerEvent&&(c="pointer"+d)}return c},addEventListener:function(a,b,c,d){a=this.changeTypeForMS(a);var e="_"+a+"_";if(!d[e]){var f=function(a){f.instance[f.method](a)};f.method=b,f.instance=d,d[e]=f,c.addEventListener(a,f,!1)}},removeEventListener:function(a,b,c){a=this.changeTypeForMS(a);var d="_"+a+"_",e=c[d];e&&(b.removeEventListener(a,e,!1),delete c[d])},isValidEvent:function(a,b){if(!b)return!1;if(b.target===a)if(Qb.isFirefox){if(a.clientHeight<a.scrollHeight&&b.layerX<25)return!1;if(a.clientWidth<a.scrollWidth&&b.layerY<25)return!1}else if(b.offsetX>a.clientWidth||b.offsetY>a.clientHeight)return!1;return!0},getLogicalPoint:function(a,b,c,d){c=c?c:1;var e,f=a.getBoundingClientRect();if(Qb.isTouchable&&b.changedTouches&&b.changedTouches.length>0){var g=b.changedTouches[0],h=Qb.isAndroid?0:zc.scrollLeft(),i=Qb.isAndroid?0:zc.scrollTop();e={x:(g.clientX+a.scrollLeft-f.left-h)/c,y:(g.clientY+a.scrollTop-f.top-i)/c}}else{if(!Wb.isValidEvent(a,b))return null;e={x:(b.clientX-f.left+a.scrollLeft)/c,y:(b.clientY-f.top+a.scrollTop)/c}}return e},handle_mousedown:function(b,c){Wb.target&&Wb.handle_mouseup(c),a.addEventListener("mousemove",Wb.handle_mousemove,!1),a.addEventListener("mouseup",Wb.handle_mouseup,!1),Wb.target=b},handle_mousemove:function(a){Wb.target.handle_mousemove&&Wb.target.handle_mousemove(a),Wb.target.handleMouseMove&&Wb.target.handleMouseMove(a)},handle_mouseup:function(b){Wb.target.handle_mouseup&&Wb.target.handle_mouseup(b),Wb.target.handleMouseUp&&Wb.target.handleMouseUp(b),a.removeEventListener("mousemove",Wb.handle_mousemove,!1),a.removeEventListener("mouseup",Wb.handle_mouseup,!1),delete Wb.target},getClientPoint:function(a){return{x:a.clientX,y:a.clientY}},windowWidth:function(){return"number"==typeof a.innerWidth?a.innerWidth:Ob.documentElement&&Ob.documentElement.clientWidth?Ob.documentElement.clientWidth:Ob.body&&Ob.body.clientWidth?Ob.body.clientWidth:0},windowHeight:function(){return"number"==typeof a.innerHeight?a.innerHeight:Ob.documentElement&&Ob.documentElement.clientHeight?Ob.documentElement.clientHeight:Ob.body&&Ob.body.clientHeight?Ob.body.clientHeight:0}};Jb.html=Wb;var Xb={cache:{},g:Wb.createCanvas().getContext("2d"),getTextSize:function(a,b){Xb.g.font=a?a:Ed.FONT;var c=Xb.cache[Xb.g.font];c||(c=2*Xb.g.measureText("e").width+4,Xb.cache[Xb.g.font]=c),b=b||"",b=String(b);for(var d,e=b.split("\n"),f=e.length,g=0,h=f-1;h>=0;h--)d=Xb.g.measureText(e[h]).width,d>g&&(g=d);return{width:g+4,height:c*f}},getSubStringInLength:function(a,b,c){var d=this,e=function(a,b,c,f,g){if(a>=b)return f.substring(0,a+1);var h=Math.floor((a+b)/2),i=f.substring(0,h+1),j=d.getTextSize(c,i).width;if(j>g)return e(a,h-1,c,f,g);var k=h+1,l=f.substring(0,k+1),m=d.getTextSize(c,l).width;return m>g?i:e(k,b,c,f,g)},f=this.getTextSize(a,b).width;return f>c?e(0,b.length-1,a,b,c):b},getCollapseTextInLength:function(a,b,c){var d=this.getTextSize(a,b).width;if(d>c){for(var e=0,f="",g=b,h=d;h>c;){var i=this.getSubStringInLength(a,g,c);f=f+i+"\n",e+=i.length,g=b.substring(e),h=this.getTextSize(a,g).width}return f+g}return b},drawText:function(a,c,d,e,f,g){c=c||"",c=String(c),e||(e=Ed.FONT);var h="center";g&&(h=g),a.font=e,a.fillStyle=f,a.textAlign=h,a.textBaseline="middle";var i,j,k=c.split("\n"),l=k.length,m=0;d?d.width===b?(i=d.x,j=d.y):(m=d.height/l,"left"==h?i=d.x:"center"==h&&(i=d.x+d.width/2),j=d.y+m/2):(i=0,j=0),Qb.isOpera&&(j-=2);for(var n=0;l>n;n++)"right"==h&&(a.textAlign="left",i=d.x+d.width-Xb.getTextSize(e,k[n]).width),a.fillText(k[n],i,j),j+=m},drawArc:function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o,p,q,r,s;if(Math.abs(e)>2*Math.PI&&(e=2*Math.PI),m=Math.ceil(Math.abs(e)/(Math.PI/4)),i=e/m,j=-i,k=-d,m>0){n=b+Math.cos(d)*f,o=c+Math.sin(-d)*g,h?a.lineTo(n,o):a.moveTo(n,o);for(var t=0;m>t;t++)k+=j,l=k-j/2,p=b+Math.cos(k)*f,q=c+Math.sin(k)*g,r=b+Math.cos(l)*(f/Math.cos(j/2)),s=c+Math.sin(l)*(g/Math.cos(j/2)),a.quadraticCurveTo(r,s,p,q)}},dashedLine:function(a,b,c,d,e,f,g){var h=f-d,i=g-e,j=Math.sqrt(h*h+i*i);if(0!=j){h/=j,i/=j;for(var k=j,l=-c.offset,m=c.drawing,n=c.patternIndex;k>l;)l+=b[n],l>=k&&(c.offset=b[n]-(l-k),c.patternIndex=n,c.drawing=m,l=k),m?a.lineTo(d+l*h,e+l*i):a.moveTo(d+l*h,e+l*i),m=!m,n=(n+1)%b.length}},drawLinePoints:function(a,b,c,d,e){var f,g,h,i,j,k,l=0,m=0,n=b.size();if(k=c&&c.length>0?new uc(a,c[0],c.length>1?c[1]:c[0]):a,d)for(m=0,j=d.size();j>m;m++)if(f=d.get(m),"moveto"===f&&n>l)g=b.get(l++),k.moveTo(g.x,g.y);else if("lineto"===f&&n>l)g=b.get(l++),k.lineTo(g.x,g.y);else if("cubicto"===f&&n-2>l)g=b.get(l++),h=b.get(l++),i=b.get(l++),k.bezierCurveTo(g.x,g.y,h.x,h.y,i.x,i.y);else{if(!("quadto"===f&&n-1>l))throw"Can not resolve segment '"+f+"'";g=b.get(l++),h=b.get(l++),k.quadraticCurveTo(g.x,g.y,h.x,h.y)}else this._drawLine(b,k);e&&k.closePath()},_drawLine:function(a,b){var c,d,e,f,g,h=0,i=a.size();for(c=a.get(0),b.moveTo(c.x,c.y),h=1;i>h;h++)g=a.get(h),g.size?(f=g.size(),2===f?(c=g.get(0),d=g.get(1),b.quadraticCurveTo(c.x,c.y,d.x,d.y)):3===f&&(c=g.get(0),d=g.get(1),e=g.get(2),b.bezierCurveTo(c.x,c.y,d.x,d.y,e.x,e.y))):b.lineTo(g.x,g.y)},drawRoundRect:function(a,b,c,d,e,f,g,h,i){6===arguments.length&&(g=f,h=f,i=f);var j=b+d,k=c+e,l=e>d?2*d:2*e;f=l>f?f:l,g=l>g?g:l,h=l>h?h:l,i=l>i?i:l;var m=.292893218813453*i,n=.585786437626905*i;a.moveTo(j,k-i),a.quadraticCurveTo(j,k-n,j-m,k-m),a.quadraticCurveTo(j-n,k,j-i,k),m=.292893218813453*h,n=.585786437626905*h,a.lineTo(b+h,k),a.quadraticCurveTo(b+n,k,b+m,k-m),a.quadraticCurveTo(b,k-n,b,k-h),m=.292893218813453*f,n=.585786437626905*f,a.lineTo(b,c+f),a.quadraticCurveTo(b,c+n,b+m,c+m),a.quadraticCurveTo(b+n,c,b+f,c),m=.292893218813453*g,n=.585786437626905*g,a.lineTo(j-g,c),a.quadraticCurveTo(j-n,c,j-m,c+m),a.quadraticCurveTo(j,c+n,j,c+g),a.lineTo(j,k-i)},drawVector:function(a,b,c,d,e,f,g){var h;4===arguments.length?(e=d.y,f=d.width,g=d.height,d=d.x):5===arguments.length&&"roundrect"===b&&(h={},h.topLeft=e,h.topRight=e,h.bottomLeft=e,h.bottomRight=e,e=d.y,f=d.width,g=d.height,d=d.x);var i=Xb["_"+b];i&&(a.beginPath(),c&&c.length>0&&(a=new uc(a,c[0],c.length>1?c[1]:c[0])),5===arguments.length&&"roundrect"===b?i(a,{x:d,y:e,width:f,height:g},h):i(a,d,e,f,g))},_rectangle:function(a,b,c,d,e){a.rect(b,c,d,e)},_circle:function(a,b,c,d,e){var f=b+d/2,g=c+e/2,h=Math.min(d,e)/2;a instanceof uc?Xb.drawArc(a,f,g,0,2*Math.PI,h,h,!1):a.arc(f,g,h,0,2*Math.PI,!0)},_oval:function(a,b,c,d,e){if(a instanceof uc)Xb.drawArc(a,b+d/2,c+e/2,0,2*Math.PI,d/2,e/2,!1);else{var f=.5522848,g=d/2*f,h=e/2*f,i=b+d,j=c+e,k=b+d/2,l=c+e/2;a.moveTo(b,l),a.bezierCurveTo(b,l-h,k-g,c,k,c),a.bezierCurveTo(k+g,c,i,l-h,i,l),a.bezierCurveTo(i,l+h,k+g,j,k,j),a.bezierCurveTo(k-g,j,b,l+h,b,l)}},_roundrect:function(a,b,c,d,e){if(3===arguments.length){var f=c;c=b.y,d=b.width,e=b.height,b=b.x,f.topLeft?Xb.drawRoundRect(a,b,c,d,e,f.topLeft):Xb.drawRoundRect(a,b,c,d,e,Math.min(Math.min(d,e)/4,10))}else Xb.drawRoundRect(a,b,c,d,e,Math.min(Math.min(d,e)/4,10))},_star:function(a,b,c,d,e){var f=2*d,g=2*e,h=b+d/2,i=c+e/2;a.moveTo(h-f/4,i-g/12),a.lineTo(b+.306*d,c+.579*e),a.lineTo(h-f/6,i+g/4),a.lineTo(b+d/2,c+.733*e),a.lineTo(h+f/6,i+g/4),a.lineTo(b+.693*d,c+.579*e),a.lineTo(h+f/4,i-g/12),a.lineTo(b+.611*d,c+.332*e),a.lineTo(h+0,i-g/4),a.lineTo(b+.388*d,c+.332*e),a.closePath()},_triangle:function(a,b,c,d,e){a.moveTo(b+d/2,c),a.lineTo(b+d,c+e),a.lineTo(b,c+e),a.closePath()},_hexagon:function(a,b,c,d,e){a.moveTo(b,c+e/2),a.lineTo(b+d/4,c+e),a.lineTo(b+3*d/4,+c+e),a.lineTo(b+d,c+e/2),a.lineTo(b+3*d/4,c),a.lineTo(b+d/4,c),a.closePath()},_pentagon:function(a,b,c,d,e){var f=2*d,g=2*e,h=b+d/2,i=c+e/2;a.moveTo(h-f/4,i-g/12),a.lineTo(h-f/6,i+g/4),a.lineTo(h+f/6,i+g/4),a.lineTo(h+f/4,i-g/12),a.lineTo(h+0,i-g/4),a.closePath()},_trapezoidal:function(a,b,c,d,e){a.moveTo(b+d/4,c),a.lineTo(b,c+e),a.lineTo(b+d,c+e),a.lineTo(b+3*d/4,c),a.closePath()},_diamond:function(a,b,c,d,e){a.moveTo(b+d/2,c),a.lineTo(b,c+e/2),a.lineTo(b+d/2,c+e),a.lineTo(b+d,c+e/2),a.closePath()},fill:function(a,b,c,d,e,f,g,h){var i=Yb[c];a.fillStyle=i?5===arguments.length?i(a,b,d,e.x,e.y,e.width,e.height):i(a,b,d,e,f,g,h):b},createRadialGradient:function(a,b,c,d,e,f,g,h,i){var j=a.createRadialGradient(d+f*h,e+g*i,Math.min(f,g)/24,d+f/2,e+g/2,Math.max(f,g)/2);return j.addColorStop(0,c),j.addColorStop(1,b),j},drawPath:function(a,b,c,d,e,f,g,h){var i=a._element,j=a.getBodyRect();d&&Tb.addPadding(j,i,c+".padding",1);var k=Jb.clone(j),l=i.getStyle(c+".outline.width");l>0&&Tb.grow(k,l/2,l/2);var m=a.setShadow(a,b,k);0!=i.getAngle()&&(i instanceof Nd||(j=i.getOriginalRect()),Ib.Util.rotateCanvas(m,j,i.getAngle()));var n,o=i.getStyle(c+".fill");if(o){n=a._innerColor&&!vc.hasDefault(a._element)?a._innerColor:i.getStyle(c+".fill.color");var p=i.getStyle(c+".gradient");p?Xb.fill(m,n,p,i.getStyle(c+".gradient.color"),j):m.fillStyle=n}var q=i.getStyle(c+".shape"),r=i.getStyle("group.shape.roundrect.radius");return o&&(m.beginPath(),f?Xb.drawLinePoints(m,f,null,g,h):"roundrect"===q&&"group"===c?Xb.drawVector(m,q,null,j,r):Xb.drawVector(m,q,null,j),m.fill()),l>0&&(m.lineWidth=l,m.lineCap=i.getStyle(c+".cap"),m.lineJoin=i.getStyle(c+".join"),m.strokeStyle=i.getStyle(c+".outline.color"),m.beginPath(),f?Xb.drawLinePoints(m,f,e,g,h):"roundrect"===q&&"group"===c?Xb.drawVector(m,q,e,j,r):Xb.drawVector(m,q,e,j),m.stroke()),k},draw3DRect:function(a,b,c,d,e,f,g){if(0!==c){arguments.length<=4&&(g=d.height,f=d.width,e=d.y,d=d.x);var h=c>0;c=Math.abs(c);var i,j;if(a.lineWidth=1,a.lineCap="square",1===c)i=Xb.brighter(b),j=Xb.darker(b),a.strokeStyle=h?i:j,a.beginPath(),a.moveTo(d,e),a.lineTo(d,e+g),a.moveTo(d,e),a.lineTo(d+f,e),a.closePath(),a.stroke(),a.strokeStyle=h?j:i,a.beginPath(),a.moveTo(d,e+g),a.lineTo(d+f,e+g),a.moveTo(d+f,e),a.lineTo(d+f,e+g),a.closePath(),a.stroke();else for(var k=2*c,l=50/k,m=0;k>m;m++)i=Xb.brighter(b,50-m*l),j=Xb.darker(b,50-m*l),d+=.5,e+=.5,f-=1,g-=1,a.strokeStyle=h?i:j,a.beginPath(),a.moveTo(d,e),a.lineTo(d,e+g),a.moveTo(d,e),a.lineTo(d+f,e),a.closePath(),a.stroke(),a.strokeStyle=h?j:i,a.beginPath(),a.moveTo(d,e+g),a.lineTo(d+f,e+g),a.moveTo(d+f,e),a.lineTo(d+f,e+g),a.closePath(),a.stroke()}},brighter:function(a,b){return b||(b=50),Xb.adjustBrightness2(a,b)},darker:function(a,b){return b||(b=50),Xb.adjustBrightness2(a,-b)},adjustBrightness2:function(a,b){var c,d,e;if(0===b)return a;var f=sd(a);return 0>b?(b=(100+b)/100,c=Math.ceil(f.r*b),d=Math.ceil(f.g*b),e=Math.ceil(f.b*b)):(b/=100,c=f.r,d=f.g,e=f.b,c+=(255-c)*b,d+=(255-d)*b,e+=(255-e)*b,c=Math.min(Math.ceil(c),255),d=Math.min(Math.ceil(d),255),e=Math.min(Math.ceil(e),255)),
"rgba("+c+","+d+","+e+",1)"},getColorArray:function(a){return rd.clearRect(0,0,1,1),rd.fillStyle=a,rd.fillRect(0,0,1,1),rd.getImageData(0,0,1,1).data},hit:function(a,b,c,d){if(!a)return!1;var e=a._viewRect;if(!e)return!1;if(b-=e.x,c-=e.y,0>b||0>c||b>=e.width||c>=e.height)return!1;try{for(var f=a.getContext("2d").getImageData(b,c,1,1),g=f.data,h=0,i=g.length;i>h;h+=4)if(0!==g[h+3])return!0}catch(j){return!0}return!1},intersects:function(a,b){if(!a)return!1;if(b=Tb.intersection(b,a._viewRect),!b)return!1;b.x-=a._viewRect.x,b.y-=a._viewRect.y;try{for(var c=a.getContext("2d").getImageData(b.x,b.y,b.width,b.height),d=c.data,e=0,f=d.length;f>e;e+=4)if(0!==d[e+3])return!0}catch(g){}return!1},strokeRect:function(a,b,c,d){b&&(a.beginPath(),a.strokeStyle=c?c:Ib.Util.randomColor(),a.lineWidth=d?d:2,a.strokeRect(b.x,b.y,b.width,b.height),a.stroke())}};Jb.g=Xb;var Yb={"linear.southwest":function(a,b,c,d,e,f,g){var h=a.createLinearGradient(d,e+g,d+f,e);return h.addColorStop(0,c),h.addColorStop(1,b),h},"linear.southeast":function(a,b,c,d,e,f,g){var h=a.createLinearGradient(d+f,e+g,d,e);return h.addColorStop(0,c),h.addColorStop(1,b),h},"linear.northwest":function(a,b,c,d,e,f,g){var h=a.createLinearGradient(d+f,e+g,d,e);return h.addColorStop(0,b),h.addColorStop(1,c),h},"linear.northeast":function(a,b,c,d,e,f,g){var h=a.createLinearGradient(d+f,e,d,e+g);return h.addColorStop(0,c),h.addColorStop(1,b),h},"linear.north":function(a,b,c,d,e,f,g){var h=a.createLinearGradient(d,e,d,e+g);return h.addColorStop(0,c),h.addColorStop(1,b),h},"linear.south":function(a,b,c,d,e,f,g){var h=a.createLinearGradient(d,e,d,e+g);return h.addColorStop(0,b),h.addColorStop(1,c),h},"linear.west":function(a,b,c,d,e,f,g){var h=a.createLinearGradient(d,e,d+f,e);return h.addColorStop(0,c),h.addColorStop(1,b),h},"linear.east":function(a,b,c,d,e,f,g){var h=a.createLinearGradient(d,e,d+f,e);return h.addColorStop(0,b),h.addColorStop(1,c),h},"radial.center":function(a,b,c,d,e,f,g){return Xb.createRadialGradient(a,b,c,d,e,f,g,.5,.5)},"radial.southwest":function(a,b,c,d,e,f,g){return Xb.createRadialGradient(a,b,c,d,e,f,g,.25,.75)},"radial.southeast":function(a,b,c,d,e,f,g){return Xb.createRadialGradient(a,b,c,d,e,f,g,.75,.75)},"radial.northwest":function(a,b,c,d,e,f,g){return Xb.createRadialGradient(a,b,c,d,e,f,g,.25,.25)},"radial.northeast":function(a,b,c,d,e,f,g){return Xb.createRadialGradient(a,b,c,d,e,f,g,.75,.25)},"radial.north":function(a,b,c,d,e,f,g){return Xb.createRadialGradient(a,b,c,d,e,f,g,.5,.25)},"radial.south":function(a,b,c,d,e,f,g){return Xb.createRadialGradient(a,b,c,d,e,f,g,.5,.75)},"radial.west":function(a,b,c,d,e,f,g){return Xb.createRadialGradient(a,b,c,d,e,f,g,.25,.5)},"radial.east":function(a,b,c,d,e,f,g){return Xb.createRadialGradient(a,b,c,d,e,f,g,.75,.5)},"spread.horizontal":function(a,b,c,d,e,f,g){var h=a.createLinearGradient(d,e,d+f,e);return h.addColorStop(0,b),h.addColorStop(.5,c),h.addColorStop(1,b),h},"spread.vertical":function(a,b,c,d,e,f,g){var h=a.createLinearGradient(d,e,d,e+g);return h.addColorStop(0,b),h.addColorStop(.5,c),h.addColorStop(1,b),h},"spread.diagonal":function(a,b,c,d,e,f,g){var h=a.createLinearGradient(d+f,e,d,e+g);return h.addColorStop(0,b),h.addColorStop(.5,c),h.addColorStop(1,b),h},"spread.antidiagonal":function(a,b,c,d,e,f,g){var h=a.createLinearGradient(d,e,d+f,e+g);return h.addColorStop(0,b),h.addColorStop(.5,c),h.addColorStop(1,b),h},"spread.north":function(a,b,c,d,e,f,g){var h=a.createLinearGradient(d,e-g/4,d,e+g+g/4);return h.addColorStop(0,b),h.addColorStop(1/3,c),h.addColorStop(2/3,b),h.addColorStop(1,c),h},"spread.south":function(a,b,c,d,e,f,g){var h=a.createLinearGradient(d,e-g/4,d,e+g+g/4);return h.addColorStop(0,c),h.addColorStop(1/3,b),h.addColorStop(2/3,c),h.addColorStop(1,b),h},"spread.west":function(a,b,c,d,e,f,g){var h=a.createLinearGradient(d-f/4,e,d+f+f/4,e);return h.addColorStop(0,b),h.addColorStop(1/3,c),h.addColorStop(2/3,b),h.addColorStop(1,c),h},"spread.east":function(a,b,c,d,e,f,g){var h=a.createLinearGradient(d-f/4,e,d+f+f/4,e);return h.addColorStop(0,c),h.addColorStop(1/3,b),h.addColorStop(2/3,c),h.addColorStop(1,b),h}};Ib.Util={getVersion:function(){return"5.5.2"},registerImage:function(a,b,c,d,e){Jb.registerImage(a,b,c,d,e)},registerImageByUrl:function(a,b,c,d){if(b&&a&&a.indexOf(".json")>0){var e=new XMLHttpRequest;e.onreadystatechange=function(){if(4===e.readyState&&200===e.status){var a=JSON.parse(e.responseText);Ib.Util.registerImage(b,a),c&&c.invalidateElementUIs(),d&&d()}},e.open("GET",a,!0),e.send()}else{var f=new Pb;f.src=a,f.onload=function(){Ib.Util.registerImage(b,f,f.width,f.height),f.onload=null,c&&c.invalidateElementUIs(),d&&d()}}},getRegisteredImageNames:function(){return Jb.getRegisteredImageNames()},unregisterImage:function(a){Jb.unregisterImage(a)},getImageAsset:function(a){return Jb.getImageAsset(a)},validateLicense:function(a){Jb.validateLicense(a)},getLicense:function(){return Kb},isPermissionGIS:function(){return tc()},moveElements:function(a,b,c,d,e){if((0!==b||0!==c)&&a&&!a.isEmpty()){var f,g,h=Ib.animate.AnimateManager;h.endAnimate(),a=vc.filterMovingElements(a),d&&(f=new nd,g=new nd),a.forEach(function(a){a instanceof Ld&&(d?(f.add(a),g.add({x:a.getX()+b,y:a.getY()+c})):a.translate(b,c))}),d?h.start(new Ib.animate.AnimateLocation(f,g,e)):e&&e()}},isTypeOf:function(a,b){if(a===b)return!0;for(var c=a.superClass;c;){if(c===b.prototype)return!0;c=c.constructor.superClass}return!1},setFocus:function(a){if(Ob.activeElement!==a){var b,c,d,e=Ob.documentElement,f=Ob.body;e&&(Qb.isIE||Qb.isOpera||e.scrollLeft||e.scrollTop)?(b=e.scrollLeft,c=e.scrollTop,d=e):f&&(b=f.scrollLeft,c=f.scrollTop,d=f),a.focus(),d&&(d.scrollLeft=b,d.scrollTop=c)}},isOpera:Qb.isOpera,isIE:Qb.isIE,isFirefox:Qb.isFirefox,isChrome:Qb.isChrome,isSafari:Qb.isSafari,isIPhone:Qb.isIPhone,isIPod:Qb.isIPod,isIPad:Qb.isIPad,isAndroid:Qb.isAndroid,isWebOS:Qb.isWebOS,isTouchable:Qb.isTouchable,ext:function(a,b,c){Jb.ext(a,b,c)},getValue:function(a,b,c){return Jb.getValue(a,b,c)},setValue:function(a,b,c){Jb.setValue(a,b,c)},grow:function(a,b,c){Tb.grow(a,b,c)},containsPoint:function(a,b,c){return Tb.containsPoint.apply(null,arguments)},intersects:function(a,b){return Tb.intersects(a,b)},getRect:function(a){return Tb.getRect(a)},unionRect:function(a,b){return Tb.unionRect(a,b)},createDiv:function(){return Wb.createDiv()},createCanvas:function(){return Wb.createCanvas()},setCanvas:function(a,b,c,d,e){return Wb.setCanvas.apply(null,arguments)},drawVector:function(a,b,c,d,e,f,g){Xb.drawVector.apply(null,arguments)},fill:function(a,b,c,d,e,f,g,h){Xb.fill.apply(null,arguments)},getClass:function(a){return Jb.getClass(a)},getAllClassNames:function(){var a,b=[];for(a in Jb.classCache)b.push(a);return b},newInstance:function(a){return Jb.newInstance.apply(null,arguments)},isDeserializing:function(){return Jb.isDeserializing},addEventListener:function(a,b,c,d){Wb.addEventListener(a,b,c,d)},removeEventListener:function(a,b,c){Wb.removeEventListener(a,b,c)},drawArrow:function(a,b,c,d,e,f,g,h,i,j,k,l,m){od.drawArrow.apply(null,arguments)},calculatePointAngleAlongLine:function(a,b,c,d,e){return Tb.calculatePointInfoAlongLineBySegments(a,b,c,d,e)},getSubNetwork:function(a){return vc.getSubNetwork(a)},transformPoint:function(a,b,c,d){return Tb.transformPoint(a,b,c,d)},getToolTipDiv:function(){return Bc.getToolTipDiv()},showToolTip:function(a,b){Bc.showToolTip(a,b)},hideToolTip:function(){Bc.hideToolTip()},resetToolTip:function(){Bc.resetToolTip()},setCSSStyle:function(a,b,c){Wb.setCSSStyle(a,b,c)},removeCSSStyle:function(a,b){Wb.removeCSSStyle(a,b)},getCSSStyle:function(a,b){return Wb.getCSSStyle(a,b)},toDegrees:function(a){return Tb.toDegrees(a)},toRadians:function(a){return Tb.toDegrees(a)},getRadiansBetweenLines:function(a,b){return Tb.getRadiansBetweenLines(a,b)},getElementsBounds:function(a,b){var c=null;return a.forEach(function(a){if(a.getRect){var d,e;b&&(e=b.getElementUI(a),e&&(d=e.getViewRect())),d||(d=a.getRect()),c=c?Ib.Util.unionRect(c,d):d}}),c},getPointIndex:function(a,b,c){if(c||(c=10),a)for(var d=a.size();d--;d>=0)if(Tb.getDistance(a.get(d),b)<=c)return d;return-1},registerVectorShape:function(a,b){Jb.g["_"+a]=b},rotateCanvas:function(a,b,c){a.translate(b.x+b.width/2,b.y+b.height/2),a.rotate(c*Math.PI/180),a.translate(-(b.x+b.width/2),-(b.y+b.height/2))},registerShape:function(a,b){fd(a,b)},registerDraw:function(a,b){ed(a,b)},getFilterColor:function(a,b){return td(a,b)},registerGifImage:function(a,b){},parseVectorData:function(a){return Ec(a)},getSharedLinks:function(a,b){var c=a.getLinks(),d=b.getLinks();if(c&&0!=c.size()&&d&&0!=d.size()){var e=c.size()>d.size()?c:d;return e.toList(function(c){return c.getFromNode()==a&&c.getToNode()==b||c.getFromNode()==b&&c.getToNode()==a})}return null},isSharedLinks:function(a,b){var c=!1,d=a.getLinks(),e=b.getLinks();if(d&&0!=d.size()&&e&&0!=e.size()){var f=d.size()>e.size()?d:e;f.forEach(function(d){return d.getFromNode()==a&&d.getToNode()==b||d.getFromNode()==b&&d.getToNode()==a?(c=!0,!1):!0})}return c},playAnimate:function(a){return yb(a)},pauseAnimate:function(a){a.pause()},resumeAnimate:function(a){a.resume()},stopAnimate:function(a,b){zb(a,b)},pauseAllAnimates:function(){Bb()},resumeAllAnimates:function(){Cb()},stopAllAnimates:function(a){Ab(a)},randomColor:function(){return"#"+("00000"+(16777216*this.random()<<0).toString(16)).substr(-6)},random:function(){return Math.random()},getHSVColor:function(a,c,d){var e,f,g,h,i,j,k,l;switch(a&&c===b&&d===b&&(c=a.s,d=a.v,a=a.h),h=Math.floor(6*a),i=6*a-h,j=d*(1-c),k=d*(1-i*c),l=d*(1-(1-i)*c),h%6){case 0:e=d,f=l,g=j;break;case 1:e=k,f=d,g=j;break;case 2:e=j,f=d,g=l;break;case 3:e=j,f=k,g=d;break;case 4:e=l,f=j,g=d;break;case 5:e=d,f=j,g=k}var m="#"+toHex(255*e)+toHex(255*f)+toHex(255*g);return m},toHex:function(a){var b=parseInt(a).toString(16);return 1==b.length&&(b="0"+b),b},makeHighRes:function(b){var c=b.getContext("2d"),d=a.devicePixelRatio||1,e=c.webkitBackingStorePixelRatio||c.mozBackingStorePixelRatio||c.msBackingStorePixelRatio||c.oBackingStorePixelRatio||c.backingStorePixelRatio||1,f=d/e;if(d!==e){var g=b.width,h=b.height;b.width=Math.round(g*f),b.height=Math.round(h*f),b.style.width=g+"px",b.style.height=h+"px",c.scale(f,f)}},newFunction:function(){var a=arguments,b=a.length;return 1===b?Jb.newInstance("Function",a[0]):2===b?Jb.newInstance("Function",a[0],a[1]):3===b?Jb.newInstance("Function",a[0],a[1],a[2]):4===b?Jb.newInstance("Function",a[0],a[1],a[2],a[3]):5===b?Jb.newInstance("Function",a[0],a[1],a[2],a[3],a[4]):6===b?Jb.newInstance("Function",a[0],a[1],a[2],a[3],a[4],a[5]):7===b?Jb.newInstance("Function",a[0],a[1],a[2],a[3],a[4],a[5],a[6]):8===b?Jb.newInstance("Function",a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7]):null}},Jb.ext("twaver.Util",Object,{});var Zb,$b=0xdeadbeefcafe,_b=15715070==(16777215&$b);_b&&"Microsoft Internet Explorer"==Nb.appName?(c.prototype.am=f,Zb=30):_b&&"Netscape"!=Nb.appName?(c.prototype.am=e,Zb=26):(c.prototype.am=g,Zb=28),c.prototype.DB=Zb,c.prototype.DM=(1<<Zb)-1,c.prototype.DV=1<<Zb;var ac=52;c.prototype.FV=Math.pow(2,ac),c.prototype.F1=ac-Zb,c.prototype.F2=2*Zb-ac;var bc,cc,dc="0123456789abcdefghijklmnopqrstuvwxyz",ec=new Array;for(bc="0".charCodeAt(0),cc=0;9>=cc;++cc)ec[bc++]=cc;for(bc="a".charCodeAt(0),cc=10;36>cc;++cc)ec[bc++]=cc;for(bc="A".charCodeAt(0),cc=10;36>cc;++cc)ec[bc++]=cc;E.prototype.convert=F,E.prototype.revert=G,E.prototype.reduce=H,E.prototype.mulTo=I,E.prototype.sqrTo=J,L.prototype.convert=M,L.prototype.revert=N,L.prototype.reduce=O,L.prototype.mulTo=Q,L.prototype.sqrTo=P,c.prototype.copyTo=k,c.prototype.fromInt=l,c.prototype.fromString=n,c.prototype.clamp=o,c.prototype.dlShiftTo=v,c.prototype.drShiftTo=w,c.prototype.lShiftTo=x,c.prototype.rShiftTo=y,c.prototype.subTo=z,c.prototype.multiplyTo=A,c.prototype.squareTo=B,c.prototype.divRemTo=C,c.prototype.invDigit=K,c.prototype.isEven=R,c.prototype.exp=S,c.prototype.toString=p,c.prototype.negate=q,c.prototype.abs=r,c.prototype.compareTo=s,c.prototype.bitLength=u,c.prototype.mod=D,c.prototype.modPowInt=T,c.ZERO=m(0),c.ONE=m(1),Ka.prototype.convert=La,Ka.prototype.revert=La,Ka.prototype.mulTo=Ma,Ka.prototype.sqrTo=Na,Ra.prototype.convert=Sa,Ra.prototype.revert=Ta,Ra.prototype.reduce=Ua,Ra.prototype.mulTo=Wa,Ra.prototype.sqrTo=Va;var fc=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],gc=(1<<26)/fc[fc.length-1];c.prototype.chunkSize=Y,c.prototype.toRadix=$,c.prototype.fromRadix=_,c.prototype.fromNumber=aa,c.prototype.bitwiseTo=fa,c.prototype.changeBit=wa,c.prototype.addTo=Aa,c.prototype.dMultiply=Ia,c.prototype.dAddOffset=Ja,c.prototype.multiplyLowerTo=Pa,c.prototype.multiplyUpperTo=Qa,c.prototype.modInt=Za,c.prototype.millerRabin=ab,c.prototype.clone=U,c.prototype.intValue=V,c.prototype.byteValue=W,c.prototype.shortValue=X,c.prototype.signum=Z,c.prototype.toByteArray=ba,c.prototype.equals=ca,c.prototype.min=da,c.prototype.max=ea,c.prototype.and=ha,c.prototype.or=ja,c.prototype.xor=la,c.prototype.andNot=na,c.prototype.not=oa,c.prototype.shiftLeft=pa,c.prototype.shiftRight=qa,c.prototype.getLowestSetBit=sa,c.prototype.bitCount=ua,c.prototype.testBit=va,c.prototype.setBit=xa,c.prototype.clearBit=ya,c.prototype.flipBit=za,c.prototype.add=Ba,c.prototype.subtract=Ca,c.prototype.multiply=Da,c.prototype.divide=Fa,c.prototype.remainder=Ga,c.prototype.divideAndRemainder=Ha,c.prototype.modPow=Xa,c.prototype.modInverse=$a,c.prototype.pow=Oa,c.prototype.gcd=Ya,c.prototype.isProbablePrime=_a,c.prototype.square=Ea,bb.prototype.init=cb,bb.prototype.next=db;var hc,ic,jc,kc=256;if(null==ic){ic=new Array,jc=0;var lc;if("Netscape"==Nb.appName&&Nb.appVersion<"5"&&a.crypto){var mc=a.crypto.random(32);for(lc=0;lc<mc.length;++lc)ic[jc++]=255&mc.charCodeAt(lc)}for(;kc>jc;)lc=Math.floor(65536*Ib.Util.random()),ic[jc++]=lc>>>8,ic[jc++]=255&lc;jc=0,gb()}jb.prototype.nextBytes=ib,mb.prototype.doPublic=ob,mb.prototype.setPublic=nb,mb.prototype.encrypt=pb,mb.prototype.doPrivate=tb,mb.prototype.setPrivate=rb,mb.prototype.setPrivateEx=sb,mb.prototype.decrypt=ub;var nc=function(){oc.v(Kb)},oc={},pc="6a384c1259bdb5e731ec96b3174683f48a2c56a85e52e7a5bb20b58711ce50c1a294bd5e1d1752e766085e9ae94bae6d217c25dbb5fcdb86a8a9a7e180fa066723d00fcb85fcf7c9d29f8cc8859f53244a49c0bc30dcc45156daf8843ce1d24fe8ebc9a3c186bb26e9d0714041aef160304c1db8cc5728cf4acb39d29755f319",qc="10001";oc.cross=function(a){if(a){for(var b="",c=0;c<a.length;)c+1<a.length?(b+=a[c+1],b+=a[c]):b+=a[c],c+=2;return b}return null},oc.reverse=function(a){if(a){for(var b="",c=a.length;c>0;c--)b+=a[c-1];return b}return null},oc.v=function(a){if(a){var b=oc;if(b.start=null,b.beginDate=null,b.end=null,b.endDate=null,b.gis=null,b["3D"]=null,b["3d"]=null,b.l=null,b.__li__=null,a.indexOf("signature=")>0){var c=a.split("signature="),d=c[0],e=c[1],f=new mb;f.setPublic(pc,qc);for(var g=e,h=g.length,i=256,j=0,k="",l="";h>j;)k=g.substr(j,i),l+=f.decrypt(k),j+=i;if(l===d)return b.i(a),!0}}return!1},oc.i=function(a){var c=oc;c.__li__=a;var d,e,f,g,h,i=a.split("\n");for(d=i.length-1;d>=0;d--)e=i[d],h=e.split("="),f=h[0],g=h[1],c[f]=g;c.start!=b&&(c.beginDate=new Date(Date.parse(c.start.replace(/-/g,"/")))),c.end!=b&&(c.endDate=new Date(Date.parse(c.end.replace(/-/g,"/"))));var j=c.gis;j!=b&&(j=parseInt(j)),j&&(c._isPermissionGIS=!0);var k=c["3D"]||c["3d"];k!=b&&(k=parseInt(k)),k&&(c._isPermission3D=!0),c["3D"]&&(c._isPermission3D=!0),c.l!=b&&(c.version=c.l)};var rc=function(a){return a.__li__!==b&&!a._isPermission3D},sc=function(a){if(!rc(a))return!0;var b=new Date;return null!=a.beginDate&&a.beginDate.getTime()-b.getTime()>=0||null!=a.endDate&&a.endDate.getTime()-b.getTime()<=0},tc=function(){return sc(oc)?!1:oc._isPermissionGIS};oc.$z=function(a){var b=new mb;b.setPublic(pc,qc);for(var c=a,d=c.length,e=256,f=0,g="",h="";d>f;)g=c.substr(f,e),h+=b.decrypt(g),f+=e;return h},oc.twm=function(a){var c=oc,d=c.$z("4cd18113d0c7046bfe51f7a3fbd41c2b7cf14dd785d6ea7cec9da17710d3acfb8ce0cb9cf10839f4bd51e88819de19cdc0db09278584396156fcb65abe0353ac49d01326b30efa0ea98a07da9f8ceeb7572fc1b37b5965ba6103ccba4913b62e36e49425c6ff21a2f008830c59cff8f29058769f858c8a9f0bab3eaea7fb8a9e"),e=this.type,f=this.markText,g=c.$z("648be38cd61c870e95ffc1ea0676af40736c1365015abc326e891a4de67b4de3d4b05da70b9aebedc83ec26ecf71eb74c72f42f6d9a4be2d507d2f67d2860b7b66e3ba1d565e15923f2db335ff922eef17c01b59818b583d5656412d6cc9d9ba70001c2c88e3efd492c6b13a07fda5f325b333138a2036f4696542ec137cc341");if(a[g]=c.__li__,"3"!==e||sc(oc)||f!==b){a.__liLabel==b&&(a.__liLabel=Ob.createElement("div")),c.startDate===b&&(c.startDate=new Date);var h=(new Date).getTime()-c.startDate.getTime();if(!(3e5>h)){var i=sc(c)&&h>3e5,j=f;if(i?j=c.$z("0dd629dbd0ce341ecdd447e35ddc3135a0b46916f7571a687f38ae665cf0ae095fee885e14329caa75112d8787508da17285b0897845d8ccae73e6a2727dd19f1ca335fe139d0e60d240f9ececc78f81c2c5667f51aeed4135b9c4bb436b8acb7cd418eeeb404bc4f3bcdedb481ac0edff7644435ce2b9f2bda78c892bd56d73"):"2"!=e||j!==b&&""!=j?"1"!=e||f||(j=d):j=c.$z("644d54bf9c59afbd8a742a9e7e2731f23f149ccb7f04c3547548c50ac2d77faea108b55f1f6261e99869f1c06b84e8abdefdf45b5170048531421f3d528123972ba2f03d70f37c33f1341dc12f986e0089e42bab517e2a05b455d12d90991bbba9bc45c715a81943062ea5fa5408c8b1b9270d260cc5a67b38ecc4178ce512fc"),j!==b){var k=a,l=k.__liLabel;if(l.innerHTML=j,k._rootCanvas)l.type=e,l.mark=f,l.expired=i,k._xyz=l;else{var m=0,n=0;l.style.position="absolute";var o=k.getView().style;f!=b&&null!=f&&""!=f||"2"==e?(m=10-k.getView().scrollLeft,n=10-k.getView().scrollTop):(m=o.width.replace("px","")/2-50-k.getView().scrollLeft,n=o.height.replace("px","")/2-k.getView().scrollTop),l.style.right=m+"px",l.style.bottom=n+"px",l.style.fontSize="120%",i&&(k.getView().style.opacity=.1,l.style.color="red",l.style.fontSize="150%"),k.getView().appendChild(l)}}}}},Jb.validateLicense(Kb);var uc=function(a,b,c){this.g=a,this.onLength=b,this.offLength=c,this.isLine=!0,this.overflow=0,this.dashLength=b+c,this.pen={x:0,y:0}};Jb.ext(uc,Object,{_curveaccuracy:6,moveTo:function(a,b){this.pen={x:a,y:b},this.g.moveTo(a,b),this.start||(this.start={x:a,y:b})},lineTo:function(a,b){var c=a-this.pen.x,d=b-this.pen.y,e=Math.atan2(d,c),f=Math.cos(e),g=Math.sin(e),h=this.lineLength(this.pen.x,this.pen.y,a,b);if(this.overflow){if(this.overflow>h)return this.isLine?this._lineTo(a,b):this.moveTo(a,b),void(this.overflow-=h);if(this.isLine?this._lineTo(this.pen.x+f*this.overflow,this.pen.y+g*this.overflow):this.moveTo(this.pen.x+f*this.overflow,this.pen.y+g*this.overflow),h-=this.overflow,this.overflow=0,this.isLine=!this.isLine,!h)return}var i=Math.floor(h/this.dashLength);if(i){for(var j=f*this.onLength,k=g*this.onLength,l=f*this.offLength,m=g*this.offLength,n=0;i>n;n++)this.isLine?(this._lineTo(this.pen.x+j,this.pen.y+k),this.moveTo(this.pen.x+l,this.pen.y+m)):(this.moveTo(this.pen.x+l,this.pen.y+m),this._lineTo(this.pen.x+j,this.pen.y+k));h-=this.dashLength*i}this.isLine?h>this.onLength?(this._lineTo(this.pen.x+f*this.onLength,this.pen.y+g*this.onLength),this.moveTo(a,b),this.overflow=this.offLength-(h-this.onLength),this.isLine=!1):(this._lineTo(a,b),h==this.onLength?(this.overflow=0,this.isLine=!this.isLine):(this.overflow=this.onLength-h,this.moveTo(a,b))):h>this.offLength?(this.moveTo(this.pen.x+f*this.offLength,this.pen.y+g*this.offLength),this._lineTo(a,b),this.overflow=this.onLength-(h-this.offLength),this.isLine=!0):(this.moveTo(a,b),h==this.offLength?(this.overflow=0,this.isLine=!this.isLine):this.overflow=this.offLength-h)},quadraticCurveTo:function(a,b,c,d){var e,f=this.pen.x,g=this.pen.y,h=this.curveLength(f,g,a,b,c,d),i=0,j=0;if(this.overflow){if(this.overflow>h)return this.isLine?this._curveTo(a,b,c,d):this.moveTo(c,d),void(this.overflow-=h);if(i=this.overflow/h,e=this.curveSliceUpTo(f,g,a,b,c,d,i),this.isLine?this._curveTo(e[2],e[3],e[4],e[5]):this.moveTo(e[4],e[5]),this.overflow=0,this.isLine=!this.isLine,!h)return}var k=h-h*i,l=Math.floor(k/this.dashLength),m=this.onLength/h,n=this.offLength/h;if(l)for(var o=0;l>o;o++)this.isLine?(j=i+m,e=this.curveSlice(f,g,a,b,c,d,i,j),this._curveTo(e[2],e[3],e[4],e[5]),i=j,j=i+n,e=this.curveSlice(f,g,a,b,c,d,i,j),this.moveTo(e[4],e[5])):(j=i+n,e=this.curveSlice(f,g,a,b,c,d,i,j),this.moveTo(e[4],e[5]),i=j,j=i+m,e=this.curveSlice(f,g,a,b,c,d,i,j),this._curveTo(e[2],e[3],e[4],e[5])),i=j;k=h-h*i,this.isLine?k>this.onLength?(j=i+m,e=this.curveSlice(f,g,a,b,c,d,i,j),this._curveTo(e[2],e[3],e[4],e[5]),this.moveTo(c,d),this.overflow=this.offLength-(k-this.onLength),this.isLine=!1):(e=this.curveSliceFrom(f,g,a,b,c,d,i),this._curveTo(e[2],e[3],e[4],e[5]),h==this.onLength?(this.overflow=0,this.isLine=!this.isLine):(this.overflow=this.onLength-k,this.moveTo(c,d))):k>this.offLength?(j=i+n,e=this.curveSlice(f,g,a,b,c,d,i,j),this.moveTo(e[4],e[5]),e=this.curveSliceFrom(f,g,a,b,c,d,j),this._curveTo(e[2],e[3],e[4],e[5]),this.overflow=this.onLength-(k-this.offLength),this.isLine=!0):(this.moveTo(c,d),k==this.offLength?(this.overflow=0,this.isLine=!this.isLine):this.overflow=this.offLength-k)},bezierCurveTo:function(a,b,c,d,e,f){this.pen={x:e,y:f};var g=[this.onLength,this.offLength];this.g.setLineDash&&this.g.setLineDash(g),this.g.lineDash=g,this.g.bezierCurveTo(a,b,c,d,e,f)},rect:function(a,b,c,d){this.pen={x:a,y:b},this.moveTo(a,b),this.lineTo(a,b+d),this.lineTo(a+c,b+d),this.lineTo(a+c,b),this.lineTo(a,b)},closePath:function(){this.lineTo(this.start.x,this.start.y)},lineLength:function(a,b,c,d){var e=c-a,f=d-b;return Math.sqrt(e*e+f*f)},curveLength:function(a,b,c,d,e,f,g){for(var h,i,j,k,l,m,n,o=0,p=a,q=b,r=g>0?g:this._curveaccuracy,s=1;r>=s;s++)j=s/r,k=1-j,l=k*k,m=2*j*k,n=j*j,h=l*a+m*c+n*e,i=l*b+m*d+n*f,o+=this.lineLength(p,q,h,i),p=h,q=i;return o},curveSlice:function(a,b,c,d,e,f,g,h){if(0==g)return this.curveSliceUpTo(a,b,c,d,e,f,h);if(1==h)return this.curveSliceFrom(a,b,c,d,e,f,g);var i=this.curveSliceUpTo(a,b,c,d,e,f,h);return i.push(g/h),this.curveSliceFrom.apply(this,i)},curveSliceUpTo:function(a,b,c,d,e,f,g){if(1!=g){var h=c+(e-c)*g,i=d+(f-d)*g;c=a+(c-a)*g,d=b+(d-b)*g,e=c+(h-c)*g,f=d+(i-d)*g}return[a,b,c,d,e,f]},curveSliceFrom:function(a,b,c,d,e,f,g){if(1!=g){var h=a+(c-a)*g,i=b+(d-b)*g;c+=(e-c)*g,d+=(f-d)*g,a=h+(c-h)*g,b=i+(d-i)*g}return[a,b,c,d,e,f]},_lineTo:function(a,b){(a!=this.pen.x||b!=this.pen.y)&&(this.pen={x:a,y:b},this.g.lineTo(a,b))},_curveTo:function(a,b,c,d){(a!=c||b!=d||c!=this.pen.x||d!=this.pen.y)&&(this.pen={x:c,y:d},this.g.quadraticCurveTo(a,b,c,d))}}),Jb.DashedLine=uc;var vc={DEFAULTS:{"default":1,"default.vector":1,"vector.default":1},VECTORS:{vector:1,"default.vector":1,"vector.default":1},hasDefault:function(a){if(a instanceof Ld){var b=a.getStyle("body.type");return 1===vc.DEFAULTS[b]}return!0},hasVector:function(a){if(a instanceof Ld){var b=a.getStyle("body.type");return 1===vc.VECTORS[b]}return!1},hasAgentLinks:function(a){for(var b=a.getChildrenSize(),c=0;b>c;c++){var d=a.getChildAt(c);if(d instanceof Ld&&vc.hasAgentLinks(d))return!0}return a.hasAgentLinks()},getParents:function(a,b,c){c||(c=!0);for(var d=new nd,e=a._parent;null!=e&&e!==b;)d.add(e,0),e=e._parent;return c&&null!=e&&e===b&&d.add(e,0),d},getSubNetwork:function(a){if(!a)return null;if(a instanceof Ib.Link){var b=a._fromAgent,c=a._toAgent;if(!b||!c)return null;var d=vc.getSubNetwork(b),e=vc.getSubNetwork(c);return d===e?d:null}var f=a._parent;if(!f)return null;for(;f instanceof Ib.Link&&!f.ISubNetwork;)f=f._parent;return f.ISubNetwork?f:vc.getSubNetwork(f)},figureSameSubNetworkAgent:function(a){if(!a)return null;for(var b=a._parent;b instanceof Nd;){if(!(b._parent instanceof Nd))return b.isExpanded()?a:b;b.isExpanded()||(a=b),b=b._parent}return a},figureSpanSubNetworkAgent:function(a,b){if(!a||!b)return null;var c=vc.getSubNetwork(a),d=vc.getSubNetwork(b);if(c!=d){for(;null!=d&&c!=d;)d=vc.getSubNetwork(d);if(c===d)return a;var e=new nd;e.add(a,0);for(var f=a._parent;f instanceof Ld&&!b.isDescendantOf(f);)e.add(f,0),f=f._parent;for(var g=e.size(),h=0;g>h;h++){var i=e.get(h);if(i instanceof Nd&&!i.isExpanded())return i;if(i.ISubNetwork)return i}return a}return a},figureFromAgent:function(a){if(a.isLooped())return a.getFromNode();var b=vc.figureSameSubNetworkAgent(a.getFromNode()),c=vc.figureSameSubNetworkAgent(a.getToNode());return b===c?a.getFromNode():vc.figureSpanSubNetworkAgent(b,c)},figureToAgent:function(a){if(a.isLooped())return a.getToNode();var b=vc.figureSameSubNetworkAgent(a.getFromNode()),c=vc.figureSameSubNetworkAgent(a.getToNode());return b===c?a.getToNode():vc.figureSpanSubNetworkAgent(c,b)},getBundleLinks:function(a,b){if(!a||!b)return null;var c,d,e,f;if(a===b){if(f=a.getLoopedLinks(),!f)return null;f=new nd(f)}else{var g=a.getAgentLinks(),h=b.getAgentLinks();if(!g||!h)return null;for(d=g.size(),c=0;d>c;c++)e=g.get(c),h.contains(e)&&(f||(f=new nd),f.add(e))}if(null!=f)for(c=0;c<f.size();c++)e=f.get(c),e.getStyle("link.bundle.enable")||(e._setBundleLinks(null),f.removeAt(c),c--);return f},resetBundleLinks:function(a,b){var c=vc.getBundleLinks(a,b);if(c&&0!==c.size()){var d=null;if(1===c.size())return d=c.get(0),void d._setBundleLinks(null);var e,f,g=new nd;for(e=0;e<c.size();e++)d=c.get(e),f=d.getStyle("link.bundle.id"),g.indexOf(f)<0&&g.add(f);g.sort();var h,i,j=new nd;for(i=0;i<g.size();i++){f=g.get(i);var k=new nd;for(e=0;e<c.size();e++)d=c.get(e),f===d.getStyle("link.bundle.id")&&k.add(d);h=new Ib.BundleLinks(k,j),j.add(h)}for(i=0;i<j.size();i++)for(h=j.get(i),e=0;e<h.getLinks().size();e++)d=h.getLinks().get(e),d._setBundleLinks(h)}},moveElements:function(a,b,c,d){for(var e=vc.filterMovingElements(a,d),f=e.size(),g=0;f>g;g++)e.get(g).translate(b,c)},filterMovingElements:function(a,b){for(var c=new nd,d=a.size(),e=0;d>e;e++){var f=a.get(e);if(f instanceof Ld&&(!b||b(f))){for(var g=!0,h=c.toArray(),i=0;i<h.length;i++){var j=h[i];g&&j instanceof Ib.Follower&&f instanceof Ib.Follower&&f.isLoopedHostOn(j)?g=!1:j instanceof Ib.Follower&&j.isHostOn(f)?c.remove(j):g&&f instanceof Ib.Follower&&j instanceof Ld&&f.isHostOn(j)?g=!1:vc.isDescendantOfGroup(j,f)?c.remove(j):g&&vc.isDescendantOfGroup(f,j)&&(g=!1)}g&&c.add(f)}}return c},isDescendantOfGroup:function(a,b){if(!(a&&b instanceof Nd))return!1;if(!b.hasChildren())return!1;for(a=a._parent;a instanceof Nd;){if(a===b)return!0;a=a._parent}return!1}};Jb.element=vc;var wc={between:function(a,b,c){return c>=a&&b>=c?!0:c>=b&&a>=c?!0:!1},considerEast:function(a,b,c){return b?wc.between(b.x,c.x,a.x)?c.x>b.x:Math.abs(b.x-a.x)>Math.abs(c.x-a.x):!0},considerWest:function(a,b,c){return b?wc.between(b.x,c.x,a.x)?c.x<b.x:Math.abs(b.x-a.x)>Math.abs(c.x-a.x):!0},considerNorth:function(a,b,c){return b?wc.between(b.y,c.y,a.y)?c.y<b.y:Math.abs(b.y-a.y)>Math.abs(c.y-a.y):!0},considerSouth:function(a,b,c){return b?wc.between(b.y,c.y,a.y)?c.y>b.y:Math.abs(b.y-a.y)>Math.abs(c.y-a.y):!0},getHorizontalPoint:function(a,b,c){return wc.between(b.x,c.x,a.x)?{x:a.x,y:b.y}:Math.abs(a.x-b.x)<Math.abs(a.x-c.x)?{x:b.x,y:b.y}:{x:c.x,y:c.y}},getVerticalPoint:function(a,b,c){return wc.between(b.y,c.y,a.y)?{x:b.x,y:a.y}:Math.abs(a.y-b.y)<Math.abs(a.y-c.y)?{x:b.x,y:b.y}:{x:c.x,y:c.y}},getPoint:function(a,b,c,d,e){var f=Math.abs(d.x-c.x)>Math.abs(d.y-c.y);if("south"===e)return f&&wc.considerSouth(b,a,c)?wc.getHorizontalPoint(b,c,d):null;if("north"===e)return f&&wc.considerNorth(b,a,c)?wc.getHorizontalPoint(b,c,d):null;if("west"===e)return!f&&wc.considerWest(b,a,c)?wc.getVerticalPoint(b,c,d):null;if("east"===e)return!f&&wc.considerEast(b,a,c)?wc.getVerticalPoint(b,c,d):null;if("nearby"===e){var g;return g=f?wc.getHorizontalPoint(b,c,d):wc.getVerticalPoint(b,c,d),!a||Tb.getDistance(a,b)>Tb.getDistance(g,b)?g:null}return null},getBusPoint:function(a,b,c){var d,e=a.size();if(e>0){for(var f=a.get(0),g=1;e>g;g++){var h=a.get(g),i=wc.getPoint(d,b,f,h,c);i&&(d=i),f=h}d||(d={x:f.x,y:f.y})}return d}};Jb.bus=wc;var xc={createFromPoint:function(a,b){var c=a._element;if(!c.getFromAgent())return{x:0,y:0};var d,e=c.getStyle("link.from.position"),f=c.getStyle("link.from.xoffset"),g=c.getStyle("link.from.yoffset"),h=c.getStyle("link.from.percent");if(h&&h instanceof Array&&2===h.length&&h[0]<=1&&h[0]>=0&&h[1]<=1&&h[1]>=0){var i=c.getFromAgent(),j=i.getSize(),k=i.getRect().x+j.width*h[0],l=i.getRect().y+j.height*h[1];return{x:k,y:l}}if(a._network._edgeDetect){var i=c.getFromAgent(),m=c.getToAgent(),n=i.getImage(),o=Jb.images[n],p=i.getCenterLocation(),q=m.getCenterLocation(),r=this._getPointAngleDegree(q.x,q.y,p.x,p.y),s={x:0,y:0};if(o){var t=o._image;if(t&&cd(t)||t&&Ib.Util.getImageAsset(n)._cache)return cd(t)?o._edgeData||(o._edgeData=o._createEdgeData(t,i._width,i._height)):"object"==typeof t&&(o._edgeData||(o._edgeData=o._createEdgeData(Ib.Util.getImageAsset(n)._cache,i.getWidth(),i.getHeight()))),s.x=o._edgeData[r].x+i.getRect().x,s.y=o._edgeData[r].y+i.getRect().y,s}}if(!Jb.isCalculatingBus){if(Jb.isCalculatingBus=!0,c.getFromAgent()instanceof Ib.Bus){var u=c.getFromAgent();if(vc.hasVector(u)){var v=b?b._getElementZoomRect(a,u.getRect()):u.getRect(),w=u.getStyle("vector.shape");if("oval"===w)d=Tb.getEllipsePoint(v,xc.createToPoint(a));else if("circle"===w)d=Tb.getEllipsePoint(Tb.getCircleRect(v),xc.createToPoint(a));else if("rectangle"===w||"roundrect"===w){var x=new nd;x.add({x:u.x,y:u.y}),x.add({x:u.x+u.width,y:u.y}),x.add({x:u.x+u.width,y:u.y+u.height}),x.add({x:u.x,y:u.y+u.height}),x.add({x:u.x,y:u.y}),x=b?b._getShapeNodeZoomPoints(a,x):x,d=wc.getBusPoint(x,xc.createToPoint(a),u.getStyle("bus.style"))}}else{var x=b?b._getShapeNodeZoomPoints(a,u.getPoints()):u.getPoints();d=wc.getBusPoint(x,xc.createToPoint(a),u.getStyle("bus.style"))}}Jb.isCalculatingBus=!1}return d?(d.x+=f,d.y+=g):d=a._network.getPosition(e,c.getFromAgent(),null,f,g,!0),d},createToPoint:function(a,b){var c=a._element;if(!c.getToAgent())return{x:0,y:0};var d,e=c.getStyle("link.to.position"),f=c.getStyle("link.to.xoffset"),g=c.getStyle("link.to.yoffset"),h=c.getStyle("link.to.percent");if(h&&h instanceof Array&&2===h.length&&h[0]<=1&&h[0]>=0&&h[1]<=1&&h[1]>=0){var i=c.getToAgent(),j=i.getSize(),k=i.getRect().x+j.width*h[0],l=i.getRect().y+j.height*h[1];return{x:k,y:l}}if(a._network._edgeDetect){var m=c.getFromAgent(),i=c.getToAgent(),n=i.getImage(),o=Jb.images[n],p=m.getLocation(),q=i.getCenterLocation(),r=this._getPointAngleDegree(p.x,p.y,q.x,q.y),s={x:0,y:0};if(o){var t=o._image;if(t&&cd(t)||t&&Ib.Util.getImageAsset(n)._cache)return cd(t)?o._edgeData||(o._edgeData=o._createEdgeData(t,i.getWidth(),i.getHeight())):"object"==typeof t&&(o._edgeData||(o._edgeData=o._createEdgeData(Ib.Util.getImageAsset(n)._cache,i.getWidth(),i.getHeight()))),s.x=o._edgeData[r].x+i.getRect().x,s.y=o._edgeData[r].y+i.getRect().y,s}}if(!Jb.isCalculatingBus){if(Jb.isCalculatingBus=!0,c.getToAgent()instanceof Ib.Bus){var u=c.getToAgent();if(vc.hasVector(u)){var v=b?b._getElementZoomRect(a,u.getRect()):u.getRect(),w=u.getStyle("vector.shape");if("oval"===w)d=Tb.getEllipsePoint(v,xc.createFromPoint(a));else if("circle"===w)d=Tb.getEllipsePoint(Tb.getCircleRect(v),xc.createFromPoint(a));else if("rectangle"===w||"roundrect"===w){var x=new nd;x.add({x:u.x,y:u.y}),x.add({x:u.x+u.width,y:u.y}),x.add({x:u.x+u.width,y:u.y+u.height}),x.add({x:u.x,y:u.y+u.height}),x.add({x:u.x,y:u.y}),x=b?b._getShapeNodeZoomPoints(a,x):x,d=wc.getBusPoint(x,xc.createFromPoint(a),u.getStyle("bus.style"))}}else{var x=b?b._getShapeNodeZoomPoints(a,u.getPoints()):u.getPoints();d=wc.getBusPoint(x,xc.createFromPoint(a),u.getStyle("bus.style"))}}Jb.isCalculatingBus=!1}return d?(d.x+=f,d.y+=g):d=a._network.getPosition(e,c.getToAgent(),null,f,g,!0),d},fillLoopedPoints:function(a,b,c){
var d,e=xc.getBundleGap(a,!0),f=e,g=a.getStyle("link.looped.type"),h=a.getStyle("link.looped.direction");if("north"===h)return"arc"===g?xc.drawArc(b.x+b.width/2,b.y,0,Math.PI,e,e,!1,c):(d={x:b.x+b.width/2,y:b.y},c.add({x:d.x+f,y:d.y}),c.add({x:d.x+f,y:d.y-e}),c.add({x:d.x-f,y:d.y-e}),c.add({x:d.x-f,y:d.y})),{x:b.x+b.width/2,y:b.y-e};if("northeast"===h)return"arc"===g?xc.drawArc(b.x+b.width,b.y,1.5*Math.PI,1.5*Math.PI,e,e,!1,c):(d={x:b.x+b.width,y:b.y},c.add({x:d.x,y:d.y+f}),c.add({x:d.x+f,y:d.y+f}),c.add({x:d.x+f,y:d.y-e}),c.add({x:d.x-f,y:d.y-e}),c.add({x:d.x-f,y:d.y})),{x:b.x+b.width+.707*e,y:b.y-.707*e};if("east"===h)return"arc"===g?xc.drawArc(b.x+b.width,b.y+b.height/2,1.5*Math.PI,Math.PI,e,e,!1,c):(d={x:b.x+b.width,y:b.y+b.height/2},c.add({x:d.x,y:d.y-f}),c.add({x:d.x+e,y:d.y-f}),c.add({x:d.x+e,y:d.y+f}),c.add({x:d.x,y:d.y+f})),{x:b.x+b.width+e,y:b.y+b.height/2};if("southeast"===h)return"arc"===g?xc.drawArc(b.x+b.width,b.y+b.height,Math.PI,1.5*Math.PI,e,e,!1,c):(d={x:b.x+b.width,y:b.y+b.height},c.add({x:d.x,y:d.y-f}),c.add({x:d.x+f,y:d.y-f}),c.add({x:d.x+f,y:d.y+e}),c.add({x:d.x-f,y:d.y+e}),c.add({x:d.x-f,y:d.y})),{x:b.x+b.width+.707*e,y:b.y+b.height+.707*e};if("south"===h)return"arc"===g?xc.drawArc(b.x+b.width/2,b.y+b.height,Math.PI,Math.PI,e,e,!1,c):(d={x:b.x+b.width/2,y:b.y+b.height},c.add({x:d.x-f,y:d.y}),c.add({x:d.x-f,y:d.y+e}),c.add({x:d.x+f,y:d.y+e}),c.add({x:d.x+f,y:d.y})),{x:b.x+b.width/2,y:b.y+b.height+e};if("southwest"===h)return"arc"===g?xc.drawArc(b.x,b.y+b.height,.5*Math.PI,1.5*Math.PI,e,e,!1,c):(d={x:b.x,y:b.y+b.height},c.add({x:d.x,y:d.y-f}),c.add({x:d.x-f,y:d.y-f}),c.add({x:d.x-f,y:d.y+e}),c.add({x:d.x+f,y:d.y+e}),c.add({x:d.x+f,y:d.y})),{x:b.x-.707*e,y:b.y+b.height+.707*e};if("west"===h)return"arc"===g?xc.drawArc(b.x,b.y+b.height/2,.5*Math.PI,Math.PI,e,e,!1,c):(d={x:b.x,y:b.y+b.height/2},c.add({x:d.x,y:d.y-f}),c.add({x:d.x-e,y:d.y-f}),c.add({x:d.x-e,y:d.y+f}),c.add({x:d.x,y:d.y+f})),{x:b.x-e,y:b.y+b.height/2};if("northwest"===h)return"arc"===g?xc.drawArc(b.x,b.y,0,1.5*Math.PI,e,e,!1,c):(d={x:b.x,y:b.y},c.add({x:d.x,y:d.y+f}),c.add({x:d.x-f,y:d.y+f}),c.add({x:d.x-f,y:d.y-e}),c.add({x:d.x+f,y:d.y-e}),c.add({x:d.x+f,y:d.y})),{x:b.x-.707*e,y:b.y-.707*e};throw"Can not resolve link looped direction '"+h+"'"},drawArc:function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o,p,q,r,s;if(Math.abs(d)>2*Math.PI&&(d=2*Math.PI),m=Math.ceil(Math.abs(d)/(Math.PI/4)),i=d/m,j=-i,k=-c,m>0){n=a+Math.cos(c)*e,o=b+Math.sin(-c)*f,h.add({x:n,y:o});for(var t=0;m>t;t++){k+=j,l=k-j/2,p=a+Math.cos(k)*e,q=b+Math.sin(k)*f,r=a+Math.cos(l)*(e/Math.cos(j/2)),s=b+Math.sin(l)*(f/Math.cos(j/2));var u=new nd;u.add({x:r,y:s}),u.add({x:p,y:q}),h.add(u)}}},fillBundlePoints:function(a,c,d,e,f,g){var h;if(a._element.getBundleCount(),a._element.getBundleIndex(),a.getStyle("link.bundle.expanded"),"parallel"!==c&&0===(h=xc.getBundleGap(a,!1)))return f.add(d),f.add(e),Tb.getCenterPoint(d,e);h===b&&(h=xc.getBundleGap(a,!1));var i=xc.getBundleOffset(a),j=Tb.getDistance(d,e);if(g){var k=g.getSizeZoom();i*=k,h*=k}("arc"===c||"triangle"===c)&&f.add({x:0,y:0}),"arc"===c&&f.add({x:0,y:h}),f.add({x:i,y:h}),f.add({x:j-i,y:h}),"arc"===c&&f.add({x:j,y:h}),("arc"===c||"triangle"===c)&&f.add({x:j,y:0});for(var l=Math.atan2(e.y-d.y,e.x-d.x),m=Tb.createMatrix(l,0,0),n=0,o=f.size();o>n;n++){var p=f.get(n);p=m.transform(p),p.x+=d.x,p.y+=d.y,f.set(n,p)}if("arc"===c){var q=Tb.getCenterPoint(f.get(2),f.get(3)),r=new nd;return r.add(f.get(1)),r.add(f.get(2)),f.set(1,r),r=new nd,r.add(f.get(4)),r.add(f.get(5)),f.set(4,r),f.removeAt(5),f.removeAt(2),q}return xc.calculateCenterPoint(f)},calculateCenterPoint:function(a){var b=a.size();if(null==a||1>b)return{x:0,y:0};if(b%2===0){var c=b/2,d=a.get(c-1),e=a.get(c);return{x:(d.x+e.x)/2,y:(d.y+e.y)/2}}return a.get((b-1)/2)},getBundleOffset:function(a){var b=Tb.getDistance(a.getFromPoint(),a.getToPoint()),c=a.getStyle("link.bundle.offset");return b>2*c?c:b/2},getBundleGap:function(a,b){var c=a._element;if(!c.getBundleLinks())return b?c.getStyle("link.looped.gap"):0;for(var d=b?"link.looped.gap":"link.bundle.gap",e=null,f=0,g=0,h=c.getBundleLinks().getSiblings(),i=0,j=c.getStyle("link.bundle.independent"),k=c.getStyle("link.bundle.group.gap"),l=0,m=h.size();m>l;l++){var n=h.get(l);if(!j||n===c.getBundleLinks()){for(var o=0,p=n.getLinks().size();p>o;o++){var q=n.getLinks().get(o);if(j===q.getStyle("link.bundle.independent")&&a._network.isVisible(q)){if(null==e)e=q,i=q.getStyle(d);else{var r=q.getStyle(d);g+=i/2+r/2,i=r}q===c&&(f=g+k/2)}}g+=k}}if(b)return g-f+i;var s=f-g/2;return null!=e&&c.getFromAgent()!==e.getFromAgent()&&(s=-s),s},isTargetPriority:function(a,b,c){if(a){if(b.height<c.height)return b.height+c.height<Math.max(b.y+b.height,c.y+c.height)-Math.min(b.y,c.y)+b.height/2}else if(b.width<c.width)return b.width+c.width<Math.max(b.x+b.width,c.x+c.width)-Math.min(b.x,c.x)+b.width/2;return!0},calculateOrthogonalAndFlexionalLinkPoints:function(a,b,c,d){var e=xc.isHorizontal(a,b,c,d),f=new nd;if(xc.isFlexionalTypeLink(a))xc.flexional(e,b,c,f,d.getStyle("link.extend"));else{xc.orthogonal(a,b,c,f,e,d);var g=xc.isSplitByPercent(a,d),h=g?xc.calculateSplitValueByPercent(a,e,b,c,d.getStyle("link.split.percent")):d.getStyle("link.split.value");0===h&&(e=!e)}var i;0===f.size()?xc.isTargetPriority(e,b,c)?(i={x:c.x+c.width/2,y:c.y+c.height/2},f.add(xc.rectanglePerimeter(b,!0,i)),f.add(xc.rectanglePerimeter(c,!1,f.get(f.size()-1)))):(i={x:b.x+b.width/2,y:b.y+b.height/2},i=xc.rectanglePerimeter(c,!1,i),f.add(xc.rectanglePerimeter(b,!0,i)),f.add(i)):(i=f.get(0),f.add(xc.rectanglePerimeter(b,!0,i),0),f.add(xc.rectanglePerimeter(c,!1,f.get(f.size()-1))));var j=f.size();if(2>j)return f;for(var k=f.get(0),l=1;j-1>l;l++){var m=f.get(l);m.x===k.x&&m.y===k.y&&(f.remove(m),j--,l--),k=m}return f},isHorizontal:function(a,b,c,d){if(a){if("flexional.horizontal"===a||"orthogonal.horizontal"===a||"orthogonal.H.V"===a||"extend.left"===a||"extend.right"===a)return!0;if("flexional.vertical"===a||"orthogonal.vertical"===a||"orthogonal.V.H"===a||"extend.top"===a||"extend.bottom"===a)return!1}var e=xc.calculateXGap(b,c),f=xc.calculateYGap(b,c);return e>=f},flexional:function(a,b,c,d,e){a?xc.flexionalHorizontal(b,c,d,e):xc.flexionalVertical(b,c,d,e)},isSplitByPercent:function(a,b){return b.getStyle("link.split.by.percent")},isExtendTypeLink:function(a){return a&&("extend.top"===a||"extend.left"===a||"extend.bottom"===a||"extend.right"===a)},isFlexionalTypeLink:function(a){return a&&("flexional"===a||"flexional.horizontal"===a||"flexional.vertical"===a)},calculateControlPoint:function(a,b,c,d,e){if("orthogonal.H.V"===a||"orthogonal.V.H"===a)return{x:d.x+d.width/2,y:d.y+d.height/2};var f;if(xc.isExtendTypeLink(a)){var g=Math.min(c.y,d.y),h=Math.min(c.x,d.x),i=Math.max(c.y+c.height,d.y+d.height),j=Math.max(c.x+c.width,d.x+d.width);if(f=e.getStyle("link.extend"),"extend.top"===a)return{x:(h+j)/2,y:g-f};if("extend.left"===a)return{x:h-f,y:(g+i)/2};if("extend.bottom"===a)return{x:(h+j)/2,y:i+f};if("extend.right"===a)return{x:j+f,y:(g+i)/2}}var k=xc.isSplitByPercent(a,e);if(f=k?xc.calculateSplitValueByPercent(a,b,c,d,e.getStyle("link.split.percent")):e.getStyle("link.split.value"),f===Number.NEGATIVE_INFINITY||f===Number.POSITIVE_INFINITY)return{x:d.x+d.width/2,y:d.y+d.height/2};if(0===f)return{x:c.x+c.width/2,y:c.y+c.height/2};if(b){var l=c.x+c.x+c.width<d.x+d.x+d.width;return{x:xc.calculateSplitLocation(l,f,c.x,c.width),y:c.y+c.height/2}}var m=c.y+c.y+c.height<d.y+d.y+d.height;return{x:c.x+c.width/2,y:xc.calculateSplitLocation(m,f,c.y,c.height)}},calculateGap:function(a,b,c,d){var e=Math.max(b,d)-Math.min(a,c);return e-(b-a+d-c)},calculateXGap:function(a,b){var c=Math.max(a.x+a.width,b.x+b.width)-Math.min(a.x,b.x);return c-a.width-b.width},calculateYGap:function(a,b){var c=Math.max(a.y+a.height,b.y+b.height)-Math.min(a.y,b.y);return c-a.height-b.height},calculateSplitValueByPercent:function(a,b,c,d,e){var f=xc.calculateSplitGapByPercent(e,b,c,d);return f*e},calculateSplitGapByPercent:function(a,b,c,d,e){return b?xc._calculateSplitGapByPercent(a,c.x,c.x+c.width,d.x,d.x+d.width):xc._calculateSplitGapByPercent(a,c.y,c.y+c.height,d.y,d.y+d.height)},_calculateSplitGapByPercent:function(a,b,c,d,e){var f=xc.calculateGap(b,c,d,e),g=d+e>b+c;if(f>0){if(1===a)return f+(e-d)/2;if(a>=0&&1>a)return f;if(0>a)return g?d-b:c-e}return Math.abs(g&&a>0||!g&&0>a?c-e:b-d)},calculateSplitPercentByControlPoint:function(a,b,c,d){return b?xc.calculateSplitPercent(a.x,c.x,c.x+c.width,d.x,d.x+d.width):xc.calculateSplitPercent(a.y,c.y,c.y+c.height,d.y,d.y+d.height)},calculateSplitPercent:function(a,b,c,d,e){if(a>=b&&c>=a)return 0;var f=xc.calculateGap(b,c,d,e);if(f>0&&a>=d&&e>=a)return 1;var g=d+e>b+c;if(f>0){if(a>Math.min(c,e)&&a<Math.max(b,d))return Math.abs(a-(g?c:b))/f;if(g){if(b>a)return(a-b)/(d-b)}else if(a>c)return(c-a)/(c-e)}return a>c?(g?a-c:c-a)/Math.abs(c-e):(g?a-b:b-a)/Math.abs(b-d)},calculateSplitLocation:function(a,b,c,d){return a===b>0?c+d+Math.abs(b):c-Math.abs(b)},calculateAngle:function(a,b){if(0!==a&&0!==b)return Math.atan2(a,b);if(0===a){if(b>0)return 0;if(0>b)return Math.PI}return a>0?Math.PI/2:-Math.PI/2},drawCorner:function(a,b){var c=a.size();if(!(3>c)){var d=b.getStyle("link.corner");if("none"!==d){for(var e,f,g,h,i=b.getStyle("link.xradius"),j=b.getStyle("link.yradius"),k=a.get(0),l=a.get(1),m=2;c>m;m++){var n=a.get(m),o=l.x-k.x,p=l.y-k.y,q=n.x-l.x,r=n.y-l.y,s=0===p;if(0===o&&0===r||0===p&&0===q)if(s?(e=Math.min(2===m?Math.abs(o):Math.abs(o)/2,i),f=Math.min(m===c-1?Math.abs(r):Math.abs(r)/2,j),g={x:l.x-(o>0?e:-e),y:l.y},h={x:l.x,y:l.y+(r>0?f:-f)}):(e=Math.min(m===c-1?Math.abs(q):Math.abs(q)/2,i),f=Math.min(2===m?Math.abs(p):Math.abs(p)/2,j),g={x:l.x,y:l.y-(p>0?f:-f)},h={x:l.x+(q>0?e:-e),y:l.y}),a.remove(l),m--,c--,(g.x!==k.x||g.y!==k.y)&&(a.add(g,m),m++,c++),"bevel"===d)a.add(h,m),m++,c++;else if("round"===d){var t=new nd;t.add(l),t.add(h),a.add(t,m),m++,c++}k=l,l=n}h&&h.x===l.x&&h.y===l.y&&a.remove(l)}}},orthogonal:function(a,b,c,d,e,f){var g=f.getStyle("link.control.point"),h=null==g;if(g){var i=Tb.unionRect(b,c);Tb.containsPoint(i,g)||(e=xc.calculateIsHorizontalByControlPoint(g.x,g.y,i.y,i.x,i.y+i.height,i.x+i.width))}else g=xc.calculateControlPoint(a,e,b,c,f);e?xc.sideToSide(b,c,g,d,h):xc.topToBottom(b,c,g,d,h)},calculateIsHorizontalByControlPoint:function(a,b,c,d,e,f){return c>b&&c-b>d-a&&c-b>a-f||b>e&&b-e>d-a&&b-e>a-f?!1:!0},contains:function(a,b,c){return b>=a.x&&b<=a.x+a.width&&c>=a.y&&c<=a.y+a.height},topToBottom:function(a,b,c,d,e){var f=Math.max(a.y,b.y),g=Math.min(a.y+a.height,b.y+b.height),h=c?c.y:g+(f-g)/2,i=a.x+a.width/2,j=b.x+b.width/2;if(!e&&c&&(c.x>=a.x&&c.x<=a.x+a.width&&(i=c.x),c.x>=b.x&&c.x<=b.x+b.width&&(j=c.x)),xc.contains(b,i,h)||xc.contains(a,i,h)||d.add({x:i,y:h}),xc.contains(b,j,h)||xc.contains(a,j,h)||d.add({x:j,y:h}),0===d.size())if(c)xc.contains(b,c.x,h)||xc.contains(a,c.x,h)||d.add({x:c.x,y:h});else{var k=Math.max(a.x,b.x),l=Math.min(a.x+a.width,b.x+b.width);d.add({x:k+(l-k)/2,y:h})}},sideToSide:function(a,b,c,d,e){var f=Math.max(a.x,b.x),g=Math.min(a.x+a.width,b.x+b.width),h=c?c.x:g+(f-g)/2,i=a.y+a.height/2,j=b.y+b.height/2;if(!e&&c&&(c.y>=a.y&&c.y<=a.y+a.height&&(i=c.y),c.y>=b.y&&c.y<=b.y+b.height&&(j=c.y)),xc.contains(b,h,i)||xc.contains(a,h,i)||d.add({x:h,y:i}),xc.contains(b,h,j)||xc.contains(a,h,j)||d.add({x:h,y:j}),0===d.size())if(c)xc.contains(b,h,c.y)||xc.contains(a,h,c.y)||d.add({x:h,y:c.y});else{var k=Math.max(a.y,b.y),l=Math.min(a.y+a.height,b.y+b.height);d.add({x:h,y:k+(l-k)/2})}},flexionalHorizontal:function(a,b,c,d){var e=b.x+b.width<a.x,f=a.x+a.width<b.x,g=e?a.x:a.x+a.width,h=a.y+a.height/2,i=f?b.x:b.x+b.width,j=b.y+b.height/2,k=d,l=e?-k:k,m={x:g+l,y:h};l=f?-k:k;var n={x:i+l,y:j};if(e===f){var o=e?Math.min(g,i)-d:Math.max(g,i)+d;c.add({x:o,y:h}),c.add({x:o,y:j})}else if(m.x<n.x===e){var p=h+(j-h)/2;c.add(m),c.add({x:m.x,y:p}),c.add({x:n.x,y:p}),c.add(n)}else c.add(m),c.add(n)},flexionalVertical:function(a,b,c,d){var e=b.y+b.height<a.y,f=a.y+a.height<b.y,g=a.x+a.width/2,h=e?a.y:a.y+a.height,i=b.x+b.width/2,j=f?b.y:b.y+b.height,k=d,l=e?-k:k,m={x:g,y:h+l};l=f?-k:k;var n={x:i,y:j+l};if(e===f){var o=e?Math.min(h,j)-d:Math.max(h,j)+d;c.add({x:g,y:o}),c.add({x:i,y:o})}else if(m.y<n.y===e){var p=g+(i-g)/2;c.add(m),c.add({x:p,y:m.y}),c.add({x:p,y:n.y}),c.add(n)}else c.add(m),c.add(n)},rectanglePerimeter:function(a,b,c){var d=a.x+a.width/2,e=a.y+a.height/2,f=c.x-d,g=c.y-e,h=Math.atan2(g,f),i={x:0,y:0},j=Math.PI,k=Math.PI/2,l=k-h,m=Math.atan2(a.height,a.width);return-j+m>h||h>j-m?(i.x=a.x,i.y=e-a.width*Math.tan(h)/2):-m>h?(i.y=a.y,i.x=d-a.height*Math.tan(l)/2):m>h?(i.x=a.x+a.width,i.y=e+a.width*Math.tan(h)/2):(i.y=a.y+a.height,i.x=d+a.height*Math.tan(l)/2),c.x>=a.x&&c.x<=a.x+a.width?i.x=c.x:c.y>=a.y&&c.y<=a.y+a.height&&(i.y=c.y),c.x<a.x?i.x=a.x:c.x>a.x+a.width&&(i.x=a.x+a.width),c.y<a.y?i.y=a.y:c.y>a.y+a.height&&(i.y=a.y+a.height),i},isSplitTypeLink:function(a){return a&&("orthogonal"===a||"orthogonal.horizontal"===a||"orthogonal.vertical"===a)},isOrthogonalOrFlexionalLink:function(a){if(a instanceof Ib.ShapeLink)return!1;if(a.isLooped())return!1;var b=a.getStyle("link.type");return xc.isOrthogonalOrFlexionalType(b)},isOrthogonalLink:function(a){if(a instanceof Ib.ShapeLink)return!1;if(a.isLooped())return!1;var b=a.getStyle("link.type");return xc.isOrthogonalType(b)},isOrthogonalOrFlexionalType:function(a){return"orthogonal"===a||"orthogonal.horizontal"===a||"orthogonal.H.V"===a||"orthogonal.vertical"===a||"orthogonal.V.H"===a||"extend.top"===a||"extend.left"===a||"extend.bottom"===a||"extend.right"===a||"flexional"===a||"flexional.horizontal"===a||"flexional.vertical"===a},isOrthogonalType:function(a){return"orthogonal"===a||"orthogonal.horizontal"===a||"orthogonal.H.V"===a||"orthogonal.vertical"===a||"orthogonal.V.H"===a||"extend.top"===a||"extend.left"===a||"extend.bottom"===a||"extend.right"===a},hasControlPoint:function(a){return"orthogonal"===a||"orthogonal.horizontal"===a||"orthogonal.vertical"===a||"extend.bottom"===a||"extend.left"===a||"extend.right"===a||"extend.top"===a},getControlPoint:function(a,b,c){if(!a)throw"link can't be null";var d=a.getStyle("link.type");if(!xc.hasControlPoint(d))return null;var e=a.getStyle("link.control.point");if(e)return e;var f,g;if(null==b?(f=a.getFromAgent().getRect(),g=a.getToAgent().getRect()):(f=xc.getLinkSourceBounds(b,c),g=xc.getLinkTargetBounds(b,c)),null==f||null==g)return null;var h=xc.isHorizontal(d,f,g,a);return xc.calculateControlPoint(a.getStyle("link.type"),h,f,g,a)},getSplitValueByControlPoint:function(a,b,c,d,e){if("extend.top"===b)return Math.min(c.y,d.y)-a.y;if("extend.left"===b)return Math.min(c.x,d.x)-a.x;if("extend.bottom"===b)return a.y-Math.max(c.y+c.height,d.y+d.height);if("extend.right"===b)return a.x-Math.max(c.x+c.width,d.x+d.width);var f;if(e){var g=c.x+c.x+c.width<d.x+d.x+d.width;return f=g?a.x-c.x+c.width:c.x-a.x,f>0?f:f>-c.width?0:f+c.width}var h=c.y+c.y+c.height<d.y+d.y+d.height;return f=h?a.y-c.y-c.height:c.y-a.y,f>0?f:f>-c.height?0:f+c.height},isHorizontalByControlPoint:function(a,b,c,d,e){var f=Tb.unionRect(c,d);return Tb.containsPoint(f,a)?xc.isHorizontal(b,c,d,e):xc.calculateIsHorizontalByControlPoint(a.x,a.y,f.y,f.x,f.y+f.height,f.x+f.width)},setParamsByControlPoint:function(a,b,c,d,e){var f=xc.isHorizontalByControlPoint(a,d,b,c,e),g=e.getStyle("link.control.point");if((g||"orthogonal"===d||"orthogonal.horizontal"===d||"orthogonal.vertical"===d)&&e.setStyle("link.type",f?"orthogonal.horizontal":"orthogonal.vertical"),g)return void e.setStyle("link.control.point",a);var h=xc.getSplitValueByControlPoint(a,d,b,c,f);if(xc.isExtendTypeLink(d))return void e.setStyle("link.extend",h);var i=xc.isSplitByPercent(d,e);return i?0===h?void e.setStyle("link.split.percent",0):void e.setStyle("link.split.percent",xc.calculateSplitPercentByControlPoint(a,f,b,c)):void e.setStyle("link.split.value",h)},getLinkNodeBounds:function(a,b,c,d,e,f){if(f){var g=f.getLocationZoom();f.getSizeZoom(a)}if(null==a)return null;var h;if(d)f?(h=a.getZoomBodyRect(),h.x+=b,h.y+=c):(h=a.getBodyRect(),h.x+=b,h.y+=c);else{var i=a.getNetwork().getPosition(e,a,null,b,c);h=f?{x:i.x*g,y:i.y*g,width:1,height:1}:{x:i.x,y:i.y,width:1,height:1}}return h},getLinkSourceBounds:function(a,b){var c=a._element,d=a.getNetwork().getElementUI(c.getFromAgent());if(null==d)return null;var e=c.getStyle("link.from.position"),f=c.getStyle("link.from.xoffset"),g=c.getStyle("link.from.yoffset"),h=c.getStyle("link.from.at.edge");return xc.getLinkNodeBounds(d,f,g,h,e,b)},getLinkTargetBounds:function(a,b){var c=a._element,d=a.getNetwork().getElementUI(c.getToAgent());if(null==d)return null;var e=c.getStyle("link.to.position"),f=c.getStyle("link.to.xoffset"),g=c.getStyle("link.to.yoffset"),h=c.getStyle("link.to.at.edge");return xc.getLinkNodeBounds(d,f,g,h,e,b)},orthogonalAndFlexional:function(a,b,c){var d=xc.getLinkSourceBounds(a,c);if(null==d)return null;var e=xc.getLinkTargetBounds(a,c);if(null==e)return null;var f=xc.calculateOrthogonalAndFlexionalLinkPoints(b,d,e,a._element);return xc.offsetLink(a,f),a.setHotSpot(xc.calculateCenterPoint(f)),"flexional"!==b&&xc.drawCorner(f,a._element),f},offsetLink:function(a,b){var c=a._element,d=c.isBundleAgent();if(!d){var e=xc.getBundleGap(a,!1);if(0!==e)for(var f,g,h=!1,i=!1,j=b.get(0),k=Jb.clone(j),l=1,m=b.size();m>l;l++){var n=b.get(l),o=n.x-k.x,p=n.y-k.y;k=Jb.clone(n),g=xc.calculateAngle(o,p),0===o?((g-f)%Math.PI===0&&(g-f)%(2*Math.PI)!==0&&(h=!h,h&&(p=-p)),(g-f)%Math.PI!==0&&(j.x+=0>p?e:-e),n.x+=0>p?e:-e):0===p&&((g-f)%Math.PI===0&&(g-f)%(2*Math.PI)!==0&&(i=!i,i&&(o=-o)),f&&(g-f)%Math.PI===0||(j.y-=0>o?e:-e),n.y-=0>o?e:-e),f=g,j=n}}},_getPointAngleDegree:function(a,b,c,d){var e=c-a,f=d-b,g=Math.atan2(f,e);return g=g/Math.PI*180,g=parseInt(g)+180,g%=360}};Jb.link=xc;var yc={findMoveToBottomDatas:function(a,b,c){for(var d=0;d<c.size();d++){var e=c.get(d);a.contains(e)&&b.add(e)}for(d=0;d<c.size();d++)e=c.get(d),yc.findMoveToBottomDatas(a,b,e.getChildren())},findMoveToTopDatas:function(a,b,c){for(var d=0;d<c.size();d++){var e=c.get(c.size()-1-d);a.contains(e)&&b.add(e)}for(d=0;d<c.size();d++)e=c.get(d),yc.findMoveToTopDatas(a,b,e.getChildren())},findMoveUpDatas:function(a,b,c){for(var d=!1,e=0;e<c.size();e++){var f=c.get(e);a.contains(f)?d&&b.add(f):d=!0}for(e=0;e<c.size();e++)f=c.get(e),yc.findMoveUpDatas(a,b,f.getChildren())},findMoveDownDatas:function(a,b,c){for(var d=!1,e=0;e<c.size();e++){var f=c.get(c.size()-1-e);a.contains(f)?d&&b.add(f):d=!0}for(e=0;e<c.size();e++)f=c.get(e),yc.findMoveDownDatas(a,b,f.getChildren())},doLayout:function(a,b){b=b||{},b.type=b.type||"round",b.animate=b.animate||!0,b.elements=b.elements||new Ib.List,b.repulsion=b.repulsion||1,b.expandGroup=b.expandGroup||!1;var c=new Ib.layout.AutoLayouter(a.getElementBox());c.getElements=function(){}}};Jb.box=yc;var zc={scrollLeft:function(){return zc._filterResults(a.pageXOffset?a.pageXOffset:0,Ob.documentElement?Ob.documentElement.scrollLeft:0,Ob.body?Ob.body.scrollLeft:0)},scrollTop:function(){return zc._filterResults(a.pageYOffset?a.pageYOffset:0,Ob.documentElement?Ob.documentElement.scrollTop:0,Ob.body?Ob.body.scrollTop:0)},_filterResults:function(a,b,c){var d=a?a:0;return b&&(!d||d>b)&&(d=b),c&&(!d||d>c)?c:d},isSingleTouch:function(a){return a.touches&&1==a.touches.length},isMultiTouch:function(a){return a.touches&&a.touches.length>1},getDistance:function(a){if(!zc.isMultiTouch(a))return 0;var b=a.touches[0],c=a.touches[1];return Math.sqrt(Math.pow(b.clientX-c.clientX,2)+Math.pow(b.clientY-c.clientY,2))},getCenterLocation:function(a){if(!zc.isMultiTouch(a))return 0;var b=a.touches[0],c=a.touches[1];return{x:(b.clientX+c.clientX)/2,y:(b.clientY+c.clientY)/2}}};Jb.touch=zc;var Ac={_string:function(a,b,c,d){var e=c._stringPool.get();e.style.whiteSpace="nowrap",e.style.verticalAlign="middle",e.style.padding="0px 2px",Jb.setText(e,a,d),e.setAttribute("title",a),b.appendChild(e)},_boolean:function(a,b,c){var d=c._booleanPool.get();b._editInfo?(d._editInfo=b._editInfo,delete b._editInfo,d.disabled=!1):d.disabled=!0,d.keepDefault=!0,d.type="checkbox",d.style.margin="0px 2px",d.style.verticalAlign="middle",d.checked=a,b.appendChild(d),""===b.style.textAlign&&(b.style.textAlign="center")},_color:function(a,b,c){var d=c._colorPool.get();d.style.width="100%",d.style.height="100%",d.style.backgroundColor=a,d.setAttribute("title",a),b.appendChild(d)},_listPoints:function(a,b,c,d){var e=c._stringPool.get();e.style.whiteSpace="nowrap",e.style.verticalAlign="middle",e.style.padding="0px 2px";var f=a._as||a,g="";f.forEach(function(a,b){g+=b==f.length-1?"["+a.x+","+a.y+"]":"["+a.x+","+a.y+"],"}),a=g,Jb.setText(e,a,d),e.setAttribute("title",a),b.appendChild(e)},render:function(a,b,c,d,e){if(null!=b){var f=Ac["_"+a];f?f(b,c,d,e):"boolean"==typeof b?Ac._boolean(b,c,d,e):b instanceof Ib.List?Ac._listPoints(b,c,d,e):Ac._string(b,c,d,e)}}};Jb.render=Ac;var Bc={toolTipDiv:null,getToolTipDiv:function(){if(!Bc.toolTipDiv){Bc.toolTipDiv=Ob.createElement("div");var a=Ed,b=Bc.toolTipDiv.style;b.position="absolute",b.color=a.TOOLTIP_COLOR,b.background=a.TOOLTIP_BACKGROUND,b.fontSize=a.TOOLTIP_FONT_SIZE,b.padding=a.TOOLTIP_PADDING,b.border=a.TOOLTIP_BORDER,b.borderRadius=a.TOOLTIP_BORDER_RADIUS,b.boxShadow=a.TOOLTIP_BOX_SHADOW,b.zIndex=a.TOOLTIP_ZINDEX,b.setProperty&&b.setProperty("-webkit-box-shadow",a.TOOLTIP_BOX_SHADOW,null)}return Bc.toolTipDiv},isToolTipVisible:function(){return Bc.getToolTipDiv().parentNode?!0:!1},hideToolTip:function(){if(Bc._clearTimeout(),Bc._clearDismiss(),Bc.isToolTipVisible()){var a=Bc.getToolTipDiv();a.parentNode&&a.parentNode.removeChild(a)}},showToolTip:function(a,b){return a&&b?void(Bc.isToolTipVisible()||Bc._reshow_timeout?Bc._showToolTip(a,b):(Bc._clearTimeout(),Bc._show_timeout=setTimeout(function(){Bc._showToolTip(a,b)},Ed.TOOLTIP_INITIAL_DELAY))):void Bc.hideToolTip()},_showToolTip:function(a,b){var c,d,e;if(a.target?(c=a.clientX,d=a.clientY):(c=a.x,d=a.y),e=Bc.getToolTipDiv(),Wb.clear(e),b instanceof Element){var f=b.cloneNode(!0);e.appendChild(f)}else e.innerHTML=b;e.style.left=c+Ed.TOOLTIP_XOFFSET+"px",e.style.top=d+Ed.TOOLTIP_YOFFSET+"px",e.parentNode||Ob.body.appendChild(e),Bc._clearDismiss(),Bc._dismiss_timeout=setTimeout(Bc.hideToolTip,Ed.TOOLTIP_DISMISS_DELAY),Bc._clearReshow(),Bc._reshow_timeout=setTimeout(Bc._clearReshow,Ed.TOOLTIP_RESHOW_DELAY)},_clearDismiss:function(){Bc._dismiss_timeout&&(clearTimeout(Bc._dismiss_timeout),Bc._dismiss_timeout=null)},_clearReshow:function(){Bc._reshow_timeout&&(clearTimeout(Bc._reshow_timeout),Bc._reshow_timeout=null)},_clearTimeout:function(){Bc._show_timeout&&(clearTimeout(Bc._show_timeout),Bc._show_timeout=null)},resetToolTip:function(){Bc.hideToolTip(),Bc.toolTipDiv=null}};Jb.popup=Bc;var Cc={handleClicked:function(a,b,c){if(Qb.isTouchable||0===b.button)if(c){var d=Dc(c);d&&d.onClick&&d.onClick(c,a),a.onClickElement(c,b),a.fireInteractionEvent({kind:"clickElement",event:b,element:c})}else a.onClickBackground(b),a.fireInteractionEvent({kind:"clickBackground",event:b})},handleDoubleClicked:function(a,b,c){if((Qb.isTouchable||0===b.button)&&!a.isEditingElement()){if(c){var d=Dc(c);d&&d.onDoubleClick&&d.onDoubleClick(c,a),a.onDoubleClickElement(c,b),a.fireInteractionEvent({kind:"doubleClickElement",event:b,element:c})}else a.onDoubleClickBackground(b),a.fireInteractionEvent({kind:"doubleClickBackground",event:b});c?c instanceof Ib.Link&&a.isDoubleClickToLinkBundle()?c.ISubNetwork&&a.isDoubleClickToSubNetwork()&&!Jb.isCtrlDown(b)?(a.isDoubleClickToEmptySubNetwork()||c.getChildrenSize()>0)&&a.setCurrentSubNetwork(c,a.isSubNetworkAnimate(),function(){a.fireInteractionEvent({kind:"enterSubNetwork",event:b,element:c})}):c.reverseBundleExpanded()&&a.fireInteractionEvent({kind:"bundleLink",event:b,element:c}):c.ISubNetwork&&a.isDoubleClickToSubNetwork()?(a.isDoubleClickToEmptySubNetwork()||c.getChildrenSize()>0)&&a.setCurrentSubNetwork(c,a.isSubNetworkAnimate(),function(){a.fireInteractionEvent({kind:"enterSubNetwork",event:b,element:c})}):c instanceof Nd&&a.isDoubleClickToGroupExpand()&&(c.reverseExpanded(),a.fireInteractionEvent({kind:"expandGroup",event:b,element:c})):a.isDoubleClickToUpSubNetwork()&&a.upSubNetwork(a.isSubNetworkAnimate(),function(){a.fireInteractionEvent({kind:"upSubNetwork",event:b})})}},handleKeyDown:function(a,b){Jb.isCtrlDown(b)&&65==b.keyCode?(a.isKeyboardSelectEnabled()&&a.selectAll().size()>0&&a.fireInteractionEvent({kind:"selectAll"}),Wb.preventDefault(b)):46==b.keyCode?(a.isKeyboardRemoveEnabled()&&a.removeSelection()&&a.fireInteractionEvent({kind:"removeElement"}),Wb.preventDefault(b)):Jb.showVersion(b)},handleLongClicked:function(a,b,c){if(Qb.isTouchable||0===b.button)if(c){var d=Dc(c);d&&d.onLongClick&&d.onLongClick(c,a),a.onLongClickElement(c,b),a.fireInteractionEvent({kind:"longClickElement",event:b,element:c})}else a.onLongClickBackground(b),a.fireInteractionEvent({kind:"longClickBackground",event:b})}},Dc=function(a){if(a&&a._image){if("object"==typeof a._image)return a._image;var b=Jb.getImageAsset(a._image);if(b)return b._image}return null};Jb.interaction=Cc;var Ec=function(a){return a.trim()[0].match(/[mlhvcsqta]/i)?Kc(a):Gc(a)},Fc={},Gc=function(a){var b=Fc[a];return b?b:(Fc[a]=b=[],a.trim().split(" ").forEach(function(a){a=a.split(","),b.push(2===a.length?{x:parseFloat(a[0]),y:parseFloat(a[1])}:a[0])}),b)},Hc={},Ic=/[mlhvcsqtaz][\d.,\-\s]*/gi,Jc=/-?(\d)+(\.(\d)+)?/g,Kc=function(a){var b,c=Hc[a];return c?c:(b=a.trim().match(Ic),Hc[a]=c=[],b&&b.forEach(function(a){var b,d=a[0],e=a.match(Jc),f=e&&e.length;if(c.push(a={c:d}),f)switch(e.forEach(function(a,b){e[b]=parseFloat(a)}),d){case"M":case"m":case"L":case"l":for(b=0;f>b;b+=2)0!==b&&c.push(a={c:"M"===d||"L"===d?"L":"l"}),a.x=e[b],a.y=e[b+1];break;case"H":case"h":for(b=0;f>b;b++)0!==b&&c.push(a={c:d}),a.x=e[b];break;case"V":case"v":for(b=0;f>b;b++)0!==b&&c.push(a={c:d}),a.y=e[b];break;case"C":case"c":for(b=0;f>b;b+=6)0!==b&&c.push(a={c:d}),a.x1=e[b],a.y1=e[b+1],a.x2=e[b+2],a.y2=e[b+3],a.x=e[b+4],a.y=e[b+5];break;case"S":case"s":for(b=0;f>b;b+=4)0!==b&&c.push(a={c:d}),a.x2=e[b],a.y2=e[b+1],a.x=e[b+2],a.y=e[b+3];break;case"Q":case"q":for(b=0;f>b;b+=4)0!==b&&c.push(a={c:d}),a.x1=e[b],a.y1=e[b+1],a.x=e[b+2],a.y=e[b+3];break;case"T":case"t":for(b=0;f>b;b+=2)0!==b&&c.push(a={c:d}),a.x=e[b],a.y=e[b+1]}}),c)},Lc=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o=a.transform&&Mc(a.transform);return o&&o.length&&(c=Sb.identity(),o.forEach(function(a){var b=a[0];"matrix"===b?c.multiply(new Sb(a[1],a[2],a[3],a[4],a[5],a[6])):"translate"===b?c.translate(a[1]||0,a[2]||0):"scale"===b?c.scale(a[1]||1,a[2]||a[1]||1):"rotate"===b?c.rotate(a[1]||0,a[2]||0,a[3]||0):"skewX"===b?c.skew(a[1]||0,0):"skewY"===b&&c.skew(0,a[1]||0)})),"linear"===a.type?(f=a.x1||0,g=a.y1||0,h=a.x2||0,i=a.y2||0,c&&(d=c.transform(f,g),f=d.x,g=d.y,d=c.transform(h,i),h=d.x,i=d.y),e=b.createLinearGradient(f,g,h,i)):"radial"===a.type&&(j=a.fx||0,k=a.fy||0,l=a.cx||0,m=a.cy||0,n=a.r||0,null==a.fx&&(j=l),null==a.fy&&(k=m),c&&(d=c.transform(j,k),j=d.x,k=d.y,d=c.transform(l,m),l=d.x,m=d.y,n=Math.max(c._m11,c._m22)*n),e=b.createRadialGradient(j,k,0,l,m,n)),e&&a.stop&&a.stop.length&&a.stop.forEach(function(a){e.addColorStop(parseFloat(a.offset),td(a.color,b._color))}),e},Mc=function(a){return a.replace(/[\s\r\t\n]+/gm," ").trim().replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/).map(function(a){return a.replace(")","").trim().split(/\s*\(\s*|\s+,?\s*|,\s*/).map(function(a,b){return 0===b?a:parseFloat(a)})})},Nc=function(a,b,c,d,e,f,g){var h,i,j,k,l=1;"object"!=typeof b&&(i=b,h=Jb.images[b],b=h&&h.getImage()),cd(b)?a.drawImage(h?h.getImage(c,d.width,d.height):b,d.x,d.y,d.width,d.height):b&&"object"==typeof b&&(a._data=e,a._view=f,i?(j=d.width/(b.w&&Yc(e,b,b,"w")||e.getWidth()),k=d.height/(b.h&&Yc(e,b,b,"h")||e.getHeight()),f&&(l=f.getSizeZoom?f.getSizeZoom()*f.getGraphicsZoom():f.getZoom()),!h._cache||Math.max(j*l,k*l)>1?Oc(a,b,c,d,e,f,g):a.drawImage(c?h.getImage(c,d.width,d.height):h._cache,d.x,d.y,d.width,d.height)):Oc(a,b,c,d,e,f,g),a._data=null,a._view=null)},Oc=function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A=e&&e.getStyle("image.state");if(p=a._vector,w=a._color,q=a._fill,r=a._pattern,s=a._lineWidth,t=a._alpha,u=a._sx,v=a._sy,m=b,Yc(e,m,m,"visible",f)!==!1){for(a._color=c,h=Yc(e,m,m,"v",f),i=h&&h.length,y=m.w&&Yc(e,m,m,"w")||e.getWidth(),z=m.h&&Yc(e,m,m,"h")||e.getHeight(),n=d.width/y,o=d.height/z,g===!0?(a._fill=null,a._pattern=null,a._lineWidth=null,a._alpha=null):(a._sx=n,a._sy=o),a.save(),a.translate(d.x+d.width/2,d.y+d.height/2),(1!==n||1!==o)&&a.scale(n,o),m.origin&&a.translate((m.origin.x-.5)*y,(m.origin.y-.5)*z),a._vector=m,m.clip&&(a.beginPath(),m.clip===!0?a.rect(-(m.origin?m.origin.x:.5)*y,-(m.origin?m.origin.y:.5)*z,y,z):m.clip.length?m.clip.forEach(function(b){a.drawShape(b)}):a.drawShape(m.clip),a.clip()),Tc(e,m,m,a,f),j=0,i=h.length;i>j;j++)l=h[j],a._shapeData=l,f&&(f._shapeDataIndex=j,l.animate&&wb(l,m,e,f)),x=Yc(e,m,l,"state",f),Yc(e,m,l,"visible",f)===!1||x&&!(Array.isArray(x)?x.indexOf(A)>=0:x===A)||(k=Qc[l.shape],k&&(a.save(),"vector"===l.shape||"g"===l.shape?k(a,l,e,f):Tc(e,m,l,a,f,function(){k(a,l,e,f)}),a.restore())),f&&(f._shapeDataIndex=null),a._shapeData=null;a.restore(),a._vector=p,a._shapeData=null,a._color=w,a._fill=q,a._pattern=r,a._lineWidth=s,a._alpha=t,a._sx=u,a._sy=v}},Pc=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o=a._vector,p=o.origin,q=o.w&&Yc(d,o,o,"w")||d.getWidth(),r=o.h&&Yc(d,o,o,"h")||d.getHeight();if("string"==typeof b?(n=Jb.images[b],n&&(h=n.getWidth(),i=n.getHeight())):(h=b.w&&Yc(d,b,b,"w"),i=b.h&&Yc(d,b,b,"h")),h&&i&&c)for(j=c.w/h*a._sx,k=c.h/i*a._sy,f=c.x-q/2*(a._sx-1),g=c.y-r/2*(a._sy-1),p&&(f-=(p.x-.5)*q*(a._sx-1),g-=(p.y-.5)*r*(a._sy-1)),(1!==a._sx||1!==a._sy)&&(a.scale(1/a._sx,1/a._sy),f+=((p?p.x:.5)*q+c.x)*(a._sx-1),g+=((p?p.x:.5)*r+c.y)*(a._sy-1)),c={x:0,y:0,width:h,height:i},l=0;j>l;l++)for(m=0;k>m;m++)c.x=l*h+f,c.y=m*i+g,Nc(a,b,null,c,d,e,!0)},Qc={line:function(a,b,c,d){var e,f,g,h,i=Yc(c,a._vector,b,"p1",d),j=Yc(c,a._vector,b,"p2",d);i?(e=Zc(i.length?i[0]:i.x,a),f=$c(i.length?i[1]:i.y,a)):(e=Yc(c,a._vector,b,"x1",d,!0),f=Yc(c,a._vector,b,"y1",d,!1)),j?(g=Zc(j.length?j[0]:j.x,a),h=$c(j.length?j[1]:j.y,a)):(g=Yc(c,a._vector,b,"x2",d,!0),h=Yc(c,a._vector,b,"y2",d,!1)),a.moveTo(e,f),a.lineTo(g,h)},rect:function(a,b,c,d){var e,f,g,h,i=Yc(c,a._vector,b,"rect",d),j=Yc(c,a._vector,b,"r",d);i?(Array.isArray(i)?(e=i[0],f=i[1],g=i[2],h=i[3]):(e=i.x,f=i.y,g=i.w,h=i.h),e=Zc(e,a),f=$c(f,a),g=Zc(g,a),h=$c(h,a)):(e=Yc(c,a._vector,b,"x",d,!0),f=Yc(c,a._vector,b,"y",d,!1),g=Yc(c,a._vector,b,"w",d,!0),h=Yc(c,a._vector,b,"h",d,!1)),a.drawRoundRect(e,f,g,h,j),(a._gradientFunc||a._pattern)&&(a._rect={x:e,y:f,w:g,h:h})},circle:function(a,b,c,d){var e=Yc(c,a._vector,b,"cx",d,!0),f=Yc(c,a._vector,b,"cy",d,!1),g=a._vector.w&&Yc(c,a._vector,a._vector,"w")||c.getWidth(),h=a._vector.h&&Yc(c,a._vector,a._vector,"h")||c.getHeight(),i=_c(Yc(c,a._vector,b,"r",d),Math.min(g,h),b,a._vector),j=Yc(c,a._vector,b,"startAngle",d),k=Yc(c,a._vector,b,"endAngle",d),l=Yc(c,a._vector,b,"anticlockwise",d),m=Yc(c,a._vector,b,"close",d);null==j&&(j=0),null==k&&(k=360),null==l&&(l=!1),m&&a.moveTo(e,f),a.arc(e,f,i,j/180*Math.PI,k/180*Math.PI,l),m&&a.closePath(),(a._gradientFunc||a._pattern)&&(a._rect={x:e-i,y:f-i,w:2*i,h:2*i})},ellipse:function(a,b,c,d){var e=Yc(c,a._vector,b,"cx",d,!0),f=Yc(c,a._vector,b,"cy",d,!1),g=Yc(c,a._vector,b,"rx",d,!0),h=Yc(c,a._vector,b,"ry",d,!1),i=Yc(c,a._vector,b,"startAngle",d),j=Yc(c,a._vector,b,"endAngle",d),k=Yc(c,a._vector,b,"anticlockwise",d),l=Yc(c,a._vector,b,"close",d);null==i&&(i=0),null==j&&(j=360),null==k&&(k=!1),l&&a.moveTo(e,f),a.ellipse(e,f,g,h,0,i/180*Math.PI,j/180*Math.PI,k),l&&a.closePath(),(a._gradientFunc||a._pattern)&&(a._rect={x:e-g,y:f-h,w:2*g,h:2*h})},path:function(a,b,c,d){var e=Yc(c,a._vector,b,"data",d);a.drawPath(e)},text:function(a,b,c,d){var e=Yc(c,a._vector,b,"text",d),f=Yc(c,a._vector,b,"x",d,!0),g=Yc(c,a._vector,b,"y",d,!1),h=Yc(c,a._vector,b,"w",d,!0);if(null!=e){e=String(e);var i=e.split("\n"),j=2*a.measureText("e").width,k=vb(a,e,h);
g-=(k.h/j-1)/2*j,i.forEach(function(b){if(h){var c,d,e,i,k,l=b.split(" "),m=l.length,n="";for(e=0;m>e;e++)if(c=l[e]+(e===m-1?"":" "),d=n+c,i=a.measureText(d).width,h>i)n=d;else if(i==h)a.fillText(n,f,g),n="",g+=j;else{for(k=0;k<c.length;k++)if(d=n+c.substr(0,k+1),a.measureText(d).width>h){a.fillText(d.substring(0,d.length-1),f,g),n=c.substring(k,c.length),g+=j;break}for(;n.length>0&&a.measureText(n).width>h;)for(k=0;k<n.length;k++)if(d=n.substr(0,k+1),a.measureText(d).width>h){a.fillText(n.substr(0,k),f,g),n=n.substring(k,n.length),g+=j;break}}a.fillText(n,f,g)}else a.fillText(b,f,g);g+=j})}},draw:function(a,b,c,d){var e,f,g=b.draw;"string"==typeof g&&((e=g.match(Wc))?(f="with(data) { "+e[1]+" }",g=Ib.Util.newFunction("g","data","view",f)):g=dd[g]),"function"==typeof g&&g.call(a._vector,a,c,d)},vector:function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r=a._vector,s=Yc(c,r,b,"name",d),t=Yc(c,r,b,"x",d,!0),u=Yc(c,r,b,"y",d,!1),v=Yc(c,r,b,"w",d),w=Yc(c,r,b,"h",d);if("string"==typeof s?(l=Jb.images[s],k=l&&l._image):k=s,k)if(cd(k))null!=v&&null!=w?a.drawImage(k,t,u,Zc(v,a),$c(w,a)):a.drawImage(k,t,u);else{for(m=Yc(c,k,k,"v",d),n=m&&m.length,o=k.w&&Yc(c,k,k,"w"),p=k.h&&Yc(c,k,k,"h"),null!=v&&null!=w?(v=Zc(v,a),w=$c(w,a)):(v=o,w=p),a.save(),h=a._lineWidth,i=a._fill,j=a._alpha,Tc(c,k,k,a,d),Tc(c,r,b,a,d),a.translate(t,u),a.scale(v/o,w/p),k.origin&&a.translate((k.origin.x-.5)*o,(k.origin.y-.5)*p),k.clip&&(a.beginPath(),k.clip===!0?a.rect(-(k.origin?k.origin.x:.5)*o,-(k.origin?k.origin.y:.5)*p,o,p):k.clip.length?k.clip.forEach(function(b){a.drawShape(b)}):a.drawShape(k.clip),a.clip()),q=a._shapeData,a._vector=k,e=0;n>e;e++)f=m[e],a._shapeData=f,d&&(d._shapeDataIndex.length?d._shapeDataIndex.push(e):d._shapeDataIndex=[d._shapeDataIndex,e],f.animate&&wb(f,r,c,d)),Yc(c,k,f,"visible",d)!==!1&&(g=Qc[f.shape],g&&(a.save(),"vector"===f.shape||"g"===f.shape?g(a,f,c,d):Tc(c,k,f,a,d,function(){g(a,f,c,d)}),a.restore())),d&&d._shapeDataIndex.pop();a._vector=r,a._shapeData=q,a._lineWidth=h,a._fill=i,a._alpha=j,a.restore()}},g:function(a,b,c,d){var e,f,g,h,i,j=Yc(c,a._vector,b,"v",d);j&&j.length&&(a.save(),f=a._lineWidth,g=a._fill,h=a._alpha,i=a._shapeData,Tc(c,a._vector,b,a,d),j.forEach(function(b){Yc(c,a._vector,b,"visible",d)!==!1&&(e=Qc[b.shape],e&&(a.save(),a._shapeData=b,"vector"===b.shape||"g"===b.shape?e(a,b,c,d):Tc(c,a._vector,b,a,d,function(){e(a,b,c,d)}),a.restore()))}),a._lineWidth=f,a._fill=g,a._alpha=h,a._shapeData=i,a.restore())}};Qc.image=Qc.vector;var Rc=Object.keys(Qc),Sc={M:function(a,b){return a.moveTo(b.x,b.y),a._path_start=b,a._rect&&bd(a._rect,b.x,b.y),b},m:function(a,b,c){return c&&(b={x:c.x+b.x,y:c.y+b.y}),a.moveTo(b.x,b.y),a._path_start=b,a._rect&&bd(a._rect,b.x,b.y),b},Z:function(a){return a.closePath(),a._path_start},z:function(a){return a.closePath(),a._path_start},L:function(a,b){return a.lineTo(b.x,b.y),a._rect&&bd(a._rect,b.x,b.y),b},l:function(a,b,c){var d={x:c.x+b.x,y:c.y+b.y};return a.lineTo(d.x,d.y),a._rect&&bd(a._rect,d.x,d.y),d},H:function(a,b,c){var d={x:b.x,y:c.y};return a.lineTo(d.x,d.y),a._rect&&bd(a._rect,d.x,d.y),d},h:function(a,b,c){var d={x:c.x+b.x,y:c.y};return a.lineTo(d.x,d.y),a._rect&&bd(a._rect,d.x,d.y),d},V:function(a,b,c){var d={x:c.x,y:b.y};return a.lineTo(d.x,d.y),a._rect&&bd(a._rect,d.x,d.y),d},v:function(a,b,c){var d={x:c.x,y:c.y+b.y};return a.lineTo(d.x,d.y),a._rect&&bd(a._rect,d.x,d.y),d},Q:function(a,b){return a._preQ_x=b.x1,a._preQ_y=b.y1,a.quadraticCurveTo(b.x1,b.y1,b.x,b.y),a._rect&&(bd(a._rect,b.x1,b.y1),bd(a._rect,b.x,b.y)),b},q:function(a,b,c){var d={x:c.x+b.x,y:c.y+b.y},e=a._preQ_x=c.x+b.x1,f=a._preQ_y=c.y+b.y1;return a.quadraticCurveTo(e,f,d.x,d.y),a._rect&&(bd(a._rect,e,f),bd(a._rect,d.x,d.y)),d},T:function(a,b,c){var d=a._preQ_x=2*c.x-a._preQ_x,e=a._preQ_y=2*c.y-a._preQ_y;return a.quadraticCurveTo(d,e,b.x,b.y),a._rect&&(bd(a._rect,d,e),bd(a._rect,b.x,b.y)),b},t:function(a,b,c){var d={x:c.x+b.x,y:c.y+b.y},e=a._preQ_x=2*c.x-a._preQ_x,f=a._preQ_y=2*c.y-a._preQ_y;return a.quadraticCurveTo(e,f,d.x,d.y),a._rect&&(bd(a._rect,e,f),bd(a._rect,d.x,d.y)),d},C:function(a,b){return a._preC_x=b.x2,a._preC_y=b.y2,a.bezierCurveTo(b.x1,b.y1,b.x2,b.y2,b.x,b.y),a._rect&&(bd(a._rect,b.x1,b.y1),bd(a._rect,b.x2,b.y2),bd(a._rect,b.x,b.y)),b},c:function(a,b,c){var d={x:c.x+b.x,y:c.y+b.y},e=c.x+b.x1,f=c.y+b.y1,g=a._preC_x=c.x+b.x2,h=a._preC_y=c.y+b.y2;return a.bezierCurveTo(e,f,g,h,d.x,d.y),a._rect&&(bd(a._rect,e,f),bd(a._rect,g,h),bd(a._rect,d.x,d.y)),d},S:function(a,b,c){var d=2*c.x-a._preC_x,e=2*c.y-a._preC_y;return a._preC_x=b.x2,a._preC_y=b.y2,a.bezierCurveTo(d,e,b.x2,b.y2,b.x,b.y),a._rect&&(bd(a._rect,d,e),bd(a._rect,b.x2,b.y2),bd(a._rect,b.x,b.y)),b},s:function(a,b,c){var d={x:c.x+b.x,y:c.y+b.y},e=2*c.x-a._preC_x,f=2*c.y-a._preC_y,g=a._preC_x=c.x+b.x2,h=a._preC_y=c.y+b.y2;return a.bezierCurveTo(e,f,g,h,d.x,d.y),a._rect&&(bd(a._rect,e,f),bd(a._rect,g,h),bd(a._rect,d.x,d.y)),d}},Tc=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q,r,s,t=Yc(a,b,c,"line",e),u=Yc(a,b,c,"fill",e),v=Yc(a,b,c,"fillRule",e)||"nonzero",w=Yc(a,b,c,"gradient",e),x=Yc(a,b,c,"gradientColor",e),y=Yc(a,b,c,"pattern",e),z=Yc(a,b,c,"font",e),A=Yc(a,b,c,"textAlign",e)||"center",B=Yc(a,b,c,"textBaseline",e)||"middle",C=Yc(a,b,c,"translate",e),D=Yc(a,b,c,"rotate",e),E=Yc(a,b,c,"rotateOrigin",e),F=Yc(a,b,c,"scale",e),G=Yc(a,b,c,"transform",e),H=Yc(a,b,c,"alpha",e),I=d._lineWidth,J=d._fill,K=d._pattern,L=d._alpha,M=d._gradientFunc;if(t?(g=t.color,h=t.width,i=t.cap,j=t.join,k=t.miterLimit,l=t.dash,m=t.dashOffset):(g=Yc(a,b,c,"lineColor",e),h=Yc(a,b,c,"lineWidth",e),i=Yc(a,b,c,"lineCap",e),j=Yc(a,b,c,"lineJoin",e),k=Yc(a,b,c,"miterLimit",e),l=Yc(a,b,c,"lineDash",e),m=Yc(a,b,c,"lineDashOffset",e)),null!=g&&(d.strokeStyle=td(g,d._color)),null!=h&&(d.lineWidth=d._lineWidth=e&&e.getSizeZoom&&!e.zoomManager.sizeChange?h/e.getSizeZoom():h),null!=i&&(d.lineCap=i),null!=j&&(d.lineJoin=j),null!=k&&(d.miterLimit=k),null!=l&&(d.lineDash=l,d.setLineDash(l)),null!=m&&(d.lineDashOffset=m),y?d._pattern=y:(u&&(d.fillStyle=d._fill=td(u,d._color)),w&&("string"==typeof w?o=Yb[w]:(o=Yb[w.type],w.color&&(x=w.color),o||(w=Lc(w,d))),d._gradientFunc=o)),null!=z&&(d.font=z),null!=A&&(d.textAlign=A),null!=B&&(d.textBaseline=B),Uc(a,b,c,d,e),null!=G)"string"==typeof G&&(G=Mc(G)),G.length&&G.forEach(function(a){var b=a[0];"matrix"===b?d.transform(a[1],a[2],a[3],a[4],a[5],a[6]):"translate"===b?d.translate(a[1]||0,a[2]||0):"scale"===b?d.scale(a[1]||1,a[2]||a[1]||1):"rotate"===b?a.length>2?(d.translate(a[2],a[3]),d.rotate(a[1]),d.translate(-a[2],-a[3])):d.rotate(a[1]):"skewX"===b?d.transform(1,0,Math.tan(a[1]*Math.PI/180),1,0,0):"skewY"===b&&d.transform(1,Math.tan(a[1]*Math.PI/180),0,1,0,0)});else{if(null!=C&&(Array.isArray(C)?(r=C[0],s=C[1]):"object"==typeof C?(r=C.x,s=C.y):(r=C,s=0),r=Zc(r,d),s=$c(s,d),(0!==r||0!==s)&&d.translate(r,s)),null!=D&&D%360!==0){var N,O;E&&(Array.isArray(E)?(N=E[0],O=E[1]):"object"==typeof E?(N=E.x,O=E.y):N=O=E,N=Zc(N,d),O=$c(O,d),(0!==N||0!==O)&&d.translate(N,O)),d.rotate(D*Math.PI/180),E&&(0!==N||0!==O)&&d.translate(-N,-O)}null!=F&&(Array.isArray(F)?(p=F[0],q=F[1]):"object"==typeof F?(p=F.x,q=F.y):p=q=F,(1!==p||1!==q)&&d.scale(p,q))}null!=H&&(d.globalAlpha=d._alpha=null!=L?L*H:H),f&&(d.beginPath(),f(),n=d._rect||c.rect,d._pattern?(d._lineWidth>0&&d.stroke(),d.clip(),Pc(d,d._pattern,n,a,e)):(o&&n&&(w=o(d,td(u||"#000000",d._color),td(x||"#FFFFFF",d._color),n.x,n.y,n.w,n.h)),w&&(d.fillStyle=d._fill=w),d._fill&&d.fill(v),d._lineWidth>0&&d.stroke()),d._lineWidth=I,d._fill=J,d._pattern=K,d._alpha=L,d._gradientFunc=M,d._rect=null)},Uc=function(a,b,c,d,e){var f,g,h,i,j=Yc(a,b,c,"shadow",e);j?(f=j.offsetX,g=j.offsetY,h=j.blur,i=j.color):(f=Yc(a,b,c,"shadowOffsetX",e),g=Yc(a,b,c,"shadowOffsetY",e),h=Yc(a,b,c,"shadowBlur",e),i=Yc(a,b,c,"shadowColor",e)),null!=f&&(d.shadowOffsetX=f),null!=g&&(d.shadowOffsetY=g),null!=h&&(d.shadowBlur=h),null!=i&&(d.shadowColor=i)},Vc=/<%=([\s\S]+?)%>/,Wc=/<%([\s\S]+?)%>/,Xc=new RegExp([Vc.source,Wc.source].join("|")),Yc=function(a,c,d,e,f,g,h){var i,j,k,l,m,n=d[e],o=typeof n;if("string"===o&&(i=n.match(Xc))?(j="with(data) { "+(i[1]?"return "+i[1]:i[2])+" }",k=Ib.Util.newFunction("data","view",j),n=k.call(c,a,f)):"function"===o&&(n=n.call(c,a,f)),g===!0?(l=c.w&&Yc(a,c,c,"w")||a.getWidth(),(d.rel===!0||d.rel===b&&c.rel)&&1>=n&&n>=-1?n*=l:"string"==typeof n&&(n=parseInt(n)/100*l),n=n||0):g===!1&&(m=c.h&&Yc(a,c,c,"h")||a.getHeight(),(d.rel===!0||d.rel===b&&c.rel)&&1>=n&&n>=-1?n*=m:"string"==typeof n&&(n=parseInt(n)/100*m),n=n||0),h!==!1&&f&&a&&d.animate&&a._animates){var p,q=a._animates,r=f._shapeDataIndex;if(r.length)for(var s=0;s<r.length;s++)p=r[s],q=q[p];else p=r;var t=q[p],u=t[e];if(u)if(Array.isArray(u))for(var s=u.length-1;s>=0;s--){var v=u[s];if((v.stopped||v.time>0)&&v.started)return Hb(v,n)}else if(u.started)return Hb(u,n)}return n},Zc=function(a,c){if(!a)return 0;var d=c._vector.w&&Yc(c._data,c._vector,c._vector,"w")||c._data.getWidth();return(c._shapeData&&c._shapeData.rel===!0||(!c._shapeData||c._shapeData.rel===b)&&c._vector.rel)&&1>=a&&a>=-1?a*d:"string"==typeof a?parseInt(a)/100*d:a},$c=function(a,c){if(!a)return 0;var d=c._vector.h&&Yc(c._data,c._vector,c._vector,"h")||c._data.getHeight();return(c._shapeData&&c._shapeData.rel===!0||(!c._shapeData||c._shapeData.rel===b)&&c._vector.rel)&&1>=a&&a>=-1?a*d:"string"==typeof a?parseInt(a)/100*d:a},_c=function(a,c,d,e){return a?(d.rel===!0||d.rel===b&&e.rel)&&1>=a&&a>=-1?a*c:"string"==typeof a?parseInt(a)/100*c:a:0},ad=(a.CanvasRenderingContext2D||Lb.Context2d).prototype;ad.drawShape=function(a){var b=this,c=b._vector,d=b._shapeData,e=b._data,f=b._view,g=Qc[a.shape];g&&(b.save(),b._shapeData=a,"vector"===a.shape||"g"===a.shape?g(b,a,e,f):Tc(e,c,a,b,f,function(){g(b,a,e,f)}),b._shapeData=d,b.restore())},ad.drawPath=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n=this;if("string"==typeof a&&(a=Ec(a)),j=a?a.length:0,!(1>=j)){if((n._gradientFunc||n._pattern)&&(n._rect=k={x:0,y:0,w:0,h:0}),b=a&&a[0]&&a[0].c,b||(c=a&&a[0]&&null!=a[0].x,d="z"===a[j-1]||"Z"===a[j-1],d&&j--),b){for(e=0;j>e;e++)g=a[e],h=Sc[g.c],h&&(f=h(n,g,f));n._path_start=null,n._preC_x=null,n._preC_y=null,n._preQ_x=null,n._preQ_y=null}else if(c){for(i=a[0],l=Zc(i.x,n),m=$c(i.y,n),n.moveTo(l,m),k&&bd(k,l,m),e=1;j>e;e++)i=a[e],l=Zc(i.x,n),m=$c(i.y,n),n.lineTo(l,m),k&&bd(k,l,m);d&&n.closePath()}else{for(l=Zc(a[0],n),m=$c(a[1],n),n.moveTo(l,m),k&&bd(k,l,m),e=2;j>e;e+=2)l=Zc(a[e],n),m=$c(a[e+1],n),n.lineTo(l,m),k&&bd(k,l,m);d&&n.closePath()}return a}};var bd=function(a,b,c){var d=Math.min(a.x,b),e=Math.max(a.x+a.w,b),f=Math.min(a.y,c),g=Math.max(a.y+a.h,c);a.x=d,a.y=f,a.w=e-d,a.h=g-f};ad._fillPath=function(a,b){var c=this;c.beginPath(),c.fillStyle=a,c.drawPath(b),c.fill()},ad._fillRect=function(a,b,c,d,e){var f=this;f.beginPath(),f.fillStyle=a,f.rect(b,c,d,e),f.fill()},ad.ellipse||(ad.ellipse=function(a,b,c,d){var e=this,f=.5522848,g=c*f,h=d*f,i=a+c,j=b+d,k=a-c,l=b-d;e.moveTo(k,b),e.bezierCurveTo(k,b-h,a-g,l,a,l),e.bezierCurveTo(a+g,l,i,b-h,i,b),e.bezierCurveTo(i,b+h,a+g,j,a,j),e.bezierCurveTo(a-g,j,k,b+h,k,b)}),ad.drawRoundRect=function(a,b,c,d,e){var f=this;if(!e)return void f.rect(a,b,c,d);var g,h,i,j;if(Array.isArray(e))if(1===e.length)g=h=i=j=e[0];else if(2===e.length)g=h=e[0],i=j=e[1];else{if(4!==e.length)return void f.rect(a,b,c,d);g=e[0],h=e[1],i=e[2],j=e[3]}else g=h=i=j=e;var k=a+c,l=b+d,m=d>c?2*c:2*d;g=m>g?g:m,h=m>h?h:m,i=m>i?i:m,j=m>j?j:m;var n=.292893218813453*j,o=.585786437626905*j;f.moveTo(k,l-j),f.quadraticCurveTo(k,l-o,k-n,l-n),f.quadraticCurveTo(k-o,l,k-j,l),n=.292893218813453*i,o=.585786437626905*i,f.lineTo(a+i,l),f.quadraticCurveTo(a+o,l,a+n,l-n),f.quadraticCurveTo(a,l-o,a,l-i),n=.292893218813453*g,o=.585786437626905*g,f.lineTo(a,b+g),f.quadraticCurveTo(a,b+o,a+n,b+n),f.quadraticCurveTo(a+o,b,a+g,b),n=.292893218813453*h,o=.585786437626905*h,f.lineTo(k-h,b),f.quadraticCurveTo(k-o,b,k-n,b+n),f.quadraticCurveTo(k,b+o,k,b+h),f.lineTo(k,l-j)};var cd=function(a){return Lb?a instanceof Lb||a instanceof Pb:a instanceof HTMLImageElement||a instanceof HTMLCanvasElement||a instanceof HTMLVideoElement},dd={},ed=function(a,b){"function"==typeof b&&(dd[a]=b)},fd=function(a,b){"function"==typeof b&&Rc.indexOf(a)<0&&(Qc[a]=b)};!function(){for(var b=["webkit","moz"],c=0;c<b.length&&!a.requestAnimationFrame;++c){var d=b[c];a.requestAnimationFrame=a[d+"RequestAnimationFrame"],a.cancelAnimationFrame=a[d+"CancelAnimationFrame"]||a[d+"CancelRequestAnimationFrame"]}if(/iP(ad|hone|od).*OS 6/.test(a.navigator.userAgent)||!a.requestAnimationFrame||!a.cancelAnimationFrame){var e=0;a.requestAnimationFrame=function(a){var b=Date.now(),c=Math.max(e+16,b);return setTimeout(function(){a(e=c)},c-b)},a.cancelAnimationFrame=clearTimeout}}();var gd=Ib.Animate=function(a){var b=this;b.type=null==a.type?"number":a.type,b.delay=null==a.delay?0:a.delay,b.dur=null==a.dur?1e3:a.dur,b.interval=null==a.interval?0:a.interval,b.finish=null==a.finish?b.delay+b.dur+b.interval:a.finish,null==a.finish?b.finish=b.delay+b.dur+b.interval:(b.finish=a.finish,b.interval=b.finish-b.delay-b.dur),b.repeat=null==a.repeat?1:a.repeat,b.reverse=null==a.reverse?!0:a.reverse,b.easing=null==a.easing?"easeNone":a.easing,b.onUpdate=a.onUpdate,b.onDone=a.onDone,b.onStop=a.onStop,b.onPlay=a.onPlay,b.attr=a.attr,b.source=a.source,b.filter=a.filter,b.from=a.from,b.to=a.to,b.start=null,b.time=0,b.total=0,b.count=0,b.started=!1,b.stopped=!1,b.paused=!1,b.pausedTime=null,b.pausedTotal=0,b._speed=1,b._oldSpeed=null,b._speedTotal=0,b._speedTime=null,b._percent=0,b._percentSet=null,b._percentDiff=0,b.id=id++};Jb.ext("twaver.Animate",Object,{play:function(){return yb(this)},stop:function(a){return zb(this,a)},pause:function(){this.stopped||(this.paused=!0)},resume:function(){this.paused&&(this.paused=!1,jd=!0)},isPaused:function(){return this.paused},percent:function(a){return null==a?this._percentSet||this._percent:(this._percentSet=0>a?0:a>100?100:a,this.paused&&(jd=!0),this.started||(this.play(),this.pause()),this)},speed:function(a){return null==a?this._speed:(a=0>a?1:a,a!==this.speed&&(this.stopped||(this._oldSpeed=this._speed),this._speed=a),this)},clone:function(){return new gd(this)},chain:function(a){var b,c=this;return c.next=a,a.pre=c,c.onDone?(b=c.onDone,c.onDone=function(){b.call(c),a.play()}):c.onDone=function(){a.play()},c}});var hd={},id=1,jd=!1;!function If(a){Ib.animateLoopId=requestAnimationFrame(If),jd&&(jd=!1,Db(a))}(0);var kd={easeNone:function(a,b,c,d){return c*a/d+b},easeIn:function(a,b,c,d){return c*(a/=d)*a+b},easeOut:function(a,b,c,d){return-c*(a/=d)*(a-2)+b},easeBoth:function(a,b,c,d){return(a/=d/2)<1?c/2*a*a+b:-c/2*(--a*(a-2)-1)+b},easeInStrong:function(a,b,c,d){return c*(a/=d)*a*a*a+b},easeOutStrong:function(a,b,c,d){return-c*((a=a/d-1)*a*a*a-1)+b},easeBothStrong:function(a,b,c,d){return(a/=d/2)<1?c/2*a*a*a*a+b:-c/2*((a-=2)*a*a*a-2)+b},elasticIn:function(a,b,c,d,e,f){var g;return 0===a?b:1===(a/=d)?b+c:(f||(f=.3*d),!e||e<Math.abs(c)?(e=c,g=f/4):g=f/(2*Math.PI)*Math.asin(c/e),-(e*Math.pow(2,10*(a-=1))*Math.sin(2*(a*d-g)*Math.PI/f))+b)},elasticOut:function(a,b,c,d,e,f){var g;return 0===a?b:1===(a/=d)?b+c:(f||(f=.3*d),!e||e<Math.abs(c)?(e=c,g=f/4):g=f/(2*Math.PI)*Math.asin(c/e),e*Math.pow(2,-10*a)*Math.sin(2*(a*d-g)*Math.PI/f)+c+b)},elasticBoth:function(a,b,c,d,e,f){var g;return 0===a?b:2===(a/=d/2)?b+c:(f||(f=.3*d*1.5),!e||e<Math.abs(c)?(e=c,g=f/4):g=f/(2*Math.PI)*Math.asin(c/e),1>a?-.5*e*Math.pow(2,10*(a-=1))*Math.sin(2*(a*d-g)*Math.PI/f)+b:e*Math.pow(2,-10*(a-=1))*Math.sin(2*(a*d-g)*Math.PI/f)*.5+c+b)},backIn:function(a,c,d,e,f){return f===b&&(f=1.70158),a===e&&(a-=.001),d*(a/=e)*a*((f+1)*a-f)+c},backOut:function(a,b,c,d,e){return"undefined"==typeof e&&(e=1.70158),c*((a=a/d-1)*a*((e+1)*a+e)+1)+b},backBoth:function(a,b,c,d,e){return"undefined"==typeof e&&(e=5.70158),(a/=d/2)<1?c/2*a*a*(((e*=1.525)+1)*a-e)+b:c/2*((a-=2)*a*(((e*=1.525)+1)*a+e)+2)+b},bounceIn:function(a,b,c,d){return c-kd.bounceOut(d-a,0,c,d)+b},bounceOut:function(a,b,c,d){return(a/=d)<1/2.75?7.5625*c*a*a+b:2/2.75>a?c*(7.5625*(a-=1.5/2.75)*a+.75)+b:2.5/2.75>a?c*(7.5625*(a-=2.25/2.75)*a+.9375)+b:c*(7.5625*(a-=2.625/2.75)*a+.984375)+b},bounceBoth:function(a,b,c,d){return d/2>a?.5*kd.bounceIn(2*a,0,c,d)+b:.5*kd.bounceOut(2*a-d,0,c,d)+.5*c+b}},ld={draw:function(a,b){var c=null==b.getCurrentSubNetwork()?b.getElementBox():b.getCurrentSubNetwork(),d=c.getStyle("background.type");"image"==d?this.drawImage(a,c,b):"vector"==d?this.drawVector(a,c,b):"image.vector"==d?(this.drawImage(a,c,b),this.drawVector(a,c,b)):"vector.image"==d&&(this.drawVector(a,c,b),this.drawImage(a,c,b))},drawImage:function(a,b,c){var d=b.getStyle("background.image"),e=Jb.getImageAsset(d),f=c.getGraphicsZoom?c.getGraphicsZoom():c.getZoom();if(null!=e){var g=b.getStyle("background.image.scope"),h=c.getScopeRect(g),i=c._dragToPan?0:-h.x/f,j=c._dragToPan?0:-h.y/f;("rootcanvas"==g||"viewport"==g)&&(h.x=i,h.y=j),"rootcanvas"==g&&(h.width=Math.max(e.getWidth(),h.width/f),h.height=Math.max(e.getHeight(),h.height/f)),"none"==b.getStyle("background.image.stretch")&&(h.width=e.getWidth(),h.height=e.getHeight());var k=b.getStyle("background.image.padding");if(k&&Tb.grow(h,k,k),"tile"==b.getStyle("background.image.stretch")){if(cd(e.getImage()))for(var l=0;l<h.width;l+=e.getWidth())for(var m=0;m<h.height;m+=e.getHeight())a.drawImage(e.getImage(),l,m)}else("fill"==b.getStyle("background.image.stretch")||"none"==b.getStyle("background.image.stretch"))&&Nc(a,e.getImage(),null,h,b,c)}},drawVector:function(a,b,c){var d=b.getStyle("background.vector.scope"),e=c.getScopeRect(d),f=c.getGraphicsZoom?c.getGraphicsZoom():c.getZoom(),g=c._dragToPan?0:-e.x/f,h=c._dragToPan?0:-e.y/f;("rootcanvas"==d||"viewport"==d)&&(e.x=g,e.y=h),"rootcanvas"==d&&(e.width=e.width/f,e.height=e.height/f);var i=b.getStyle("background.outline.width"),j=(b.getStyle("background.outline.color"),b.getStyle("background.vector.fill")),k=b.getStyle("background.vector.fill.color"),l=b.getStyle("background.vector.padding"),m=b.getStyle("background.vector.shape"),n=b.getStyle("background.vector.pattern");l&&Tb.grow(e,l,l);var o=b.getStyle("background.vector.gradient");j&&(o?Xb.fill(a,k,o,b.getStyle("background.vector.gradient.color"),e):a.fillStyle=k,Xb.drawVector(a,m,n,e),a.fill()),i>0&&(a.lineWidth=i,a.strokeStyle=b.getStyle("background.outline.color"),Xb.drawVector(a,m,n,e),a.stroke())}},md=Ib.UndoManager=function(a){var b=this;b._list=[],b._cursor=-1,b._suspended=!1,b._dispatcher=new Ib.EventDispatcher,b._box=a,b._enabled=!1,b._limit=100};md._IGNORE_PROPERTIES={alarmState:1,propagateSeverity:1,enablePropagation:1,children:1,fromAgent:1,toAgent:1,bundleLinks:1},Jb.ext("twaver.UndoManager",Object,{setEnabled:function(a){var b=this,c=b._box;b._enabled!=a&&(a?(c.addDataBoxChangeListener(b._handleDataBoxChange,b,!0),c.addDataPropertyChangeListener(b._handleDataPropertyChange,b,!0)):(c.removeDataBoxChangeListener(b._handleDataBoxChange,b),c.removeDataPropertyChangeListener(b._handleDataPropertyChange,b))),b._enabled=a},isEnabled:function(){return this._enabled},undo:function(){var a,b,c,d=this,e=d._list;if(d.canUndo()){if(a=e[d._cursor--],d._suspended=!0,a.length)for(c=a.length,b=c-1;b>=0;b--)a[b].undo();else a.undo();d._suspended=!1,d._fire({kind:"undo",action:a})}},redo:function(){var a,b=this,c=b._list;b.canRedo()&&(a=c[++b._cursor],b._suspended=!0,a.length?a.forEach(function(a){a.redo()}):a.redo(),b._suspended=!1,b._fire({kind:"redo",action:a}))},canUndo:function(){return this._cursor>=0},canRedo:function(){return this._cursor<this._list.length-1},_add:function(a){var b=this,c=b._batch,d=b._list;c?c.push(a):(b._cursor!==d.length-1&&d.splice(b._cursor+1,d.length),0!==b._limit&&d.length===b._limit&&d.splice(0,1),d.push(a),b._cursor=d.length-1,b._fire({kind:"add",action:a}))},_handleDataBoxChange:function(a){if(!this._suspended){var b=this,c=b._box,d=a.kind,e=a.data;"add"===d?b._add({undo:function(){var a=this;a.parent=e.getParent(),a.host=e.getHost&&e.getHost(),e.getFromNode&&(a.fromNode=e.getFromNode(),a.toNode=e.getToNode()),c.remove(e)},redo:function(){var a=this;a.parent&&e.setParent(a.parent),e.getHost&&a.host&&e.setHost(a.host),e.getFromNode&&(a.fromNode&&e.setFromNode(a.fromNode),a.toNode&&e.setToNode(a.toNode)),c.add(e)}}):"remove"===d&&b._add({undo:function(){c.add(e)},redo:function(){c.remove(e)}})}},_handleDataPropertyChange:function(a){if(!this._suspended){var b=this,c=a.property,d=c.substr(0,2),e=a.source,f=a.oldValue,g=a.newValue;"C:"===d?(c=c.substr(2),b._add({undo:function(){e.setClient(c,f)},redo:function(){e.setClient(c,g)}})):"S:"===d?(c=c.substr(2),b._add({undo:function(){e.setStyle(c,f)},redo:function(){e.setStyle(c,g)}})):md._IGNORE_PROPERTIES[c]||b._add({undo:function(){e[Jb.setter(c)](f)},redo:function(){e[Jb.setter(c)](g)}})}},size:function(){return this._list.length},getCursor:function(){return this._cursor},_fire:function(a){this._dispatcher.fire(a)},on:function(a,b,c){this._dispatcher.add(a,b,c)},off:function(a,b){this._dispatcher.remove(a,b)},isSuspended:function(){return this._suspended},setSuspended:function(a){this._suspended=a},getLimit:function(){return this._limit},setLimit:function(a){var b,c,d=this,e=d._list;return 0>a&&(a=0),a!==d._limit&&(b=e.length-a,a>0&&b>0&&(c=d._cursor+1,d._cursor-=b,d._cursor<-1&&(d._cursor=-1),c>0&&e.splice(0,c),b-=c,b>0&&e.splice(e.length-b,b)),d._limit=a,d._fire({kind:"change"})),d},clear:function(){var a=this;return a._list=[],a._cursor=-1,a._fire({kind:"clear"}),a},batch:function(a,b){var c=this;return c.startBatch(),a.call(b),c.endBatch(),c},startBatch:function(){var a=this;return a._batch||(a._batch=[]),a},endBatch:function(){var a,b=this;return b._batch&&(a=b._batch,b._batch=null,a.length&&b._add(a)),b}}),Ib.Pool=function(a,b){this.func="string"==typeof a?function(){return Ob.createElement(a)}:a,this.tagName=a,null!=b&&(this.redundancy=b)},Jb.ext("twaver.Pool",Object,{redundancy:2,currentIndex:-1,get:function(){if(this.currentIndex++,this.currentIndex===this.size()){var a=this.func();return a._pool=this,a.style.margin="0px",a.style.padding="0px",this.list||(this.list=new nd),this.list.add(a),a}return this.list.get(this.currentIndex)},release:function(a){this.list&&this.list.remove(a)>=0&&(delete a._selectData,delete a._expandData,delete a._checkData,delete a._editInfo,delete a.keepDefault,a.style.margin="0px",a.style.padding="0px",a.style.backgroundColor="",a.removeAttribute("title"),"img"===this.tagName&&a.removeAttribute&&(a.removeAttribute("width"),a.removeAttribute("height"),a.removeAttribute("src")),this.list.add(a),this.currentIndex--)},reset:function(){this.currentIndex=-1},clear:function(){if(this.list)for(;this.redundancy+this.currentIndex<this.list.size()-1;)delete this.list.removeAt(this.list.size()-1)._pool},size:function(){return this.list?this.list.size():0}});var nd=function(){if(this._as=[],1===arguments.length){var a=arguments[0];if(a instanceof nd&&(a=a._as),a instanceof Array)for(var b=a.length,c=0;b>c;c++)this._as.push(a[c]);else a===!1?(this._duplicatable=!1,this._map={}):null!=a&&this._as.push(a)}else if(arguments.length>1)for(b=arguments.length,c=0;b>c;c++)this._as.push(arguments[c])};Ib.List=nd,Jb.ext("twaver.List",Object,{_duplicatable:!0,size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(a,c){if(!this._duplicatable){if(this._map[a._id])return;this._map[a._id]=!0}return c===b?this._as.push(a):this._as.splice(c,0,a)},addAll:function(a){if(a instanceof nd&&(a=a._as),a instanceof Array)for(var b=a.length,c=0;b>c;c++)this.add(a[c]);else this.add(a)},get:function(a){return this._as[a]},remove:function(a){if(!this._duplicatable&&!this._map[a&&a._id])return-1;var b=this._as.indexOf(a);return b>=0&&b<this._as.length&&this.removeAt(b),b},removeAt:function(a){var b=this._as.splice(a,1)[0];return!this._duplicatable&&b&&delete this._map[b._id],b},set:function(a,b){var c=this._as[a];if(c===b)return b;if(!this._duplicatable){if(this._map[b._id])throw"duplicate item:"+b;delete this._map[c._id],this._map[b._id]=!0}return this._as[a]=b,c},clear:function(){return this._duplicatable||(this._map={}),this._as.splice(0,this._as.length)},contains:function(a){return this._duplicatable?this.indexOf(a)>=0:!!this._map[a&&a._id]},indexOf:function(a){return this._as.indexOf(a)},forEach:function(a,b){for(var c=this._as.length,d=0;c>d;d++){var e=this._as[d];b?a.call(b,e):a(e)}},forEachReverse:function(a,b){for(var c=this._as.length,d=c-1;d>=0;d--){var e=this._as[d];b?a.call(b,e):a(e)}},toArray:function(a,b){if(a){for(var c=[],d=this._as.length,e=0;d>e;e++){var f=this._as[e];b?a.call(b,f)&&c.push(f):a(f)&&c.push(f)}return c}return this._as.concat()},toList:function(a,b){if(a){for(var c=new nd,d=this._as.length,e=0;d>e;e++){var f=this._as[e];b?a.call(b,f)&&c.add(f):a(f)&&c.add(f)}return c}return new nd(this)},sort:function(a){return a?this._as.sort(a):this._as.sort(),this},toString:function(){return this._as.toString()}});var od={shapeMap:{},init:function(){od.register("arrow.standard",od.createStandardArrow()),od.register("arrow.delta",od.createDeltaArrow()),od.register("arrow.diamond",od.createDiamondArrow()),od.register("arrow.short",od.createShortArrow()),od.register("arrow.slant",od.createSlantArrow()),od.register("arrow.doubledelta",od.createDoubleDeltaArrow()),od.register("arrow.tee",od.createTeeArrow()),od.register("arrow.box",od.createBoxArrow()),od.register("arrow.dot",od.createDotArrow()),od.register("arrow.tail",od.createTailArrow())},createStandardArrow:function(){var a=new nd;return a.add({x:-1,y:-5/9}),a.add({x:-.75,y:0}),a.add({x:-1,y:5/9}),a.add({x:0,y:0}),a.add({x:-1,y:-5/9}),{points:a}},createDeltaArrow:function(){var a=new nd;return a.add({x:-1,y:-5/9}),a.add({x:-1,y:5/9}),a.add({x:0,y:0}),a.add({x:-1,y:-5/9}),{points:a}},createDoubleDeltaArrow:function(){var a=new nd;return a.add({x:-1,y:-5/9}),a.add({x:-1,y:5/9}),a.add({x:-.5,y:0}),a.add({x:-.5,y:-5/9}),a.add({x:0,y:0}),a.add({x:-.5,y:5/9}),a.add({x:-.5,y:0}),a.add({x:-1,y:-5/9}),{points:a}},createTeeArrow:function(){var a=new nd;return a.add({x:-1/9,y:-5/9}),a.add({x:-1/9,y:5/9}),a.add({x:0,y:5/9}),a.add({x:0,y:-5/9}),a.add({x:-1/9,y:-5/9}),{points:a}},createBoxArrow:function(){var a=new nd;return a.add({x:-10/9,y:-5/9}),a.add({x:-10/9,y:5/9}),a.add({x:0,y:5/9}),a.add({x:0,y:-5/9}),a.add({x:-10/9,y:-5/9}),{points:a}},createDotArrow:function(){var a={},b=new Ib.List;return b.add({x:-.5,y:0}),a.points=b,a.draw=function(a,b){if(a&&b&&b.points&&!(b.points.size()<=0)){var c=b.points._as,d=c[0],e=Math.min(b.width,b.height)/2;a.save(),a.beginPath(),a.arc(d.x,d.y,e,0,2*Math.PI,!1),a.closePath(),a.restore()}},a},createTailArrow:function(){for(var a={},b=new Ib.List,c=30,d=-c/2;c/2>d;d++)b.add({x:-d/9,y:0});return a.points=b,a.draw=function(a,b){if(a&&b&&b.points&&!(b.points.size()<=0))for(var c=b.points._as,d=b.shadow,e=b.shadowColor,f=b.shadowXOffset,g=b.shadowYOffset,h=b.shadowBlur,e=b.shadowColor,i=c.length-4,j=Math.min(b.width,b.height)/2,k=0;i>k;k++){var l=k/i,m=c[k],n=.4*j;a.save(),a.restore(),a.beginPath(),a.globalAlpha=l*l,d&&(a.shadowOffsetX=f,a.shadowOffsetY=g,a.shadowBlur=h,a.shadowColor=e),a.arc(m.x,m.y,n,0,2*Math.PI,!1),a.closePath(),a.fill()}},a},createDiamondArrow:function(){var a=new nd;return a.add({x:-7/12,y:5/9}),a.add({x:-14/12,y:0}),a.add({x:-7/12,y:-5/9}),a.add({x:0,y:0}),a.add({x:-7/12,y:5/9}),{points:a}},createShortArrow:function(){var a=new nd;return a.add({x:-8/12,y:6/9}),a.add({x:-5/12,y:0}),a.add({x:-8/12,y:-6/9}),a.add({x:0,y:0}),a.add({x:-8/12,y:6/9}),{points:a}},createSlantArrow:function(){var a=new nd;return a.add({x:-1,y:-5/9}),a.add({x:-6.5/12,y:0}),a.add({x:-.75,y:4/9}),a.add({x:0,y:0}),a.add({x:-1,y:-5/9}),{points:a}},register:function(a,b){od.shapeMap[a]=b},getShape:function(a){if(a)return od.shapeMap[a];throw"shape type can't be null"},getArrowRect:function(a,b,c,d,e,f,g,h,i){var j=od.getShape(d);if(j&&j.points&&!(j.points&&j.points.size()<=0)){if(g>0&&1>g){var k;k=a.getLineLength?a.getLineLength():a._element.getLineLength(),g*=k}else a.getLineLength&&(g+=od.calculateArrowXOffsetAtEdge(b,a,c,i));var l,m,n,o=Tb.calculatePointInfoAlongLine(b,c,g,h),p=o.point,q=o.angle,r=j.points._as,s=r.length,t=new nd;for(n=new Sb(e,0,0,f,p.x,p.y),l=0;s>l;l++)t.add(n.transform(r[l]));for(n=Tb.createMatrix(q+Math.PI,p.x,p.y),l=0;s>l;l++)m=t.get(l),m instanceof nd&&(m=m._as),m instanceof Array?(m[0]=n.transform(m[0]),m[1]=n.transform(m[1])):t.set(l,n.transform(m));return Tb.getLineRect(t)}},drawArrow:function(a,b,c,d,e,f,g,h,i,j,k,l,m){i=i||0,j=j||0,k=k||0;var n=m._element.getStyle("arrow.from.shadow"),o=m._element.getStyle("arrow.from.shadow.color"),p=m._element.getStyle("arrow.from.shadow.xoffset"),q=m._element.getStyle("arrow.from.shadow.yoffset"),r=m._element.getStyle("arrow.from.shadow.blur"),s=k>=0&&l;if(g||s){var t=od.getShape(f);if(t&&t.points&&!(t.points&&t.points.size()<=0)){var u=Tb.calculatePointInfoAlongLine(d,e,i,j),v=u.point,w=u.angle;g&&(a.fillStyle=h),a.beginPath(),s&&(a.lineWidth=k,a.strokeStyle=l),od._drawArrow(a,t,w,v,b,c,l,o,n,p,q,r),n&&(a.shadowOffsetX=p,a.shadowOffsetY=q,a.shadowBlur=r,a.shadowColor=o),g&&a.fill(),s&&a.stroke()}}},_drawArrow:function(a,b,c,d,e,f,g,h,i,j,k,l){if(b.draw){for(var m=new Ib.List,n=0;n<b.points._as.length;n++)m.add(b.points.get(n));m.add({x:-1,y:-.5}),m.add({x:-1,y:.5}),m.add({x:0,y:.5}),m.add({x:0,y:-.5}),m=m._as;var n,o,p,q=m.length,r=new nd;p=new Sb(e,0,0,f,d.x,d.y);for(var n=0;q>n;n++)r.add(p.transform(m[n]));r=r._as,p=Tb.createMatrix(c+Math.PI,d.x,d.y);for(var s=new nd,n=0;q>n;n++)s.add(p.transform(r[n]));b.draw&&b.draw(a,{points:s,width:e,height:f,shadowColor:h,shadow:i,shadowXOffset:j,shadowYOffset:k,shadowBlur:l})}else{var n,o,p,m=b.points._as,q=m.length,r=new nd;for(p=new Sb(e,0,0,f,d.x,d.y),n=0;q>n;n++)r.add(p.transform(m[n]));r=r._as,p=Tb.createMatrix(c+Math.PI,d.x,d.y);var t=r[0];for(t=p.transform(t),a.moveTo(t.x,t.y),n=1;q>n;n++)o=r[n],o instanceof nd&&(o=o._as),o instanceof Array?(o[0]=p.transform(o[0]),o[1]=p.transform(o[1]),a.quadraticCurveTo(o[0].x,o[0].y,o[1].x,o[1].y)):(o=p.transform(o),a.lineTo(o.x,o.y))}},drawLinkArrow:function(a,b,c,d){if(!(c.size()<2)){var e=a._element.isBundleAgent?a._element.isBundleAgent():!1;a._element.getStyle(e?"arrow.agent.from":"arrow.from")&&od._drawFromArrow(a,b,c,d),a._element.getStyle(e?"arrow.agent.to":"arrow.to")&&od._drawToArrow(a,b,c,d)}},_drawFromArrow:function(a,b,c,d){var e=a._element,f=e.isBundleAgent?e.isBundleAgent():!1,g=e.getStyle(f?"arrow.agent.from.fill":"arrow.from.fill"),h=e.getStyle(f?"arrow.agent.from.outline.width":"arrow.from.outline.width");if(e.getStyle(f?"arrow.agent.from.shadow.color":"arrow.from.shadow.color"),g||h>=0){var i=e.getStyle(f?"arrow.agent.from.width":"arrow.from.width"),j=e.getStyle(f?"arrow.agent.from.height":"arrow.from.height"),k=e.getStyle(f?"arrow.agent.from.xoffset":"arrow.from.xoffset");if(k>0&&1>k){var l;l=a.getLineLength?a.getLineLength():a._element.getLineLength(),k*=l}else a.getLineLength&&(k+=od.calculateArrowXOffsetAtEdge(c,a,!0,d));var m=e.getStyle(f?"arrow.agent.from.yoffset":"arrow.from.yoffset"),n=e.getStyle(f?"arrow.agent.from.shape":"arrow.from.shape");od.drawArrow(b,i,j,c,!0,n,g,e.getStyle(f?"arrow.agent.from.color":"arrow.from.color"),k,m,h,e.getStyle(f?"arrow.agent.from.outline.color":"arrow.from.outline.color"),a)}},_drawToArrow:function(a,b,c,d){var e=a._element,f=e.isBundleAgent?e.isBundleAgent():!1,g=e.getStyle(f?"arrow.agent.to.fill":"arrow.to.fill"),h=e.getStyle(f?"arrow.agent.to.outline.width":"arrow.to.outline.width");if(g||h>=0){var i=e.getStyle(f?"arrow.agent.to.width":"arrow.to.width"),j=e.getStyle(f?"arrow.agent.to.height":"arrow.to.height"),k=e.getStyle(f?"arrow.agent.to.xoffset":"arrow.to.xoffset");if(k>0&&1>k){var l;l=a.getLineLength?a.getLineLength():a._element.getLineLength(),k*=l}else a.getLineLength&&(k+=od.calculateArrowXOffsetAtEdge(c,a,!1,d));var m=e.getStyle(f?"arrow.agent.to.yoffset":"arrow.to.yoffset"),n=e.getStyle(f?"arrow.agent.to.shape":"arrow.to.shape");od.drawArrow(b,i,j,c,!1,n,g,e.getStyle(f?"arrow.agent.to.color":"arrow.to.color"),k,m,h,e.getStyle(f?"arrow.agent.to.outline.color":"arrow.to.outline.color"),a);
}},calculateArrowXOffsetAtEdge:function(a,b,c,d){if(null==a||a.size()<2)return 0;var e=b._element,f=e.getStyle(c?"arrow.from.at.edge":"arrow.to.at.edge");if(!f)return 0;var g=b._network.getElementUI(c?e.getFromAgent():e.getToAgent());if(!g)return 0;if(d)var h=g.getZoomBodyRect();else var h=g._bodyRect;if(null==h)return 0;for(var i=Tb._getPoint(a.get(c?0:a.size()-1)),j=0,k=b.getLineLength();od._containsByInt(h,Math.floor(i.x),Math.floor(i.y),!1)&&k>j;)i=Tb.calculatePointInfoAlongLine(a,c,j++).point;return j},_containsByInt:function(a,c,d,e){return e=e===b?!0:e,e?c>=Math.floor(a.x)&&c<=Math.floor(a.x+a.width)&&d>=Math.floor(a.y)&&d<=Math.floor(a.y+a.height):c>Math.floor(a.x)&&c<Math.floor(a.x+a.width)&&d>Math.floor(a.y)&&d<Math.floor(a.y+a.height)}};od.init(),Jb.arrow=od,Ib.EventDispatcher=function(){},Jb.ext("twaver.EventDispatcher",null,{contains:function(a,b){if(this._ls)for(var c,d=0,e=this._ls.size();e>d;d++)if(c=this._ls.get(d),a===c.l&&b===c.s)return!0;return!1},add:function(a,b,c){var d={l:a,s:b,a:c};this._ls||(this._ls=new nd),this._f?(this._addPendings||(this._addPendings=new nd),this._addPendings.add(d)):d.a?this._ls.add(d,0):this._ls.add(d)},remove:function(a,b){this._ls&&(this._f?(this._removePendings||(this._removePendings=new nd),this._removePendings.add({l:a,s:b})):this._remove(a,b))},_remove:function(a,b){for(var c,d=0,e=this._ls.size();e>d;d++)if(c=this._ls.get(d),c.l===a&&c.s===b)return void this._ls.removeAt(d)},fire:function(a){if(this._ls){var b,c,d=this._ls.size();for(this._f=!0,b=0;d>b;b++)c=this._ls.get(b),c.s?c.l.call(c.s,a):c.l(a);if(this._f=!1,this._removePendings){for(d=this._removePendings.size(),b=0;d>b;b++)c=this._removePendings.get(b),this._remove(c.l,c.s);delete this._removePendings}if(this._addPendings){for(d=this._addPendings.size(),b=0;d>b;b++)c=this._addPendings.get(b),c.a?this._ls.add(c,0):this._ls.add(c);delete this._addPendings}}}}),Ib.ImageAsset=function(a,b,c,d,e){this._name=a,this._width=c,this._height=d,this._svg=e,this._edgeData,"string"==typeof b?this._src=b:"function"==typeof b?this._func=b:cd(b)?this._image=b:"object"==typeof b&&(this._image=b,this._width=b.w||b.width,this._height=b.h||b.height,b.cache!==!1&&zd(b)&&(xd(a,b),this._cache=Cd(b)))},Jb.ext("twaver.ImageAsset",Object,{getName:function(){return this._name},getSrc:function(){return this._src},isSvg:function(){return this._svg},getImage:function(a,b,c){if(!a||!this._image)return this._image;this._map||(this._map={});var d;d=this._svg&&3===arguments.length?a+","+b+","+c:a;var e=this._map[d];return e?e:(e=ud(this._cache||this._image,sd(a),this._svg?b||this.getWidth():this.getWidth(),this._svg?c||this.getHeight():this.getHeight()),this._map[d]=e,e)},getWidth:function(){return this._width},getHeight:function(){return this._height},getFunction:function(){return this._func},_createEdgeData:function(a,b,c){var d=300,e=d/b;b>c&&(e=d/c);var f=Math.floor(b*e),g=Math.floor(c*e);this.tempCanvas||(this.tempCanvas=Ob.createElement("canvas"),this.ctx=this.tempCanvas.getContext("2d")),this.tempCanvas.width=f,this.tempCanvas.height=g,this.ctx.clearRect(0,0,f,g),this.ctx.drawImage(a,0,0,f,g);for(var h=this.ctx.getImageData(0,0,f,g),i=!0,j=[],k=0,b=f,c=g;c>k;k++)for(var l=0;b>l;l++){var m=4*(k*b+l),n=this._isTransparentPoint(h.data,m),o=i!=n||!n&&(0==l||l==b-1);if(o){var p=n?1:0;j.push({x:l-p,y:k})}i=n}i=!0;for(var l=0,b=f,c=g;b>l;l++)for(var k=0;c>k;k++){var m=4*(k*b+l),n=this._isTransparentPoint(h.data,m),o=i!=n||!n&&(0==k||k==c-1);if(o){var p=n?1:0;j.push({x:l,y:k-p})}i=n}for(var q=b/2,r=c/2,s=[],t=0;360>t;t++)s.push({x:q,y:r,dist:0});for(var t=0,u=j.length;u>t;t++){var v=j[t],w=this._getPointAngleDegree(v.x,v.y,q,r),x=this._getPointDist(v.x,v.y,q,r);s[w].dist<x&&(s[w]={x:v.x,y:v.y,dist:x})}for(var t=0,u=s.length;u>t;t++){var o=s[t];o.x=o.x/e,o.y=o.y/e,delete o.dist}return s},_isTransparentPoint:function(a,b){return a[b]+a[b+1]+a[b+2]+a[b+3]==0},_getPointAngleDegree:function(a,b,c,d){var e=c-a,f=d-b,g=Math.atan2(f,e);return g=g/Math.PI*180,g=parseInt(g)+180,g%=360},_getPointDist:function(a,b,c,d){var e=c-a,f=d-b;return Math.sqrt(e*e+f*f)}});var pd={},qd=Wb.createCanvas();qd.width=1,qd.height=1;var rd=qd.getContext("2d"),sd=function(a){a=a||"black";var b,c=pd[a];return c||(rd.clearRect(0,0,1,1),rd.fillStyle=a,rd.fillRect(0,0,1,1),b=rd.getImageData(0,0,1,1).data,c=pd[a]={r:b[0],g:b[1],b:b[2],a:b[3]}),c},td=function(a,b){if(!b)return a;if(b=sd(b),a=sd(a),Ed.PIXEL_FILTER_FUNCTION){var c=Ed.PIXEL_FILTER_FUNCTION(a,b);return"rgba("+c.r+","+c.g+","+c.b+","+a.a+")"}return null},ud=function(a,b,c,d){var e=Wb.createCanvas(c,d),f=e.getContext("2d");f.drawImage(a,0,0,c,d);try{for(var g=f.getImageData(0,0,c,d),h=g.data,i=0,j=h.length;j>i;i+=4){var k={r:h[i+0],g:h[i+1],b:h[i+2]},l=Ed.PIXEL_FILTER_FUNCTION(k,b);h[i+0]=l.r,h[i+1]=l.g,h[i+2]=l.b}f.putImageData(g,0,0)}catch(m){return a}return e},vd={},wd=function(a,b){if(a){var c=typeof a;"string"===c&&(a.match(Xc)||Jb.images[a]||(vd[a]||(vd[a]=[])).push(b))}},xd=function(a,b){b.pattern&&wd(b.pattern,a),b.v&&b.v.forEach(function(b){b.pattern&&wd(b.pattern,a)})},yd=function(a){var b=vd[a];b&&(b.forEach(function(a){var b=Jb.images[a];b._cache=Cd(b._image)}),delete vd[a])},zd=function(a){return a.w&&a.h?Ad(a):!1},Ad=function(a){return!Object.keys(a).some(function(b){if(/^on/.test(b))return!1;var c=a[b],d=Bd(c);return d||"v"!==b||(d=c.some(function(a){if("draw"===a.shape)return!0;if("vector"===a.shape){var b=Jb.images[a.name];if(b&&!b._cache)return!0}var c=Object.keys(a).some(function(b){return"state"===b||"animate"===b?!0:Bd(a[b])});return c?!0:"g"===a.shape&&a.v&&a.v.length?!Ad(a):!1})),d})},Bd=function(a){var b=typeof a;return"string"===b&&a.match(Xc)||"function"===b},Cd=function(a){var b=Wb.createCanvas(a.w,a.h),c=b.getContext("2d");return Oc(c,a,null,{x:0,y:0,width:a.w,height:a.h}),b},Dd=Ib.imageUtil={IMAGE_LOAD_COMPLETED:"IMAGE_LOAD_COMPLETED",_dispatcher:new Ib.EventDispatcher,addEventListener:function(a,b,c){Dd._dispatcher.add(a,b,c)},removeEventListener:function(a,b){Dd._dispatcher.remove(a,b)},images:{},registerImageByUrl:function(a,b,c){if(b=b||Dd.getImageType(a),c=c||Dd.getImageName(a),!Dd.images[c]){Dd.images[c]=a;var d=new Pb;d.src=a,d.onload=function(){Jb.registerImage(c,d,d.width,d.height,b===!0),d.onload=null,delete Dd.images[c];var e={type:Dd.IMAGE_LOAD_COMPLETED,url:a,svg:b,name:c};Dd._dispatcher.fire(e)}}},getImageName:function(a){if("string"!=typeof a)return null;var b=a.lastIndexOf("/"),c=a;return b>=0&&(c=a.substring(b+1)),b=c.lastIndexOf("."),b>=0&&(c=c.substring(0,b)),c},getImageType:function(a){if("string"!=typeof a)return null;var b=a.lastIndexOf("/"),c=a;return b>=0&&(c=a.substring(b+1)),b=c.lastIndexOf("."),b>=0&&(c=c.substring(b+1)),c}},Ed={COLORS:["#6495ED","#FFFF00","#00FFFF","#FF0000","#7FFF00","#E0A580","#5FC0CB","#FA00F0","#A1BC50","#FFD700","#4169E1","#E5A5F5","#1E90FF","#696969","#FF6347","#00BFEF","#FFD700","#80E090","#5F9EA0","#A000FF","#7FAF00","#228BA2","#FF00FF","#7FFFD4","#800000","#0000CD","#20B2AA","#D2691E","#6495BD","#DC143C","#F0A8AF","#008B8B","#800080","#B8860B","#4B0082","#00FF00","#FFA500","#FF4500","#FFFF00","#9ACD32","#00008B","#FF1493","#ADFF2F","#4682B4","#00C0B1"],CALL_LATER_DELAY:17,SCROLL_BAR_WIDTH:17,SELECT_COLOR:"#C2CFF1",FOCUS_ON_CLICK:!0,VIEW_POSITION:"absolute",VIEW_FONT_SIZE:"12px",VIEW_FONT_FAMILY:"arial, tahoma, helvetica, sans-serif",TOOLTIP_BACKGROUND:"lightyellow",TOOLTIP_FONT_SIZE:"12px",TOOLTIP_COLOR:"black",TOOLTIP_PADDING:"4px 8px",TOOLTIP_BORDER:"1px solid gray",TOOLTIP_BORDER_RADIUS:"6px",TOOLTIP_XOFFSET:12,TOOLTIP_YOFFSET:12,TOOLTIP_BOX_SHADOW:"0px 0px 3px #AAA",TOOLTIP_ZINDEX:1e5,TOOLTIP_INITIAL_DELAY:750,TOOLTIP_RESHOW_DELAY:500,TOOLTIP_DISMISS_DELAY:4e3,ZOOM_MAX:5,ZOOM_MIN:.1,ZOOM_INCREMENT:1.3,ZOOM_ANIMATE:!0,COLUMN_INNER_TEXT:!0,COLUMN_WIDTH:80,COLUMN_HORIZONTAL_ALIGN:"",COLUMN_PROPERTY_TYPE:"accessor",COLUMN_VALUE_TYPE:"string",COLUMN_EDITABLE:!1,COLUMN_SORTABLE:!0,COLUMN_VISIBLE:!0,COLUMN_RESIZABLE:!0,COLUMN_MOVABLE:!0,COLUMN_RENDER_CELL:null,COLUMN_RENDER_HEADER:null,COLUMN_RENDER_EDITOR:null,PROPERTY_INNER_TEXT:!0,PROPERTY_HORIZONTAL_ALIGN:"",PROPERTY_PROPERTY_TYPE:"accessor",PROPERTY_VALUE_TYPE:"string",PROPERTY_EDITABLE:!1,PROPERTY_CATEGORY_NAME:null,PROPERTY_RENDER_NAME:null,PROPERTY_RENDER_VALUE:null,PROPERTY_RENDER_EDITOR:null,TAB_WIDTH:100,TAB_CLOSABLE:!1,TAB_RESIZABLE:!0,TAB_MOVABLE:!0,TAB_DISABLED:!1,TAB_VISIBLE:!0,ACCORDION_EXPAND_ICON:"expand_icon",ACCORDION_COLLAPSE_ICON:"collapse_icon",ACCORDION_TITLE_HEIGHT:20,ACCORDION_TITLE_BACKGROUND:"#EBEBEB",ACCORDION_BORDER_BOTTOM_COLOR:"lightgray",ACCORDION_ICON_POSITION:"left",TITLEPANE_TITLE_HEIGHT:20,TITLEPANE_TITLE_BACKGROUND:"#DDD",TITLEPANE_TITLE_HORIZONTAL_ALIGN:"left",BORDERPANE_HGAP:0,BORDERPANE_VGAP:0,CHARTPANE_TITLE_HEIGHT:20,CHARTPANE_TITLE_HORIZONTAL_ALIGN:"center",CHARTPANE_LEGEND_ORIENTATION:"bottom",CHARTPANE_LEGEND_WIDTH:80,LEGENDPANE_ICON_WIDTH:10,LEGENDPANE_ICON_HEIGHT:10,LEGENDPANE_ICON_RADIUS:0,LEGENDPANE_ROW_HEIGHT:20,LEGENDPANE_ORIENTATION:"horizontal",LEGENDPANE_HIDDEN_COLOR:"#BABBBC",LEGENDPANE_SELECT_BACKGROUND_COLOR:"#00007D",LEGENDPANE_SELECT_FOREGROUND_COLOR:"#FFFFFF",CHART_TOOLTIP_ENABLED:!0,CHART_SELECT_TOLERANCE:0,CHART_XGAP:6,CHART_YGAP:6,CHART_XZOOM_ENABLED:!0,CHART_YZOOM_ENABLED:!0,CHART_XTRANSLATE_ENABLED:!0,CHART_YTRANSLATE_ENABLED:!0,CHART_DOUBLE_CLICK_TO_RESET:!0,CHART_VALUE_VISIBLE:!0,CHART_VALUE_FONT:null,CHART_BACKGROUND_VISIBLE:!1,CHART_BACKGROUND_FILL:!0,CHART_BACKGROUND_FILL_COLOR:"rgba(50,50,50,0.11)",CHART_BACKGROUND_OUTLINE_WIDTH:1,CHART_BACKGROUND_OUTLINE_COLOR:"rgba(50,50,50,0.11)",CHART_BACKGROUND_GRADIENT:"linear.north",CHART_BACKGROUND_GRADIENT_COLOR:"#FFFFFF",PIECHART_TYPE:"oval",PIECHART_START_ANGLE:0,PIECHART_SELECT_OFFSET:5,PIECHART_SHADOW_OFFSET:1,PIECHART_SHADOW_COLOR:"#C2CFF1",PIECHART_LINE_RATE:.5,PIECHART_DONUT_RATE:.5,PIECHART_VALUE_POSITION:.5,BARCHART_TYPE:"default",BARCHART_UPPER_LIMIT:null,BARCHART_LOWER_LIMIT:0,BARCHART_XAXIS_LINE_COLOR:"#808080",BARCHART_XAXIS_LINE_WIDTH:1,BARCHART_XAXIS_TEXT_COLOR:"#000000",BARCHART_XAXIS_TEXT_FONT:null,BARCHART_YAXIS_LINE_COLOR:"#808080",BARCHART_YAXIS_LINE_WIDTH:1,BARCHART_YAXIS_TEXT_COLOR:"#000000",BARCHART_YAXIS_TEXT_FONT:null,BARCHART_XSCALE_TEXT_FONT:null,BARCHART_XSCALE_TEXT_COLOR:"#000000",BARCHART_XSCALE_TEXT_ORIENTATION:"horizontal",BARCHART_YSCALE_TEXT_VISIBLE:!0,BARCHART_YSCALE_TEXT_COLOR:"#000000",BARCHART_YSCALE_TEXT_FONT:null,BARCHART_YSCALE_LINE_COLOR:"#808080",BARCHART_YSCALE_LINE_WIDTH:.3,BARCHART_YSCALE_VALUE_GAP:0,BARCHART_YSCALE_PIXEL_GAP:20,BARCHART_YSCALE_MIN_TEXT_VISIBLE:!1,LINECHART_INTERRUPTABLE:!0,LINECHART_UPPER_LIMIT:null,LINECHART_LOWER_LIMIT:null,LINECHART_XAXIS_LINE_COLOR:"#808080",LINECHART_XAXIS_LINE_WIDTH:1,LINECHART_XAXIS_TEXT_COLOR:"#000000",LINECHART_XAXIS_TEXT_FONT:null,LINECHART_YAXIS_LINE_COLOR:"#808080",LINECHART_YAXIS_LINE_WIDTH:1,LINECHART_YAXIS_TEXT_COLOR:"#000000",LINECHART_YAXIS_TEXT_FONT:null,LINECHART_XSCALE_TEXT_FONT:null,LINECHART_XSCALE_TEXT_COLOR:"#000000",LINECHART_XSCALE_TEXT_ORIENTATION:"horizontal",LINECHART_XSCALE_LINE_COLOR:"#808080",LINECHART_XSCALE_LINE_WIDTH:.3,LINECHART_YSCALE_TEXT_VISIBLE:!0,LINECHART_YSCALE_TEXT_COLOR:"#000000",LINECHART_YSCALE_TEXT_FONT:null,LINECHART_YSCALE_LINE_COLOR:"#808080",LINECHART_YSCALE_LINE_WIDTH:.3,LINECHART_YSCALE_VALUE_GAP:0,LINECHART_YSCALE_PIXEL_GAP:20,LINECHART_YSCALE_MIN_TEXT_VISIBLE:!1,LINECHART_VALUESPANCOUNT:1,BUBBLECHART_UPPER_LIMIT:null,BUBBLECHART_LOWER_LIMIT:null,BUBBLECHART_XAXIS_UPPER_LIMIT:null,BUBBLECHART_XAXIS_LOWER_LIMIT:null,BUBBLECHART_XAXIS_LINE_COLOR:"#808080",BUBBLECHART_XAXIS_LINE_WIDTH:1,BUBBLECHART_XAXIS_TEXT_COLOR:"#000000",BUBBLECHART_XAXIS_TEXT_FONT:null,BUBBLECHART_YAXIS_LINE_COLOR:"#808080",BUBBLECHART_YAXIS_LINE_WIDTH:1,BUBBLECHART_YAXIS_TEXT_COLOR:"#000000",BUBBLECHART_YAXIS_TEXT_FONT:null,BUBBLECHART_XSCALE_TEXT_FONT:null,BUBBLECHART_XSCALE_TEXT_COLOR:"#000000",BUBBLECHART_XSCALE_TEXT_ORIENTATION:"horizontal",BUBBLECHART_XSCALE_LINE_COLOR:"#808080",BUBBLECHART_XSCALE_LINE_WIDTH:.3,BUBBLECHART_YSCALE_TEXT_VISIBLE:!0,BUBBLECHART_YSCALE_TEXT_COLOR:"#000000",BUBBLECHART_YSCALE_TEXT_FONT:null,BUBBLECHART_YSCALE_LINE_COLOR:"#808080",BUBBLECHART_YSCALE_LINE_WIDTH:.3,BUBBLECHART_YSCALE_VALUE_GAP:0,BUBBLECHART_YSCALE_PIXEL_GAP:20,BUBBLECHART_YSCALE_MIN_TEXT_VISIBLE:!1,BUBBLECHART_SELECT_SHADOW_COLOR:"#000000",BUBBLECHART_SELECT_SHADOW_OFFSET:3,RADARCHART_AXIS_TEXT_FONT:null,RADARCHART_AXIS_TEXT_COLOR:"#000000",RADARCHART_AXIS_TEXT_VISIBLE:!0,RADARCHART_SCALE_TEXT_FONT:null,RADARCHART_SCALE_TEXT_COLOR:"#000000",RADARCHART_SCALE_TEXT_VISIBLE:!0,RADARCHART_AXIS_VISIBLE:!0,RADARCHART_AXIS_LINE_COLOR:"#808080",RADARCHART_AXIS_LINE_WIDTH:3,RADARCHART_AXIS_START_ANGLE:0,RADARCHART_RING_VISIBLE:!0,RADARCHART_RING_TYPE:"line",RADARCHART_RING_LINE_COLOR:"#808080",RADARCHART_RING_LINE_WIDTH:1,RADARCHART_SCALE_COUNT:5,RADARCHART_SCALE_MAXVALUE:1,RADARCHART_SCALE_MINVALUE:0,RADARCHART_ANCHOR_VISIBLE:!0,RADARCHART_AREA_FILL:!0,RADARCHART_AREA_FILL_ALPHA:.2,RADARCHART_AREA_SELECT_FILL_ALPHA:.5,DIALCHART_UPPER_LIMIT:100,DIALCHART_LOWER_LIMIT:0,DIALCHART_START_ANGLE:0,DIALCHART_END_ANGLE:360,DIALCHART_INNER_RADIUS:.8,DIALCHART_COLOR_RANGE_FILL_COLOR:"#808080",DIALCHART_OUTLINE_WIDTH:0,DIALCHART_OUTLINE_COLOR:"#808080",DIALCHART_SCALE_INSIDE:!0,DIALCHART_MAJOR_SCALE_COUNT:11,DIALCHART_MAJOR_SCALE_LINE_WIDTH:2,DIALCHART_MAJOR_SCALE_LINE_LENGTH:8,DIALCHART_MAJOR_SCALE_LINE_COLOR:"#000000",DIALCHART_MINOR_SCALE_COUNT:4,DIALCHART_MINOR_SCALE_LINE_WIDTH:1,DIALCHART_MINOR_SCALE_LINE_LENGTH:4,DIALCHART_MINOR_SCALE_LINE_COLOR:"#000000",DIALCHART_SCALE_TEXT_VISIBLE:!0,DIALCHART_SCALE_UPPER_LIMIT_TEXT_VISIBLE:!0,DIALCHART_SCALE_LOWER_LIMIT_TEXT_VISIBLE:!0,DIALCHART_SCALE_TEXT_FONT:null,DIALCHART_SCALE_TEXT_COLOR:"#000000",DIALCHART_PIVOT_RADIUS:10,DIALCHART_PIVOT_FILL:!0,DIALCHART_PIVOT_FILL_COLOR:"#808080",DIALCHART_PIVOT_OUTLINE_WIDTH:0,DIALCHART_PIVOT_OUTLINE_COLOR:"#808080",DIALCHART_VALUE_POSITION:.5,DIALCHART_INNER_DARKER_RADIUS:10,DIALCHART_OUTER_BRIGHTER_RADIUS:10,DIALCHART_SELECT_SHADOW_COLOR:"#000000",DIALCHART_SELECT_SHADOW_OFFSET:3,TABPANE_TAB_GAP:1,TABPANE_TAB_RADIUS:0,TABPANE_TAB_HEIGHT:24,TABPANE_TAB_ORIENTATION:"top",TABPANE_RESIZE_TOLERANCE:3,TABPANE_TAB_BACKGROUND:"#EBEBEB",TABPANE_DISABLED_COLOR:"#BABBBC",TABPANE_SELECT_BACKGROUND:"white",TABPANE_MOVE_BACKGROUND:"rgba(184,211,240,0.7)",TABPANE_INSERT_BACKGROUND:"orange",TABPANE_HORIZONTAL_ALIGN:"center",TABPANE_CLOSE_ICON:"close_icon",TABPANE_SELECT_NEXT_ON_CLOSE:!0,TABPANE_SELECT_NEXT_ON_INVISIBLE:!0,LISTBASE_INNER_TEXT:!0,LIST_ROW_HEIGHT:19,LIST_INDENT:2,LIST_ROW_LINE_WIDTH:0,LIST_ROW_LINE_COLOR:"#DDD",LIST_MAKE_VISIBLE_ON_SELECTED:!0,LIST_KEYBOARD_REMOVE_ENABLED:!0,LIST_KEYBOARD_SELECT_ENABLED:!0,TREE_ROW_HEIGHT:19,TREE_INDENT:16,TREE_ROW_LINE_WIDTH:0,TREE_ROW_LINE_COLOR:"#DDD",TREE_MAKE_VISIBLE_ON_SELECTED:!0,TREE_KEYBOARD_REMOVE_ENABLED:!0,TREE_KEYBOARD_SELECT_ENABLED:!0,TREE_EXPAND_ICON:"expand_icon",TREE_COLLAPSE_ICON:"collapse_icon",TREE_LINE_TYPE:"none",TREE_LINE_THICKNESS:2,TREE_LINE_COLOR:"#000000",TREE_LINE_ALPHA:1,TREE_LINE_DASH:[4,2],TABLE_ROW_HEIGHT:19,TABLE_ROW_LINE_WIDTH:1,TABLE_ROW_LINE_COLOR:"#DDD",TABLE_COLUMN_LINE_WIDTH:1,TABLE_COLUMN_LINE_COLOR:"#DDD",TABLE_MAKE_VISIBLE_ON_SELECTED:!0,TABLE_KEYBOARD_REMOVE_ENABLED:!0,TABLE_KEYBOARD_SELECT_ENABLED:!0,TABLE_EDITABLE:!1,TABLEHEADER_HEIGHT:24,TABLEHEADER_RESIZE_TOLERANCE:3,TABLEHEADER_BACKGROUND:"#EBEBEB",TABLEHEADER_MOVE_BACKGROUND:"rgba(184,211,240,0.7)",TABLEHEADER_INSERT_BACKGROUND:"orange",TABLEHEADER_COLUMN_LINE_COLOR:"#DDD",TABLEHEADER_SORT_DESC_ICON:"sort_desc",TABLEHEADER_SORT_ASC_ICON:"sort_asc",TABLEHEADER_SORT_ICON_POSITION:"98% 50%",TREETABLE_ROW_HEIGHT:19,TREETABLE_INDENT:16,TREETABLE_ROW_LINE_WIDTH:1,TREETABLE_ROW_LINE_COLOR:"#DDD",TREETABLE_COLUMN_LINE_WIDTH:1,TREETABLE_COLUMN_LINE_COLOR:"#DDD",TREETABLE_MAKE_VISIBLE_ON_SELECTED:!0,TREETABLE_KEYBOARD_REMOVE_ENABLED:!0,TREETABLE_KEYBOARD_SELECT_ENABLED:!0,TREETABLE_EXPAND_ICON:"expand_icon",TREETABLE_COLLAPSE_ICON:"collapse_icon",TREETABLE_EDITABLE:!1,PROPERTYSHEET_AUTO_ADJUSTABLE:!0,PROPERTYSHEET_INDENT:16,PROPERTYSHEET_ROW_HEIGHT:19,PROPERTYSHEET_ROW_LINE_WIDTH:1,PROPERTYSHEET_COLUMN_LINE_WIDTH:1,PROPERTYSHEET_BORDER_COLOR:"#EBEBEB",PROPERTYSHEET_EXPAND_ICON:"expand_icon",PROPERTYSHEET_COLLAPSE_ICON:"collapse_icon",PROPERTYSHEET_PROPERTY_NAME_WIDTH:100,PROPERTYSHEET_PROPERTY_NAME_HORIZONTAL_ALIGN:"",PROPERTYSHEET_SUM_WIDTH:200,PROPERTYSHEET_RESIZE_TOLERANCE:3,PROPERTYSHEET_EDITABLE:!1,PROPERTYSHEET_CATEGORIZABLE:!0,PROPERTYSHEET_EXPAND_CATEGORY:!0,POPUPMENU_SUBNENU_ENABLE_ICON:"submenu_enable_icon",POPUPMENU_SUBNENU_DISABLE_ICON:"submenu_disable_icon",POPUPMENU_CHECKBOX_SELECTED_ICON:"checkbox_selected_icon",POPUPMENU_CHECKBOX_UNSELECTED_ICON:"checkbox_unselected_icon",POPUPMENU_RADIOBUTTON_SELECTED_ICON:"radiobutton_selected_icon",POPUPMENU_RADIOBUTTON_UNSELECTED_ICON:"radiobutton_unselected_icon",SPLITPANE_ORIENTATION:"horizontal",SPLITPANE_POSITION:.5,SPLITPANE_DIVIDER_WIDTH:6,SPLITPANE_DIVIDER_BACKGROUND:"#CCCCFF",SPLITPANE_DIVIDER_OPACITY:.5,SPLITPANE_MASK_BACKGROUND:"",SPLITPANE_UP_EXPAND_ICON:"up_expand_icon",SPLITPANE_DOWN_EXPAND_ICON:"down_expand_icon",SPLITPANE_LEFT_EXPAND_ICON:"left_expand_icon",SPLITPANE_RIGHT_EXPAND_ICON:"right_expand_icon",NODE_WIDTH:50,NODE_HEIGHT:50,IMAGE_NODE:"node_image",IMAGE_GROUP:"group_image",IMAGE_SUBNETWORK:"subnetwork_image",ICON_DATABOX:"databox_icon",ICON_DATA:"data_icon",ICON_NODE:"node_icon",ICON_LINK:"link_icon",ICON_GROUP:"group_icon",ICON_SUBNETWORK:"subnetwork_icon",ICON_GRID:"grid_icon",ICON_BUS:"bus_icon",ICON_SHAPENODE:"shapenode_icon",ICON_SHAPELINK:"shapelink_icon",ICON_LINKSUBNETWORK:"linksubnetwork_icon",ICON_SHAPESUBNETWORK:"shapesubnetwork_icon",LAYER_DEFAULT_ID:"default",LAYER_DEFAULT_NAME:"default",ATTACHMENT_POINTER_LENGTH:10,ATTACHMENT_POINTER_WIDTH:8,ATTACHMENT_CORNER_RADIUS:5,ATTACHMENT_CONTENT_WIDTH:30,ATTACHMENT_CONTENT_HEIGHT:20,ATTACHMENT_POSITION:"topright.topright",ATTACHMENT_XOFFSET:0,ATTACHMENT_YOFFSET:0,ATTACHMENT_PADDING:0,ATTACHMENT_PADDING_LEFT:0,ATTACHMENT_PADDING_RIGHT:0,ATTACHMENT_PADDING_TOP:0,ATTACHMENT_PADDING_BOTTOM:0,ATTACHMENT_DIRECTION:"right",ATTACHMENT_FILL:!1,ATTACHMENT_FILL_COLOR:"#000000",ATTACHMENT_GRADIENT:null,ATTACHMENT_GRADIENT_COLOR:"#FFFFFF",ATTACHMENT_OUTLINE_WIDTH:-1,ATTACHMENT_OUTLINE_COLOR:"#000000",ATTACHMENT_CAP:"butt",ATTACHMENT_JOIN:"miter",ATTACHMENT_SHADOWABLE:!0,NETWORK_TOOLTIP_ENABLED:!0,NETWORK_SELECT_MODE:"mix",NETWORK_MAKE_VISIBLE_ON_SELECTED:!0,NETWORK_NO_AGENT_LINK_VISIBLE:!1,NETWORK_REMOVE_ELEMENTUI_ON_INVISIBLE:!1,NETWORK_SUBNETWORK_ANIMATE:!0,NETWORK_SENDTOTOP_ON_SELECTED:!0,NETWORK_KEYBOARD_REMOVE_ENABLED:!0,NETWORK_KEYBOARD_SELECT_ENABLED:!0,NETWORK_RECT_SELECT_ENABLED:!0,NETWORK_DOUBLECLICK_TO_SUBNETWORK:!0,NETWORK_DOUBLECLICK_TO_UPSUBNETWORK:!0,NETWORK_DOUBLECLICK_TO_EMPTYSUBNETWORK:!0,NETWORK_DOUBLECLICK_TO_LINKBUNDLE:!0,NETWORK_DOUBLECLICK_TO_GROUPEXPAND:!0,NETWORK_SELECT_OUTLINE_COLOR:"#2877A8",NETWORK_SELECT_OUTLINE_WIDTH:1,NETWORK_SELECT_FILL_COLOR:"rgba(184,211,240,0.4)",NETWORK_LAZYMOVE_OUTLINE_COLOR:"#2877A8",NETWORK_LAZYMOVE_OUTLINE_WIDTH:1,NETWORK_LAZYMOVE_FILL_COLOR:"rgba(184,211,240,0.4)",NETWORK_LAZYMOVE_FILL:!0,NETWORK_LAZYMOVE_ANIMATE:!0,NETWORK_RESIZE_POINT_SIZE:3,NETWORK_RESIZE_POINT_FILL_COLOR:"#FFFFFF",NETWORK_RESIZE_POINT_OUTLINE_COLOR:"#000000",NETWORK_RESIZE_POINT_OUTLINE_WIDTH:1,NETWORK_RESIZE_LINE_COLOR:"#000000",NETWORK_RESIZE_LINE_WIDTH:1,NETWORK_RESIZE_ANIMATE:!0,NETWORK_EDIT_POINT_SIZE:3,NETWORK_EDIT_POINT_FILL_COLOR:"#FFFF00",NETWORK_EDIT_POINT_OUTLINE_COLOR:"#000000",NETWORK_EDIT_POINT_OUTLINE_WIDTH:1,NETWORK_EDIT_LINE_COLOR:"rgba(184,211,240,0.7)",NETWORK_EDIT_LINE_WIDTH:2,NETWORK_ROTATE_POINT_SIZE:5,NETWORK_ROTATE_POINT_FILL_COLOR:"#FFFF00",NETWORK_ROTATE_POINT_OFFSET:15,NETWORK_ROTATE_POINT_OUTLINE_WIDTH:1,NETWORK_ROTATE_POINT_OUTLINE_COLOR:"rgba(0,0,0,1)",NETWORK_ROTATE_SCALE_FILL_COLOR:"rgb(227,166,103)",NETWORK_ROTATE_SCALE_FONT_COLOR:"#FFFFFF",NETWORK_ROTATE_SCALE_WIDTH:30,NETWORK_ROTATE_SCALE_HEIGHT:20,NETWORK_LIMIT_ELEMENT_INPOSITIVE_LOCATION:!0,NETWORK_LINK_FLOW_STEPPING:3,NETWORK_LINK_FLOW_COLOR:"#FF0000",NETWORK_LINK_FLOW_INTERVAL:600,NETWORK_SELECTION_TOLERANCE:2,NETWORK_TRANSPARENT_SELECTION_ENABLE:!1,SHOW_ALARM_IN_ATTACHMENT_DIV:!0,SHOW_LABEL_IN_ATTACHMENT_DIV:!1,SHOW_LABEL2_IN_ATTACHMENT_DIV:!1,SHOW_ICON_IN_ATTACHMENT_DIV:!1,SHOW_EDIT_IN_ATTACHMENT_DIV:!1,OVERVIEW_FILL_COLOR:"rgba(184,211,240,0.4)",OVERVIEW_OUTLINE_COLOR:"#B8D3F0",OVERVIEW_OUTLINE_WIDTH:1,OVERVIEW_SELECT_COLOR:"#0000FF",OVERVIEW_SELECT_WIDTH:1,OVERVIEW_PADDING:1,OVERVIEW_ANIMATE:!0,OVERVIEW_MAX_PACKING_WIDTH:-1,OVERVIEW_MAX_PACKING_HEIGHT:-1,TOUCH_MOVE_THRESHOLD:5,TOUCH_RECT_SELECT_THRESHOLD:20,TOUCH_ZOOM_THRESHOLD:30,LINK_BUNDLE_AGENT_FUNCTION:null,IS_LINK_ADJUSTED_TO_BOTTOM:!1,GROUP_EXPAND_ALIGN:"center",ELEMENTUI_FUNCTION:function(a,b){var c=b.getElementUIClass();return c?new c(a,b):null},CANVASUI_FUNCTION:function(a,b){var c=b.getCanvasUIClass();return c?new c(a,b):null},VECTORUI_FUNCTION:function(a,b){var c=b.getVectorUIClass();return c?new c(a,b):null},KEEP_DEFAULT_FUNCTION:function(a){return a.target.keepDefault||a.target.getAttribute("keepDefault")?!0:a.target.parentNode&&(a.target.parentNode.keepDefault||a.target.parentNode.getAttribute("keepDefault"))?!0:a.shiftKey?!0:!1},SORT_FUNCTION:function(a,c){if(a===c)return 0;if(null==a&&null!=c)return 1;if(null!=a&&null==c)return-1;if(null==a&&null==c)return 0;var d,e=typeof a,f=typeof c;return"string"===e&&"string"===f&&(d=a.localeCompare(c)),"number"===e&&"number"===f&&(d=a-c),d===b&&(d=(""+a).localeCompare(""+c)),d>0?1:0>d?-1:0},CENTER_LOCATION:!1,PIXEL_FILTER_FUNCTION:function(a,b){if(!b)return a;var c=.3*a.r+.59*a.g+.11*a.b;return{r:Math.floor(b.r*c/255),g:Math.floor(b.g*c/255),b:Math.floor(b.b*c/255)}}};!function(){var b=Ed;if(a.OverrideTWaverDefaults)for(var c in OverrideTWaverDefaults)b[c]=OverrideTWaverDefaults[c];b.FONT=b.VIEW_FONT_SIZE&&b.VIEW_FONT_FAMILY?b.VIEW_FONT_SIZE+" "+b.VIEW_FONT_FAMILY:Ob.createElement("canvas").getContext("2d").font,b.CHART_VALUE_FONT||(b.CHART_VALUE_FONT="10px "+b.VIEW_FONT_FAMILY),b.BARCHART_XSCALE_TEXT_FONT||(b.BARCHART_XSCALE_TEXT_FONT="10px "+b.VIEW_FONT_FAMILY),b.BARCHART_YSCALE_TEXT_FONT||(b.BARCHART_YSCALE_TEXT_FONT="10px "+b.VIEW_FONT_FAMILY),b.BARCHART_XAXIS_TEXT_FONT||(b.BARCHART_XAXIS_TEXT_FONT="12px "+b.VIEW_FONT_FAMILY),b.BARCHART_YAXIS_TEXT_FONT||(b.BARCHART_YAXIS_TEXT_FONT="12px "+b.VIEW_FONT_FAMILY),b.LINECHART_XSCALE_TEXT_FONT||(b.LINECHART_XSCALE_TEXT_FONT="10px "+b.VIEW_FONT_FAMILY),b.LINECHART_YSCALE_TEXT_FONT||(b.LINECHART_YSCALE_TEXT_FONT="10px "+b.VIEW_FONT_FAMILY),b.LINECHART_XAXIS_TEXT_FONT||(b.LINECHART_XAXIS_TEXT_FONT="12px "+b.VIEW_FONT_FAMILY),b.LINECHART_YAXIS_TEXT_FONT||(b.LINECHART_YAXIS_TEXT_FONT="12px "+b.VIEW_FONT_FAMILY),b.BUBBLECHART_XAXIS_TEXT_FONT||(b.BUBBLECHART_XAXIS_TEXT_FONT="12px "+b.VIEW_FONT_FAMILY),b.BUBBLECHART_YAXIS_TEXT_FONT||(b.BUBBLECHART_YAXIS_TEXT_FONT="12px "+b.VIEW_FONT_FAMILY),b.BUBBLECHART_XSCALE_TEXT_FONT||(b.BUBBLECHART_XSCALE_TEXT_FONT="10px "+b.VIEW_FONT_FAMILY),b.BUBBLECHART_YSCALE_TEXT_FONT||(b.BUBBLECHART_YSCALE_TEXT_FONT="10px "+b.VIEW_FONT_FAMILY),b.RADARCHART_AXIS_TEXT_FONT||(b.RADARCHART_AXIS_TEXT_FONT="12px "+b.VIEW_FONT_FAMILY),b.RADARCHART_SCALE_TEXT_FONT||(b.RADARCHART_SCALE_TEXT_FONT="10px "+b.VIEW_FONT_FAMILY),b.DIALCHART_SCALE_TEXT_FONT||(b.DIALCHART_SCALE_TEXT_FONT="10px "+b.VIEW_FONT_FAMILY)}(),Ib.Defaults=Ed,Jb.ext("twaver.Defaults",Object,{}),Ib.Colors={orange:"#EC6C00",orange_light:"#EF8200",orange_dark:"#EA5404",gray_light:"#666666",gray_dark:"#242424",green_light:"#57AB9A",green_dark:"#238475",blue_light:"#61B6D8",blue_dark:"#0089C1"},Ib.SerializationSettings=function(){var a=Ib.SerializationSettings;this.isDataBoxSerializable=a.isDataBoxSerializable,this.isLayerBoxSerializable=a.isLayerBoxSerializable,this.isStyleSerializable=a.isStyleSerializable,this.isClientSerializable=a.isClientSerializable,this.isImageSerializable=a.isImageSerializable,this._pm=Jb.clone(a._pm),this._sm=Jb.clone(a._sm),this._cm=Jb.clone(a._cm)},function(){var a=Ib.SerializationSettings;a.isDataBoxSerializable=!0,a.isLayerBoxSerializable=!0,a.isStyleSerializable=!0,a.isClientSerializable=!0,a.isImageSerializable=!0,a._pm={},a._sm={},a._cm={},a.setPropertyType=function(b,c){a._pm[b]=c},a.getPropertyType=function(b){return a._pm[b]},a.setStyleType=function(b,c){a._sm[b]=c},a.getStyleType=function(b){return a._sm[b]},a.setClientType=function(b,c){a._cm[b]=c},a.getClientType=function(b){return a._cm[b]}}(),Jb.ext("twaver.SerializationSettings",Object,{setPropertyType:function(a,b){this._pm[a]=b},getPropertyType:function(a){return this._pm[a]},setStyleType:function(a,b){this._sm[a]=b},getStyleType:function(a){return this._sm[a]},setClientType:function(a,b){this._cm[a]=b},getClientType:function(a){return this._cm[a]}}),Ib.Styles={_m:{},setStyle:function(a,b){null==b?delete Ib.Styles._m[a]:Ib.Styles._m[a]=b},getStyle:function(a){return Ib.Styles._m[a]},getStyleProperties:function(){return Jb.keys(Ib.Styles._m)}},function(){var a=function(a,b){Ib.SerializationSettings.setPropertyType(a,b)};a("name","cdata"),a("name2","cdata"),a("icon","string"),a("toolTip","cdata"),a("parent","data"),a("layerId","string"),a("alarmState","alarmstate"),a("image","string"),a("imageUrl","string"),a("location","point"),a("width","number"),a("height","number"),a("expanded","boolean"),a("host","data"),a("fromNode","data"),a("toNode","data"),a("points","list.point"),a("segments","list.string"),a("angle","number"),a("visible","boolean"),a=function(a,b,c){null==c&&(c=null!=b?typeof b:"string"),Ib.Styles.setStyle(a,b),Ib.SerializationSettings.setStyleType(a,c)},a("chart.color",null),a("chart.value",0),a("chart.values",null,"list.number"),a("chart.value.color","#000000"),a("chart.value.font",null),a("chart.line.width",2),a("chart.marker.size",6),a("chart.marker.shape","circle"),a("chart.bubble.shape","circle"),a("chart.names",null,"list.string"),a("chart.xaxis.values",null,"list.number"),a("chart.yaxis.values",null,"list.number"),a("dialchart.rear.extension",0),a("dialchart.base.width",5),a("dialchart.top.width",0),a("dialchart.radius",.8),a("inner.color",null),a("outer.shape","rectangle"),a("outer.color",null),a("outer.width",2),a("outer.padding",1),a("outer.padding.left",0),a("outer.padding.right",0),a("outer.padding.top",0),a("outer.padding.bottom",0),a("outer.cap","butt"),a("outer.join","miter"),a("outer.style","border"),a("shadow.color",null),a("shadow.xoffset",3),a("shadow.yoffset",3),a("shadow.blur",6),a("select.style","shadow"),a("select.color","rgba(0, 0, 0, 0.7)"),a("select.shape","rectangle"),a("select.width",2),a("select.padding",2),a("select.padding.left",0),a("select.padding.right",0),a("select.padding.top",0),a("select.padding.bottom",0),a("select.cap","butt"),a("select.join","miter"),a("whole.alpha",1),a("body.type","default"),a("network.label",null,"cdata"),a("image.padding",0),a("image.padding.left",0),a("image.padding.right",0),a("image.padding.top",0),a("image.padding.bottom",0),a("image.state",null),a("vector.shape","rectangle"),a("vector.fill",!0),a("vector.fill.color","#CCCCFF"),a("vector.outline.width",-1),a("vector.outline.pattern",null,"array.number"),a("vector.outline.color","#5B5B5B"),a("vector.gradient","none"),a("vector.gradient.color","#FFFFFF"),a("vector.padding",0),a("vector.padding.left",0),a("vector.padding.right",0),a("vector.padding.top",0),a("vector.padding.bottom",0),a("vector.cap","butt"),a("vector.join","miter"),a("vector.deep",0),a("group.shape","rectangle"),a("group.fill",!0),a("group.fill.color","#CCCCFF"),a("group.outline.width",-1),a("group.outline.color","#5B5B5B"),a("group.gradient","none"),a("group.gradient.color","#FFFFFF"),a("group.padding",5),a("group.padding.left",0),a("group.padding.right",0),a("group.padding.top",0),a("group.padding.bottom",0),a("group.cap","butt"),a("group.join","miter"),a("group.deep",1),a("group.shape.roundrect.radius",-1),a("group.expend.image",null),a("group.expend.image.vector",!1),a("label.alpha",1),a("label.color","#000000"),a("label.font",null),a("label.position","bottom.bottom"),a("label.direction","below"),a("label.corner.radius",0),a("label.pointer.length",0),a("label.pointer.width",8),a("label.xoffset",0),a("label.yoffset",2),a("label.padding",0),a("label.padding.left",0),a("label.padding.right",0),a("label.padding.top",0),a("label.padding.bottom",0),a("label.fill",!1),a("label.fill.color","#C0C0C0"),a("label.gradient","none"),a("label.gradient.color","#FFFFFF"),a("label.outline.width",-1),a("label.outline.color","#000000"),a("label.cap","butt"),a("label.join","miter"),a("label.shadowable",!0),a("label.align","center"),a("label.rotate.angle",0),a("label.maxlength",0),a("link.label.rotatable",!1),a("label2.alpha",1),a("label2.color","#000000"),a("label2.font",null),a("label2.position","top.top"),a("label2.direction","below"),a("label2.corner.radius",0),a("label2.pointer.length",0),a("label2.pointer.width",8),a("label2.xoffset",0),a("label2.yoffset",-2),a("label2.padding",0),a("label2.padding.left",0),a("label2.padding.right",0),a("label2.padding.top",0),a("label2.padding.bottom",0),a("label2.fill",!1),a("label2.fill.color","#C0C0C0"),a("label2.gradient","none"),a("label2.gradient.color","#FFFFFF"),a("label2.outline.width",-1),a("label2.outline.color","#000000"),a("label2.cap","butt"),a("label2.join","miter"),a("label2.shadowable",!0),a("label2.align","center"),a("label2.rotate.angle",0),a("label2.maxlength",0),a("link.label2.rotatable",!1),a("icons.names",null,"array.string"),a("icons.colors",null,"array.string"),a("icons.position",null,"array.string"),a("icons.orientation",null,"array.string"),a("icons.xoffset",[0],"array.number"),a("icons.yoffset",[0],"array.number"),a("icons.xgap",[1],"array.number"),a("icons.ygap",[1],"array.number"),a("alarm.alpha",1),a("alarm.color","#000000"),a("alarm.font",null),a("alarm.position","hotspot"),a("alarm.direction","aboveright"),a("alarm.corner.radius",5),a("alarm.pointer.length",10),a("alarm.pointer.width",8),a("alarm.xoffset",0),a("alarm.yoffset",0),a("alarm.padding",0),a("alarm.padding.left",0),a("alarm.padding.right",0),a("alarm.padding.top",0),a("alarm.padding.bottom",0),a("alarm.gradient","none"),a("alarm.gradient.color","#FFFFFF"),a("alarm.outline.width",-1),a("alarm.outline.color","#000000"),a("alarm.cap","butt"),a("alarm.join","miter"),a("alarm.shadowable",!0),a("link.color","#658DC1"),a("link.width",3),a("link.cap","butt"),a("link.join","miter"),a("link.type","arc"),a("link.pattern",null,"array.number"),a("link.extend",20),a("link.control.point",null,"point"),a("link.bundle.id",0),a("link.bundle.enable",!0),a("link.bundle.expanded",!0),a("link.bundle.independent",!1),a("link.bundle.offset",20),a("link.bundle.gap",12),a("link.bundle.group.gap",0),a("link.looped.gap",6),a("link.looped.direction","northwest"),a("link.looped.type","arc"),a("link.from.position","center"),a("link.from.xoffset",0),a("link.from.yoffset",0),a("link.from.percent",null),a("link.from.at.edge",!0),a("link.to.position","center"),a("link.to.xoffset",0),a("link.to.yoffset",0),a("link.to.percent",null),a("link.to.at.edge",!0),a("link.split.by.percent",!0),a("link.split.percent",.5),a("link.split.value",20),a("link.corner","round"),a("link.xradius",8),a("link.yradius",8),a("link.flow",!1),a("link.flow.converse",!1),a("link.flow.offset",0),a("link.handler.alpha",1),a("link.handler.color","#000000"),a("link.handler.font",null),a("link.handler.position","topleft.topleft"),a("link.handler.direction","below"),a("link.handler.corner.radius",0),a("link.handler.pointer.length",0),a("link.handler.pointer.width",8),a("link.handler.xoffset",0),a("link.handler.yoffset",0),a("link.handler.padding",0),a("link.handler.padding.left",0),a("link.handler.padding.right",0),a("link.handler.padding.top",0),a("link.handler.padding.bottom",0),a("link.handler.fill",!1),a("link.handler.fill.color","#C0C0C0"),a("link.handler.gradient","none"),a("link.handler.gradient.color","#FFFFFF"),a("link.handler.outline.width",-1),a("link.handler.outline.color","#000000"),
a("link.handler.cap","butt"),a("link.handler.join","miter"),a("link.handler.shadowable",!0),a("link.agent",!1),a("link.agent.color","#658DC1"),a("link.agent.width",3),a("link.agent.cap","butt"),a("link.agent.join","miter"),a("link.agent.type","arc"),a("link.agent.pattern",null,"array.number"),a("link.agent.extend",20),a("link.agent.control.point",null,"point"),a("link.agent.from.position","center"),a("link.agent.from.xoffset",0),a("link.agent.from.yoffset",0),a("link.agent.from.percent",null),a("link.agent.from.at.edge",!0),a("link.agent.to.position","center"),a("link.agent.to.xoffset",0),a("link.agent.to.yoffset",0),a("link.agent.to.percent",null),a("link.agent.to.at.edge",!0),a("link.agent.split.by.percent",!0),a("link.agent.split.percent",.5),a("link.agent.split.value",20),a("link.agent.corner","round"),a("link.agent.xradius",8),a("link.agent.yradius",8),a("link.agent.flow",!1),a("link.agent.flow.converse",!1),a("link.agent.flow.offset",0),a("follower.row.index",0),a("follower.column.index",0),a("follower.row.span",1),a("follower.column.span",1),a("follower.padding",0),a("follower.padding.left",0),a("follower.padding.right",0),a("follower.padding.top",0),a("follower.padding.bottom",0),a("follower.fill.cell",!0),a("follower.cell.position","center"),a("glow.blur",20),a("grid.row.count",1),a("grid.column.count",1),a("grid.row.percents",null,"array.number"),a("grid.column.percents",null,"array.number"),a("grid.border",1),a("grid.border.left",0),a("grid.border.right",0),a("grid.border.top",0),a("grid.border.bottom",0),a("grid.padding",1),a("grid.padding.left",0),a("grid.padding.right",0),a("grid.padding.top",0),a("grid.padding.bottom",0),a("grid.fill",!0),a("grid.fill.color","#C0C0C0"),a("grid.deep",1),a("grid.cell.deep",-1),a("shapelink.type","lineto"),a("shapenode.closed",!1),a("shapenode.pattern",null,"array.number"),a("bus.style","nearby"),a("arrow.from",!1),a("arrow.from.fill",!0),a("arrow.from.shape","arrow.standard"),a("arrow.from.color","#000000"),a("arrow.from.xoffset",0),a("arrow.from.yoffset",0),a("arrow.from.width",12),a("arrow.from.height",9),a("arrow.from.outline.color","#000000"),a("arrow.from.outline.width",-1),a("arrow.from.at.edge",!0),a("arrow.from.shadow",!1),a("arrow.from.shadow.color","#000000"),a("arrow.from.shadow.xoffset",0),a("arrow.from.shadow.yoffset",0),a("arrow.from.shadow.blur",16),a("arrow.to",!1),a("arrow.to.fill",!0),a("arrow.to.shape","arrow.standard"),a("arrow.to.color","#000000"),a("arrow.to.xoffset",0),a("arrow.to.yoffset",0),a("arrow.to.width",12),a("arrow.to.height",9),a("arrow.to.outline.color","#000000"),a("arrow.to.outline.width",-1),a("arrow.to.at.edge",!0),a("arrow.agent.from",!1),a("arrow.agent.from.fill",!0),a("arrow.agent.from.shape","arrow.standard"),a("arrow.agent.from.color","#000000"),a("arrow.agent.from.xoffset",0),a("arrow.agent.from.yoffset",0),a("arrow.agent.from.width",12),a("arrow.agent.from.height",9),a("arrow.agent.from.outline.color","#000000"),a("arrow.agent.from.outline.width",-1),a("arrow.agent.from.at.edge",!0),a("arrow.agent.from.shadow",!1),a("arrow.agent.from.shadow.color","#000000"),a("arrow.agent.from.shadow.xoffset",0),a("arrow.agent.from.shadow.yoffset",0),a("arrow.agent.from.shadow.blur",16),a("arrow.agent.to",!1),a("arrow.agent.to.fill",!0),a("arrow.agent.to.shape","arrow.standard"),a("arrow.agent.to.color","#000000"),a("arrow.agent.to.xoffset",0),a("arrow.agent.to.yoffset",0),a("arrow.agent.to.width",12),a("arrow.agent.to.height",9),a("arrow.agent.to.outline.color","#000000"),a("arrow.agent.to.outline.width",-1),a("arrow.agent.to.at.edge",!0),a("background.image",null),a("background.image.scope","viewport"),a("background.type","none"),a("background.outline.width",-1),a("background.outline.color",null),a("background.vector.padding",0),a("background.image.padding",0),a("background.image.stretch","fill"),a("background.vector.scope","viewport"),a("background.vector.fill",null),a("background.vector.fill.color",null),a("background.vector.gradient",!1),a("background.vector.gradient.color",null),a("background.vector.shape","rectangle"),a("background.outline.pattern",null,"array.number"),a("attachment.label.style","html"),a("attachment.label2.style","html"),a("attachment.alarm.style","html"),a("attachment.htmllabel.hyperlink",!1),a("attachment.htmllabel2.hyperlink",!1)}(),Jb.ext("twaver.Styles",Object,{}),Ib.PropertyChangeDispatcher=function(){this._dispatcher=new Ib.EventDispatcher},Jb.ext("twaver.PropertyChangeDispatcher",Object,{addPropertyChangeListener:function(a,b,c){this._dispatcher.add(a,b,c)},removePropertyChangeListener:function(a,b){this._dispatcher.remove(a,b)},firePropertyChange:function(a,b,c){if(b==c)return!1;var d={property:a,oldValue:b,newValue:c,source:this};return this._dispatcher.fire(d),this.onPropertyChanged(d),!0},onPropertyChanged:function(a){}}),Ib.animate.Animate=function(){},Jb.ext("twaver.animate.Animate",Object,{current:0,step:8,delay:4,finishFunction:null,shouldBeFinished:!1,getCurrentDelay:function(){return this.delay*this.current+1},action:function(a){}}),Ib.animate.AnimateProperty=function(a,b,c){this.objects=a,this.newValues=b,this.finishFunction=c,this.oldValues=new nd;for(var d=this.objects.size(),e=0;d>e;e++){var f=this.objects.get(e);this.oldValues.add(this.getPropertyValue(f))}},Jb.ext("twaver.animate.AnimateProperty",Ib.animate.Animate,{action:function(a){for(var b=this.objects.size(),c=0;b>c;c++){var d=this.objects.get(c),e=this.oldValues.get(c),f=this.newValues.get(c);this.currentAction(d,e,f,a)}},getPropertyValue:function(a){},currentAction:function(a,b,c,d){}}),Ib.animate.AnimateBounds=function(a,b,c){this.node=a,this.newBounds=b,this.oldBounds=a.getRect(),this.finishFunction=c},Jb.ext("twaver.animate.AnimateBounds",Ib.animate.Animate,{shouldBeFinished:!0,action:function(a){var b=this.oldBounds,c=this.newBounds;this.node.setLocation(b.x+(c.x-b.x)*a,b.y+(c.y-b.y)*a),this.node.setSize(b.width+(c.width-b.width)*a,b.height+(c.height-b.height)*a)}}),Ib.animate.AnimateCenterLocation=function(a,b,c){Ib.animate.AnimateCenterLocation.superClass.constructor.call(this,a,b,c)},Jb.ext("twaver.animate.AnimateCenterLocation",Ib.animate.AnimateProperty,{getPropertyValue:function(a){return a.getCenterLocation()},currentAction:function(a,b,c,d){var e=b.x+(c.x-b.x)*d,f=b.y+(c.y-b.y)*d;a.setCenterLocation(e,f)}}),Ib.animate.AnimateLocation=function(a,b,c){Ib.animate.AnimateLocation.superClass.constructor.call(this,a,b,c)},Jb.ext("twaver.animate.AnimateLocation",Ib.animate.AnimateProperty,{getPropertyValue:function(a){return a.getLocation()},currentAction:function(a,b,c,d){var e=b.x+(c.x-b.x)*d,f=b.y+(c.y-b.y)*d;a.setLocation(e,f)}}),Ib.animate.AnimateScrollPosition=function(a,b,c){this.view=a,this.oldHorizontalOffset=a.scrollLeft,this.oldVerticalOffset=a.scrollTop,this.newHorizontalOffset=b,this.newVerticalOffset=c},Jb.ext("twaver.animate.AnimateScrollPosition",Ib.animate.Animate,{action:function(a){this.view.scrollLeft=this.oldHorizontalOffset+(this.newHorizontalOffset-this.oldHorizontalOffset)*a,this.view.scrollTop=this.oldVerticalOffset+(this.newVerticalOffset-this.oldVerticalOffset)*a}}),Ib.animate.AnimateZoom=function(a,b,c){this.view=a,this.oldZoom=a.getZoom(),this.newZoom=b,this.finishFunction=c},Jb.ext("twaver.animate.AnimateZoom",Ib.animate.Animate,{shouldBeFinished:!0,action:function(a){this.view.setZoom(this.oldZoom+(this.newZoom-this.oldZoom)*a,!1)}}),Ib.animate.AnimateXZoom=function(a,b,c){this.view=a,this.oldXZoom=a.getXZoom(),this.newXZoom=b,this.finishFunction=c},Jb.ext("twaver.animate.AnimateXZoom",Ib.animate.Animate,{shouldBeFinished:!0,action:function(a){this.view.setXZoom(this.oldXZoom+(this.newXZoom-this.oldXZoom)*a,!1)}}),Ib.animate.AnimateYZoom=function(a,b,c){this.view=a,this.oldYZoom=a.getYZoom(),this.newYZoom=b,this.finishFunction=c},Jb.ext("twaver.animate.AnimateYZoom",Ib.animate.Animate,{shouldBeFinished:!0,action:function(a){this.view.setYZoom(this.oldYZoom+(this.newYZoom-this.oldYZoom)*a,!1)}}),Ib.animate.AnimateXYZoom=function(a,b,c,d){this.view=a,this.oldXZoom=a.getXZoom(),this.newXZoom=b,this.oldYZoom=a.getYZoom(),this.newYZoom=c,this.finishFunction=d},Jb.ext("twaver.animate.AnimateXYZoom",Ib.animate.Animate,{shouldBeFinished:!0,action:function(a){this.view.setXZoom(this.oldXZoom+(this.newXZoom-this.oldXZoom)*a,!1),this.view.setYZoom(this.oldYZoom+(this.newYZoom-this.oldYZoom)*a,!1)}}),Ib.animate.AnimateSubNetwork=function(a,b,c){this.network=a,this.subNetwork=b,this.finishFunction=c},Jb.ext("twaver.animate.AnimateSubNetwork",Ib.animate.Animate,{shouldBeFinished:!0,action:function(a){a>.5?(this.network.getView().style.opacity=2*a-1,this.network._setCurrentSubNetwork(this.subNetwork)):this.network.getView().style.opacity=1-2*a}}),Ib.animate.AnimateManager={timer:null,animate:null,start:function(a,b){var c=Ib.animate.AnimateManager;a.current<0&&(a.current=0),b?Jb.callLater(c.startImpl,null,[a],b):c.startImpl(a)},startImpl:function(a){var b=Ib.animate.AnimateManager;b.animate&&b.endAnimate(),b.animate=a,b.timer=setTimeout(b.tick,a.getCurrentDelay())},tick:function(){var a=Ib.animate.AnimateManager,b=a.animate;if(b){if(b.current<0)return void b.current++;b.current<b.step&&(b.current++,b.action(b.current/b.step),a.timer=setTimeout(a.tick,b.getCurrentDelay())),b.current>=b.step&&a.endAnimate()}},endAnimate:function(){var a=Ib.animate.AnimateManager;if(a.animate){a.animate.shouldBeFinished&&a.animate.current<a.animate.step&&(a.animate.current=a.animate.step,a.animate.action(a.animate.current/a.animate.step));var b=a.animate.finishFunction;a.animate=null,a.timer&&(clearTimeout(a.timer),a.timer=null),b&&b()}else a.timer&&(clearTimeout(a.timer),a.timer=null)}},Ib.DataBox=function(a){Ib.DataBox.superClass.constructor.apply(this,arguments),1===arguments.length&&(this._name=a),this._dataList=new nd,this._dataMap={},this._rootList=new nd,this._rootMap={},this._clientMap={},this._dataBoxChangeDispatcher=new Ib.EventDispatcher,this._dataPropertyChangeDispatcher=new Ib.EventDispatcher,this._hierarchyChangeDispatcher=new Ib.EventDispatcher,this._selectionModel=new Ib.SelectionModel(this)},Jb.ext("twaver.DataBox",Ib.PropertyChangeDispatcher,{IClient:!0,__client:1,__new:1,_limit:-1,_name:"DataBox",_icon:Ed.ICON_DATABOX,__accessor:["name","icon","toolTip"],getSelectionModel:function(){return this._selectionModel},size:function(){return this._dataList.size()},isEmpty:function(){return this._dataList.isEmpty()},getLimit:function(){return this._limit},setLimit:function(a){var b=this._limit;this._limit=a,this.firePropertyChange("limit",b,a),this._checkLimit()},_checkLimit:function(){this._limit>=0&&this.size()>this._limit&&this.removeFirst(this.size()-this._limit)},removeFirst:function(a){for(0===arguments.length&&(a=1);a>0&&this._dataList.size()>0;){var b=this._dataList.get(0);this.remove(b),a--}},getSiblings:function(a){if(!this.contains(a))throw a+" dosen't belong to this dataBox";var b=a.getParent();return b?b.getChildren():this._rootList},getRoots:function(){return this._rootList},getSiblingIndex:function(a){return a.getParent()?a.getParent().getChildren().indexOf(a):this._rootList.indexOf(a)},getDatas:function(){return this._dataList},getDataAt:function(a){return this._dataList.get(a)},toDatas:function(a,b){return this._dataList.toList(a,b)},forEach:function(a,b){this._dataList.forEach(a,b)},forEachReverse:function(a,b){this._dataList.forEachReverse(a,b)},forEachByDepthFirst:function(a,b,c){if(b)this._depthFirst(a,b,c);else for(var d=this._rootList.size(),e=0;d>e;e++){var f=this._rootList.get(e);if(this._depthFirst(a,f,c)===!1)return}},_depthFirst:function(a,b,c){for(var d=b.getChildrenSize(),e=0;d>e;e++){var f=b.getChildAt(e);if(this._depthFirst(a,f,c)===!1)return!1}if(c){if(a.call(c,b)===!1)return!1}else if(a(b)===!1)return!1},forEachByBreadthFirst:function(a,b,c){var d=new nd;for(b?d.add(b):this._rootList.forEach(d.add,d);d.size()>0;)if(b=d.removeAt(0),b.getChildren().forEach(d.add,d),c){if(a.call(c,b)===!1)return}else if(a(b)===!1)return},add:function(a,b){if(a){1===arguments.length&&(b=-1);var c=a.getId();if(this._dataMap.hasOwnProperty(c))throw"Data with ID '"+c+"' already exists";this._dataBoxChangeDispatcher.fire({kind:"preAdd",data:a}),this._dataMap[c]=a,this._dataList.add(a),a.getParent()||(this._rootMap[c]=a,b>=0?this._rootList.add(a,b):this._rootList.add(a)),a.addPropertyChangeListener(this.handleDataPropertyChange,this,!0),this._dataBoxChangeDispatcher.fire({kind:"add",data:a}),this._checkLimit()}},addByDescendant:function(a){this.add(a),a.getChildren().size()>0&&a.getChildren().forEach(function(a){this.addByDescendant(a)},this)},remove:function(a){this.removeById(a.getId())},removeSelection:function(){this._selectionModel.toSelection().forEach(function(a){this.remove(a)},this)},removeById:function(a){var b=this.getDataById(a);b&&(this._dataBoxChangeDispatcher.fire({kind:"preRemove",data:b}),b instanceof Ib.Link&&(b.setFromNode(null),b.setToNode(null)),b instanceof Ld&&b.getLinks()&&b.getLinks().toList().forEach(function(a){this.remove(a)},this),b instanceof Ld&&b.getFollowers()&&b.getFollowers().toList().forEach(function(a){a.setHost(null)}),b instanceof Ib.Follower&&b.getHost()&&b.setHost(null),b.toChildren().forEach(function(a){this.remove(a)},this),b.getParent()&&b.getParent().removeChild(b),this._dataList.remove(b),delete this._dataMap[a],this._rootMap[a]&&(delete this._rootMap[a],this._rootList.remove(b)),this._dataBoxChangeDispatcher.fire({kind:"remove",data:b}),b.removePropertyChangeListener(this.handleDataPropertyChange,this))},clear:function(){if(this._dataList.size()>0){this._dataList.forEach(function(a){a.removePropertyChangeListener(this.handleDataPropertyChange,this)},this);var a=this._dataList.toList();this._dataList.clear(),this._dataMap={},this._rootList.clear(),this._rootMap={},this._dataBoxChangeDispatcher.fire({kind:"clear",datas:a})}},getDataById:function(a){return this._dataMap[a]},containsById:function(a){return this._dataMap.hasOwnProperty(a)},contains:function(a){return a?this._dataMap[a._id]===a:!1},moveTo:function(a,b){if(!this.contains(a))throw a+" dosen't belong to this dataBox";var c=this.getSiblings(a),d=c.indexOf(a);d===b||0>d||b>=0&&b<=c.size()&&(c.remove(a),b>c.size()&&b--,c.add(a,b),this._hierarchyChangeDispatcher.fire({data:a,oldIndex:d,newIndex:b}))},moveUp:function(a){var b=this.getSiblings(a);this.moveTo(a,b.indexOf(a)-1)},moveDown:function(a){var b=this.getSiblings(a);this.moveTo(a,b.indexOf(a)+1)},moveToTop:function(a){this.moveTo(a,0)},moveToBottom:function(a){var b=this.getSiblings(a);this.moveTo(a,b.size())},moveSelectionUp:function(a){a||(a=this._selectionModel);var b=new nd;yc.findMoveUpDatas(a,b,this._rootList),b.forEach(this.moveUp,this)},moveSelectionDown:function(a){a||(a=this._selectionModel);var b=new nd;yc.findMoveDownDatas(a,b,this._rootList),b.forEach(this.moveDown,this)},moveSelectionToTop:function(a){a||(a=this._selectionModel);var b=new nd;yc.findMoveToTopDatas(a,b,this._rootList),b.forEach(this.moveToTop,this)},moveSelectionToBottom:function(a){a||(a=this._selectionModel);var b=new nd;yc.findMoveToBottomDatas(a,b,this._rootList),b.forEach(this.moveToBottom,this)},handleDataPropertyChange:function(a){var b=a.source;if("parent"===a.property){var c=b.getId();b.getParent()?this._rootMap[c]&&(delete this._rootMap[c],this._rootList.remove(b)):this._rootMap[c]||(this._rootMap[c]=b,this._rootList.add(b))}this.onDataPropertyChanged(b,a),this._dataPropertyChangeDispatcher.fire(a)},onDataPropertyChanged:function(a,b){},addDataBoxChangeListener:function(a,b,c){this._dataBoxChangeDispatcher.add(a,b,c)},removeDataBoxChangeListener:function(a,b){this._dataBoxChangeDispatcher.remove(a,b)},addDataPropertyChangeListener:function(a,b,c){this._dataPropertyChangeDispatcher.add(a,b,c)},removeDataPropertyChangeListener:function(a,b){this._dataPropertyChangeDispatcher.remove(a,b)},addHierarchyChangeListener:function(a,b,c){this._hierarchyChangeDispatcher.add(a,b,c)},removeHierarchyChangeListener:function(a,b){this._hierarchyChangeDispatcher.remove(a,b)},getRandomData:function(a){if(a){for(var b=new Ib.List,c=0;c<this._dataList.size()-1;c++){var d=this._dataList.get(c);d instanceof a&&b.add(d)}if(0==b.size())return null}var e=a?b.get(parseInt(Ib.Util.random()*b.size())):this._dataList.get(parseInt(Ib.Util.random()*this._dataList.size()));return e}}),Ib.ElementBox=function(a){Ib.ElementBox.superClass.constructor.apply(this,arguments),this._styleMap={},this._alarmBox=new Ib.AlarmBox(this),this._layerBox=new Ib.LayerBox(this),this._alarmStatePropagator=new Ib.AlarmStatePropagator(this),this._alarmStatePropagator.setEnable(!0),this._indexChangeDispatcher=new Ib.EventDispatcher,this._undoManager=new Ib.UndoManager(this)},Ib.ElementBox.IS_INTERESTED_ADJUSTELEMENTINDEX_PROPERTY={fromAgent:1,toAgent:1,expanded:1,parent:1,host:1},Jb.ext("twaver.ElementBox",Ib.DataBox,{IStyle:!0,__style:1,_name:"ElementBox",add:function(a,b){if(a){if(!a.IElement)throw"Only IElement can be added into ElementBox";Ib.ElementBox.superClass.add.apply(this,arguments),this.adjustElementIndex(a)}},onDataPropertyChanged:function(a,b){Ib.ElementBox.IS_INTERESTED_ADJUSTELEMENTINDEX_PROPERTY[b.property]&&this.adjustElementIndex(a),Ib.ElementBox.superClass.onDataPropertyChanged.apply(this,arguments)},addIndexChangeListener:function(a,b,c){this._indexChangeDispatcher.add(a,b,c)},removeIndexChangeListener:function(a,b){this._indexChangeDispatcher.remove(a,b)},sendToTop:function(a){if(this.contains(a)){if(a!==this.getDatas().get(this.size()-1)){var b=this.getDatas().indexOf(a);this.getDatas().removeAt(b),this.getDatas().add(a),this._indexChangeDispatcher.fire({element:a,oldIndex:b,newIndex:this.size()-1})}a instanceof Ib.Link&&(a.getFromAgent()&&!a.getFromAgent().isAdjustedToBottom()&&this.sendToTop(a.getFromAgent()),a.getToAgent()&&!a.getToAgent().isAdjustedToBottom()&&this.sendToTop(a.getToAgent())),a instanceof Ld&&a.getFollowers()&&a.getFollowers().forEach(function(b){b.isRelatedTo(a)||a instanceof Ib.Follower&&b.isLoopedHostOn(a)||this.sendToTop(b)},this),a.ISubNetwork||a instanceof Nd&&!a.isExpanded()||a.getChildren().forEach(function(a){a instanceof Ib.Link||this.sendToTop(a)},this)}},sendToBottom:function(a,b){if(a!==b&&this.contains(a)&&(!b||this.contains(b))){var c=this.getDatas().remove(a),d=0;b&&(d=this.getDatas().indexOf(b)),this.getDatas().add(a,d),c!=d&&(this._indexChangeDispatcher.fire({element:a,oldIndex:c,newIndex:d}),!a.getParent()||a.getParent().ISubNetwork||a.getParent()instanceof Ib.Link||this.sendToBottom(a.getParent(),a))}},fireIndexChange:function(a,b,c){this._indexChangeDispatcher.fire({element:a,oldIndex:b,newIndex:c})},adjustElementIndex:function(a){this.contains(a)&&(a.isAdjustedToBottom()?(this.sendToBottom(a),a.getChildren().forEach(this.adjustElementIndex,this)):this.sendToTop(a))},forEachByLayer:function(a,b,c){var d=this.size(),e=this.getDatas();if(b)for(var f=0;d>f;f++){var g=e.get(f);if(this._layerBox.getLayerByElement(g)===b)if(c){if(a.call(c,g)===!1)return}else if(a(g)===!1)return}else this._layerBox.forEachByDepthFirst(function(b){for(var f=0;d>f;f++){var g=e.get(f);if(this._layerBox.getLayerByElement(g)===b)if(c){if(a.call(c,g)===!1)return}else if(a(g)===!1)return}},null,this)},forEachByLayerReverse:function(a,b,c){var d=new nd;this.forEachByLayer(function(a){d.add(a,0)},b),d.forEach(a,c)},getLayerBox:function(){return this._layerBox},getAlarmBox:function(){return this._alarmBox},getAlarmStatePropagator:function(){return this._alarmStatePropagator},startBatch:function(a,b){Ib._isInitializing=!0,Ib._bundleLinks={},Ib._links={},a.call(b);var c,d;for(var e in Ib._links)c=Ib._links[e],c._checkAgentNodeImpl();for(var e in Ib._bundleLinks)d=Ib._bundleLinks[e],vc.resetBundleLinks(d[0],d[1]);Ib._bundleLinks=null,Ib._links=null,Ib._isInitializing=!1},getUndoManager:function(){return this._undoManager}}),Ib.SelectionModel=function(a){Ib.SelectionModel.superClass.constructor.apply(this,arguments),this._selectionMode="multipleSelection",this._selectionList=new nd,this._selectionChangeDispatcher=new Ib.EventDispatcher,this._selectionMap={},this._setDataBox(a)},Jb.ext("twaver.SelectionModel",Ib.PropertyChangeDispatcher,{getSelectionMode:function(){return this._selectionMode},setSelectionMode:function(a){if(this._selectionMode!==a&&("noneSelection"===a||"singleSelection"===a||"multipleSelection"===a)){this.clearSelection();var b=this._selectionMode;this._selectionMode=a,this.firePropertyChange("selectionMode",b,this._selectionMode)}},getDataBox:function(){return this._dataBox},_setDataBox:function(a){if(!a)throw"dataBox can not be null";if(this._dataBox!==a){this._dataBox&&(this.clearSelection(),this._dataBox.removeDataBoxChangeListener(this.handleDataBoxChange,this));var b=this._dataBox;this._dataBox=a,this._dataBox.addDataBoxChangeListener(this.handleDataBoxChange,this,!0),this.firePropertyChange("dataBox",b,this._dataBox)}},dispose:function(){this.clearSelection(),this._dataBox.removeDataBoxChangeListener(this.handleDataBoxChange,this)},handleDataBoxChange:function(a){if("remove"===a.kind){var b=a.data;this.contains(b)&&(this._selectionList.remove(b),delete this._selectionMap[b.getId()],this.fireSelectionChange("remove",new nd(b)))}else"clear"===a.kind&&this.clearSelection()},getFilterFunction:function(){return this._filterFunction},setFilterFunction:function(a){if(this._filterFunction!==a){this.clearSelection();var b=this._filterFunction;this._filterFunction=a,this.firePropertyChange("filterFunction",b,this._filterFunction)}},fireSelectionChange:function(a,b,c){c&&(this._selectionList.forEach(function(a){c.contains(a)?c.remove(a):c.add(a)}),b=c.toList()),this._selectionChangeDispatcher.fire({kind:a,datas:new nd(b)})},addSelectionChangeListener:function(a,b,c){this._selectionChangeDispatcher.add(a,b,c)},removeSelectionChangeListener:function(a,b){this._selectionChangeDispatcher.remove(a,b)},_filterList:function(a,b){for(var c=new nd(a),d=0;d<c.size();d++){var e=c.get(d);(this._filterFunction&&!this._filterFunction(e)||b&&this.contains(e)||!b&&!this.contains(e)||!this._dataBox.contains(e))&&(c.removeAt(d),d--)}return c},appendSelection:function(a){if("noneSelection"!==this._selectionMode){var b=this._filterList(a,!0);if(!b.isEmpty()){var c=null;"singleSelection"===this._selectionMode&&(c=new nd(this._selectionList),this._selectionList.clear(),this._selectionMap={},b=new nd(b.get(b.size()-1)));for(var d=0;d<b.size();d++){var e=b.get(d);this._selectionList.add(e),this._selectionMap[e.getId()]=e}this.fireSelectionChange("append",b,c)}}},removeSelection:function(a){var b=this._filterList(a);if(0!==b.size()){for(var c=0;c<b.size();c++){var d=b.get(c);this._selectionList.remove(d),delete this._selectionMap[d.getId()]}this.fireSelectionChange("remove",b)}},toSelection:function(a,b){return this._selectionList.toList(a,b)},getSelection:function(){return this._selectionList},setSelection:function(a){if("noneSelection"!==this._selectionMode&&(0!==this._selectionList.size()||null!=a)){var b=new nd(this._selectionList);this._selectionList.clear(),this._selectionMap={};var c=this._filterList(a,!0);"singleSelection"===this._selectionMode&&c.size()>1&&(c=new nd(c.get(c.size()-1)));for(var d=0;d<c.size();d++){var e=c.get(d);this._selectionList.add(e),this._selectionMap[e.getId()]=e}this.fireSelectionChange("set",null,b)}},clearSelection:function(){if(this._selectionList.size()>0){var a=this._selectionList.toList();this._selectionList.clear(),this._selectionMap={},this.fireSelectionChange("clear",a)}},selectAll:function(){if("noneSelection"!==this._selectionMode){var a=this._dataBox.toDatas(),b=0,c=null;if(this._filterFunction)for(b=0;b<a.size();b++)c=a.get(b),this._filterFunction(c)||(a.removeAt(b),b--);var d=new nd(this._selectionList);for(this._selectionList.clear(),this._selectionMap={},"singleSelection"===this._selectionMode&&a.size()>1&&(a=new nd(a.get(a.size()-1))),b=0;b<a.size();b++)c=a.get(b),this._selectionList.add(c),this._selectionMap[c.getId()]=c;this.fireSelectionChange("all",null,d)}},size:function(){return this._selectionList.size()},contains:function(a){return a?null!=this._selectionMap[a.getId()]:!1},getLastData:function(){return this._selectionList.size()>0?this._selectionList.get(this._selectionList.size()-1):null},getFirstData:function(){return this._selectionList.size()>0?this._selectionList.get(0):null},isSelectable:function(a){return a?"noneSelection"===this._selectionMode?!1:this._filterFunction&&!this._filterFunction(a)?!1:!0:!1}}),Ib.QuickFinder=function(a,b,c,d,e){if(this._map={},!a)throw"dataBox can not be null";if(!b)throw"propertyName can not be null";this._dataBox=a,this._propertyName=b,this._propertyType=c||"accessor","accessor"===this._propertyType&&(this._getter=Jb.getter(b)),this._valueFunction=d||this.getValue,this._filterFunction=e||this.isInterested,this._dataBox.forEach(this._addData,this),this._dataBox.addDataBoxChangeListener(this.handleDataBoxChange,this,!0),this._dataBox.addDataPropertyChangeListener(this.handleDataPropertyChange,this,!0)},Jb.ext("twaver.QuickFinder",Object,{_NULL_:"twaver-null-key",getValueFunction:function(){return this._valueFunction},getFilterFunction:function(){return this._filterFunction},handleDataBoxChange:function(a){"add"===a.kind?this._addData(a.data):"remove"===a.kind?this._removeData(a.data):"clear"===a.kind&&(this._map={})},handleDataPropertyChange:function(a){if(this._filterFunction.call(this,a.source)){if("accessor"===this._propertyType&&this._propertyName===a.property);else if("style"===this._propertyType&&a.source.IStyle&&"S:"+this._propertyName===a.property);else if("client"!==this._propertyType||"C:"+this._propertyName!==a.property)return;var b=this._getMap(a.oldValue);b&&b.remove(a.source),this._addData(a.source)}},_getMap:function(a){return a=null==a?this._NULL_:a,this._map[a]},find:function(a){var b=this._getMap(a);return b?b.toList():new nd},findFirst:function(a){var b=this._getMap(a);return!b||b.isEmpty()?null:b.get(0)},_addData:function(a){if(this._filterFunction.call(this,a)){var b=this._valueFunction.call(this,a),c=this._getMap(b);c||(c=new nd,b=null==b?this._NULL_:b,this._map[b]=c),c.add(a)}},_removeData:function(a){if(this._filterFunction.call(this,a)){var b=this._valueFunction.call(this,a),c=this._getMap(b);c&&(c.remove(a),c.isEmpty()&&(b=null==b?this._NULL_:b,delete this._map[b]))}},dispose:function(){this._dataBox.removeDataBoxChangeListener(this.handleDataBoxChange,this),this._dataBox.removeDataPropertyChangeListener(this.handleDataPropertyChange,this),delete this._dataBox},getDataBox:function(){return this._dataBox},getPropertyType:function(){return this._propertyType},getPropertyName:function(){return this._propertyName},isInterested:function(a){return"style"===this._propertyType&&!a.IStyle||"accessor"===this._propertyType&&this._valueFunction===this.getValue&&!a[this._getter]?!1:!0},getValue:function(a){return"accessor"===this._propertyType?a[this._getter]():"style"===this._propertyType&&a.getStyle?a.getStyle(this._propertyName):"client"===this._propertyType&&a.getClient?a.getClient(this._propertyName):null}}),Ib.PropertyPropagator=function(a,b,c){if(!a)throw"dataBox can not be null";if(!b)throw"propertyName can not be null";this._dataBox=a,this._propertyName=b,this._propertyType=c||"accessor","accessor"===this._propertyType&&(this._getter=Jb.getter(b),this._setter=Jb.setter(b)),this._enable=!1,this._isPropagating=!1},Jb.ext("twaver.PropertyPropagator",Object,{getDataBox:function(){return this._dataBox},getPropertyType:function(){return this._propertyType},getPropertyName:function(){return this._propertyName},isEnable:function(){return this._enable},setEnable:function(a){this._enable!==a&&(this._enable=a,this._enable?(this._dataBox.addDataBoxChangeListener(this.handleDataBoxChange,this),this._dataBox.addDataPropertyChangeListener(this.handleDataPropertyChange,this),this._dataBox.forEach(function(a){this.propagate(a)},this)):(this._dataBox.removeDataBoxChangeListener(this.handleDataBoxChange,this),this._dataBox.removeDataPropertyChangeListener(this.handleDataPropertyChange,this)))},handleDataBoxChange:function(a){a.data&&this.propagate(a.data)},handleDataPropertyChange:function(a){if(this.isInterestedProperty(a))this.propagate(a.source);else if("parent"===a.property){var b=a.oldValue;b&&this.propagate(b),this.propagate(a.source)}},isInterestedProperty:function(a){return"accessor"===this._propertyType&&this._propertyName===a.property?!0:"style"===this._propertyType&&a.IElement&&"S:"+this._propertyName===a.property?!0:"client"===this._propertyType&&"C:"+this._propertyName===a.property?!0:!1},propagate:function(a){a&&!this._isPropagating&&(this._isPropagating=!0,this.propagateToTop(a),this._isPropagating=!1)},propagateToTop:function(a){for(this.propagateToParent(null,a);a&&a.getParent();)this.propagateToParent(a,a.getParent()),a=a.getParent()},propagateToParent:function(a,b){}}),Ib.AlarmStatePropagator=function(a){Ib.AlarmStatePropagator.superClass.constructor.call(this,a,"alarmState")},Jb.ext("twaver.AlarmStatePropagator",Ib.PropertyPropagator,{handleDataPropertyChange:function(a){"enablePropagation"===a.property?this.propagate(a.source):Ib.AlarmStatePropagator.superClass.handleDataPropertyChange.call(this,a)},propagateToParent:function(a,b){var c=null;b.getChildren().forEach(function(a){var b=a.getAlarmState().getHighestOverallAlarmSeverity();Ib.AlarmSeverity.compare(b,c)>0&&(c=b)}),b.getAlarmState().setPropagateSeverity(c)}}),Ib.AlarmSeverity=function(a,b,c,d,e){this.value=a,this.name=b,this.nickName=c,this.color=d,this.displayName=e},Jb.ext("twaver.AlarmSeverity",Object,{toString:function(){return this.displayName?this.displayName:this.name}}),function(){var a=Ib.AlarmSeverity;a.severities=new nd,a._vm={},a._nm={},a._cp=function(a,b){if(a&&b){var c=a.value-b.value;return c>0?1:0>c?-1:0}return a&&!b?1:!a&&b?-1:0},a.forEach=function(b,c){a.severities.forEach(b,c)},a.getSortFunction=function(){return a._cp},a.setSortFunction=function(b){a._cp=b,a.severities.sort(b)},a.add=function(b,c,d,e,f){var g=new a(b,c,d,e,f);return a._vm[b]=g,a._nm[c]=g,a.severities.add(g),a.severities.sort(a._cp),g},a.remove=function(b){var c=a._nm[b];return c&&(delete a._nm[b],delete a._vm[c.value],a.severities.remove(c)),c},a.CRITICAL=a.add(500,"Critical","C","#FF0000"),a.MAJOR=a.add(400,"Major","M","#FFA000"),a.MINOR=a.add(300,"Minor","m","#FFFF00"),a.WARNING=a.add(200,"Warning","W","#00FFFF"),a.INDETERMINATE=a.add(100,"Indeterminate","N","#C800FF"),a.CLEARED=a.add(0,"Cleared","R","#00FF00"),a.isClearedAlarmSeverity=function(a){return a?0===a.value:!1},a.getByName=function(b){return a._nm[b]},a.getByValue=function(b){return a._vm[b]},a.clear=function(){a.severities.clear(),a._vm={},a._nm={}},a.compare=function(b,c){return a._cp(b,c)}}(),Ib.AlarmState=function(a){this._e=a,this._nm={},this._am={},this._ps=null,this._haa=null,this._hna=null,this._hoa=null,this._hta=null,this._hls=!1,this._aac=0,this._nac=0},Jb.ext("twaver.AlarmState",Object,{_ep:!0,_f:function(){this._c1(),this._c2(),this._c3(),this._c4(),this._c5(),this._c6(),this._c7(),this._e.firePropertyChange("alarmState",null,this)},getHighestAcknowledgedAlarmSeverity:function(){return this._haa},getHighestNewAlarmSeverity:function(){return this._hna},getHighestOverallAlarmSeverity:function(){return this._hoa},getHighestNativeAlarmSeverity:function(){return this._hta},hasLessSevereNewAlarms:function(){return this._hls},_c1:function(){var a=null;for(var b in this._am)b=Ib.AlarmSeverity.getByName(b),Ib.AlarmSeverity.isClearedAlarmSeverity(b)||0!==this.getAcknowledgedAlarmCount(b)&&(a=a&&Ib.AlarmSeverity.compare(a,b)>0?a:b);this._haa=a},_c2:function(){var a=null;for(var b in this._nm)b=Ib.AlarmSeverity.getByName(b),Ib.AlarmSeverity.isClearedAlarmSeverity(b)||0!==this.getNewAlarmCount(b)&&(a=a&&Ib.AlarmSeverity.compare(a,b)>0?a:b);this._hna=a},_c3:function(){if(!this._hna)return void(this._hls=!1);for(var a in this._nm)if(a=Ib.AlarmSeverity.getByName(a),!Ib.AlarmSeverity.isClearedAlarmSeverity(a)&&0!==this.getNewAlarmCount(a)&&Ib.AlarmSeverity.compare(this._hna,a)>0)return void(this._hls=!0);
this._hls=!1},_c4:function(){var a=this._haa,b=this._hna,c=this._ps;this._hoa=a,Ib.AlarmSeverity.compare(b,this._hoa)>0&&(this._hoa=b),Ib.AlarmSeverity.compare(c,this._hoa)>0&&(this._hoa=c)},_c5:function(){var a=this._haa,b=this._hna;this._hta=a,Ib.AlarmSeverity.compare(b,this._hta)>0&&(this._hta=b)},increaseAcknowledgedAlarm:function(a,b){if(null==b&&(b=1),0!==b){var c=this._am[a.name];null==c&&(c=0),c+=b,this._am[a.name]=c,this._f()}},increaseNewAlarm:function(a,b){if(null==b&&(b=1),0!==b){var c=this._nm[a.name];null==c&&(c=0),c+=b,this._nm[a.name]=c,this._f()}},decreaseAcknowledgedAlarm:function(a,b){if(null==b&&(b=1),0!==b){var c=this._am[a.name];if(null==c&&(c=0),c-=b,0>c)throw"Alarm count can not be negative";this._am[a.name]=c,this._f()}},decreaseNewAlarm:function(a,b){if(null==b&&(b=1),0!==b){var c=this._nm[a.name];if(null==c&&(c=0),c-=b,0>c)throw"Alarm count can not be negative";this._nm[a.name]=c,this._f()}},acknowledgeAlarm:function(a){this.decreaseNewAlarm(a,1),this.increaseAcknowledgedAlarm(a,1)},acknowledgeAllAlarms:function(a){if(a){var b=this.getNewAlarmCount(a);this.decreaseNewAlarm(a,b),this.increaseAcknowledgedAlarm(a,b)}else for(var c in this._nm)this.acknowledgeAllAlarms(Ib.AlarmSeverity.getByName(c))},_c6:function(){this._aac=0;for(var a in this._am)a=Ib.AlarmSeverity.getByName(a),this._aac+=this.getAcknowledgedAlarmCount(a)},getAcknowledgedAlarmCount:function(a){if(a){var b=this._am[a.name];return null==b?0:b}return this._aac},getAlarmCount:function(a){return this.getAcknowledgedAlarmCount(a)+this.getNewAlarmCount(a)},_c7:function(){this._nac=0;for(var a in this._nm)a=Ib.AlarmSeverity.getByName(a),this._nac+=this.getNewAlarmCount(a)},getNewAlarmCount:function(a){if(a){var b=this._nm[a.name];return null==b?0:b}return this._nac},setNewAlarmCount:function(a,b){this._nm[a.name]=b,this._f()},removeAllNewAlarms:function(a){a?delete this._nm[a]:this._nm={},this._f()},setAcknowledgedAlarmCount:function(a,b){this._am[a.name]=b,this._f()},removeAllAcknowledgedAlarms:function(a){a?delete this._am[a.name]:this._am={},this._f()},isEmpty:function(){return null==this._hoa},clear:function(){this._am={},this._nm={},this._f()},getPropagateSeverity:function(){return this._ps},setPropagateSeverity:function(a){if(this._ep||(a=null),this._ps!==a){var b=this._ps;this._ps=a,this._f(),this._e.firePropertyChange("propagateSeverity",b,a)}},isEnablePropagation:function(){return this._ep},setEnablePropagation:function(a){var b=this._ep;this._ep=a,this._e.firePropertyChange("enablePropagation",b,a)&&(a||this.setPropagateSeverity(null))}}),Ib.AlarmBox=function(a){if(!a)throw"elementBox can not be null.";Ib.AlarmBox.superClass.constructor.call(this),this._elementBox=a,this._alarmElementMapping=new Ib.AlarmElementMapping(this,a),this._elementBox.addDataBoxChangeListener(this.handleElementBoxChange,this,!0),this.addDataBoxChangeListener(this.handleAlarmBoxChange,this,!0),this.addDataPropertyChangeListener(this.handleAlarmPropertyChange,this,!0)},Jb.ext("twaver.AlarmBox",Ib.DataBox,{__accessor:["removeAlarmWhenElementIsRemoved"],_name:"AlarmBox",_removeAlarmWhenAlarmIsCleared:!1,_removeAlarmWhenElementIsRemoved:!0,getElementBox:function(){return this._elementBox},isRemoveAlarmWhenAlarmIsCleared:function(){return this._removeAlarmWhenAlarmIsCleared},setRemoveAlarmWhenAlarmIsCleared:function(a){var b=this._removeAlarmWhenAlarmIsCleared;this._removeAlarmWhenAlarmIsCleared=a,this.firePropertyChange("removeAlarmWhenAlarmIsCleared",b,a),a&&this.toDatas(function(a){return a.isCleared()}).forEach(this.remove,this)},getAlarmElementMapping:function(){return this._alarmElementMapping},setAlarmElementMapping:function(a){if(!a)throw"alarmElementMapping can not be null";if(this._alarmElementMapping!==a){var b=this._alarmElementMapping;this.getDatas().forEach(this._decreaseAlarmState,this),this._alarmElementMapping=a,this.getDatas().forEach(this._increaseAlarmState,this),this.firePropertyChange("alarmElementMapping",b,a)}},handleElementBoxChange:function(a){"add"===a.kind?this.handleElementAdded(a.data):"remove"===a.kind?(this.handleElementRemoved(a.data),this._removeAlarmWhenElementIsRemoved&&this.removeAlarmsByElement(a.data)):"clear"===a.kind&&(a.datas.forEach(this.handleElementRemoved,this),this._removeAlarmWhenElementIsRemoved&&this.clear())},handleAlarmBoxChange:function(a){"add"===a.kind?this._increaseAlarmState(a.data):"remove"===a.kind?this._decreaseAlarmState(a.data):"clear"===a.kind&&a.datas.forEach(this._decreaseAlarmState,this)},handleAlarmPropertyChange:function(a){var b=a.source;b.isCleared()||("alarmSeverity"===a.property?this.handleAlarmSeverityChange(b,a):"acked"===a.property&&this.handleAckedChange(b,a)),"cleared"===a.property&&(b.isCleared()?(this._decreaseAlarmState(b,!0),this._removeAlarmWhenAlarmIsCleared&&this.remove(b)):this._increaseAlarmState(b,!0))},handleAckedChange:function(a,b){if(a.getAlarmSeverity()){var c=this.getCorrespondingElements(a);if(c)for(var d=0;d<c.size();d++){var e=c.get(d);b.oldValue?e.getAlarmState().decreaseAcknowledgedAlarm(a.getAlarmSeverity()):e.getAlarmState().decreaseNewAlarm(a.getAlarmSeverity()),b.newValue?e.getAlarmState().increaseAcknowledgedAlarm(a.getAlarmSeverity()):e.getAlarmState().increaseNewAlarm(a.getAlarmSeverity())}}},handleAlarmSeverityChange:function(a,b){var c=b.oldValue,d=b.newValue,e=this.getCorrespondingElements(a);if(e)for(var f=0;f<e.size();f++){var g=e.get(f);c&&(a.isAcked()?g.getAlarmState().decreaseAcknowledgedAlarm(c):g.getAlarmState().decreaseNewAlarm(c)),d&&(a.isAcked()?g.getAlarmState().increaseAcknowledgedAlarm(d):g.getAlarmState().increaseNewAlarm(d))}},getCorrespondingAlarms:function(a){return this._alarmElementMapping.getCorrespondingAlarms(a)},getCorrespondingElements:function(a){return this._alarmElementMapping.getCorrespondingElements(a)},handleElementAdded:function(a){var b=this.getCorrespondingAlarms(a);if(b)for(var c=0;c<b.size();c++){var d=b.get(c);if(!d.isCleared()){var e=d.getAlarmSeverity();e&&(d.isAcked()?a.getAlarmState().increaseAcknowledgedAlarm(e):a.getAlarmState().increaseNewAlarm(e))}}},_increaseAlarmState:function(a,b){if(!a.isCleared()||b){var c=a.getAlarmSeverity();if(c){var d=this.getCorrespondingElements(a);if(d)for(var e=0;e<d.size();e++){var f=d.get(e);a.isAcked()?f.getAlarmState().increaseAcknowledgedAlarm(c):f.getAlarmState().increaseNewAlarm(c)}}}},_decreaseAlarmState:function(a,b){if(!a.isCleared()||b){var c=a.getAlarmSeverity();if(c){var d=this.getCorrespondingElements(a);if(d)for(var e=0;e<d.size();e++){var f=d.get(e);a.isAcked()?f.getAlarmState().decreaseAcknowledgedAlarm(c):f.getAlarmState().decreaseNewAlarm(c)}}}},handleElementRemoved:function(a){var b=this.getCorrespondingAlarms(a);b&&b.forEach(function(b){!b.isCleared()&&b.getAlarmSeverity()&&(b.isAcked()?a.getAlarmState().decreaseAcknowledgedAlarm(b.getAlarmSeverity()):a.getAlarmState().decreaseNewAlarm(b.getAlarmSeverity()))})},removeAlarmsByElement:function(a){var b=this.getCorrespondingAlarms(a);b&&b.forEach(this.remove,this)},add:function(a,b){if(!a.IAlarm)throw"Only IAlarm can be added into AlarmBox";this._removeAlarmWhenAlarmIsCleared&&a.isCleared()||Ib.AlarmBox.superClass.add.apply(this,arguments)}}),Ib.AlarmElementMapping=function(a,b){if(!b)throw"ElementBox can not be null";if(!a)throw"AlarmBox can not be null";this._elementBox=b,this._alarmBox=a,this._alarmsFinder=new Ib.QuickFinder(a,"elementId")},Jb.ext("twaver.AlarmElementMapping",Object,{getCorrespondingAlarms:function(a){return this._alarmsFinder.find(a.getId())},getCorrespondingElements:function(a){var b=this._elementBox.getDataById(a.getElementId());return new nd(b)},dispose:function(){this._alarmsFinder.dispose(),delete this._elementBox,delete this._alarmBox,delete this._alarmsFinder}}),Ib.AlarmStateStatistics=function(a){Ib.AlarmStateStatistics.superClass.constructor.apply(this,arguments),this.sumNew=0,this.sumAcked=0,this.sumTotal=0,this.severtiyMap={},this.elementMap={},this.setElementBox(a)},Jb.ext("twaver.AlarmStateStatistics",Ib.PropertyChangeDispatcher,{getElementBox:function(){return this._elementBox},setElementBox:function(a){if(!a)throw"ElementBox can not be null";if(this._elementBox!==a){var b=this._elementBox;b&&(b.removeDataPropertyChangeListener(this.handleElementPropertyChange,this),b.removeDataBoxChangeListener(this.handleElementBoxChange,this),this.severtiyMap={},this.elementMap={}),this._elementBox=a,this.reset(),a.addDataPropertyChangeListener(this.handleElementPropertyChange,this),a.addDataBoxChangeListener(this.handleElementBoxChange,this),this.firePropertyChange("elementBox",b,a)}},dispose:function(){this._elementBox.removeDataPropertyChangeListener(this.handleElementPropertyChange,this),this._elementBox.removeDataBoxChangeListener(this.handleElementBoxChange,this),delete this._elementBox},handleElementPropertyChange:function(a){"alarmState"===a.property&&(this.increase(a.source),this.fireAlarmStateChange())},handleElementBoxChange:function(a){"add"===a.kind?(this.increase(a.data),this.fireAlarmStateChange()):"remove"===a.kind?(this.decrease(a.data),this.fireAlarmStateChange()):"clear"===a.kind&&(this.severtiyMap={},this.elementMap={},this.fireAlarmStateChange())},fireAlarmStateChange:function(){this.sumAcked=0,this.sumNew=0,this.sumTotal=0,Ib.AlarmSeverity.forEach(function(a){var b=this.getSumInfo(a);this.sumAcked+=b.ackedCount,this.sumNew+=b.newCount,this.sumTotal+=b.totalCount},this),this.firePropertyChange("alarmState",!1,!0)},getNewAlarmCount:function(a){if(!a)return this.sumNew;var b=this.getSumInfo(a);return b.newCount},getAcknowledgedAlarmCount:function(a){if(!a)return this.sumAcked;var b=this.getSumInfo(a);return b.ackedCount},getTotalAlarmCount:function(a){if(!a)return this.sumTotal;var b=this.getSumInfo(a);return b.totalCount},getSumInfo:function(a){var b=this.severtiyMap[a.name];return b||(b={},b.newCount=0,b.ackedCount=0,b.totalCount=0,this.severtiyMap[a.name]=b),b},decrease:function(a){var b=this.elementMap[a.getId()];b&&(delete this.elementMap[a.getId()],Ib.AlarmSeverity.forEach(function(a){var c=b[a.name],d=this.getSumInfo(a);d.newCount=d.newCount-c.newCount,d.ackedCount=d.ackedCount-c.ackedCount,d.totalCount=d.totalCount-c.totalCount},this))},increase:function(a){if(this.decrease(a),!this._filterFunction||this._filterFunction(a)){var b={};this.elementMap[a.getId()]=b,Ib.AlarmSeverity.forEach(function(c){var d={};d.newCount=a.getAlarmState().getNewAlarmCount(c),d.ackedCount=a.getAlarmState().getAcknowledgedAlarmCount(c),d.totalCount=a.getAlarmState().getAlarmCount(c),b[c.name]=d;var e=this.getSumInfo(c);e.newCount=e.newCount+d.newCount,e.ackedCount=e.ackedCount+d.ackedCount,e.totalCount=e.totalCount+d.totalCount},this)}},reset:function(){this.severtiyMap={},this.elementMap={},this._elementBox.forEach(this.increase,this),this.fireAlarmStateChange()},setFilterFunction:function(a){var b=this._filterFunction;this._filterFunction=a,this.reset(),this.firePropertyChange("filterFunction",b,a)},getFilterFunction:function(){return _filterFunction}}),Ib.LayerBox=function(a){Ib.LayerBox.superClass.constructor.call(this),this._elementBox=a,this._defaultLayer=new Ib.Layer(Ed.LAYER_DEFAULT_ID,Ed.LAYER_DEFAULT_NAME),this.add(this._defaultLayer)},Jb.ext("twaver.LayerBox",Ib.DataBox,{_name:"LayerBox",getElementBox:function(){return this._elementBox},getDefaultLayer:function(){return this._defaultLayer},add:function(a,b){if(!a.ILayer)throw"Only ILayer can be added into LayerBox";Ib.LayerBox.superClass.add.apply(this,arguments)},removeById:function(a){if(a===this._defaultLayer.getId())throw"Cannot remove default layer";Ib.LayerBox.superClass.removeById.call(this,a)},getLayerByElement:function(a){if(!a)return null;if(a._layerId===Ed.LAYER_DEFAULT_ID)return this._defaultLayer;var b=this.getDataById(a.getLayerId());return b?b:this._defaultLayer},clear:function(){this.toDatas().forEach(function(a){a!=this._defaultLayer&&this.removeById(a.getId())},this)}}),Ib.BundleLinks=function(a,b){this._links=a,this._siblings=b;var c,d,e=Ib.Styles.getStyle("link.bundle.expanded");for(c=0;c<a.size();c++){d=a.get(c);var f=d.getStyle("link.bundle.expanded",!1);if(null!=f){e=f;break}}if(null==e&&(e=!0),Ed.LINK_BUNDLE_AGENT_FUNCTION){var g=Ed.LINK_BUNDLE_AGENT_FUNCTION(a);null==g?g=a.get(0):g!=a.get(0)&&(a.remove(g),a.add(g,0))}for(c=0;c<a.size();c++)a.get(c).setStyle("link.bundle.expanded",e)},Jb.ext("twaver.BundleLinks",Object,{getLinks:function(){return this._links},getSiblings:function(){return this._siblings},forEachSiblingLink:function(a,b){this._siblings.forEach(function(c){c.getLinks().forEach(a,b)})}});var Fd={bitsToNum:function(a){return a.reduce(function(a,b){return 2*a+b},0)},byteToBitArr:function(a){for(var b=[],c=7;c>=0;c--)b.push(!!(a&1<<c));return b},lzwDecode:function(a,b){for(var c,d,e=0,f=function(a){for(var c=0,d=0;a>d;d++)b.charCodeAt(e>>3)&1<<(7&e)&&(c|=1<<d),e++;return c},g=[],h=1<<a,i=h+1,j=a+1,k=[],l=function(){k=[],j=a+1;for(var b=0;h>b;b++)k[b]=[b];k[h]=[],k[i]=null};;)if(d=c,c=f(j),c!==h){if(c===i)break;if(c<k.length)d!==h&&k.push(k[d].concat(k[c][0]));else{if(c!==k.length)throw new Error("Invalid LZW code.");k.push(k[d].concat(k[d][0]))}g.push.apply(g,k[c]),k.length===1<<j&&12>j&&j++}else l();return g}},Gd=function(a){this.data=a,this.len=this.data.length,this.pos=0};Jb.ext(Gd,Object,{readByte:function(){if(this.pos>=this.data.length)throw new Error("Attempted to read past end of stream.");return 255&this.data.charCodeAt(this.pos++)},readBytes:function(a){for(var b=[],c=0;a>c;c++)b.push(this.readByte());return b},read:function(a){for(var b="",c=0;a>c;c++)b+=String.fromCharCode(this.readByte());return b},readUnsigned:function(){var a=this.readBytes(2);return(a[1]<<8)+a[0]}});var Hd=function(a){var b,c=a,d=null,e=null,f=null,g=0,h=null,i=null,j=null;this.frames=[],this.size={};var k=this,l=Ob.createElement("canvas");this.loaded=!1;var m=function(){d=null,e=null,h=f,f=null,i=null};this.doParse=function(){Id(c,t)};var n=function(a){b=a,k.size.width=b.width,k.size.height=b.height},o=function(a){p(),m(),d=a.transparencyGiven?a.transparencyIndex:null,e=a.delayTime,f=a.disposalMethod},p=function(){i&&k.frames.push({data:i.getImageData(0,0,b.width,b.height),delay:e})},q=function(a){i||(i=l.getContext("2d"));var c=k.frames.length,e=a.lctFlag?a.lct:b.gct;c>0&&(3===h?i.putImageData(k.frames[g].data,0,0):g=c-1,2===h&&(j||i.clearRect(j.leftPos,j.topPos,j.width,j.height)));var f=i.getImageData(a.leftPos,a.topPos,a.width,a.height);a.pixels.forEach(function(a,b){a!==d&&(f.data[4*b+0]=e[a][0],f.data[4*b+1]=e[a][1],f.data[4*b+2]=e[a][2],f.data[4*b+3]=255)}),i.putImageData(f,a.leftPos,a.topPos),j=a},r=function(){},s=function(a){return function(b){a(b)}},t={hdr:s(n),gce:s(o),com:s(r),app:{NETSCAPE:s(r)},img:s(q),eof:function(a){p(),k.loaded=!0}}},Id=function(a,b){b||(b={});var c=function(b){for(var c=[],d=0;b>d;d++)c.push(a.readBytes(3));return c},d=function(){var b,c;c="";do b=a.readByte(),c+=a.read(b);while(0!==b);return c},e=function(){var d={};if(d.sig=a.read(3),d.ver=a.read(3),"GIF"!==d.sig)throw new Error("Not a GIF file.");d.width=a.readUnsigned(),d.height=a.readUnsigned();var e=Fd.byteToBitArr(a.readByte());d.gctFlag=e.shift(),d.colorRes=Fd.bitsToNum(e.splice(0,3)),d.sorted=e.shift(),d.gctSize=Fd.bitsToNum(e.splice(0,3)),d.bgColor=a.readByte(),d.pixelAspectRatio=a.readByte(),d.gctFlag&&(d.gct=c(1<<d.gctSize+1)),b.hdr&&b.hdr(d)},f=function(c){var e=function(c){var d=(a.readByte(),Fd.byteToBitArr(a.readByte()));c.reserved=d.splice(0,3),c.disposalMethod=Fd.bitsToNum(d.splice(0,3)),c.userInput=d.shift(),c.transparencyGiven=d.shift(),c.delayTime=a.readUnsigned(),c.transparencyIndex=a.readByte(),c.terminator=a.readByte(),b.gce&&b.gce(c)},f=function(a){a.comment=d(),b.com&&b.com(a)},g=function(c){a.readByte(),c.ptHeader=a.readBytes(12),c.ptData=d(),b.pte&&b.pte(c)},h=function(c){var e=function(c){a.readByte(),c.unknown=a.readByte(),c.iterations=a.readUnsigned(),c.terminator=a.readByte(),b.app&&b.app.NETSCAPE&&b.app.NETSCAPE(c)},f=function(a){a.appData=d(),b.app&&b.app[a.identifier]&&b.app[a.identifier](a)};switch(a.readByte(),c.identifier=a.read(8),c.authCode=a.read(3),c.identifier){case"NETSCAPE":e(c);break;default:f(c)}},i=function(a){a.data=d(),b.unknown&&b.unknown(a)};switch(c.label=a.readByte(),c.label){case 249:c.extType="gce",e(c);break;case 254:c.extType="com",f(c);break;case 1:c.extType="pte",g(c);break;case 255:c.extType="app",h(c);break;default:c.extType="unknown",i(c)}},g=function(e){var f=function(a,b){for(var c=new Array(a.length),d=a.length/b,e=function(d,e){var f=a.slice(e*b,(e+1)*b);c.splice.apply(c,[d*b,b].concat(f))},f=[0,4,2,1],g=[8,8,4,2],h=0,i=0;4>i;i++)for(var j=f[i];d>j;j+=g[i])e(j,h),h++;return c};e.leftPos=a.readUnsigned(),e.topPos=a.readUnsigned(),e.width=a.readUnsigned(),e.height=a.readUnsigned();var g=Fd.byteToBitArr(a.readByte());e.lctFlag=g.shift(),e.interlaced=g.shift(),e.sorted=g.shift(),e.reserved=g.splice(0,2),e.lctSize=Fd.bitsToNum(g.splice(0,3)),e.lctFlag&&(e.lct=c(1<<e.lctSize+1)),e.lzwMinCodeSize=a.readByte();var h=d();e.pixels=Fd.lzwDecode(e.lzwMinCodeSize,h),e.interlaced&&(e.pixels=f(e.pixels,e.width)),b.img&&b.img(e)},h=function(){var c={};switch(c.sentinel=a.readByte(),String.fromCharCode(c.sentinel)){case"!":c.type="ext",f(c);break;case",":c.type="img",g(c);break;case";":c.type="eof",b.eof&&b.eof(c);break;default:throw new Error("Unknown block: 0x"+c.sentinel.toString(16))}"eof"!==c.type&&setTimeout(h,0)},i=function(){e(),setTimeout(h,0)};i()},Jd=function(a,b,c){var d=Ob.createElement("canvas");return Kd(d,b.width,b.height),d.getContext("2d").clearRect(0,0,b.width,b.height),d.getContext("2d").putImageData(a[c].data,0,0),d},Kd=function(a,b,c){a.width=b,a.height=c,a.style.width=b+"px",a.style.height=c+"px"};Ib.Data=function(a){if(Ib.Data.superClass.constructor.apply(this,arguments),this._childList=new nd,this._childMap={},this._clientMap={},a===b||null===a)this._id=Jb.id();else if("string"==typeof a||"number"==typeof a||"boolean"==typeof a)this._id=a;else{for(var c in a)if("clients"===c)for(var d in a.clients)this._clientMap[d]=a.clients[d];else if("styles"===c)for(var e in a.styles)this._styleMap[e]=a.styles[e];else null!=a[c]&&("id"===c?this._id=a[c]:this[Jb.setter(c)]&&this[Jb.setter(c)](a[c]));null==this._id&&(this._id=Jb.id())}},Jb.ext("twaver.Data",Ib.PropertyChangeDispatcher,{IData:!0,IClient:!0,__client:1,__new:1,_parent:null,__accessor:["name","name2","icon","toolTip"],_icon:Ed.ICON_DATA,getId:function(){return this._id},getChildren:function(){return this._childList},getChildrenSize:function(){return this._childList.size()},toChildren:function(a,b){return this._childList.toList(a,b)},addChild:function(a,c){return c===b&&(c=this._childList.size()),a&&a!==this?this._childMap[a.getId()]?!1:this.isDescendantOf(a)?!1:(a.getParent()&&a.getParent().removeChild(a),(0>c||c>this._childList.size())&&(c=this._childList.size()),this._childList.add(a,c),this._childMap[a._id]=a,a.setParent(this),this.firePropertyChange("children",null,a),this.onChildAdded(a,c),!0):!1},onChildAdded:function(a,b){},removeChild:function(a){if(!a)return!1;if(!this._childMap[a._id])return!1;var b=this._childList.remove(a);return delete this._childMap[a._id],this.firePropertyChange("children",a,null),a.setParent(null),this.onChildRemoved(a,b),!0},onChildRemoved:function(a,b){},getChildAt:function(a){return this._childList.get(a)},clearChildren:function(){if(0===this._childList.size())return!1;for(var a=this._childList.toArray(),b=a.length,c=0;b>c;c++)this.removeChild(a[c]);return this.onChildrenCleared(a),!0},onChildrenCleared:function(a){},getParent:function(){return this._parent},setParent:function(a){if(!(this._isUpdatingParent||this._parent===a||this===a||a&&a.isDescendantOf(this))){var b=this._parent;this._parent=a,this._isUpdatingParent=!0,b&&b.removeChild(this),a&&a.addChild(this),delete this._isUpdatingParent,this.firePropertyChange("parent",b,a),this.onParentChanged(b,a)}},onParentChanged:function(a,b){},hasChildren:function(){return this._childList.size()>0},isRelatedTo:function(a){return a?this.isDescendantOf(a)||a.isDescendantOf(this):!1},isParentOf:function(a){return a?null!=this._childMap[a._id]:!1},isDescendantOf:function(a){if(!a)return!1;if(!a.hasChildren())return!1;for(var b=this._parent;b;){if(a===b)return!0;b=b.getParent()}return!1},toString:function(){return this.getName()?this.getName():this._id}}),Ib.Alarm=function(a,b,c,d,e){Ib.Alarm.superClass.constructor.call(this,a),this._elementId=b,this._alarmSeverity=c,this._acked=d||!1,this._cleared=e||!1},Jb.ext("twaver.Alarm",Ib.Data,{IAlarm:!0,getElementId:function(){return this._elementId},__accessor:["acked","cleared","alarmSeverity"]}),Ib.Layer=function(a){Ib.Layer.superClass.constructor.call(this,a)},Jb.ext("twaver.Layer",Ib.Data,{ILayer:!0,__accessor:["visible","movable","editable","rotatable"],_visible:!0,_movable:!0,_editable:!0,_rotatable:!0,_name:"Default"}),Ib.Element=function(a){this._styleMap=this._styleMap||{},this._alarmState=new Ib.AlarmState(this),Ib.Element.superClass.constructor.call(this,a)},Jb.ext("twaver.Element",Ib.Data,{IElement:!0,IStyle:!0,__accessor:["layerId"],__bool:["visible","movable"],__style:1,_layerId:Ed.LAYER_DEFAULT_ID,_visible:!0,_movable:!0,getAlarmState:function(){return this._alarmState},isAdjustedToBottom:function(){return!1},getElementUIClass:function(){return null},getCanvasUIClass:function(){return null},getVectorUIClass:function(){return null},s:function(a,c){return c===b?this.getStyle(a):(this.setStyle(a,c),this)}}),Ib.Dummy=function(a){Ib.Dummy.superClass.constructor.call(this,a)},Jb.ext("twaver.Dummy",Ib.Element,{IDummy:!0});var Ld=function(a){this._location={x:0,y:0},Ld.superClass.constructor.call(this,a)};Ib.Node=Ld,Ld.IS_INTERESTED_NODE_PROPERTY={location:1,width:1,height:1,expanded:1},Jb.ext("twaver.Node",Ib.Element,{_icon:Ed.ICON_NODE,_image:Ed.IMAGE_NODE,_imageUrl:null,_angle:0,getLoopedLinks:function(){return this._loopedLinks},getLinks:function(){return this._links},getAgentLinks:function(){return this._agentLinks},getFollowers:function(){return this._followers},_addFollower:function(a){this._followers||(this._followers=new nd),this._followers.add(a)},_removeFollower:function(a){this._followers.remove(a),this._followers.isEmpty()&&delete this._followers},getFromLinks:function(){return this._fromLinks},getToLinks:function(){return this._toLinks},_addFromLink:function(a){this._links||(this._links=new nd(!1)),this._fromLinks||(this._fromLinks=new nd(!1)),this._links.add(a),this._toLinks&&this._toLinks.contains(a)&&(this._loopedLinks||(this._loopedLinks=new nd(!1)),this._loopedLinks.add(a)),this._fromLinks.add(a)},_addToLink:function(a){this._links||(this._links=new nd(!1)),this._toLinks||(this._toLinks=new nd(!1)),this._links.add(a),this._fromLinks&&this._fromLinks.contains(a)&&(this._loopedLinks||(this._loopedLinks=new nd(!1)),this._loopedLinks.add(a)),this._toLinks.add(a)},_removeFromLink:function(a){this._links&&this._links.remove(a),this._fromLinks&&this._fromLinks.remove(a),this._loopedLinks&&this._loopedLinks.remove(a)},_removeToLink:function(a){this._links&&this._links.remove(a),this._toLinks&&this._toLinks.remove(a),this._loopedLinks&&this._loopedLinks.remove(a)},hasAgentLinks:function(){return null!=this._agentLinks&&!this._agentLinks.isEmpty()},getFromAgentLinks:function(){return this._fromAgentLinks},getToAgentLinks:function(){return this._toAgentLinks},_addFromAgentLink:function(a){this._fromAgentLinks||(this._fromAgentLinks=new nd(!1)),this._agentLinks||(this._agentLinks=new nd(!1)),this._fromAgentLinks.add(a),this._agentLinks.add(a)},_addToAgentLink:function(a){this._toAgentLinks||(this._toAgentLinks=new nd(!1)),this._agentLinks||(this._agentLinks=new nd(!1)),this._toAgentLinks.add(a),this._agentLinks.add(a)},_removeFromAgentLink:function(a){this._fromAgentLinks&&this._fromAgentLinks.remove(a),this._agentLinks&&this._agentLinks.remove(a)},_removeToAgentLink:function(a){this._toAgentLinks&&this._toAgentLinks.remove(a),this._agentLinks&&this._agentLinks.remove(a)},getImage:function(){return this._image},setImage:function(a){var b=this._image,c=this.getWidth(),d=this.getHeight();this._image=a,this.firePropertyChange("image",b,a),this.firePropertyChange("width",c,this.getWidth()),this.firePropertyChange("height",d,this.getHeight())},getImageUrl:function(){return this._imageUrl},setImageUrl:function(a){if(this._imageUrl!=a){var b=this._imageUrl;this._imageUrl=a,Dd.images[a]||Ib.imageUtil.registerImageByUrl(a,"svg"===Ib.imageUtil.getImageType(a),a),this.setImage(a),this.firePropertyChange("imageUrl",b,a)}},getX:function(){return this._location.x},getY:function(){return this._location.y},setX:function(a){this.setLocation(a,this._location.y)},setY:function(a){this.setLocation(this._location.x,a)},getLocation:function(){return this._location},setLocation:function(a,b){var c;if(c=2===arguments.length?{x:arguments[0],y:arguments[1]}:arguments[0],Jb.num(c.x)&&Jb.num(c.y)&&(c.x!==this._location.x||c.y!==this._location.y)){var d=this._location;this._location=c,this.firePropertyChange("location",d,c)}},getCenterLocation:function(){return Ed.CENTER_LOCATION?this._location:{x:this.getX()+this.getWidth()/2,y:this.getY()+this.getHeight()/2}},setCenterLocation:function(a,b){var c;c=2===arguments.length?{x:arguments[0],y:arguments[1]}:Jb.clone(arguments[0]),Jb.num(c.x)&&Jb.num(c.y)&&(Ed.CENTER_LOCATION||(c.x-=this.getWidth()/2,c.y-=this.getHeight()/2),this.setLocation(c))},translate:function(a,b){this.setLocation(this.getX()+a,this.getY()+b)},getWidth:function(){if(Jb.num(this._width)&&this._width>=0)return this._width;if("object"!=typeof this._image){var a=Jb.getImageAsset(this._image);if(a){var b=a.getWidth();return Jb.num(b)&&b>=0?b:(a=a._image,Yc(this,a,a,"w"))}}else if(this._image)return this._image.w;return Ed.NODE_WIDTH},setWidth:function(a){var b=this._width;this._width=a,this.firePropertyChange("width",b,a)},getHeight:function(){if(Jb.num(this._height)&&this._height>=0)return this._height;if("object"!=typeof this._image){var a=Jb.getImageAsset(this._image);if(a){var b=a.getHeight();return Jb.num(b)&&b>=0?b:(a=a._image,Yc(this,a,a,"h"))}}else if(this._image)return this._image.h;return Ed.NODE_HEIGHT},setHeight:function(a){var b=this._height;this._height=a,this.firePropertyChange("height",b,a)},setSize:function(){2===arguments.length?(this.setWidth(arguments[0]),this.setHeight(arguments[1])):(this.setWidth(arguments[0].width),this.setHeight(arguments[0].height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},getRect:function(){var a=this.getOriginalRect();if(0===this._angle)return a;for(var b=Tb.createMatrix(this._angle*Math.PI/180,a.x+a.width/2,a.y+a.height/2),c=[{x:a.x,y:a.y},{x:a.x+a.width,y:a.y},{x:a.x+a.width,y:a.y+a.height},{x:a.x,y:a.y+a.height}],d=0,e=c.length;e>d;d++)c[d]=b.transform(c[d]);var f=Tb.getRect(c);return f},getOriginalRect:function(){var a=this,b=a.getWidth(),c=a.getHeight();return Ed.CENTER_LOCATION?{x:a._location.x-b/2,y:a._location.y-c/2,width:b,height:c}:{x:a.getX(),y:a.getY(),width:b,height:c}},getAngle:function(){return this._angle},setAngle:function(a){var b=this._angle;this._angle=a%360,this.firePropertyChange("angle",b,this._angle)},onParentChanged:function(a,b){Ld.superClass.onParentChanged.call(this,a,b),this._checkLinkAgent()},_checkLinkAgent:function(){if(Ib._isInitializing){if(this._links)for(var a=this._links.size(),b=0;a>b;b++)this._links.get(b)._checkAgentNode()}else Ib.ElementBox.prototype.startBatch(function(){if(this._links)for(var a=this._links.size(),b=0;a>b;b++)this._links.get(b)._checkAgentNode()},this)},onPropertyChanged:function(a){if(Ld.superClass.onPropertyChanged.call(this,a),this._followers)for(var b=this._followers.toList(),c=b.size(),d=0;c>d;d++)b.get(d).handleHostPropertyChange(a);this.getParent()instanceof Nd&&Ld.IS_INTERESTED_NODE_PROPERTY[a.property]&&this.getParent().updateLocationFromChildren()},getElementUIClass:function(){return Ib.network.NodeUI},getCanvasUIClass:function(){return Ib.canvas.NodeUI},getVectorUIClass:function(){return Ib.vector.NodeUI}});var Md=function(a){Md.superClass.constructor.call(this,a)};Ib.HTMLNode=Md,Jb.ext("twaver.HTMLNode",Ib.Node,{getElementUIClass:function(){return Ib.network.HTMLNodeUI},getCanvasUIClass:function(){return Ib.canvas.HTMLNodeUI},getVectorUIClass:function(){return Ib.vector.HTMLNodeUI}}),Ib.Link=function(a,b,c){Ib.Link.superClass.constructor.call(this,a instanceof Ld?null:a),a instanceof Ld&&(c=b,b=a),b&&this.setFromNode(b),c&&this.setToNode(c)},Ib.Link.IS_INTERESTED_BUNDLE_STYLE={"link.bundle.enable":1,"link.bundle.id":1,"link.bundle.independent":1},Jb.ext("twaver.Link",Ib.Element,{_fromNode:null,_toNode:null,_fromAgent:null,_toAgent:null,_icon:Ed.ICON_LINK,getFromNode:function(){return this._fromNode},getToNode:function(){return this._toNode},getFromAgent:function(){return this._fromAgent},getToAgent:function(){return this._toAgent},setFromNode:function(a){if(this._fromNode!==a){var b=this._fromNode;this._fromNode=a,b&&b._removeFromLink(this),this._fromNode&&this._fromNode._addFromLink(this),this._checkAgentNode(),this.firePropertyChange("fromNode",b,a)}},setToNode:function(a){if(this._toNode!==a){var b=this._toNode;this._toNode=a,b&&b._removeToLink(this),this._toNode&&this._toNode._addToLink(this),this._checkAgentNode(),this.firePropertyChange("toNode",b,a)}},isLooped:function(){return this._fromNode===this._toNode&&null!=this._fromNode&&null!=this._toNode},_checkAgentNode:function(){Ib._isInitializing?Ib._links[this._id]||(Ib._links[this._id]=this):this._checkAgentNodeImpl()},_checkAgentNodeImpl:function(){var a,b,c=vc.figureFromAgent(this),d=this;this._fromAgent!=c&&(a=this._fromAgent,this._fromAgent&&this._fromAgent._removeFromAgentLink(this),this._fromAgent=c,this._fromAgent&&this._fromAgent._addFromAgentLink(this),this.firePropertyChange("fromAgent",a,this._fromAgent),Ib._isInitializing?(a&&this._toAgent&&(b=a._id+":"+this._toAgent._id,Ib._bundleLinks[b]||(Ib._bundleLinks[b]=[a,this._toAgent])),this._fromAgent&&this._toAgent&&(b=this._fromAgent._id+":"+this._toAgent._id,Ib._bundleLinks[b]||(Ib._bundleLinks[b]=[this._fromAgent,this._toAgent]))):(vc.resetBundleLinks(a,d._toAgent),vc.resetBundleLinks(d._fromAgent,d._toAgent)));var e=vc.figureToAgent(this);this._toAgent!=e&&(a=this._toAgent,this._toAgent&&this._toAgent._removeToAgentLink(this),this._toAgent=e,this._toAgent&&this._toAgent._addToAgentLink(this),this.firePropertyChange("toAgent",a,this._toAgent),Ib._isInitializing?(a&&this._fromAgent&&(b=a._id+":"+this._fromAgent._id,Ib._bundleLinks[b]||(Ib._bundleLinks[b]=[a,this._fromAgent])),this._toAgent&&this._fromAgent&&(b=this._toAgent._id+":"+this._fromAgent._id,Ib._bundleLinks[b]||(Ib._bundleLinks[b]=[this._toAgent,this._fromAgent]))):(vc.resetBundleLinks(a,d._fromAgent),vc.resetBundleLinks(d._toAgent,d._fromAgent)))},_setBundleLinks:function(a){this._bundleLinks=a,this.firePropertyChange("bundleLinks",!0,!1)},getBundleLinks:function(){return this._bundleLinks},getBundleCount:function(){return this._bundleLinks?this._bundleLinks.getLinks().size():1},getBundleIndex:function(){return this._bundleLinks?this._bundleLinks.getLinks().indexOf(this):0},reverseBundleExpanded:function(){if(this._bundleLinks&&this._bundleLinks.getLinks().size()>0){var a,b,c=this._bundleLinks.getLinks(),d=!this.getStyle("link.bundle.expanded");for(a=0;a<c.size();a++)b=c.get(a),b.setStyle("link.bundle.expanded",d);var e=this._bundleLinks.getSiblings();for(a=0;a<e.size();a++){var f=e.get(a);if(f!=this._bundleLinks){c=f.getLinks();for(var g=0;g<c.size();g++)b=c.get(g),b.firePropertyChange("bundleLinks",null,f)}}return!0}return!1},isBundleAgent:function(){return null!=this._bundleLinks&&this._bundleLinks.getLinks().size()>1&&this===this._bundleLinks.getLinks().get(0)&&!this.getStyle("link.bundle.expanded")},onStyleChanged:function(a,b,c){Ib.Link.superClass.onStyleChanged.call(this,a,b,c),Ib.Link.IS_INTERESTED_BUNDLE_STYLE[a]&&vc.resetBundleLinks(this._toAgent,this._fromAgent)},getElementUIClass:function(){return Ib.network.LinkUI;
},getCanvasUIClass:function(){return Ib.canvas.LinkUI},getVectorUIClass:function(){return Ib.vector.LinkUI},isAdjustedToBottom:function(){return Ed.IS_LINK_ADJUSTED_TO_BOTTOM}}),Ib.HTMLLink=function(a,b,c){Ib.HTMLLink.superClass.constructor.call(this,a,b,c)},Ib.Util.ext("twaver.HTMLLink",Ib.Link,{getElementUIClass:function(){return Ib.network.HTMLLinkUI},getCanvasUIClass:function(){return Ib.canvas.HTMLLinkUI},getVectorUIClass:function(){return Ib.vector.HTMLLinkUI}}),Ib.Follower=function(a){this._isUpdatingFollower=!1,this._isUpdatingLocation=!1,Ib.Follower.superClass.constructor.call(this,a)},Ib.Follower.IS_INTERESTED_HOST_GRID_PROPERTY={location:1,width:1,height:1,"S:grid.row.count":1,"S:grid.column.count":1,"S:grid.row.percents":1,"S:grid.column.percents":1,"S:grid.border":1,"S:grid.border.left":1,"S:grid.border.right":1,"S:grid.border.top":1,"S:grid.border.bottom":1,"S:grid.padding":1,"S:grid.padding.left":1,"S:grid.padding.right":1,"S:grid.padding.top":1,"S:grid.padding.bottom":1},Ib.Follower.IS_INTERESTED_FOLLOWER_STYLE={"follower.row.index":1,"follower.column.index":1,"follower.row.span":1,"follower.column.span":1,"follower.padding":1,"follower.padding.left":1,"follower.padding.right":1,"follower.padding.top":1,"follower.padding.bottom":1},Jb.ext("twaver.Follower",Ld,{_host:null,getHost:function(){return this._host},setHost:function(a){if(this!==a&&this._host!==a){var b=this._host;b&&b._removeFollower(this),this._host=a,this._host&&this._host._addFollower(this),this.firePropertyChange("host",b,a),this.onHostChanged(b,a)}},onStyleChanged:function(a,b,c){Ib.Follower.superClass.onStyleChanged.call(this,a,b,c),Ib.Follower.IS_INTERESTED_FOLLOWER_STYLE[a]&&this.updateFollower(null)},setLocation:function(){this._isUpdatingLocation||(this._isUpdatingLocation=!0,Ib.Follower.superClass.setLocation.apply(this,arguments),this._isUpdatingLocation=!1)},onHostChanged:function(a,b){this.updateFollower(null)},handleHostPropertyChange:function(a){this.updateFollower(a)},updateFollower:function(a){this._isUpdatingFollower||Jb.isDeserializing||(this._isUpdatingFollower=!0,this.updateFollowerImpl(a),this._isUpdatingFollower=!1)},updateFollowerImpl:function(a){var b=this.getHost();if(b instanceof Ib.Grid){if(!a||Ib.Follower.IS_INTERESTED_HOST_GRID_PROPERTY[a.property]){var c=this.getStyle("follower.row.index"),d=this.getStyle("follower.column.index"),e=b.getCellRect(c,d);if(!e)return;var f=this.getStyle("follower.row.span"),g=this.getStyle("follower.column.span");if(1!=f||1!=g){var h=b.getCellRect(c+f-1,d+g-1);h&&(e=Tb.unionRect(e,h))}if(Tb.addPadding(e,this,"follower.padding"),this.getStyle("follower.fill.cell"))this.setLocation(e.x,e.y),this.setWidth(e.width),this.setHeight(e.height);else{var i=this.getStyle("follower.cell.position");e=Vb.get(i,e,this.getRect()),this.setLocation(e.x,e.y)}}}else if(null!=a&&"location"===a.property){var j=a.oldValue,k=a.newValue,l=this.getLocation();this.setLocation(l.x+(k.x-j.x),l.y+(k.y-j.y))}},isHostOn:function(a){if(!a)return!1;for(var b={},c=this._host;c&&c!=this&&!b[c.getId()];){if(c===a)return!0;b[c.getId()]=c,c=c instanceof Ib.Follower?c.getHost():null}return!1},isLoopedHostOn:function(a){return this.isHostOn(a)&&a.isHostOn(this)}});var Nd=function(a){this._isUpdatingLocationFromChildren=!1,this._isAdjusting=!1,this._expanded=!1,Nd.superClass.constructor.call(this,a)};Ib.Group=Nd,Jb.ext("twaver.Group",Ib.Follower,{_image:Ed.IMAGE_GROUP,_icon:Ed.ICON_GROUP,isAdjustedToBottom:function(){return this.isExpanded()&&vc.hasAgentLinks(this)},onChildAdded:function(a,b){Nd.superClass.onChildAdded.apply(this,arguments),this.updateLocationFromChildren()},onChildRemoved:function(a,b){Nd.superClass.onChildRemoved.apply(this,arguments),this.updateLocationFromChildren()},updateLocationFromChildren:function(){if(!this._isAdjusting&&!Jb.isDeserializing){for(var a,b,c=0,d=this.getChildrenSize();d>c;c++)b=this.getChildAt(c),b instanceof Ld&&(a=Tb.unionRect(a,this.getChildRect(b)));a&&(this._isUpdatingLocationFromChildren=!0,"lefttop"===Ed.GROUP_EXPAND_ALIGN?this.setLocation(a.x-this.getWidth()/2,a.y-this.getHeight()/2):this.setLocation(a.x+a.width/2-this.getWidth()/2,a.y+a.height/2-this.getHeight()/2),this._isUpdatingLocationFromChildren=!1)}},getChildRect:function(a){var b;return a instanceof Ld&&(a instanceof Nd?(a.isExpanded()&&a.getChildren().forEach(function(c){b=Tb.unionRect(b,a.getChildRect(c))}),b||(b=a.getRect())):b=a.getRect()),b},setLocation:function(){if(!this._isAdjusting){var a;if(a=2===arguments.length?{x:arguments[0],y:arguments[1]}:arguments[0],!Jb.isDeserializing&&!this._isUpdatingLocationFromChildren){this._isAdjusting=!0;var b=a.x-this.getX(),c=a.y-this.getY();vc.moveElements(this.getChildren(),b,c),this._isAdjusting=!1}Nd.superClass.setLocation.call(this,a)}},reverseExpanded:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._expanded},setExpanded:function(a){if(this._expanded!==a){var b=this._expanded;this._expanded=a,this.firePropertyChange("expanded",b,this._expanded),this._checkLinkAgent()}},_checkLinkAgent:function(){Nd.superClass._checkLinkAgent.call(this);for(var a=this.getChildrenSize(),b=0;a>b;b++){var c=this.getChildAt(b);c instanceof Ld&&c._checkLinkAgent()}},getElementUIClass:function(){return Ib.network.GroupUI},getCanvasUIClass:function(){return Ib.canvas.GroupUI},getVectorUIClass:function(){return Ib.vector.GroupUI}}),Ib.SubNetwork=function(a){Ib.SubNetwork.superClass.constructor.call(this,a)},Jb.ext("twaver.SubNetwork",Ib.Follower,{ISubNetwork:!0,_image:Ed.IMAGE_SUBNETWORK,_icon:Ed.ICON_SUBNETWORK,_checkLinkAgent:function(){Ib.SubNetwork.superClass._checkLinkAgent.call(this);for(var a=this.getChildrenSize(),b=0;a>b;b++){var c=this.getChildAt(b);c instanceof Ld&&c._checkLinkAgent()}}}),Ib.Grid=function(a){Ib.Grid.superClass.constructor.call(this,a)},Jb.ext("twaver.Grid",Ib.Follower,{_icon:Ed.ICON_GRID,_image:null,getCellObject:function(a,b){1===arguments.length&&(b=a.y,a=a.x);for(var c=this.getStyle("grid.row.count"),d=this.getStyle("grid.column.count"),e=0;c>e;e++)for(var f=0;d>f;f++){var g=this.getCellRect(e,f);if(Tb.containsPoint(g,a,b))return{rowIndex:e,columnIndex:f,rect:g}}return null},getCellRect:function(a,b){var c=this.getStyle("grid.row.count"),d=this.getStyle("grid.column.count");if(0>=c||0>=d)return null;if(0>a||a>=c)return null;if(0>b||b>=d)return null;var e=this.getRect();Tb.addPadding(e,this,"grid.border");var f=0,g=this.getStyle("grid.row.percents"),h=this.getStyle("grid.column.percents");if(g&&g.length===c){var i=0;for(f=0;a>f;f++)i+=e.height*g[f];e.y+=i,e.height=e.height*g[a]}else e.height=e.height/c,e.y+=e.height*a;if(h&&h.length===d){var j=0;for(f=0;b>f;f++)j+=e.width*h[f];e.x+=j,e.width=e.width*h[b]}else e.width=e.width/d,e.x+=e.width*b;return Tb.addPadding(e,this,"grid.padding"),e},getElementUIClass:function(){return Ib.network.GridUI},getCanvasUIClass:function(){return Ib.canvas.GridUI},getVectorUIClass:function(){return Ib.vector.GridUI}}),Ib.ShapeNode=function(a){this._isUpdatingShapeNode=!1,this._points=new nd,Ib.ShapeNode.superClass.constructor.call(this,a)},Jb.ext("twaver.ShapeNode",Ib.Follower,{_icon:Ed.ICON_SHAPENODE,__accessor:["segments"],getElementUIClass:function(){return Ib.network.ShapeNodeUI},getCanvasUIClass:function(){return Ib.canvas.ShapeNodeUI},getVectorUIClass:function(){return Ib.vector.ShapeNodeUI},getPoints:function(){return this._points},setPoints:function(a){a||(a=new nd);var b=new nd(this._points);this._points=a,this.firePointsChange(b,this._points)},getSegments:function(){return this._segments},setSegments:function(a){a||(a=new nd);var b=new nd(this._segments);this._segments=a,this._reCalculateLineLength(),this.firePropertyChange("segments",b,this._segments)},addPoint:function(a,b){var c=new nd(this._points);this._points.add(a,b),this.firePointsChange(c,this._points)},setPoint:function(a,b){var c=new nd(this._points);this._points.set(a,b),this.firePointsChange(c,this._points)},removePoint:function(a){var b=new nd(this._points);this._points.remove(a),this.firePointsChange(b,this._points)},removeAt:function(a){var b=new nd(this._points);this._points.removeAt(a),this.firePointsChange(b,this._points)},setWidth:function(a){if(1>a&&(a=1),!this._isUpdatingShapeNode&&!Jb.isDeserializing){this._isUpdatingShapeNode=!0;for(var b=new nd(this._points),c=0;c<this._points.size();c++){var d=this._points.get(c);d.x=(d.x-this.getX())*a/this.getWidth()+this.getX()}this.firePointsChange(b,this._points),this._isUpdatingShapeNode=!1}Ib.ShapeNode.superClass.setWidth.apply(this,arguments)},setHeight:function(a){if(1>a&&(a=1),!this._isUpdatingShapeNode&&!Jb.isDeserializing){this._isUpdatingShapeNode=!0;for(var b=new nd(this._points),c=0;c<this._points.size();c++){var d=this._points.get(c);d.y=(d.y-this.getY())*a/this.getHeight()+this.getY()}this.firePointsChange(b,this._points),this._isUpdatingShapeNode=!1}Ib.ShapeNode.superClass.setHeight.apply(this,arguments)},setLocation:function(){if(!this._isUpdatingShapeNode&&!Jb.isDeserializing){var a;if(a=2===arguments.length?{x:arguments[0],y:arguments[1]}:arguments[0],!Jb.num(a.x)||!Jb.num(a.y))return;var b=a.x-this.getX(),c=a.y-this.getY();if(0===b&&0===c)return;this._isUpdatingShapeNode=!0;for(var d=new nd(this._points),e=0;e<this._points.size();e++){var f=this._points.get(e);f.x+=b,f.y+=c}this.firePointsChange(d,this._points),this._isUpdatingShapeNode=!1}Ib.ShapeNode.superClass.setLocation.apply(this,arguments)},firePointsChange:function(a,b){if(!this._isUpdatingShapeNode&&!Jb.isDeserializing){var c=Tb.getRect(b);c?(this._isUpdatingShapeNode=!0,Ed.CENTER_LOCATION?this.setLocation(c.x+c.width/2,c.y+c.height/2):this.setLocation(c.x,c.y),this.setWidth(c.width),this.setHeight(c.height),this._isUpdatingShapeNode=!1):(this._isUpdatingShapeNode=!0,this.setWidth(0),this.setHeight(0),this._isUpdatingShapeNode=!1)}this._reCalculateLineLength(),this.firePropertyChange("points",a,b)},_reCalculateLineLength:function(){this._lineLength=null!=this._points&&this._points.size()>0?Tb.calculateLineLength(this._points,this._segments):0},getLineLength:function(){return this._lineLength}}),Ib.Bus=function(a){this._styleMap={},this._styleMap["vector.fill"]=!1,this._styleMap["shapenode.closed"]=!1,Ib.Bus.superClass.constructor.call(this,a)},Jb.ext("twaver.Bus",Ib.ShapeNode,{_icon:Ed.ICON_BUS,firePointsChange:function(a,b){var c=b.size();if(!Jb.isDeserializing&&c>=2)for(var d=b.get(0),e=1;c>e;e++){var f=b.get(e);Math.abs(f.x-d.x)>Math.abs(f.y-d.y)?f.y=d.y:f.x=d.x,d=f}Ib.Bus.superClass.firePointsChange.apply(this,arguments)}}),Ib.ShapeLink=function(a,b,c){this._points=new nd,this._styleMap={},this._styleMap["link.bundle.enable"]=!1,Ib.ShapeLink.superClass.constructor.call(this,a,b,c)},Jb.ext("twaver.ShapeLink",Ib.Link,{_icon:Ed.ICON_SHAPELINK,getElementUIClass:function(){return Ib.network.ShapeLinkUI},getCanvasUIClass:function(){return Ib.canvas.ShapeLinkUI},getVectorUIClass:function(){return Ib.vector.ShapeLinkUI},getPoints:function(){return this._points},setPoints:function(a){a||(a=new nd);var b=new nd(this._points);this._points=a,this.firePointsChange(b,this._points)},addPoint:function(a,b){var c=new nd(this._points);this._points.add(a,b),this.firePointsChange(c,this._points)},setPoint:function(a,b){var c=new nd(this._points);this._points.set(a,b),this.firePointsChange(c,this._points)},removePoint:function(a){var b=new nd(this._points);this._points.remove(a),this.firePointsChange(b,this._points)},removeAt:function(a){var b=new nd(this._points);this._points.removeAt(a),this.firePointsChange(b,this._points)},firePointsChange:function(a,b){this.firePropertyChange("points",a,b)}}),Ib.ShapeSubNetwork=function(a){Ib.ShapeSubNetwork.superClass.constructor.call(this,a)},Jb.ext("twaver.ShapeSubNetwork",Ib.ShapeNode,{ISubNetwork:!0,_icon:Ed.ICON_SHAPESUBNETWORK,_checkLinkAgent:function(){Ib.ShapeSubNetwork.superClass._checkLinkAgent.call(this);for(var a=this.getChildrenSize(),b=0;a>b;b++){var c=this.getChildAt(b);c instanceof Ld&&c._checkLinkAgent()}}}),Ib.LinkSubNetwork=function(){Ib.LinkSubNetwork.superClass.constructor.apply(this,arguments)},Jb.ext("twaver.LinkSubNetwork",Ib.Link,{ISubNetwork:!0,_icon:Ed.ICON_LINKSUBNETWORK}),Ib.ShapeLinkSubNetwork=function(){Ib.ShapeLinkSubNetwork.superClass.constructor.apply(this,arguments)},Jb.ext("twaver.ShapeLinkSubNetwork",Ib.ShapeLink,{ISubNetwork:!0,_icon:Ed.ICON_LINKSUBNETWORK}),Ib.RotatableNode=function(a){Ib.RotatableNode.superClass.constructor.call(this,a)},Jb.ext("twaver.RotatableNode",Ib.Follower,{getWidth:function(){return 0==this._angle?this._getOrignalWidth():this._getRotateRect().width},setWidth:function(a){},getHeight:function(){return 0==this._angle?this._getOrignalHeight():this._getRotateRect().height},setHeight:function(a){},getElementUIClass:function(){return Ib.network.RotatableNodeUI},getCanvasUIClass:function(){return Ib.canvas.RotatableNodeUI},getVectorUIClass:function(){return Ib.vector.RotatableNodeUI},_getRotateRect:function(){for(var a=this._getOrignalWidth(),b=this._getOrignalHeight(),c=Tb.createMatrix(this._angle*Math.PI/180,a/2,b/2),d=[{x:0,y:0},{x:a,y:0},{x:a,y:b},{x:0,y:b}],e=0,f=d.length;f>e;e++)d[e]=c.transform(d[e]);return Tb.getRect(d)},_getOrignalWidth:function(){return Ib.RotatableNode.superClass.getWidth.call(this)},_getOrignalHeight:function(){return Ib.RotatableNode.superClass.getHeight.call(this)}}),Ib.controls.ControlBase=function(){Ib.controls.ControlBase.superClass.constructor.apply(this,arguments),this._pools=new nd},Jb.ext("twaver.controls.ControlBase",Ib.PropertyChangeDispatcher,{_autoAdjustBounds:!1,addPool:function(a){this._pools.contains(a)||this._pools.add(a)},removePool:function(a){this._pools.remove(a)},adjustBounds:function(a){var b=this._view.style;b.position="absolute",b.left=a.x+"px",b.top=a.y+"px",b.width=a.width+"px",b.height=a.height+"px",this._autoAdjustBounds===!0&&(b.left="0px",b.top="0px",b.right="0px",b.bottom="0px"),this.invalidate&&this.invalidate()},setAutoAdjustBounds:function(b){b===!0?Wb.addEventListener("resize","_handleResize",a,this):Wb.removeEventListener("resize",a,this),this._autoAdjustBounds=b},isAutoAdjustBounds:function(){return this._autoAdjustBounds},_handleResize:function(a){this.adjustBounds({x:0,y:0,width:Ob.documentElement.clientWidth,height:Ob.documentElement.clientHeight})},getView:function(){return this._view},invalidate:function(a){this._invalidate||(this._invalidate=!0,Jb.callLater(this.validate,this,null,a))},validate:function(){this._invalidate&&(this._invalidate=!1,0===this._view.offsetWidth&&0===this._view.offsetHeight&&null!==this._reinvalidateCount?(this._reinvalidateCount===b&&(this._reinvalidateCount=100),this._reinvalidateCount>0?this._reinvalidateCount--:this._reinvalidateCount=null,this.invalidate()):this.validateImpl())},validateImpl:function(){}}),Ib.controls.ViewBase=function(){Ib.controls.ViewBase.superClass.constructor.apply(this,arguments),this._interactionDispatcher=new Ib.EventDispatcher,this._viewDispatcher=new Ib.EventDispatcher},Jb.ext("twaver.controls.ViewBase",Ib.controls.ControlBase,{__bool:["focusOnClick"],_focusOnClick:Ed.FOCUS_ON_CLICK,getSelectionModel:function(){return this._selectionModel?this._selectionModel:this._box.getSelectionModel()},isShareSelectionModel:function(){return null==this._selectionModel},setShareSelectionModel:function(a){var b=null==this._selectionModel;b!==a&&(a?(this._box.getSelectionModel().addSelectionChangeListener(this.handleSelectionChange,this),this._selectionModel.removeSelectionChangeListener(this.handleSelectionChange,this),this._selectionModel.dispose(),this._selectionModel=null):(this._box.getSelectionModel().removeSelectionChangeListener(this.handleSelectionChange,this),this._selectionModel=new Ib.SelectionModel(this._box),this._selectionModel.addSelectionChangeListener(this.handleSelectionChange,this)),this.onShareSelectionModelChanged(),this.firePropertyChange("shareSelectionModel",b,a))},removeSelection:function(){if(0===this.getSelectionModel().size())return null;var a=this.getSelectionModel().toSelection();return this._box._undoManager._enabled&&this._box._undoManager.startBatch(),a.forEach(function(a){this._box.remove(a)},this),this._box._undoManager._enabled&&this._box._undoManager.endBatch(),a},selectAll:function(){var a=new nd;return this._box.forEach(function(b){this.isVisible(b)&&a.add(b)},this),this.getSelectionModel().setSelection(a),a},isSelected:function(a){return this.getSelectionModel().contains(a)},isSelectable:function(a){return this.getSelectionModel().isSelectable(a)},getLabel:function(a){return a.getName()},getToolTip:function(a){return a.getToolTip()},getIcon:function(a){return a.getIcon()},getSelectColor:function(a){return Ed.SELECT_COLOR},addViewListener:function(a,b,c){this._viewDispatcher.add(a,b,c)},removeViewListener:function(a,b){this._viewDispatcher.remove(a,b)},fireViewEvent:function(a){this._viewDispatcher.fire(a)},addInteractionListener:function(a,b,c){this._interactionDispatcher.add(a,b,c)},removeInteractionListener:function(a,b){this._interactionDispatcher.remove(a,b)},fireInteractionEvent:function(a){this._interactionDispatcher.fire(a)},invalidate:function(a){this._invalidate||(this._invalidate=!0,this.fireViewEvent({kind:"invalidate"}),Jb.callLater(this.validate,this,null,a))},validate:function(){this._invalidate&&(this._invalidate=!1,Mb||0!==this._view.offsetWidth||0!==this._view.offsetHeight||null===this._reinvalidateCount?(this._isValidating=!0,this.fireViewEvent({kind:"validateStart"}),this.validateImpl(),this.fireViewEvent({kind:"validateEnd"}),delete this._isValidating):(this._reinvalidateCount===b&&(this._reinvalidateCount=100),this._reinvalidateCount>0?this._reinvalidateCount--:this._reinvalidateCount=null,this.invalidate()))}}),Ib.controls.View=function(){Ib.controls.View.superClass.constructor.apply(this,arguments)},Jb.ext("twaver.controls.View",Ib.controls.ViewBase,{_zoom:1,_maxZoom:Ed.ZOOM_MAX,_minZoom:Ed.ZOOM_MIN,getRootDiv:function(){return this._rootDiv},isValidEvent:function(a){return Wb.isValidEvent(this._view,a)},getAlarmFillColor:function(a){if(a.IElement){var b=a.getAlarmState().getHighestNewAlarmSeverity();if(b)return b.color}return null},getInnerColor:function(a){if(a.IElement){var b=a.getAlarmState().getHighestNativeAlarmSeverity();return b?b.color:a.getStyle("inner.color")}return null},getOuterColor:function(a){if(a.IElement){var b=a.getAlarmState().getPropagateSeverity();return b?b.color:a.getStyle("outer.color")}return null},zoomOverview:function(a){var b=Math.min(this._view.clientWidth/this._viewRect.width,this._view.clientHeight/this._viewRect.height);this.setZoom(b,a)},getLogicalPoint:function(a){return Wb.getLogicalPoint(this._view,a,this.getZoom(),this._rootDiv)},centerByLogicalPoint:function(a,b,c){c&&Ib.animate.AnimateManager.endAnimate();var d=this._view.scrollWidth-this._view.clientWidth,e=this._view.scrollHeight-this._view.clientHeight,f=(a-this._view.clientWidth/this._zoom/2)*this._zoom,g=(b-this._view.clientHeight/this._zoom/2)*this._zoom;0>f&&(f=0),0>g&&(g=0),f>d&&(f=d),g>e&&(g=e),c?Ib.animate.AnimateManager.start(new Ib.animate.AnimateScrollPosition(this._view,f,g)):(this._view.scrollLeft=f,this._view.scrollTop=g)},panByOffset:function(a,b){a*=this.getZoom(),b*=this.getZoom();var c=this._view.scrollLeft+a,d=this._view.scrollTop+b,e=this._view.scrollWidth-this._view.clientWidth,f=this._view.scrollHeight-this._view.clientHeight;0>c&&(c=0),c>e&&(c=e),0>d&&(d=0),d>f&&(d=f);var g={x:(c-this._view.scrollLeft)/this.getZoom(),y:(d-this._view.scrollTop)/this.getZoom()};return this._view.scrollLeft=c,this._view.scrollTop=d,g},getMaxZoom:function(){return this._maxZoom},setMaxZoom:function(a){if(!(0>a)){var b=this._maxZoom;this._maxZoom=a,this.firePropertyChange("maxZoom",b,a),this.getZoom()>a&&this.setZoom(a)}},getMinZoom:function(){return this._minZoom},setMinZoom:function(a){if(!(0>a)){var b=this._minZoom;this._minZoom=a,this.firePropertyChange("minZoom",b,a),this.getZoom()<a&&this.setZoom(a,!1)}},getZoom:function(){return this._zoom},onZoomChanged:function(a,b){},zoomIn:function(a){this.setZoom(this._zoom*Ed.ZOOM_INCREMENT,a)},zoomOut:function(a){this.setZoom(this._zoom/Ed.ZOOM_INCREMENT,a)},zoomReset:function(a){this.setZoom(1,a)},checkZoom:function(a){return a<this._minZoom&&(a=this._minZoom),a>this._maxZoom&&(a=this._maxZoom),a},setZoom:function(a,b){if(Jb.num(a)&&!(0>=a)&&(a=this.checkZoom(a),a!==this._zoom))if(null==b&&(b=Ed.ZOOM_ANIMATE),b)Ib.animate.AnimateManager.start(new Ib.animate.AnimateZoom(this,a));else{var c=(this._view.scrollLeft+this._view.clientWidth/2)/this._zoom,d=(this._view.scrollTop+this._view.clientHeight/2)/this._zoom,e=this._zoom;this._zoom=a,Wb.setZoom(this._rootDiv,a),this.firePropertyChange("zoom",e,a),this.onZoomChanged(e,a),this.centerByLogicalPoint(c,d,!1)}},setTouchZoom:function(a){this.setZoom(a,!1)}}),function(){var a=function(a,b,c,d){var e=new Pb;e.src=d,Ib.Util.registerImage(a,e,b,c)};a("subnetwork_image",64,46,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAAuCAYAAACYlx/0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAB1JJREFUeNrkWmtQk1cafr4vUQhEiNeBpkWwXitCqK1WaiU4tCMjlmCnrU4rmE4v2v1Rmf7q7M6is/uj7e4OurMz7fSyiXXVddsasBa0xQawoqiFFPBWJATkVpQSLPdLTt/zkTCgSHVNuISXeZLvnC8JeZ7zvu8578kBRs/UhB0EE6GZwIaBmbCToIEXWSjBcAfCI4GLoZ3QzIX+0RwgpYnUsPT0dGY2m5nDwYagqKiYGQwGlpiYeKsQJvoc1UQjriKYCYwjJiaG5eScYN09fXeF8qsVLDk5hbneT2gWJkpYyARBJQpCMYFNV6nYRx9/wtq7uv8vnD57jkVGRjL+WYRmgsYDg+U+U0ydoiJvNpPjagICA2E6moVlERH39Zkt9hboEuJxobSUN+2iKMR2dPdYxkSAQD+FhoJSxxiLAY9LNsgtBeS6+qYFBuC/piNYGr7MLV/yZksLXkx6FpfKynjTRiJEtbR32EdFgNmB01REeAdjSHFm9N8146Ev8fgTq9zqqr/evImN8XGoq6nhzd1Nv7amelwA9awZOsrQBjizsHLaNCxf8YSEhUseue0L/nT5IgICArAp5RWP5Jeis2fwxpbN0jX3gtobv1g8IkCYOkjFiDiNvI63gx5QQ7/tD1i9Ng5KZcCYJtl3095BdqaJf3NjVX2j3u0CLA4LUTkcDjNzxvfLr24jbIdDmpLH3q7X1yMlKb5/xpGJSTwxOm9ZLldW2+9LgIhF8/vJ05zr76/EO399H0siHh1vawykvf0mSi1Fw9220/1cQRDyCBklV67a7kmA5eFLTNzt/ZVK/Ond3VCHPjwu1xqWwlM4lvnFQLvKehVtra23kyMRKFfsOVdyMfd3BYheHrmV3J4nPPz57/9CcEgoxqsRMdBADbRFQaQ+4HJZCWqrrDhtzkG1zTr49UZC6qnzxfZhBVj75EqVo89RybN9/MZNWLvhuYldg5AaDTVVOPnNURTmmwfCQxTF2O8KCi23CbBO+xQVLSxt+szZSP3LP9DrcHhFGSrQX431CrI/34+6a1VOcUR9tjnfOESAxHVxvD5XPbtZjwWRj8HbzNHTjexDeylELM41hBhlyvpGagibdBv40tYUOGMmknf8ET19ffBGk4si8r76H0rPF0rhIJPJww4czrDLfXx9+bqeprsodHR1w1utF31YGZeAlqYbaGyo4yvbdIJe2KZPLuZbUNoNz2O6ei683dqbfsbxz/e5QiFMrlD4SSs+1aw5cHhJ8hvJlLOCMG/hYtRfq+YZ8C25r59CujHVz9+rQ8Bl3TTIcxeHo7npOp8BtHI/Ig7XBhzDpDDV7GA4eWvkhn37pc650esmRQg4Yx8u3nJrZaV00dbZjclkLt5yV0e1tRwPjtPix6PrA14+0rO2zlaBkHkLJgXpcloROqtAO/eAPC5AydkCPBkXPykE4FydlivnNTOpkVZCNXZXZwf8/JXevRBqa8UZ83EqoQU+8+2V0UODzxS5TibKgnx8fLAoQiOVk96KzH2foOJCKWSiYOvpc2yXkuAUuXwP3TaczMrA07oXoPBSL+Be/n1WJqbK5TT6LLWzpxcyaXXU22tRKnx1zNEbdL2uBo89tVZyEW9CXVUFDO/vAnHkW+pGe1vHe0O2xIJUARpBFHlhhKSt27AmYaPXjHz+14dhMnzY32Ast765JdZ1T+a6aO3sapih9K+Sy2S68pIizJwTBHXo/Akd7/XVVhz453sozMmmmBe5Jxhrm5qTht0Uddl8dbCB3ruVX6+O1yFhy2sTbsQvnj+D77MzYb1UMtDHHCz1al3D7mE3RW+1R8JC0klBfpwFwSFhWP/yqwijCmpckCsqRENVJYLnhsGXCprO9jbUU7ujvRUN1ZVEumzI6xljRsKuS7ZrtuH3De9gkQvn6URBHPhdMJQEWPVMAhZHrRgz8vYbjfgg7W2J9EhGGd5GDxlEfM+P5VbbyBunI9jjSxepyBO4N2wd3B+6aCkio7USRss6O9rw2d92oqF/IG1E7lZiedTH9/1zz124ctc/mt7V+YBoTXgoifAWQUcIdfVvSNmOiFVrRkWAr/Z+iJLTeZIjUNkedaq41OaOz73nEyKxK5drnGJIXrF+y+tYtnK1B0e+HSe+3I/SMyelNidvLvxhbE6IDLb4mGiDS4SlK1YjVrcZvgo/t5JvrK3GsYOfSs/95Jn+WH6B0Z3/477OCCU+rd1JIqTx68AZs6DVbcKCcI0bRr0DRfnfouD4kYH8RyMfeyQnz+JuD7vvQ1LPr39GSyIYXLlhzgMP4dE1cZIQ9+oRLb/cQNm5Avxw8gS6yPWd01gukdd/kfWtzRMh5pZTYi/p1vPZYoczNwwcapxPIoQ8vFASZY76IRJEMeR9P9fWSESvVfyE8rJiNNbVDJ6/eabf9R/TUSM8aG49Jqd/IUkliiIXImXwbHEvRqQtNOJ7/n3osEeJe0SAwbY9ebOGxOBnjGKcYtxJEAsnTfiRkPHBZwdtGEX7TYABAPgBTYK366ChAAAAAElFTkSuQmCC"),a("bus_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAINJREFUeNqkU0EOgCAMo2Y/1P8Y/6NvnBADwTnGzHYiGetKW8DMKVJLChbVAwCNCrrzp5/Zg/4MaH0JMBOEh08o6OtxtgvXvkFuV/vFBeGEm0WZo8GgF+QlIkI2OrZq5WLAFjuy4DvVWXHl2VodyElMjkxAJNFm4EjmFGAqLKLf+RZgAKkFNRwzv7gHAAAAAElFTkSuQmCC"),a("data_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAMZJREFUeNqkU8ENwjAM9KEwWwaAKVA3iMQDtRtUTAEDdLZWMkkhIUljU4n7RInP9p3dgoiYBAzDgHAyfykA1rtzbr2bmpDDk5uBvu+ROO98pvs4FqRL10nCogokBS3UBaXCZg9JQ7JQY5qmZoK1trCQCuQJnoS9CsQZHKsNcOyWvS1ehdGqz8xyZ0BXEHG+PTdvj+uJkFsASsusdN5sQSKHGWgWfDxY1GcQfEIYIn4p+HuN+SqXRtL8+ZAOinwm5V+P8ZcAAwC0T1T5kpEqewAAAABJRU5ErkJggg=="),a("databox_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwMjI+N/BiIBUD0jMp8FpDm4cQ2DvYEiw8EL9/FqBqkBqUc3BGT7/0kbz/6HsXHhS/eewtWBXA7CYAMOX75PlCEgA9ANYYQaADbJVleRAShJ0Csw7+T5G2MaQCpgQReAuQAWqPhokAuYGCgEowZQwwBQuiYn/mGAEZaeYTkSlA6IBeCUCDMA2RBSsjZAgAEAOyp6/CYHWkwAAAAASUVORK5CYII="),a("grid_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAFdJREFUeNpi/P//PwMlgImBQsACIhgZGUl2BtDljCguAHkFhIMb1xBkU9ULjCATQV4A2UAsWFsfAvcCzEn/YQBoEEE2VD1Y76gXhpcXyM0LjJRmZ4AAAwCoyOJjz29PsAAAAABJRU5ErkJggg=="),a("group_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAOFJREFUeNqUUwsOwjAILa67i2fwEMbEnUej55mJO4Rn8DBtglAh6YfOSdJkBfregwEgottiHiAlQuZjh68TQRJzI5L07nSbC//zOrUAmkxAJXBP2VgxRjpDK818z06gZIwrfSACF0iVVZrLiab7ownOl7PTV0QESsRgWqoHt80oD0fpy/BVhuZfsOpkC8LYxAkBw4YedOdDhuRny1UyZEPE334NvbZ6kBYeJGFPKFgp4HsUAqtI9u1AYipJgfQ+GjtQlPvPMkGlBHrLdFjeBeHruE+hYAxSo6C3jb4zyh8BBgBVL19PZ27iaAAAAABJRU5ErkJggg=="),a("group_image",32,29,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAdCAYAAADLnm6HAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABHNJREFUeNqsV1ts21QY/uy4zc1ZnZY2bdbSLMlKxUWkaBJMgJY9gARIax/2NokVofLARWjiBYRY2QMdCGlI440H1ok3btsQ0wAxNdvKpnYdyyYK7UZHVK1L2rRZLo3j2InDOaZD60psp+WXrDjO93/nO7/PfwkDAwu0Nh8jH30wZwc6/f43X9jVJ5gBn/zueJozgaNkUXLtMwLyLt4XDG4Vtj+/B8lMQRf7QLsb079PCpzJnaVnEsmIEeiZgD/Mu5yYT4uYiWd1sW1NTlCsWQGmzC00gOd5lFQVkqLoYiuViobVBNzf3BRaCfUaUyuV2AomXI1sNrmkRUeUZBRlBXJJRVFRdQUoZVXDclvbvUeImn6j3VmAqpjg5ra0xcL2nDwdwW1JQeP2HJLLki7frVQOo+OXwNnttv5fp65vKPSvvLhHmBgf77fV10XqWBaLZPGEgYC0KIFiOYfdBoY8OH72D8QS6ZoX3x1+CFarFZSnxS1gk9OBeUJ+00BAimAolnM6nQDDEDVAHVOpWQBD/Ow2GyhPoyDHWKjYkr+GVrv+GWBmE6BYIsChRYCz0Kt2AWR92GxWUJ7TFy7GWltb9l368ZteM77lcukE53A4tC91VAC7jggwVIANd3h+OHM+Qlj2ktvQv9U0EIAkSZibm7vbNUpcIxxPQsfQV2BhwDHrE2C320F5qPnaPCMkdVel9EdDQ8iLeex/5+27H4dYljnGnRo5B1EUMT1fwI2lUs0CHs9JOD9xGeNjY9i7u9dXkKTovZgvv/j8H+y2njX+3FxiHmKhgHiGhCir1CwgKxawsLgEynP06xO0aO2sxV+rhAopm9migrRUuwCJVDMS8nXXEE2ALMtIF2UskVJaqxWIgIqqrl8ATUGFkNDaLKu174RGjzYWykO9A17P+6pa2WEqhVnmDOfmnUgmk+gN2vBsZ33NAng1DxspIpTH1+H1Pdrz2OCHn34GpaQfFYe1Dm+9+nKY62jzpIcG3xU20gukXAZtzU0Rkoo+mo6/TMZxI6E/Dzz9sFdLXc7jad6pSIW+jQho2OSKjl2djOyiAwmdB8jrLMj6Ka3emQd+Gh2jeUvTp7/aTGBgwyv+cJNm5HLx2plQSmX9AkYuiuXqOUuorKoj1RZ/7fU34PcHMLj/PSwv5/4LMsgy7EtKuTz887kLyMoq7CERi/miroD5TB4Xr/wGrsPT8omqqlV3PjAwgIYGAd9/+xVmrledG46QjhiZjs0iSYtSehk3M6KugAUigGK5rqA/rAc89MEBOJy81qq7u4LVJyYL27eYSkV50hkXxCLmDCKQIhiK5do3e3VL59TUNdrZ0N3dddTgLMQ89zX5XKQtP+m14kGB1QVv4VVMrIwCRn9M6PkAGctN1fjnwk9ddjc2hcxgb6eWov/rWE7tVGS0ZyWjfEYRoxlkVoBAIhE2gYst5vKDpVJ51QR96PBhxONxfHzw4Oo+wFl2mBFAJ1W6+IgR0OGwD2/zda4Z32/99ScpTiU80fPIvT/1/y3AAMOmtJl1Hv9IAAAAAElFTkSuQmCC"),a("link_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAHVJREFUeNqkkwEOgCAIRaEr6nlqdR49I4XTzcqUn39jE5xP1C+LCPkjCl0Kq2NC5fYgRXlMSCw0K6Xozhqaol3ckj+QVwGFNIsI5HPCCunSLZDhGUcQ0033IOb3riE1CLJty/bTVubUBqDyc+Pm01oY8NQpwAAbUwhLBQIWcAAAAABJRU5ErkJggg=="),a("linksubnetwork_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAU5JREFUeNqUUi1Tw0AQ3cukEY0AwdlDM8XRD41ARAAi/RHoCmQ7/QNofkTQFQh8W9kOOtgiQIBImTnuXbs3udAvduZms5t9b/fdrUiHGW2z0cOdLsdJ71GU46yfUrgL/PWx8HLxsUTOI3EE98mp9ZdXie0K8HgydYXtVtN6znHsTQAwdy2DOcY/TMFytkqogqskLIf6qQhYL7q/PI8cOIoiiuO69bvIRf3o5M/YANVqIZ03GjSbz2m5/KGiKDxgp90irbUINzEz2BSQEMKSwJiEwfgONmlFR4AAhg2yV0talWNfAbfJN4s7KHcCCcBPgy7WhobdM7q9uXbd3TPyhvEOwL4/30kpRVJKwrYySZ7nWABlzpsthM49R5lzYUhAruERr/P7CdZNPJJVakUiuOgAw9jSXOyUX8f4ZkCHGzQvAGIw4v9M4E0CMEh/BRgAwM37IYxGnbkAAAAASUVORK5CYII="),a("node_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAGBJREFUeNpiZGBg+M9AJvj//z8jC5RBsmZGRkYwzQITCGlaS7TmNXXBcDYTA4Vg1IDBYAAjJB2Rl5DgKRGWqshyATm2o3uBgcwMBbacBZdmZJfh8CJIASMLodxGCAAEGACTAB0gDBYjygAAAABJRU5ErkJggg=="),a("node_image",30,32,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAgCAYAAAAFQMh/AAAACXBIWXMAAAsTAAALEwEAmpwYAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAO0SURBVHjavJZJaF1lGIaffzzn3pvbxAyYJulgNKJIF7WkuhEHFCy40LpRBLdFcFi4ciOCC9dmU910WbduBEEoRhFEarJw2UaLJXFImya5ubln+AcX5+YG3ZjCaT44cDb/+5zv/Ybzi7npo7Mhhi+886c5hFBaLUshX9dKq8tW2bPjExOHweXW+vpZ7/1lrZWanz52jK+//f5QwC8+8xSrN2/Oa2OM10pJgKwoWd/cRQpRKyzEyMRIk9QatFIYY7xOEou1BoD1zS6ff/kTqbW1grtZyVsvz3N8cgRrDUli0dZabB+kpGSkYdHWUGfOSkT6prLH04m1GFOBBaAkKBkQsU5wACpBYyyJtfSt1hVYVGDZf68rpNjXs1b3rU72rZaAlhFJRMj6wJUm+1bv1diYqrmEFCgJQtaf8Z6gMaaqcbPRpJGmgxprCYhYK1iL/YwbaUqz0UTneUFeusG8uRARNYPLEAn95spLR54X6K+uLDI1NQ3A7e0ey3+UtBJDnfO004vc6WRMjg3zzeIPrK2toje3O6StLWII7GYFt7qOPNS7uTo9x25WEENgY2uLze0Oem9xhOBwwZM5j3WyVnDmPC54QnAoWWlrgBgj3nuc9+yWHq3rBe+Wlbb3nhjjPhiowM7TdQ7t6rW66xzOVeBBpw/AzlM4z3bpkTVnvF1W2t79B1xZXVI4x3bpUfcE7PC+/LfVUgic80giY6lhJDG1gmUESawY/QWhG0aLxBh2dnoMqcBrpyawNWdcuMCQCuzs9EiMoWG00GPDR2QrMVxdWqIsch5L1cCOukJowerKn/x9M6GVGMaGj0hx+uEHrypjzzwwN0cI4Z7et6SU/HbtGr4sftbNVvN9a5NP1m78elpK6a0x9wRalCUhBNUeai0Xhf5ASykXh4fbbxo9+nin2y2v3/i9B3jq29YRUA+dPN5ot1qmdOXS7dvldfHIiRky5wBJt9djfePONHA/4Or6KwJ/TYzet9pqNIBAqjVianSEtY1NgCeBd4FTQBuoq+AS6AC/AAvAj1OjIzAzPoqS8pyAFQHx/x4gzs7OxosXP4ufLizEkydORA5wrv+sKCnPzYyPooFHh5vppQiTB/n8PMt47523Of/qebIsY7fT4eOPPiRJkoMcnxVwCXhOH2kPXWi3WpMH7s48J5Ql1tpq3p3j6Pj44MJ4gJgUUlwQzz5xpgMMHbhFYyRNU55+/gWC93x35Qp5niHu7q60I9545aUeoO5qPkJAqupICOFuoQD+nwEAIKWd899qAZAAAAAASUVORK5CYII="),
a("shapelink_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAIJJREFUeNqkUwsOgCAIxeYN5Ty1Og+ekUarzRwQ5tsYDpTPExIzgwY86uWgtSTwIAF6KTvxg/sMliwwCy27mEVr2Xu7+TjaWm4JqxvKpW/iWowQprX2i8RXhS0xXv+WL0xiKIAVxKssa/0hEMuPiB4epNFxnh7lZG1jdCPdABGcAgwAc06H0rgwLSIAAAAASUVORK5CYII="),a("shapenode_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAI9JREFUeNq0UtsNgDAILI0jdZN2Ho3O027SnRA+MNb0QTWS8EPuLncAIKL5UvY5CEdC7h7pjrEtEABgqwucRCBFk7aAfo9uZJtwmXhQCLDyLJlrkSxaMuGgu8QZ8hVhYD8LVgZx9fMO1H9QKXbm+EJvBYwsuSYyFaEmUvyBUkQWCYUDfg5NV8/49xW6dQowAIJydCoPajIHAAAAAElFTkSuQmCC"),a("shapesubnetwork_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAATBJREFUeNpiDG5cw4ALbO/L+I/M9yyawYjMX1MXzMCCT/PXD69RxLgFREFiKIbADSjzlAfTjq6eYFtBmk+dPgNXaGZqAqZhYjA+igtAmmG2ImuG8UFyIFfAvIPTC+ia0Q2BeYehLpiRCeZfkO37d2/HqRmX4Yxc/CJwZ9+6fYeBEPjw4QOYNjczZfj//z8j3AuMjIjAvXnrNoomdTVVFDkonxEjEIEmgg1C1oAuhw5YQKEZGhHzH9kVbcuPoiiqirSGy5UUF8FtBwFwIK5esYQRaIMfyE/Y/A0yEGbopk2b/FACEeQ0mO1Ati+UvQndFciuAVkG5W5GMQDqV1+QAci2oxuAFC5+4MCBGQIzAEKBBbFimBxILc7MhOQiPzTxTcixwYhsOxLwRWJvxicHEGAAkPKxzyGuYWgAAAAASUVORK5CYII="),a("subnetwork_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAOJJREFUeNqkUjsOwjAMzavSBQYY4FDM7SGYOUARHICZQ5SBiUPBAAMLIJk8aFASkoDgSVFlu/68Z6NatCqF3Woqrj2ZreHabVMpnUs+H/eerz8c0+cV0amuTK6XG69bDEWsa5hM0KafU/DZeJRCmBwWsXRUUwEU0Y5tRFLfgHRMARYDeoPRSyy383Zee0nsgO5rcROBzo19FUlOoYG0Bp/0IAW7y4LHQT5GB/UL4F6ie3mX0yFLoTQUTByQxE8lQ51wMRHx1Chd4FtkReQUj3VFktj97ZSDNYkK9h6L/03hLsAAjRx4oMVjqkMAAAAASUVORK5CYII="),a=function(a,b,c,d){Ib.Util.registerImage(a,d,b,c)},a("expand_icon",16,18,"data:image/gif;base64,R0lGODlhEAASAIcAADFKY0L/QpSlvZylvZytxqW11qm92r3GxrnK5MbGxsbW69jh8efv9+vz/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAMAAAEALAAAAAAQABIAAAhfAAMIHEiwoMGDCBMqXMjQ4AICEAcMECDgwEECDjJmbMAAwEWNDjgi8GgQ40YGCwyQLDjAAYCXL1UeFBAS5QIFBVYSFMBxwU0EOWcyUIDAQIGjOgcegMnUYsOnUKMiDAgAOw=="),a("collapse_icon",16,18,"data:image/gif;base64,R0lGODlhEAASAIcAADFKY0L/QpSlvZylvZytxqW11qm92r3GxrXI48bGxsbS59Te8efv9+vz/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAMAAAEALAAAAAAQABIAAAhhAAMIHEiwoMGDCBMqXMjQ4AICEAcMECDgwEECDjJmbMAAwEWNADgq8GgQY0YADBYYIFlwgAMAMGGuPCjAAUcACxQUYElQAMcFABQg2EmTgVADBZLyHHggplOLDaNKnYowIAA7"),a("close_icon",11,11,"data:image/gif;base64,R0lGODlhCwALAIcAAHd3d319fUD/QIODg4iIiI6Ojq6urri4uNnZ2eHh4eTk5Ofn5/Dw8PT09Pj4+Pn5+fz8/P39/f///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAMAAAIALAAAAAALAAsAAAhdAAUIOECw4AGBAyUoXCjh4AEJDBA4mIiAQcMDERAUKOBgI4IIBCE0IECSZAMIBB8wYDCg5coHBBkkCECTZgIGMQ0AAKBgpwGcBxgsMLCgKFGcA1cqXXlQoMGCAgMCADs="),a("sort_desc",9,5,"data:image/gif;base64,R0lGODlhCQAFAJECAImJiezs7P///wAAACH5BAEAAAIALAAAAAAJAAUAAAIMDI4QYrnC0INxUnYLADs="),a("sort_asc",9,5,"data:image/gif;base64,R0lGODlhCQAFAJECAImJiezs7P///wAAACH5BAEAAAIALAAAAAAJAAUAAAIMlAWnwIrcDJwi2HsLADs="),a("submenu_enable_icon",8,8,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAA7SURBVHjafI9BDgAgDMKqH3c/ryd1iTqOpARARQUYJG0/AWboB2yoAgTG8jtvtXvMSUdVEdXIeN2cAwDPLmAjfDYS7AAAAABJRU5ErkJggg=="),a("submenu_disable_icon",8,8,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAABKSURBVHjafM9BDoAgDETRD1cTz0W9luDZxhUBCjpJkzZ9m0ESkrhLzW0fJ9JjpT4Zl+juBXmwoB0ACH/gOtNhX2B6AjDUtF3NdwAU6zx4LEQe5AAAAABJRU5ErkJggg=="),a("checkbox_selected_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAAflJREFUeNqkk09oE1EQxn+7btyIYBRCbayFtlhEtLeAin+KouDNo548eJHCQkFQC1K0Bw8VqT1EVIqo0IMUvejNg6AIIglSsdSCiA0WolaIOWi3+2fGw242CRFBHPjg8d7MfPO+mTEcxzkNDAF5/s1KwE0cxylWKhX1fV89r44gget6bVhd9bRcLqvjOEULyGezWTwvAMAwjIRCRAnD8I/0nZ05gLwZOTYeVBXQOIGgqgk+flrk3MUxVBWRyMeMw5oCG2eREFVBVZibf8+x4ydZLH9GVRISq5W5uXwhDKPSvnz9xolTZ/A29GNZFiJ1kjhBnVFVEw0a7MrQ8HlqbMZwXeYXlpL7ti/Usbz8Hd8PEBGmHzxk9kMVfI+BrWt4PHM/0abtC67r8vTZC4qlWY4c2s/Azh2MTxQwpIPduzZx99Z1bNtu1yBiFp6/fMXr4ht+/NzI+MQNBg/sxdccPbmAqcI1UqkUEresTQMR5ejhQbb19XJ25BJzC8Lbd3dIp22mCtPY9tokuDmB2VyBqtDb082VyxdYv26JXysrTF4dY0uuI3lvoKWCaOoMA1SF7q4u7t2eZObREw7u25MMTbPF8VGCqHNRB4IgQFXY3t/H6MhwLFirGYZBfeItoFSr1fKZTAbVaPbT6fRf19A0TarVKkDJ+N91/j0A8Y5o3Yt7KRAAAAAASUVORK5CYII="),a("checkbox_unselected_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAiUlEQVR42qXM3QYFIRiF4d3dJpIhI5FKJCOSSHe7f9gn4ztZo3Wwzt6HvTbHfhdCeD8Nvw27Ad57OI4xUsA5BwMpJQpYa2Eg50wBYwwMlFIocJ4nDFzXRQGtNQzUWilwHAcMtNYooJSCgd47BaSUMDDGoIAQAgbmnBTgnMPAWosCcP3fDdjZNvABvRhVEQglsV8AAAAASUVORK5CYII="),a("radiobutton_selected_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAXFJREFUeNrUUz9rwkAUv0syBVxMm01L2lIdilOg4BcQ7eKcIV/AqZAxo1/B2a/QoSSTH6AQCoFMJUSig5C0EiPEv8G+Z604eJNTHxz37vf73Y977+7obrcjlwRHLoyLDYTThWmav6AgKDA9wrg6UF8wvO12O8RFt9s9bwACwvP8U6lUajWbzbYsy/eIR1Hk27b9GgSBlef5O7OEzWZzC5ufNU17gc01gEQcmCOGHGqYJaxWq1qj0WhzHFfwfZ84jrPHVVUliqIUkPM87wOg4KzBcrm8liTpbr1ek8FgQNI03eOz2Yzouk6QQw3zBFmWUewDxnQ6JUmSHHsDRz9qmD0A8ns8HgcortfrRxxzxJBDDfMEi8XC7ff7b4Zh3FSr1UKlUtnjlFI0mCOHGqZBHMd+GIbWZDIROp1OCxqH74HA9Q17vZ7luq4liqJ/uoee/oVyufxX/wPctwqpfKAieB9OsVj8xMVoNDpv8D8/048AAwDskrF8QGeJUgAAAABJRU5ErkJggg=="),a("radiobutton_unselected_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAATVJREFUeNrUU71qhEAQ9q8S0mhip3C5kCpcFcgjiJfmal/BKr2lr2DtK1wR9BkCaYRUQTzUQtDE5sB/MTOJAQs3jVUGhp2Z75vPnV2XHseRWmMMtdJWC3DzxDTNnyLHbWC5A7+coA/wt77vT5hYlrUsAASKZdkHWZb3mqYdJEm6wXqWZYHneccwDN1hGF6II3Rddw3Nj7quP0HzDko8OsZYQww5RIGmaXaqqh4YhrnA3cwda4ghh3gGdV1fiaK4bdt28cAQQw5RoCxLGr/2lyGHOAKAn0mShDAnteSIIYcoUFWV7zjOM5DPuJPfxik+I4Yc4gh5ngdRFLlpmnKGYew3YFiH6zvZtu36vu/yPB/Me+j5W1AU5XstiuIW7vseQmmCMvg/XgVBeMckjuNlgf/5mL4EGAAhHbltcqEYDQAAAABJRU5ErkJggg=="),a("right_expand_icon",6,11,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAALCAYAAABcUvyWAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6N0ZBRTFFQjJGQjA1MTFFNUE5M0NCMDAwMTJBRUZCNjkiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6N0ZBRTFFQjNGQjA1MTFFNUE5M0NCMDAwMTJBRUZCNjkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpCMzYzQTE5MUZBRkYxMUU1QTkzQ0IwMDAxMkFFRkI2OSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpCMzYzQTE5MkZBRkYxMUU1QTkzQ0IwMDAxMkFFRkI2OSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqPQWR4AAABJSURBVHjaYvT08vrPwMAgCsQM27ZufcMABUxQ+jWI8PL2FkGXwJBElkCRRJeAS2KTAEvikhDFJiGKzSi4f5iwCSLrwPA5QIABAAmgFhOOHdKvAAAAAElFTkSuQmCC"),a("left_expand_icon",6,11,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAALCAYAAABcUvyWAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6N0ZBRTFFQjZGQjA1MTFFNUE5M0NCMDAwMTJBRUZCNjkiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6N0ZBRTFFQjdGQjA1MTFFNUE5M0NCMDAwMTJBRUZCNjkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo3RkFFMUVCNEZCMDUxMUU1QTkzQ0IwMDAxMkFFRkI2OSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo3RkFFMUVCNUZCMDUxMUU1QTkzQ0IwMDAxMkFFRkI2OSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PmpWGHAAAABISURBVHjaYvz//z8DDHh5e4tAma+ZsAmCCCZsgiDAfOr0aQxBuA50QZgEhiBMQhSXBAM2SaZtW7e+wSYJ1oFNEu5BdEmAAAMAvV8Xc/cw3YgAAAAASUVORK5CYII="),a("up_expand_icon",11,6,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAGCAYAAAAVMmT4AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QjM2M0ExOEZGQUZGMTFFNUE5M0NCMDAwMTJBRUZCNjkiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QjM2M0ExOTBGQUZGMTFFNUE5M0NCMDAwMTJBRUZCNjkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpCMzYzQTE4REZBRkYxMUU1QTkzQ0IwMDAxMkFFRkI2OSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpCMzYzQTE4RUZBRkYxMUU1QTkzQ0IwMDAxMkFFRkI2OSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PnCNygcAAABGSURBVHjaYvz//z8DDHh5e4tAma+BWBTE2LZ16xuYPBMOhXAaSRyiGItCBmwaGD29vHApRAaiyM7ApxAuz0SEQrgGgAADALOxFSETkKKwAAAAAElFTkSuQmCC"),a("down_expand_icon",11,6,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAGCAYAAAAVMmT4AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA0xpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QjM2M0ExOENGQUZGMTFFNUE5M0NCMDAwMTJBRUZCNjkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QjM2M0ExOEJGQUZGMTFFNUE5M0NCMDAwMTJBRUZCNjkiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKE1hY2ludG9zaCkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0iYWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOjQ5ZTRmZmE2LTQzNmYtMTE3OS04NThhLTk1ZGZjOWRiNmNiOCIgc3RSZWY6ZG9jdW1lbnRJRD0iYWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOjQ5ZTRmZmE2LTQzNmYtMTE3OS04NThhLTk1ZGZjOWRiNmNiOCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PtPgXX8AAAA7SURBVHjaYvH08vrPQCRgAmJRItWKMsEYhBSCTd62desbAhrA4iB1TDAGDg2iyPIwZ2DTIIomzgAQYAAmahUFv1Iq6AAAAABJRU5ErkJggg==")}(),Rb.__tree=function(a,b){a._rootVisible=!0,a._initTree=function(a){this._rootData=null,this._expandMap={},this._levelMap={}},a.validateModel=function(){this._rowDatas.clear(),this._levelMap={},this._dataRowMap={},this._currentLevel=0,this._rootData?this._rootVisible?this.isVisible(this._rootData)&&this._buildData(this._rootData):this._buildChildren(this._rootData):this._buildChildren(),delete this._currentLevel},a._buildData=function(a){this._dataRowMap[a.getId()]=this._rowDatas.size(),this._rowDatas.add(a),this._levelMap[a.getId()]=this._currentLevel,this.isExpanded(a)&&(this._currentLevel++,this._buildChildren(a),this._currentLevel--)},a._buildChildren=function(a){var b=a?a.getChildren():this._box.getRoots(),c=this.getCurrentSortFunction();c&&this.isChildrenSortable(a)?b.toList(this.isVisible,this).sort(c).forEach(function(a){this._buildData(a)},this):b.forEach(function(a){this.isVisible(a)&&this._buildData(a)},this)},a.getLevel=function(a){return this._levelMap[a.getId()]},a.getToggleImage=function(a){return a.getChildrenSize()>0?this.isExpanded(a)?this._expandIcon:this._collapseIcon:null},a.isCheckable=function(a){return this.isCheckMode()},a.isCheckMode=function(){return 1===Rb.__tree._checkMap[this._checkMode]},a.isChildrenSortable=function(a){return!0},a.handleDataBoxChange=function(a){"remove"===a.kind?delete this._expandMap[a.data.getId()]:"clear"===a.kind&&(this._expandMap={}),this.invalidateModel()},a.isExpanded=function(a){return 1===this._expandMap[a.getId()]},a.expand=function(a){if(!this.isExpanded(a)){for(var b=a.getParent();null!=b&&b!==this._rootData;)this._expandMap[b.getId()]=1,b=b.getParent();this._expandMap[a.getId()]=1,this.invalidateModel()}},a.collapse=function(a){this.isExpanded(a)&&(delete this._expandMap[a.getId()],this.invalidateModel())},a.expandAll=function(){this._box.forEach(function(a){this._expandMap[a.getId()]=1},this),this.invalidateModel()},a.collapseAll=function(){this._expandMap={},this.invalidateModel()},a._handleClick=function(a){if(this.isFocusOnClick()&&Ib.Util.setFocus(this._view),!this._isValidating){var b;if(a.target._expandData)b=a.target._expandData,this.isExpanded(b)?(this.collapse(b),this.fireInteractionEvent({kind:"collapse",data:b})):(this.expand(b),this.fireInteractionEvent({kind:"expand",data:b}));else if(a.target._selectData||a.target.parentNode._selectData){if(this._handlePressSelection(a.target._selectData||a.target.parentNode._selectData,a),this.isCheckMode()){var c=this.getRowIndexAt(a);c>=0&&this.__handleClick(a)}}else this._treeColumn?(b=this.getDataAt(a),b&&(this.isCheckMode()?a.target._checkData||this.__handleClick(a):this._handlePressSelection(b,a))):this.isCheckMode()&&!a.target._checkData&&this.__handleClick(a);if(this._currentEditor&&!this._isCommitting&&(this._isCommitting=!0,this.commitEditValue(this._currentEditor._editInfo,this._currentEditor)),this.updateCurrentEditor){var d=this;setTimeout(function(){d.updateCurrentEditor(a)},0)}}},a.__handleClick=function(a){var b=this.getDataAt(a);if(b){var c=this.getRowIndexByData(b);if(this._focusedRow!==c){var d=this._rowDatas.get(this._focusedRow);this._focusedRow=c,d&&this.invalidateData(d),this.invalidateData(b)}}},a.handleChange=function(a){if(!(this._isCommitting||this._isCanceling||this._isValidating)){var b=a.target._checkData;if(b){var c,d=this.isSelected(b),e=this.getSelectionModel();if("default"===this._checkMode)d?e.removeSelection(b):e.appendSelection(b);else if("children"===this._checkMode)c=new nd(b),c.addAll(b.getChildren());else if("descendant"===this._checkMode)c=new nd,Jb.fillDescendant(b,c);else if("descendantAncestor"===this._checkMode&&(c=new nd,Jb.fillDescendant(b,c),!d))for(var f=b.getParent();f;)c.add(f),f=f.getParent();d?e.removeSelection(c):e.appendSelection(c)}a.target._editInfo&&this.commitEditValue&&(this._isCommitting=!0,this.commitEditValue(a.target._editInfo,a.target))}},a.onLabelRendered=function(a,b,c,d,e,f){},a.onToggleImageRendered=function(a){},a._renderTree=function(a,b,c,d){var e=this._levelMap[b.getId()],f=this.getToggleImage(b),g=this.getLineType(),h=this._indent,i=this.__spanPool.get();i.style.width=f?this._indent*e+"px":this._indent*(e+1)+"px",i.style.display="inline-block",i.style.position="relative",i.style.verticalAlign="top",i.style.margin="0px 1px 0px 1px",i.style.width=(e+1)*h+"px",a.appendChild(i);var j=b,k=j.getParent(),l=0;if("dotted"===g||"solid"===g){if(null==k){var m=this.getIcon(b);this._addLine(i,b,m,!0)}for(;null!==k;){var n=k.getChildren(),o=j===n.get(n.size()-1),m=this.getIcon(j);j.setClient("isLast",o),0==l&&this._addLine(i,b,m,o),l++,j=k,k=k.getParent()}}if(f){var p=this.__imagePool.get();p.setAttribute("src",Jb.getImageSrc(f)),p.style.verticalAlign="middle",p._expandData=b,p.style.position="absolute",p.style.right="0px";var q=this;p.onload=function(){p.style.top=q.getRowHeight()/2-p.height/2+"px"},i.appendChild(p),this.onToggleImageRendered(p)}var r=this.isCheckable(b),s="disabled"===this.getUncheckableStyle();if(r||s){var t=this._addCheckBox(a,b,d);t.disabled=!r}var m=this.getIcon(b);if(m){var u=this.isCheckMode()||this._treeColumn?null:b;this._addIcon(a,b,m,u)}var v=this.getLabel(b);v&&(i=this.__textPool.get(),i.style.whiteSpace="nowrap",i.style.verticalAlign="middle",i.style.padding="1px 2px 1px 2px",Jb.setText(i,v,this._treeColumn?this._treeColumn.isInnerText():this._innerText),this.isCheckMode()||this._treeColumn?this._focusedRow===c&&(i.style.backgroundColor=this.getSelectColor(b)):(i._selectData=b,i.style.backgroundColor=d?this.getSelectColor(b):""),this.onLabelRendered(i,b,v,c,e,d),a.appendChild(i),a.title=this.getToolTip(b))}},Rb.__tree._checkMap={"default":1,children:1,descendant:1,descendantAncestor:1},Ib.Column=function(a){Ib.Column.superClass.constructor.call(this,a)},Jb.ext("twaver.Column",Ib.Data,{IColumn:!0,__property:1,__accessor:["width","horizontalAlign","valueType","propertyType","propertyName","editable","visible","sortable","resizable","movable","sortDirection","sortFunction","enumInfo"],__bool:["innerText"],_innerText:Ed.COLUMN_INNER_TEXT,_width:Ed.COLUMN_WIDTH,_horizontalAlign:Ed.COLUMN_HORIZONTAL_ALIGN,_propertyName:null,_propertyType:Ed.COLUMN_PROPERTY_TYPE,_valueType:Ed.COLUMN_VALUE_TYPE,_editable:Ed.COLUMN_EDITABLE,_sortable:Ed.COLUMN_SORTABLE,_visible:Ed.COLUMN_VISIBLE,_resizable:Ed.COLUMN_RESIZABLE,_movable:Ed.COLUMN_MOVABLE,_sortDirection:"asc",_sortFunction:Ed.SORT_FUNCTION,_enumInfo:null,renderCell:Ed.COLUMN_RENDER_CELL,renderHeader:Ed.COLUMN_RENDER_HEADER,renderEditor:Ed.COLUMN_RENDER_EDITOR,setParent:function(a){throw"parent not supported"},getEnumInfo:function(){return"object"==typeof this._enumInfo?this._enumInfo:"function"==typeof this._enumInfo?1===arguments.length?this._enumInfo(arguments[0]):this._enumInfo():void 0}}),Ib.ColumnBox=function(a){Ib.ColumnBox.superClass.constructor.apply(this,arguments)},Jb.ext("twaver.ColumnBox",Ib.DataBox,{_name:"ColumnBox",add:function(a,b){if(!a.IColumn)throw"Only IColumn can be added into ColumnBox";
Ib.ColumnBox.superClass.add.apply(this,arguments)}}),Ib.Property=function(a){Ib.Property.superClass.constructor.call(this,a)},Jb.ext("twaver.Property",Ib.Data,{IProperty:!0,__property:1,__accessor:["horizontalAlign","valueType","editable","propertyType","propertyName","categoryName","enumInfo"],__bool:["innerText"],_innerText:Ed.PROPERTY_INNER_TEXT,_horizontalAlign:Ed.PROPERTY_HORIZONTAL_ALIGN,_propertyName:null,_propertyType:Ed.PROPERTY_PROPERTY_TYPE,_valueType:Ed.PROPERTY_VALUE_TYPE,_editable:Ed.PROPERTY_EDITABLE,_categoryName:Ed.PROPERTY_CATEGORY_NAME,_enumInfo:null,renderName:Ed.PROPERTY_RENDER_NAME,renderValue:Ed.PROPERTY_RENDER_VALUE,isVisible:null,renderEditor:Ed.PROPERTY_RENDER_EDITOR,setParent:function(a){throw"parent not supported"},setPropertyName:function(a){var b=this._propertyName;this._propertyName=a,this.firePropertyChange("propertyName",b,a)},setPropertyType:function(a){var b=this._propertyType;this._propertyType=a,this.firePropertyChange("propertyType",b,a)},getEnumInfo:function(){return"object"==typeof this._enumInfo?this._enumInfo:"function"==typeof this._enumInfo?1===arguments.length?this._enumInfo(arguments[0]):this._enumInfo():void 0}}),Ib.PropertyBox=function(a){Ib.PropertyBox.superClass.constructor.apply(this,arguments)},Jb.ext("twaver.PropertyBox",Ib.DataBox,{_name:"PropertyBox",add:function(a,b){if(!a.IProperty)throw"Only IProperty can be added into PropertyBox";Ib.PropertyBox.superClass.add.apply(this,arguments)}}),Ib.Tab=function(a){Ib.Tab.superClass.constructor.call(this,a)},Jb.ext("twaver.Tab",Ib.Data,{ITab:!0,__accessor:["view","width","closable","resizable","movable","disabled","visible"],_icon:null,_width:Ed.TAB_WIDTH,_closable:Ed.TAB_CLOSABLE,_resizable:Ed.TAB_RESIZABLE,_movable:Ed.TAB_MOVABLE,_disabled:Ed.TAB_DISABLED,_visible:Ed.TAB_VISIBLE,setParent:function(a){throw"parent not supported"}}),Ib.TabBox=function(a){Ib.TabBox.superClass.constructor.apply(this,arguments),this.getSelectionModel().setSelectionMode("singleSelection")},Jb.ext("twaver.TabBox",Ib.DataBox,{_name:"TabBox",add:function(a,b){if(!a.ITab)throw"Only ITab can be added into TabBox";Ib.TabBox.superClass.add.apply(this,arguments)}}),Ib.controls.ListBase=function(a){Ib.controls.ListBase.superClass.constructor.apply(this,arguments),this._invalidate=!1,this._invalidateModel=!1,this._invalidateDisplay=!1,this._invalidateDatas=null,this._rowDatas=new nd,this._startRowIndex=0,this._endRowIndex=0,this._renderMap={},this._dataRowMap={},this.__divPool=new Ib.Pool("div",20),this.__imagePool=new Ib.Pool("img",20),this.__canvasPool=new Ib.Pool("canvas",20),this.__spanPool=new Ib.Pool("span",20),this.__textPool=new Ib.Pool("span",20),this.__checkBoxPool=new Ib.Pool("input",20),this.__linePool=new Ib.Pool("canvas",20),this._pools.add(this.__divPool),this._pools.add(this.__linePool),this._pools.add(this.__imagePool),this._pools.add(this.__canvasPool),this._pools.add(this.__spanPool),this._pools.add(this.__textPool),this._pools.add(this.__checkBoxPool),this._view=Wb.createView("auto",!0),this._rootDiv=Wb.createDiv(),this._dataDiv=Wb.createDiv(),this._dataDiv.style.width="1px",this._view.appendChild(this._rootDiv),this._rootDiv.appendChild(this._dataDiv),this.setDataBox(a?a:new Ib.DataBox);var b=this;b.handleChange&&b._view.addEventListener("change",function(a){b.handleChange(a)},!1),Qb.isTouchable?Qb.isMSTouchable?new Ib.controls.ListBaseMSTouchInteraction(this):(new Ib.controls.ListBaseTouchInteraction(this),new Ib.controls.ListBaseInteraction(this)):new Ib.controls.ListBaseInteraction(this)},Jb.ext("twaver.controls.ListBase",Ib.controls.View,{__bool:["innerText"],_innerText:Ed.LISTBASE_INNER_TEXT,getDataDiv:function(){return this._dataDiv},getStartRowIndex:function(){return this._startRowIndex},getEndRowIndex:function(){return this._endRowIndex},getRowDatas:function(){return this._rowDatas},getRowIndexByData:function(a){return this._dataRowMap[a.getId()]},getRowIndexById:function(a){return this._dataRowMap[a]},getRowSize:function(){return this._rowDatas.size()},getDataBox:function(){return this._box},setDataBox:function(a){if(!a)throw"DataBox can not be null";if(this._box!==a){var b=this._box;b&&(b.removeDataBoxChangeListener(this.handleDataBoxChange,this),b.removeDataPropertyChangeListener(this.handlePropertyChange,this),b.removeHierarchyChangeListener(this.handleHierarchyChange,this),this._selectionModel||b.getSelectionModel().removeSelectionChangeListener(this.handleSelectionChange,this)),this._box=a,this._box.addDataBoxChangeListener(this.handleDataBoxChange,this),this._box.addDataPropertyChangeListener(this.handlePropertyChange,this),this._box.addHierarchyChangeListener(this.handleHierarchyChange,this),this._selectionModel?this._selectionModel._setDataBox(a):this._box.getSelectionModel().addSelectionChangeListener(this.handleSelectionChange,this),this.invalidateModel(),this.firePropertyChange("dataBox",b,this._box)}},onPropertyChanged:function(a){"zoom"===a.property?this.invalidate():this.invalidateModel()},invalidateModel:function(){this._invalidateModel||(this._invalidateModel=!0,this._invalidateDisplay=!0,this._invalidateDatas=null,this.invalidate())},invalidateDisplay:function(){this._invalidateDisplay||(this._invalidateDisplay=!0,this._invalidateDatas=null,this.invalidate())},invalidateData:function(a){this._invalidateDisplay||(this._invalidateDatas||(this._invalidateDatas={}),this._invalidateDatas[a.getId()]=a,this.invalidate())},validateImpl:function(){var a=this._view.scrollLeft,b=this._view.scrollTop;this._invalidateModel&&(this._invalidateModel=!1,this.validateModel()),this._invalidateDisplay&&(this._invalidateDisplay=!1,this._renderMap={},Wb.release(this._dataDiv),this._dataDiv.style.height=this.getRowSize()*this._rowHeight+"px");var c;if(this._invalidateDatas){for(c in this._invalidateDatas){var d=this._renderMap[c];d&&(Wb.release(d),this._dataDiv.removeChild(d),delete this._renderMap[c])}this._invalidateDatas=null}var e=this._view.scrollTop/this._zoom,f=this._view.clientHeight/this._zoom;this._startRowIndex=Math.floor(e/this._rowHeight)-2,this._endRowIndex=Math.ceil((e+f)/this._rowHeight)+2,this._startRowIndex<0&&(this._startRowIndex=0),this._endRowIndex>this._rowDatas.size()&&(this._endRowIndex=this._rowDatas.size());for(var g=this._rowHeight-this._rowLineWidth-2+"px",h=this._rowLineWidth+"px",i=this._startRowIndex;i<this._endRowIndex;i++){var j=this._rowDatas.get(i);c=j.getId();var k=this._renderMap[c];if(!k){k=this.__divPool.get();var l=k.style;l.position="absolute",l.whiteSpace="nowrap",l.lineHeight=g,l.top=i*this._rowHeight+"px",l.borderStyle="solid",l.borderWidth="0px",l.borderBottomWidth=h,l.borderBottomColor=this._rowLineColor,l.opacity=j.getStyle?j.getStyle("whole.alpha"):1,this._dataDiv.appendChild(k),this._renderMap[c]=k;var m=this.isSelected(j);this.renderData(k,j,i,m),this.onDataRendered(k,j,i,m)}}this._dataDiv.style.width=this.calculateSumWidth()+"px","0px"===this._dataDiv.style.height&&(this._dataDiv.style.height="1px"),Jb.keys(this._renderMap).forEach(function(a){var b=this.getRowIndexById(a);if(b<this._startRowIndex||b>=this._endRowIndex){var c=this._renderMap[a];Wb.release(c),this._dataDiv.removeChild(c),delete this._renderMap[a]}},this),this._pools.forEach(function(a){a.clear()}),this._view.scrollLeft!==a&&(this._view.scrollLeft=a),this._view.scrollTop!==b&&(this._view.scrollTop=b),this.adjustRowSize(),this.onValidated()},adjustRowSize:function(){var a,b,c=this._rowHeight-this._rowLineWidth+"px",d=Math.floor((this._view.scrollLeft+this._view.clientWidth)/this._zoom)+"px";for(a in this._renderMap)b=this._renderMap[a],b.style.height=c,b.style.width=d},onValidated:function(){},onDataRendered:function(a,b,c,d){},calculateSumWidth:function(){return 0},_addCheckBox:function(a,b,c){var d=this.__checkBoxPool.get();return d.keepDefault=!0,d.type="checkbox",d.style.margin="0px 2px",d.style.verticalAlign="middle",d._checkData=b,d.checked=c,d.disabled=!1,a.appendChild(d),d},_addIcon:function(a,b,c,d){var e,f=Jb.getImageAsset(c),g=this.getInnerColor(b),h=this.getOuterColor(b),i=this.getAlarmFillColor(b);if(f&&f.getImage()){var j=f.getWidth(),k=f.getHeight();e=this.__canvasPool.get(),e.style.verticalAlign="middle",e.setAttribute("width",j),e.setAttribute("height",k);var l=e.getContext("2d");l.clearRect(0,0,j,k);var m={x:0,y:0,width:j,height:k};Nc(l,c,g,m,b,this),h&&(l.lineWidth=2,l.strokeStyle=h,l.beginPath(),l.rect(0,0,j,k),l.closePath(),l.stroke()),i&&(l.fillStyle=Xb.createRadialGradient(l,i,"white",1,k-9,8,8,.75,.25),l.beginPath(),l.arc(5,k-5,4,0,2*Math.PI,!0),l.closePath(),l.fill())}else e=this.__imagePool.get(),e.style.verticalAlign="middle",e.setAttribute("src",Jb.getImageSrc(c));e.style.margin="0px 1px 0px 1px",e._selectData=d,a.appendChild(e)},_addLine:function(a,b,c,d){var e,f,g=this.__linePool.get(),h=Jb.getImageAsset(c),i=this.getToggleImage(b),j=this._levelMap[b.getId()],k=this._indent,l=k,m=k,n=0;this.isCheckable(b),"disabled"===this.getUncheckableStyle(),n=2,h&&(l=h.getWidth(),m=h.getHeight()),d?(e=(j+n-1)*k+l,f=this.getRowHeight()):(e=(j+n-1)*k+l,f=this.getRowHeight()),a.style.width=(j+n-1)*k+"px",a.style.height=f+"px";var o=this.getLineType(),p=this.getLineColor(),q=this.getLineAlpha(),r=this.getLineThickness(),s=this.getLineDash();Jb.getImageSrc(i),g.style.verticalAlign="top",g.style.margin="0px 0px 0px 0px",g.style.zIndex=-1,g.setAttribute("width",e),g.setAttribute("height",f);var t=g.getContext("2d");t.lineWidth=r,t.strokeStyle=p,t.globalAlpha=q,"dotted"===o&&t.setLineDash(s);var u=2*(j+n);if(d){var v=b,w=v.getParent();t.clearRect(0,0,e,f),null===w&&0!==b.getChildrenSize()&&this.isExpanded(b)&&(t.moveTo((j+n+1)*e/u,f/2+m/2),t.lineTo((j+n+1)*e/u,f),t.stroke());for(var x=2*j-1;x>=1;x-=2){if(v.getClient("isLast")){if(v=w,w=v.getParent(),(x+1)/2!=j)continue}else v=w,w=v.getParent();x==2*j-1?(t.moveTo((x+n)*e/u,0),t.lineTo((x+n)*e/u,f/2),t.stroke(),t.moveTo((x+n)*e/u,f/2),t.lineTo((x+n+1)*e/u,f/2),t.stroke(),0!==b.getChildrenSize()&&this.isExpanded(b)&&(t.moveTo((x+n+2)*e/u,f/2+m/2),t.lineTo((x+n+2)*e/u,f),t.stroke())):(t.moveTo((x+n)*e/u,0),t.lineTo((x+n)*e/u,f),t.stroke())}}else{var v=b,w=v.getParent();t.clearRect(0,0,e,f);for(var x=2*j-1;x>=1;x-=2){if(v.getClient("isLast")){if(v=w,w=v.getParent(),(x+1)/2!=j)continue}else v=w,w=v.getParent();t.moveTo((x+n)*e/u,0),t.lineTo((x+n)*e/u,f),t.stroke(),x==2*j-1&&(t.moveTo((x+n)*e/u,f/2),t.lineTo((x+n+1)*e/u,f/2),t.stroke(),0!==b.getChildrenSize()&&this.isExpanded(b)&&(t.moveTo((x+n+2)*e/u,f/2+m/2),t.lineTo((x+n+2)*e/u,f),t.stroke()))}}return a.appendChild(g),g},isVisible:function(a){return this._box.contains(a)?this._visibleFunction?this._visibleFunction(a):!0:!1},handleDataBoxChange:function(a){this.invalidateModel()},handlePropertyChange:function(a){"parent"===a.property?this.invalidateModel():this.invalidateData(a.source)},handleHierarchyChange:function(a){this.invalidateModel()},handleSelectionChange:function(a){a.datas.forEach(function(a){this.invalidateData(a)},this),this.onSelectionChanged(a)},getRowIndexAt:function(a){var b=this.getLogicalPoint(a);if(!b)return-1;var c=parseInt(b.y/this._rowHeight);return c>=0&&c<this._rowDatas.size()?c:-1},getDataAt:function(a){var b=this.getRowIndexAt(a);return b>=0?this._rowDatas.get(b):null},getCurrentSortFunction:function(){return this._sortFunction},validateModel:function(){this._rowDatas.clear(),this._dataRowMap={},this._buildChildren(this._box.getRoots()),this._rowDatas=this._rowDatas.toList(this.isVisible,this);var a=this.getCurrentSortFunction();a&&this._rowDatas.sort(a);for(var b=this._rowDatas.size(),c=0;b>c;c++)this._dataRowMap[this._rowDatas.get(c).getId()]=c},_buildChildren:function(a){a.forEach(function(a){this._rowDatas.add(a),this._buildChildren(a.getChildren())},this)},_handlePressSelection:function(a,b){var c=this.getSelectionModel();if(Jb.isCtrlDown(b))c.contains(a)?c.removeSelection(a):c.appendSelection(a);else if(b.shiftKey&&c.getLastData()){var d=c.getLastData(),e=this.getRowIndexByData(d),f=this.getRowIndexByData(a),g=new nd;for(g.add(this.getRowDatas().get(e));e!==f;)e+=f>e?1:-1,g.add(this.getRowDatas().get(e));c.setSelection(g)}else 1===c.size()&&c.contains(a)||c.setSelection(a);this.fireInteractionEvent({kind:2===b.detail?"doubleClick":"click",data:a})},_handleClick:function(a){this.isFocusOnClick()&&Ib.Util.setFocus(this._view);var b=this.getDataAt(a);if(b){if(this.isCheckMode()&&!a.target._checkData){var c=this.getRowIndexByData(b);if(this._focusedRow!==c){var d=this._rowDatas.get(this._focusedRow);this._focusedRow=c,d&&this.invalidateData(d),this.invalidateData(b)}}this.isCheckMode()||this._handlePressSelection(b,a)}if(this._currentEditor&&this.commitEditValue(this._currentEditor._editInfo,this._currentEditor),this.updateCurrentEditor){var e=this;setTimeout(function(){e.updateCurrentEditor(a)},0)}},handleChange:function(a){if(!this._isCanceling&&!this._isValidating){var b=a.target._checkData;if(b){var c=this.isSelected(b),d=this.getSelectionModel();c?d.removeSelection(b):d.appendSelection(b)}a.target._editInfo&&this.commitEditValue&&this.commitEditValue(a.target._editInfo,a.target)}},scrollToData:function(a){if(a){var b=this.getRowIndexById(a.getId());if(!(0>b)){var c=b*this._rowHeight*this._zoom,d=c+this._rowHeight*this._zoom,e=this._view.scrollTop;this._view.scrollTop>c&&(e=c),this._view.scrollTop+this._view.clientHeight<d&&(e=d-this._view.clientHeight),this._view.scrollTop!=e&&(this._view.scrollTop=e,this.invalidate())}}},makeVisible:function(a){this.isVisible(a)&&(this.expand&&this.expand(a),Jb.callLater(this.scrollToData,this,[a],2*Ed.CALL_LATER_DELAY))},onSelectionChanged:function(a){this._makeVisibleOnSelected&&("append"===a.kind||"set"===a.kind||"all"===a.kind)&&(this.expand&&this.getSelectionModel().getSelection().forEach(function(a){a.getParent()&&this.expand(a.getParent())},this),Jb.callLater(this.scrollToData,this,[this.getSelectionModel().getLastData()],2*Ed.CALL_LATER_DELAY))},onShareSelectionModelChanged:function(){this.invalidateModel()}}),Ib.controls.TableBase=function(a){this._columnBox=new Ib.ColumnBox,this._columnBox.addDataBoxChangeListener(this.handleColumnBoxChange,this),this._columnBox.addDataPropertyChangeListener(this.handleColumnPropertyChange,this),this._columnBox.addHierarchyChangeListener(this.handleColumnHierarchyChange,this),Ib.controls.TableBase.superClass.constructor.apply(this,arguments),this._cellPool=new Ib.Pool("div",20),this._stringPool=new Ib.Pool("span",20),this._booleanPool=new Ib.Pool("input",20),this._colorPool=new Ib.Pool("div",20),this._pools.add(this._cellPool),this._pools.add(this._stringPool),this._pools.add(this._booleanPool),this._pools.add(this._colorPool)},Jb.ext("twaver.controls.TableBase",Ib.controls.ListBase,{getColumnBox:function(){return this._columnBox},handleColumnBoxChange:function(a){this.invalidateDisplay()},handleColumnPropertyChange:function(a){a.source!==this._sortColumn||"sortDirection"!==a.property&&"sortFunction"!==a.property&&"sortable"!==a.property?this.invalidateDisplay():this.invalidateModel()},handleColumnHierarchyChange:function(a){this.invalidateDisplay()},renderData:function(a,b,c,d){for(var e,f=this._columnBox.getRoots(),g=f.size(),h=0,i=this._rowHeight-this._rowLineWidth+"px",j=0;g>j;j++){var k=f.get(j),l=k.getWidth();0>l&&(l=0);var m=Math.min(this._columnLineWidth,l);if(k.isVisible()){var n=this._cellPool.get();e=n.style,e.position="absolute",e.whiteSpace="nowrap",e.verticalAlign="middle",e.textAlign=k.getHorizontalAlign(),e.overflow="hidden",e.textOverflow="ellipsis",e.left=h+"px",e.width=l-m+"px",e.height=i,e.borderStyle="solid",e.borderWidth="0px",e.borderRightWidth=m+"px",e.borderRightColor=this._columnLineColor,0===j?(e.borderLeftWidth=m+"px",e.borderLeftColor=this._columnLineColor):e.borderLeftWidth="0px",a.appendChild(n);var o={data:b,value:this.getValue(b,k),div:n,view:this,column:k,rowIndex:c,selected:d};this.renderCell(o),this.onCellRendered(o),h+=l}}e=a.style,e.width=h+"px",e.height=i,e.backgroundColor=this.isCheckMode()&&this._focusedRow===c||!this.isCheckMode()&&d?this.getSelectColor(b):""},adjustRowSize:function(){},onCellRendered:function(a){},calculateSumWidth:function(){for(var a=this._columnBox.getRoots(),b=a.size(),c=0,d=0;b>d;d++){var e=a.get(d),f=e.getWidth();0>f&&(f=0),c+=f}return c},getCurrentSortFunction:function(){var a=this._sortColumn;if(a){var b=a.getSortFunction();if(b){var c=this,d="asc"===a.getSortDirection()?1:-1;return function(e,f){var g=c.getValue(e,a),h=c.getValue(f,a);return b.call(c,g,h,e,f)*d}}}return this._sortFunction},renderCell:function(a){var b=a.column;if(b.renderCell)return void b.renderCell(a);var c=a.value,d=b.getEnumInfo(a.rowIndex);d&&!Array.isArray(d)&&(c=d.map[c]),a.view.isCellEditable(a.data,b)&&(a.enumInfo=d,a.div._editInfo=a),Ac.render(b.getValueType(),c,a.div,a.view,b.isInnerText())},getValue:function(a,b){return b.getValue(a,this)},setValue:function(a,b,c){b.setValue(a,c,this)},getColumnAt:function(a){var b=this.getLogicalPoint(a);if(!b)return null;for(var c=this._columnBox.getRoots(),d=0,e=c.size(),f=0;e>d;d++){var g=c.get(d),h=g.getWidth();if(0>h&&(h=0),b.x>f&&b.x<f+h)return g;f+=h}return null},isCellEditable:function(a,b){return this.isEditable()&&b.isEditable()},commitEditValue:function(a,b){if(!this._isCanceling){var c;c="checkbox"===b.type?b.checked:b.value;var d=a.column,e=d.getValueType();if("int"===e&&"string"==typeof c)c=parseInt(c);else if("number"===e&&"string"==typeof c)c=parseFloat(c);else if("list.points"===e){for(var f=c.replace(/\]/g,"").replace(/\[/g,"").split(","),g=new Ib.List,h=0;h<f.length;h+=2)h+1>=f.length||g.add({x:parseInt(f[h]),y:parseInt(f[h+1])});c=g}if(this.setValue(a.data,d,c),this._currentEditor){var i=this._currentEditor.parentNode,j=this._currentEditor;delete this._currentEditor,i&&i.removeChild(j),Ib.Util.setFocus(this._view)}delete this._isCommitting}},cancelEditing:function(){if(this._currentEditor){this._isCanceling=!0;var a=this._currentEditor.parentNode,b=this._currentEditor;delete this._currentEditor,a&&a.removeChild(b),Ib.Util.setFocus(this._view),delete this._isCanceling}},renderEditor:function(a){},onEditorRendered:function(a){},getEditorValue:function(a){var b=a.column.getValueType(),c=a.value,d="";if("list.points"===b){var e=c._as?c._as:c;e.forEach(function(a,b){d+=b==e.length-1?"["+a.x+","+a.y+"]":"["+a.x+","+a.y+"],"})}else d=c;return d},updateCurrentEditor:function(a){var b=a.target;if(b!==this._currentEditor&&b.parentNode!==this._currentEditor){for(var c;b&&b!==this._view&&!(c=b._editInfo);)b=b.parentNode;if(c&&b===c.div){var d=this.renderEditor&&this.renderEditor(c);d?(this._currentEditor=d.view,null!=c.value&&(this._currentEditor.value=this.getEditorValue(c))):c.enumInfo?this._currentEditor=Wb.createSelect(c.enumInfo,c.value):(this._currentEditor=Ob.createElement("input"),null!=c.value&&(this._currentEditor.value=this.getEditorValue(c)));var e=this;if(c.column&&c.column.renderEditor){var d="function"==typeof c.column.renderEditor?c.column.renderEditor(e,c):c.column.renderEditor;d&&(e._currentEditor=d)}if(this._currentEditor){if(d&&d.onKeyDown){var f=d.onKeyDown;f&&Array.isArray(f)&&e._currentEditor.addEventListener("keydown",function(a){for(var b=0;b<f.length;b++)if(f[b].combKey){var c=null;switch(f[b].combKey){case"ctrlKey":c=a.ctrlKey;break;case"shiftKey":c=a.shiftKey;break;case"altKey":c=a.altKey}a.keyCode===f[b].keyCode&&c&&f[b].handlerEvent&&f[b].handlerEvent(a)}else a.keyCode===f[b].keyCode&&f[b].handlerEvent&&f[b].handlerEvent(a)})}else this._currentEditor.addEventListener("keydown",function(a){var b=a.target._editInfo.view;13===a.keyCode&&a.shiftKey||(13===a.keyCode?b.commitEditValue(a.target._editInfo,a.target):27===a.keyCode&&b.cancelEditing())},!1);if(this._currentEditor.addEventListener("blur",function(a){var b=a.target._editInfo.view;b._isCanceling||b.commitEditValue(a.target._editInfo,a.target)},!1),this._currentEditor.keepDefault=!0,this._currentEditor._editInfo=c,!this._currentEditor.parentNode){var g=this._currentEditor.style;g.position="absolute",g.margin="0px",g.border="0px",g.padding="0px",g.left=c.div.style.left,g.top=c.div.parentNode.style.top,g.width=c.div.style.width,g.height=c.div.style.height,this._rootDiv.appendChild(this._currentEditor)}Ib.Util.setFocus(this._currentEditor)}}}},onColumnSorted:function(a){},getCurrentEditor:function(){return this._currentEditor}}),Ib.controls.List=function(a){Ib.controls.List.superClass.constructor.apply(this,arguments)},Jb.ext("twaver.controls.List",Ib.controls.ListBase,{__accessor:["rowHeight","indent","rowLineWidth","rowLineColor","sortFunction","visibleFunction"],__bool:["makeVisibleOnSelected","keyboardRemoveEnabled","keyboardSelectEnabled"],_checkMode:!1,_rowHeight:Ed.LIST_ROW_HEIGHT,_indent:Ed.LIST_INDENT,_rowLineWidth:Ed.LIST_ROW_LINE_WIDTH,_rowLineColor:Ed.LIST_ROW_LINE_COLOR,_makeVisibleOnSelected:Ed.LIST_MAKE_VISIBLE_ON_SELECTED,_keyboardRemoveEnabled:Ed.LIST_KEYBOARD_REMOVE_ENABLED,_keyboardSelectEnabled:Ed.LIST_KEYBOARD_SELECT_ENABLED,isCheckMode:function(){return this._checkMode},setCheckMode:function(a){delete this._focusedRow;var b=this._checkMode;this._checkMode=a,this.firePropertyChange("checkMode",b,a)},isCheckable:function(a){return this._checkMode===!0},renderData:function(a,b,c,d){var e;this._indent>0&&(e=this.__spanPool.get(),e.style.width=this._indent+"px",e.style.display="inline-block",a.appendChild(e));var f=this.isCheckable(b);f&&this._addCheckBox(a,b,d);var g=this.getIcon(b);g&&this._addIcon(a,b,g);var h=this.getLabel(b);if(h){e=this.__textPool.get();var i=e.style;i.whiteSpace="nowrap",i.verticalAlign="middle",i.padding="1px 2px 1px 2px",i.display="inline-block",Jb.setText(e,h,this._innerText),this.onLabelRendered(e,b,h,c,d),a.appendChild(e)}a.style.backgroundColor=this.isCheckMode()?this._focusedRow===c?this.getSelectColor(b):"":d?this.getSelectColor(b):""},onLabelRendered:function(a,b,c,d,e){}}),Ib.controls.ListBaseInteraction=function(a){this.listBase=a,this.view=a._view;var b=this;this.view.addEventListener("scroll",function(a){b.handleScroll(a)},!1),this.view.addEventListener("mousedown",function(a){b.handleMouseDown(a)},!1),this.view.addEventListener("keydown",function(a){b.handleKeyDown(a)},!1)},Jb.ext("twaver.controls.ListBaseInteraction",Object,{handleMouseDown:function(a){var b=this.listBase;a.target!==b._currentEditor&&a.target.parentNode!==b._currentEditor&&b._handleClick(a)},handleKeyDown:function(a){var b=this.listBase;if(!b._currentEditor)if(Jb.isCtrlDown(a)&&65==a.keyCode)b.isKeyboardSelectEnabled()&&b.selectAll().size()>0&&b.fireInteractionEvent({kind:"selectAll"}),Wb.preventDefault(a);else if(46==a.keyCode)b.isKeyboardRemoveEnabled()&&b.removeSelection()&&b.fireInteractionEvent({kind:"removeElement"}),Wb.preventDefault(a);else if(b.isCheckMode()||38!==a.keyCode&&40!==a.keyCode&&37!==a.keyCode&&39!==a.keyCode)Jb.showVersion(a);else{var c=b.getSelectionModel().getLastData();if(c)if(38===a.keyCode||40===a.keyCode){var d=b.getRowDatas(),e=b.getRowIndexByData(c);e>=0&&(38===a.keyCode?0!==e&&(c=d.get(e-1),b.getSelectionModel().setSelection(c)):e!==d.size()-1&&(c=d.get(e+1),b.getSelectionModel().setSelection(c)))}else!b.expand||37!==a.keyCode&&39!==a.keyCode||c.hasChildren()&&(37===a.keyCode?b.collapse(c):b.expand(c));else b.getRowDatas().size()>0&&(c=b.getRowDatas().get(0),b.getSelectionModel().setSelection(c))}},handleScroll:function(a){this.listBase.invalidate()}}),Ib.controls.ListBaseTouchInteraction=function(a){this.listBase=a,this.view=a._view,Wb.addEventListener("touchstart","handleTouchstart",this.view,this)},Jb.ext("twaver.controls.ListBaseTouchInteraction",Object,{handleTouchstart:function(a){Wb.preventDefault(a),this.startPoint=this.lastPoint=this.listBase.getLogicalPoint(a),Wb.addEventListener("touchmove","handleTouchmove",this.view,this),Wb.addEventListener("touchend","handleTouchend",this.view,this),zc.isMultiTouch(a)&&(this.distance=zc.getDistance(a),this.zoom=this.listBase._zoom)},handleTouchmove:function(a){Wb.preventDefault(a);var b=this.listBase.getLogicalPoint(a);if(!(Tb.getDistance(this.startPoint,b)<20))if(this.moved||(this.moved=!0),zc.isSingleTouch(a)){if(this.lastPoint){var c=this.lastPoint.x-b.x,d=this.lastPoint.y-b.y,e=this.listBase.panByOffset(c,d);this.listBase.invalidate(),this.lastPoint.x-=c-e.x,this.lastPoint.y-=d-e.y}}else if(this.distance){var f=zc.getDistance(a)/this.distance;this.listBase.setZoom(this.zoom*f,!1)}},handleTouchend:function(a){Wb.preventDefault(a),this.moved||a.target===this.listBase._currentEditor||a.target.parentNode===this.listBase._currentEditor||this.listBase._handleClick(a),delete this.startPoint,delete this.lastPoint,delete this.moved,delete this.distance,delete this.zoom,Wb.removeEventListener("touchmove",this.view,this),Wb.removeEventListener("touchend",this.view,this)}}),Ib.controls.ListBaseMSTouchInteraction=function(a){Ib.controls.ListBaseMSTouchInteraction.superClass.constructor.apply(this,arguments),this._pointerMap={},this._pointerIdArray=[],Wb.addEventListener("MSPointerDown","handleTouchstart",this.view,this),Wb.addEventListener("MSPointerMove","handleTouchmove",this.view,this),Wb.addEventListener("MSPointerUp","handleTouchend",this.view,this),Wb.addEventListener("MSPointerCancel","handleTouchend",this.view,this),this.superHandleMouseDown=Ib.controls.ListBaseMSTouchInteraction.superClass.handleMouseDown},Jb.ext("twaver.controls.ListBaseMSTouchInteraction",Ib.controls.ListBaseInteraction,{handleMouseDown:function(a){},handleTouchstart:function(a){a.isPrimary&&this._pointerIdArray.length>0&&(this._pointerMap={},this._pointerIdArray=[]),this._pointerMap[a.pointerId]||null==this.listBase.getLogicalPoint(a)||(this._pointerIdArray.push(a.pointerId),this._pointerMap[a.pointerId]=a),1==this._pointerIdArray.length&&a.pointerType==a.MSPOINTER_TYPE_MOUSE&&this.superHandleMouseDown(a),1==this._pointerIdArray.length?(this._startTouchPoint=this.listBase.getLogicalPoint(a),this._startTouchTime=new Date):2==this._pointerIdArray.length&&(this._distance=this._getDistance(),this._zoom=this.listBase.getZoom())},handleTouchmove:function(a){if(null!=this._startTouchPoint&&0!=this._pointerIdArray.length&&this._pointerMap[a.pointerId]&&!(Tb.getDistance({x:this._pointerMap[a.pointerId].pageX,y:this._pointerMap[a.pointerId].pageY},{x:a.pageX,y:a.pageY})<=10))if(this._pointerMap[a.pointerId]=a,2==this._pointerIdArray.length){var b=this._getDistance()/this._distance;this.listBase.setZoom(this._zoom*b,!1)}else if(1==this._pointerIdArray.length&&a.pointerType!=a.MSPOINTER_TYPE_MOUSE&&this._startTouchPoint){var c=this.listBase.getLogicalPoint(a);if(null==c)return;var d=this._startTouchPoint.x-c.x,e=this._startTouchPoint.y-c.y,f=this.listBase.panByOffset(d,e);this.listBase.invalidate(),this._startTouchPoint.x-=d-f.x,this._startTouchPoint.y-=e-f.y}},handleTouchend:function(a){if(this._startTouchPoint&&1==this._pointerIdArray.length&&a.pointerType!=a.MSPOINTER_TYPE_MOUSE){var b=this.listBase.getLogicalPoint(a);if(b){var c=new Date;c.getTime()-this._startTouchTime.getTime()<=500&&Tb.getDistance(this._startTouchPoint,b)<=20&&this.superHandleMouseDown(a)}}this._pointerMap={},this._pointerIdArray=[]},_getDistance:function(){return Tb.getDistance({x:this._pointerMap[this._pointerIdArray[0]].pageX,y:this._pointerMap[this._pointerIdArray[0]].pageY},{x:this._pointerMap[this._pointerIdArray[1]].pageX,y:this._pointerMap[this._pointerIdArray[1]].pageY})}}),Ib.controls.Tree=function(a){this._interactionDispatcher=new Ib.EventDispatcher,this._initTree(a),Ib.controls.Tree.superClass.constructor.apply(this,arguments)},Jb.ext("twaver.controls.Tree",Ib.controls.ListBase,{__tree:1,__accessor:["rootData","sortFunction","visibleFunction","indent","rowHeight","rowLineWidth","rowLineColor","expandIcon","collapseIcon","uncheckableStyle","lineType","lineColor","lineThickness","lineAlpha","lineDash"],__bool:["rootVisible","makeVisibleOnSelected","keyboardRemoveEnabled","keyboardSelectEnabled"],_checkMode:!1,_indent:Ed.TREE_INDENT,_rowHeight:Ed.TREE_ROW_HEIGHT,_rowLineWidth:Ed.TREE_ROW_LINE_WIDTH,_rowLineColor:Ed.TREE_ROW_LINE_COLOR,_makeVisibleOnSelected:Ed.TREE_MAKE_VISIBLE_ON_SELECTED,_keyboardRemoveEnabled:Ed.TREE_KEYBOARD_REMOVE_ENABLED,_keyboardSelectEnabled:Ed.TREE_KEYBOARD_SELECT_ENABLED,_expandIcon:Ed.TREE_EXPAND_ICON,_collapseIcon:Ed.TREE_COLLAPSE_ICON,_uncheckableStyle:"none",_lineType:Ed.TREE_LINE_TYPE,_lineColor:Ed.TREE_LINE_COLOR,_lineThickness:Ed.TREE_LINE_THICKNESS,_lineAlpha:Ed.TREE_LINE_ALPHA,_lineDash:Ed.TREE_LINE_DASH,getCheckMode:function(){return this._checkMode},setCheckMode:function(a){delete this._focusedRow;var b=this._checkMode;this._checkMode=a,this.firePropertyChange("checkMode",b,a)},renderData:function(a,b,c,d){this._renderTree(a,b,c,d)},getToolTip:function(a){return a.getToolTip()||a.getName()}}),Ib.controls.Table=function(a){this._checkColumn=new Ib.Column,this._checkColumn.setName("check"),this._checkColumn.setEditable(!0),this._checkColumn.setWidth(40),this._checkColumn.setHorizontalAlign("center"),this._checkColumn.renderCell=this.renderCheckCell;var b=this;this._checkColumn.getValue=function(a,c){return b.isSelected(a)},Ib.controls.Table.superClass.constructor.apply(this,arguments)},Jb.ext("twaver.controls.Table",Ib.controls.TableBase,{__accessor:["rowHeight","rowLineWidth","rowLineColor","columnLineWidth","columnLineColor","sortFunction","visibleFunction","sortColumn"],__bool:["editable","makeVisibleOnSelected","keyboardRemoveEnabled","keyboardSelectEnabled"],_editable:Ed.TABLE_EDITABLE,_rowHeight:Ed.TABLE_ROW_HEIGHT,_rowLineWidth:Ed.TABLE_ROW_LINE_WIDTH,_rowLineColor:Ed.TABLE_ROW_LINE_COLOR,_columnLineWidth:Ed.TABLE_COLUMN_LINE_WIDTH,_columnLineColor:Ed.TABLE_COLUMN_LINE_COLOR,_makeVisibleOnSelected:Ed.TABLE_MAKE_VISIBLE_ON_SELECTED,_keyboardRemoveEnabled:Ed.TABLE_KEYBOARD_REMOVE_ENABLED,_keyboardSelectEnabled:Ed.TABLE_KEYBOARD_SELECT_ENABLED,getCheckColumn:function(){return this._checkColumn},isCheckMode:function(){return this._columnBox.contains(this._checkColumn)},setCheckMode:function(a){a!==this.isCheckMode()&&(delete this._focusedRow,a?this._columnBox.add(this._checkColumn,0):this._columnBox.remove(this._checkColumn),this.firePropertyChange("checkMode",!a,a))},renderCheckCell:function(a){var b=a.view._booleanPool.get();b.disabled=!1,b.type="checkbox",b.style.margin="0px 2px",b.style.verticalAlign="middle",b.checked=a.selected;var c=a.div;c.appendChild(b),""===c.style.textAlign&&(c.style.textAlign="center"),b._checkData=a.data}}),Ib.controls.TableHeader=function(a){Ib.controls.TableHeader.superClass.constructor.apply(this,arguments),this._invalidateScroll=!1,this._invalidateDisplay=!1,this._divPool=new Ib.Pool("div"),this._imagePool=new Ib.Pool("img"),this._textPool=new Ib.Pool("span"),this._resizePool=new Ib.Pool("div"),this._pools.add(this._divPool),this._pools.add(this._imagePool),this._pools.add(this._textPool),this._pools.add(this._resizePool),this._table=a,this._tableView=a.getView(),this._columnBox=a.getColumnBox(),this._columnBox.addDataBoxChangeListener(this.handleColumnBoxChange,this),this._columnBox.addDataPropertyChangeListener(this.handleColumnPropertyChange,this),this._columnBox.addHierarchyChangeListener(this.handleColumnHierarchyChange,this);var b=this;a.getView().addEventListener("scroll",function(a){b.invalidateScroll()},!1),a.addPropertyChangeListener(function(a){b.invalidateDisplay()},this),this._view=Wb.createView("hidden"),this._view.tabIndex=-1,this._view.style.background=Ed.TABLEHEADER_BACKGROUND,this._rootDiv=Wb.createDiv(),this._view.appendChild(this._rootDiv),this.invalidateDisplay(),Qb.isTouchable&&new Ib.controls.TableHeaderTouchInteraction(this),new Ib.controls.TableHeaderInteraction(this)},Jb.ext("twaver.controls.TableHeader",Ib.controls.ControlBase,{__accessor:["height","moveBackground","insertBackground","columnLineColor","resizeTolerance","sortDescIcon","sortAscIcon","sortIconPosition"],_height:Ed.TABLEHEADER_HEIGHT,_moveBackground:Ed.TABLEHEADER_MOVE_BACKGROUND,_insertBackground:Ed.TABLEHEADER_INSERT_BACKGROUND,_columnLineColor:Ed.TABLEHEADER_COLUMN_LINE_COLOR,_resizeTolerance:Ed.TABLEHEADER_RESIZE_TOLERANCE,
_sortDescIcon:Ed.TABLEHEADER_SORT_DESC_ICON,_sortAscIcon:Ed.TABLEHEADER_SORT_ASC_ICON,_sortIconPosition:Ed.TABLEHEADER_SORT_ICON_POSITION,getRootDiv:function(){return this._rootDiv},handleColumnBoxChange:function(a){this.invalidateDisplay()},handleColumnPropertyChange:function(a){this.invalidateDisplay()},handleColumnHierarchyChange:function(a){this.invalidateDisplay()},onPropertyChanged:function(a){this.invalidateDisplay()},invalidateScroll:function(){this._invalidateScroll||(this._invalidateScroll=!0,this.invalidate())},invalidateDisplay:function(){this._invalidateDisplay||(this._invalidateDisplay=!0,this._invalidateScroll=!0,this.invalidate())},validate:function(){this._invalidate&&(this._invalidate=!1,this._invalidateDisplay&&(this._invalidateDisplay=!1,this.validateDisplay()),this._invalidateScroll&&(this._invalidateScroll=!1,this._rootDiv.style.left=-this._tableView.scrollLeft+"px"))},validateDisplay:function(){Wb.release(this._rootDiv);for(var a=this._table.getZoom(),b=this.getHeight()+"px",c=this.getHeight()-2+"px",d=this._table.getColumnBox().getRoots(),e=d.size(),f=0,g=this._table._columnLineWidth*a,h=0;e>h;h++){var i=d.get(h);if(i.isVisible()){var j=i.getWidth()*a;0>j&&(j=0);var k=Math.min(g,j),l=this._divPool.get();l._column=i;var m=l.style;m.position="absolute",m.whiteSpace="nowrap",m.lineHeight=c,m.overflow="hidden",m.textOverflow="ellipsis",m.backgroundPosition=this._sortIconPosition?this._sortIconPosition:"",m.backgroundRepeat="no-repeat",m.backgroundImage="",m.textAlign=i.getHorizontalAlign(),m.borderStyle="solid",m.borderWidth="0px",m.borderRightWidth=k+"px",m.borderRightColor=this._columnLineColor,0===h?(m.borderLeftWidth=k+"px",m.borderLeftColor=this._columnLineColor):m.borderLeftWidth="0px",m.left=f+"px",m.width=j-k+"px",m.height=b,l._x=f,l._width=j-k,this._rootDiv.insertBefore(l,this._rootDiv.firstChild),this.renderColumn(l,i),this.onColumnRendered(l,i),f+=j,i.isResizable()&&(l=this._resizePool.get(),l._resizeColumn=i,m=l.style,m.position="absolute",m.backgroundColor="white",m.opacity=0,m.left=f-k-this._resizeTolerance+"px",m.width=k+2*this._resizeTolerance+"px",m.height=b,this._rootDiv.appendChild(l))}}this._pools.forEach(function(a){a.clear()}),this._rootDiv.style.width=f+"px",this._rootDiv.style.height=b},renderColumn:function(a,b){if(b.renderHeader)b.renderHeader(a);else{var c=this._textPool.get();if(c.style.whiteSpace="nowrap",c.style.verticalAlign="middle",c.style.padding="1px 2px 1px 2px",c.innerHTML=b.getName()?b.getName():b.getPropertyName(),c.setAttribute("title",c.innerHTML),a.appendChild(c),Qb.isOpera){var d=a.cloneNode(!1);d.style.left="0px",d.style.top="0px",d.style.opacity=0,a.appendChild(d)}}if(this._table.getSortColumn()===b&&b.isSortable()){var e="asc"===b.getSortDirection()?this._sortAscIcon:this._sortDescIcon,f=Jb.getImageSrc(e);if(this._sortIconPosition&&""!==this._sortIconPosition)a.style.backgroundImage="url("+f+")";else{var g=this._imagePool.get();g.setAttribute("src",f),g.style.verticalAlign="middle",a.appendChild(g)}}},onColumnRendered:function(a,b){}}),Ib.controls.TableHeaderInteraction=function(a){this.header=a,this.table=a._table,this.view=a._view;var b=this;this.view.addEventListener("mousedown",function(a){b.handleMouseDown(a)},!1),this.view.addEventListener("mousemove",function(a){b.handleMouseMove(a)},!1)},Jb.ext("twaver.controls.TableHeaderInteraction",Object,{handleMouseDown:function(a){if(0===a.button){if(this.movableDiv)return void this.handleMouseUp(a);this.resizeColumn=a.target._resizeColumn,this.resizeColumn||(this.movableDiv=this.getMovableDivAt(a)),this.changeCursor(a),this._startClient=Wb.getClientPoint(a),this.lastX=this.getX(a),this._startLogicalX=this.lastX,Wb.handle_mousedown(this,a)}},changeCursor:function(a){var b="";if(a.target._resizeColumn)b="ew-resize";else{var c=this.getColumnAt(a);c&&(c.isMovable()||c.isSortable())&&(b="pointer")}this.view.style.cursor=b},handleMouseMove:function(a){if(null==this.lastX)return void this.changeCursor(a);if(Wb.target===this){var b=this._startLogicalX+a.clientX-this._startClient.x;if(this.resizeColumn){if(null!=this.stopX){if(b<this.stopX)return;delete this.stopX}var c=this.resizeColumn.getWidth()+(b-this.lastX)/this.table.getZoom();10>c&&(c=10,this.stopX=b),this.resizeColumn.setWidth(c),this.lastX=b}else if(this.movableDiv){var d=b-this.lastX;if(!this.cloneDiv){if(Math.abs(d)<3)return;this.cloneDiv=this.movableDiv.cloneNode(!0),this.cloneDiv._x=this.movableDiv._x,this.cloneDiv.style.background=this.header.getMoveBackground(),this.insertDiv=Wb.createDiv(),this.insertDiv.style.width="1px",this.insertDiv.style.height=this.cloneDiv.style.height,this.insertDiv.style.background=this.header.getInsertBackground(),this.movableDiv.parentNode.appendChild(this.cloneDiv),this.movableDiv.parentNode.appendChild(this.insertDiv)}var e=this.cloneDiv._x+d;this.cloneDiv.style.left=e+"px",this.cloneDiv._x=e,this.lastX=b,this.columnInfo=this.getColumnInfoAt(a),this.columnInfo&&(this.insertDiv.style.left=this.columnInfo.position)}}},handleMouseUp:function(a){if(0===a.button){var b;if(this.resizeColumn);else if(this.movableDiv&&this.columnInfo){b=this.movableDiv._column;var c=this.columnInfo.index;this.table.getColumnBox().moveTo(b,c)}else if(b=this.getColumnAt(a),b&&b.isSortable()){var d=b.getSortDirection();this.table.getSortColumn()===b?("desc"===d&&this.table.setSortColumn(null),b.setSortDirection("asc"===d?"desc":"asc")):this.table.setSortColumn(b),this.table.onColumnSorted(this.table.getSortColumn())}this.clear()}},clear:function(){this.view.style.cursor="",this.cloneDiv&&this.movableDiv&&this.movableDiv.parentNode.removeChild(this.cloneDiv),this.insertDiv&&this.movableDiv&&this.movableDiv.parentNode.removeChild(this.insertDiv),delete this.movableDiv,delete this.columnInfo,delete this.insertDiv,delete this.cloneDiv,delete this.resizeColumn,delete this.stopX,delete this.lastX,delete this._startClient,delete this._startLogicalX},getColumnAt:function(a){a=a.target;for(var b;a&&a!==this.view&&!(b=a._column);)a=a.parentNode;return b},getMovableDivAt:function(a){a=a.target;for(var b;a&&a!==this.view&&!(b=a._column);)a=a.parentNode;return b&&b.isMovable()?a:null},getX:function(a){var b=Wb.getLogicalPoint(this.view,a);return b?b.x:null},getColumnInfoAt:function(a){for(var b=this._startLogicalX+a.clientX-this._startClient.x+this.table.getView().scrollLeft,c=this.table.getColumnBox().getRoots(),d=c.size(),e=this.table.getZoom(),f=0,g=!1,h=0;d>h;h++){var i=c.get(h);if(i===this.movableDiv._column&&(g=!0),i.isVisible()){var j=i.getWidth()*e;if(0>=j)continue;if(b>=f&&f+j>=b){var k=f+j/2>b;!g||i===this.movableDiv._column&&k||h--;var l=k?Math.max(0,h):Math.min(h+1,d),m=k?f:f+j;return m=Math.max(0,m-1),{index:l,column:i,position:m+"px"}}f+=j}}return this.columnInfo}}),Ib.controls.TableHeaderTouchInteraction=function(a){this.header=a,this.table=a._table,this.view=a._view,Wb.addEventListener("touchstart","handleTouchstart",this.view,this)},Jb.ext("twaver.controls.TableHeaderTouchInteraction",Object,{handleTouchstart:function(a){return Wb.preventDefault(a),this.movableDiv?void this.handleTouchend(a):(this.resizeColumn=a.target._resizeColumn,this.resizeColumn||(this.movableDiv=this.getMovableDivAt(a)),this.lastX=this.getX(a),Wb.addEventListener("touchmove","handleTouchmove",this.view,this),void Wb.addEventListener("touchend","handleTouchend",this.view,this))},handleTouchmove:function(a){if(Wb.preventDefault(a),null!=this.lastX){var b;if(this.resizeColumn){if(b=this.getX(a),null!=this.stopX){if(b<this.stopX)return;delete this.stopX}var c=this.resizeColumn.getWidth()+(b-this.lastX)/this.table.getZoom();0>c&&(c=0,this.stopX=b),this.resizeColumn.setWidth(c),this.lastX=b}else if(this.movableDiv){b=this.getX(a);var d=b-this.lastX;if(!this.cloneDiv){if(Math.abs(d)<3)return;this.cloneDiv=this.movableDiv.cloneNode(!0),this.cloneDiv._x=this.movableDiv._x,this.cloneDiv.style.background=this.header.getMoveBackground(),this.insertDiv=Wb.createDiv(),this.insertDiv.style.width="1px",this.insertDiv.style.height=this.cloneDiv.style.height,this.insertDiv.style.background=this.header.getInsertBackground(),this.movableDiv.parentNode.appendChild(this.cloneDiv),this.movableDiv.parentNode.appendChild(this.insertDiv)}var e=this.cloneDiv._x+d;this.cloneDiv.style.left=e+"px",this.cloneDiv._x=e,this.lastX=b,this.columnInfo=this.getColumnInfoAt(a),this.columnInfo&&(this.insertDiv.style.left=this.columnInfo.position)}}},handleTouchend:function(a){Wb.preventDefault(a);var b;if(this.resizeColumn);else if(this.movableDiv&&this.columnInfo){b=this.movableDiv._column;var c=this.columnInfo.index;this.table.getColumnBox().moveTo(b,c)}else if(b=this.getColumnAt(a),b&&b.isSortable()){var d=b.getSortDirection();this.table.getSortColumn()===b?("desc"===d&&this.table.setSortColumn(null),b.setSortDirection("asc"===d?"desc":"asc")):this.table.setSortColumn(b)}this.clear(),Wb.removeEventListener("touchmove",this.view,this),Wb.removeEventListener("touchend",this.view,this)},clear:function(){this.cloneDiv&&this.movableDiv&&this.movableDiv.parentNode.removeChild(this.cloneDiv),this.insertDiv&&this.movableDiv&&this.movableDiv.parentNode.removeChild(this.insertDiv),delete this.movableDiv,delete this.columnInfo,delete this.insertDiv,delete this.cloneDiv,delete this.resizeColumn,delete this.stopX,delete this.lastX},getColumnAt:function(a){a=a.target;for(var b;a&&a!==this.view&&!(b=a._column);)a=a.parentNode;return b},getMovableDivAt:function(a){a=a.target;for(var b;a&&a!==this.view&&!(b=a._column);)a=a.parentNode;return b&&b.isMovable()?a:null},getX:function(a){var b=Wb.getLogicalPoint(this.view,a);return b?b.x:null},getColumnInfoAt:function(a){for(var b=this.getX(a)+this.table.getView().scrollLeft,c=this.table.getColumnBox().getRoots(),d=c.size(),e=this.table.getZoom(),f=0,g=!1,h=0;d>h;h++){var i=c.get(h);if(i===this.movableDiv._column&&(g=!0),i.isVisible()){var j=i.getWidth()*e;if(0>=j)continue;if(b>=f&&f+j>=b){var k=f+j/2>b;!g||i===this.movableDiv._column&&k||h--;var l=k?Math.max(0,h):Math.min(h+1,d),m=k?f:f+j;return m=Math.max(0,m-1),{index:l,column:i,position:m+"px"}}f+=j}}return this.columnInfo}}),Ib.controls.TablePane=function(a,b){Ib.controls.TablePane.superClass.constructor.apply(this,arguments),this.invalidate(),this._table=a,this._tableHeader=b?b:new Ib.controls.TableHeader(a),this._view=Wb.createView("hidden",!0),this._view.tabIndex=-1,this._view.appendChild(this._tableHeader.getView()),this._view.appendChild(this._table.getView());var c=this;this._tableHeader.addPropertyChangeListener(function(a){"height"===a.property&&c.invalidate()})},Jb.ext("twaver.controls.TablePane",Ib.controls.ControlBase,{onPropertyChanged:function(a){this.invalidate()},getTable:function(){return this._table},getTableHeader:function(){return this._tableHeader},validateImpl:function(){var a=this._view.offsetWidth,b=this._view.offsetHeight,c=this._tableHeader.getHeight();this._tableHeader.adjustBounds({x:0,y:0,width:a,height:c}),this._table.adjustBounds({x:0,y:c,width:a,height:Math.max(0,b-c)})}}),Ib.controls.TreeTable=function(a){this._treeColumn=new Ib.Column,this._treeColumn.setName("tree"),this._treeColumn.setWidth(120),this._treeColumn.renderCell=this.renderTreeCell,this._treeColumn.getValue=this.getTreeValue,this._treeColumn.setValue=this.setTreeValue,this._initTree(a),Ib.controls.TreeTable.superClass.constructor.apply(this,arguments),this._columnBox.add(this._treeColumn)},Jb.ext("twaver.controls.TreeTable",Ib.controls.TableBase,{__tree:1,__accessor:["sortFunction","visibleFunction","checkMode","rootData","sortColumn","indent","rowHeight","rowLineWidth","rowLineColor","columnLineWidth","columnLineColor","expandIcon","collapseIcon","uncheckableStyle","lineType","lineColor","lineThickness","lineAlpha","lineDash"],__bool:["editable","rootVisible","makeVisibleOnSelected","keyboardRemoveEnabled","keyboardSelectEnabled"],_editable:Ed.TREETABLE_EDITABLE,_indent:Ed.TREETABLE_INDENT,_rowHeight:Ed.TREETABLE_ROW_HEIGHT,_rowLineWidth:Ed.TREETABLE_ROW_LINE_WIDTH,_rowLineColor:Ed.TREETABLE_ROW_LINE_COLOR,_columnLineWidth:Ed.TREETABLE_COLUMN_LINE_WIDTH,_columnLineColor:Ed.TREETABLE_COLUMN_LINE_COLOR,_makeVisibleOnSelected:Ed.TREETABLE_MAKE_VISIBLE_ON_SELECTED,_keyboardRemoveEnabled:Ed.TREETABLE_KEYBOARD_REMOVE_ENABLED,_keyboardSelectEnabled:Ed.TREETABLE_KEYBOARD_SELECT_ENABLED,_expandIcon:Ed.TREETABLE_EXPAND_ICON,_collapseIcon:Ed.TREETABLE_COLLAPSE_ICON,_lineType:Ed.TREE_LINE_TYPE,_lineColor:Ed.TREE_LINE_COLOR,_lineThickness:Ed.TREE_LINE_THICKNESS,_lineAlpha:Ed.TREE_LINE_ALPHA,_lineDash:Ed.TREE_LINE_DASH,getTreeColumn:function(){return this._treeColumn},renderTreeCell:function(a){a.view._renderTree(a.div,a.data,a.rowIndex,a.selected)},getTreeValue:function(a,b){return b.getLabel(a)},setTreeValue:function(a,b,c){a.setName(b)}}),Ib.controls.PropertySheet=function(a){Ib.controls.PropertySheet.superClass.constructor.apply(this,arguments),this._currentRowIndex=-1,this._currentEditor=null,this._currentData=null,this._invalidate=!1,this._resizeDiv=Wb.createDiv(),this._resizeDiv.style.backgroundColor="white",this._resizeDiv.style.opacity=0,this._resizeDiv.style.top="0px",this._categoryList=new nd,this._categoryMap={},this._rowList=new nd,this._propertyBox=new Ib.PropertyBox,this._propertyBox.addDataBoxChangeListener(this.invalidatePropertyBox,this),this._propertyBox.addDataPropertyChangeListener(this.invalidatePropertyBox,this),this._propertyBox.addHierarchyChangeListener(this.invalidatePropertyBox,this),this.__divPool=new Ib.Pool("div",2),this.__cellPool=new Ib.Pool("div",2),this.__imagePool=new Ib.Pool("img",2),this.__textPool=new Ib.Pool("span",2),this._stringPool=new Ib.Pool("span",2),this._booleanPool=new Ib.Pool("input",2),this._colorPool=new Ib.Pool("div",2),this._pools.add(this.__divPool),this._pools.add(this.__cellPool),this._pools.add(this.__imagePool),this._pools.add(this.__textPool),this._pools.add(this._stringPool),this._pools.add(this._booleanPool),this._pools.add(this._colorPool),this._view=Wb.createView("auto"),this._rootDiv=Wb.createDiv(),this._dataDiv=Wb.createDiv(),this._view.appendChild(this._rootDiv),this._rootDiv.appendChild(this._dataDiv),this.setDataBox(a?a:new Ib.DataBox);var b=this;this._view.addEventListener("change",function(a){b.handleChange(a)},!1),Qb.isTouchable?Qb.isMSTouchable?new Ib.controls.PropertySheetMSTouchInteraction(this):(new Ib.controls.PropertySheetTouchInteraction(this),new Ib.controls.PropertySheetInteraction(this)):new Ib.controls.PropertySheetInteraction(this)},Jb.ext("twaver.controls.PropertySheet",Ib.controls.View,{__accessor:["indent","rowHeight","sumWidth","propertyNameWidth","propertyNameHorizontalAlign","autoAdjustable","rowLineWidth","columnLineWidth","borderColor","categorizable","resizeTolerance","editable","selectColor","expandIcon","collapseIcon","sortFunction","visibleFunction"],_autoAdjustable:Ed.PROPERTYSHEET_AUTO_ADJUSTABLE,_selectColor:Ed.SELECT_COLOR,_categorizable:Ed.PROPERTYSHEET_CATEGORIZABLE,_editable:Ed.PROPERTYSHEET_EDITABLE,_propertyNameWidth:Ed.PROPERTYSHEET_PROPERTY_NAME_WIDTH,_propertyNameHorizontalAlign:Ed.PROPERTYSHEET_PROPERTY_NAME_HORIZONTAL_ALIGN,_sumWidth:Ed.PROPERTYSHEET_SUM_WIDTH,_indent:Ed.PROPERTYSHEET_INDENT,_rowHeight:Ed.PROPERTYSHEET_ROW_HEIGHT,_rowLineWidth:Ed.PROPERTYSHEET_ROW_LINE_WIDTH,_columnLineWidth:Ed.PROPERTYSHEET_COLUMN_LINE_WIDTH,_borderColor:Ed.PROPERTYSHEET_BORDER_COLOR,_expandIcon:Ed.PROPERTYSHEET_EXPAND_ICON,_collapseIcon:Ed.PROPERTYSHEET_COLLAPSE_ICON,_resizeTolerance:Ed.PROPERTYSHEET_RESIZE_TOLERANCE,getPropertyBox:function(){return this._propertyBox},getCurrentData:function(){return this._currentData},getDataDiv:function(){return this._dataDiv},getDataBox:function(){return this._box},setDataBox:function(a){if(!a)throw"DataBox can not be null";if(this._box!==a){var b=this._box;b&&(b.removeDataPropertyChangeListener(this.handlePropertyChange,this),this._selectionModel||b.getSelectionModel().removeSelectionChangeListener(this.handleSelectionChange,this)),this._box=a,this._box.addDataPropertyChangeListener(this.handlePropertyChange,this),this._selectionModel?this._selectionModel._setDataBox(a):this._box.getSelectionModel().addSelectionChangeListener(this.handleSelectionChange,this),this.invalidate(),this.firePropertyChange("dataBox",b,this._box)}},invalidatePropertyBox:function(){this._isValidating||this.invalidate()},onPropertyChanged:function(a){"zoom"!==a.property&&this.invalidate()},isVisible:function(a){return a.isVisible&&!a.isVisible(this._currentData,this)?!1:this._visibleFunction?this._visibleFunction(a):!0},handlePropertyChange:function(a){this._currentData===a.source&&this.invalidate()},handleSelectionChange:function(a){this._currentData!==this.getSelectionModel().getLastData()&&(this._currentRowIndex=-1,this.invalidate())},isExpanded:function(a){if(!a)return!0;var b=this._categoryMap[a];return b?b.isExpanded:Ed.PROPERTYSHEET_EXPAND_CATEGORY},expand:function(a){if(a){var b=this._categoryMap[a];b&&!b.isExpanded&&(b.isExpanded=!0,this.invalidate())}},expandAll:function(){for(var a in this._categoryMap){var b=this._categoryMap[a];b&&(b.isExpanded=!0)}this.invalidate()},collapse:function(a){if(a){var b=this._categoryMap[a];b&&b.isExpanded&&(b.isExpanded=!1,this.invalidate())}},collapseAll:function(){for(var a in this._categoryMap){var b=this._categoryMap[a];b&&(b.isExpanded=!1)}this.invalidate()},getCategoryName:function(a){if(!this.isCategorizable())return"null";var b=a.getCategoryName();return b?b:"null"},validateModel:function(){this._rowList.clear(),this._categoryList.clear();var a,b,c,d,e,f={},g=new nd,h=this._currentData?this._propertyBox.getRoots():new nd;for(d=h.size(),a=0;d>a;a++)e=h.get(a),this.isVisible(e)&&(g.add(e),c=this.getCategoryName(e),f[c]||(this._categoryList.add(c),f[c]={isExpanded:this.isExpanded(c),properties:new nd}));for(this._sortFunction&&g.sort(this._sortFunction),this._categoryMap=f,d=g.size(),a=0;a<this._categoryList.size();a++){c=this._categoryList.get(a),"null"!==c&&this._rowList.add(c);var i=f[c];if(i.isExpanded)for(b=0;d>b;b++)e=g.get(b),this.getCategoryName(e)===c&&(i.properties.add(e),this._rowList.add({view:this,data:this._currentData,property:e,value:this._currentData?this.getValue(this._currentData,e):null}))}},adjustWidth:function(){var a=this._view.offsetWidth,b=this._view.offsetHeight;a<=this._indent||0>=b||(a-=this._indent,this._rowList.size()*this._rowHeight>b&&(a-=Ed.SCROLL_BAR_WIDTH,0>=a)||(this._propertyNameWidth=0===this._sumWidth||this._propertyNameWidth>this._sumWidth?a/2:a*(this._propertyNameWidth/this._sumWidth),this._sumWidth=a,this._view.style.overflowX="hidden",this._view.style.overflowY="auto"))},validateDisplay:function(){var a=this._rowList.size(),b=this._borderColor,c=this._indent,d=this._rowHeight,e=this._propertyNameWidth,f=Math.max(0,this._sumWidth-e),g=this._rowLineWidth,h=this._columnLineWidth,i=d-g+"px",j=d-g-2+"px",k=c+"px",l=e-h+"px",m=f-h+"px",n=e+f+"px",o=g+"px",p=h+"px",q=e+"px",r=this._dataDiv,s=r.style;s.height=a*d+"px",s.width=c+e+f+"px";var t=this.__divPool.get();s=t.style,s.position="absolute",s.left="0px",s.top="0px",s.width=k,s.height=r.style.height,s.borderWidth="0px",s.backgroundColor=b,r.appendChild(t);for(var u=0;a>u;u++){var v=this._rowList.get(u),w=u*d+"px",x=this.__divPool.get();if(v.rowDiv=x,s=x.style,s.position="absolute",s.whiteSpace="nowrap",s.overflow="hidden",s.textOverflow="ellipsis",s.left=k,s.top=w,s.width=n,s.height=i,s.lineHeight=j,s.borderStyle="solid",s.borderWidth="0px",s.borderBottomWidth=o,s.borderBottomColor=b,r.appendChild(x),"string"==typeof v){s.backgroundColor=b,t=this.__divPool.get(),s=t.style,s.position="absolute",s.left="0px",s.top=w,s.width=k,s.height=i,s.lineHeight=j,s.borderWidth="0px",r.appendChild(t);var y=this.__imagePool.get(),z=this.isExpanded(v)?this._expandIcon:this._collapseIcon;y.setAttribute("src",Jb.getImageSrc(z)),s=y.style,s.verticalAlign="middle",y._expandData=v,t.appendChild(y),this.renderCategory(x,v),this.onCategoryRendered(x,v)}else{var A=v.property,B=this.__cellPool.get();v.nameRender=B,s=B.style,this._currentRowIndex===u&&(s.backgroundColor=this.getSelectColor()),s.position="absolute",s.verticalAlign="middle",s.textAlign=this._propertyNameHorizontalAlign,s.overflow="hidden",s.textOverflow="ellipsis",s.whiteSpace="nowrap",s.left="0px",s.top="0px",s.width=l,s.height=i,s.borderStyle="solid",s.borderWidth="0px",s.borderRightWidth=p,s.borderRightColor=b,x.appendChild(B),this.renderName(v),this.onNameRendered(v),B=this.__cellPool.get(),v.valueRender=B,s=B.style,s.position="absolute",s.verticalAlign="middle",s.textAlign=A.getHorizontalAlign(),s.whiteSpace="nowrap",s.overflow="hidden",s.textOverflow="ellipsis",s.left=q,s.top="0px",s.width=m,s.height=i,s.borderStyle="solid",s.borderWidth="0px",s.borderRightWidth=p,s.borderRightColor=b,x.appendChild(B),this.renderValue(v),this.onValueRendered(v)}}s=this._resizeDiv.style,s.left=c+e-h-this._resizeTolerance+"px",s.width=h+2*this._resizeTolerance+"px",s.height=r.style.height,r.appendChild(this._resizeDiv)},renderCategory:function(a,b){var c=this.__textPool.get(),d=c.style;d.fontWeight="bold",d.whiteSpace="nowrap",d.overflow="hidden",d.textOverflow="ellipsis",d.verticalAlign="middle",d.padding="1px 2px 1px 2px",c.innerHTML=b,c.setAttribute("title",b),a.appendChild(c)},onCategoryRendered:function(a,b){},renderName:function(a){if(a.property.renderName)return void a.property.renderName(a);var b=this.__textPool.get(),c=b.style;c.fontWeight="",c.whiteSpace="nowrap",c.verticalAlign="middle",c.padding="1px 2px 1px 2px";var d=a.property.getName();d||(d=a.property.getPropertyName()),b.innerHTML=d,b.setAttribute("title",d),a.nameRender.appendChild(b)},onNameRendered:function(a){},renderValue:function(a){var b=a.property;if(b.renderValue)return void b.renderValue(a);var c=a.value,d=b.getEnumInfo(this._currentData);d&&!Array.isArray(d)&&(c=d.map[c]),a.view.isCellEditable(a.data,b)&&(a.enumInfo=d,a.valueRender._editInfo=a),a.valueRender.innerHTML="",Ac.render(b.getValueType(),c,a.valueRender,a.view,b.isInnerText())},onValueRendered:function(a){},renderEditor:function(a){},onEditorRendered:function(a){},updateCurrentData:function(){this._currentData=this.getSelectionModel().getLastData()},validateImpl:function(){var a=this._view.scrollLeft,b=this._view.scrollTop;Wb.release(this._dataDiv),this.updateCurrentData(),this.validateModel(),this.isAutoAdjustable()&&this.adjustWidth(),this.validateDisplay(),this._pools.forEach(function(a){a.clear()}),this._view.scrollLeft!==a&&(this._view.scrollLeft=a),this._view.scrollTop!==b&&(this._view.scrollTop=b)},getValue:function(a,b){return a?b.getValue(a,this):null},setValue:function(a,b,c){a&&b.setValue(a,c,this)},isCellEditable:function(a,b){return a?this.isEditable()&&b.isEditable():!1},getRowIndexAt:function(a){var b=this.getLogicalPoint(a);if(!b)return-1;var c=parseInt(b.y/this._rowHeight);return c>=0&&c<this._rowList.size()?c:-1},handleChange:function(a){this._isCommitting||this._isCanceling||this._isValidating||a.target._editInfo&&this.commitEditValue&&this.commitEditValue(a.target._editInfo,a.target)},commitEditValue:function(a,b){var c;c="checkbox"===b.type?b.checked:b.value;var d=a.property,e=d.getValueType();if("int"===e&&"string"==typeof c)c=parseInt(c);else if("number"===e&&"string"==typeof c)c=parseFloat(c);else if("array.string"===e)c=c.split(",");else if("array.number"===e){c=c.split(",");for(var f=0,g=c.length;g>f;f++)c[f]=parseFloat(c[f])}else if("list.points"===e){for(var h=c.replace(/\]/g,"").replace(/\[/g,"").split(","),i=new Ib.List,f=0;f<h.length;f+=2)f+1>=h.length||i.add({x:parseInt(h[f]),y:parseInt(h[f+1])});c=i}if(b._rowInfo&&(b._rowInfo.value=c,this.renderValue(b._rowInfo)),this.setValue(a.data,d,c),Ib.Util.setFocus(this._view),this._currentEditor){var j=this._currentEditor.parentNode;j&&j.removeChild(this._currentEditor),delete this._currentEditor}delete this._isCommitting},cancelEditing:function(){if(this._currentEditor){var a=this._currentEditor.parentNode;a&&a.removeChild(this._currentEditor),delete this._currentEditor,delete this._isCanceling}},getEditorValue:function(a){var b=a.valueRender._editInfo,c=b.property.getValueType(),d=a.valueRender._editInfo.value,e="";if("list.points"===c){var f=d._as?d._as:d;f.forEach(function(a,b){e+=b==f.length-1?"["+a.x+","+a.y+"]":"["+a.x+","+a.y+"],"})}else e=d;return e},updateCurrentRowIndex:function(a){var b=this._rowList.size();(0>a||a>=b)&&(a=-1);var c,d=this._currentRowIndex;if(a!==d&&(d>=0&&b>d&&(c=this._rowList.get(d),c.nameRender&&(c.nameRender.style.backgroundColor="")),this._currentRowIndex=a),a>=0&&(c=this._rowList.get(a),c.nameRender&&(c.nameRender.style.backgroundColor=this.getSelectColor(),!this._currentEditor&&c.valueRender&&c.valueRender._editInfo))){var e=c.valueRender._editInfo,f=this.renderEditor&&this.renderEditor(c);f?(this._currentEditor=f.view,null!=e.value&&(this._currentEditor.value=this.getEditorValue(c))):e.enumInfo?this._currentEditor=Wb.createSelect(e.enumInfo,e.value):(this._currentEditor=Ob.createElement("input"),null!=e.value&&(this._currentEditor.value=this.getEditorValue(c)));var g=this;if(c.property&&c.property.renderEditor){var f="function"==typeof c.property.renderEditor?c.property.renderEditor(g,c):c.property.renderEditor;f&&(g._currentEditor=f)}if(this._currentEditor){if(f&&f.onKeyDown){var h=f.onKeyDown;h&&Array.isArray(h)&&g._currentEditor.addEventListener("keydown",function(a){for(var b=0;b<h.length;b++)if(h[b].combKey){var c=null;switch(h[b].combKey){case"ctrlKey":c=a.ctrlKey;break;case"shiftKey":c=a.shiftKey;break;case"altKey":c=a.altKey}a.keyCode===h[b].keyCode&&c&&h[b].handlerEvent&&h[b].handlerEvent(a)}else a.keyCode===h[b].keyCode&&h[b].handlerEvent&&h[b].handlerEvent(a)})}else this._currentEditor.addEventListener("keydown",function(a){var b=a.target._editInfo.view;if(13!==a.keyCode||!a.shiftKey)if(13===a.keyCode){if(b._isCommitting)return;b._isCommitting=!0,b.commitEditValue(a.target._editInfo,a.target)}else 27===a.keyCode&&(b._isCanceling=!0,b.cancelEditing())},!1);if(this._currentEditor.addEventListener("blur",function(a){var b=a.target._editInfo.view;b._isCommitting||b._isCanceling||(b._isCommitting=!0,b.commitEditValue(a.target._editInfo,a.target))},!1),this._currentEditor.keepDefault=!0,this._currentEditor._rowInfo=c,this._currentEditor._editInfo=e,!this._currentEditor.parentNode){var i=this._currentEditor.style;i.position="absolute",i.margin="0px",i.border="0px",i.padding="0px",i.left=this._indent+this._propertyNameWidth+"px",i.top=c.rowDiv.style.top,i.width=c.valueRender.style.width,i.height=c.valueRender.style.height,this._rootDiv.appendChild(this._currentEditor)}Ib.Util.setFocus(this._currentEditor),this.onEditorRendered&&this.onEditorRendered(c)}}}}),Ib.controls.PropertySheetInteraction=function(a){this.sheet=a,this.view=a._view,this.resizeDiv=a._resizeDiv;var b=this;this.view.addEventListener("mousedown",function(a){0===a.button&&b.handleMouseDown(a)},!1),this.view.addEventListener("mousemove",function(a){b.handleMouseMove(a)},!1)},Jb.ext("twaver.controls.PropertySheetInteraction",Object,{minGap:10,handleMouseDown:function(a){if(a.target!==this.sheet._currentEditor&&a.target.parentNode!==this.sheet._currentEditor&&(this.sheet.isFocusOnClick()&&Ib.Util.setFocus(this.view),!this.sheet._isValidating))if(a.target._expandData){var b=a.target._expandData;this.sheet.isExpanded(b)?this.sheet.collapse(b):this.sheet.expand(b)}else if(a.target===this.resizeDiv)this.lastX=this.getX(a),Wb.handle_mousedown(this,a);else{this.sheet._currentEditor&&!this.sheet._isCommitting&&(this.sheet._isCommitting=!0,this.sheet.commitEditValue(this.sheet._currentEditor._editInfo,this.sheet._currentEditor));var c=this.sheet.getRowIndexAt(a);this.sheet.updateCurrentRowIndex(c)}},handleMouseMove:function(a){if(null==this.lastX&&!Wb.target)return void this.changeCursor(a);if(Wb.target===this&&null!=this.lastX){var b=this.getX(a);if(null!=this.stopLeft){if(b<this.stopLeft)return;delete this.stopLeft}if(null!=this.stopRight){if(b>this.stopRight)return;delete this.stopRight}var c=this.sheet.getPropertyNameWidth()+(b-this.lastX);c<this.minGap?(c=this.minGap,this.stopLeft=b):c>this.sheet.getSumWidth()-this.minGap&&(c=this.sheet.getSumWidth()-this.minGap,this.stopRight=b),this.sheet.setPropertyNameWidth(c),this.lastX=b}},handleMouseUp:function(a){0===a.button&&(this.view.style.cursor="default",delete this.stopLeft,delete this.stopRight,delete this.lastX)},changeCursor:function(a){this.view.style.cursor=a.target===this.resizeDiv?"ew-resize":"default"},getX:function(a){return a.clientX/this.sheet.getZoom()}}),Ib.controls.PropertySheetTouchInteraction=function(a){this.sheet=a,this.view=a._view,this.resizeDiv=a._resizeDiv,Wb.addEventListener("touchstart","handleTouchstart",this.view,this)},Jb.ext("twaver.controls.PropertySheetTouchInteraction",Object,{minGap:10,handleTouchstart:function(a){Wb.preventDefault(a),a.target!==this.sheet._currentEditor&&a.target.parentNode!==this.sheet._currentEditor&&(this.sheet.isFocusOnClick()&&Ib.Util.setFocus(this.view),this.sheet._isValidating||(a.target===this.resizeDiv&&(this.lastX=this.getX(a)),this.lastPoint=this.sheet.getLogicalPoint(a),zc.isMultiTouch(a)&&(this.distance=zc.getDistance(a),this.zoom=this.sheet.getZoom()),Wb.addEventListener("touchmove","handleTouchmove",this.view,this),Wb.addEventListener("touchend","handleTouchend",this.view,this)))},handleTouchmove:function(a){if(Wb.preventDefault(a),this.moved||(this.moved=!0),null!=this.lastX){var b=this.getX(a);if(null!=this.stopLeft){if(b<this.stopLeft)return;delete this.stopLeft}if(null!=this.stopRight){if(b>this.stopRight)return;delete this.stopRight}var c=this.sheet.getPropertyNameWidth()+(b-this.lastX);c<this.minGap?(c=this.minGap,this.stopLeft=b):c>this.sheet.getSumWidth()-this.minGap&&(c=this.sheet.getSumWidth()-this.minGap,this.stopRight=b),this.sheet.setPropertyNameWidth(c),this.lastX=b}else if(zc.isSingleTouch(a)){if(this.lastPoint){var d=this.sheet.getLogicalPoint(a),e=this.lastPoint.x-d.x,f=this.lastPoint.y-d.y,g=this.sheet.panByOffset(e,f);this.lastPoint.x-=e-g.x,this.lastPoint.y-=f-g.y}}else if(this.distance){var h=zc.getDistance(a)/this.distance;this.sheet.setZoom(this.zoom*h,!1)}},handleTouchend:function(a){if(Wb.preventDefault(a),!this.moved)if(a.target._expandData){var b=a.target._expandData;this.sheet.isExpanded(b)?this.sheet.collapse(b):this.sheet.expand(b)}else if(a.target===this.resizeDiv);else{var c=this.sheet.getRowIndexAt(a);this.sheet.updateCurrentRowIndex(c)}delete this.stopLeft,delete this.stopRight,delete this.lastX,delete this.lastPoint,delete this.distance,delete this.zoom,delete this.moved,Wb.removeEventListener("touchmove",this.view,this),Wb.removeEventListener("touchend",this.view,this)},getX:function(a){var b=a.changedTouches[0];return b.clientX}}),Ib.controls.PropertySheetMSTouchInteraction=function(a){this.sheet=a,this.view=a._view,this.resizeDiv=a._resizeDiv,this._pointerMap={},this._pointerIdArray=[],Wb.addEventListener("MSPointerDown","handleTouchstart",this.view,this),Wb.addEventListener("MSPointerMove","handleTouchmove",this.view,this),Wb.addEventListener("MSPointerUp","handleTouchend",this.view,this),Wb.addEventListener("MSPointerCancel","handleTouchend",this.view,this),this.superHandleMouseDown=Ib.controls.PropertySheetMSTouchInteraction.superClass.handleMouseDown},Jb.ext("twaver.controls.PropertySheetMSTouchInteraction",Ib.controls.PropertySheetInteraction,{handleMouseDown:function(a){},handleTouchstart:function(a){a.isPrimary&&this._pointerIdArray.length>0&&(this._pointerMap={},this._pointerIdArray=[]),this._pointerMap[a.pointerId]||null==this.sheet.getLogicalPoint(a)||(this._pointerIdArray.push(a.pointerId),this._pointerMap[a.pointerId]=a),1==this._pointerIdArray.length&&a.pointerType==a.MSPOINTER_TYPE_MOUSE&&this.superHandleMouseDown(a),1==this._pointerIdArray.length?(this._startTouchPoint=this.sheet.getLogicalPoint(a),this._startTouchTime=new Date):2==this._pointerIdArray.length&&(this._distance=this._getDistance(),this._zoom=this.sheet.getZoom())},handleTouchmove:function(a){if(0!=this._pointerIdArray.length&&this._pointerMap[a.pointerId]&&!(Tb.getDistance({
x:this._pointerMap[a.pointerId].pageX,y:this._pointerMap[a.pointerId].pageY},{x:a.pageX,y:a.pageY})<=10))if(this._pointerMap[a.pointerId]=a,2==this._pointerIdArray.length){var b=this._getDistance()/this._distance;this.sheet.setZoom(this._zoom*b,!1)}else if(1==this._pointerIdArray.length&&a.pointerType!=a.MSPOINTER_TYPE_MOUSE&&this._startTouchPoint){var c=this.sheet.getLogicalPoint(a);if(null==c)return;var d=this._startTouchPoint.x-c.x,e=this._startTouchPoint.y-c.y,f=this.sheet.panByOffset(d,e);this._startTouchPoint.x-=d-f.x,this._startTouchPoint.y-=e-f.y}},handleTouchend:function(a){if(1==this._pointerIdArray.length&&a.pointerType!=a.MSPOINTER_TYPE_MOUSE){var b=this.sheet.getLogicalPoint(a),c=new Date;c.getTime()-this._startTouchTime.getTime()<=500&&Tb.getDistance(this._startTouchPoint,b)<=20&&this.superHandleMouseDown(a)}this._pointerMap={},this._pointerIdArray=[]},_getDistance:function(){return Tb.getDistance({x:this._pointerMap[this._pointerIdArray[0]].pageX,y:this._pointerMap[this._pointerIdArray[0]].pageY},{x:this._pointerMap[this._pointerIdArray[1]].pageX,y:this._pointerMap[this._pointerIdArray[1]].pageY})}}),Ib.controls.SplitPane=function(a,b,c,d){Ib.controls.SplitPane.superClass.constructor.apply(this,arguments),this._view=Wb.createView("hidden",!0),this._view.tabIndex=-1,this._dividerDiv=Wb.createDiv(),this._dividerDiv.tabIndex=-1,this._view.appendChild(this._dividerDiv),a&&this.setFirstView(a),b&&this.setNextView(b),c&&this.setOrientation(c),null!=d&&this.setPosition(d),this.setDividerDraggable(!0),this.setExpandable(!1),this.invalidate(),Qb.isTouchable&&new Ib.controls.SplitPaneTouchInteraction(this),new Ib.controls.SplitPaneInteraction(this)},Jb.ext("twaver.controls.SplitPane",Ib.controls.ControlBase,{__accessor:["orientation","dividerWidth","dividerBackground","dividerOpacity","maskBackground","upExpandIcon","downExpandIcon","leftExpandIcon","rightExpandIcon"],__bool:["dividerDraggable","expandable"],_position:Ed.SPLITPANE_POSITION,_orientation:Ed.SPLITPANE_ORIENTATION,_dividerWidth:Ed.SPLITPANE_DIVIDER_WIDTH,_dividerBackground:Ed.SPLITPANE_DIVIDER_BACKGROUND,_dividerOpacity:Ed.SPLITPANE_DIVIDER_OPACITY,_maskBackground:Ed.SPLITPANE_MASK_BACKGROUND,_upExpandIcon:Ed.SPLITPANE_UP_EXPAND_ICON,_downExpandIcon:Ed.SPLITPANE_DOWN_EXPAND_ICON,_leftExpandIcon:Ed.SPLITPANE_LEFT_EXPAND_ICON,_rightExpandIcon:Ed.SPLITPANE_RIGHT_EXPAND_ICON,onPropertyChanged:function(a){this.invalidate()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(a){if(0>a&&(a=0),a>1&&(a=1),a!==this._position){var b=this._position;this._position=a,this.firePropertyChange("position",b,a),null==this.lastDividerLocation&&(this.lastDividerLocation=a)}},setFirstView:function(a){if(this._firstView!==a){var b=this._firstView;b&&this._view.removeChild(b.getView?b.getView():b),this._firstView=a,a&&(a.getView?this._view.insertBefore(a.getView(),this._dividerDiv):this._view.insertBefore(a,this._dividerDiv)),this.firePropertyChange("firstView",b,a)}},getFirstView:function(){return this._firstView},setNextView:function(a){if(this._nextView!==a){var b=this._nextView;b&&this._view.removeChild(b.getView?b.getView():b),this._nextView=a,a&&(a.getView?this._view.insertBefore(a.getView(),this._dividerDiv):this._view.insertBefore(a,this._dividerDiv)),this.firePropertyChange("nextView",b,a)}},getNextView:function(){return this._nextView},validateImpl:function(){var a,b=this._position,c=this._view.offsetWidth,d=this._view.offsetHeight,e=this._dividerWidth;if(e>=8||0===e?this._coverDiv&&(this._dividerDiv.removeChild(this._coverDiv),delete this._coverDiv):this._coverDiv||(this._coverDiv=Wb.createDiv(),this._coverDiv.tabIndex=-1,this._dividerDiv.appendChild(this._coverDiv)),"horizontal"===this._orientation){e>c&&(e=c);var f=(c-e)*b,g=c-e-f+1;Jb.setViewBounds(this._firstView,{x:0,y:0,width:f,height:d}),Jb.setViewBounds(this._nextView,{x:f+e,y:0,width:g,height:d}),Jb.setViewBounds(this._dividerDiv,{x:f,y:0,width:e,height:d}),this._dividerDiv.position=f,this._coverDiv&&Jb.setViewBounds(this._coverDiv,{x:e/2-4,y:0,width:8,height:d}),this._expandable&&(this._expandCvs1||(a=Jb.html.createDiv(),a.tabIndex=-1,Jb.setViewBounds(a,{x:0,y:0,width:e,height:11}),this._expandCvs1=Jb.html.createImg(Jb.getImageSrc(this._leftExpandIcon)),this._expandCvs1.style.left=e/2-3+"px",a.appendChild(this._expandCvs1),this._dividerDiv.appendChild(a)),this._expandCvs2||(a=Jb.html.createDiv(),a.tabIndex=-1,Jb.setViewBounds(a,{x:0,y:15,width:e,height:11}),this._expandCvs2=Jb.html.createImg(Jb.getImageSrc(this._rightExpandIcon)),this._expandCvs2.style.left=e/2-3+"px",a.appendChild(this._expandCvs2),this._dividerDiv.appendChild(a)))}else{e>d&&(e=d);var h=(d-e)*b,i=d-e-h;Jb.setViewBounds(this._firstView,{x:0,y:0,width:c,height:h}),Jb.setViewBounds(this._nextView,{x:0,y:h+e,width:c,height:i}),Jb.setViewBounds(this._dividerDiv,{x:0,y:h,width:c,height:e}),this._dividerDiv.position=h,this._coverDiv&&Jb.setViewBounds(this._coverDiv,{x:0,y:e/2-4,width:c,height:8}),this._expandable&&(this._expandCvs1||(a=Jb.html.createDiv(),a.tabIndex=-1,Jb.setViewBounds(a,{x:0,y:0,width:11,height:e}),this._expandCvs1=Jb.html.createImg(Jb.getImageSrc(this._upExpandIcon)),this._expandCvs1.style.top=e/2-3+"px",a.appendChild(this._expandCvs1),this._dividerDiv.appendChild(a)),this._expandCvs2||(a=Jb.html.createDiv(),a.tabIndex=-1,Jb.setViewBounds(a,{x:15,y:0,width:11,height:e}),this._expandCvs2=Jb.html.createImg(Jb.getImageSrc(this._downExpandIcon)),this._expandCvs2.style.top=e/2-3+"px",a.appendChild(this._expandCvs2),this._dividerDiv.appendChild(a)))}var j=this._dividerDiv.style;j.background=this._dividerBackground}}),Ib.controls.SplitPaneInteraction=function(a){this.splitPane=a,this.view=a._view,this.dividerDiv=a._dividerDiv;var b=this;this.view.addEventListener("mousedown",function(a){0===a.button&&b.handleMouseDown(a)},!1),this.view.addEventListener("mousemove",function(a){b.handleMouseMove(a)},!1)},Jb.ext("twaver.controls.SplitPaneInteraction",Object,{handleMouseDown:function(a){if(this.splitPane.isExpandable()){var b,c,d=this.splitPane._dividerWidth;if(a.target===this.splitPane._expandCvs1)return void("horizontal"===this.splitPane._orientation?(b=this.view.clientWidth,d>b&&(d=b),this.splitPane.lastDividerLocation===this.splitPane.getPosition()?this.splitPane.setPosition(0):this.splitPane.lastDividerLocation<this.splitPane.getPosition()&&(this.splitPane.setPosition(this.splitPane.lastDividerLocation),this.splitPane.lastDividerLocation=this.splitPane.getPosition())):(c=this.view.clientHeight,d>c&&(d=c),this.splitPane.lastDividerLocation===this.splitPane.getPosition()?this.splitPane.setPosition(0):this.splitPane.lastDividerLocation<this.splitPane.getPosition()&&(this.splitPane.setPosition(this.splitPane.lastDividerLocation),this.splitPane.lastDividerLocation=this.splitPane.getPosition())));if(a.target===this.splitPane._expandCvs2)return void("horizontal"===this.splitPane._orientation?(b=this.view.clientWidth,d>b&&(d=b),this.splitPane.lastDividerLocation===this.splitPane.getPosition()?this.splitPane.setPosition(1):this.splitPane.lastDividerLocation>this.splitPane.getPosition()&&(this.splitPane.setPosition(this.splitPane.lastDividerLocation),this.splitPane.lastDividerLocation=this.splitPane.getPosition())):(c=this.view.clientHeight,d>c&&(d=c),this.splitPane.lastDividerLocation===this.splitPane.getPosition()?this.splitPane.setPosition(1):this.splitPane.lastDividerLocation>this.splitPane.getPosition()&&(this.splitPane.setPosition(this.splitPane.lastDividerLocation),this.splitPane.lastDividerLocation=this.splitPane.getPosition())))}if(this.splitPane.isDividerDraggable())if(this.resizeDiv)this.clear(a);else if(a.target===this.dividerDiv||a.target===this.splitPane._coverDiv){this.resizeDiv=Wb.createDiv();var e=this.resizeDiv.style;e.left=this.dividerDiv.style.left,e.top=this.dividerDiv.style.top,e.width=this.dividerDiv.style.width,e.height=this.dividerDiv.style.height,e.opacity=this.splitPane.getDividerOpacity(),e.background=this.splitPane.getDividerBackground(),this.resizeDiv.lastPosition="horizontal"===this.splitPane._orientation?a.clientX:a.clientY,this.resizeDiv.maskDiv=Wb.createDiv(),e=this.resizeDiv.maskDiv.style,e.left="0px",e.top="0px",e.width=this.view.clientWidth+"px",e.height=this.view.clientHeight+"px",e.background=this.splitPane.getMaskBackground(),this.view.appendChild(this.resizeDiv.maskDiv),this.view.appendChild(this.resizeDiv),Wb.handle_mousedown(this,a),a.preventDefault()}},handleMouseMove:function(a){if((!this.splitPane.isExpandable()||a.target!==this.splitPane._expandCvs1&&a.target!==this.splitPane._expandCvs2)&&this.splitPane.isDividerDraggable())if(this.resizeDiv||Wb.target)this.resizeDiv&&Wb.target===this&&("horizontal"===this.splitPane._orientation?this.resizeDiv.style.left=this.dividerDiv.position+a.clientX-this.resizeDiv.lastPosition+"px":this.resizeDiv.style.top=this.dividerDiv.position+a.clientY-this.resizeDiv.lastPosition+"px");else{var b="horizontal"===this.splitPane._orientation?"ew-resize":"ns-resize";this.view.style.cursor=a.target===this.dividerDiv||a.target===this.splitPane._coverDiv?b:"default"}},handleMouseUp:function(a){(!this.splitPane.isExpandable()||a.target!==this.splitPane._expandCvs1&&a.target!==this.splitPane._expandCvs2)&&this.splitPane.isDividerDraggable()&&0===a.button&&this.clear(a)},clear:function(a){if(this.resizeDiv){var b,c=this.splitPane._dividerWidth;if("horizontal"===this.splitPane._orientation){var d=this.view.clientWidth;c>d&&(c=d),b=this.dividerDiv.position+a.clientX-this.resizeDiv.lastPosition,this.splitPane.setPosition(b/(d-c))}else{var e=this.view.clientHeight;c>e&&(c=e),b=this.dividerDiv.position+a.clientY-this.resizeDiv.lastPosition,this.splitPane.setPosition(b/(e-c))}this.splitPane.lastDividerLocation=this.splitPane.getPosition(),this.view.removeChild(this.resizeDiv.maskDiv),this.view.removeChild(this.resizeDiv),delete this.resizeDiv}}}),Ib.controls.SplitPaneTouchInteraction=function(a){this.splitPane=a,this.view=a._view,this.dividerDiv=a._dividerDiv,Wb.addEventListener("touchstart","handleTouchstart",this.view,this)},Jb.ext("twaver.controls.SplitPaneTouchInteraction",Object,{handleTouchstart:function(a){if(Wb.preventDefault(a),this.splitPane.isExpandable()){var b,c,d=this.splitPane._dividerWidth;if(a.target===this.splitPane._expandCvs1)return void("horizontal"===this.splitPane._orientation?(b=this.view.clientWidth,d>b&&(d=b),this.splitPane.lastDividerLocation===this.splitPane.getPosition()?this.splitPane.setPosition(0):this.splitPane.lastDividerLocation<this.splitPane.getPosition()&&(this.splitPane.setPosition(this.splitPane.lastDividerLocation),this.splitPane.lastDividerLocation=this.splitPane.getPosition())):(c=this.view.clientHeight,d>c&&(d=c),this.splitPane.lastDividerLocation===this.splitPane.getPosition()?this.splitPane.setPosition(0):this.splitPane.lastDividerLocation<this.splitPane.getPosition()&&(this.splitPane.setPosition(this.splitPane.lastDividerLocation),this.splitPane.lastDividerLocation=this.splitPane.getPosition())));if(a.target===this.splitPane._expandCvs2)return void("horizontal"===this.splitPane._orientation?(b=this.view.clientWidth,d>b&&(d=b),this.splitPane.lastDividerLocation===this.splitPane.getPosition()?this.splitPane.setPosition(1):this.splitPane.lastDividerLocation>this.splitPane.getPosition()&&(this.splitPane.setPosition(this.splitPane.lastDividerLocation),this.splitPane.lastDividerLocation=this.splitPane.getPosition())):(c=this.view.clientHeight,d>c&&(d=c),this.splitPane.lastDividerLocation===this.splitPane.getPosition()?this.splitPane.setPosition(1):this.splitPane.lastDividerLocation>this.splitPane.getPosition()&&(this.splitPane.setPosition(this.splitPane.lastDividerLocation),this.splitPane.lastDividerLocation=this.splitPane.getPosition())))}if(this.resizeDiv)this.clear(a);else if(a.target===this.dividerDiv||a.target===this.splitPane._coverDiv){this.resizeDiv=Wb.createDiv();var e=this.resizeDiv.style;e.left=this.dividerDiv.style.left,e.top=this.dividerDiv.style.top,e.width=this.dividerDiv.style.width,e.height=this.dividerDiv.style.height,e.opacity=this.splitPane.getDividerOpacity(),e.background=this.splitPane.getDividerBackground();var f=a.changedTouches[0];this.resizeDiv.lastPosition="horizontal"===this.splitPane._orientation?f.clientX:f.clientY,this.resizeDiv.maskDiv=Wb.createDiv();var e=this.resizeDiv.maskDiv.style;e.left="0px",e.top="0px",e.width=this.view.clientWidth+"px",e.height=this.view.clientHeight+"px",e.background=this.splitPane.getMaskBackground(),this.view.appendChild(this.resizeDiv.maskDiv),this.view.appendChild(this.resizeDiv)}Wb.addEventListener("touchmove","handleTouchmove",this.view,this),Wb.addEventListener("touchend","handleTouchend",this.view,this)},handleTouchmove:function(a){if(Wb.preventDefault(a),(!this.splitPane.isExpandable()||a.target!==this.splitPane._expandCvs1&&a.target!==this.splitPane._expandCvs2)&&this.resizeDiv){var b=a.changedTouches[0];"horizontal"===this.splitPane._orientation?this.resizeDiv.style.left=this.dividerDiv.position+b.clientX-this.resizeDiv.lastPosition+"px":this.resizeDiv.style.top=this.dividerDiv.position+b.clientY-this.resizeDiv.lastPosition+"px"}},handleTouchend:function(a){(!this.splitPane.isExpandable()||a.target!==this.splitPane._expandCvs1&&a.target!==this.splitPane._expandCvs2)&&(Wb.removeEventListener("touchmove",this.view,this),Wb.removeEventListener("touchend",this.view,this),this.clear(a))},clear:function(a){var b=a.changedTouches[0];if(this.resizeDiv){var c=this.splitPane._dividerWidth;if("horizontal"===this.splitPane._orientation){var d=this.view.clientWidth;c>d&&(c=d);var e=this.dividerDiv.position+b.clientX-this.resizeDiv.lastPosition;this.splitPane.setPosition(e/(d-c))}else{var f=this.view.clientHeight;c>f&&(c=f);var e=this.dividerDiv.position+b.clientY-this.resizeDiv.lastPosition;this.splitPane.setPosition(e/(f-c))}this.splitPane.lastDividerLocation=this.splitPane.getPosition(),this.view.removeChild(this.resizeDiv.maskDiv),this.view.removeChild(this.resizeDiv),delete this.resizeDiv}}}),Ib.controls.TabPane=function(){Ib.controls.TabPane.superClass.constructor.apply(this,arguments),this._tabBox=new Ib.TabBox,this._tabBox.addDataBoxChangeListener(this.handleTabChange,this),this._tabBox.addDataPropertyChangeListener(this.handleTabChange,this),this._tabBox.addHierarchyChangeListener(this.handleTabChange,this),this._tabBox.getSelectionModel().addSelectionChangeListener(this.handleTabChange,this),this._view=Wb.createView("hidden",!0),this._tabDiv=Wb.createDiv(),this._tabDiv.onmousedown=Wb.preventDefault,this._tabDiv.onkeydown=Wb.preventDefault,this._contentDiv=Wb.createDiv(),this._view.appendChild(this._tabDiv),this._view.appendChild(this._contentDiv),this._divPool=new Ib.Pool("div"),this._iconPool=new Ib.Pool("img"),this._closePool=new Ib.Pool("img"),this._textPool=new Ib.Pool("span"),this._resizePool=new Ib.Pool("div"),this._pools.add(this._divPool),this._pools.add(this._iconPool),this._pools.add(this._closePool),this._pools.add(this._textPool),this._pools.add(this._resizePool),this.invalidateTab(),Qb.isTouchable&&new Ib.controls.TabPaneTouchInteraction(this),new Ib.controls.TabPaneInteraction(this)},Jb.ext("twaver.controls.TabPane",Ib.controls.ControlBase,{__accessor:["tabGap","tabRadius","tabHeight","horizontalAlign","tabOrientation","resizeTolerance","tabBackground","selectBackground","moveBackground","insertBackground","closeIcon","disabledColor"],__bool:["selectNextOnClose","selectNextOnInVisible"],_tabGap:Ed.TABPANE_TAB_GAP,_tabRadius:Ed.TABPANE_TAB_RADIUS,_tabHeight:Ed.TABPANE_TAB_HEIGHT,_resizeTolerance:Ed.TABPANE_RESIZE_TOLERANCE,_tabOrientation:Ed.TABPANE_TAB_ORIENTATION,_tabBackground:Ed.TABPANE_TAB_BACKGROUND,_disabledColor:Ed.TABPANE_DISABLED_COLOR,_selectBackground:Ed.TABPANE_SELECT_BACKGROUND,_moveBackground:Ed.TABPANE_MOVE_BACKGROUND,_insertBackground:Ed.TABPANE_INSERT_BACKGROUND,_horizontalAlign:Ed.TABPANE_HORIZONTAL_ALIGN,_closeIcon:Ed.TABPANE_CLOSE_ICON,_selectNextOnClose:Ed.TABPANE_SELECT_NEXT_ON_CLOSE,_selectNextOnInVisible:Ed.TABPANE_SELECT_NEXT_ON_INVISIBLE,onPropertyChanged:function(a){this.invalidateTab()},getTabBox:function(){return this._tabBox},getTabDiv:function(){return this._tabDiv},getContentDiv:function(){return this._contentDiv},handleTabChange:function(a){if(this._selectNextOnInVisible&&"visible"===a.property&&!a.newValue&&this._tabBox.getSelectionModel().contains(a.source)){for(var b,c,d=a.source,e=this._tabBox.getRoots().indexOf(d),f=this._tabBox.getRoots(),g=f.size(),h=e;g-1>h;)if(b=f.get(++h),b.isVisible()&&!b.isDisabled()){c=b;break}if(!c)for(h=e;h>0;)if(b=f.get(--h),b.isVisible()&&!b.isDisabled()){c=b;break}this._tabBox.getSelectionModel().setSelection(c)}this.invalidateTab()},invalidateTab:function(a){this._invalidateTab||(this._invalidateTab=!0,this.invalidate(a))},validateImpl:function(){this._invalidateTab&&(this._invalidateTab=!1,this.validateTab());var a,b=this._view.offsetWidth,c=this._view.offsetHeight;"top"===this._tabOrientation?(this._tabDiv.style.top="0px",a={x:0,y:this._tabHeight,width:b,height:Math.max(0,c-this._tabHeight)}):(this._tabDiv.style.top=c-this._tabHeight+"px",a={x:0,y:0,width:b,height:Math.max(0,c-this._tabHeight)}),this._currentView&&Jb.setViewBounds(this._currentView,a)},getCurrentTab:function(){return this._currentTab},getCurrentView:function(){return this._currentView},onViewRemoved:function(a){},onViewAdded:function(a){},validateTab:function(){this._currentTab=this._tabBox.getSelectionModel().getLastData();var a=this._currentTab?this._currentTab.getView():null;if(a!==this._currentView){var b,c;this._currentView&&(b=this._currentView.getView?this._currentView.getView():this._currentView,b.style.visibility="hidden",this.onViewRemoved(this._currentView)),a&&(c=a.getView?a.getView():a,c.style.visibility="inherit",c.parentNode||this._contentDiv.appendChild(c),this.onViewAdded(a)),this._currentView=a}Wb.release(this._tabDiv);for(var d=this._tabBox.getRoots(),e=this._tabHeight+"px",f=this._tabHeight-2+"px",g=this._tabRadius+"px",h=d.size(),i=0,j=0;h>j;j++){var k=d.get(j);if(k.isVisible()){var l=this._currentTab===k,m=k.getWidth();0>m&&(m=0);var n=Math.min(this._tabGap,m),o=this._divPool.get();o._tab=k;var p=o.style;p.position="absolute",p.whiteSpace="nowrap",p.lineHeight=f,p.overflow="hidden",p.textOverflow="ellipsis",p.background=l?this._selectBackground:this._tabBackground,p.textAlign=this._horizontalAlign,"top"===this._tabOrientation?(p.borderTopLeftRadius=g,p.borderTopRightRadius=g,p.borderBottomLeftRadius="0px",p.borderBottomRightRadius="0px"):(p.borderTopLeftRadius="0px",p.borderTopRightRadius="0px",p.borderBottomLeftRadius=g,p.borderBottomRightRadius=g),p.left=i+"px",p.width=m-n+"px",p.height=e,o._x=i,o._width=m-n,this.renderTab(o,k),this.onTabRendered(o,k),this._tabDiv.insertBefore(o,this._tabDiv.firstChild),i+=m,k.isResizable()&&(o=this._resizePool.get(),o._resizeTab=k,p=o.style,p.position="absolute",p.backgroundColor="white",p.opacity=0,p.left=i-n-this._resizeTolerance+"px",p.width=n+2*this._resizeTolerance+"px",p.height=e,this._tabDiv.appendChild(o))}}this._tabDiv.style.left="0px",this._tabDiv.style.width=i+"px",this._tabDiv.style.height=this._tabHeight+"px",this._pools.forEach(function(a){a.clear()})},renderTab:function(a,b){if(b.renderTab)b.renderTab(a);else{var c=b.getIcon();if(c){var d=this._iconPool.get();d.setAttribute("src",Jb.getImageSrc(c)),d.style.paddingLeft="4px",d.style.verticalAlign="middle",a.appendChild(d)}var e=b.getName();if(e){var f=this._textPool.get();f.style.whiteSpace="nowrap",f.style.verticalAlign="middle",f.style.padding="2px 4px",f.innerHTML=e,a.appendChild(f)}if(Qb.isOpera){var g=a.cloneNode(!1);g.style.left="0px",g.style.top="0px",g.style.opacity=0,a.appendChild(g)}}if(b.isClosable()){var h=this._tabRadius/4+2,d=this._closePool.get();d._closeTab=b,d.setAttribute("src",Jb.getImageSrc(this._closeIcon)),d.style.position="absolute",d.style.top=h+"px",d.style.right=h+"px",a.appendChild(d)}a.style.color=b.isDisabled()?this.getDisabledColor():""},onTabRendered:function(a,b){}}),Ib.controls.TabPaneInteraction=function(a){this.tabPane=a,this.view=a.getTabDiv();var b=this;this.view.addEventListener("mousedown",function(a){b.handleMouseDown(a)},!1),this.view.addEventListener("mousemove",function(a){b.handleMouseMove(a)},!1)},Jb.ext("twaver.controls.TabPaneInteraction",Object,{handleMouseDown:function(a){if(0===a.button){if(this.movableDiv)return void this.handleMouseUp(a);this.resizeTab=a.target._resizeTab,this.resizeTab||(this.movableDiv=this.getMovableDivAt(a)),this.changeCursor(a),this.lastX=this.getX(a),this._startClient=Wb.getClientPoint(a),this._startLogicalX=this.lastX,Wb.handle_mousedown(this,a)}},changeCursor:function(a){var b="";if(a.target._resizeTab)b="ew-resize";else{var c=this.getTabAt(a);!c||c.isDisabled()&&!c.isMovable()||(b="pointer")}this.view.style.cursor=b},handleMouseMove:function(a){if(null==this.lastX)return void this.changeCursor(a);if(Wb.target===this){var b=this._startLogicalX+a.clientX-this._startClient.x;if(this.resizeTab){if(null!=this.stopX){if(b<this.stopX)return;delete this.stopX}var c=this.resizeTab.getWidth()+(b-this.lastX);10>c&&(c=10,this.stopX=b),this.resizeTab.setWidth(c),this.lastX=b}else if(this.movableDiv){var d=b-this.lastX;if(!this.cloneDiv){if(Math.abs(d)<3)return;this.cloneDiv=this.movableDiv.cloneNode(!0),this.cloneDiv._x=this.movableDiv._x,this.cloneDiv.style.background=this.tabPane.getMoveBackground(),this.insertDiv=Wb.createDiv(),this.insertDiv.style.width="1px",this.insertDiv.style.height=this.cloneDiv.style.height,this.insertDiv.style.background=this.tabPane.getInsertBackground(),this.movableDiv.parentNode.appendChild(this.cloneDiv),this.movableDiv.parentNode.appendChild(this.insertDiv)}var e=this.cloneDiv._x+d;this.cloneDiv.style.left=e+"px",this.cloneDiv._x=e,this.lastX=b,this.tabInfo=this.getTabInfoAt(a),this.tabInfo&&(this.insertDiv.style.left=this.tabInfo.position)}}},handleMouseUp:function(a){if(0===a.button){if(this.resizeTab);else if(this.movableDiv&&this.tabInfo){var b=this.movableDiv._tab,c=this.tabInfo.index;this.tabPane.getTabBox().moveTo(b,c)}else{var d=this.tabPane.getTabBox(),b=a.target._closeTab;if(b)if(this.tabPane.isSelectNextOnClose()&&this.tabPane.getCurrentTab()===b){var e=d.getRoots(),c=e.indexOf(b);d.remove(b),e.size()>0&&(c>=e.size()&&(c=e.size()-1),d.getSelectionModel().setSelection(e.get(c)))}else d.remove(b);else{var b=this.getTabAt(a);b&&!b.isDisabled()&&d.getSelectionModel().setSelection(b)}}this.clear()}},clear:function(){this.view.style.cursor="",this.cloneDiv&&this.movableDiv&&this.movableDiv.parentNode.removeChild(this.cloneDiv),this.insertDiv&&this.movableDiv&&this.movableDiv.parentNode.removeChild(this.insertDiv),delete this.movableDiv,delete this.tabInfo,delete this.insertDiv,delete this.cloneDiv,delete this.resizeTab,delete this.stopX,delete this.lastX,delete this._startLogicalX,delete this._startClient},getTabAt:function(a){a=a.target;for(var b;a&&a!==this.view&&!(b=a._tab);)a=a.parentNode;return b},getMovableDivAt:function(a){a=a.target;for(var b;a&&a!==this.view&&!(b=a._tab);)a=a.parentNode;return b&&b.isMovable()?a:null},getX:function(a){var b=Wb.getLogicalPoint(this.view,a);return b?b.x:null},getTabInfoAt:function(a){for(var b=this._startLogicalX+a.clientX-this._startClient.x,c=this.tabPane.getTabBox().getRoots(),d=c.size(),e=0,f=!1,g=0;d>g;g++){var h=c.get(g);if(h===this.movableDiv._tab&&(f=!0),h.isVisible()){var i=h.getWidth();if(0>=i)continue;if(b>=e&&e+i>=b){var j=e+i/2>b;!f||h===this.movableDiv._tab&&j||g--;var k=j?Math.max(0,g):Math.min(g+1,d),l=j?e:e+i;return l=Math.max(0,l-1),{index:k,tab:h,position:l+"px"}}e+=i}}return this.tabInfo}}),Ib.controls.TabPaneTouchInteraction=function(a){this.tabPane=a,this.view=a.getTabDiv(),Wb.addEventListener("touchstart","handleTouchstart",this.view,this)},Jb.ext("twaver.controls.TabPaneTouchInteraction",Object,{handleTouchstart:function(a){return Wb.preventDefault(a),this.movableDiv?void this.handleTouchend(a):(this.resizeTab=a.target._resizeTab,this.resizeTab||(this.movableDiv=this.getMovableDivAt(a)),this.lastX=this.getX(a),Wb.addEventListener("touchmove","handleTouchmove",this.view,this),void Wb.addEventListener("touchend","handleTouchend",this.view,this))},handleTouchmove:function(a){if(null!=this.lastX)if(this.resizeTab){var b=this.getX(a);if(null!=this.stopX){if(b<this.stopX)return;delete this.stopX}var c=this.resizeTab.getWidth()+(b-this.lastX);0>c&&(c=0,this.stopX=b),this.resizeTab.setWidth(c),this.lastX=b}else if(this.movableDiv){var b=this.getX(a),d=b-this.lastX;if(!this.cloneDiv){if(Math.abs(d)<3)return;this.cloneDiv=this.movableDiv.cloneNode(!0),this.cloneDiv._x=this.movableDiv._x,this.cloneDiv.style.background=this.tabPane.getMoveBackground(),this.insertDiv=Wb.createDiv(),this.insertDiv.style.width="1px",this.insertDiv.style.height=this.cloneDiv.style.height,this.insertDiv.style.background=this.tabPane.getInsertBackground(),this.movableDiv.parentNode.appendChild(this.cloneDiv),this.movableDiv.parentNode.appendChild(this.insertDiv)}var e=this.cloneDiv._x+d;this.cloneDiv.style.left=e+"px",this.cloneDiv._x=e,this.lastX=b,this.tabInfo=this.getTabInfoAt(a),this.tabInfo&&(this.insertDiv.style.left=this.tabInfo.position)}},handleTouchend:function(a){if(this.resizeTab);else if(this.movableDiv&&this.tabInfo){var b=this.movableDiv._tab,c=this.tabInfo.index;this.tabPane.getTabBox().moveTo(b,c)}else{var d=this.tabPane.getTabBox(),b=a.target._closeTab;if(b)if(this.tabPane.isSelectNextOnClose()&&this.tabPane.getCurrentTab()===b){var e=d.getRoots(),c=e.indexOf(b);d.remove(b),e.size()>0&&(c>=e.size()&&(c=e.size()-1),d.getSelectionModel().setSelection(e.get(c)))}else d.remove(b);else{var b=this.getTabAt(a);b&&!b.isDisabled()&&d.getSelectionModel().setSelection(b)}}this.clear(),Wb.removeEventListener("touchmove",this.view,this),Wb.removeEventListener("touchend",this.view,this)},clear:function(){this.cloneDiv&&this.movableDiv&&this.movableDiv.parentNode.removeChild(this.cloneDiv),this.insertDiv&&this.movableDiv&&this.movableDiv.parentNode.removeChild(this.insertDiv),delete this.movableDiv,delete this.tabInfo,delete this.insertDiv,delete this.cloneDiv,delete this.resizeTab,delete this.stopX,delete this.lastX},getTabAt:function(a){a=a.target;for(var b;a&&a!==this.view&&!(b=a._tab);)a=a.parentNode;return b},getMovableDivAt:function(a){a=a.target;for(var b;a&&a!==this.view&&!(b=a._tab);)a=a.parentNode;return b&&b.isMovable()?a:null},getX:function(a){var b=Wb.getLogicalPoint(this.view,a);return b?b.x:null},getTabInfoAt:function(a){for(var b=this.getX(a),c=this.tabPane.getTabBox().getRoots(),d=c.size(),e=0,f=!1,g=0;d>g;g++){var h=c.get(g);if(h===this.movableDiv._tab&&(f=!0),h.isVisible()){var i=h.getWidth();if(0>=i)continue;if(b>=e&&e+i>=b){var j=e+i/2>b;!f||h===this.movableDiv._tab&&j||g--;var k=j?Math.max(0,g):Math.min(g+1,d),l=j?e:e+i;return l=Math.max(0,l-1),{index:k,tab:h,position:l+"px"}}e+=i}}return this.tabInfo}}),Ib.controls.TitlePane=function(a,b,c){Ib.controls.TitlePane.superClass.constructor.apply(this,arguments),this.invalidate(),this._titleDiv=Wb.createDiv(),this._titleDiv.tabIndex=-1,this._titleDiv.style.verticalAlign="middle",this._titleDiv.style.fontWeight="bold",this._titleDiv.style.textOverflow="ellipsis",this._titleDiv.style.overflow="hidden",this._titleDiv.style.whiteSpace="nowrap",this._titleDiv.onmousedown=Wb.preventDefault,this._span=Ob.createElement("span"),this._span.style.verticalAlign="middle",this._span.style.paddingLeft="4px",this._span.style.paddingRight="4px",this._img=Ob.createElement("img"),this._img.style.verticalAlign="middle",this._img.style.paddingLeft="4px",this._view=Wb.createView("hidden",!0),this._view.tabIndex=-1,this._view.appendChild(this._titleDiv),b&&this.setTitle(b),a&&this.setContent(a),c&&this.setIcon(c)},Jb.ext("twaver.controls.TitlePane",Ib.controls.ControlBase,{__accessor:["icon","title","titleHeight","titleHorizontalAlign","titleBackground"],_titleHeight:Ed.TITLEPANE_TITLE_HEIGHT,_titleBackground:Ed.TITLEPANE_TITLE_BACKGROUND,_titleHorizontalAlign:Ed.TITLEPANE_TITLE_HORIZONTAL_ALIGN,onPropertyChanged:function(a){this.invalidate()},getTitleDiv:function(){return this._titleDiv},getContent:function(){return this._content},setContent:function(a){if(this._content!==a){var b=this._content;b&&this._view.removeChild(b.getView?b.getView():b),this._content=a,a&&this._view.appendChild(a.getView?a.getView():a),this.firePropertyChange("content",b,a)}},validateImpl:function(){var a=this._view.offsetWidth,b=this._view.offsetHeight,c=this._titleDiv.style;c.textAlign=this._titleHorizontalAlign,c.lineHeight=this._titleHeight-2+"px",c.background=this._titleBackground,Wb.clear(this._titleDiv),this._icon&&(this._img.setAttribute("src",Jb.getImageSrc(this._icon)),this._titleDiv.appendChild(this._img)),this._title&&(this._span.innerHTML=this._title,this._span.setAttribute("title",this._title),this._titleDiv.appendChild(this._span));var c=this._titleDiv.style;c.left="0px",c.top="0px",c.width=a+"px",c.height=this._titleHeight+"px",Jb.setViewBounds(this._content,{x:0,y:this._titleHeight,width:a,height:Math.max(b-this._titleHeight,0)})}}),Ib.controls.Accordion=function(){Ib.controls.Accordion.superClass.constructor.apply(this,arguments),this._titleMap={},this._titleList=new nd,this._currentTitle=null,this._currentView=null,this._view=Wb.createView("hidden",!0),this.invalidate();var a=this;this._view.addEventListener("mousedown",function(b){a.handleMouseDown(b)},!1)},Jb.ext("twaver.controls.Accordion",Ib.controls.ControlBase,{__accessor:["expandIcon","collapseIcon","titleHeight","titleBackground","borderBottomColor","iconPosition"],_expandIcon:Ed.ACCORDION_EXPAND_ICON,_collapseIcon:Ed.ACCORDION_COLLAPSE_ICON,_titleHeight:Ed.ACCORDION_TITLE_HEIGHT,_titleBackground:Ed.ACCORDION_TITLE_BACKGROUND,_borderBottomColor:Ed.ACCORDION_BORDER_BOTTOM_COLOR,_iconPosition:Ed.ACCORDION_ICON_POSITION,onPropertyChanged:function(a){this.invalidate()},handleMouseDown:function(a){if(0===a.button){var b=a.target._title;b||(b=a.target.parentNode._title),b&&(this._currentTitle===b?this.collapse():this.expand(b))}},getTitles:function(){return this._titleList},getCurrentTitle:function(){return this._currentTitle},add:function(a,b){if(this._titleMap[a])throw"Title ' + title + ' already exists";var c=Wb.createDiv();c._title=a,c.onmousedown=Wb.preventDefault,c.style.cursor="pointer",c.style.textAlign="left",c.style.textOverflow="ellipsis",c.style.whiteSpace="nowrap",c.style.overflow="hidden",c.style.borderBottomWidth="1px",c.style.borderBottomStyle="solid";var d=Ob.createElement("img");d.style.verticalAlign="middle",d.style.paddingLeft="4px";var e=Ob.createElement("span");if(e.style.verticalAlign="middle",e.style.paddingLeft="4px",e.innerHTML=a,e.setAttribute("title",a),this._view.appendChild(c),c.appendChild(d),c.appendChild(e),"right"==this._iconPosition){var f=d.style,g=(this._titleHeight-8)/2;f.marginTop=g+"px",f.right="15px",f.position="absolute"}this._titleMap[a]={content:b,titleDiv:c,span:e,img:d},this._titleList.add(a),this.invalidate()},remove:function(a){var b=this._titleMap[a];b&&this._view.removeChild(b.titleDiv),delete this._titleMap[a],this._titleList.remove(a),this.invalidate()},clear:function(){var a=this;Object.keys(a._titleMap).forEach(function(b){a._view.removeChild(a._titleMap[b].titleDiv)}),a._titleMap={},a._titleList.clear(),a.invalidate()},expand:function(a){this._titleMap[a]&&this._currentTitle!==a&&(this._currentTitle=a,this.onExpanded(a),this.invalidate())},onExpanded:function(a){},collapse:function(){this._currentTitle&&(this.onCollapsed(this._currentTitle),this._currentTitle=null,this.invalidate())},onCollapsed:function(a){},validateImpl:function(){var a=this._currentView;this._currentView=null;for(var b=this._view.offsetWidth,c=this._view.offsetHeight,d=this._titleList.size(),e=0,f=0;d>f;f++){var g=this._titleList.get(f),h=this._titleMap[g],i=h.titleDiv.style;i.lineHeight=this._titleHeight-3+"px",i.background=this._titleBackground,i.borderBottomColor=this._borderBottomColor,
i.left="0px",i.top=e+"px",i.width=b+"px",i.height=this._titleHeight-1+"px";var j=this._currentTitle===g,k=j?this._expandIcon:this._collapseIcon;if(h.img.setAttribute("src",Jb.getImageSrc(k)),j){var l=Math.max(0,c-d*this._titleHeight);h.content&&(this._currentView=h.content.getView?h.content.getView():h.content,Jb.setViewBounds(h.content,{x:0,y:e+this._titleHeight,width:b,height:l}),h.content.style.overflowY="auto"),e+=this._titleHeight+l}else e+=this._titleHeight}this._currentView&&this._currentView!==a&&this._view.appendChild(this._currentView),a&&a!==this._currentView&&this._view.removeChild(a)}}),Ib.controls.BorderPane=function(a,b,c,d,e){Ib.controls.BorderPane.superClass.constructor.apply(this,arguments),this.invalidate(),this._view=Wb.createView("hidden",!0),this._view.tabIndex=-1,a&&this.setCenter(a),b&&this.setTop(b),c&&this.setRight(c),d&&this.setBottom(d),e&&this.setLeft(e)},Jb.ext("twaver.controls.BorderPane",Ib.controls.ControlBase,{__accessor:["hGap","vGap","topHeight","bottomHeight","leftWidth","rightWidth"],_hGap:Ed.BORDERPANE_HGAP,_vGap:Ed.BORDERPANE_VGAP,_topHeight:0,_bottomHeight:0,_leftWidth:0,_rightWidth:0,onPropertyChanged:function(a){this.invalidate()},getCenter:function(){return this._center},setCenter:function(a){this._setContent("center",a)},getTop:function(){return this._top},setTop:function(a){this._setContent("top",a)},getRight:function(){return this._right},setRight:function(a){this._setContent("right",a)},getBottom:function(){return this._bottom},setBottom:function(a){this._setContent("bottom",a)},getLeft:function(){return this._left},setLeft:function(a){this._setContent("left",a)},_setContent:function(a,b){var c=this["_"+a];if(c!==b){if(c){var d=c.getView?c.getView():c;this._view.contains(d)&&this._view.removeChild(d)}this["_"+a]=b,b&&this._view.appendChild(b.getView?b.getView():b),this.firePropertyChange(a,c,b)}},validateImpl:function(){var a=this._view.offsetWidth,b=this._view.offsetHeight,c=0,d=0,e=a,f=b,g=0,h=0,i=0,j=0;this._top&&(g=this._topHeight||(this._top.getView?this._top.getView().offsetHeight:this._top.offsetHeight),d=g+this._vGap),this._bottom&&(h=this._bottomHeight||(this._bottom.getView?this._bottom.getView().offsetHeight:this._bottom.offsetHeight),f=b-h-this._vGap),this._left&&(i=this._leftWidth||(this._left.getView?this._left.getView().offsetWidth:this._left.offsetWidth),c=i+this._hGap),this._right&&(j=this._rightWidth||(this._right.getView?this._right.getView().offsetWidth:this._right.offsetWidth),e=a-j-this._hGap);var k=Math.max(0,e-c),l=Math.max(0,f-d);this._top&&Jb.setViewBounds(this._top,{x:0,y:0,width:a,height:g}),this._bottom&&Jb.setViewBounds(this._bottom,{x:0,y:f,width:a,height:h}),this._left&&Jb.setViewBounds(this._left,{x:0,y:d,width:i,height:l}),this._right&&Jb.setViewBounds(this._right,{x:e,y:d,width:j,height:l}),this._center&&Jb.setViewBounds(this._center,{x:c,y:d,width:k,height:l})}}),Ib.controls.PopupMenu=function(a){this._view=Wb.createDiv(),this._view.style.zIndex=100001,this._items=[],this._itemsMap={},this.setContextView(a);var b=this._view,c=this;b.addEventListener("mouseover",function(a){c._mouseOver=!0},!1),b.addEventListener("mouseout",function(a){c._mouseOver=!1},!1),b.oncontextmenu=function(a){a.preventDefault()},Wb.addEventListener("mousedown","_handleClick",b,this)},Jb.ext("twaver.controls.PopupMenu",Object,{_width:200,_xOffset:0,_yOffset:0,_menuItemHeight:25,_background:"#F9F9F9",_border:"2px outset white",_disabledColor:"#BABBBC",_focusColor:"white",_focusBackground:"#C2CFF1",_color:"black",_subMenuEnableIcon:Ed.POPUPMENU_SUBNENU_ENABLE_ICON,_subMenuDisableIcon:Ed.POPUPMENU_SUBNENU_DISABLE_ICON,_checkboxSelectedIcon:Ed.POPUPMENU_CHECKBOX_SELECTED_ICON,_checkboxUnselectedIcon:Ed.POPUPMENU_CHECKBOX_UNSELECTED_ICON,_radiobuttonSelectedIcon:Ed.POPUPMENU_RADIOBUTTON_SELECTED_ICON,_radiobuttonUnselectedIcon:Ed.POPUPMENU_RADIOBUTTON_UNSELECTED_ICON,getView:function(){return this._view},getContextView:function(){return this._contextView},setContextView:function(a){if(this._removeContextmenuListener(),this._contextView=a,a){var b=a.getView?a.getView():a;Qb.isTouchable?(b.addEventListener("touchstart",this._getTouchStartListener(),!1),b.addEventListener("touchmove",this._getTouchMoveListener(),!1),b.addEventListener("touchend",this._getTouchEndListener(),!1)):Wb.addEventListener("contextmenu","_handleContextmenu",b,this)}},getMenuItems:function(){return this._items},setMenuItems:function(a){if(this._items=[],this._itemsMap={},a)for(var b=0,c=a.length;c>b;b++)this.addMenuItem(a[b])},addMenuItem:function(a){a.separator!==!0&&(this._itemsMap[a.id||a.label]=a),this._items.push(a)},getMenuItem:function(a){return this._itemsMap[a]},addSeparator:function(){this.addMenuItem({separator:!0})},getMenuItemById:function(a){return this._itemsMap[a]},isVisible:function(a){return a.visible!==!1},isEnabled:function(a){return a.enabled!==!1},show:function(a){this.hide();var b,c,d=this._view,e=this._view.style;if(Qb.isTouchable?(b=a.changedTouches[0].clientX,c=a.changedTouches[0].clientY):(b=a.clientX,c=a.clientY),Wb.clear(d),this.renderMenu(d,this._items),0!==this._height){Wb.addEventListener(Qb.isTouchable?"touchstart":"mousedown","_handleBodyClicked",Ob.body,this);var f=Wb.windowWidth()-this._width-10,g=Wb.windowHeight()-this._height-10;b=b>f?f:b,c=c>g?g:c,b=0>b?0:b,c=0>c?0:c,e.left=b+zc.scrollLeft()+this._xOffset+"px",e.top=c+zc.scrollTop()+this._yOffset+"px",Ob.body.appendChild(d)}},_showMenuItem:function(a,b){this._hideMenuItem(b);var c=Ob.createElement("div");b.menuItem.childrenDiv=c;var d=c.style;d.color="#000000",d.position="absolute";var e=this._width,f=b.offsetTop,g=b.menuItem.items;if(this._itemsShow=!0,b.appendChild(c),Wb.clear(c),this.renderMenu(c,g),0!==this._height){var h=Wb.windowWidth()-this._width-10,i=Wb.windowHeight()-10,j=this._getPosition(this._view);e=j.left+this._width>h?-this._width:e,f=j.top+f+g.length*this._menuItemHeight>i?f-(g.length-1)*this._menuItemHeight:f,d.left=e+"px",d.top=f+"px",b.appendChild(c)}},hide:function(){Ob.body.contains(this._view)&&Ob.body.removeChild(this._view),delete this._mouseOver,delete this._itemsShow,Wb.removeEventListener(Qb.isTouchable?"touchstart":"mousedown",Ob.body,this)},_hideMenuItem:function(a){var b=a.menuItem.childrenDiv;b&&a.contains(b)&&a.removeChild(b),this._itemsShow=!1},dispose:function(){this._removeContextmenuListener(),this.hide()},onMenuShowing:function(a){return!0},onAction:function(a){},renderMenu:function(a,b){var c=a.style;c.background=this._background,c.border=this._border,c.width=this._width+"px",this._height=0,delete this._separator;for(var d,e=0,f=b.length;f>e;e++)if(d=b[e],this.isVisible(d))if(d.separator===!0)this._separator=!0;else{var g=Ob.createElement("div");this.isEnabled(d)&&this._addMouseoverListener(g,d),g.menuItem=d,a.appendChild(g),this.renderMenuItem(g,d),this.onMenuItemRendered(g,d),this._separator=!1,this._height+=this._menuItemHeight}},renderMenuItem:function(a,b){var c=a.style;c.height=this._menuItemHeight+"px",this._separator&&(c.borderTop="1px solid gray"),this.isEnabled(b)||(c.color=this._disabledColor);var d=Ob.createElement("span");c=d.style,c.position="absolute",c.width="25px",c.height=this._menuItemHeight+"px",c.lineHeight=this._menuItemHeight+"px",c.textAlign="center",a.appendChild(d);var e;if("check"===b.type?e=b.selected?this._checkboxSelectedIcon:this._checkboxUnselectedIcon:"radio"===b.type?e=b.selected?this._radiobuttonSelectedIcon:this._radiobuttonUnselectedIcon:b.icon&&(e=b.icon),e){var f=new Pb;f.src=Jb.getImageSrc(e),f.style.verticalAlign="middle",d.appendChild(f)}var g=Ob.createElement("label");if(Jb.setText(g,b.label,!0),c=g.style,c.position="absolute",c.height=this._menuItemHeight+"px",c.lineHeight=this._menuItemHeight+"px",c.left="25px",a.appendChild(g),b.items&&a.parentNode===this._view){var h=Ob.createElement("img");c=h.style,this.isEnabled(b)?h.setAttribute("src",Jb.getImageSrc(this._subMenuEnableIcon)):h.setAttribute("src",Jb.getImageSrc(this._subMenuDisableIcon));var i=(this._menuItemHeight-8)/2;c.marginTop=i+"px",c.right="5px",c.position="absolute",a.appendChild(h)}},onMenuItemRendered:function(a,b){},_addMouseoverListener:function(a,b){var c=this;a.addEventListener(Qb.isTouchable?"touchstart":"mouseover",function(d){a.style.background=c._focusBackground,a.style.color=c._focusColor,this===d.relatedTarget||this.contains(d.relatedTarget)||b.items&&!c._itemsShow&&a.parentNode==c._view&&c._showMenuItem(d,a)},!1),a.addEventListener(Qb.isTouchable?"touchend":"mouseout",function(d){if(a.style.background=c._background,a.style.color=c._color,this!==d.relatedTarget&&!this.contains(d.relatedTarget)&&b.items&&a.parentNode===c._view){var e=d.clientX,f=d.clientY,g=b.childrenDiv,h=c._getPosition(g);(e<h.left+2||e>h.left+g.offsetWidth-2||f<h.top+2||f>h.top+g.offsetHeight-2)&&c._hideMenuItem(a)}},!1)},_getPosition:function(a){for(var b=0,c=0;a;)c+=a.offsetLeft,b+=a.offsetTop,a=a.offsetParent;return{left:c,top:b}},_removeContextmenuListener:function(){var a=this._contextView;a&&(a=a.getView?a.getView():a,Qb.isTouchable?(a.removeEventListener("touchstart",this._getTouchStartListener(),!1),a.removeEventListener("touchmove",this._getTouchMoveListener(),!1),a.removeEventListener("touchend",this._getTouchEndListener(),!1)):Wb.removeEventListener("contextmenu",a,this))},_handleContextmenu:function(a){this.onMenuShowing(a)===!0&&this.show(a),a.preventDefault()},_handleBodyClicked:function(a){if(Qb.isTouchable){for(var b=a.target;b&&b!==this._view;)b=b.parentElement;b!==this._view&&this.hide()}else this._mouseOver||this.hide()},_handleClick:function(a){if(0===a.button){for(var b=a.target;!b.menuItem&&b.parentElement;)b=b.parentElement;var c=b?b.menuItem:null;c&&this.isEnabled(c)&&("check"===c.type&&(c.selected=!c.selected),"radio"===c.type&&(c.groupName?(c.selected=!0,this._items.forEach(function(a){c!==a&&a.groupName===c.groupName&&(a.selected=!1),a.items&&a.items.forEach(function(a){c!==a&&a.groupName===c.groupName&&(a.selected=!1)})})):c.selected=!c.selected),c.action&&c.action(c),this.onAction(c),c.items&&c.items.length>0||this.hide())}},_getTouchStartListener:function(){if(!this._touchStartListener){var a=this;this._touchStartListener=function(b){a._touchMoved=!1,a._lastTouch=new Date}}return this._touchStartListener},_getTouchMoveListener:function(){if(!this._touchMoveListener){var a=this;this._touchMoveListener=function(b){a._touchMoved=!0}}return this._touchMoveListener},_getTouchEndListener:function(){if(!this._touchEndListener){var a=this;this._touchEndListener=function(b){!a._touchMoved&&(new Date).getTime()-a._lastTouch.getTime()>1e3&&a._handleContextmenu(b)}}return this._touchEndListener},getWidth:function(){return this._width},setWidth:function(a){this._width=a},getMenuItemHeight:function(){return this._menuItemHeight},setMenuItemHeight:function(a){this._menuItemHeight=a},getBackground:function(){return this._background},setBackground:function(a){this._background=a},getBorder:function(){return this._border},setBorder:function(a){this._border=a},getDisabledColor:function(){return this._disabledColor},setDisabledColor:function(a){this._disabledColor=a},getFocusColor:function(){return this._focusColor},setFocusColor:function(a){this._focusColor=a},getFocusBackground:function(){return this._focusBackground},setFocusBackground:function(a){this._focusBackground=a},getColor:function(){return this._color},setColor:function(a){this._color=a},getSubMenuEnableIcon:function(){return this._subMenuEnableIcon},setSubMenuEnableIcon:function(a){this._subMenuEnableIcon=a},getSubMenuDisableIcon:function(){return this._subMenuDisableIcon},setSubMenuDisableIcon:function(a){this._subMenuDisableIcon=a},getCheckboxSelectedIcon:function(){return this._checkboxSelectedIcon},setCheckboxSelectedIcon:function(a){this._checkboxSelectedIcon=a},getCheckboxUnselectedIcon:function(){return this._checkboxUnselectedIcon},setCheckboxUnselectedIcon:function(a){this._checkboxUnselectedIcon=a},getRadiobuttonSelectedIcon:function(){return this._radiobuttonSelectedIcon},setRadiobuttonSelectedIcon:function(a){this._radiobuttonSelectedIcon=a},getRadiobuttonUnselectedIcon:function(){return this._radiobuttonUnselectedIcon},setRadiobuttonUnselectedIcon:function(a){this._radiobuttonUnselectedIcon=a},getXOffset:function(){return this._xOffset},setXOffset:function(a){this._xOffset=a},getYOffset:function(){return this._yOffset},setYOffset:function(a){this._yOffset=a}}),Ib.charts.IS_INVALIDATE_PROPERTY={xZoom:1,xTranslate:1,yZoom:1,yTranslate:1},Ib.charts.ChartBase=function(a){Ib.charts.ChartBase.superClass.constructor.apply(this,arguments),this._uniqueColors={},this._nonDataColors={},this._publishedDatas=new nd,this._view=Wb.createView("hidden"),this._canvas=Wb.createCanvas(),this._view.appendChild(this._canvas),this.setDataBox(a?a:new Ib.ElementBox),this.invalidate(),Qb.isTouchable?Qb.isMSTouchable?new Ib.charts.ChartMSTouchInteraction(this):(new Ib.charts.ChartTouchInteraction(this),new Ib.charts.ChartInteraction(this)):new Ib.charts.ChartInteraction(this),this.setToolTipEnabled(Ed.CHART_TOOLTIP_ENABLED)},Jb.ext("twaver.charts.ChartBase",Ib.controls.ViewBase,{__accessor:["xGap","yGap","xTranslate","yTranslate","valueVisible","sortFunction","visibleFunction","xTranslateEnabled","yTranslateEnabled","xZoomEnabled","yZoomEnabled","selectTolerance","backgroundVisible","backgroundFill","backgroundFillColor","backgroundOutlineWidth","backgroundOutlineColor","backgroundGradient","backgroundGradientColor","outerZoom"],__bool:["doubleClickToReset","focusOnClick"],_backgroundVisible:Ed.CHART_BACKGROUND_VISIBLE,_backgroundFill:Ed.CHART_BACKGROUND_FILL,_backgroundFillColor:Ed.CHART_BACKGROUND_FILL_COLOR,_backgroundOutlineWidth:Ed.CHART_BACKGROUND_OUTLINE_WIDTH,_backgroundOutlineColor:Ed.CHART_BACKGROUND_OUTLINE_COLOR,_backgroundGradient:Ed.CHART_BACKGROUND_GRADIENT,_backgroundGradientColor:Ed.CHART_BACKGROUND_GRADIENT_COLOR,_selectTolerance:Ed.CHART_SELECT_TOLERANCE,_doubleClickToReset:Ed.CHART_DOUBLE_CLICK_TO_RESET,_focusOnClick:Ed.FOCUS_ON_CLICK,_sortFunction:null,_visibleFunction:null,_canvasWidth:0,_canvasHeight:0,_outerZoomL:1,_xGap:Ed.CHART_XGAP,_yGap:Ed.CHART_YGAP,_xTranslate:0,_yTranslate:0,_xTranslateEnabled:Ed.CHART_XTRANSLATE_ENABLED,_yTranslateEnabled:Ed.CHART_YTRANSLATE_ENABLED,_xZoom:1,_yZoom:1,_maxZoom:Ed.ZOOM_MAX,_minZoom:Ed.ZOOM_MIN,_xZoomEnabled:Ed.CHART_XZOOM_ENABLED,_yZoomEnabled:Ed.CHART_YZOOM_ENABLED,_valueVisible:Ed.CHART_VALUE_VISIBLE,_valueFont:Ed.CHART_VALUE_FONT,isToolTipEnabled:function(){return this._toolTipListener?!0:!1},setToolTipEnabled:function(a){if(a){if(!this._toolTipListener){var b=this;this._toolTipListener=function(a){Bc.showToolTip(a,b.getToolTip(a))},this._canvas.addEventListener("mousemove",this._toolTipListener,!0),this.firePropertyChange("toolTipEnabled",!1,!0)}}else this._toolTipListener&&(Bc.hideToolTip(),this._canvas.removeEventListener("mousemove",this._toolTipListener,!0),delete this._toolTipListener,this.firePropertyChange("toolTipEnabled",!0,!1))},getToolTip:function(a){if(this._toolTipInfos){var b=this.getLogicalPoint(a);b.x-=this._xTranslate,b.y-=this._yTranslate;for(var c=this._toolTipInfos.size(),d=c-1;d>=0;d--){var e=this._toolTipInfos.get(d);if(e.rect&&Tb.containsPoint(e.rect,b))return this.getToolTipByData(e.data,e)}}else{var f=this.tryGetDataAt(a);if(f)return this.getToolTipByData(f,{value:this.getValue(f)})}return null},getToolTipByData:function(a,c){return c.value!==b?this.formatValueText(c.value,a):null},addToolTipInfo:function(a,b,c,d,e,f,g){this._toolTipInfos&&this._toolTipInfos.add({data:f,rect:{x:a,y:b,width:c,height:d},value:e,index:g})},getLogicalPoint:function(a){return Wb.getLogicalPoint(this._canvas,a,this._outerZoom)},getTextSize:function(a,b){var c=Xb.getTextSize(a,b);return c.width&&(c.width+=4),c},getUniqueColor:function(a,c){if(null==a)return null;var d;if(!c&&(d=this._nonDataColors[a]))return d;var e=Xb.getColorArray(a);if(!c)return d=255!=e[3]?a:"rgba("+e[0]+","+e[1]+","+e[2]+",0.99)",this._nonDataColors[a]=d,d;var f="rgb("+e[0]+","+e[1]+","+e[2]+")";if(this._uniqueColors[f]===b||this._uniqueColors[f]===c);else{var g=1,h=-1,i=1;for(Qb.isOpera&&(e=[e[0],e[1],e[2]]);(e[0]+=g,e[0]>=255?(e[0]=255,g=-1):e[0]<=0&&(e[0]=0,g=1),f="rgb("+e[0]+","+e[1]+","+e[2]+")",this._uniqueColors[f]!==b&&this._uniqueColors[f]!==c)&&(e[1]+=h,e[1]>=255?(e[1]=255,h=-1):e[1]<=0&&(e[1]=0,h=1),f="rgb("+e[0]+","+e[1]+","+e[2]+")",this._uniqueColors[f]!==b&&this._uniqueColors[f]!==c)&&(e[2]+=i,e[2]>=255?(e[2]=255,i=-1):e[2]<=0&&(e[2]=0,i=1),f="rgb("+e[0]+","+e[1]+","+e[2]+")",this._uniqueColors[f]!==b&&this._uniqueColors[f]!==c););}return this._uniqueColors[f]=c,f},tryGetDataAt:function(a,b){if((null==b||0>b)&&(b=this._selectTolerance),a.target&&(a=Wb.getLogicalPoint(this._canvas,arguments[0],this._outerZoom)),!a)return null;var c=a.x-b,d=a.y-b,e=2*b+1,f=2*b+1;try{for(var g=this._canvas.getContext("2d").getImageData(c,d,e,f).data,h=0,i=g.length;i>h;h+=4)if(255===g[h+3]){var j="rgb("+g[h]+","+g[h+1]+","+g[h+2]+")",k=this._uniqueColors[j];if(k)return k}}catch(l){}return null},_getPoint:function(){var a,b;if(2===arguments.length)a=arguments[0],b=arguments[1];else if(arguments[0].target){var c=Wb.getLogicalPoint(this._canvas,arguments[0],this._outerZoom);if(!c)return null;a=c.x,b=c.y}else a=arguments[0].x,b=arguments[0].y;return{x:a,y:b}},getDataAt:function(){var a=this._getPoint.apply(this,arguments),b=a.x,c=a.y;if(0>b||0>c||b>this._canvasWidth||c>this._canvasHeight)return null;try{var d=this._canvas.getContext("2d").getImageData(b,c,1,1).data;if(255===d[3]){var e="rgb("+d[0]+","+d[1]+","+d[2]+")",f=this._uniqueColors[e];if(f)return f}}catch(g){}return null},getBackgroundRect:function(){return this._backgroundRect},drawBackground:function(a,b){this._backgroundRect=Jb.clone(b),null!=b&&b.width>0&&b.height>0&&this._backgroundVisible&&(this._backgroundFill&&Xb.fill(a,this.getUniqueColor(this._backgroundFillColor),this._backgroundGradient,this.getUniqueColor(this._backgroundGradientColor),b),this._backgroundOutlineWidth>0&&(a.lineWidth=this._backgroundOutlineWidth,a.strokeStyle=this._backgroundOutlineColor),a.beginPath(),a.rect(b.x,b.y,b.width,b.height),a.closePath(),this._backgroundFill&&a.fill(),this._backgroundOutlineWidth>0&&a.stroke())},getName:function(a){return a.getName()},getColor:function(a){return a.getStyle?a.getStyle("chart.color"):a.getClient("chart.color")},getValue:function(a){return a.getStyle?a.getStyle("chart.value"):0},getValueColor:function(a){return a.getStyle?a.getStyle("chart.value.color"):Ib.Styles.getStyle("chart.value.color")},setValueFont:function(a){if(a!==this._valueFont){var b=a;this._valueFont=a,this.firePropertyChange("valueFont",b,a)}},getValueFont:function(a){if(a){var b=a.getStyle?a.getStyle("chart.value.font"):Ib.Styles.getStyle("chart.value.font");if(b)return b}return this._valueFont},formatValueText:function(a,b){return a},getCanvasWidth:function(){return this._canvasWidth},getCanvasHeight:function(){return this.canvasHeight},getCanvas:function(){return this._canvas},isVisible:function(a){return this._internalVisibleFunction&&!this._internalVisibleFunction(a)?!1:this._visibleFunction?this._visibleFunction(a):!0},onPropertyChanged:function(a){Ib.charts.IS_INVALIDATE_PROPERTY[a.property]?this.invalidate():this.invalidateModel()},getDataBox:function(){return this._box},setDataBox:function(a){if(!a)throw"DataBox can not be null";if(this._box!==a){var b=this._box;b&&(b.removeDataBoxChangeListener(this.handleDataBoxChange,this),b.removeDataPropertyChangeListener(this.handlePropertyChange,this),b.removeHierarchyChangeListener(this.handleHierarchyChange,this),this._selectionModel||b.getSelectionModel().removeSelectionChangeListener(this.handleSelectionChange,this)),this._box=a,this._box.addDataBoxChangeListener(this.handleDataBoxChange,this),this._box.addDataPropertyChangeListener(this.handlePropertyChange,this),this._box.addHierarchyChangeListener(this.handleHierarchyChange,this),this._selectionModel?this._selectionModel._setDataBox(a):this._box.getSelectionModel().addSelectionChangeListener(this.handleSelectionChange,this),this.invalidateModel(),this.firePropertyChange("dataBox",b,this._box)}},handleDataBoxChange:function(a){this.invalidateModel()},handlePropertyChange:function(a){this.invalidateModel()},handleHierarchyChange:function(a){this.invalidateModel()},handleSelectionChange:function(a){this.invalidateModel()},getUnfilteredDatas:function(){return this._unfilteredDatas?this._unfilteredDatas:this._publishedDatas},getPublishedDatas:function(){return this._publishedDatas},createPublishedDatas:function(){return this._unfilteredDatas=new nd,this._buildChildren(this._box.getRoots(),this._unfilteredDatas),this._sortFunction&&this._unfilteredDatas.sort(this._sortFunction),this._unfilteredDatas.toList(this.isVisible,this)},_buildChildren:function(a,b){a.forEach(function(a){b.add(a),this._buildChildren(a.getChildren(),b)},this)},invalidateModel:function(){this._invalidateModel||(this._invalidateModel=!0,this.invalidate())},validateImpl:function(){this._invalidateModel&&(this._invalidateModel=!1,this._uniqueColors={},this._nonDataColors={},this._publishedDatas=this.createPublishedDatas(),this._publishedDatas.forEach(function(a){a.IStyle?a.getStyle("chart.color")||a.setStyle("chart.color",Jb.nextColor()):a.getClient("chart.color")||a.setClient("chart.color",Jb.nextColor())}),this.validateModel());var a=this._canvas.getContext("2d");this._canvasWidth=this._view.clientWidth,this._canvasHeight=this._view.clientHeight,this._canvas.setAttribute("width",this._canvasWidth),this._canvas.setAttribute("height",this._canvasHeight),a.clearRect(0,0,this._canvasWidth,this._canvasHeight),Ib.Util.makeHighRes(this._canvas),this._canvasWidth>0&&this._canvasHeight>0&&(a.translate(this._xTranslate,this._yTranslate),this._valueTexts=this._valueVisible?new nd:null,this.validateDisplay(a,this._canvasWidth*this._xZoom,this._canvasHeight*this._yZoom),delete this._valueTexts,a.translate(-this._xTranslate,-this._yTranslate))},adjustBounds:function(a){Ib.charts.ChartBase.superClass.adjustBounds.apply(this,arguments)},validateModel:function(){},validateDisplay:function(a,b,c){},drawLine:function(a,b,c,d,e,f,g){c>0&&(a.lineWidth=c,a.strokeStyle=this.getUniqueColor(b),a.beginPath(),a.moveTo(d,e),a.lineTo(f,g),a.stroke())},drawValueTexts:function(a){this._valueTexts&&this._valueTexts.forEach(function(b){Xb.drawText(a,b.text,b,b.font,b.color)})},drawVerticalText:function(a,b,c,d,e){e=this.getUniqueColor(e),a.translate(c.x,c.y),a.rotate(-Math.PI/2),Xb.drawText(a,b,null,d,e),a.rotate(Math.PI/2),a.translate(-c.x,-c.y)},_getValueTextInfo:function(a,b){if(this._valueTexts){var c=this.formatValueText(b,a);if(c&&""!==c){var d=this.getValueColor(a),e={text:c,font:this.getValueFont(a),color:this.getUniqueColor(d,a)};return this._valueTexts.add(e),e}}return null},getMaxZoom:function(){return this._maxZoom},setMaxZoom:function(a){if(!(0>a)){var b=this._maxZoom;this._maxZoom=a,this.firePropertyChange("maxZoom",b,a),this.getXZoom()>a&&this.setXZoom(a,!1),this.getYZoom()>a&&this.setYZoom(a,!1)}},getMinZoom:function(){return this._minZoom},setMinZoom:function(a){if(!(0>a)){var b=this._minZoom;this._minZoom=a,this.firePropertyChange("minZoom",b,a),this.getXZoom()<a&&this.setXZoom(a),this.getYZoom()<a&&this.setYZoom(a)}},zoomIn:function(a){null==a&&(a=Ed.ZOOM_ANIMATE),a?Ib.animate.AnimateManager.start(new Ib.animate.AnimateXYZoom(this,this._xZoom*Ed.ZOOM_INCREMENT,this._yZoom*Ed.ZOOM_INCREMENT)):(this.xZoomIn(!1),this.yZoomIn(!1))},zoomOut:function(a){null==a&&(a=Ed.ZOOM_ANIMATE),a?Ib.animate.AnimateManager.start(new Ib.animate.AnimateXYZoom(this,this._xZoom/Ed.ZOOM_INCREMENT,this._yZoom/Ed.ZOOM_INCREMENT)):(this.xZoomOut(!1),this.yZoomOut(!1))},zoomReset:function(a){null==a&&(a=Ed.ZOOM_ANIMATE),a?Ib.animate.AnimateManager.start(new Ib.animate.AnimateXYZoom(this,1,1)):(this.xZoomReset(!1),this.yZoomReset(!1))},getXZoom:function(){return this._xZoom},onXZoomChanged:function(a,b){},xZoomIn:function(a){this.setXZoom(this._xZoom*Ed.ZOOM_INCREMENT,a)},xZoomOut:function(a){this.setXZoom(this._xZoom/Ed.ZOOM_INCREMENT,a)},xZoomReset:function(a){this.setXZoom(1,a)},setXZoom:function(a,b){if(Jb.num(a)&&!(0>=a)&&(a<this._minZoom&&(a=this._minZoom),a>this._maxZoom&&(a=this._maxZoom),a!==this.xZoom))if(null==b&&(b=Ed.ZOOM_ANIMATE),b)Ib.animate.AnimateManager.start(new Ib.animate.AnimateXZoom(this,a));else{var c=this._xZoom,d=this._xTranslate-(this._canvasWidth/2-this._xTranslate)/c*(a-c);this._xZoom=a,this.firePropertyChange("xZoom",c,a),this.onXZoomChanged(c,a),this.setXTranslate(d)}},getYZoom:function(){return this._yZoom},onYZoomChanged:function(a,b){},yZoomIn:function(a){this.setYZoom(this._yZoom*Ed.ZOOM_INCREMENT,a)},yZoomOut:function(a){this.setYZoom(this._yZoom/Ed.ZOOM_INCREMENT,a)},yZoomReset:function(a){this.setYZoom(1,a)},setYZoom:function(a,b){if(Jb.num(a)&&!(0>=a)&&(a<this._minZoom&&(a=this._minZoom),a>this._maxZoom&&(a=this._maxZoom),a!==this.YZoom))if(null==b&&(b=Ed.ZOOM_ANIMATE),b)Ib.animate.AnimateManager.start(new Ib.animate.AnimateYZoom(this,a));else{var c=this._yZoom,d=this._yTranslate-(this._canvasHeight/2-this._yTranslate)/c*(a-c);this._yZoom=a,this.firePropertyChange("yZoom",c,a),this.onYZoomChanged(c,a),this.setYTranslate(d)}}}),Ib.charts.ScaleChart=function(a){Ib.charts.ScaleChart.superClass.constructor.apply(this,arguments)},Jb.ext("twaver.charts.ScaleChart",Ib.charts.ChartBase,{__accessor:["upperLimit","lowerLimit","xAxisText","xAxisLineColor","xAxisLineWidth","xAxisTextColor","xAxisTextFont","yAxisText","yAxisLineColor","yAxisLineWidth","yAxisTextColor","yAxisTextFont","xScaleTexts","xScaleTextFont","xScaleTextColor","xScaleTextOrientation","yScaleTextVisible","yScaleTextColor","yScaleTextFont","yScaleLineColor","yScaleLineWidth","yScaleValueGap","yScalePixelGap","yScaleMinTextVisible","valueSpanCount"],_reset:function(){this._map={},this._max=0,this._min=0,this._columnCount=this._xScaleTexts?this._xScaleTexts.size():0,null!=this._upperLimit&&(this._max=this._upperLimit),null!=this._lowerLimit&&(this._min=this._lowerLimit)},getMin:function(){return this._min},getMax:function(){return this._max},getRange:function(){return this._range},getColumnCount:function(){return this._columnCount},getColumnWidth:function(){return this._columnWidth},getValues:function(a){return a.getStyle?a.getStyle("chart.values"):null},formatYScaleText:function(a){return a.toFixed(2)},_initRange:function(){null==this._lowerLimit&&(this._min>=this._max&&(this._min=this._max-.1*Math.abs(this._max)),this._min=this._min-.1*(this._max-this._min)),this._range=this._max-this._min},_initValuesProportion:function(){this._publishedDatas.forEach(function(a){var b=this._map[a.getId()];b.values.forEach(function(a){b.proportions.add(null==a?null:0==this._range?0:a/this._range)},this)},this)},_commonValidateModel:function(){this._publishedDatas.forEach(function(a){var b=new nd(this.getValues(a));b.size()>this._columnCount&&(this._columnCount=b.size());var c={data:a,values:b,proportions:new nd,color:this.getUniqueColor(this.getColor(a),a)};this._initInfo&&this._initInfo(a,c),this._map[a.getId()]=c,(null==this._upperLimit||null==this._lowerLimit)&&b.forEach(function(a){null!=a&&(null==this._upperLimit&&a>this._max&&(this._max=a),null==this._lowerLimit&&a<this._min&&(this._min=a))},this)},this),this._initRange(),this._initValuesProportion()},validateDisplay:function(a,b,c){var d=0;this._xAxisText&&(d=this.getTextSize(this._xAxisTextFont,this._xAxisText).height);var e=0;this._xScaleTexts&&this._xScaleTexts.forEach(function(a){var b=this.getTextSize(this._xScaleTextFont,a),c="vertical"===this._xScaleTextOrientation?b.width:b.height;c>e&&(e=c)},this);var f=c-this._yGap-d-e,g=f-this._yGap,h=null==this._upperLimit?.9*g:g,i=0;this._yAxisText&&(i=this.getTextSize(this._yAxisTextFont,this._yAxisText).height);var j,k;this._yScaleValueGap>0?(j=Math.max(this._yScaleValueGap/this._range*h,1),k=this._yScaleValueGap):(j=Math.max(this._yScalePixelGap,1),k=this._range*(j/h));var l,m,n=0,o=new nd;if(this._yScaleTextVisible){l=this._yScaleMinTextVisible?0:j;for(var p=this._min+(this._yScaleMinTextVisible?0:k);g+1>=l;){if(m=this.formatYScaleText(p)){var q=this.getTextSize(this._yScaleTextFont,m);q.width>n&&(n=q.width),o.add({text:m,size:q,cursor:l})}l+=j,p+=k}}var r={x:this._xGap+i+n,y:this._yGap,width:b-this._xGap-i-n-this._xGap,height:c-this._yGap-e-d-this._yGap};if(this.drawBackground(a,r),this._columnWidth=this._columnCount>0?r.width/(3*this._columnCount+1)*2:r.width/2,0===this._columnWidth&&(this._columnWidth=1),this._yScaleLineWidth>0)for(l=0;g+1>=l;)this.drawLine(a,this._yScaleLineColor,this._yScaleLineWidth,r.x,f-l,r.x+r.width,f-l),l+=j;this._xAxisText&&Xb.drawText(a,this._xAxisText,{x:r.x+r.width/2,y:f+e+d/2},this._xAxisTextFont,this.getUniqueColor(this._xAxisTextColor)),this._yAxisText&&this.drawVerticalText(a,this._yAxisText,{x:this._xGap+i/2,y:g/2+this._yGap},this._yAxisTextFont,this.getUniqueColor(this._yAxisTextColor)),this.drawLine(a,this._yAxisLineColor,this._yAxisLineWidth,r.x,r.y+r.height,r.x,r.y);var s=this.getUniqueColor(this._yScaleTextColor);o.forEach(function(b){var c={x:this._xGap+i+n-b.size.width/2,y:f-b.cursor};Xb.drawText(a,b.text,c,this._yScaleTextFont,s)},this);var t=r.y+r.height+e/2;s=this.getUniqueColor(this._xScaleTextColor);for(var u=this._xScaleLineWidth>0?this.getUniqueColor(this._xScaleLineColor):null,v=0;v<this._columnCount;v++){var w=r.x+this._columnWidth*(1+1.5*v);if(this._xScaleTexts&&v<this._xScaleTexts.size()&&(m=this._xScaleTexts.get(v))){var x={x:w,y:t};"vertical"===this._xScaleTextOrientation?this.drawVerticalText(a,m,x,this._yScaleTextFont,s):this._valueSpanCount?v%this._valueSpanCount==0&&Xb.drawText(a,m,x,this._xScaleTextFont,s):Xb.drawText(a,m,x,this._xScaleTextFont,s)}"default"!==this._type&&u&&(this._valueSpanCount?v%this._valueSpanCount==0&&this.drawLine(a,u,this._xScaleLineWidth,w,r.y+r.height,w,r.y):this.drawLine(a,u,this._xScaleLineWidth,w,r.y+r.height,w,r.y))}var y=f+this._min/k*j;this._publishedDatas.size()>0&&this._columnCount>0&&this.drawContent(a,r,h,y),this.drawLine(a,this._xAxisLineColor,this._xAxisLineWidth,r.x,r.y+r.height,r.x+r.width,r.y+r.height)}}),Ib.charts.PieChart=function(a){this._sum=0,this._map={},Ib.charts.PieChart.superClass.constructor.apply(this,arguments)},Jb.ext("twaver.charts.PieChart",Ib.charts.ChartBase,{__accessor:["type","selectOffset","startAngle","shadowColor","shadowOffset","lineRate","donutRate","valuePosition"],_type:Ed.PIECHART_TYPE,_lineRate:Ed.PIECHART_LINE_RATE,_donutRate:Ed.PIECHART_DONUT_RATE,_startAngle:Ed.PIECHART_START_ANGLE,_shadowColor:Ed.PIECHART_SHADOW_COLOR,_shadowOffset:Ed.PIECHART_SHADOW_OFFSET,_selectOffset:Ed.PIECHART_SELECT_OFFSET,_valuePosition:Ed.PIECHART_VALUE_POSITION,getSum:function(){return this._sum},validateModel:function(){this._sum=0,this._map={},this._publishedDatas.forEach(function(a){var b=this.getValue(a);this._map[a.getId()]={data:a,value:b,color:this.getUniqueColor(this.getColor(a),a)},this._sum+=b},this);var a=this._startAngle;this._publishedDatas.forEach(function(b){var c=this._map[b.getId()];c.proportion=0===this._sum?0:c.value/this._sum,"line"!==this._type&&(c.startAngle=a,c.arc=c.proportion*Math.PI*2,a+=c.arc)},this)},validateDisplay:function(a,b,c){var d={x:this._xGap,y:this._yGap,width:b-2*this._xGap,height:c-2*this._yGap};if(this.drawBackground(a,d),Tb.grow(d,-4,-4),!(d.width<=0||d.height<=0)){var e=this._shadowOffset;if(e>0&&(a.shadowOffsetX=e,a.shadowOffsetY=e,a.shadowBlur=1.5*e,a.shadowColor=this._shadowColor),"oval"===this._type||"circle"===this._type){var f=d.x+d.width/2,g=d.y+d.height/2,h=d.width/2,i=d.height/2;"circle"===this._type&&(h=i=Math.min(h,i)),this._publishedDatas.forEach(function(b){var c=this._map[b.getId()];if(0!==c.arc){var d=0,e=0;if(this.isSelected(b)){var j=c.startAngle+c.arc/2;d=Math.cos(j)*this._selectOffset,e=Math.sin(j)*this._selectOffset*i/h}a.fillStyle=c.color,a.beginPath(),a.moveTo(f+d,g-e),Xb.drawArc(a,f+d,g-e,c.startAngle,c.arc,h,i,!0),a.closePath(),a.fill();
var k=this._getValueTextInfo(b,c.value);if(k){var j=c.startAngle+c.arc/2;k.x=f+d+Math.cos(j)*h*this._valuePosition,k.y=g-e-Math.sin(j)*i*this._valuePosition}}},this)}else if("donut"===this._type||"ovalDonut"===this._type){var f=d.x+d.width/2,g=d.y+d.height/2,h=d.width/2,i=d.height/2;"donut"===this._type&&(h=i=Math.min(h,i)),this._publishedDatas.forEach(function(b){var c=this._map[b.getId()];if(0!==c.arc){var d=0,e=0;if(this.isSelected(b)){var j=c.startAngle+c.arc/2;d=Math.cos(j)*this._selectOffset,e=Math.sin(j)*this._selectOffset*i/h}var k=f+Math.cos(c.startAngle)*h*this._donutRate,l=g-Math.sin(c.startAngle)*i*this._donutRate,m=f+Math.cos(c.startAngle+c.arc)*h*this._donutRate,n=g-Math.sin(c.startAngle+c.arc)*i*this._donutRate;a.fillStyle=c.color,a.beginPath(),a.moveTo(k+d,l-e),Xb.drawArc(a,f+d,g-e,c.startAngle,c.arc,h,i,!0),a.lineTo(m+d,n-e),Xb.drawArc(a,f+d,g-e,c.startAngle+c.arc,-c.arc,h*this._donutRate,i*this._donutRate,!0),a.closePath(),a.fill();var o=this._getValueTextInfo(b,c.value);if(o){var j=c.startAngle+c.arc/2,p=this._donutRate+(1-this._donutRate)*this._valuePosition;o.x=f+d+Math.cos(j)*h*p,o.y=g-e-Math.sin(j)*i*p}}},this)}else if("line"===this._type){var j=d.height*this._lineRate;d.y=d.y+d.height/2-j/2,d.height=j;var k=d.x;this._publishedDatas.forEach(function(b){var c=this._map[b.getId()],e=d.width*c.proportion;if(0!==e){a.beginPath(),a.fillStyle=c.color;var f=this.isSelected(b)?-this._selectOffset:0;a.rect(k,d.y+f,e,d.height),a.closePath(),a.fill();var g=this._getValueTextInfo(b,c.value);g&&(g.x=k+e/2,g.y=d.y+d.height+f-d.height*this._valuePosition),k+=e}},this)}this._shadowOffset>0&&(a.shadowOffsetX=0,a.shadowOffsetY=0,a.shadowBlur=0),this.drawValueTexts(a)}}}),Ib.charts.BarChart=function(a){Ib.charts.BarChart.superClass.constructor.apply(this,arguments)},Jb.ext("twaver.charts.BarChart",Ib.charts.ScaleChart,{__accessor:["type"],_upperLimit:Ed.BARCHART_UPPER_LIMIT,_lowerLimit:Ed.BARCHART_LOWER_LIMIT,_type:Ed.BARCHART_TYPE,_xAxisText:null,_xAxisTextColor:Ed.BARCHART_XAXIS_TEXT_COLOR,_xAxisTextFont:Ed.BARCHART_XAXIS_TEXT_FONT,_xAxisLineColor:Ed.BARCHART_XAXIS_LINE_COLOR,_xAxisLineWidth:Ed.BARCHART_XAXIS_LINE_WIDTH,_yAxisText:null,_yAxisTextColor:Ed.BARCHART_YAXIS_TEXT_COLOR,_yAxisTextFont:Ed.BARCHART_YAXIS_TEXT_FONT,_yAxisLineColor:Ed.BARCHART_YAXIS_LINE_COLOR,_yAxisLineWidth:Ed.BARCHART_YAXIS_LINE_WIDTH,_xScaleTexts:null,_xScaleTextFont:Ed.BARCHART_XSCALE_TEXT_FONT,_xScaleTextColor:Ed.BARCHART_XSCALE_TEXT_COLOR,_xScaleTextOrientation:Ed.BARCHART_XSCALE_TEXT_ORIENTATION,_yScaleTextVisible:Ed.BARCHART_YSCALE_TEXT_VISIBLE,_yScaleTextColor:Ed.BARCHART_YSCALE_TEXT_COLOR,_yScaleTextFont:Ed.BARCHART_YSCALE_TEXT_FONT,_yScaleLineColor:Ed.BARCHART_YSCALE_LINE_COLOR,_yScaleLineWidth:Ed.BARCHART_YSCALE_LINE_WIDTH,_yScaleValueGap:Ed.BARCHART_YSCALE_VALUE_GAP,_yScalePixelGap:Ed.BARCHART_YSCALE_PIXEL_GAP,_yScaleMinTextVisible:Ed.BARCHART_YSCALE_MIN_TEXT_VISIBLE,validateModel:function(){var a=this._type+"ValidateModel";this[a]&&(this._reset(),this[a]())},defaultValidateModel:function(){this._columnCount=this._publishedDatas.size(),this._publishedDatas.forEach(function(a){var b=this.getValue(a);null==this._upperLimit&&b>this._max&&(this._max=b),null==this._lowerLimit&&b<this._min&&(this._min=b),this._map[a.getId()]={data:a,value:b,color:this.getUniqueColor(this.getColor(a),a)}},this),this._initRange(),this._publishedDatas.forEach(function(a){var b=this._map[a.getId()];b.proportion=0==this._range?0:b.value/this._range},this)},layerValidateModel:function(){this._commonValidateModel()},groupValidateModel:function(){this._commonValidateModel()},stackValidateModel:function(){if(this._publishedDatas.forEach(function(a){var b=new nd(this.getValues(a));b.size()>this._columnCount&&(this._columnCount=b.size());var c={data:a,values:b,proportions:new nd,color:this.getUniqueColor(this.getColor(a),a)};this._map[a.getId()]=c},this),null==this._upperLimit||null==this._lowerLimit)for(var a=0;a<this._columnCount;a++){var b=0,c=0;this._publishedDatas.forEach(function(d){var e=this._map[d.getId()];if(e.values.size()>a){var f=e.values.get(a);null!=f&&(f>=0?b+=f:c+=f)}},this),null==this._upperLimit&&b>this._max&&(this._max=b),null==this._lowerLimit&&c<this._min&&(this._min=c)}this._initRange(),this._initValuesProportion()},percentValidateModel:function(){this._publishedDatas.forEach(function(a){var b=new nd(this.getValues(a));b.size()>this._columnCount&&(this._columnCount=b.size());var c={data:a,values:b,proportions:new nd,color:this.getUniqueColor(this.getColor(a),a)};this._map[a.getId()]=c},this);for(var a=new nd,b=0;b<this._columnCount;b++){var c=0;this._publishedDatas.forEach(function(a){var d=this._map[a.getId()];if(d.values.size()>b){var e=d.values.get(b);null!=e&&(c+=e)}},this),a.add(c)}for(var b=0;b<this._columnCount;b++)this._publishedDatas.forEach(function(c){var d=this._map[c.getId()],e=a.get(b);if(0!==e&&d.values.size()>b){var f=d.values.get(b);if(null!=f)return void d.proportions.add(f/e)}d.proportions.add(null)},this);this._min=0,this._max=1,this._range=1},drawRect:function(a,b,c,d,e,f,g){a.fillStyle=b,c&&this._selectInfos.add({x:d,y:e,w:f,h:g,color:this.getUniqueColor(Xb.darker(b))}),a.beginPath(),a.rect(d,e,f,g),a.closePath(),a.fill()},drawContent:function(a,b,c,d){this._selectInfos=new nd,this._toolTipInfos=this.isToolTipEnabled()?new nd:null,"default"===this._type?this.drawDefaultContent(a,b,c,d):"group"===this._type?this.drawGroupContent(a,b,c,d):"percent"===this._type?this.drawPercentContent(a,b,c,d):"stack"===this._type?this.drawStackContent(a,b,c,d):"layer"===this._type&&this.drawLayerContent(a,b,c,d),this.drawValueTexts(a),this._selectInfos.forEach(function(b){a.lineWidth=2,a.strokeStyle=b.color,a.beginPath(),a.rect(b.x,b.y,b.w,b.h),a.closePath(),a.stroke()},this),delete this._selectInfos},drawDefaultContent:function(a,b,c,d){for(var e=this._publishedDatas.size(),f=this._columnWidth,g=0;e>g;g++){var h=this._publishedDatas.get(g),i=this._map[h.getId()],j=b.x+f*(.5+1.5*g),k=Math.abs(c*i.proportion),l=i.proportion>0?d-k:d;this.drawRect(a,i.color,this.isSelected(h),j,l,f,k),this.addToolTipInfo(j,l,f,k,i.value,h);var m=this._getValueTextInfo(h,i.value);if(m){var n=this.getTextSize(m.font,m.text);m.x=j+f/2,m.y=l-n.height/2+1}}},drawPercentContent:function(a,b,c,d){this.drawStackContent(a,b,c,d)},drawStackContent:function(a,b,c,d){for(var e=this._columnCount,f=this._columnWidth,g=0;e>g;g++){var h=d,i=b.x+f*(.5+1.5*g);this._publishedDatas.forEach(function(b){var d=this._map[b.getId()];if(g<d.proportions.size()){var e=d.proportions.get(g);if(null!=e){var j=c*e;h-=j,this.drawRect(a,d.color,this.isSelected(b),i,h,f,j),this.addToolTipInfo(i,h,f,j,d.values.get(g),b);var k=this._getValueTextInfo(b,d.values.get(g));k&&(k.x=i+f/2,k.y=h+j/2)}}},this)}},drawLayerContent:function(a,b,c,d){for(var e=this._publishedDatas.size(),f=this._columnCount,g=this._columnWidth,h=3*g/8/e,i=0;f>i;i++){var j=b.x+g*(.5+1.5*i),k=0;this._publishedDatas.forEach(function(b){var f=this._map[b.getId()];if(i<f.proportions.size()){var l=f.proportions.get(i);if(null!=l){var m=c*l,n=d-m,o=j+g/2-g/8-h*(e-k),p=2*(g/8+h*(e-k));this.drawRect(a,f.color,this.isSelected(b),o,n,p,m),this.addToolTipInfo(o,n,p,m,f.values.get(i),b);var q=this._getValueTextInfo(b,f.values.get(i));if(q){var r=this.getTextSize(q.font,q.text);q.x=o+p/2,q.y=n-r.height/2+1}}}k++},this)}},drawGroupContent:function(a,b,c,d){for(var e=this._publishedDatas.size(),f=this._columnCount,g=this._columnWidth,h=g/e,i=0;f>i;i++){var j=b.x+g*(.5+1.5*i),k=0;this._publishedDatas.forEach(function(b){var e=this._map[b.getId()];if(i<e.proportions.size()){var f=e.proportions.get(i);if(null!=f){var g=c*f,l=d-g;this.drawRect(a,e.color,this.isSelected(b),j+h*k,l,h,g),this.addToolTipInfo(j+h*k,l,h,g,e.values.get(i),b);var m=this._getValueTextInfo(b,e.values.get(i));if(m){var n=this.getTextSize(m.font,m.text);m.x=j+h*k+h/2,m.y=l-n.height/2+1}}}k++},this)}}}),Ib.charts.LineChart=function(a){Ib.charts.LineChart.superClass.constructor.apply(this,arguments),this._selectTolerance=2},Jb.ext("twaver.charts.LineChart",Ib.charts.ScaleChart,{__accessor:["xScaleLineColor","xScaleLineWidth","interruptable"],_interruptable:Ed.LINECHART_INTERRUPTABLE,_upperLimit:Ed.LINECHART_UPPER_LIMIT,_lowerLimit:Ed.LINECHART_LOWER_LIMIT,_xAxisText:null,_xAxisTextColor:Ed.LINECHART_XAXIS_TEXT_COLOR,_xAxisTextFont:Ed.LINECHART_XAXIS_TEXT_FONT,_xAxisLineColor:Ed.LINECHART_XAXIS_LINE_COLOR,_xAxisLineWidth:Ed.LINECHART_XAXIS_LINE_WIDTH,_yAxisText:null,_yAxisTextColor:Ed.LINECHART_YAXIS_TEXT_COLOR,_yAxisTextFont:Ed.LINECHART_YAXIS_TEXT_FONT,_yAxisLineColor:Ed.LINECHART_YAXIS_LINE_COLOR,_yAxisLineWidth:Ed.LINECHART_YAXIS_LINE_WIDTH,_xScaleTexts:null,_xScaleTextFont:Ed.LINECHART_XSCALE_TEXT_FONT,_xScaleTextColor:Ed.LINECHART_XSCALE_TEXT_COLOR,_xScaleTextOrientation:Ed.LINECHART_XSCALE_TEXT_ORIENTATION,_xScaleLineColor:Ed.LINECHART_XSCALE_LINE_COLOR,_xScaleLineWidth:Ed.LINECHART_XSCALE_LINE_WIDTH,_valueSpanCount:Ed.LINECHART_VALUESPANCOUNT,_yScaleTextVisible:Ed.LINECHART_YSCALE_TEXT_VISIBLE,_yScaleTextColor:Ed.LINECHART_YSCALE_TEXT_COLOR,_yScaleTextFont:Ed.LINECHART_YSCALE_TEXT_FONT,_yScaleLineColor:Ed.LINECHART_YSCALE_LINE_COLOR,_yScaleLineWidth:Ed.LINECHART_YSCALE_LINE_WIDTH,_yScaleValueGap:Ed.LINECHART_YSCALE_VALUE_GAP,_yScalePixelGap:Ed.LINECHART_YSCALE_PIXEL_GAP,_yScaleMinTextVisible:Ed.LINECHART_YSCALE_MIN_TEXT_VISIBLE,getLineWidth:function(a){return a.getStyle?a.getStyle("chart.line.width"):Ib.Styles.getStyle("chart.line.width")},getMarkerShape:function(a){return a.getStyle?a.getStyle("chart.marker.shape"):Ib.Styles.getStyle("chart.marker.shape")},getMarkerSize:function(a){return a.getStyle?a.getStyle("chart.marker.size"):Ib.Styles.getStyle("chart.marker.size")},_initInfo:function(a,b){b.markerShape=this.getMarkerShape(a),b.markerSize=this.getMarkerSize(a),b.lineWidth=this.getLineWidth(a),this.isSelected(a)&&(b.lineWidth+=2)},validateModel:function(){this._reset(),this._commonValidateModel()},getPointIndexAt:function(){var a=this._getPoint.apply(this,arguments),b=this.tryGetDataAt(a);if(!b)return-1;for(var c,d=this._map[b.getId()],e=d.points,f=d.markerSize,g=0,h=e.size();h>g;g++)if(c=e.get(g),c&&Tb.getDistance(a,c)<=f)return g;return-1},drawContent:function(a,b,c,d){this._toolTipInfos=this.isToolTipEnabled()?new nd:null,this._publishedDatas.forEach(function(e){var f=this._map[e.getId()],g=f.markerSize>0?new nd:null;a.strokeStyle=f.color,a.lineWidth=f.lineWidth,a.beginPath();var h=f.proportions,i=null,j=h.size(),k=new nd;f.points=k;for(var l=0;j>l;l++){var m=h.get(l);if(null!=m){var n={x:b.x+this._columnWidth*(1+1.5*l),y:d-c*m};k.add(n),null==i?a.moveTo(n.x,n.y):a.lineTo(n.x,n.y);var o=f.values.get(l),p=this._getValueTextInfo(e,o);if(p){var q=this.getTextSize(p.font,p.text);p.x=n.x,p.y=n.y-q.height/2+2}g&&g.add({point:n,value:o,data:e,index:l}),i=n}else this._interruptable&&(i=null,k.add(null))}if(a.stroke(),g){var r=f.markerSize/2;g.forEach(function(b){a.fillStyle=f.color;var c=b.point.x-r,d=b.point.y-r,e=f.markerSize,g=f.markerSize;Xb.drawVector(a,f.markerShape,null,c,d,e,g),a.fill(),this.addToolTipInfo(c,d,e,g,b.value,b.data,b.index)},this)}},this),this.drawValueTexts(a)}}),Ib.charts.BubbleChart=function(a){Ib.charts.BubbleChart.superClass.constructor.apply(this,arguments)},Jb.ext("twaver.charts.BubbleChart",Ib.charts.ScaleChart,{__accessor:["xAxisUpperLimit","xAxisLowerLimit","xScaleLineColor","xScaleLineWidth","selectShadowColor","selectShadowOffset"],_upperLimit:Ed.BUBBLECHART_UPPER_LIMIT,_lowerLimit:Ed.BUBBLECHART_LOWER_LIMIT,_xAxisUpperLimit:Ed.BUBBLECHART_XAXIS_UPPER_LIMIT,_xAxisLowerLimit:Ed.BUBBLECHART_XAXIS_LOWER_LIMIT,_xAxisText:null,_xAxisTextColor:Ed.BUBBLECHART_XAXIS_TEXT_COLOR,_xAxisTextFont:Ed.BUBBLECHART_XAXIS_TEXT_FONT,_xAxisLineColor:Ed.BUBBLECHART_XAXIS_LINE_COLOR,_xAxisLineWidth:Ed.BUBBLECHART_XAXIS_LINE_WIDTH,_yAxisText:null,_yAxisTextColor:Ed.BUBBLECHART_YAXIS_TEXT_COLOR,_yAxisTextFont:Ed.BUBBLECHART_YAXIS_TEXT_FONT,_yAxisLineColor:Ed.BUBBLECHART_YAXIS_LINE_COLOR,_yAxisLineWidth:Ed.BUBBLECHART_YAXIS_LINE_WIDTH,_xScaleTexts:null,_xScaleTextFont:Ed.BUBBLECHART_XSCALE_TEXT_FONT,_xScaleTextColor:Ed.BUBBLECHART_XSCALE_TEXT_COLOR,_xScaleTextOrientation:Ed.BUBBLECHART_XSCALE_TEXT_ORIENTATION,_xScaleLineColor:Ed.BUBBLECHART_XSCALE_LINE_COLOR,_xScaleLineWidth:Ed.BUBBLECHART_XSCALE_LINE_WIDTH,_yScaleTextVisible:Ed.BUBBLECHART_YSCALE_TEXT_VISIBLE,_yScaleTextColor:Ed.BUBBLECHART_YSCALE_TEXT_COLOR,_yScaleTextFont:Ed.BUBBLECHART_YSCALE_TEXT_FONT,_yScaleLineColor:Ed.BUBBLECHART_YSCALE_LINE_COLOR,_yScaleLineWidth:Ed.BUBBLECHART_YSCALE_LINE_WIDTH,_yScaleValueGap:Ed.BUBBLECHART_YSCALE_VALUE_GAP,_yScalePixelGap:Ed.BUBBLECHART_YSCALE_PIXEL_GAP,_yScaleMinTextVisible:Ed.BUBBLECHART_YSCALE_MIN_TEXT_VISIBLE,_selectShadowColor:Ed.BUBBLECHART_SELECT_SHADOW_COLOR,_selectShadowOffset:Ed.BUBBLECHART_SELECT_SHADOW_OFFSET,_resetX:function(){this._xMax=0,this._xMin=0,null!=this._xAxisUpperLimit&&(this._xMax=this._xAxisUpperLimit),null!=this._xAxisLowerLimit&&(this._xMin=this._xAxisLowerLimit)},getXMin:function(){return this._xMin},getXMax:function(){return this._xMax},getXRange:function(){return this._xRange},getShape:function(a){return a.getStyle?a.getStyle("chart.bubble.shape"):Ib.Styles.getStyle("chart.bubble.shape")},getSize:function(a,b){return b},getNames:function(a){return a.getStyle?a.getStyle("chart.names"):Ib.Styles.getStyle("chart.names")},getXAxisValues:function(a){return a.getStyle?a.getStyle("chart.xaxis.values"):Ib.Styles.getStyle("chart.xaxis.values")},getYAxisValues:function(a){return a.getStyle?a.getStyle("chart.yaxis.values"):Ib.Styles.getStyle("chart.yaxis.values")},_initXRange:function(){null==this._xAxisLowerLimit&&(this._xMin>=this._xMax&&(this._xMin=this._xMax-.1*Math.abs(this._xMax)),this._xMin=this._xMin-.1*(this._xMax-this._xMin)),this._xRange=this._xMax-this._xMin},_initXYValuesProportion:function(){this._publishedDatas.forEach(function(a){var b=this._map[a.getId()];b.xAxisValues.forEach(function(a){b.xAxisProportions.add(null==a?null:0==this._xRange?0:a/this._xRange)},this),b.yAxisValues.forEach(function(a){b.yAxisProportions.add(null==a?null:0==this._range?0:a/this._range)},this)},this)},validateModel:function(){this._reset(),this._resetX(),this._columnCount=null==this._xScaleTexts?0:this._xScaleTexts.size(),this._publishedDatas.forEach(function(a){var b=new nd(this.getYAxisValues(a)),c=new nd(this.getXAxisValues(a)),d=new nd(this.getValues(a));d.size()>this._columnCount&&(this._columnCount=d.size());var e={data:a,values:d,yAxisValues:b,xAxisValues:c,yAxisProportions:new nd,xAxisProportions:new nd,color:this.getUniqueColor(this.getColor(a),a),anchorShape:this.getShape(a)};this._map[a.getId()]=e,(null==this._upperLimit||null==this._lowerLimit)&&b.forEach(function(a){null!=a&&(null==this._upperLimit&&a>this._max&&(this._max=a),null==this._lowerLimit&&a<this._min&&(this._min=a))},this),(null==this._upperLimit||null==this._lowerLimit)&&c.forEach(function(a){null!=a&&(null==this._xAxisUpperLimit&&a>this._xMax&&(this._xMax=a),null==this._xAxisLowerLimit&&a<this._xMin&&(this._xMin=a))},this)},this),this._initRange(),this._initXRange(),this._initXYValuesProportion()},drawContent:function(a,b,c,d){this._toolTipInfos=this.isToolTipEnabled()?new nd:null,this._publishedDatas.forEach(function(e){var f=this._map[e.getId()],g=f.yAxisProportions,h=f.xAxisProportions,i=f.values,j=f.yAxisProportions.size(),k=this._selectShadowOffset;this.isSelected(e)&&k>0?(a.shadowOffsetX=k,a.shadowOffsetY=k,a.shadowBlur=2*k,a.shadowColor=this._selectShadowColor):(a.shadowOffsetX=0,a.shadowOffsetY=0,a.shadowBlur=0,a.shadowColor=f.color),a.fillStyle=f.color;for(var l=0;j>l;l++){var m=g.get(l),n=h.get(l);if(null!=m){var o={x:b.x+b.width*n,y:d-c*m},p=i.get(l),q=this.getSize(e,p),k=q/2,r=o.x-k,s=o.y-k,t=q,u=q;Xb.drawVector(a,f.anchorShape,null,r,s,t,u),a.fill(),this.addToolTipInfo(r,s,t,u,p,e,l);var v=this._getValueTextInfo(e,p);if(v){var q=this.getTextSize(v.font,v.text);v.x=o.x,v.y=o.y}}}},this),this.drawValueTexts(a)}}),Ib.charts.DialChart=function(a){Ib.charts.DialChart.superClass.constructor.apply(this,arguments)},Jb.ext("twaver.charts.DialChart",Ib.charts.ChartBase,{__accessor:["upperLimit","lowerLimit","startAngle","endAngle","innerRadius","colorRangeFillColor","outlineWidth","outlineColor","majorScaleCount","majorScaleLineWidth","majorScaleLineLength","majorScaleLineColor","minorScaleCount","minorScaleLineWidth","minorScaleLineLength","minorScaleLineColor","scaleTextVisible","scaleUpperLimitTextVisible","scaleLowerLimitTextVisible","scaleTextFont","scaleTextColor","pivotRadius","pivotFillColor","pivotOutlineWidth","pivotOutlineColor","pivotGradient","pivotGradientColor","valuePosition","colorRangeList","innerDarkerRadius","outerBrighterRadius","selectShadowColor","selectShadowOffset"],__bool:["scaleInside","pivotFill"],_upperLimit:Ed.DIALCHART_UPPER_LIMIT,_lowerLimit:Ed.DIALCHART_LOWER_LIMIT,_startAngle:Ed.DIALCHART_START_ANGLE,_endAngle:Ed.DIALCHART_END_ANGLE,_innerRadius:Ed.DIALCHART_INNER_RADIUS,_colorRangeFillColor:Ed.DIALCHART_COLOR_RANGE_FILL_COLOR,_outlineWidth:Ed.DIALCHART_OUTLINE_WIDTH,_outlineColor:Ed.DIALCHART_OUTLINE_COLOR,_scaleInside:Ed.DIALCHART_SCALE_INSIDE,_majorScaleCount:Ed.DIALCHART_MAJOR_SCALE_COUNT,_majorScaleLineWidth:Ed.DIALCHART_MAJOR_SCALE_LINE_WIDTH,_majorScaleLineLength:Ed.DIALCHART_MAJOR_SCALE_LINE_LENGTH,_majorScaleLineColor:Ed.DIALCHART_MAJOR_SCALE_LINE_COLOR,_minorScaleCount:Ed.DIALCHART_MINOR_SCALE_COUNT,_minorScaleLineWidth:Ed.DIALCHART_MINOR_SCALE_LINE_WIDTH,_minorScaleLineLength:Ed.DIALCHART_MINOR_SCALE_LINE_LENGTH,_minorScaleLineColor:Ed.DIALCHART_MINOR_SCALE_LINE_COLOR,_scaleTextVisible:Ed.DIALCHART_SCALE_TEXT_VISIBLE,_scaleUpperLimitTextVisible:Ed.DIALCHART_SCALE_UPPER_LIMIT_TEXT_VISIBLE,_scaleLowerLimitTextVisible:Ed.DIALCHART_SCALE_LOWER_LIMIT_TEXT_VISIBLE,_scaleTextFont:Ed.DIALCHART_SCALE_TEXT_FONT,_scaleTextColor:Ed.DIALCHART_SCALE_TEXT_COLOR,_pivotRadius:Ed.DIALCHART_PIVOT_RADIUS,_pivotFill:Ed.DIALCHART_PIVOT_FILL,_pivotFillColor:Ed.DIALCHART_PIVOT_FILL_COLOR,_pivotOutlineWidth:Ed.DIALCHART_PIVOT_OUTLINE_WIDTH,_pivotOutlineColor:Ed.DIALCHART_PIVOT_OUTLINE_COLOR,_pivotGradient:Ed.DIALCHART_PIVOT_GRADIENT,_pivotGradientColor:Ed.DIALCHART_PIVOT_GRADIENT_COLOR,_valuePosition:Ed.DIALCHART_VALUE_POSITION,_innerDarkerRadius:Ed.DIALCHART_INNER_DARKER_RADIUS,_outerBrighterRadius:Ed.DIALCHART_OUTER_BRIGHTER_RADIUS,_selectShadowColor:Ed.DIALCHART_SELECT_SHADOW_COLOR,_selectShadowOffset:Ed.DIALCHART_SELECT_SHADOW_OFFSET,formatScaleText:function(a){return a.toFixed(2)},validateModel:function(){this._map={},this._valueRange=this._upperLimit-this._lowerLimit;var a=this._startAngle;0!=a&&(a=(a%360+360)%360,0==a&&(a=360)),this._positiveStartAngle=a;var b=this._endAngle;0!=b&&(b=(b%360+360)%360,0==b&&(b=360)),this._positiveEndAngle=b,this._whole=360==Math.abs(a-b),this._startAngleByRadian=a*Math.PI/180,this._endAngleByRadian=b*Math.PI/180,this._clockwise=this._startAngleByRadian>this._endAngleByRadian,this._angleRange=Math.abs(this._startAngleByRadian-this._endAngleByRadian),this._publishedDatas.forEach(function(a){var b=this.getValue(a);this._map[a.getId()]={data:a,value:b,color:this.getUniqueColor(this.getColor(a),a),angle:this._startAngleByRadian+(this._clockwise?-1:1)*b/this._valueRange*this._angleRange}},this)},validateDisplay:function(a,b,c){var d={x:this._xGap,y:this._yGap,width:b-2*this._xGap,height:c-2*this._yGap};if(this.drawBackground(a,d),this._startAngleByRadian!=this._endAngleByRadian){var e,f,g=this._lowerLimit,h=this._majorScaleCount>1?this._valueRange/(this._majorScaleCount-1):0,i=0,j=0,k=null,l=null;if(this._scaleTextVisible)for(k=new nd,e=0;e<this._majorScaleCount;e++)0==e&&!this._scaleLowerLimitTextVisible||e==this._majorScaleCount-1&&!this._scaleUpperLimitTextVisible?(f=null,k.add({text:"",size:{width:0,height:0}})):(l=this.formatScaleText(g),f=this.getTextSize(this._scaleTextFont,l),k.add({text:l,size:f})),this._scaleInside||null==f||(f.width>i&&(i=f.width),f.height>j&&(j=f.height)),g+=h;if(this._angleRange<=Math.PI&&(i=Math.max(i,this._pivotRadius),j=Math.max(j,this._pivotRadius)),Tb.grow(d,-i,-j),this._calcluateCenterAndRadius(d),a.lineWidth=0,null==this._colorRangeList||0==this._colorRangeList.size())this._drawArcGroup(a,this._startAngleByRadian,this._endAngleByRadian,this.getUniqueColor(this._colorRangeFillColor)),this._drawArcOutLine(a,this._startAngleByRadian,this._endAngleByRadian,!0,!0);else{var m=this._angleRange/this._colorRangeList.size(),n=this._startAngleByRadian;for(e=0;e<this._colorRangeList.size();e++){var o=this.getUniqueColor(this._colorRangeList.get(e)),p=n+(this._clockwise?-1:1)*m;this._drawArcGroup(a,n,p,o),this._drawArcOutLine(a,n,n+(this._clockwise?-1:1)*m,0==e,e==this._colorRangeList.size()-1),n+=(this._clockwise?-1:1)*m}}var q,r,s,t,u,v,w,x,y=this._startAngleByRadian,z=this._majorScaleCount>1?this._angleRange/(this._majorScaleCount-1):0;for(v=this._scaleInside?this._innerRadiusByPixel:this._outerRadius,w=v+this._majorScaleLineLength*(this._scaleInside?1:-1),x=v+this._minorScaleLineLength*(this._scaleInside?1:-1),e=0;e<this._majorScaleCount;e++){if(r=this._center.x+Math.cos(y)*v,s=this._center.y+Math.sin(-y)*v,t=this._center.x+Math.cos(y)*w,u=this._center.y+Math.sin(-y)*w,a.lineWidth=this._majorScaleLineWidth,a.strokeStyle=this.getUniqueColor(this._majorScaleLineColor),a.beginPath(),a.moveTo(r,s),a.lineTo(t,u),a.closePath(),a.stroke(),this._scaleTextVisible)if(0==e&&!this._scaleLowerLimitTextVisible||e==this._majorScaleCount-1&&!this._scaleUpperLimitTextVisible);else{var A=k.get(e);if(A){var B=this.getScaleTextPosition(y/Math.PI*180,r,s,A.size.width,A.size.height);A.x=B.x,A.y=B.y}}if(this._whole||!this._whole&&e<this._majorScaleCount-1){var C=y,D=this._minorScaleCount>0?z/(this._minorScaleCount+1):0;for(q=0;q<this._minorScaleCount;q++)C+=(this._clockwise?-1:1)*D,r=this._center.x+Math.cos(C)*v,s=this._center.y+Math.sin(-C)*v,t=this._center.x+Math.cos(C)*x,u=this._center.y+Math.sin(-C)*x,a.lineWidth=this._minorScaleLineWidth,a.strokeStyle=this.getUniqueColor(this._minorScaleLineColor),a.beginPath(),a.moveTo(r,s),a.lineTo(t,u),a.closePath(),a.stroke()}y+=(this._clockwise?-1:1)*z}this._pivotFill&&Xb.fill(a,this.getUniqueColor(this._pivotFillColor),this._pivotGradient,this._pivotGradientColor,this._center.x-this._pivotRadius,this._center.y-this._pivotRadius,2*this._pivotRadius,2*this._pivotRadius),a.lineWidth=this._pivotOutlineWidth,a.strokeStyle=this.getUniqueColor(this._pivotOutlineColor),a.beginPath(),a.arc(this._center.x,this._center.y,this._pivotRadius,0,2*Math.PI,!0),a.closePath(),this._pivotFill&&a.fill(),k&&k.forEach(function(b){b&&Xb.drawText(a,b.text,b,this._scaleTextFont,this._scaleTextColor)},this),this._publishedDatas.forEach(function(b){var c=this._map[b.getId()],d=this._getDataStyle("dialchart.rear.extension",b),e=this._getDataStyle("dialchart.base.width",b),f=this._getDataStyle("dialchart.top.width",b),g=this._getDataStyle("dialchart.radius",b);g>=-1&&1>=g&&(g*=this._innerRadiusByPixel),a.fillStyle=c.color,a.lineWidth=0;var h=Tb.createMatrix(-c.angle,this._center.x,this._center.y),i=h.transform(this._center.x+g,this._center.y+f/2),j=h.transform(this._center.x+g,this._center.y-f/2),k=h.transform(this._center.x-d,this._center.y-e/2),l=h.transform(this._center.x-d,this._center.y+e/2),m=this._selectShadowOffset;this.isSelected(b)&&m>0?(a.shadowOffsetX=m,a.shadowOffsetY=m,a.shadowBlur=2*m,a.shadowColor=this._selectShadowColor):(a.shadowOffsetX=0,a.shadowOffsetY=0,a.shadowBlur=0,a.shadowColor=c.color),a.beginPath(),a.moveTo(i.x,i.y),a.lineTo(j.x,j.y),a.lineTo(k.x,k.y),a.lineTo(l.x,l.y),a.lineTo(i.x,i.y),a.closePath(),a.fill();var n=this._getValueTextInfo(b,c.value);if(n){var o=h.transform(this._center.x+g*this._valuePosition,this._center.y);n.x=o.x,n.y=o.y}},this),this.drawValueTexts(a)}},_getDataStyle:function(a,b){return b.getStyle?b.getStyle(a):b.getClient(a)},_calcluateCenterAndRadius:function(a){var b=this._clockwise?this._positiveEndAngle:this._positiveStartAngle,c=this._clockwise?this._positiveStartAngle:this._positiveEndAngle;Math.abs(this._positiveEndAngle-this._positiveStartAngle),b>=0&&90>b?c>=0&&90>=c?(this._outerRadius=Math.min(a.width,a.height),this._center={x:a.x+(a.width-this._outerRadius)/2,y:a.y+(a.height+this._outerRadius)/2}):c>90&&180>=c?(this._outerRadius=Math.min(a.width/2,a.height),this._center={x:a.x+a.width/2,y:a.y+(a.height+this._outerRadius)/2}):(this._center={x:a.x+a.width/2,y:a.y+a.height/2},this._outerRadius=Math.min(a.width,a.height)/2):b>=90&&180>b?c>=90&&180>=c?(this._outerRadius=Math.min(a.width,a.height),this._center={x:a.x+(a.width+this._outerRadius)/2,y:a.y+(a.height+this._outerRadius)/2}):c>180&&270>=c?(this._outerRadius=Math.min(a.width,a.height/2),this._center={x:a.x+(a.width+this._outerRadius)/2,y:a.y+a.height/2}):(this._center={x:a.x+a.width/2,y:a.y+a.height/2},this._outerRadius=Math.min(a.width,a.height)/2):b>=180&&270>b?c>=180&&270>=c?(this._outerRadius=Math.min(a.width,a.height),this._center={x:a.x+(a.width+this._outerRadius)/2,y:a.y+(a.height-this._outerRadius)/2}):(this._outerRadius=Math.min(a.width/2,a.height),this._center={x:a.x+a.width/2,y:a.y+(a.height-this._outerRadius)/2}):(this._outerRadius=Math.min(a.width,a.height),this._center={x:a.x+(a.width-this._outerRadius)/2,y:a.y+(a.height-this._outerRadius)/2}),this._innerRadiusByPixel=this._innerRadius>1?this._innerRadius:this._outerRadius*this._innerRadius,this._innerDarkerRadiusByPixel=this._innerDarkerRadius>1?this._innerDarkerRadius:this._outerRadius*this._innerDarkerRadius,this._outerBrighterRadiusByPixel=this._outerBrighterRadius>1?this._outerBrighterRadius:this._outerRadius*this._outerBrighterRadius},_drawArcOutLine:function(a,b,c,d,e){if(!(this._outlineWidth<=0)){var f=Math.abs(b-c),g=this._center.x+Math.cos(b)*this._innerRadiusByPixel,h=this._center.y+Math.sin(-b)*this._innerRadiusByPixel,i=this._center.x+Math.cos(b)*this._outerRadius,j=this._center.y+Math.sin(-b)*this._outerRadius,k=this._center.x+Math.cos(c)*this._innerRadiusByPixel,l=this._center.y+Math.sin(-c)*this._innerRadiusByPixel,m=this._center.x+Math.cos(c)*this._outerRadius,n=this._center.y+Math.sin(-c)*this._outerRadius;this._clockwise?(a.lineWidth=this._outlineWidth,a.strokeStyle=this.getUniqueColor(this._outlineColor),a.beginPath(),a.moveTo(this._center.x,this._center.y),Xb.drawArc(a,this._center.x,this._center.y,c,f,this._outerRadius,this._outerRadius,!1),a.stroke(),!this._whole&&d?(a.lineWidth=this._outlineWidth,a.strokeStyle=this.getUniqueColor(this._outlineColor)):a.lineWidth=0,a.lineTo(g,h),a.stroke(),a.beginPath(),a.lineWidth=this._outlineWidth,a.strokeStyle=this.getUniqueColor(this._outlineColor),a.moveTo(this._center.x,this._center.y),Xb.drawArc(a,this._center.x,this._center.y,b,-f,this._innerRadiusByPixel,this._innerRadiusByPixel,!1),a.stroke(),!this._whole&&e?(a.lineWidth=this._outlineWidth,a.strokeStyle=this.getUniqueColor(this._outlineColor)):a.lineWidth=0,a.lineTo(m,n),a.stroke()):(a.lineWidth=this._outlineWidth,a.strokeStyle=this.getUniqueColor(this._outlineColor),a.beginPath(),a.moveTo(this._center.x,this._center.y),Xb.drawArc(a,this._center.x,this._center.y,b,f,this._outerRadius,this._outerRadius,!1),a.stroke(),!this._whole&&e?(a.lineWidth=this._outlineWidth,a.strokeStyle=this.getUniqueColor(this._outlineColor)):a.lineWidth=0,a.lineTo(k,l),a.stroke(),a.lineWidth=this._outlineWidth,a.strokeStyle=this.getUniqueColor(this._outlineColor),a.beginPath(),a.moveTo(this._center.x,this._center.y),Xb.drawArc(a,this._center.x,this._center.y,c,-f,this._innerRadiusByPixel,this._innerRadiusByPixel,!1),a.stroke(),!this._whole&&d?(a.lineWidth=this._outlineWidth,a.strokeStyle=this.getUniqueColor(this._outlineColor)):a.lineWidth=0,a.lineTo(i,j),a.stroke())}},_drawArcGroup:function(a,b,c,d){0!=this._outerBrighterRadiusByPixel&&this._drawArc(a,b,c,this._outerRadius-this._outerBrighterRadiusByPixel,this._outerRadius,Xb.brighter(d)),this._drawArc(a,b,c,this._innerRadiusByPixel+this._innerDarkerRadiusByPixel,this._outerRadius-this._outerBrighterRadiusByPixel,d),0!=this._innerDarkerRadiusByPixel&&this._drawArc(a,b,c,this._innerRadiusByPixel,this._innerRadiusByPixel+this._innerDarkerRadiusByPixel,Xb.darker(d,20))},_drawArc:function(a,b,c,d,e,f){var g=Math.abs(b-c);a.lineWidth=0,a.fillStyle=f;var h=this._center.x+Math.cos(b)*d,i=this._center.y+Math.sin(-b)*d,j=(this._center.x+Math.cos(b)*e,this._center.y+Math.sin(-b)*e,this._center.x+Math.cos(c)*d),k=this._center.y+Math.sin(-c)*d;this._center.x+Math.cos(c)*e,this._center.y+Math.sin(-c)*e,a.beginPath(),this._clockwise?(a.moveTo(j,k),Xb.drawArc(a,this._center.x,this._center.y,c,g,e,e,!0),a.lineTo(h,i),Xb.drawArc(a,this._center.x,this._center.y,b,-g,d,d,!0),a.closePath()):(a.moveTo(h,i),Xb.drawArc(a,this._center.x,this._center.y,b,g,e,e,!0),a.lineTo(j,k),Xb.drawArc(a,this._center.x,this._center.y,c,-g,d,d,!0),a.closePath()),a.fill()},getScaleTextPosition:function(a,b,c,d,e){a=(a%360+360)%360;var f={x:b,y:c};return 0==a&&(f=this._scaleInside?{x:b-d/2,y:c}:{x:b+d/2,y:c}),180==a&&(f=this._scaleInside?{x:b+d/2,y:c}:{x:b-d/2,y:c}),90==a&&(f=this._scaleInside?{x:b,y:c+e/2}:{x:b,y:c-e/2}),270==a&&(f=this._scaleInside?{x:b,y:c-e/2}:{x:b,y:c+e/2}),a>270&&360>a&&(f=this._scaleInside?{x:b-d/2,y:c-e/2}:{x:b+d/2,y:c+e/2}),a>180&&270>a&&(f=this._scaleInside?{x:b+d/2,y:c-e/2}:{x:b-d/2,y:c+e/2}),a>90&&180>a&&(f=this._scaleInside?{x:b+d/2,y:c+e/2}:{x:b-d/2,y:c-e/2}),a>0&&90>a&&(f=this._scaleInside?{x:b-d/2,y:c+e/2}:{x:b+d/2,y:c-e/2}),f}}),Ib.charts.RadarChart=function(a){Ib.charts.RadarChart.superClass.constructor.apply(this,arguments),this._selectTolerance=2},Jb.ext("twaver.charts.RadarChart",Ib.charts.ChartBase,{__accessor:["axisTextVisible","axisTextFont","axisTextColor","scaleTextVisible","scaleTextFont","scaleTextColor","axisVisible","axisLineColor","axisLineWidth","axisStartAngle","ringVisible","ringType","ringLineColor","ringLineWidth","scaleCount","scaleMaxValue","scaleMinValue","anchorVisible","areaFillAlpha","areaSelectFillAlpha","axisList"],__bool:["areaFill"],_axisTextVisible:Ed.RADARCHART_AXIS_TEXT_VISIBLE,_axisTextFont:Ed.RADARCHART_AXIS_TEXT_FONT,_axisTextColor:Ed.RADARCHART_AXIS_TEXT_COLOR,_scaleTextVisible:Ed.RADARCHART_SCALE_TEXT_VISIBLE,_scaleTextFont:Ed.RADARCHART_SCALE_TEXT_FONT,_scaleTextColor:Ed.RADARCHART_SCALE_TEXT_COLOR,_axisVisible:Ed.RADARCHART_AXIS_VISIBLE,_axisLineColor:Ed.RADARCHART_AXIS_LINE_COLOR,_axisLineWidth:Ed.RADARCHART_AXIS_LINE_WIDTH,_axisStartAngle:Ed.RADARCHART_AXIS_START_ANGLE,_ringVisible:Ed.RADARCHART_RING_VISIBLE,_ringType:Ed.RADARCHART_RING_TYPE,_ringLineColor:Ed.RADARCHART_RING_LINE_COLOR,_ringLineWidth:Ed.RADARCHART_RING_LINE_WIDTH,_scaleCount:Ed.RADARCHART_SCALE_COUNT,_scaleMaxValue:Ed.RADARCHART_SCALE_MAXVALUE,_scaleMinValue:Ed.RADARCHART_SCALE_MINVALUE,_anchorVisible:Ed.RADARCHART_ANCHOR_VISIBLE,_areaFill:Ed.RADARCHART_AREA_FILL,_areaFillAlpha:Ed.RADARCHART_AREA_FILL_ALPHA,_areaSelectFillAlpha:Ed.RADARCHART_AREA_SELECT_FILL_ALPHA,getAxisCount:function(){return this._axisCount},formatScaleText:function(a,b){return a.toFixed(2)},getAnchorSize:function(a){return a.getStyle?a.getStyle("chart.marker.size"):Ib.Styles.getStyle("chart.marker.size")},getAnchorShape:function(a){return a.getStyle?a.getStyle("chart.marker.shape"):Ib.Styles.getStyle("chart.marker.shape")},getLineWidth:function(a){return a.getStyle?a.getStyle("chart.line.width"):Ib.Styles.getStyle("chart.line.width")},getValues:function(a){return a.getStyle?a.getStyle("chart.values"):null},tryGetDataAt:function(a,b){if((null==b||0>b)&&(b=this._selectTolerance),a.target&&(a=Wb.getLogicalPoint(this._canvas,arguments[0],1)),!a)return null;if(!this._areaFill){var c=a.x-b,d=a.y-b,e=2*b+1,f=2*b+1;try{for(var g=this._canvas.getContext("2d").getImageData(c,d,e,f).data,h=0,i=g.length;i>h;h+=4)if(255===g[h+3]){var j="rgb("+g[h]+","+g[h+1]+","+g[h+2]+")",k=this._uniqueColors[j];if(k)return k}}catch(l){}return null}if(!this._center)return null;a={x:a.x-this._xTranslate,y:a.y-this._yTranslate};for(var h=this._publishedDatas.size()-1;h>=0;h--){var k=this._publishedDatas.get(h),m=this._map[k.getId()],n=Tb.isPointInPolygon(m.points,a);
if(n)return k}return null},getDataAt:function(){var a,b;if(2===arguments.length)a=arguments[0],b=arguments[1];else if(arguments[0].target){var c=Wb.getLogicalPoint(this._canvas,arguments[0],1);if(!c)return;a=c.x,b=c.y}else a=arguments[0].x,b=arguments[0].y;if(0>a||0>b||a>this._canvasWidth||b>this._canvasHeight)return null;if(!this._areaFill){try{var d=this._canvas.getContext("2d").getImageData(a,b,1,1).data;if(255===d[3]){var e="rgb("+d[0]+","+d[1]+","+d[2]+")",f=this._uniqueColors[e];if(f)return f}}catch(g){}return null}for(var h=this._publishedDatas.size()-1;h>=0;h--){var f=this._publishedDatas.get(h),i=this._map[f.getId()],j=Tb.isPointInPolygon(i.points,{x:a-this._xTranslate,y:b-this._yTranslate});if(j)return f}return null},validateModel:function(){if(this._map={},this._axisTexts=new nd,this._axisMaxValues=new nd,this._axisMinValues=new nd,this._axisRangeValues=new nd,this._axisCount=null==this._axisList?0:this._axisList.size(),0!=this._axisCount){this._averageAngleByRadian=2*Math.PI/this._axisCount,this._averageAngle=360/this._axisCount,this._axisList.forEach(function(a){if("string"==typeof a)this._axisTexts.add(a),this._axisMaxValues.add(this._scaleMaxValue),this._axisMinValues.add(this._scaleMinValue),this._axisRangeValues.add(this._scaleMaxValue-this._scaleMinValue);else{this._axisTexts.add(a.text);var b=isNaN(a.max)?this._scaleMaxValue:a.max,c=isNaN(a.min)?this._scaleMinValue:a.min;this._axisMaxValues.add(b),this._axisMinValues.add(c),this._axisRangeValues.add(b-c)}},this),this._publishedDatas.forEach(function(a){var b=new nd(this.getValues(a)),c={data:a,values:b,proportions:new nd,color:this.getUniqueColor(this.getColor(a),a),anchorShape:this.getAnchorShape(a),anchorSize:this.getAnchorSize(a),lineWidth:this.getLineWidth(a),points:new nd};this.isSelected(a)&&(c.lineWidth+=2),this._map[a.getId()]=c},this);for(var a=0;a<this._axisCount;a++)this._publishedDatas.forEach(function(b){var c=this._map[b.getId()],d=0;if(c.values.size()>a){var e=c.values.get(a),f=this._axisMinValues.get(a),g=this._axisRangeValues.get(a);g>0&&(d=(e-f)/g)}c.proportions.add(d)},this)}},validateDisplay:function(a,b,c){var d={x:this._xGap,y:this._yGap,width:b-2*this._xGap,height:c-2*this._yGap};if(this.drawBackground(a,d),!(d.width<=0||d.height<=0||this._axisCount<3)){var e=0,f=0,g=0,h=null,i=null,j=null,k=null;if(this._axisTextVisible)for(k=new nd,g=0;g<this._axisCount;g++)j=this._axisTexts.get(g),h=this.getTextSize(this._axisTextFont,j),k.add({text:j,size:h}),h.width>e&&(e=h.width),h.height>f&&(f=h.height);var l=d.width/2-e>d.height/2-f?d.height/2-2*f:d.width/2-e,m={x:d.x+d.width/2,y:d.y+d.height/2};this._center={x:m.x+this._xTranslate,y:m.y+this._yTranslate};var n=null;this._scaleTextVisible&&(n=new nd);var o=this._axisStartAngle/180*Math.PI;for(g=0;g<this._axisCount;g++){var p=180*o/Math.PI,q=m.x+Math.cos(o)*l,r=m.y+Math.sin(-o)*l,s=null;n&&(s=new nd,n.add(s)),this._ringVisible&&this._ringLineWidth>0&&(a.lineWidth=this._ringLineWidth,a.strokeStyle=this._ringLineColor);for(var t=1;t<=this._scaleCount;t++){var u=t/this._scaleCount,v=l*u,w=m.x+Math.cos(o)*v,x=m.y+Math.sin(-o)*v;if(this._ringVisible&&this._ringLineWidth>0){var y=m.x+Math.cos(o+this._averageAngleByRadian)*v,z=m.y+Math.sin(-o-this._averageAngleByRadian)*v;"line"==this._ringType?this.drawLine(a,this._ringLineColor,this._ringLineWidth,w,x,y,z):"arc"==this._ringType&&(a.beginPath(),a.moveTo(m.x,m.y),Xb.drawArc(a,m.x,m.y,o,this._averageAngleByRadian,v,v,!0),a.closePath(),a.stroke())}s&&(j=this.formatScaleText(this._axisMinValues.get(g)+this._axisRangeValues.get(g)*u,g),h=this.getTextSize(this._scaleTextFont,j),i=this.getScaleTextPosition(p,w,x,h.width,h.height),s.add({text:j,x:i.x,y:i.y}))}if(this._axisVisible&&this.drawLine(a,this._axisLineColor,this._axisLineWidth,m.x,m.y,q,r),k){var A=k.get(g);i=this.getAxisTextPosition(p,q,r,A.size.width,A.size.height),A.x=i.x,A.y=i.y}o+=this._averageAngleByRadian}this._publishedDatas.forEach(function(b){var c=this._map[b.getId()];c.points.clear();var d=c.anchorSize>0?new nd:null,e=c.proportions;if(a.lineWidth=0,a.globalAlpha=this.isSelected(b)?this._areaSelectFillAlpha:this._areaFillAlpha,this._areaFill&&(a.fillStyle=c.color),this._drawItem(a,e,m,l,d,c),this._areaFill&&a.fill(),a.lineWidth=c.lineWidth,a.strokeStyle=c.color,a.globalAlpha=1,this._drawItem(a,e,m,l),a.lineWidth=0,null!=d&&d.size()>0){var f=c.anchorSize/2;d.forEach(function(b){a.fillStyle=c.color,Xb.drawVector(a,c.anchorShape,null,b.x-f,b.y-f,c.anchorSize,c.anchorSize),a.fill()})}},this),n&&n.forEach(function(b){b.forEach(function(b){Xb.drawText(a,b.text,b,this._scaleTextFont,this._scaleTextColor)},this)},this),k&&k.forEach(function(b){Xb.drawText(a,b.text,b,this._axisTextFont,this._axisTextColor)},this)}},_drawItem:function(a,b,c,d,e,f){var g=this._axisStartAngle/180*Math.PI,h=null;a.beginPath();for(var i=0;i<this._axisCount;i++){var j=b.get(i),k={x:c.x+Math.cos(g)*d*j,y:c.y+Math.sin(-g)*d*j};null==h?a.moveTo(k.x,k.y):a.lineTo(k.x,k.y),null!=e&&this._anchorVisible&&e.add(k),f&&f.points.add(k),0==i&&(h=k),g+=this._averageAngleByRadian}null!=h&&a.lineTo(h.x,h.y),a.closePath(),a.stroke()},getAxisTextPosition:function(a,b,c,d,e){a=(a%360+360)%360;var f={x:b,y:c};return 0==a&&(f={x:b+d/2,y:c}),180==a&&(f={x:b-d/2,y:c}),90==a&&(f={x:b,y:c-e/2}),270==a&&(f={x:b,y:c+e/2}),a>270&&360>a&&(f={x:b+d/2,y:c+e/2}),a>180&&270>a&&(f={x:b-d/2,y:c+e/2}),a>90&&180>a&&(f={x:b-d/2,y:c-e/2}),a>0&&90>a&&(f={x:b+d/2,y:c-e/2}),f},getScaleTextPosition:function(a,b,c,d,e){a=(a%360+360)%360;var f={x:b,y:c};return 0==a&&(f={x:b,y:c+e/2}),180==a&&(f={x:b-d/2,y:c+e/2}),90==a&&(f={x:b+d/2,y:c}),270==a&&(f={x:b+d/2,y:c}),a>270&&360>a&&(f={x:b+d/2,y:c-e/2}),a>180&&270>a&&(f={x:b-d/2,y:c-e/2}),a>90&&180>a&&(f={x:b-d/2,y:c+e/2}),a>0&&90>a&&(f={x:b+d/2,y:c+e/2}),f}}),Ib.charts.LegendPane=function(a){Ib.charts.LegendPane.superClass.constructor.apply(this,arguments),this._divPool=new Ib.Pool("div"),this._iconPool=new Ib.Pool("div"),this._textPool=new Ib.Pool("span"),this._pools.add(this._divPool),this._pools.add(this._iconPool),this._pools.add(this._textPool),this._chart=a,this._chart.addViewListener(this.handleViewChange,this),this._view=Wb.createView("hidden"),this._view.style.verticalAlign="middle",this._legendDiv=Wb.createDiv(),this._legendDiv.style.whiteSpace="nowrap",this._legendDiv.style.verticalAlign="middle",this._legendDiv.style.position="",this._view.appendChild(this._legendDiv),this._hiddenMap={};var b=this;this._chart._internalVisibleFunction=function(a){return!b.isHidden(a)},Qb.isTouchable&&new Ib.charts.LegendPaneTouchInteraction(this),new Ib.charts.LegendPaneInteraction(this)},Jb.ext("twaver.charts.LegendPane",Ib.controls.ControlBase,{__accessor:["iconWidth","iconHeight","iconRadius","rowHeight","orientation","hiddenColor","selectBackgroundColor","selectForegroundColor"],_iconWidth:Ed.LEGENDPANE_ICON_WIDTH,_iconHeight:Ed.LEGENDPANE_ICON_HEIGHT,_iconRadius:Ed.LEGENDPANE_ICON_RADIUS,_rowHeight:Ed.LEGENDPANE_ROW_HEIGHT,_orientation:Ed.LEGENDPANE_ORIENTATION,_hiddenColor:Ed.LEGENDPANE_HIDDEN_COLOR,_selectBackgroundColor:Ed.LEGENDPANE_SELECT_BACKGROUND_COLOR,_selectForegroundColor:Ed.LEGENDPANE_SELECT_FOREGROUND_COLOR,onPropertyChanged:function(a){this.invalidate()},getChart:function(){return this._chart},isHidden:function(a){return null!=this._hiddenMap[a.getId()]},handleViewChange:function(a){"validateEnd"===a.kind&&(this._invalidate=!0,this.validate())},validate:function(){if(this._invalidate){this._invalidate=!1,Wb.release(this._legendDiv),Jb.keys(this._hiddenMap).forEach(function(a){this._chart.getDataBox().containsById(a)||delete this._hiddenMap[a]},this);for(var a=new nd(this._chart.getUnfilteredDatas()),b=0;b<a.size();b++){var c=a.get(b);this._chart.isVisible(c)||this.isHidden(c)||(a.removeAt(b),b--)}var d=a.size(),e=this._view.style,f="horizontal"===this._orientation;for(f?(e.textAlign="center",e.height=this._rowHeight+"px"):(e.textAlign="",e.height=this._rowHeight*d+"px"),e.lineHeight=this._rowHeight-2+"px",b=0;d>b;b++){var c=a.get(b),g=this._divPool.get();g._data=c,g.style.cursor="pointer",g.style.height=this._rowHeight+"px",g.style.display=f?"inline-block":"block",this._legendDiv.appendChild(g),this.renderLegend(g,c),this.onLegendRendered(g,c)}this._pools.forEach(function(a){a.clear()})}},renderLegend:function(a,b){var c=!this.isHidden(b),d=this._chart.isSelected(b),e=this._iconPool.get(),f=e.style;f.display="inline-block",f.verticalAlign="middle",f.marginLeft="4px",f.width=this.getIconWidth()+"px",f.height=this.getIconHeight()+"px",f.backgroundColor=c?this._chart.getColor(b):this.getHiddenColor(),a.appendChild(e);var g=this._textPool.get();f=g.style,f.paddingLeft="2px",f.paddingRight="4px",f.display="inline-block",f.verticalAlign="middle",f.color=c?d?this._selectForegroundColor:"":this.getHiddenColor(),g.innerHTML=this._chart.getName(b),a.appendChild(g),a.style.backgroundColor=c&&d?this._selectBackgroundColor:""},onLegendRendered:function(a,b){}}),Ib.charts.ChartPane=function(a,b,c,d){Ib.charts.ChartPane.superClass.constructor.apply(this,arguments),this.invalidate(),this._chart=a,this._legendPane=new Ib.charts.LegendPane(a),this._titleDiv=Wb.createDiv(),this._titleDiv.style.verticalAlign="middle",this._titleDiv.style.whiteSpace="nowrap",this._view=Wb.createView("hidden"),this._view.appendChild(this._titleDiv),this._view.appendChild(this._legendPane.getView()),this._view.appendChild(this._chart.getView());var e=this;this._legendPane.addPropertyChangeListener(function(a){("rowHeight"===a.property||"orientation"===a.porperty)&&e.invalidate()}),arguments.length>1&&this.setTitle(b),arguments.length>2&&this.setLegendOrientation(c),arguments.length>3&&this.setLegendWidth(d)},Jb.ext("twaver.charts.ChartPane",Ib.controls.ControlBase,{__accessor:["title","titleHorizontalAlign","titleHeight","legendWidth"],_title:null,_titleHeight:Ed.CHARTPANE_TITLE_HEIGHT,_titleHorizontalAlign:Ed.CHARTPANE_TITLE_HORIZONTAL_ALIGN,_legendOrientation:Ed.CHARTPANE_LEGEND_ORIENTATION,_legendWidth:Ed.CHARTPANE_LEGEND_WIDTH,getLegendOrientation:function(){return this._legendOrientation},setLegendOrientation:function(a){if(this._legendOrientation!==a){var b=this._legendOrientation;this._legendOrientation=a,this.firePropertyChange("orientation",b,a),this._adjustLegendOrientation()}},_adjustLegendOrientation:function(){this._legendPane.setOrientation("left"===this._legendOrientation||"right"===this._legendOrientation?"vertical":"horizontal")},onPropertyChanged:function(a){this.invalidate()},getTitleDiv:function(){return this._titleDiv},getChart:function(){return this._chart},getLegendPane:function(){return this._legendPane},validateImpl:function(){this._adjustLegendOrientation();var a,b=this._view.offsetWidth,c=this._view.offsetHeight,d=this._legendPane.getRowHeight();this._title&&""!==this._title?(a=this._titleHeight,this._titleDiv.innerHTML=this._title):(a=0,this._titleDiv.innerHTML=""),this._titleDiv.innerHTML=this._title?this._title:"",this._titleDiv.style.textAlign=this._titleHorizontalAlign,this._titleDiv.style.lineHeight=this._titleHeight-2+"px";var e=this._titleDiv.style;e.left="0px",e.top="0px",e.width=b+"px",e.height=a+"px";var f,g;"bottom"===this._legendOrientation?(f={x:0,y:a,width:b,height:Math.max(c-a-d,0)},g={x:0,y:Math.max(c-d,0),width:b,height:d}):"right"===this._legendOrientation?(f={x:0,y:a,width:Math.max(b-this._legendWidth,0),height:Math.max(c-a,0)},g={x:Math.max(b-this._legendWidth,0),y:a,width:this._legendWidth,height:Math.max(c-a,0)}):"top"===this._legendOrientation?(f={x:0,y:a+d,width:b,height:Math.max(c-a-d,0)},g={x:0,y:a,width:b,height:d}):"left"===this._legendOrientation&&(f={x:this._legendWidth,y:a,width:Math.max(b-this._legendWidth,0),height:Math.max(c-a,0)},g={x:0,y:a,width:this._legendWidth,height:Math.max(c-a,0)}),f&&this._chart.adjustBounds(f),g&&this._legendPane.adjustBounds(g)}}),Ib.charts.ChartInteraction=function(a){this.chart=a,this.canvas=a._canvas;var b=this;this.canvas.addEventListener("mousedown",function(a){0===a.button&&b.handleMouseDown(a),a.preventDefault()},!1);var c=Qb.isFirefox?"DOMMouseScroll":"mousewheel";this.canvas.addEventListener(c,function(a){b.handleMouseWheel(a)},!1)},Jb.ext("twaver.charts.ChartInteraction",Object,{handleMouseDown:function(a){this.chart.isFocusOnClick()&&Ib.Util.setFocus(this.canvas),this.lastPoint=this.chart.getLogicalPoint(a);var b=this.chart.tryGetDataAt(a);2===a.detail&&null==b?this.chart.isDoubleClickToReset()&&(this.chart.zoomReset(!1),this.chart.setXTranslate(0),this.chart.setYTranslate(0)):(this._startLogical=this.lastPoint,this._startClient=Wb.getClientPoint(a),Wb.handle_mousedown(this,a))},handleMouseMove:function(a){if(this.lastPoint){var b={x:this._startLogical.x+a.clientX-this._startClient.x,y:this._startLogical.y+a.clientY-this._startClient.y};!this.startPan&&Tb.getDistance(this.lastPoint,b)>3&&(this.startPan=!0,this.lastPoint=b),this.startPan&&(this.chart.isXTranslateEnabled()&&this.chart.setXTranslate(this.chart.getXTranslate()+b.x-this.lastPoint.x),this.chart.isYTranslateEnabled()&&this.chart.setYTranslate(this.chart.getYTranslate()+b.y-this.lastPoint.y),this.lastPoint=b)}},handleMouseUp:function(a){if(!this.startPan&&1===a.detail){var b=this.chart.tryGetDataAt(a),c=this.chart.getSelectionModel();b?Jb.isCtrlDown(a)?c.contains(b)?c.removeSelection(b):c.appendSelection(b):c.contains(b)||c.setSelection(b):Jb.isCtrlDown(a)||c.clearSelection()}delete this.lastPoint,delete this.startPan,delete this._startClient,delete this._startLogical},handleMouseWheel:function(a){Wb.preventDefault(a);var b=Qb.isFirefox?-a.detail:a.wheelDelta;b>0?(this.chart.isXZoomEnabled()&&this.chart.setXZoom(1.1*this.chart.getXZoom(),!1),this.chart.isYZoomEnabled()&&this.chart.setYZoom(1.1*this.chart.getYZoom(),!1)):0>b&&(this.chart.isXZoomEnabled()&&this.chart.setXZoom(this.chart.getXZoom()/1.1,!1),this.chart.isYZoomEnabled()&&this.chart.setYZoom(this.chart.getYZoom()/1.1,!1))}}),Ib.charts.ChartTouchInteraction=function(a){this.chart=a,this.canvas=a._canvas,Wb.addEventListener("touchstart","handleTouchstart",this.canvas,this)},Jb.ext("twaver.charts.ChartTouchInteraction",Object,{handleTouchstart:function(a){Wb.preventDefault(a),this.chart.isFocusOnClick()&&Ib.Util.setFocus(this.canvas),this.endPoint=this.chart.getLogicalPoint(a),zc.isMultiTouch(a)&&(this.distance=zc.getDistance(a),this.xZoom=this.chart.getXZoom(),this.yZoom=this.chart.getYZoom()),Wb.addEventListener("touchmove","handleTouchmove",this.canvas,this),Wb.addEventListener("touchend","handleTouchend",this.canvas,this)},handleTouchmove:function(a){if(Wb.preventDefault(a),this.endPoint){var b=this.chart.getLogicalPoint(a);if(!this.moved&&Tb.getDistance(this.endPoint,b)>10&&(this.moved=!0,this.lastPoint=b),this.moved)if(zc.isSingleTouch(a))this.endPoint&&(this.chart.isXTranslateEnabled()&&this.chart.setXTranslate(this.chart.getXTranslate()+b.x-this.endPoint.x),this.chart.isYTranslateEnabled()&&this.chart.setYTranslate(this.chart.getYTranslate()+b.y-this.endPoint.y),this.endPoint=b);else if(this.distance){var c=zc.getDistance(a)/this.distance,d=this.xZoom*c,e=this.yZoom*c;this.chart.isXZoomEnabled()&&this.chart.setXZoom(d,!1),this.chart.isYZoomEnabled()&&this.chart.setYZoom(e,!1)}}},handleTouchend:function(a){if(Wb.preventDefault(a),!this.moved){this.endPoint=this.chart.getLogicalPoint(a);var b=this.lastPoint&&this.lastTouchStartTime&&(new Date).getTime()-this.lastTouchStartTime.getTime()<=300&&Math.abs(this.endPoint.x-this.lastPoint.x)<=10&&Math.abs(this.endPoint.y-this.lastPoint.y)<=10;b?(this.lastPoint=null,this.lastTouchStartTime=null):(this.lastPoint=this.endPoint,this.lastTouchStartTime=new Date);var c=this.chart.tryGetDataAt(a);if(b&&null==c)this.chart.isDoubleClickToReset()&&(this.chart.zoomReset(!1),this.chart.setXTranslate(0),this.chart.setYTranslate(0));else{var d=this.chart.getSelectionModel();c?d.contains(c)||d.setSelection(c):d.clearSelection()}}delete this.endPoint,delete this.distance,delete this.xZoom,delete this.yZoom,delete this.moved,Wb.removeEventListener("touchmove",this.canvas,this),Wb.removeEventListener("touchend",this.canvas,this)}}),Ib.charts.ChartMSTouchInteraction=function(a){this.chart=a,this.canvas=a._canvas,this._pointerMap={},this._pointerIdArray=[],Wb.addEventListener("MSPointerDown","handleTouchstart",this.canvas,this),Wb.addEventListener("MSPointerMove","handleTouchmove",this.canvas,this),Wb.addEventListener("MSPointerUp","handleTouchend",this.canvas,this),Wb.addEventListener("MSPointerCancel","handleTouchend",this.canvas,this);var b=Qb.isFirefox?"DOMMouseScroll":"mousewheel";this.canvas.addEventListener(b,function(a){self.handleMouseWheel(a)},!1)},Jb.ext("twaver.charts.ChartMSTouchInteraction",Object,{handleTouchstart:function(a){this.chart.isFocusOnClick()&&Ib.Util.setFocus(this.canvas);var b=this.chart.getLogicalPoint(a);a.isPrimary&&this._pointerIdArray.length>0&&(this._pointerMap={},this._pointerIdArray=[]),!this._pointerMap[a.pointerId]&&b&&(this._pointerIdArray.push(a.pointerId),this._pointerMap[a.pointerId]=a);var c=this.chart.tryGetDataAt(a);if(1==this._pointerIdArray.length&&b){var d=this._startTouchPoint&&this._startTouchTime&&(new Date).getTime()-this._startTouchTime.getTime()<=500&&Tb.getDistance(this._startTouchPoint,b)<=10;d&&null==c?this.chart.isDoubleClickToReset()&&(this.chart.zoomReset(!1),this.chart.setXTranslate(0),this.chart.setYTranslate(0),this._startTouchPoint=null,this._startTouchTime=null,this._startClientPoint=null):(this._startTouchPoint=b,this._startTouchTime=new Date,this._startClientPoint={x:a.clientX,y:a.clientY},Wb.handle_mousedown(this,a))}else 2==this._pointerIdArray.length&&(this.xZoom=this.chart.getXZoom(),this.yZoom=this.chart.getYZoom(),this._distance=this._getDistance())},handleTouchmove:function(a){if(0!=this._pointerIdArray.length&&this._pointerMap[a.pointerId]&&!(Tb.getDistance({x:this._pointerMap[a.pointerId].pageX,y:this._pointerMap[a.pointerId].pageY},{x:a.pageX,y:a.pageY})<=3)&&(this._pointerMap[a.pointerId]=a,2==this._pointerIdArray.length)){var b=this._getDistance()/this._distance,c=this.xZoom*b,d=this.yZoom*b;this.chart.isXZoomEnabled()&&this.chart.setXZoom(c,!1),this.chart.isYZoomEnabled()&&this.chart.setYZoom(d,!1)}},handleTouchend:function(a){var b=this.chart.getLogicalPoint(a);if(1==this._pointerIdArray.length&&b&&!this.moved){var c=this.chart.tryGetDataAt(a),d=this._startTouchPoint&&this._startTouchTime&&(new Date).getTime()-this._startTouchTime.getTime()<=500&&Tb.getDistance(this._startTouchPoint,b)<=10,e=this.chart.getSelectionModel();c&&d?Jb.isCtrlDown(a)?e.contains(c)?e.removeSelection(c):e.appendSelection(c):e.contains(c)||e.setSelection(c):Jb.isCtrlDown(a)||e.clearSelection()}this.moved=!1,this._pointerMap={},this._pointerIdArray=[]},handleMouseWheel:function(a){Wb.preventDefault(a);var b=Qb.isFirefox?-a.detail:a.wheelDelta;b>0?(this.chart.isXZoomEnabled()&&this.chart.setXZoom(1.1*this.chart.getXZoom(),!1),this.chart.isYZoomEnabled()&&this.chart.setYZoom(1.1*this.chart.getYZoom(),!1)):0>b&&(this.chart.isXZoomEnabled()&&this.chart.setXZoom(this.chart.getXZoom()/1.1,!1),this.chart.isYZoomEnabled()&&this.chart.setYZoom(this.chart.getYZoom()/1.1,!1))},handle_mousemove:function(a){if(1==this._pointerIdArray.length&&this._startTouchPoint&&this._startClientPoint){var b={x:this._startTouchPoint.x+(a.clientX-this._startClientPoint.x)/this.chart.getXZoom(),y:this._startTouchPoint.y+(a.clientY-this._startClientPoint.y)/this.chart.getYZoom()};Tb.getDistance(this._startTouchPoint,b)>3&&(this.moved=!0,this.chart.isXTranslateEnabled()&&this.chart.setXTranslate(this.chart.getXTranslate()+b.x-this._startTouchPoint.x),this.chart.isYTranslateEnabled()&&this.chart.setYTranslate(this.chart.getYTranslate()+b.y-this._startTouchPoint.y),this._startClientPoint.x=a.clientX,this._startClientPoint.y=a.clientY)}},handle_mouseup:function(a){this.handleTouchend(a)},_getDistance:function(){return Tb.getDistance({x:this._pointerMap[this._pointerIdArray[0]].pageX,y:this._pointerMap[this._pointerIdArray[0]].pageY},{x:this._pointerMap[this._pointerIdArray[1]].pageX,y:this._pointerMap[this._pointerIdArray[1]].pageY})}}),Ib.charts.LegendPaneInteraction=function(a){this.legendPane=a;var b=this;this.legendPane._legendDiv.addEventListener("mousedown",function(a){b.handleMouseDown(a)},!1)},Jb.ext("twaver.charts.LegendPaneInteraction",Object,{handleMouseDown:function(a){if(0===a.button){var b=a.target._data;b||(b=a.target.parentNode._data),b&&(this.legendPane._hiddenMap[b.getId()]?delete this.legendPane._hiddenMap[b.getId()]:this.legendPane._hiddenMap[b.getId()]=b,this.legendPane._chart.invalidateModel())}}}),Ib.charts.LegendPaneTouchInteraction=function(a){this.legendPane=a,Wb.addEventListener("touchstart","handleTouchstart",this.legendPane._legendDiv,this)},Jb.ext("twaver.charts.LegendPaneTouchInteraction",Object,{handleTouchstart:function(a){Wb.preventDefault(a);var b=a.target._data;b||(b=a.target.parentNode._data),b&&(this.legendPane._hiddenMap[b.getId()]?delete this.legendPane._hiddenMap[b.getId()]:this.legendPane._hiddenMap[b.getId()]=b,this.legendPane._chart.invalidateModel())}}),Ib.network.Network=function(a){Ib.network.Network.superClass.constructor.apply(this,arguments),this._elementUIMap={},this._layerMap={},this._layerList=new nd,this._view=Wb.createView("auto"),this._rootDiv=Wb.createDiv(),this._topDiv=Wb.createDiv(),this._attachmentDiv=Wb.createDiv(),this._layersDiv=Wb.createDiv(),this._bottomDiv=Wb.createDiv(),this._rootDiv.appendChild(this._bottomDiv),this._rootDiv.appendChild(this._layersDiv),this._rootDiv.appendChild(this._attachmentDiv),this._rootDiv.appendChild(this._topDiv),this._view.appendChild(this._rootDiv),this.setElementBox(a?a:new Ib.ElementBox),Qb.isTouchable?Qb.isMSTouchable?this.setMSTouchInteractions():this.setTouchInteractions():this.setDefaultInteractions(!1);var b=this;this._flowLink=function(){if(!(b.isMovingElement()||b.isSelectingElement()||b.isEditingElement()||b._box._layoutMovingElements)){b._flowLinkQuickFinder||(b._flowLinkQuickFinder=new Ib.QuickFinder(b._box,"link.flow","style"));var a=b._flowLinkQuickFinder.find(!0);a.forEach(function(a){a._styleMap["link.flow.offset"]=b.getLinkFlowOffset(a);var c=b.getElementUI(a);c.drawBody()})}},this.setToolTipEnabled(Ed.NETWORK_TOOLTIP_ENABLED),this._view.addEventListener("scroll",function(a){oc.twm(b)}),this.addPropertyChangeListener(function(a){"zoom"===a.property&&oc.twm(b)}),Ib.imageUtil.addEventListener(this.invalidateElementUIs,this)},Jb.ext("twaver.network.Network",Ib.controls.View,{__accessor:["selectMode","makeVisibleOnSelected","movableFunction","editPointSize","editPointFillColor","editPointOutlineWidth","editPointOutlineColor","editLineColor","editLineWidth","resizePointSize","resizePointFillColor","resizePointOutlineWidth","resizePointOutlineColor","resizeLineColor","resizeLineWidth","rotatePointSize","rotatePointFillColor","rotatePointOffset","rotatePointOutlineWidth","rotatePointOutlineColor","rotateScaleFillColor","rotateScaleFontColor","rotateScaleWidth","rotateScaleHeight","selectOutlineColor","selectOutlineWidth","selectFillColor","lazyMoveOutlineColor","lazyMoveOutlineWidth","lazyMoveFillColor","rectSelectFilter","selectionTolerance"],__bool:["doubleClickToUpSubNetwork","doubleClickToSubNetwork","doubleClickToEmptySubNetwork","doubleClickToLinkBundle","doubleClickToGroupExpand","subNetworkAnimate","lazyMoveAnimate","resizeAnimate","noAgentLinkVisible","keyboardRemoveEnabled","keyboardSelectEnabled","sendToTopOnSelected","lazyMoveFill","editingElement","rotatingElement","movingElement","selectingElement","rectSelectEnabled","limitElementInPositiveLocation","showRotateScale","transparentSelectionEnable"],_viewRect:{x:0,y:0,width:0,height:0},_currentSubNetwork:null,_selectMode:Ed.NETWORK_SELECT_MODE,_noAgentLinkVisible:Ed.NETWORK_NO_AGENT_LINK_VISIBLE,_makeVisibleOnSelected:Ed.NETWORK_MAKE_VISIBLE_ON_SELECTED,_keyboardRemoveEnabled:Ed.NETWORK_KEYBOARD_REMOVE_ENABLED,_keyboardSelectEnabled:Ed.NETWORK_KEYBOARD_SELECT_ENABLED,_rectSelectEnabled:Ed.NETWORK_RECT_SELECT_ENABLED,_rectSelectFilter:null,_subNetworkAnimate:Ed.NETWORK_SUBNETWORK_ANIMATE,_transparentSelectable:Ed.NETWORK_TRANSPARENT_SELECTABLE,_removeElementUIOnInvisible:Ed.NETWORK_REMOVE_ELEMENTUI_ON_INVISIBLE,_elementUIFunction:Ed.ELEMENTUI_FUNCTION,_doubleClickToUpSubNetwork:Ed.NETWORK_DOUBLECLICK_TO_UPSUBNETWORK,_doubleClickToSubNetwork:Ed.NETWORK_DOUBLECLICK_TO_SUBNETWORK,_doubleClickToEmptySubNetwork:Ed.NETWORK_DOUBLECLICK_TO_EMPTYSUBNETWORK,_doubleClickToLinkBundle:Ed.NETWORK_DOUBLECLICK_TO_LINKBUNDLE,_doubleClickToGroupExpand:Ed.NETWORK_DOUBLECLICK_TO_GROUPEXPAND,_sendToTopOnSelected:Ed.NETWORK_SENDTOTOP_ON_SELECTED,_selectOutlineColor:Ed.NETWORK_SELECT_OUTLINE_COLOR,_selectOutlineWidth:Ed.NETWORK_SELECT_OUTLINE_WIDTH,_selectFillColor:Ed.NETWORK_SELECT_FILL_COLOR,_lazyMoveOutlineColor:Ed.NETWORK_LAZYMOVE_OUTLINE_COLOR,_lazyMoveOutlineWidth:Ed.NETWORK_LAZYMOVE_OUTLINE_WIDTH,_lazyMoveFillColor:Ed.NETWORK_LAZYMOVE_FILL_COLOR,_lazyMoveFill:Ed.NETWORK_LAZYMOVE_FILL,_lazyMoveAnimate:Ed.NETWORK_LAZYMOVE_ANIMATE,_editPointSize:Ed.NETWORK_EDIT_POINT_SIZE,_editPointFillColor:Ed.NETWORK_EDIT_POINT_FILL_COLOR,_editPointOutlineColor:Ed.NETWORK_EDIT_POINT_OUTLINE_COLOR,_editPointOutlineWidth:Ed.NETWORK_EDIT_POINT_OUTLINE_WIDTH,_editLineColor:Ed.NETWORK_EDIT_LINE_COLOR,_editLineWidth:Ed.NETWORK_EDIT_LINE_WIDTH,_resizePointSize:Ed.NETWORK_RESIZE_POINT_SIZE,_resizePointFillColor:Ed.NETWORK_RESIZE_POINT_FILL_COLOR,_resizePointOutlineColor:Ed.NETWORK_RESIZE_POINT_OUTLINE_COLOR,_resizePointOutlineWidth:Ed.NETWORK_RESIZE_POINT_OUTLINE_WIDTH,_resizeLineColor:Ed.NETWORK_RESIZE_LINE_COLOR,_resizeLineWidth:Ed.NETWORK_RESIZE_LINE_WIDTH,_resizeAnimate:Ed.NETWORK_RESIZE_ANIMATE,_rotatePointSize:Ed.NETWORK_ROTATE_POINT_SIZE,_rotatePointFillColor:Ed.NETWORK_ROTATE_POINT_FILL_COLOR,_rotatePointOffset:Ed.NETWORK_ROTATE_POINT_OFFSET,_rotatePointOutlineWidth:Ed.NETWORK_ROTATE_POINT_OUTLINE_WIDTH,_rotatePointOutlineColor:Ed.NETWORK_ROTATE_POINT_OUTLINE_COLOR,_rotateScaleWidth:Ed.NETWORK_ROTATE_SCALE_WIDTH,_rotateScaleHeight:Ed.NETWORK_ROTATE_SCALE_HEIGHT,_rotateScaleFillColor:Ed.NETWORK_ROTATE_SCALE_FILL_COLOR,_rotateScaleFontColor:Ed.NETWORK_ROTATE_SCALE_FONT_COLOR,_limitElementInPositiveLocation:Ed.NETWORK_LIMIT_ELEMENT_INPOSITIVE_LOCATION,_linkFlowInterval:Ed.NETWORK_LINK_FLOW_INTERVAL,_selectionTolerance:Ed.NETWORK_SELECTION_TOLERANCE,_invalidate:!1,_invalidateElementVisibility:!1,_invalidateElementIndex:!1,_isEditingElement:!1,_isRotatingElement:!1,_isMovingElement:!1,_isSelectingElement:!1,_hasEditInteraction:!1,_showRotateScale:!0,_transparentSelectionEnable:Ib.Defaults.NETWORK_TRANSPARENT_SELECTION_ENABLE,getLabel:function(a){return a.getStyle("network.label")||a.getName()},isToolTipEnabled:function(){return this._toolTipEnabled?!0:!1},setToolTipEnabled:function(a){if(this._toolTipEnabled=a,a){if(!this._toolTipListener){var b=this;this._toolTipListener=function(a){var c=b.getElementAt(a);if(b._preElement!==c)if(b._preElement=c,c){var d=b.getToolTip(c);Bc.showToolTip({x:a.pageX,y:a.pageY},d);var e=Bc.getToolTipDiv();if(e.children.length>0){var f=b._view.getBoundingClientRect(),g=e.getBoundingClientRect();g.width+g.left>f.width+f.left&&(e.style.left=f.width+f.left-g.width+(Ob.documentElement.scrollLeft||Ob.body.scrollLeft)+"px"),g.height+g.top>f.height+f.top&&(e.style.top=f.height+f.top-g.height+(Ob.documentElement.scrollTop||Ob.body.scrollTop)+"px")}}else Bc.hideToolTip()},this._view.addEventListener("mousemove",this._toolTipListener,!0),this.firePropertyChange("toolTipEnabled",!1,!0)}}else this._toolTipListener&&(Bc.hideToolTip(),this._view.removeEventListener("mousemove",this._toolTipListener,!0),delete this._toolTipListener,this.firePropertyChange("toolTipEnabled",!0,!1))},isLinkFlowEnabled:function(){return this._linkFlowEnabled?!0:!1},setLinkFlowEnabled:function(a){a?(this._linkFlowEnabled||(this._linkFlowEnabled=!0,this.firePropertyChange("linkFlowEnabled",!1,!0)),clearInterval(this._linkFlowTimerId),this._linkFlowTimerId=setInterval(this._flowLink,this._linkFlowInterval)):(this._linkFlowEnabled&&(this._linkFlowEnabled=!1,this.firePropertyChange("linkFlowEnabled",!0,!1)),clearInterval(this._linkFlowTimerId),delete this._linkFlowTimerId)},getLinkFlowInterval:function(){return this._linkFlowInterval},setLinkFlowInterval:function(a){var b=this._linkFlowInterval;this._linkFlowInterval=a,this.firePropertyChange("linkFlowInterval",b,a),clearInterval(this._linkFlowTimerId),this.isLinkFlowEnabled()&&(this._linkFlowTimerId=setInterval(this._flowLink,this._linkFlowInterval))},getTopDiv:function(){return this._topDiv},getAttachmentDiv:function(){return this._attachmentDiv},getLayersDiv:function(){return this._layersDiv},getBottomDiv:function(){return this._bottomDiv},validateImpl:function(){if(oc.twm(this),this.__lics__){var a=0,b=null,c=null,d=null,e=this._invalidateElementVisibility;if(this._invalidateElementVisibility&&(this._invalidateElementVisibility=!1,this._removeElementUIOnInvisible&&(this._invalidateElementIndex=!0),this.forEachElementUI(function(e){e.validate();var f=e.getElement();if(e.setVisible(this.isVisible(f)),this._removeElementUIOnInvisible){if(b=this.getLayerDivByElement(f),e.isVisible()){if(e.getView().parentNode!==b)for(b.appendChild(e.getView()),c=e.getAttachments(),a=0;a<c.size();a++)d=c.get(a),d.isShowInAttachmentDiv()&&this._attachmentDiv.appendChild(d.getView())}else if(e.getView().parentNode===b)for(b.removeChild(e.getView()),c=e.getAttachments(),a=0;a<c.size();a++)d=c.get(a),d.isShowInAttachmentDiv()&&this._attachmentDiv.removeChild(d.getView())}else if(!e.getView().parentNode)for(b=this.getLayerDivByElement(f),b.appendChild(e.getView()),c=e.getAttachments(),a=0;a<c.size();a++)d=c.get(a),d.isShowInAttachmentDiv()&&this._attachmentDiv.appendChild(d.getView())},null,this)),this._invalidateElementIndex){this._invalidateElementIndex=!1;var f,g=this;this._box.getLayerBox().forEachByDepthFirst(function(a){var b,c=g._layerMap[a.getId()];g._box.forEachByLayer(function(a){var d=g._elementUIMap[a.getId()];if(d&&d.getView().parentNode===c){b=Wb.insertAfter(d.getView(),b);for(var e=d.getAttachments(),h=0;h<e.size();h++){var i=e.get(h);i.getView().parentNode===g._attachmentDiv&&(f=Wb.insertAfter(i.getView(),f))}}},a)})}if(e&&!this._invalidateElementVisibility){var h;for(var i in this._elementUIMap){var j=this._elementUIMap[i];j.isVisible()&&(h=Tb.unionRect(h,j.getViewRect()))}if(h=h?{x:0,y:0,width:h.x+h.width,height:h.y+h.height}:{x:0,y:0,width:0,height:0},h.x!==this._viewRect.x||h.y!==this._viewRect.y||h.width!==this._viewRect.width||h.height!==this._viewRect.height){var k=this._viewRect;this._viewRect=h,this._rootDiv.style.left="0px",this._rootDiv.style.top="0px",this._rootDiv.style.width=h.width+"px",this._rootDiv.style.height=h.height+"px",this.firePropertyChange("viewRect",k,h)}}}},setInteractions:function(a){var b=this._interactions;b&&b.forEach(function(a){a.tearDown()}),this._interactions=a,a&&a.forEach(function(a){a.setUp()}),this.invalidateSelectedElementUIs(!0),this.firePropertyChange("interactions",b,a)},getInteractions:function(){return this._interactions},upSubNetwork:function(a,b){this._currentSubNetwork&&this.setCurrentSubNetwork(vc.getSubNetwork(this._currentSubNetwork),a,b)},sendToTop:function(a){if(this.isVisible(a)){for(var b=a;this.isVisible(b.getParent())&&(b=b.getParent()););b!==a&&this._box.adjustElementIndex(b),this._box.adjustElementIndex(a)}},invalidateElementIndex:function(){this._invalidateElementIndex||(this._invalidateElementIndex=!0,this.invalidate())},invalidateElementVisibility:function(){this._invalidateElementVisibility||(this._invalidateElementVisibility=!0,this.invalidate())},updateLayers:function(){Wb.clear(this._layersDiv),Wb.clear(this._attachmentDiv),this._layerMap={},this._layerList.clear();var a=this;this._box.getLayerBox().forEachByDepthFirst(function(b){var c=Wb.createDiv();Wb.setVisible(c,b.isVisible()),a._layerMap[b.getId()]=c,a._layersDiv.appendChild(c),a._layerList.add(b)}),this._box.forEach(this.createElementUI,this)},getCurrentSubNetwork:function(){
return this._currentSubNetwork},setCurrentSubNetwork:function(a,b,c){var d=Ib.animate.AnimateManager;if(d.endAnimate(),b){if(this._currentSubNetwork===a)return;if(a&&!this._box.contains(a))throw a+" is not contained in this network's elementBox";d.start(new Ib.animate.AnimateSubNetwork(this,a,c))}else this._setCurrentSubNetwork(a),c&&c()},_setCurrentSubNetwork:function(a){if(this._currentSubNetwork!==a){if(a&&!this._box.contains(a))throw a+" is not contained in this network's elementBox";var b=this._currentSubNetwork;this._currentSubNetwork=a,this.firePropertyChange("currentSubNetwork",b,a),this.invalidateElementVisibility()}},isVisible:function(a){if(!this._box.contains(a))return!1;if(!a.isVisible())return!1;if(this._visibleFunction&&!this._visibleFunction(a))return!1;if(!this._box.getLayerBox().getLayerByElement(a).isVisible())return!1;if(vc.getSubNetwork(a)!==this._currentSubNetwork)return!1;if(a instanceof Ib.Link){if(!this.isNoAgentLinkVisible()){if(!a.getFromAgent()||!a.getToAgent())return!1;if(!this.isVisible(a.getFromAgent())||!this.isVisible(a.getToAgent()))return!1}if(a.getBundleIndex()>0&&a.getBundleCount()>1&&!a.getStyle("link.bundle.expanded"))return!1}else for(var b=a.getParent();b&&!b.ISubNetwork;){if(b instanceof Nd&&(!b.isExpanded()||!this.isVisible(b)))return!1;b=b.getParent()}return a.IDummy?!1:!0},isMovable:function(a){return this._box.contains(a)?a instanceof Ib.Link?!1:this._movableFunction&&!this._movableFunction(a)?!1:this._box.getLayerBox().getLayerByElement(a).isMovable():!1},isEditable:function(a){return this._box.contains(a)?this._editableFunction&&!this._editableFunction(a)?!1:this._box.getLayerBox().getLayerByElement(a).isEditable():!1},isRotatable:function(a){return this._rotatableFunction&&!this._rotatableFunction(a)?!1:!0},getVisibleFunction:function(){return this._visibleFunction},setVisibleFunction:function(a){var b=this._visibleFunction;this._visibleFunction=a,this.firePropertyChange("visibleFunction",b,a),this.invalidateElementVisibility()},getEditableFunction:function(){return this._editableFunction},setEditableFunction:function(a){var b=this._editableFunction;this._editableFunction=a,this.firePropertyChange("editableFunction",b,a),this.invalidateSelectedElementUIs(!0)},getRotatableFunction:function(){return this._rotatableFunction},setRotatableFunction:function(a){var b=this._rotatableFunction;this._rotatableFunction=a,this.firePropertyChange("rotatableFunction",b,a),this.invalidateSelectedElementUIs(!0)},isLinkable:function(a){return null==this._linkableFunction||this._linkableFunction(a)},getLinkableFunction:function(){return this._linkableFunction},setLinkableFunction:function(a){var b=this._linkableFunction;this._linkableFunction=a,this.firePropertyChange("linkableFunction",b,a),this.invalidateSelectedElementUIs(!0)},onShareSelectionModelChanged:function(){this.invalidateElementUIs()},getElementBox:function(){return this._box},setElementBox:function(a){if(!a)throw"ElementBox can not be null";if(this._box!==a){var b=this._box;b&&(b.removeDataBoxChangeListener(this.handleElementBoxChange,this),b.removeDataPropertyChangeListener(this.handleElementPropertyChange,this),b.removePropertyChangeListener(this.handleElementBoxPropertyChange,this),b.removeIndexChangeListener(this.handleIndexChange,this),b.getLayerBox().removeDataBoxChangeListener(this.handleLayerBoxChange,this),b.getLayerBox().removeDataPropertyChangeListener(this.handleLayerPropertyChange,this),b.getLayerBox().removeHierarchyChangeListener(this.handleLayerHierarchyChange,this),this._selectionModel||b.getSelectionModel().removeSelectionChangeListener(this.handleSelectionChange,this)),this._box=a,this._box.addDataBoxChangeListener(this.handleElementBoxChange,this),this._box.addDataPropertyChangeListener(this.handleElementPropertyChange,this),this._box.addPropertyChangeListener(this.handleElementBoxPropertyChange,this),this._box.addIndexChangeListener(this.handleIndexChange,this),this._box.getLayerBox().addDataBoxChangeListener(this.handleLayerBoxChange,this),this._box.getLayerBox().addDataPropertyChangeListener(this.handleLayerPropertyChange,this),this._box.getLayerBox().addHierarchyChangeListener(this.handleLayerHierarchyChange,this),this._flowLinkQuickFinder&&(this._flowLinkQuickFinder.dispose(),this._flowLinkQuickFinder=new Ib.QuickFinder(this._box,"link.flow","style")),this._selectionModel?this._selectionModel._setDataBox(a):this._box.getSelectionModel().addSelectionChangeListener(this.handleSelectionChange,this),this._elementUIMap={},this.updateLayers(),this.invalidateElementVisibility(),this.firePropertyChange("elementBox",b,this._box)}},invalidateElementUI:function(a,b){var c=this.getElementUI(a);c&&c.invalidate(b)},invalidateElementUIs:function(a){for(var b in this._elementUIMap){var c=this._elementUIMap[b];c.invalidate(a)}},invalidateSelectedElementUIs:function(a){this.getSelectionModel().getSelection().forEach(function(b){this.invalidateElementUI(b,a)},this)},getElementUI:function(a){return a?this._elementUIMap[a.getId()]:null},getLayerDivByElement:function(a){var b=this._box.getLayerBox().getLayerByElement(a);return b?this._layerMap[b.getId()]:null},createElementUI:function(a){var b=this._elementUIMap[a.getId()];if(b||(b=this._elementUIFunction(this,a),b&&(this._elementUIMap[a.getId()]=b)),b){var c=this.getLayerDivByElement(a);b.getView().parentNode!==c&&(c.appendChild(b.getView()),b.getAttachments().forEach(function(a){a.isShowInAttachmentDiv()&&a.getView().parentNode!==this._attachmentDiv&&this._attachmentDiv.appendChild(a.getView())},this)),this.invalidateElementIndex()}},invalidateBundleLink:function(a){if(a instanceof Ib.Link&&a._bundleLinks){var b=this._elementUIMap;a._bundleLinks.forEachSiblingLink(function(c){if(c!==a){var d=b[c._id];d&&d.invalidate(!1)}},this)}},handleLayerBoxChange:function(a){this.updateLayers(),this.invalidateElementVisibility()},handleLayerPropertyChange:function(a){var b=a.source;if("visible"===a.property){var c=this._layerMap[b.getId()];Wb.setVisible(c,b.isVisible())}else"editable"===a.property&&this.invalidateSelectedElementUIs(!0);this.invalidateElementVisibility()},handleLayerHierarchyChange:function(a){var b;this._layerList.clear(),this._box.getLayerBox().forEachByDepthFirst(function(a){var c=this._layerMap[a.getId()];b=Wb.insertAfter(c,b),this._layerList.add(a)},null,this),this.invalidateElementVisibility()},handleSelectionChange:function(a){a.datas.forEach(function(b){var c=this.getElementUI(b);c&&c.handleSelectionChange(a)},this),this.invalidateElementVisibility();var b=this.getSelectionModel().getLastData();b&&("append"===a.kind||"set"===a.kind)&&(this.isMakeVisibleOnSelected()&&this.makeVisible(b),this.isSendToTopOnSelected()&&this.sendToTop(b))},makeVisible:function(a){var b=this.getElementUI(a);if(b){var c=vc.getSubNetwork(a);if(c!==this._currentSubNetwork){var d=this;return void this.setCurrentSubNetwork(c,this.isSubNetworkAnimate(),function(){Jb.callLater(d.makeVisible,d,[a])})}for(var e=a;(e=e.getParent())&&e!==c;)e instanceof Nd&&e.setExpanded(!0);var f=b.getUnionBodyBounds();if(f){var g={x:this._view.scrollLeft/this._zoom,y:this._view.scrollTop/this._zoom,width:this._view.clientWidth/this._zoom,height:this._view.clientHeight/this._zoom};Tb.intersects(g,f)||this.isVisible(a)&&Jb.callLater(this.centerByLogicalPoint,this,[f.x+f.width/2,f.y+f.height/2])}}},handleElementBoxChange:function(a){var b=a.data;if("add"===a.kind)this.createElementUI(b),this.invalidateBundleLink(b);else if("remove"===a.kind){var c=this.getElementUI(b);if(c){var d=this._box.getLayerBox().getLayerByElement(b),e=this._layerMap[d.getId()];c.getView().parentNode===e&&e.removeChild(c.getView()),c.dispose(),delete this._elementUIMap[b.getId()]}b===this._currentSubNetwork&&null!=this._currentSubNetwork&&this._setCurrentSubNetwork(null)}else"clear"===a.kind&&(this.forEachElementUI(function(a){a.dispose()}),this._elementUIMap={},this.updateLayers(),null!=this._currentSubNetwork&&this._setCurrentSubNetwork(null));this.invalidateElementVisibility()},handleElementPropertyChange:function(a){var b=a.source,c=this.getElementUI(b);if(c&&(c.handlePropertyChange(a),"layerId"===a.property)){var d=this._box.getLayerBox().getLayerByElement(b),e=this._layerMap[d.getId()];c.getView().parentNode!==e&&(e.appendChild(c.getView()),this.invalidateElementIndex())}this.invalidateBundleLink(b),this.invalidateElementVisibility()},handleElementBoxPropertyChange:function(a){this.invalidateElementVisibility()},handleIndexChange:function(a){this.invalidateElementIndex()},getElementUIFunction:function(){return this._elementUIFunction},setElementUIFunction:function(a){if(!a)throw"ElementUIFunction can not be null";if(this._elementUIFunction!==a){var b=this._elementUIFunction;this._elementUIFunction=a,this.firePropertyChange("elementUIFunction",b,a),this._box.isEmpty()||this.updateLayers()}},getIconsNames:function(a){return a.getStyle("icons.names")},getIconsColors:function(a){return a.getStyle("icons.colors")},getLinkHandlerLabel:function(a){return a.isBundleAgent()?"+("+a.getBundleCount()+")":null},getSelectColor:function(a){return a.getStyle("select.color")},getShadowColor:function(a){var b=a.getStyle("shadow.color");return!b&&this.isSelected(a)&&"shadow"===a.getStyle("select.style")?a.getStyle("select.color"):b},getAlarmLabel:function(a){var b=a.getAlarmState().getHighestNewAlarmSeverity();if(b){var c=a.getAlarmState().getNewAlarmCount(b)+b.nickName;return a.getAlarmState().hasLessSevereNewAlarms()&&(c+="+"),c}return null},isRemoveElementUIOnInvisible:function(){return this._removeElementUIOnInvisible},setRemoveElementUIOnInvisible:function(a){var b=this._removeElementUIOnInvisible;this._removeElementUIOnInvisible=a,this.firePropertyChange("removeElementUIOnInvisible",b,a),this.invalidateElementVisibility()},setDefaultInteractions:function(a,b){var c=[new Ib.network.interaction.SelectInteraction(this),new Ib.network.interaction.MoveInteraction(this,a),new Ib.network.interaction.DefaultInteraction(this)];b&&c.push(new Ib.network.interaction.MoveLinkInteraction(this,a)),this.setInteractions(c)},setPanInteractions:function(){this.setInteractions([new Ib.network.interaction.PanInteraction(this),new Ib.network.interaction.DefaultInteraction(this)])},setEditInteractions:function(a,b){var c=[new Ib.network.interaction.SelectInteraction(this),new Ib.network.interaction.EditInteraction(this,a),new Ib.network.interaction.MoveInteraction(this,a),new Ib.network.interaction.DefaultInteraction(this)];b&&c.push(new Ib.network.interaction.MoveLinkInteraction(this,a)),this.setInteractions(c)},setCreateElementInteractions:function(a){this.setInteractions([new Ib.network.interaction.CreateElementInteraction(this,a),new Ib.network.interaction.DefaultInteraction(this)])},setCreateLinkInteractions:function(a){this.setInteractions([new Ib.network.interaction.CreateLinkInteraction(this,a),new Ib.network.interaction.DefaultInteraction(this)])},setCreateShapeLinkInteractions:function(a){this.setInteractions([new Ib.network.interaction.CreateShapeLinkInteraction(this,a),new Ib.network.interaction.DefaultInteraction(this)])},setCreateShapeNodeInteractions:function(a){this.setInteractions([new Ib.network.interaction.CreateShapeNodeInteraction(this,a),new Ib.network.interaction.DefaultInteraction(this)])},setTouchInteractions:function(){var a=[new Ib.network.interaction.SelectInteraction(this),new Ib.network.interaction.MoveInteraction(this,!1),new Ib.network.interaction.DefaultInteraction(this),new Ib.network.interaction.TouchInteraction(this)];this.setInteractions(a)},setMSTouchInteractions:function(){this.setInteractions([new Ib.network.interaction.MSTouchInteraction(this)])},setMagnifyInteractions:function(){this.setInteractions([new Ib.network.interaction.SelectInteraction(this),new Ib.network.interaction.MoveInteraction(this),new Ib.network.interaction.DefaultInteraction(this),new Ib.network.interaction.MagnifyInteraction(this)])},hasEditInteraction:function(){return this._hasEditInteraction},setHasEditInteraction:function(a){var b=this._hasEditInteraction;this._hasEditInteraction=a,this.firePropertyChange("hasEditInteraction",b,a)},moveSelectedElements:function(a,b,c,d){if(0!==a||0!==b){var e=this.getMovableSelectedElementsRect();null!=e&&(this._limitElementInPositiveLocation&&(e.x+a<0&&(a=-e.x),e.y+b<0&&(b=-e.y)),Ib.Util.moveElements(this.getMovableSelectedElements(),a,b,c,d,this))}},getMovableSelectedElements:function(){return this.getSelectionModel().toSelection(function(a){return this.isMovable(a)},this)},hasMovableSelectedElements:function(){for(var a=this.getSelectionModel().getSelection(),b=0;b<a.size();b++){var c=a.get(b);if(this.isMovable(c))return!0}return!1},getMovableSelectedElementsRect:function(){var a=this.getMovableSelectedElements();if(0===a.size())return null;for(var b=null,c=0,d=a.size();d>c;c++){var e=a.get(c);if(e instanceof Ld){var f=this.getElementUI(e);f&&(b=Tb.unionRect(b,f.getViewRect()))}}return b},getLayerByElement:function(a){return this._box.getLayerBox().getLayerByElement(a)},getPosition:function(a,b,c,d,e){var f,g=b instanceof Ib.network.ElementUI?b:this.getElementUI(b);if(g)if("from"===a||"to"===a){if(g.getFromPosition&&(f="from"===a?g.getFromPosition(d,e):g.getToPosition(d,e)))return{x:f.x-c.width/2,y:f.y-c.height/2}}else f="hotspot"===a?g.getHotSpot():Vb.get(a,g.getBodyRect(),c);if(!f&&b.getRect&&(f=Vb.get(a,b.getRect(),c)),f)return{x:f.x+d,y:f.y+e};throw"position '"+a+"' object '"+b+"'"},getViewRect:function(){return this._viewRect?Jb.clone(this._viewRect):{x:0,y:0,width:0,height:0}},forEachElementUI:function(a,b,c){b?this._box.forEachReverse(function(d){if(this.getLayerByElement(d)===b){var e=this.getElementUI(d);e&&(c?a.call(c,e):a(e))}},this):this._layerList.forEachReverse(function(b){this.forEachElementUI(a,b,c)},this)},findFirstElement:function(a,b){for(var c=this._layerList.size()-1,d=this._box.size()-1,e=c;e>=0;e--)for(var f=this._layerList.get(e),g=d;g>=0;g--){var h=this._box.getDataAt(g);if(this.getLayerByElement(h)===f)if(b){if(a.call(b,h)===!0)return h}else if(a(h)===!0)return h}return null},getElementAt:function(a,b){if(1===arguments.length&&(b=!0),!this.isValidEvent(a))return null;a=this._getPoint(a),a||console.log("null");var c=a.x,d=a.y,e=this._selectionTolerance;if(e&&e>0){var f={x:c,y:d,width:0,height:0};Tb.grow(f,e,e)}return this.findFirstElement(function(a){if(b&&!this.isSelectable(a))return!1;var e=this.getElementUI(a);return e?f?!!e.intersectsTest(f):!!e.hitTest(c,d):!1},this)},_getPoint:function(a){return a?a.target?this.getLogicalPoint(a):a:null},getElementsAtRect:function(a,c,d,e){var f=new nd;return e=e===b?!0:e,this.forEachElementUI(function(b){b.isVisible()&&(!d||d(b._element))&&(e&&this.isSelectable(b._element)||!e)&&(c?b.intersectsTest(a)&&f.add(b._element):Tb.contains(a,b.getViewRect())&&f.add(b._element))},null,this),f},hitTest:function(a){var b=this.getElementAt(a);if(!b)return null;var c=this.getElementUI(b);return c?(a=this._getPoint(a),c.hitTest(a.x,a.y)):null},addElementByInteraction:function(a){a.getParent()||a.setParent(this._currentSubNetwork),this._box.add(a),this.getSelectionModel().setSelection(a),this.fireInteractionEvent({kind:"createElement",element:a})},getLinkFlowStepping:function(a){var b=parseInt(a.getStyle("link.flow.stepping"));return b||(b=Ed.NETWORK_LINK_FLOW_STEPPING),b},getLinkFlowOffset:function(a){var b=a.getStyle("link.flow.offset");return isNaN(b)&&(b=0),b+this.getLinkFlowStepping(a)},toCanvas:function(a,b,c){c||(c=Wb.createCanvas()),c.setAttribute("width",a),c.setAttribute("height",b),c._viewRect?(c._viewRect.width=a,c._viewRect.height=b):c._viewRect={x:0,y:0,width:a,height:b};var d=c.getContext("2d");if(d.clearRect(0,0,a,b),0===this._view.clientWidth||0===this._view.clientHeight)return c;var e=a/this._view.scrollWidth*this._zoom,f=b/this._view.scrollHeight*this._zoom;return d.scale(e,f),Wb.forEach(this._view,function(a){if(("CANVAS"===a.tagName||"IMG"===a.tagName)&&!a._isIgnored){var b=a._viewRect;if(b)try{d.drawImage(a,b.x,b.y,b.width,b.height)}catch(a){}}}),c},toCanvasByRegion:function(a,b,c){c||(c=Wb.createCanvas());var d=a.width*b,e=a.height*b;c.setAttribute("width",d),c.setAttribute("height",e);var f=c.getContext("2d");return f.clearRect(0,0,d,e),0===this._view.clientWidth||0===this._view.clientHeight?c:(f.save(),f.scale(b,b),Wb.forEach(this._view,function(b){if(("CANVAS"===b.tagName||"IMG"===b.tagName)&&!b._isIgnored){var c=b._viewRect;if(c&&Tb.intersects(c,a))try{f.drawImage(b,c.x-a.x,c.y-a.y,c.width,c.height)}catch(b){}}}),f.restore(),c)},getGroupChildrenRects:function(a){var b=new nd;return a.getChildren().forEach(function(a){if(a instanceof Ld){var c=this.getElementUI(a);if(c){var d=c.getViewRect();d&&b.add(d)}}},this),b},getLinkPathFunction:function(){return this._linkPathFunction},setLinkPathFunction:function(a){var b=this._linkPathFunction;this._linkPathFunction=a,this.firePropertyChange("linkPathFunction",b,a),this.invalidateElementUIs()},onClickElement:function(a,b){},onClickBackground:function(a){},onDoubleClickElement:function(a,b){},onDoubleClickBackground:function(a){},onLongClickElement:function(a,b){},onLongClickBackground:function(a){},onMouseMove:function(a,b){},onMouseEnter:function(a,b){},onMouseLeave:function(a,b){},setMovingElement:function(a){if(a!=this._movingElement){var b=this._movingElement;this._movingElement=a,this.firePropertyChange("movingElement",b,a),this._box._undoManager._enabled&&(a?this._box._undoManager.startBatch():this._box._undoManager.endBatch())}},setEditingElement:function(a){if(a!=this._editingElement){var b=this._editingElement;this._editingElement=a,this.firePropertyChange("editingElement",b,a),this._box._undoManager._enabled&&(a?this._box._undoManager.startBatch():this._box._undoManager.endBatch())}},dispose:function(){Ib.imageUtil.removeEventListener(this.invalidateElementUIs,this)}}),Ib.network.Overview=function(a){Ib.network.Overview.superClass.constructor.apply(this,arguments),this._view=Wb.createView(),this._rootDiv=Wb.createDiv(),this._imageCanvas=Wb.createCanvas(),this._imageDiv=Wb.createDiv(),this._maskCanvas=Wb.createCanvas(),this._selectDiv=Wb.createDiv(),this._isNetworkDirty=!1,this._isMaskDirty=!1,Wb.setVisible(this._selectDiv,!1),this._view.appendChild(this._rootDiv),this._rootDiv.appendChild(this._imageDiv),this._rootDiv.appendChild(this._maskCanvas),this._rootDiv.appendChild(this._selectDiv),this._imageDiv.appendChild(this._imageCanvas),this.setNetwork(a),Qb.isTouchable?Qb.isMSTouchable?new Ib.network.OverviewMSTouchInteraction(this):(new Ib.network.OverviewTouchInteraction(this),new Ib.network.OverviewInteraction(this)):new Ib.network.OverviewInteraction(this)},Jb.ext("twaver.network.Overview",Ib.controls.ControlBase,{__accessor:["fillColor","outlineColor","outlineWidth","selectColor","selectWidth","padding","maxPackingWidth","maxPackingHeight"],__bool:["animate"],_fillColor:Ed.OVERVIEW_FILL_COLOR,_outlineColor:Ed.OVERVIEW_OUTLINE_COLOR,_outlineWidth:Ed.OVERVIEW_OUTLINE_WIDTH,_selectColor:Ed.OVERVIEW_SELECT_COLOR,_selectWidth:Ed.OVERVIEW_SELECT_WIDTH,_padding:Ed.OVERVIEW_PADDING,_animate:Ed.OVERVIEW_ANIMATE,_maxPackingWidth:Ed.OVERVIEW_MAX_PACKING_WIDTH,_maxPackingHeight:Ed.OVERVIEW_MAX_PACKING_HEIGHT,getNetwork:function(){return this._network},onPropertyChanged:function(a){this._invalidateMask()},setNetwork:function(a){a!==this._network&&(this._network&&(this._network.removePropertyChangeListener(this._handleNetworkPropertyChange,this),this._network.removeViewListener(this._handleNetworkViewChange,this),Wb.removeEventListener("scroll","_handleScrollChange",this._network.getView(),this)),this._network=a,this._network&&(this._network.addPropertyChangeListener(this._handleNetworkPropertyChange,this),this._network.addViewListener(this._handleNetworkViewChange,this),Wb.addEventListener("scroll","_handleScrollChange",this._network.getView(),this)),this.invalidate())},_handleNetworkPropertyChange:function(a){("zoom"===a.property||"currentSubNetwork"===a.property||"elementBox"===a.property||"dataBox"===a.property)&&this.invalidate()},_handleNetworkViewChange:function(a){"validateEnd"===a.kind&&this.invalidate()},_handleScrollChange:function(){this._invalidateMask()},invalidate:function(a){this._isNetworkDirty&&this._isMaskDirty||(this._isNetworkDirty||(this._isNetworkDirty=!0),this._isMaskDirty||(this._isMaskDirty=!0),Jb.callLater(this.validate,this,null,a))},_invalidateMask:function(){this._isMaskDirty||(this._isMaskDirty=!0,Jb.callLater(this.validate,this,[],100))},validate:function(){if((this._isMaskDirty||this._isNetworkDirty)&&this._network&&(this._maxPackingWidth>0&&this._maxPackingHeight>0||this._view.clientWidth>0&&this._view.clientHeight>0)&&0!==this._network._view.clientWidth&&0!==this._network._view.clientHeight){var a,b=this._maxPackingWidth>0&&this._maxPackingHeight>0;a=b?{x:0,y:0,width:this._maxPackingWidth,height:this._maxPackingHeight}:{x:0,y:0,width:this._view.clientWidth,height:this._view.clientHeight},Tb.grow(a,-this._padding,-this._padding);var c=Math.min(a.width/this._network._view.scrollWidth,a.height/this._network._view.scrollHeight);b&&(Wb.setDiv(this._view,{x:0,y:0,width:this._imageDiv._viewRect.width,height:this._imageDiv._viewRect.height},null,0,null),a.width=this._imageDiv._viewRect.width,a.height=this._imageDiv._viewRect.height);var d=this._network._view.scrollWidth*c,e=this._network._view.scrollHeight*c,f=a.x+(a.width-d)/2,g=a.y+(a.height-e)/2;if(this._isNetworkDirty){var h={x:f,y:g,width:d,height:e};this._network.toCanvas(h.width,h.height,this._imageCanvas),Wb.setDiv(this._imageDiv,h,null,0,null),this._network.getElementBox&&(this._imageDiv.style.backgroundColor=(this._network.getCurrentSubNetwork()||this._network.getElementBox()).getStyle("background.color")||""),this._isNetworkDirty=!1}if(this._isMaskDirty){var i={x:this._network._view.scrollLeft*c,y:this._network._view.scrollTop*c,width:d*this._network._view.clientWidth/this._network._view.scrollWidth,height:e*this._network._view.clientHeight/this._network._view.scrollHeight},j=Wb.setCanvas(this._maskCanvas,f,g,d,e);j.lineWidth=0,j.fillStyle=this._fillColor,j.beginPath(),Xb.drawVector(j,"rectangle",null,f,g,d,e),j.fill(),j.clearRect(f+i.x,g+i.y,i.width,i.height);var k=this._outlineWidth<0?0:this._outlineWidth;j.lineWidth=k,j.strokeStyle=this._outlineColor,j.beginPath(),Xb.drawVector(j,"rectangle",null,f+i.x+k,g+i.y+k,i.width-2*k,i.height-2*k),k>=0&&j.stroke(),this._isMaskDirty=!1}}else this._isNetworkDirty=!1,this._isMaskDirty=!1},getLogicalPoint:function(a){return Wb.getLogicalPoint(this._view,a,1,this._rootDiv)},centerNetwork:function(a,b){var c=this._imageDiv._viewRect;Tb.containsPoint(c,a)&&(this._network.centerByLogicalPoint((a.x-c.x)/c.width*this._network._view.scrollWidth/this._network.getZoom(),(a.y-c.y)/c.height*this._network._view.scrollHeight/this._network.getZoom(),b),this._invalidateMask())}}),Ib.network.OverviewTouchInteraction=function(a){this.overview=a,this.network=a.getNetwork(),this.view=a._view,Wb.addEventListener("touchstart","handleTouchstart",this.view,this)},Jb.ext("twaver.network.OverviewTouchInteraction",Object,{handleTouchstart:function(a){Wb.preventDefault(a),this.clear(),this.endPoint=this.overview.getLogicalPoint(a),zc.isMultiTouch(a)&&(this.distance=zc.getDistance(a),this.zoom=this.network.getZoom()),Wb.addEventListener("touchmove","handleTouchmove",this.view,this),Wb.addEventListener("touchend","handleTouchend",this.view,this)},handleTouchmove:function(a){if(Wb.preventDefault(a),this.moved||(this.moved=!0),this.endPoint=this.overview.getLogicalPoint(a),zc.isSingleTouch(a))this.overview.centerNetwork(this.endPoint,!1);else if(this.distance){var b=zc.getDistance(a)/this.distance;this.network.setZoom(this.zoom*b,!1)}},handleTouchend:function(a){if(!this.moved){this.endPoint=this.overview.getLogicalPoint(a);var b=this.lastPoint&&this.lastTouchStartTime&&(new Date).getTime()-this.lastTouchStartTime.getTime()<=300&&Math.abs(this.endPoint.x-this.lastPoint.x)<=10&&Math.abs(this.endPoint.y-this.lastPoint.y)<=10;b?(this.lastPoint=null,this.lastTouchStartTime=null):(this.lastPoint=this.endPoint,this.lastTouchStartTime=new Date),b?Jb.callLater(this.network.zoomReset,this.network,[this.overview._animate]):this.overview.centerNetwork(this.endPoint,this.overview._animate)}this.clear()},clear:function(){this.endPoint&&(this.endPoint=null,Wb.removeEventListener("touchmove",this.view,this),Wb.removeEventListener("touchend",this.view,this)),this.moved=!1}}),Ib.network.OverviewInteraction=function(a){this.overview=a,this.network=a.getNetwork(),this.view=a._view,Wb.addEventListener("mousedown","handleMousedown",this.view,this)},Jb.ext("twaver.network.OverviewInteraction",Object,{handleMousedown:function(a){0===a.button&&(this.clear(),this.endPoint=this.overview.getLogicalPoint(a),Jb.isCtrlDown(a)&&(this.startPoint=this.endPoint,Wb.setVisible(this.overview._selectDiv,!0)),Wb.addEventListener("mousemove","handleMousemove",this.view,this),Wb.addEventListener("mouseup","handleMouseup",this.view,this))},handleMouseup:function(a){if(this.endPoint=this.overview.getLogicalPoint(a),"detail"in a&&2===a.detail)Jb.callLater(this.network.zoomReset,this.network,[this.overview._animate]);else if(Wb.isVisible(this.overview._selectDiv)&&this.startPoint){var b=this.overview._imageDiv._viewRect,c=this.overview._selectDiv._viewRect.x,d=this.overview._selectDiv._viewRect.y,e=b.width/this.overview._selectDiv._viewRect.width,f=b.height/this.overview._selectDiv._viewRect.height,g=Math.min(e,f),h=this.network._view.scrollWidth/this.network.getZoom()*((c-b.x+this.overview._selectDiv._viewRect.width/2)/b.width),i=this.network._view.scrollHeight/this.network.getZoom()*((d-b.y+this.overview._selectDiv._viewRect.height/2)/b.height);this.network.setZoom(g*Math.min(this.network._view.clientWidth/this.network._view.scrollWidth,this.network._view.clientHeight/this.network._view.scrollHeight)*this.network.getZoom(),!1),Jb.callLater(this.network.centerByLogicalPoint,this.network,[h,i,this.overview._animate]),Wb.setVisible(this.overview._selectDiv,!1),Wb.setDiv(this.overview._selectDiv,{x:0,y:0,width:0,height:0},null,0,null),this.startPoint=null}else this.overview.centerNetwork(this.endPoint,this.overview._animate);this.clear()},handleMousemove:function(a){var b=this.overview.getLogicalPoint(a);if(this.endPoint=b,Wb.isVisible(this.overview._selectDiv)&&this.startPoint){var c=b.x>this.startPoint.x?this.startPoint.x:b.x,d=b.x>this.startPoint.x?this.startPoint.y:b.y;b.x>this.startPoint.x&&b.y<this.startPoint.y&&(d=b.y),b.x<this.startPoint.x&&b.y>this.startPoint.y&&(d=this.startPoint.y);var e=this.overview._imageDiv._viewRect;c<e.x&&(c=e.x),c>e.x+e.width&&(c=e.x+e.width),d<e.y&&(d=e.y),d>e.y+e.height&&(d=e.y+e.height);var f=Math.abs(b.x-this.startPoint.x),g=Math.abs(b.y-this.startPoint.y);c+f>e.x+e.width&&(f=e.x+e.width-c),d+g>e.y+e.height&&(g=e.y+e.height-d),Wb.setDiv(this.overview._selectDiv,{x:c,y:d,width:f,height:g},null,this.overview._selectWidth,this.overview._selectColor)}else this.overview.centerNetwork(b,!1)},clear:function(){this.endPoint&&(this.endPoint=null,Wb.removeEventListener("mousemove",this.view,this),Wb.removeEventListener("mouseup",this.view,this))}}),Ib.network.OverviewMSTouchInteraction=function(a){this.overview=a,this.network=a.getNetwork(),this.view=a._view,this._pointerMap={},this._pointerIdArray=[],Wb.addEventListener("MSPointerDown","handleTouchstart",this.view,this),Wb.addEventListener("MSPointerMove","handleTouchmove",this.view,this),Wb.addEventListener("MSPointerUp","handleTouchend",this.view,this),Wb.addEventListener("MSPointerCancel","handleTouchend",this.view,this)},Jb.ext("twaver.network.OverviewMSTouchInteraction",Object,{handleTouchstart:function(a){Wb.preventDefault(a),a.isPrimary&&this._pointerIdArray.length>0&&(this._pointerMap={},this._pointerIdArray=[]),!this._pointerMap[a.pointerId]&&this.overview.getLogicalPoint(a)&&(this._pointerIdArray.push(a.pointerId),this._pointerMap[a.pointerId]=a),1==this._pointerIdArray.length?(this._startTouchPoint=this.overview.getLogicalPoint(a),this._startTouchTime=new Date):2==this._pointerIdArray.length&&(this._distance=this._getDistance(),this._zoom=this.network.getZoom())},handleTouchmove:function(a){if(0!=this._pointerIdArray.length&&this._pointerMap[a.pointerId]&&!(Tb.getDistance({x:this._pointerMap[a.pointerId].pageX,y:this._pointerMap[a.pointerId].pageY},{x:a.pageX,y:a.pageY})<=10))if(this._pointerMap[a.pointerId]=a,2==this._pointerIdArray.length){var b=this._getDistance()/this._distance;this.network.setZoom(this._zoom*b,!1)}else if(1==this._pointerIdArray.length&&this._startTouchPoint){var c=this.overview.getLogicalPoint(a);if(null==c)return;this._startTouchPoint=c,this.overview.centerNetwork(this._startTouchPoint,!1)}},handleTouchend:function(a){var b=this.overview.getLogicalPoint(a);if(1==this._pointerIdArray.length&&b){var c=this._endTouchPoint&&this._endTouchTime&&(new Date).getTime()-this._endTouchTime.getTime()<=500&&Tb.getDistance(this._endTouchPoint,b)<=10;c?(this._endTouchPoint=null,this._endTouchTime=null):(this._endTouchPoint=b,this._endTouchTime=new Date),c?Jb.callLater(this.network.zoomReset,this.network,[this.overview._animate]):this.overview.centerNetwork(this._endTouchPoint,this.overview._animate)}this._pointerMap={},this._pointerIdArray=[]},_getDistance:function(){return Tb.getDistance({x:this._pointerMap[this._pointerIdArray[0]].pageX,y:this._pointerMap[this._pointerIdArray[0]].pageY},{x:this._pointerMap[this._pointerIdArray[1]].pageX,y:this._pointerMap[this._pointerIdArray[1]].pageY})}}),Ib.network.ElementUI=function(a,b){this._view=Wb.createDiv(),this._bodyView=Wb.createDiv(),this._view.appendChild(this._bodyView),this._network=a,this._element=b,this._attachments=new nd,this._bodyBounds=new nd,this.invalidate(!0)},Jb.ext("twaver.network.ElementUI",Object,{_invalidateFlag:!1,_invalidateAttachmentsFlag:!1,getElement:function(){return this._element},getNetwork:function(){return this._network},getAttachments:function(){return this._attachments},getStyle:function(a){return this._element.getStyle(a)},getFont:function(a){var b=this._element.getStyle(a);return b?b:Ed.FONT},getDyeColor:function(a){return this._innerColor?this._innerColor:this.getStyle(a)},getInnerColor:function(){return this._innerColor},getOuterColor:function(){return this._outerColor},getShadowColor:function(){return this._shadowColor},getLabelAttachment:function(){return this._labelAttachment},getAlarmAttachment:function(){return this._alarmAttachment},getIconsAttachment:function(){return this._iconsAttachment},getEditAttachment:function(){return this._editAttachment},getHotSpot:function(){return this._hotSpot?Jb.clone(this._hotSpot):{x:0,y:0}},setHotSpot:function(a){this._hotSpot=a},getUnionBodyBounds:function(){return Jb.clone(this._unionBodyBounds)},getBodyRect:function(){return this._bodyRect||(this._bodyRect=this.createBodyRect()),Jb.clone(this._bodyRect)},invalidate:function(a){a===b&&(a=!0),a&&(this._invalidateAttachmentsFlag=!0),this._invalidateFlag||(this._bodyRect=null,this._invalidateFlag=!0,this._network.invalidateElementVisibility())},updateMeasure:function(){},validate:function(){if(this._invalidateFlag){this._invalidateAttachmentsFlag&&(this._invalidateAttachmentsFlag=!1,this.checkAttachments()),this._invalidateFlag=!1,this._bodyBounds.clear(),Wb.clear(this._bodyView),this._innerColor=this._network.getInnerColor(this._element),this._outerColor=this._network.getOuterColor(this._element),this._shadowColor=this._network.getShadowColor(this._element),this._shadowXOffset=this._element.getStyle("shadow.xoffset"),this._shadowYOffset=this._element.getStyle("shadow.yoffset"),this._shadowBlur=this._element.getStyle("shadow.blur"),this.updateMeasure();var a=this._element.getStyle("whole.alpha");this._view.style.opacity=a,this._attachments.forEach(function(b){b.updateMeasure();var c=b.getAlpha();b._view.style.opacity=b.isShowInAttachmentDiv()?c*a:c});var b;this._bodyBounds.forEach(function(a){b=Tb.unionRect(b,a)}),this._unionBodyBounds=Jb.clone(b),
this._attachments.forEach(function(a){b=Tb.unionRect(b,a.getViewRect())}),this._viewRect=b}},cleanUp:function(a){for(var b=a.length,c=0;b>c;c++){var d=a[c],e=this[d];e&&!e.parentNode&&(this[d]=null)}},setVisible:function(a){this.isVisible()!==a&&(Wb.setVisible(this._view,a),this._attachments.forEach(function(b){b.isShowInAttachmentDiv()&&Wb.setVisible(b._view,a)}),this.invalidate(!0))},isVisible:function(){return Wb.isVisible(this._view)},checkAttachments:function(){this.checkLabelAttachment(),this.checkAlarmAttachment(),this.checkIconsAttachment(),this.checkEditAttachment()},checkLabelAttachment:function(){var a=this._network.getLabel(this._element);null!=a&&""!==a?this._labelAttachment||(this._labelAttachment=new Ib.network.LabelAttachment(this,Ed.SHOW_LABEL_IN_ATTACHMENT_DIV),this.addAttachment(this._labelAttachment)):this._labelAttachment&&(this.removeAttachment(this._labelAttachment),this._labelAttachment=null)},checkAlarmAttachment:function(){var a=this._network.getAlarmLabel(this._element);null!=a&&""!==a?this._alarmAttachment||(this._alarmAttachment=new Ib.network.AlarmAttachment(this,Ed.SHOW_ALARM_IN_ATTACHMENT_DIV),this.addAttachment(this._alarmAttachment)):this._alarmAttachment&&(this.removeAttachment(this._alarmAttachment),this._alarmAttachment=null)},checkIconsAttachment:function(){var a=this._network.getIconsNames(this._element);a&&a.length>0?this._iconsAttachment||(this._iconsAttachment=new Ib.network.IconsAttachment(this),this.addAttachment(this._iconsAttachment)):this._iconsAttachment&&(this.removeAttachment(this._iconsAttachment),this._iconsAttachment=null)},checkEditAttachment:function(){this.isEditable()&&this._network.hasEditInteraction()&&this._network.isSelected(this._element)&&this._network.isEditable(this._element)?this._editAttachment||(this._editAttachment=new Ib.network.EditAttachment(this),this.addAttachment(this._editAttachment)):this._editAttachment&&(this.removeAttachment(this._editAttachment),this._editAttachment=null)},isEditable:function(){return!0},handlePropertyChange:function(a){this.invalidate(!0)},handleSelectionChange:function(a){this.invalidate(!0)},dispose:function(){this._attachments.forEach(function(a){a.getView().parentNode&&a.getView().parentNode.removeChild(a.getView()),a.dispose()}),this._attachments.clear()},addAttachment:function(a){this._attachments.add(a),a.isShowInAttachmentDiv()?this._network.getAttachmentDiv().appendChild(a.getView()):this._view.appendChild(a.getView()),this.invalidate(!1)},removeAttachment:function(a){this._attachments.remove(a),a.getView().parentNode&&a.getView().parentNode.removeChild(a.getView()),a.dispose(),this.invalidate(!1)},addBodyBounds:function(a){a&&this._bodyBounds.add(a)},addComponent:function(a){this._bodyView.appendChild(a)},getBodyView:function(){return this._bodyView},getView:function(){return this._view},getViewRect:function(){return Jb.clone(this._viewRect)},setShadow:function(a,b,c){var d=a.isShadowable()&&this._shadowColor&&!this._editAttachment;d&&(this._shadowXOffset>0?c.width+=this._shadowXOffset:(c.x+=this._shadowXOffset,c.width+=-this._shadowXOffset),this._shadowYOffset>0?c.height+=this._shadowYOffset:(c.y+=this._shadowYOffset,c.height+=-this._shadowYOffset),Tb.grow(c,this._shadowBlur,this._shadowBlur));var e=Wb.setCanvas(b,c);return d&&(e.shadowOffsetX=this._shadowXOffset,e.shadowOffsetY=this._shadowYOffset,e.shadowBlur=this._shadowBlur,e.shadowColor=this._shadowColor),e},isShadowable:function(){return this._shadowColor&&this._network.isSelected(this._element)&&"shadow"===this._element.getStyle("select.style")?!0:!1},hit:function(a,b){return!1},hitCanvas:function(a,b,c){for(var d=c.length,e=0;d>e;e++){var f=c[e],g=this[f];if(Xb.hit(g,a,b,this._network.getSelectionTolerance()))return!0}return!1},hitComponent:function(a,b,c){for(var d=c.length,e=0;d>e;e++){var f=c[e],g=this[f];if(g&&Tb.containsPoint(g._viewRect,a,b))return!0}return!1},hitTest:function(a,b){if(!this.isVisible()||!Tb.containsPoint(this._viewRect,a,b))return null;var c,d,e=this._attachments.size();for(c=e-1;c>=0;c--)if(d=this._attachments.get(c),d.isShowInAttachmentDiv()&&d.hit(a,b))return d;for(c=e-1;c>=0;c--)if(d=this._attachments.get(c),!d.isShowInAttachmentDiv()&&d.hit(a,b))return d;return Tb.containsPoint(this._unionBodyBounds,a,b)&&this.hit(a,b)?this:null},intersects:function(a){return!1},intersectsComponent:function(a,b){for(var c=b.length,d=0;c>d;d++){var e=b[d],f=this[e];if(f&&Tb.intersects(f._viewRect,a))return!0}return!1},intersectsCanvas:function(a,b){for(var c=b.length,d=0;c>d;d++){var e=b[d],f=this[e];if(Xb.intersects(f,a))return!0}return!1},intersectsTest:function(a){if(!this.isVisible()||!Tb.intersects(this._viewRect,a))return null;var b,c,d=this._attachments.size();for(b=d-1;b>=0;b--)if(c=this._attachments.get(b),c.isShowInAttachmentDiv()&&c.intersects(a))return c;for(b=d-1;b>=0;b--)if(c=this._attachments.get(b),!c.isShowInAttachmentDiv()&&c.intersects(a))return c;return Tb.intersects(this._unionBodyBounds,a)&&this.intersects(a)?this:null}}),Ib.network.Attachment=function(a,b){this._view=Wb.createDiv(),this._ui=a,this._element=this._ui.getElement(),this._network=a.getNetwork(),this._isShowInAttachmentDiv=b===!0,this._isShowInAttachmentDiv&&Wb.setVisible(this._view,a.isVisible())},Jb.ext("twaver.network.Attachment",Object,{getElement:function(){return this._element},getElementUI:function(){return this._ui},getNetwork:function(){return this._network},getStyle:function(a){return this._ui.getStyle(a)},getFont:function(a){return this._ui.getFont(a)},isShowInAttachmentDiv:function(){return this._isShowInAttachmentDiv},getView:function(){return this._view},getViewRect:function(){return Jb.clone(this._viewRect)},getAlpha:function(){return 1},updateMeasure:function(){},dispose:function(){},hit:function(a,b){return Tb.containsPoint(this._viewRect,a,b)},intersects:function(a){return Tb.intersects(this._viewRect,a)}}),Ib.network.BasicAttachment=function(a,b){Ib.network.BasicAttachment.superClass.constructor.call(this,a,b),this._roundRect={x:0,y:0,width:0,height:0},this._contentRect={x:0,y:0,width:0,height:0},this._attachmentCanvas=Wb.createCanvas(),this._view.insertBefore(this._attachmentCanvas,this._view.firstChild)},Jb.ext("twaver.network.BasicAttachment",Ib.network.Attachment,{calculateMeasure:function(){var a=this.getContentWidth(),b=this.getContentHeight(),c=this.getCornerRadius(),d=this.getPointerLength(),e=this.getPointerWidth(),f=this.getPosition(),g=this.getXOffset(),h=this.getYOffset(),i=this._roundRect;i.width=a+2*c,i.height=b;var j;if(d>0){var k=this.getDirection();j=this._network.getPosition(f,this._ui,null,g,h);var l;if("aboveleft"===k)i.y=j.y-d-i.height,i.x=j.x-(i.width-c),l=Math.max(j.x-e,i.x+c/2),this._pointers=[j,{x:j.x,y:j.y-d},{x:l,y:j.y-d}];else if("aboveright"===k)i.y=j.y-d-i.height,i.x=j.x-c,l=Math.min(j.x+e,i.x+i.width-c/2),this._pointers=[j,{x:j.x,y:j.y-d},{x:l,y:j.y-d}];else if("belowleft"===k)i.y=j.y+d,i.x=j.x-(i.width-c),l=Math.max(j.x-e,i.x+c/2),this._pointers=[j,{x:j.x,y:j.y+d},{x:l,y:j.y+d}];else if("belowright"===k)i.y=j.y+d,i.x=j.x-c,l=Math.min(j.x+e,i.x+i.width-c/2),this._pointers=[j,{x:j.x,y:j.y+d},{x:l,y:j.y+d}];else if("leftabove"===k)i.y=j.y+c-i.height,i.x=j.x-d-i.width,l=Math.max(j.y-e,i.y+c/2),this._pointers=[j,{x:j.x-d,y:j.y},{x:j.x-d,y:l}];else if("leftbelow"===k)i.y=j.y-c,i.x=j.x-d-i.width,l=Math.min(j.y+e,i.y+i.height-c/2),this._pointers=[j,{x:j.x-d,y:j.y},{x:j.x-d,y:l}];else if("rightabove"===k)i.y=j.y+c-i.height,i.x=j.x+d,l=Math.max(j.y-e,i.y+c/2),this._pointers=[j,{x:j.x+d,y:j.y},{x:j.x+d,y:l}];else if("rightbelow"===k)i.y=j.y-c,i.x=j.x+d,l=Math.min(j.y+e,i.y+i.height-c/2),this._pointers=[j,{x:j.x+d,y:j.y},{x:j.x+d,y:l}];else if("above"===k)i.y=j.y-d-i.height,i.x=j.x-i.width/2,l=Math.min(a/2,e/2),this._pointers=[j,{x:j.x-l,y:j.y-d},{x:j.x+l,y:j.y-d}];else if("below"===k)i.y=j.y+d,i.x=j.x-i.width/2,l=Math.min(a/2,e/2),this._pointers=[j,{x:j.x-l,y:j.y+d},{x:j.x+l,y:j.y+d}];else if("left"===k)i.y=j.y-i.height/2,i.x=j.x-d-i.width,l=Math.min(b/2,e/2),this._pointers=[j,{x:j.x-d,y:j.y+l},{x:j.x-d,y:j.y-l}];else{if("right"!==k)throw"Can not resolve '"+k+"' attachment direction";i.y=j.y-i.height/2,i.x=j.x+d,l=Math.min(b/2,e/2),this._pointers=[j,{x:j.x+d,y:j.y+l},{x:j.x+d,y:j.y-l}]}}else j=this._network.getPosition(f,this._ui,{width:i.width,height:i.height},g,h),i.x=j.x,i.y=j.y,this._pointers=null;this._contentRect.x=i.x+(i.width-a)/2,this._contentRect.y=i.y+(i.height-b)/2,this._contentRect.width=a,this._contentRect.height=b;var m=this.getPadding();0!=m&&Tb.grow(i,m,m),m=this.getPaddingLeft(),0!=m&&(i.x-=m,i.width+=m),m=this.getPaddingRight(),0!=m&&(i.width+=m),m=this.getPaddingTop(),0!=m&&(i.y-=m,i.height+=m),m=this.getPaddingBottom(),0!=m&&(i.height+=m),i.width<0&&(i.width=i.width,i.x-=i.width),i.height<0&&(i.height=-i.height,i.y-=i.height)},updateMeasure:function(){Ib.network.BasicAttachment.superClass.updateMeasure.call(this),this.calculateMeasure();var a=this.isFill(),b=this.getOutlineWidth();this._viewRect=Tb.getRect(this._pointers),this._viewRect=Tb.unionRect(this._viewRect,this._roundRect),b>0&&Tb.grow(this._viewRect,b/2,b/2);var c=this._ui.setShadow(this,this._attachmentCanvas,this._viewRect);if((b>0||a)&&(c.beginPath(),Xb.drawRoundRect(c,this._roundRect.x,this._roundRect.y,this._roundRect.width,this._roundRect.height,this.getCornerRadius()),this._pointers&&(c.moveTo(this._pointers[0].x,this._pointers[0].y),c.lineTo(this._pointers[1].x,this._pointers[1].y),c.lineTo(this._pointers[2].x,this._pointers[2].y)),c.closePath(),b>0&&(c.lineWidth=b,c.strokeStyle=this.getOutlineColor(),c.lineCap=this.getCap(),c.lineJoin=this.getJoin(),c.stroke()),a)){var d=this.getFillColor(),e=this.getGradient();e?Xb.fill(c,d,e,this.getGradientColor(),this._viewRect):c.fillStyle=d,c.fill()}return c},getRoundRect:function(){return Jb.clone(this._roundRect)},getContentRect:function(){return Jb.clone(this._contentRect)},getContent:function(){return this._content},setContent:function(a){this._content!==a&&(this._content&&this._view.removeChild(this._content),this._content=a,a&&this._view.appendChild(a))},getContentWidth:function(){return Ed.ATTACHMENT_CONTENT_WIDTH},getContentHeight:function(){return Ed.ATTACHMENT_CONTENT_HEIGHT},getCornerRadius:function(){return Ed.ATTACHMENT_CORNER_RADIUS},getPointerLength:function(){return Ed.ATTACHMENT_POINTER_LENGTH},getPointerWidth:function(){return Ed.ATTACHMENT_POINTER_WIDTH},getPosition:function(){return Ed.ATTACHMENT_POSITION},getXOffset:function(){return Ed.ATTACHMENT_XOFFSET},getYOffset:function(){return Ed.ATTACHMENT_YOFFSET},getPadding:function(){return Ed.ATTACHMENT_PADDING},getPaddingLeft:function(){return Ed.ATTACHMENT_PADDING_LEFT},getPaddingRight:function(){return Ed.ATTACHMENT_PADDING_RIGHT},getPaddingTop:function(){return Ed.ATTACHMENT_PADDING_TOP},getPaddingBottom:function(){return Ed.ATTACHMENT_PADDING_BOTTOM},getDirection:function(){return Ed.ATTACHMENT_DIRECTION},isFill:function(){return Ed.ATTACHMENT_FILL},getFillColor:function(){return Ed.ATTACHMENT_FILL_COLOR},getGradient:function(){return Ed.ATTACHMENT_GRADIENT},getGradientColor:function(){return Ed.ATTACHMENT_GRADIENT_COLOR},getOutlineWidth:function(){return Ed.ATTACHMENT_OUTLINE_WIDTH},getOutlineColor:function(){return Ed.ATTACHMENT_OUTLINE_COLOR},getCap:function(){return Ed.ATTACHMENT_CAP},getJoin:function(){return Ed.ATTACHMENT_JOIN},isShadowable:function(){return Ed.ATTACHMENT_SHADOWABLE},hit:function(a,b){return Tb.containsPoint(this._viewRect,a,b)?Tb.containsPoint(this._contentRect,a,b)?!0:Xb.hit(this._attachmentCanvas,a,b):!1},intersects:function(a){return Tb.intersects(this._viewRect,a)?Tb.intersects(this._contentRect,a)?!0:Xb.intersects(this._attachmentCanvas,a):!1}}),Ib.network.LabelAttachment=function(a,b){Ib.network.LabelAttachment.superClass.constructor.call(this,a,b)},Jb.ext("twaver.network.LabelAttachment",Ib.network.BasicAttachment,{updateMeasure:function(){var a,b=this.getFont("label.font"),c=this.getLabel(),d=Jb.g.getTextSize(b,c),e=this.getMaxLength();0!==e&&d.width>e?(a=Jb.g.getCollapseTextInLength(b,c,e),this._textSize=Jb.g.getTextSize(b,a)):(a=c,this._textSize=d);var f=Ib.network.LabelAttachment.superClass.updateMeasure.call(this),g=this._element.getStyle("label.align");Xb.drawText(f,a,this._contentRect,b,this.getStyle("label.color"),g)},getLabel:function(){return this._network.getLabel(this._element)},getContentWidth:function(){return this._textSize?this._textSize.width:0},getContentHeight:function(){return this._textSize?this._textSize.height:0},getCornerRadius:function(){return this.getStyle("label.corner.radius")},getPointerLength:function(){return this.getStyle("label.pointer.length")},getPointerWidth:function(){return this.getStyle("label.pointer.width")},getPosition:function(){return this.getStyle("label.position")},getXOffset:function(){return this.getStyle("label.xoffset")},getYOffset:function(){return this.getStyle("label.yoffset")},getPadding:function(){return this.getStyle("label.padding")},getPaddingLeft:function(){return this.getStyle("label.padding.left")},getPaddingRight:function(){return this.getStyle("label.padding.right")},getPaddingTop:function(){return this.getStyle("label.padding.top")},getPaddingBottom:function(){return this.getStyle("label.padding.bottom")},getDirection:function(){return this.getStyle("label.direction")},isFill:function(){return this.getStyle("label.fill")},getFillColor:function(){return this.getStyle("label.fill.color")},getGradient:function(){return this.getStyle("label.gradient")},getGradientColor:function(){return this.getStyle("label.gradient.color")},getOutlineWidth:function(){return this.getStyle("label.outline.width")},getOutlineColor:function(){return this.getStyle("label.outline.color")},getCap:function(){return this.getStyle("label.cap")},getJoin:function(){return this.getStyle("label.join")},getAlpha:function(){return this.getStyle("label.alpha")},getMaxLength:function(){return this.getStyle("label.maxlength")},isShadowable:function(){return this.getStyle("label.shadowable")}}),Ib.network.AlarmAttachment=function(a,b){Ib.network.AlarmAttachment.superClass.constructor.call(this,a,b)},Jb.ext("twaver.network.AlarmAttachment",Ib.network.BasicAttachment,{updateMeasure:function(){var a=this.getFont("alarm.font"),b=this._network.getAlarmLabel(this._element);this._textSize=Xb.getTextSize(a,b),this._fillColor=this._network.getAlarmFillColor(this._element);var c=Ib.network.AlarmAttachment.superClass.updateMeasure.call(this);Xb.drawText(c,b,this._contentRect,a,this.getStyle("alarm.color"))},getContentWidth:function(){return this._textSize?this._textSize.width:0},getContentHeight:function(){return this._textSize?this._textSize.height:0},getCornerRadius:function(){return this.getStyle("alarm.corner.radius")},getPointerLength:function(){return this.getStyle("alarm.pointer.length")},getPointerWidth:function(){return this.getStyle("alarm.pointer.width")},getPosition:function(){return this.getStyle("alarm.position")},getXOffset:function(){return this.getStyle("alarm.xoffset")},getYOffset:function(){return this.getStyle("alarm.yoffset")},getPadding:function(){return this.getStyle("alarm.padding")},getPaddingLeft:function(){return this.getStyle("alarm.padding.left")},getPaddingRight:function(){return this.getStyle("alarm.padding.right")},getPaddingTop:function(){return this.getStyle("alarm.padding.top")},getPaddingBottom:function(){return this.getStyle("alarm.padding.bottom")},getDirection:function(){return this.getStyle("alarm.direction")},isFill:function(){return null!=this._fillColor},getFillColor:function(){return this._fillColor},getGradient:function(){return this.getStyle("alarm.gradient")},getGradientColor:function(){return this.getStyle("alarm.gradient.color")},getOutlineWidth:function(){return this.getStyle("alarm.outline.width")},getOutlineColor:function(){return this.getStyle("alarm.outline.color")},getCap:function(){return this.getStyle("alarm.cap")},getJoin:function(){return this.getStyle("alarm.join")},getAlpha:function(){return this.getStyle("alarm.alpha")},isShadowable:function(){return this.getStyle("alarm.shadowable")}}),Ib.network.LinkHandlerAttachment=function(a,b){Ib.network.LinkHandlerAttachment.superClass.constructor.call(this,a,b)},Jb.ext("twaver.network.LinkHandlerAttachment",Ib.network.BasicAttachment,{updateMeasure:function(){var a=this.getFont("link.handler.font"),b=this._network.getLinkHandlerLabel(this._element);this._textSize=Xb.getTextSize(a,b);var c=Ib.network.LabelAttachment.superClass.updateMeasure.call(this);Xb.drawText(c,b,this._contentRect,a,this.getStyle("link.handler.color"))},getContentWidth:function(){return this._textSize?this._textSize.width:0},getContentHeight:function(){return this._textSize?this._textSize.height:0},getCornerRadius:function(){return this.getStyle("link.handler.corner.radius")},getPointerLength:function(){return this.getStyle("link.handler.pointer.length")},getPointerWidth:function(){return this.getStyle("link.handler.pointer.width")},getPosition:function(){return this.getStyle("link.handler.position")},getXOffset:function(){return this.getStyle("link.handler.xoffset")},getYOffset:function(){return this.getStyle("link.handler.yoffset")},getPadding:function(){return this.getStyle("link.handler.padding")},getPaddingLeft:function(){return this.getStyle("link.handler.padding.left")},getPaddingRight:function(){return this.getStyle("link.handler.padding.right")},getPaddingTop:function(){return this.getStyle("link.handler.padding.top")},getPaddingBottom:function(){return this.getStyle("link.handler.padding.bottom")},getDirection:function(){return this.getStyle("link.handler.direction")},isFill:function(){return this.getStyle("link.handler.fill")},getFillColor:function(){return this.getStyle("link.handler.fill.color")},getGradient:function(){return this.getStyle("link.handler.gradient")},getGradientColor:function(){return this.getStyle("link.handler.gradient.color")},getOutlineWidth:function(){return this.getStyle("link.handler.outline.width")},getOutlineColor:function(){return this.getStyle("link.handler.outline.color")},getCap:function(){return this.getStyle("link.handler.cap")},getJoin:function(){return this.getStyle("link.handler.join")},getAlpha:function(){return this.getStyle("link.handler.alpha")},isShadowable:function(){return this.getStyle("link.handler.shadowable")}}),Ib.network.EditAttachment=function(a,b){Ib.network.EditAttachment.superClass.constructor.call(this,a,b),this._attachmentDiv=Wb.createDiv(),this._view.appendChild(this._attachmentDiv)},Jb.ext("twaver.network.EditAttachment",Ib.network.Attachment,{updateMeasure:function(){Ib.network.EditAttachment.superClass.updateMeasure.call(this),this._viewRect=null,this._element instanceof Ld&&this._addResizingPoint(this._element),!(this._network.isRotatable(this._element)&&this._element instanceof Ld)||this._element instanceof Ib.ShapeNode||this._element instanceof Ib.Grid||this._element instanceof Ib.Group||this._addRotatePoint(this._element),this._element instanceof Ib.ShapeNode&&(this._addResizingPoint(this._element),this._addShapeNodePoint(this._element)),this._ui instanceof Ib.network.ShapeLinkUI&&this._addShapeLinkPoints(this._ui),this._ui instanceof Ib.network.LinkUI&&this._addLinkControlPoint(this._ui)},_addRotatePoint:function(a){var b=this._network.getRotatePointSize();if(!(0>=b)){var c=a.getOriginalRect();if(!this._rotateDiv){var d=Wb.createDiv();this._attachmentDiv.appendChild(d),this._rotateDiv=d}var e,f=this._network.getRotatePointOutlineWidth(),g=this._network.getRotatePointOutlineColor(),h=this._network.getRotatePointFillColor(),b=this._network.getRotatePointSize(),i=2*b,j={x:c.x+c.width/2-b,y:c.y-this._network.getRotatePointOffset()-i,width:i,height:i};e=0==a.angle?j:this._getRotateRect(j,a.getAngle(),{x:c.x+c.width/2,y:c.y+c.height/2});var k=Tb.unionRect(a.getRect(),e);this._viewRect=Tb.unionRect(k,this._viewRect),Wb.setDiv(this._rotateDiv,j,h,f,g),this._rotateDiv._viewRect=e,Wb.setBorderRaidus(this._rotateDiv,i+"px"),this._rotateAttachments(this._rotateDiv,i/2,f)}},_addResizingPoint:function(a){var b=this._network.getResizePointSize();if(!(0>=b)){var c=a.getOriginalRect(),d=new nd([{x:c.x,y:c.y},{x:c.x+c.width/2,y:c.y},{x:c.x+c.width,y:c.y},{x:c.x,y:c.y+c.height/2},{x:c.x+c.width,y:c.y+c.height/2},{x:c.x,y:c.y+c.height},{x:c.x+c.width/2,y:c.y+c.height},{x:c.x+c.width,y:c.y+c.height}]);if(!this._resizeDivs){this._resizeDivs=new Array;for(var e=0;8>e;e++){var f=Wb.createDiv();this._attachmentDiv.appendChild(f),this._resizeDivs[e]=f}}if(this._resizeDivs){this._resizeRects=new Array;for(var e=0;8>e;e++){var g,h=d.get(e),i={x:h.x-b,y:h.y-b,width:2*b,height:2*b};g=0==a.getAngle()?i:this._getRotateRect(i,a.getAngle(),{x:c.x+c.width/2,y:c.y+c.height/2}),this._resizeRects[e]=g}}var j=this._network.getResizePointOutlineWidth(),k=this._network.getResizePointOutlineColor(),l=this._network.getResizePointFillColor();this._addPoints(a.getRect(),d,j,k,l,!0)}},_addPoints:function(a,b,c,d,e,f){var g=f?this._network.getResizePointSize():this._network.getEditPointSize();if(!(0>=g)){var h=g+c;Tb.grow(a,h,h),this._viewRect=Tb.unionRect(a,this._viewRect);var i,j,k,l,m=2*g,n=new nd;for(i=0,j=b.size();j>i;i++)k=b.get(i),l={x:k.x-g,y:k.y-g,width:m,height:m},n.add(l);var o;if(f)o=this._resizeDivs;else{if(this._controlDivs||(this._controlDivs=new Array),this._controlDivs.length<j)for(i=this._controlDivs.length;j>i;i++){var p=Wb.createDiv();this._attachmentDiv.appendChild(p),this._controlDivs[i]=p}else if(this._controlDivs.length>j){for(i=j;i<this._controlDivs.length;i++)this._attachmentDiv.removeChild(this._controlDivs[i]);this._controlDivs.splice(j)}o=this._controlDivs}for(i=0,j=n.size();j>i;i++)l=n.get(i),Wb.setDiv(o[i],l,e,c,d),Wb.setBorderRaidus(o[i],(f?"0":m)+"px"),this._rotateAttachments(o[i],m/2,c,b.get(i))}},_rotateAttachments:function(a,b,c,d){if(this._element instanceof Ld){var e=this._element.getAngle();if(0==e)return;var f=this._element.getOriginalRect(),g=a.style.left.split("px")[0],h=a.style.top.split("px")[0];f.x+f.width/2,f.y+f.height/2,d||(d={x:parseFloat(g)+b+c,y:parseFloat(h)+b+c});var i=Tb.createMatrix(e*Math.PI/180,f.x+f.width/2,f.y+f.height/2),j=i.transform(d);a.style.webkitTransform="rotate("+e+"deg)",a.style.mozTransform="rotate("+e+"deg)",a.style.OTransform="rotate("+e+"deg)",a.style.msTransform="rotate("+e+"deg)",a.style.transform="rotate("+e+"deg)",a.style.left=j.x-b-c+"px",a.style.top=j.y-b-c+"px"}},_addShapeLinkPoints:function(a){this._addEditPoints(a._element.getPoints())},_addShapeNodePoint:function(a){this._addEditPoints(a.getPoints())},_addLinkControlPoint:function(a){if(xc.isOrthogonalLink(a._element)){var b=a.getControlPoint();if(b){var c=new nd;c.add(b),this._addEditPoints(c)}}},_addEditPoints:function(a){var b=Tb.getRect(a);if(b){var c=this._network.getEditPointOutlineWidth(),d=this._network.getEditPointOutlineColor(),e=this._network.getEditPointFillColor();this._addPoints(b,a,c,d,e,!1)}},hit:function(a,b){if(!Tb.containsPoint(this._viewRect,a,b))return!1;var c;if(this._resizeDivs)for(c=this._resizeDivs.length-1;c>=0;c--)if(Tb.containsPoint(this._resizeRects[c],a,b))return!0;if(this._rotateDiv&&Tb.containsPoint(this._rotateDiv._viewRect,a,b))return!0;if(this._controlDivs)for(c=this._controlDivs.length-1;c>=0;c--)if(Tb.containsPoint(this._controlDivs[c]._viewRect,a,b))return!0;return!1},intersects:function(a){if(!Tb.intersects(this._viewRect,a))return!1;var b;if(this._resizeDivs)for(b=this._resizeDivs.length-1;b>=0;b--)if(Tb.intersects(this._resizeRects[b],a))return!0;if(this._rotateDiv&&Tb.containsPoint(this._rotateDiv._viewRect,a))return!0;if(this._controlDivs)for(b=this._controlDivs.length-1;b>=0;b--)if(Tb.intersects(this._controlDivs[b]._viewRect,a))return!0;return Tb.intersects(this._viewRect,a)?!1:!1},_getRotateRect:function(a,b,c){var d=Tb.createMatrix(b*Math.PI/180,c.x,c.y),e={x:a.x+a.width/2,y:a.y+a.height/2},f=d.transform(e),g=new Ib.List([{x:f.x-a.width/2,y:f.y-a.height/2},{x:f.x+a.width/2,y:f.y-a.height/2},{x:f.x+a.width/2,y:f.y+a.height/2},{x:f.x-a.width/2,y:f.y+a.height/2}]);return Tb.getRect(g)}}),Ib.network.IconsAttachment=function(a,b){Ib.network.IconsAttachment.superClass.constructor.call(this,a,b),this._iconsCanvas=null},Jb.ext("twaver.network.IconsAttachment",Ib.network.Attachment,{isShadowable:function(){return Ed.ATTACHMENT_SHADOWABLE},updateMeasure:function(){Ib.network.IconsAttachment.superClass.updateMeasure.call(this);var a=this._network.getIconsNames(this._element);if(a&&0!=a.length){var b=this._network.getIconsColors(this._element),c=this._element.getStyle("icons.orientation"),d=this._element.getStyle("icons.position"),e=this._element.getStyle("icons.xoffset");e=e instanceof Array?e[0]:e;var f=this._element.getStyle("icons.yoffset");f=f instanceof Array?f[0]:f;var g=this._element.getStyle("icons.xgap");g=g instanceof Array?g[0]:g;var h=this._element.getStyle("icons.ygap");h=h instanceof Array?h[0]:h;var i=this._getIconsSize(a,c,g,h);if(i){var j=this._network.getPosition(d,this._ui,i,e,f);this._viewRect={x:j.x,y:j.y,width:i.width,height:i.height},"top"===c?j.y+=i.height:"left"===c&&(j.x+=i.width),this._iconsCanvas||(this._iconsCanvas=Wb.createCanvas(),this._view.appendChild(this._iconsCanvas));var k=this._ui.setShadow(this,this._iconsCanvas,Jb.clone(this._viewRect)),l=j.x,m=j.y,n=0;for(var o in a){var p=null,q=null;b&&b.length>n&&(q=b[n++]);var r=Jb.getImageAsset(a[o]);if(null!=r){if("right"===c)p={x:l,y:m,width:r.getWidth(),height:r.getHeight()},l+=p.width+g;else if("left"===c)p={x:l-r.getWidth(),y:m,width:r.getWidth(),height:r.getHeight()},l-=p.width+g;else if("top"===c)p={x:l,y:m-r.getHeight(),width:r.getWidth(),height:r.getHeight()},m-=p.height+h;else{if("bottom"!==c)throw"Can not resolve '"+c+"' orientation";p={x:l,y:m,width:r.getWidth(),height:r.getHeight()},m+=p.height+h}Nc(k,r.getImage(q,p.width,p.height),q,p,this._element,this._network)}}}}},_getIconsSize:function(a,b,c,d){var e=0,f=0,g=null,h=null,i=null;for(var j in a)if(h=Jb.getImageAsset(a[j])){if("right"===b)g={x:e,y:f,width:h.getWidth(),height:h.getHeight()},e+=g.width+c;else if("left"===b)g={x:e-h.getWidth(),y:f,width:h.getWidth(),height:h.getHeight()},e-=g.width+c;else if("top"===b)g={x:e,y:f-h.getHeight(),width:h.getWidth(),height:h.getHeight()},f-=g.height+d;else{if("bottom"!==b)throw"Can not resolve '"+b+"' orientation";g={x:e,y:f,width:h.getWidth(),height:h.getHeight()},f+=g.height+d}i=null==i?Jb.clone(g):Tb.unionRect(i,g)}return i?{width:Math.abs(i.width),height:Math.abs(i.height)}:null}}),Ib.network.HTMLBasicAttachment=function(a,b){function c(a,b,c,d,e,f,g){c||(c=this._origin.x),d||(d=this._origin.y),e||(e=this._location.x),f||(f=this._location.y),a=a-c-e,b=b-d-f;var h=Ib.Util.transformPoint({x:c+e,y:d+f},g?this._radian:-this._radian,a,b).point;return h}Ib.network.HTMLBasicAttachment.superClass.constructor.call(this,a,b),this._roundRect={x:0,y:0,width:0,height:0},this._contentRect={x:0,y:0,width:0,height:0},this._triangleDiv=Ib.Util.createDiv(),this._roundDiv=Ib.Util.createDiv(),this._contentDiv=Ib.Util.createDiv(),Ib.Util.setCSSStyle(this._triangleDiv,"border-style","solid"),Ib.Util.setCSSStyle(this._contentDiv,"white-space","nowrap");var d=this;this.hit=function(a,b){if(this._radian&&this._origin){var e=c.call(d,a,b);a=e.x,b=e.y}return Ib.Util.containsPoint(this._roundRect,a,b)||Ib.Util.containsPoint(this._pointerRect,a,b)},this.intersects=function(a){var b={x:a.x,y:a.y},e={x:a.x+a.width,y:a.y},f={x:a.x,y:a.y+a.height},g={x:a.x+a.width,y:a.y+a.height};if(this._radian&&this._origin){if(a.width*a.height>50)return!1;b=c.call(d,b.x,b.y),e=c.call(d,e.x,e.y),f=c.call(d,f.x,f.y),g=c.call(d,g.x,g.y)}return a=Ib.Util.getRect([b,e,f,g]),Ib.Util.intersects(this._roundRect,a)||Ib.Util.intersects(this._pointerRect,a)},this.getContentWidth=function(){return this._contentDiv.scrollWidth||parseInt(Ib.Util.getCSSStyle(this._contentDiv.firstChild,"width"))},this.getContentHeight=function(){return this._contentDiv.scrollHeight||parseInt(Ib.Util.getCSSStyle(this._contentDiv.firstChild,"height"))},this._view.appendChild(this._roundDiv),this._roundDiv.appendChild(this._contentDiv)},Ib.Util.ext("twaver.network.HTMLBasicAttachment",Ib.network.BasicAttachment,{calculateMeasure:function(){var a=this.getContentWidth(),b=this.getContentHeight(),c=Math.min(this.getCornerRadius(),b/2),d=this.getPointerLength(),e=this.getPointerWidth(),f=this.getPosition(),g=this.getXOffset(),h=this.getYOffset();this._contentRect.width=a,this._contentRect.height=b,this._contentRect.x=c;var i=this._roundRect;i.width=a+2*c,i.height=b;var j;if(d>0){var k=this.getDirection();if(j=this._network.getPosition(f,this._ui,null,g,h),"aboveleft"===k){i.y=j.y-d-i.height,i.x=j.x-(i.width-c),this._pointers=[j,{x:j.x,y:j.y-d},{x:j.x-Math.min(e,a),y:j.y-d}];var l=d/2,m=Math.min(e,a)/2,n=this.getFillColor();this._triangleBorderWidthStyle=l+"px "+m+"px "+l+"px "+m+"px",this._triangleBorderColorStyle=n+" "+n+" transparent transparent",this._triangleDivLocation=this._pointers[2]}else if("aboveright"===k){i.y=j.y-d-i.height,i.x=j.x-c,this._pointers=[j,{x:j.x,y:j.y-d},{x:j.x+Math.min(e,a),y:j.y-d}];var l=d/2,m=Math.min(e,a)/2,n=this.getFillColor();this._triangleBorderWidthStyle=l+"px "+m+"px "+l+"px "+m+"px",this._triangleBorderColorStyle=n+" transparent transparent "+n,this._triangleDivLocation=this._pointers[1]}else if("belowleft"===k){i.y=j.y+d,i.x=j.x-(i.width-c),this._pointers=[j,{x:j.x,y:j.y+d},{x:j.x-Math.min(e,a),y:j.y+d}];var l=d/2,m=Math.min(e,a)/2,n=this.getFillColor();this._triangleBorderWidthStyle=l+"px "+m+"px "+l+"px "+m+"px",this._triangleBorderColorStyle=" transparent "+n+" "+n+" transparent",this._triangleDivLocation={x:this._pointers[2].x,y:j.y}}else if("belowright"===k){i.y=j.y+d,i.x=j.x-c,this._pointers=[j,{x:j.x,y:j.y+d},{x:j.x+Math.min(e,a),y:j.y+d}];var l=d/2,m=Math.min(e,a)/2,n=this.getFillColor();this._triangleBorderWidthStyle=l+"px "+m+"px "+l+"px "+m+"px",this._triangleBorderColorStyle="transparent transparent "+n+" "+n,this._triangleDivLocation=this._pointers[0]}else if("above"===k){i.y=j.y-d-i.height,i.x=j.x-i.width/2,this._pointers=[j,{x:j.x-Math.min(e,a)/2,y:j.y-d},{x:j.x+Math.min(e,a)/2,y:j.y-d}];var l=d,m=Math.min(e,a)/2,n=this.getFillColor();this._triangleBorderWidthStyle=l+"px "+m+"px 0px "+m+"px",this._triangleBorderColorStyle=n+" transparent transparent transparent",this._triangleDivLocation=this._pointers[1]}else if("below"===k){i.y=j.y+d,i.x=j.x-i.width/2,this._pointers=[j,{x:j.x-Math.min(e,a)/2,y:j.y+d},{x:j.x+Math.min(e,a)/2,y:j.y+d}];var l=d,m=Math.min(e,a)/2,n=this.getFillColor();this._triangleBorderWidthStyle="0px "+m+"px "+l+"px "+m+"px",this._triangleBorderColorStyle="transparent transparent "+n+" transparent ",this._triangleDivLocation={x:this._pointers[1].x,y:j.y}}else if("left"===k){i.y=j.y-i.height/2,i.x=j.x-i.width-d,this._pointers=[j,{x:j.x-d,y:j.y-Math.min(e,b)/2},{x:j.x-d,y:j.y+Math.min(e,b)/2}];var l=Math.min(e,b)/2,m=d,n=this.getFillColor();this._triangleBorderWidthStyle=l+"px 0px "+l+"px "+m+"px",this._triangleBorderColorStyle="transparent transparent  transparent "+n,this._triangleDivLocation=this._pointers[1]}else{if("right"!==k)throw"Can not resolve '"+k+"' attachment direction";i.y=j.y-i.height/2,i.x=j.x+d,this._pointers=[j,{x:j.x+d,y:j.y-Math.min(e,b)/2},{x:j.x+d,y:j.y+Math.min(e,b)/2}];var l=Math.min(e,b)/2,m=d,n=this.getFillColor();this._triangleBorderWidthStyle=l+"px "+m+"px "+l+"px 0px",this._triangleBorderColorStyle="transparent "+n+" transparent  transparent ",this._triangleDivLocation={x:j.x,y:this._pointers[1].y}}}else j=this._network.getPosition(f,this._ui,{width:i.width,height:i.height},g,h),i.x=j.x,i.y=j.y,this._pointers=null;this._location=j},updateMeasure:function(){if(this.calculateMeasure(),this._ui.isShadowable()&&this.isShadowable()?Ib.Util.setCSSStyle(this._roundDiv,"text-shadow",this._ui._shadowXOffset+"px "+this._ui._shadowYOffset+"px "+this._ui._shadowBlur+"px "+this._ui._shadowColor):Ib.Util.removeCSSStyle(this._roundDiv,"text-shadow"),this._pointerRect=Ib.Util.getRect(this._pointers),
this._viewRect=Ib.Util.unionRect(this._pointerRect,this._roundRect),Ib.Util.setCSSStyle(this._contentDiv,"left",this._contentRect.x+"px"),Ib.Util.setCSSStyle(this._contentDiv,"top",this._contentRect.y+"px"),Ib.Util.setCSSStyle(this._roundDiv,"left",this._roundRect.x+"px"),Ib.Util.setCSSStyle(this._roundDiv,"top",this._roundRect.y+"px"),Ib.Util.setCSSStyle(this._roundDiv,"width",this._roundRect.width+"px"),Ib.Util.setCSSStyle(this._roundDiv,"height",this._roundRect.height+"px"),Ib.Util.setCSSStyle(this._roundDiv,"background",this.isFill()?this.getFillColor():null),Ib.Util.setCSSStyle(this._roundDiv,"-webkit-border-radius",this.getCornerRadius()+"px"),Ib.Util.setCSSStyle(this._roundDiv,"-moz-border-radius",this.getCornerRadius()+"px"),Ib.Util.setCSSStyle(this._roundDiv,"border-radius",this.getCornerRadius()+"px"),this._pointers?(Ib.Util.setCSSStyle(this._triangleDiv,"left",this._triangleDivLocation.x+"px"),Ib.Util.setCSSStyle(this._triangleDiv,"top",this._triangleDivLocation.y+"px"),Ib.Util.setCSSStyle(this._triangleDiv,"border-width",this._triangleBorderWidthStyle),Ib.Util.setCSSStyle(this._triangleDiv,"border-color",this._triangleBorderColorStyle),this._view.appendChild(this._triangleDiv)):this._triangleDiv.parentNode==this._view&&this._view.removeChild(this._triangleDiv),this._element.getStyle("label.rotatable")&&this.label){var a=this._ui.getFromPoint(),b=this._ui.getToPoint(),c=this._ui.getLinkPoints();c.size()%2==0&&(a=c.get(c.size()/2-1),b=c.get(c.size()/2)),this._radian=a.x>b.x?Ib.Util.getRadiansBetweenLines(b,a):Ib.Util.getRadiansBetweenLines(a,b),this._origin={x:this._contentRect.width/2,y:0};var d="rotate("+Ib.Util.toDegrees(this._radian)+"deg)",e=this._origin.x+"px "+this._origin.y+"px";Ib.Util.isChrome||Ib.Util.isSafari?(Ib.Util.setCSSStyle(this._roundDiv,"-webkit-transform",d),Ib.Util.setCSSStyle(this._roundDiv,"-webkit-transform-origin",e)):Ib.Util.isIE?(Ib.Util.setCSSStyle(this._roundDiv,"-ms-transform",d),Ib.Util.setCSSStyle(this._roundDiv,"-ms-transform-origin",e)):(Ib.Util.setCSSStyle(this._roundDiv,"transform",d),Ib.Util.setCSSStyle(this._roundDiv,"transform-origin",e))}else Ib.Util.removeCSSStyle(this._roundDiv,"-webkit-transform"),Ib.Util.removeCSSStyle(this._roundDiv,"-webkit-transform-origin"),Ib.Util.removeCSSStyle(this._roundDiv,"-ms-transform"),Ib.Util.removeCSSStyle(this._roundDiv,"-ms-transform-origin"),Ib.Util.removeCSSStyle(this._roundDiv,"transform"),Ib.Util.removeCSSStyle(this._roundDiv,"transform-origin"),delete this._origin,delete this._radian}}),Ib.network.HTMLLabelAttachment=function(a,b){Ib.network.HTMLBasicAttachment.call(this,a,b),this.label=!0},Ib.Util.ext("twaver.network.HTMLLabelAttachment",Ib.network.LabelAttachment,{updateMeasure:function(){var a=this.getFont("label.font"),b=this.getLabel();this._contentDiv.innerHTML=b,Ib.Util.setCSSStyle(this._contentDiv,"font",a),Ib.network.HTMLBasicAttachment.prototype.updateMeasure.call(this),Ib.Util.removeCSSStyle(this._contentDiv,"font")},calculateMeasure:Ib.network.HTMLBasicAttachment.prototype.calculateMeasure}),Ib.network.HTMLAlarmAttachment=function(a,b){Ib.network.HTMLBasicAttachment.call(this,a,b),this.alarm=!0},Ib.Util.ext("twaver.network.HTMLAlarmAttachment",Ib.network.AlarmAttachment,{updateMeasure:function(){var a=this.getFont("alarm.font");this._contentDiv.innerHTML=this._network.getAlarmLabel(this._element),Ib.Util.setCSSStyle(this._contentDiv,"font",a),this._fillColor=this._network.getAlarmFillColor(this._element),Ib.network.HTMLBasicAttachment.prototype.updateMeasure.call(this),Ib.Util.removeCSSStyle(this._contentDiv,"font")},calculateMeasure:Ib.network.HTMLBasicAttachment.prototype.calculateMeasure}),Ib.network.NodeUI=function(a,b){Ib.network.NodeUI.superClass.constructor.call(this,a,b)},Jb.ext("twaver.network.NodeUI",Ib.network.ElementUI,{createBodyRect:function(){return this._element.getRect()},invalidate:function(a){Ib.network.NodeUI.superClass.invalidate.call(this,a);var b=this._element.getAgentLinks();b&&b.forEach(function(a){this._network.invalidateElementUI(a,!1)},this)},updateMeasure:function(){Ib.network.NodeUI.superClass.updateMeasure.call(this);var a=this.getStyle("vector.shape"),b=this.getBodyRect();this._hotSpot=Tb.getHotSpot(b.x,b.y,b.width,b.height,a),this.drawBody(),this._outerColor&&this.drawOuterBorder(),!this._editAttachment&&"border"===this.getStyle("select.style")&&this._network.isSelected(this._element)&&this.drawSelectBorder(),this.cleanUp(["_selectCanvas","_nodeCanvas","_nodeImage","_nodeComponent","_vectorCanvas","_outerCanvas"]);var c=this._element.getParent();c instanceof Nd&&this._network.invalidateElementUI(c,!1)},drawBody:function(){var a=this.getStyle("body.type");"default"===a?this.drawDefaultBody():"vector"===a?this.drawVectorBody():"default.vector"===a?(this.drawVectorBody(),this.drawDefaultBody()):"vector.default"===a?(this.drawDefaultBody(),this.drawVectorBody()):this.addBodyBounds({x:this._element.getX(),y:this._element.getY(),width:0,height:0})},drawOuterBorder:function(){var a=this._element,b=a.getStyle("outer.width");if(b>0){var c=this.getBodyRect();Tb.addPadding(c,a,"outer.padding",1),this._outerCanvas||(this._outerCanvas=Wb.createCanvas());var d=Jb.clone(c);Tb.grow(d,b/2,b/2);var e=Wb.setCanvas(this._outerCanvas,d);e.lineWidth=b,e.lineCap=a.getStyle("outer.cap"),e.lineJoin=a.getStyle("outer.join"),e.strokeStyle=this._outerColor,Xb.drawVector(e,a.getStyle("outer.shape"),null,c),e.stroke(),this.addComponent(this._outerCanvas),this.addBodyBounds(d)}},drawSelectBorder:function(){var a=this._element,b=a.getStyle("select.width");if(b>0){var c=this.getBodyRect();c=Jb.clone(c);var d=a.getStyle("select.physicalZoom")?1:this._network.getGraphicsZoom();Tb.addPadding(c,a,"select.padding",1/d),this._selectCanvas||(this._selectCanvas=Wb.createCanvas()),Tb.grow(c,b/2/d,b/2/d);var e=Wb.setCanvas(this._selectCanvas,bounds);e.lineWidth=b/d,e.lineCap=a.getStyle("select.cap"),e.lineJoin=a.getStyle("select.join"),e.strokeStyle=a.getStyle("select.color"),Xb.drawVector(e,a.getStyle("select.shape"),null,c),e.stroke(),this.addComponent(this._selectCanvas),this.addBodyBounds(bounds)}},drawDefaultBody:function(){var a=this._element,b=Jb.getImageAsset(a.getImage()),c=this.getBodyRect();if(!b)return this.addBodyBounds(c),void(this._currentImageAsset=null);if(Tb.addPadding(c,this._element,"image.padding",1),b.getImage()){this._nodeCanvas||(this._nodeCanvas=Wb.createCanvas());var d=Jb.clone(c),e=this.setShadow(this,this._nodeCanvas,d);0!=a.getAngle()&&(c=a.getOriginalRect(),Ib.Util.rotateCanvas(e,c,a.getAngle())),Nc(e,a.getImage(),this.getInnerColor(),c,a,this._network),c=d,this.addComponent(this._nodeCanvas)}else if(b.getSrc())this._nodeImage||(this._nodeImage=Wb.createImg()),Wb.setImg(this._nodeImage,b.getSrc(),c),this.addComponent(this._nodeImage);else{if(!b.getFunction())throw"ImageAsset '"+a.getImage()+" ' is empty";this._nodeComponent=this._currentImageAsset!==b?b.getFunction()(this,c):b.getFunction()(this,c,this._nodeComponent),this.addComponent(this._nodeComponent),this._nodeComponent._viewRect=Jb.clone(c)}this.addBodyBounds(c),this._currentImageAsset=b},hit:function(a,b){if(this._network._transparentSelectionEnable){var c=this.getBodyRect();if(Jb.math.containsPoint(c,a,b))return!0}return this.hitCanvas(a,b,["_nodeCanvas","_outerCanvas","_vectorCanvas"])?!0:this.hitComponent(a,b,["_nodeImage","_nodeComponent"])},intersects:function(a){if(this._network._transparentSelectionEnable){var b=this.getBodyRect();if(Jb.math.intersects(b,a))return!0}return this.intersectsCanvas(a,["_nodeCanvas","_outerCanvas","_vectorCanvas"])?!0:this.intersectsComponent(a,["_nodeImage","_nodeComponent"])},drawVectorBody:function(){this._vectorCanvas||(this._vectorCanvas=Wb.createCanvas());var a=Xb.drawPath(this,this._vectorCanvas,"vector",!0,this._element.getStyle("vector.outline.pattern")),b=this.getStyle("vector.deep"),c=this._vectorCanvas.getContext("2d"),d=this.getBodyRect(),e=this.getStyle("vector.fill.color");if(0!==b&&e){var f=this._element.getAngle();0!=f&&(d=this._element.getOriginalRect(),Ib.Util.rotateCanvas(c,d,-f),Ib.Util.rotateCanvas(c,d,f)),"rectangle"===this.getStyle("vector.shape")&&Xb.draw3DRect(c,e,b,d)}this.addBodyBounds(a),this.addComponent(this._vectorCanvas)}}),Ib.network.LinkUI=function(a,b){Ib.network.LinkUI.superClass.constructor.call(this,a,b),this._linkCanvas=Wb.createCanvas()},Jb.ext("twaver.network.LinkUI",Ib.network.ElementUI,{isEditable:function(){return xc.isOrthogonalLink(this._element)&&this.getControlPoint()?!0:!1},createBodyRect:function(){var a=this.getHotSpot();return a?{x:a.x-1,y:a.y-1,width:2,height:2}:null},hit:function(a,b){return this.hitCanvas(a,b,["_linkCanvas"])},intersects:function(a){return this.intersectsCanvas(a,["_linkCanvas"])},checkAttachments:function(){Ib.network.LinkUI.superClass.checkAttachments.call(this),this.checkLinkHandlerAttachment()},checkLinkHandlerAttachment:function(){var a=this._network.getLinkHandlerLabel(this._element);null!=a&&""!==a?this._linkHandlerAttachment||(this._linkHandlerAttachment=new Ib.network.LinkHandlerAttachment(this),this.addAttachment(this._linkHandlerAttachment)):this._linkHandlerAttachment&&(this.removeAttachment(this._linkHandlerAttachment),this._linkHandlerAttachment=null)},getLinkHandlerAttachment:function(){return this._linkHandlerAttachment},getLinkPoints:function(){return this._linkPoints||(this._linkPoints=this.createLinkPoints(),this._lineLength=Tb.calculateLineLength(this._linkPoints)),this._linkPoints},invalidate:function(a){this._linkPoints=null,this._fromPoint=null,this._toPoint=null,Ib.network.LinkUI.superClass.invalidate.call(this,a)},getFromPosition:function(a,b){var c=this.getFromPoint();return c?{x:c.x+a,y:c.y+b}:null},getToPosition:function(a,b){var c=this.getToPoint();return c?{x:c.x+a,y:c.y+b}:null},getFromPoint:function(){return this._fromPoint||(this._fromPoint=xc.createFromPoint(this)),this._fromPoint},getToPoint:function(){return this._toPoint||(this._toPoint=xc.createToPoint(this)),this._toPoint},updateMeasure:function(){Ib.network.LinkUI.superClass.updateMeasure.call(this),this.drawBody()},createLinkPoints:function(){var a=this.getFromPoint(),b=this.getToPoint(),c=this.getStyle("link.type"),d=new nd;if(xc.isOrthogonalOrFlexionalLink(this._element))d=xc.orthogonalAndFlexional(this,c);else if(this._element.isLooped()){var e=this._network.getElementUI(this._element.getFromAgent());null!=e&&(this._hotSpot=xc.fillLoopedPoints(this,e.getBodyRect(),d))}else{if("arc"!==c&&"triangle"!==c&&"parallel"!==c)throw"Can not resolve link type '"+c+"'";this._hotSpot=xc.fillBundlePoints(this,c,a,b,d)}if(this._network._linkPathFunction){var f=this._network._linkPathFunction(this,d);f&&(d=f)}return d},drawLinePoints:function(a,b,c,d,e){if(a.lineWidth=c,a.strokeStyle=d,this._element.getStyle("link.flow")===!0&&e&&e.length>1){var f=new uc(a,e[0],e[1]),g=this._element.getStyle("link.flow.offset");this._element.getStyle("link.flow.converse")?g<e[0]?f.overflow=e[0]-g:g>=e[0]&&g<=e[0]+e[1]?(f.overflow=e[1]-(g-e[0]),f.overflow&&(f.isLine=!1)):(g-=e[0]+e[1],f.overflow=e[0]-g):g<=e[1]?(f.overflow=g,g&&(f.isLine=!1)):g>e[1]&&g<=e[0]+e[1]?f.overflow=g-e[1]:(g-=e[0]+e[1],g&&(f.isLine=!1),f.overflow=g),this._element._styleMap["link.flow.offset"]=g,a.beginPath(),Xb._drawLine(b,a),a.stroke(),a.shadowColor="transparent",a.beginPath();var h=this._element.getStyle("link.flow.color");h=h?h:Ed.NETWORK_LINK_FLOW_COLOR,a.strokeStyle=h,Xb._drawLine(b,f),a.stroke(),a.shadowColor=this._shadowColor}else a.beginPath(),Xb.drawLinePoints(a,b,e),a.stroke()},drawBody:function(){var a=this.getLinkPoints();if(a&&!(a.size()<2)){var b=this._element,c=Tb.getLineRect(a),d=b.getStyle("link.width"),e=d;if(this._outerColor){var f=b.getStyle("outer.width");e+=2*f}var g=!this._editAttachment&&"border"===b.getStyle("select.style")&&this._network.isSelected(this._element);if(g){var h=b.getStyle("select.width");e+=2*h}Tb.grow(c,e/2,e/2),b.getStyle("arrow.from")&&(c=Tb.unionRect(c,od.getArrowRect(a,!0,b.getStyle("arrow.from.shape"),b.getStyle("arrow.from.width"),b.getStyle("arrow.from.height"),b.getStyle("arrow.from.xoffset"),b.getStyle("arrow.from.yoffset")))),b.getStyle("arrow.to")&&(c=Tb.unionRect(c,od.getArrowRect(a,!1,b.getStyle("arrow.to.shape"),b.getStyle("arrow.to.width"),b.getStyle("arrow.to.height"),b.getStyle("arrow.to.xoffset"),b.getStyle("arrow.to.yoffset"))));var i=this.setShadow(this,this._linkCanvas,c);i.lineCap=b.getStyle("link.cap"),i.lineJoin=b.getStyle("link.join");var j=b.getStyle("link.pattern");g&&this.drawLinePoints(i,a,e,b.getStyle("select.color"),j),this._outerColor&&this.drawLinePoints(i,a,d+2*f,this._outerColor,j),this.drawLinePoints(i,a,d,this._innerColor||b.getStyle("link.color"),j),this.addBodyBounds(c),this.addComponent(this._linkCanvas),od.drawLinkArrow(this,i,a)}},getControlPoint:function(){return xc.getControlPoint(this._element,this)},setControlPoint:function(a){if(a){var b=this.getStyle("link.type");if(xc.hasControlPoint(b)){var c=xc.getLinkSourceBounds(this),d=xc.getLinkTargetBounds(this);xc.setParamsByControlPoint(a,c,d,b,this._element)}}},getLineLength:function(){return this._lineLength}}),Ib.network.HTMLLinkUI=function(a,b){Ib.network.HTMLLinkUI.superClass.constructor.call(this,a,b)},Jb.ext("twaver.network.HTMLLinkUI",Ib.network.LinkUI,{checkAttachments:function(){Ib.network.LinkUI.prototype.checkAttachments.call(this)},checkLabelAttachment:function(){var a=this._element.getStyle("attachment.label.style");if(a&&"none"===a)return void Ib.network.HTMLLinkUI.superClass.checkLabelAttachment.call(this);var b=this._network.getLabel(this._element);null!=b&&""!==b?this._labelAttachment||(this._labelAttachment=new Ib.network.HTMLLabelAttachment(this),this.addAttachment(this._labelAttachment)):this._labelAttachment&&(this.removeAttachment(this._labelAttachment),this._labelAttachment=null)},checkAlarmAttachment:function(){var a=this._element.getStyle("attachment.alarm.style");if(a&&"none"===a)return void Ib.network.HTMLLinkUI.superClass.checkAlarmAttachment.call(this);var b=this._network.getAlarmLabel(this._element);null!=b&&""!==b?this._alarmAttachment||(this._alarmAttachment=new Ib.network.HTMLAlarmAttachment(this,!1),this.addAttachment(this._alarmAttachment)):this._alarmAttachment&&(this.removeAttachment(this._alarmAttachment),this._alarmAttachment=null)}}),Ib.network.GroupUI=function(a,b){Ib.network.GroupUI.superClass.constructor.call(this,a,b)},Jb.ext("twaver.network.GroupUI",Ib.network.NodeUI,{isEditable:function(){return!this._element.isExpanded()},drawBody:function(){this.getBodyRect(),this._shapeRect?this.drawExpandedGroup():Ib.network.GroupUI.superClass.drawBody.call(this)},drawExpandedGroup:function(){this._nodeCanvas||(this._nodeCanvas=Wb.createCanvas());var a=Xb.drawPath(this,this._nodeCanvas,"group",!1,this._element.getStyle("vector.outline.pattern")),b=this.getStyle("group.deep"),c=this.getStyle("group.fill.color");0!==b&&c&&"rectangle"===this.getStyle("group.shape")&&Xb.draw3DRect(this._nodeCanvas.getContext("2d"),c,b,this._bodyRect),this.addBodyBounds(a),this.addComponent(this._nodeCanvas)},getChildrenRects:function(){return this._network.getGroupChildrenRects(this._element)},createBodyRect:function(){this._shapeRect=null;var a=this._element;if(a.isExpanded()){var b=this.getChildrenRects();if(!b.isEmpty()){var c=a.getStyle("group.shape"),d=Ub[c];if(!d)throw"Can not resolve group shape '"+c+"'";this._shapeRect=d(b)}}return this._shapeRect?(Tb.addPadding(this._shapeRect,a,"group.padding",1),this._shapeRect):Ib.network.GroupUI.superClass.createBodyRect.call(this)}}),Ib.network.GridUI=function(a,b){Ib.network.GridUI.superClass.constructor.call(this,a,b)},Jb.ext("twaver.network.GridUI",Ib.network.NodeUI,{drawDefaultBody:function(){this._element.getImage()?Ib.network.GridUI.superClass.drawDefaultBody.call(this):this.drawGridBody()},drawGridBody:function(){var a=this.getStyle("grid.fill"),b=this.getStyle("grid.deep"),c=this.getStyle("grid.cell.deep");if(a||0!==b||0!==c){var d=this.getBodyRect(),e=this.getDyeColor("grid.fill.color");this._nodeCanvas||(this._nodeCanvas=Wb.createCanvas());var f=Jb.clone(d),g=this.setShadow(this,this._nodeCanvas,f);if(g.rect(d.x,d.y,d.width,d.height),this.addComponent(this._nodeCanvas),a&&(g.fillStyle=e,g.fill()),0!=b&&Xb.draw3DRect(g,e,b,d.x,d.y,d.width,d.height),0!=c)for(var h=this.getStyle("grid.row.count"),i=this.getStyle("grid.column.count"),j=0;h>j;j++)for(var k=0;i>k;k++){var l=this._element.getCellRect(j,k);null!=l&&Xb.draw3DRect(g,e,c,l.x,l.y,l.width,l.height)}this.addBodyBounds(f)}}}),Ib.network.ShapeNodeUI=function(a,b){Ib.network.ShapeNodeUI.superClass.constructor.call(this,a,b)},Jb.ext("twaver.network.ShapeNodeUI",Ib.network.NodeUI,{drawDefaultBody:function(){if(this._element._points.size()<2)return void this.addBodyBounds({x:this._element.getX(),y:this._element.getY(),width:0,height:0});this._nodeCanvas||(this._nodeCanvas=Wb.createCanvas());var a=Xb.drawPath(this,this._nodeCanvas,"vector",!0,this._element.getStyle("vector.outline.pattern"),this._element._points,this._element._segments,this._element.getStyle("shapenode.closed"));this.addBodyBounds(a),this.addComponent(this._nodeCanvas),od.drawLinkArrow(this,this._nodeCanvas.getContext("2d"),Tb.getPointObject(this._element._points,this._element._segments))},drawSelectBorder:function(){var a=this._element,b=a.getStyle("select.width");if(b>0){var c=this.getBodyRect();c=Jb.clone(c);var d=a.getStyle("select.physicalZoom")?1:this._network.getGraphicsZoom();Tb.addPadding(c,a,"select.padding",1/d);var e=a.getStyle("vector.outline.width");e>0&&Tb.grow(c,e/2,e/2),this._selectCanvas||(this._selectCanvas=Wb.createCanvas()),Tb.grow(c,b/2/d,b/2/d);var f=Wb.setCanvas(this._selectCanvas,c);f.lineWidth=b/d,f.lineCap=a.getStyle("select.cap"),f.lineJoin=a.getStyle("select.join"),f.strokeStyle=a.getStyle("select.color"),Xb.drawVector(f,a.getStyle("select.shape"),null,c),f.stroke(),this.addComponent(this._selectCanvas),this.addBodyBounds(bounds)}}}),Ib.network.ShapeLinkUI=function(a,b){Ib.network.ShapeLinkUI.superClass.constructor.call(this,a,b)},Jb.ext("twaver.network.ShapeLinkUI",Ib.network.LinkUI,{isEditable:function(){return!0},createLinkPoints:function(){var a=this.getFromPoint(),b=this.getToPoint(),c=new nd,d=this.getStyle("shapelink.type");c.add(a),null!=this._element._points&&c.addAll(this._element._points),c.add(b);var e=c.size(),f=Math.floor(e/2);if(e%2===0){var g=c.get(f),h=c.get(f-1);this._hotSpot={x:(g.x+h.x)/2,y:(g.y+h.y)/2}}else this._hotSpot=Jb.clone(c.get(f));var i,j,k;if("lineto"===d);else if("quadto"===d){for(i=new nd(c.get(0)),j=1,e=c.size();e>j;j++)i.add(e-1>j?new nd([c.get(j++),c.get(j)]):c.get(j));c=i}else if("cubicto"===d){for(i=new nd(c.get(0)),j=1,e=c.size();e>j;j++)i.add(e-2>j?new nd([c.get(j++),c.get(j++),c.get(j)]):e-1>j?new nd([c.get(j++),c.get(j)]):c.get(j));c=i}else{if("orthogonalto"!==d)throw"Can not resolve shapelink type '"+d+"'";for(k=c.get(0),i=new nd(k),j=1,e=c.size();e>j;j++)if(e-1>j){var l=Jb.clone(c.get(j)),m=l.x,n=l.y,o=m-k.x,p=n-k.y;Math.abs(o)>Math.abs(p)?(l.x=m,l.y=k.y):(l.x=k.x,l.y=n),k=l,i.add(k)}else i.add(c.get(j));c=i}return c}}),Ib.network.RotatableNodeUI=function(a,b){Ib.network.RotatableNodeUI.superClass.constructor.call(this,a,b)},Jb.ext("twaver.network.RotatableNodeUI",Ib.network.NodeUI,{isEditable:function(){return!1},drawDefaultBody:function(){var a=this._element,b=Jb.getImageAsset(a.getImage()),c=this.getBodyRect();if(!b)return this.addBodyBounds(c),void(this._currentImageAsset=null);if(Tb.addPadding(c,this._element,"image.padding",1),b.getImage()){this._nodeCanvas||(this._nodeCanvas=Wb.createCanvas());var d=Jb.clone(c),e=this.setShadow(this,this._nodeCanvas,d),f=this._element._getOrignalWidth(),g=this._element._getOrignalHeight(),h=this._element._getRotateRect();e.save(),e.translate(c.x-h.x+f/2,c.y-h.y+g/2),e.rotate(this._element._angle*Math.PI/180);var c={x:-f/2,y:-g/2,width:f,height:g};Nc(e,b.getImage(this._innerColor,c.width,c.height),this._innerColor,c,a,this._network),e.restore(),this.addComponent(this._nodeCanvas)}else if(b.getSrc());else if(!b.getFunction())throw"ImageAsset '"+a.getImage()+" ' is empty";this.addBodyBounds(c),this._currentImageAsset=b}}),Ib.network.HTMLNodeUI=function(a,b){Ib.network.HTMLNodeUI.superClass.constructor.call(this,a,b)},Ib.Util.ext("twaver.network.HTMLNodeUI",Ib.network.NodeUI,{checkAttachments:function(){Ib.network.NodeUI.prototype.checkAttachments.call(this)},checkLabelAttachment:function(){var a=this._element.getStyle("attachment.label.style");if(a&&"none"===a)return void Ib.network.HTMLNodeUI.superClass.checkLabelAttachment.call(this);var b=this._network.getLabel(this._element);null!=b&&""!==b?this._labelAttachment||(this._labelAttachment=new Ib.network.HTMLLabelAttachment(this,Ed.SHOW_LABEL_IN_ATTACHMENT_DIV),this.addAttachment(this._labelAttachment)):this._labelAttachment&&(this.removeAttachment(this._labelAttachment),this._labelAttachment=null)},checkAlarmAttachment:function(){var a=this._element.getStyle("attachment.alarm.style");if(a&&"none"===a)return void Ib.network.HTMLNodeUI.superClass.checkAlarmAttachment.call(this);var b=this._network.getAlarmLabel(this._element);null!=b&&""!==b?this._alarmAttachment||(this._alarmAttachment=new Ib.network.HTMLAlarmAttachment(this,!1),this.addAttachment(this._alarmAttachment)):this._alarmAttachment&&(this.removeAttachment(this._alarmAttachment),this._alarmAttachment=null)}}),Ib.network.interaction.BaseInteraction=function(a){this.network=a},Jb.ext("twaver.network.interaction.BaseInteraction",Object,{setUp:function(){},tearDown:function(){},addListener:function(){for(var a=0;a<arguments.length;a++){var b=arguments[a];Wb.addEventListener(b,"handle_"+b,this.network.getView(),this)}},removeListener:function(){for(var a=0;a<arguments.length;a++)Wb.removeEventListener(arguments[a],this.network.getView(),this)},_handle_mousedown:function(a){0===a.button&&(this._startLogical=this.network.getLogicalPoint(a),this._startClient=Wb.getClientPoint(a),this._startLogical&&Wb.handle_mousedown(this,a))},_handle_mousemove:function(a){this._endLogical={x:this._startLogical.x+(a.clientX-this._startClient.x)/this.network.getZoom(),y:this._startLogical.y+(a.clientY-this._startClient.y)/this.network.getZoom()}},_handle_mouseup:function(a){delete this._startClient,delete this._startLogical,delete this._endLogical}}),Ib.network.interaction.SelectInteraction=function(a){Ib.network.interaction.SelectInteraction.superClass.constructor.call(this,a)},Jb.ext("twaver.network.interaction.SelectInteraction",Ib.network.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown")},tearDown:function(){this.removeListener("mousedown"),this.end()},handle_mousedown:function(a){if(this._button=a.button,this.network.isValidEvent(a)&&!this.network.isMovingElement()&&!this.network.isEditingElement()&&!a.shiftKey){var b=this.network.getElementAt(a),c=this.network.getSelectionModel();b?Jb.isCtrlDown(a)?c.contains(b)?c.removeSelection(b):c.appendSelection(b):c.contains(b)||c.setSelection(b):(Jb.isCtrlDown(a)||c.clearSelection(),this.end(a),this.network.getLogicalPoint(a)&&this.network.isRectSelectEnabled()&&this._handle_mousedown(a))}},handle_mouseup:function(a){this.end(a)},handle_mousemove:function(a){if(0!==this._button||this.network.isMovingElement()||this.network.isEditingElement())return void this.end(a);this._handle_mousemove(a),this.mark?this.network.fireInteractionEvent({kind:"selectBetween",event:a}):(this.mark=Wb.createDiv(),this.network.getTopDiv().appendChild(this.mark),this.network.setSelectingElement(!0),this.network.fireInteractionEvent({kind:"selectStart",event:a}));var b=Tb.getRect([this._startLogical,this._endLogical]);Wb.setDiv(this.mark,b,this.getIntersectMode()?this.network.getSelectFillColor():null,this.network.getSelectOutlineWidth(),this.network.getSelectOutlineColor())},end:function(a){if(this._startLogical){if(this.mark){if(this._endLogical&&this._startLogical.x!==this._endLogical.x&&this._startLogical.y!==this._endLogical.y){var b=this.network.getElementsAtRect(this.mark._viewRect,this.getIntersectMode(),this.network.getRectSelectFilter());if(b&&b.size()>0){var c=this.network.getSelectionModel(),d=c.toSelection();b.forEach(function(a){c.contains(a)?d.remove(a):d.add(a)},this),c.setSelection(d)}this.network.fireInteractionEvent({kind:"selectEnd",event:a})}var e=this;setTimeout(function(){e.mark&&(e.network.getTopDiv().removeChild(e.mark),e.mark=null)},0),this.network.setSelectingElement(!1)}this._handle_mouseup(a)}},getIntersectMode:function(){return"intersect"===this.network.getSelectMode()?!0:"contain"===this.network.getSelectMode()?!1:this._startLogical.x>this._endLogical.x&&this._startLogical.y>this._endLogical.y}}),Ib.network.interaction.MoveInteraction=function(a,b){this.lazyMode=b,this.xoffset=0,this.yoffset=0,Ib.network.interaction.MoveInteraction.superClass.constructor.call(this,a),this.currentKeyEvent=null},Jb.ext("twaver.network.interaction.MoveInteraction",Ib.network.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown","keydown","mouseleave")},tearDown:function(){this.removeListener("mousedown","keydown","mouseleave"),this.end()},handle_keydown:function(a){this.currentKeyEvent=a,this.addListener("keyup")},handle_keyup:function(a){this.currentKeyEvent=null,this.removeListener("keyup")},handle_mouseleave:function(a){this.end(a)},isParenting:function(){return this._startLogical&&null!=this.currentKeyEvent&&80===this.currentKeyEvent.keyCode},parentProcess:function(a,b){var c=null;null!=this.parent&&(c=this.network.getElementUI(this.parent).getViewRect(),this.parent=null);var d=this;if(a=this.network.getLogicalPoint(a),!b&&this.isParenting()){var e={};e.x=a.x-1,e.y=a.y-1,e.width=2,e.height=2;var f=this.network.getElementsAtRect(e,!0);if(f&&f.size()>0)for(var g=f.size(),h=0;g>h;h++){var i=f.get(h);if(!d.network.getElementBox().getSelectionModel().contains(i)){d.parent=i;break}}}null!=this.parent&&(c=this.network.getElementUI(this.parent).getViewRect()),null==c||b?this.parentMark&&(this.network.getTopDiv().removeChild(this.parentMark),this.parentMark=null):(this.parentMark||(this.parentMark=Jb.html.createDiv(),this.network.getTopDiv().appendChild(this.parentMark)),Jb.html.setDiv(this.parentMark,c,this.network.isLazyMoveFill()?this.network.getLazyMoveFillColor():null,this.network.getLazyMoveOutlineWidth(),this.network.getLazyMoveOutlineColor()))},handle_mousedown:function(a){if(0===a.button&&!this.network.isSelectingElement()&&!this.network.isEditingElement()){var b=this.network.getElementAt(a);this.network.isMovable(b)&&(this.end(a),this._handle_mousedown(a))}},handle_mouseup:function(a){this.end(a)},handle_mousemove:function(a){if(this.network.isSelectingElement()||this.network.isEditingElement()||!this.network.hasMovableSelectedElements()||!this._startLogical)return void this.end(a);if(this._handle_mousemove(a),this.xoffset=this._endLogical.x-this._startLogical.x,this.yoffset=this._endLogical.y-this._startLogical.y,this.lazyMode){if(this.mark)this.network.fireInteractionEvent({kind:"lazyMoveBetween",event:a});else{this.mark=Wb.createDiv();var b;this.network.getMovableSelectedElements().forEach(function(a){var c=this.getElementUI(a);c&&(b=Tb.unionRect(b,c.getViewRect()))},this.network),this.network.getTopDiv().appendChild(this.mark),this.network.setMovingElement(!0),Wb.setDiv(this.mark,b,this.network.isLazyMoveFill()?this.network.getLazyMoveFillColor():null,this.network.getLazyMoveOutlineWidth(),this.network.getLazyMoveOutlineColor()),this.network.fireInteractionEvent({kind:"lazyMoveStart",event:a})}this.mark.style.left=this.xoffset+this.mark._viewRect.x+"px",this.mark.style.top=this.yoffset+this.mark._viewRect.y+"px"}else this._startLogical=this._endLogical,this._startClient=Wb.getClientPoint(a),this.network.isMovingElement()?this.network.fireInteractionEvent({kind:"liveMoveBetween",event:a}):(this.network.setMovingElement(!0),this.network.fireInteractionEvent({kind:"liveMoveStart",event:a})),this.network.moveSelectedElements(this.xoffset,this.yoffset);this.parentProcess(a,!1)},end:function(a){if(this._startLogical){if(this.lazyMode){if(this.mark){var b=this,c=function(){b.network.fireInteractionEvent({kind:"lazyMoveEnd",event:a}),b.mark&&(b.network.getTopDiv().removeChild(b.mark),b.mark=null,b.network.setMovingElement(!1))};this.network.moveSelectedElements(this.xoffset,this.yoffset,this.network.isLazyMoveAnimate(),c)}}else this.network.isMovingElement()&&(this.network.setMovingElement(!1),this.network.fireInteractionEvent({kind:"liveMoveEnd",event:a}));if(this.isParenting()){null==this.parent&&(this.parent=this.network.getCurrentSubNetwork());var b=this;this.network.getMovableSelectedElements().forEach(function(a){a.setParent(b.parent)},this.network)}this.parentProcess(a,!0),this._handle_mouseup(a)}}}),Ib.network.interaction.DefaultInteraction=function(a){Ib.network.interaction.DefaultInteraction.superClass.constructor.call(this,a)},Jb.ext("twaver.network.interaction.DefaultInteraction",Ib.network.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown","mousemove","keydown")},tearDown:function(){this.removeListener("mousedown","mousemove","keydown")},handle_mousedown:function(a){if(this.network.isValidEvent(a)){this.network.isFocusOnClick()&&Ib.Util.setFocus(this.network.getView());var b=this.network.getElementAt(a);2===a.detail?this.handleDoubleClicked(a,b):this.handleClicked(a,b)}},handleClicked:function(a,b){Cc.handleClicked(this.network,a,b)},handleDoubleClicked:function(a,b){Cc.handleDoubleClicked(this.network,a,b)},handle_keydown:function(a){Cc.handleKeyDown(this.network,a)},handle_mousemove:function(a){var b=this.network.getElementAt(a),c=this._preElement,d=Dc(c),e=Dc(b);c!==b&&(c&&(d&&d.onMouseLeave&&d.onMouseLeave(c,this.network),this.network.onMouseLeave(c,a)),b&&(e&&e.onMouseEnter&&e.onMouseEnter(b,this.network),this.network.onMouseEnter(b,a))),b&&e&&e.onMouseMove&&e.onMouseMove(b,this.network),this.network.onMouseMove(b,a),this._preElement=b}}),Ib.network.interaction.PanInteraction=function(a){Ib.network.interaction.PanInteraction.superClass.constructor.call(this,a)},Jb.ext("twaver.network.interaction.PanInteraction",Ib.network.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown"),this._oldCursor=this.network.getView().style.cursor},tearDown:function(){this.removeListener("mousedown")},handle_mousedown:function(a){this._startLogical=this.network.getLogicalPoint(a),this._startLogical&&(this._handle_mousedown(a),this.network.getView().style.cursor="pointer")},handle_mouseup:function(a){this._clear()},handle_mousemove:function(a){if(this._startLogical){this._handle_mousemove(a);var b=this._startLogical.x-this._endLogical.x,c=this._startLogical.y-this._endLogical.y;this.network.panByOffset(b,c),this._startLogical=this._endLogical,this._startClient=Wb.getClientPoint(a)}},_clear:function(a){this._startLogical&&(this._handle_mouseup(a),this.network.getView().style.cursor=this._oldCursor)}}),Ib.network.interaction.EditInteraction=function(a,b){this.lazyMode=b,this.pointIndex=-1,Ib.network.interaction.EditInteraction.superClass.constructor.call(this,a)},Jb.ext("twaver.network.interaction.EditInteraction",Ib.network.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown","mousemove"),this.oldCursor=this.network.getView().style.cursor,this.network.setHasEditInteraction(!0)},tearDown:function(){this.removeListener("mousedown","mousemove"),this.network.getView().style.cursor=this.oldCursor,this.network.setHasEditInteraction(!1),this.clear()},clear:function(){this.network.setEditingElement(!1),this.network.setRotatingElement(!1),this.isStart=!1,this.isStartRotate=!1,this.node=null,this.shapeNode=null,this.shapeLink=null,this.linkUI=null,this.resizingRect=null,this.resizeDirection=null,this.pointIndex=-1,this._removeCursor(),this.oldCursor=null,this.mouseMoved=!1,this.horizontal=!1,this.vertical=!1,this.mark&&(this.network.getTopDiv().removeChild(this.mark),this.mark=null),this.rotateScale&&this.network.getTopDiv().contains(this.rotateScale)&&(this.network.getTopDiv().removeChild(this.rotateScale),
this.rotateScale=null)},_removeCursor:function(){this.cursorID&&(this.network.getView().style.cursor=this.oldCursor||"default",this.cursorID=null),this.resizeDirection=null,this.isCrossCursor=!1},_setCrossCursor:function(){this.isCrossCursor||(this._removeCursor(),this._setCursor("crosshair"),this.isCrossCursor=!0)},_setCursor:function(a){this.cursorID=a,this.network.getView().style.cursor!==this.cursorID&&(this.network.getView().style.cursor=this.cursorID)},handle_mousedown:function(a){if(0===a.button)if(!Jb.isAltDown(a)||this.network.isEditingElement())!this.network.isEditingElement()||this.isStart||this.isStartRotate||(this.node&&this.resizeDirection?(this.isStart=!0,this._handle_mousedown(a),this.network.fireInteractionEvent({kind:this.lazyMode?"lazyResizeStart":"liveResizeStart",event:a,element:this.node,resizeDirection:this.resizeDirection})):this.shapeNode&&this.pointIndex>=0?Jb.isAltDown(a)?(this.shapeNode.removeAt(this.pointIndex),this.network.fireInteractionEvent({kind:"removePoint",event:a,element:this.shapeNode})):(this.isStart=!0,this._handle_mousedown(a),this.network.fireInteractionEvent({kind:"liveMovePointStart",event:a,element:this.shapeNode,pointIndex:this.pointIndex})):this.shapeLink&&this.pointIndex>=0?Jb.isAltDown(a)?(this.shapeLink.removeAt(this.pointIndex),this.network.fireInteractionEvent({kind:"removePoint",event:a,element:this.shapeLink})):(this.isStart=!0,this._handle_mousedown(a),this.network.fireInteractionEvent({kind:"liveMovePointStart",event:a,element:this.shapeLink,pointIndex:this.pointIndex})):this.linkUI?(this.isStart=!0,this._handle_mousedown(a),this.network.fireInteractionEvent({kind:"liveMovePointStart",event:a,element:this.linkUI._element})):this.node&&(this.isStartRotate=!0,this._handle_mousedown(a)));else{var b=this.network.getElementAt(a),c=this.network.getLogicalPoint(a);if(b instanceof Ib.ShapeNode){var d=this.getPointIndex(b.getPoints(),c,!0);d>0&&(this._handle_mousedown(a),this.pointIndex=d,this.shapeNode=b,b.addPoint(c,d),this._setCrossCursor(),this.network.setEditingElement(!0),this.isStart=!0,this.network.fireInteractionEvent({kind:"addPoint",event:a,element:b,pointIndex:d}),this.network.fireInteractionEvent({kind:"liveMovePointStart",event:a,element:b,pointIndex:d}))}if(b instanceof Ib.ShapeLink){var e=new Ib.List(b.getPoints()),f=this.network.getElementUI(b);e.add(f.getFromPoint(),0),e.add(f.getToPoint());var d=this.getPointIndex(e,c)-1;d>0&&(this._handle_mousedown(a),this.pointIndex=d,this.shapeLink=b,b.addPoint(c,d),this._setCrossCursor(),this.network.setEditingElement(!0),this.isStart=!0,this.network.fireInteractionEvent({kind:"addPoint",event:a,element:b,pointIndex:d}),this.network.fireInteractionEvent({kind:"liveMovePointStart",event:a,element:b,pointIndex:d}))}}},handle_mouseup:function(a){if(this.isStart){var b=Jb.clone(this._endLogical);if(this.resizingRect)if(this.lazyMode)if(this.network.isResizeAnimate()){var c=this,d=new Ib.animate.AnimateBounds(this.node,this.resizingRect,function(){c.network.fireInteractionEvent({kind:"lazyResizeEnd",event:a,element:c.node,resizeDirection:c.resizeDirection}),c.clear()});Ib.animate.AnimateManager.start(d)}else this.node.setLocation(this.resizingRect.x,this.resizingRect.y),this.node.setSize(this.resizingRect.width,this.resizingRect.height),this.network.fireInteractionEvent({kind:"lazyResizeEnd",event:a,element:this.node,resizeDirection:this.resizeDirection});else this.node.setLocation(this.resizingRect.x,this.resizingRect.y),this.node.setSize(this.resizingRect.width,this.resizingRect.height),this.network.fireInteractionEvent({kind:"liveResizeEnd",event:a,element:this.node,resizeDirection:this.resizeDirection});else if(this.shapeNode&&this.pointIndex>=0&&b){var e=this.shapeNode.getPoints().get(this.pointIndex);this.horizontal&&(b.y=e.y),this.vertical&&(b.x=e.x),this.shapeNode.setPoint(this.pointIndex,b),this.network.fireInteractionEvent({kind:"liveMovePointEnd",event:a,element:this.shapeNode,pointIndex:this.pointIndex})}else if(this.shapeLink&&this.pointIndex>=0&&b){var e=this.shapeLink.getPoints().get(this.pointIndex);this.horizontal&&(b.y=e.y),this.vertical&&(b.x=e.x),this.shapeLink.setPoint(this.pointIndex,b),this.network.fireInteractionEvent({kind:"liveMovePointEnd",event:a,element:this.shapeLink,pointIndex:this.pointIndex})}else this.linkUI&&b&&(this.linkUI.setControlPoint(b),this.network.fireInteractionEvent({kind:"liveMovePointEnd",event:a,element:this.linkUI._element}))}this._handle_mouseup(a),this.lazyMode||this.clear()},handle_mousemove:function(a){if(this.isStartRotate&&this.node)return this._handleRotateElement(a,this.node),void(this.network.isShowRotateScale()&&this.showRotateScale());if(this.isStart){if(this.shapeNode&&this.pointIndex>=0)return void this._handleMovingShapeNodePoint(a);if(this.shapeLink&&this.pointIndex>=0)return void this._handleMovingShapeLinkPoint(a);if(this.node&&this.resizeDirection)return void this._handleResizing(a);if(this.linkUI)return void this._handleMovingLinkControlPoint(a)}else if(this.network.isValidEvent(a)){if(this.network.isSelectingElement()||this.network.isMovingElement()||0===this.network.getSelectionModel().size())return void this.clear();var b=this.network.getElementAt(a),c=this.network.getElementUI(b);if(!c||!c.getEditAttachment())return void this.clear();var d=this.network.getLogicalPoint(a);if(b instanceof Ld){if(this.node=b,this._isEditingShapeNode(d)||this._isResizingNode(d))return void this.network.setEditingElement(!0);if(this._isRotatingElement(d))return this.network.setRotatingElement(!0),void this.network.setEditingElement(!0)}else if(b instanceof Ib.ShapeLink){if(this.shapeLink=b,this._isEditingShapeLink(d))return void this.network.setEditingElement(!0)}else if(c instanceof Ib.network.LinkUI){var e=this.network.getEditPointSize();if(xc.isOrthogonalLink(c._element)){this.linkUI=c;var f=this.linkUI.getControlPoint();return void(f&&this._contains(d,f,e)&&(this._setCrossCursor(),this.network.setEditingElement(!0)))}}this.clear()}},_isRotatingElement:function(a){var b=this.network.getRotatePointSize();if(0>=b)return!1;var c=this.node.getOriginalRect(),d=this.node.getAngle();return this._isRotating(a,"crosshair",c,d)},_isRotating:function(a,b,c,d){var e=this.network.getRotatePointSize(),f={x:c.x+c.width/2,y:c.y-this.network.getRotatePointOffset()-e},g=this._rotatePoint(f,d,c),h={x:g.x-e,y:g.y-e,width:2*e,height:2*e};return Tb.containsPoint(h,a)?(this._removeCursor(),this._setCursor(b),!0):!1},_handleRotateElement:function(a,b){this._handle_mousemove(a);var c=this._calculateAngle(this.network.getLogicalPoint(a),b);b.setAngle(c)},_calculateAngle:function(a,b){var c=b.getCenterLocation();return Math.round(180*Math.atan2(c.x-a.x,a.y-c.y)/Math.PI+180)},_handleMovingShapeNodePoint:function(a){if(this._handle_mousemove(a),!this.mouseMoved&&Jb.isCtrlDown(a)){var b=this._endLogical.x-this._startLogical.x,c=this._endLogical.y-this._startLogical.y;this.horizontal=Math.abs(b)>=Math.abs(c),this.vertical=!this.horizontal,this.mouseMoved=!0}var d=this.shapeNode.getPoints().get(this.pointIndex),e=Jb.clone(this._endLogical);this.horizontal&&(e.y=d.y),this.vertical&&(e.x=d.x),this.shapeNode.setPoint(this.pointIndex,e),this.network.fireInteractionEvent({kind:"liveMovePointBetween",e:a,element:this.shapeNode,pointIndex:this.pointIndex})},_handleMovingShapeLinkPoint:function(a){if(this._handle_mousemove(a),!this.mouseMoved&&Jb.isCtrlDown(a)){var b=this._endLogical.x-this._startLogical.x,c=this._endLogical.y-this._startLogical.y;this.horizontal=Math.abs(b)>=Math.abs(c),this.vertical=!this.horizontal,this.mouseMoved=!0}var d=this.shapeLink.getPoints().get(this.pointIndex),e=Jb.clone(this._endLogical);this.horizontal&&(e.y=d.y),this.vertical&&(e.x=d.x),this.shapeLink.setPoint(this.pointIndex,e),this.network.fireInteractionEvent({kind:"liveMovePointBetween",e:a,element:this.shapeLink,pointIndex:this.pointIndex})},_handleMovingLinkControlPoint:function(a){this._handle_mousemove(a),this.linkUI.setControlPoint(Jb.clone(this._endLogical)),this.network.fireInteractionEvent({kind:"liveMovePointBetween",e:a,element:this.linkUI._element})},_handleResizing:function(a){this._handle_mousemove(a);var b=this.node.getAngle(),c=this.node.getLocation(),d=this.node.getWidth()/2,e=this.node.getHeight()/2,f={x:c.x+d,y:c.y+e},g={x:-d,y:-e},h={x:-d,y:e},i={x:d,y:e},j={x:d,y:-e},k={x:0,y:-e},l={x:d,y:0},m={x:0,y:e},n={x:-d,y:0};if("northwest"===this.resizeDirection&&(this._transformPoint(i,f,b),g.x=this._endLogical.x,g.y=this._endLogical.y,f.x=(g.x+i.x)/2,f.y=(g.y+i.y)/2,this._reversPoint(g,f,b),this._reversPoint(i,f,b),this.resizingRect={x:g.x,y:g.y,width:i.x-g.x,height:i.y-g.y}),"north"===this.resizeDirection){var o={x:this._endLogical.x,y:this._endLogical.y};this._reversPoint(o,f,b),k.y=o.y-f.y,this._transformPoint(k,f,b),this._transformPoint(m,f,b),f.x=(k.x+m.x)/2,f.y=(k.y+m.y)/2,this._reversPoint(k,f,b),this._reversPoint(m,f,b),this.resizingRect={x:f.x-this.node.getWidth()/2,y:f.y-(m.y-k.y)/2,width:this.node.getWidth(),height:m.y-k.y}}if("northeast"===this.resizeDirection&&(this._transformPoint(h,f,b),j.x=this._endLogical.x,j.y=this._endLogical.y,f.x=(h.x+j.x)/2,f.y=(h.y+j.y)/2,this._reversPoint(h,f,b),this._reversPoint(j,f,b),this.resizingRect={x:h.x,y:j.y,width:j.x-h.x,height:h.y-j.y}),"west"===this.resizeDirection){var o={x:this._endLogical.x,y:this._endLogical.y};this._reversPoint(o,f,b),n.x=o.x-f.x,this._transformPoint(l,f,b),this._transformPoint(n,f,b),f.x=(l.x+n.x)/2,f.y=(l.y+n.y)/2,this._reversPoint(l,f,b),this._reversPoint(n,f,b),this.resizingRect={x:f.x-(l.x-n.x)/2,y:f.y-this.node.getHeight()/2,width:l.x-n.x,height:this.node.getHeight()}}if("east"===this.resizeDirection){var o={x:this._endLogical.x,y:this._endLogical.y};this._reversPoint(o,f,b),l.x=o.x-f.x,this._transformPoint(l,f,b),this._transformPoint(n,f,b),f.x=(l.x+n.x)/2,f.y=(l.y+n.y)/2,this._reversPoint(l,f,b),this._reversPoint(n,f,b),this.resizingRect={x:f.x-(l.x-n.x)/2,y:f.y-this.node.getHeight()/2,width:l.x-n.x,height:this.node.getHeight()}}if("southwest"===this.resizeDirection&&(this._transformPoint(j,f,b),h.x=this._endLogical.x,h.y=this._endLogical.y,f.x=(h.x+j.x)/2,f.y=(h.y+j.y)/2,this._reversPoint(h,f,b),this._reversPoint(j,f,b),this.resizingRect={x:h.x,y:j.y,width:j.x-h.x,height:h.y-j.y}),"south"===this.resizeDirection){var o={x:this._endLogical.x,y:this._endLogical.y};this._reversPoint(o,f,b),m.y=o.y-f.y,this._transformPoint(k,f,b),this._transformPoint(m,f,b),f.x=(k.x+m.x)/2,f.y=(k.y+m.y)/2,this._reversPoint(k,f,b),this._reversPoint(m,f,b),this.resizingRect={x:f.x-this.node.getWidth()/2,y:f.y-(m.y-k.y)/2,width:this.node.getWidth(),height:m.y-k.y}}"southeast"===this.resizeDirection&&(this._transformPoint(g,f,b),i.x=this._endLogical.x,i.y=this._endLogical.y,f.x=(g.x+i.x)/2,f.y=(g.y+i.y)/2,this._reversPoint(g,f,b),this._reversPoint(i,f,b),this.resizingRect={x:g.x,y:g.y,width:i.x-g.x,height:i.y-g.y}),this.lazyMode?(this.mark||(this.mark=Wb.createDiv(),this.mark.style.webkitTransform="rotate("+b+"deg)",this.mark.style.mozTransform="rotate("+b+"deg)",this.mark.style.OTransform="rotate("+b+"deg)",this.mark.style.msTransform="rotate("+b+"deg)",this.mark.style.transform="rotate("+b+"deg)",this.network.getTopDiv().appendChild(this.mark)),Wb.setDiv(this.mark,this.resizingRect,null,this.network.getResizeLineWidth(),this.network.getResizeLineColor()),this.network.fireInteractionEvent({kind:"lazyResizeBetween",event:a,element:this.node,resizeDirection:this.resizeDirection})):(this.node.setSize(this.resizingRect.width,this.resizingRect.height),this.node.setLocation(this.resizingRect.x,this.resizingRect.y),this.network.fireInteractionEvent({kind:"liveResizeBetween",event:a,element:this.node,resizeDirection:this.resizeDirection}))},_isEditingShapeNode:function(a){var b=this.network.getEditPointSize();if(this.node instanceof Ib.ShapeNode){this.shapeNode=this.node;for(var c=this.shapeNode.getPoints(),d=0,e=c.size();e>d;d++){var f=c.get(d);if(this._contains(a,f,b))return this._setCrossCursor(),this.pointIndex=d,!0}}return this.pointIndex=-1,!1},_isEditingShapeLink:function(a){for(var b=this.shapeLink.getPoints(),c=this.network.getEditPointSize(),d=0,e=b.size();e>d;d++){var f=b.get(d);if(this._contains(a,f,c))return this._setCrossCursor(),this.pointIndex=d,!0}return this.pointIndex=-1,!1},_isResizingNode:function(a){var b=this.network.getResizePointSize();if(0>=b)return!1;var c=this.node.getOriginalRect(),d=this.node.getAngle(),e={x:c.x,y:c.y},f=this._rotatePoint(e,d,c);return this._isResizing(a,f.x,f.y,"northwest","nwse-resize")?!0:(e={x:c.x+c.width/2,y:c.y},f=this._rotatePoint(e,d,c),this._isResizing(a,f.x,f.y,"north","ns-resize")?!0:(e={x:c.x+c.width,y:c.y},f=this._rotatePoint(e,d,c),this._isResizing(a,f.x,f.y,"northeast","nesw-resize")?!0:(e={x:c.x,y:c.y+c.height/2},f=this._rotatePoint(e,d,c),this._isResizing(a,f.x,f.y,"west","ew-resize")?!0:(e={x:c.x+c.width,y:c.y+c.height/2},f=this._rotatePoint(e,d,c),this._isResizing(a,f.x,f.y,"east","ew-resize")?!0:(e={x:c.x,y:c.y+c.height},f=this._rotatePoint(e,d,c),this._isResizing(a,f.x,f.y,"southwest","nesw-resize")?!0:(e={x:c.x+c.width/2,y:c.y+c.height},f=this._rotatePoint(e,d,c),this._isResizing(a,f.x,f.y,"south","ns-resize")?!0:(e={x:c.x+c.width,y:c.y+c.height},f=this._rotatePoint(e,d,c),this._isResizing(a,f.x,f.y,"southeast","nwse-resize")?!0:!1)))))))},_rotatePoint:function(a,b,c){var d=Tb.createMatrix(b*Math.PI/180,c.x+c.width/2,c.y+c.height/2),e=d.transform(a);return e},_isResizing:function(a,b,c,d,e){var f=this.network.getResizePointSize();return this._contains(a,{x:b,y:c},f)?(this.resizeDirection!==d&&(this._removeCursor(),e=this._changeCursorWithAngle(d,this.node.getAngle()),this._setCursor(e),this.resizeDirection=d),!0):!1},_getRect:function(a,b,c,d){var e=c>a?a:c,f=d>b?b:d,g=Math.abs(a-c),h=Math.abs(b-d);return{x:e,y:f,width:g,height:h}},_contains:function(a,b,c){var d={x:b.x-c,y:b.y-c,width:2*c,height:2*c};return Tb.containsPoint(d,a)},getPointIndex:function(a,b,c){if(a.size()<2)return 0;for(var d,e=a.get(0),f=1;f<a.size();f++){if(d=a.get(f),this.isPointOnLine(b,e,d,6))return f;e=d}return e=a.get(0),c&&this.isPointOnLine(b,e,d,6)?a.size():0},showRotateScale:function(){this.rotateScale||(this.rotateScale=Jb.html.createCanvas());var a,b,c,d,e,f=(new Ib.List,this.network.getRotateScaleWidth()),g=this.network.getRotateScaleHeight(),h=this.network.getRotatePointSize(),i=this.node.getAngle(),j=this.node.getOriginalRect(),k={x:j.x+j.width/2,y:j.y-this.network.getRotatePointOffset()-h},l=this._rotatePoint(k,i,j),m="13px Arial",n=i+"°";this.node.getAngle()>=0&&this.node.getAngle()<=180?(b={x:l.x+h,y:l.y},c={x:b.x+f,y:b.y},d={x:c.x,y:c.y-g},e={x:b.x,y:d.y}):this.node.getAngle()>180&&this.node.getAngle()<=360&&(b={x:l.x-h,y:l.y},c={x:b.x-f,y:b.y},d={x:c.x,y:c.y-g},e={x:b.x,y:d.y});var o=new Ib.List([b,c,d,e]),a=Jb.math.getRect(o),p=Jb.html.setCanvas(this.rotateScale,a);p.fillStyle=this.network.getRotateScaleFillColor(),p.fillRect(a.x,a.y,a.width,a.height),p.fillStyle=this.network.getRotateScaleFontColor(),p.textBaseline="middle",p.textAlign="center",p.font=m,p.fillText(n,a.x+a.width/2,a.y+a.height/2),this.network.getTopDiv().appendChild(this.rotateScale)},isPointOnLine:function(a,b,c,d){0>d&&(d=0);var e=this.getDistanceFromPointToLine(a,b,c);return d>=e&&a.x>=Math.min(b.x,c.x)-d&&a.x<=Math.max(b.x,c.x)+d&&a.y>=Math.min(b.y,c.y)-d&&a.y<=Math.max(b.y,c.y)+d},getDistanceFromPointToLine:function(a,b,c){if(b.x===c.x)return Math.abs(a.x-b.x);var d=(c.y-b.y)/(c.x-b.x),e=(c.x*b.y-b.x*c.y)/(c.x-b.x);return Math.abs(d*a.x-a.y+e)/Math.sqrt(d*d+1)},_transformPoint:function(a,b,c){var d=Math.cos(c*Math.PI/180),e=Math.sin(c*Math.PI/180),f=a.x,g=a.y,h=f*d-g*e,i=f*e+g*d;a.x=h+b.x,a.y=i+b.y},_reversPoint:function(a,b,c){c*=-1;var d=Math.cos(c*Math.PI/180),e=Math.sin(c*Math.PI/180),f=a.x-b.x,g=a.y-b.y,h=f*d-g*e,i=f*e+g*d;a.x=h+b.x,a.y=i+b.y},_changeCursorWithAngle:function(a,b){var c,d=["auto","nwse-resize","ns-resize","nesw-resize","ew-resize","nwse-resize","ns-resize","nesw-resize","ew-resize"];switch(a){case"northwest":c=1;break;case"north":c=2;break;case"northeast":c=3;break;case"east":c=4;break;case"southeast":c=5;break;case"south":c=6;break;case"southwest":c=7;break;case"west":c=8;break;default:c=0}return(b>=360||-360>=b)&&(b%=360),b>22.5&&67.5>=b&&(c+=1),-22.5>b&&b>=-67.5&&(c-=1),b>67.5&&112.5>=b&&(c+=2),-67.5>b&&b>=-112.5&&(c-=2),b>112.5&&157.5>=b&&(c+=3),-112.5>b&&b>=-157.5&&(c-=3),b>157.5&&202.5>=b&&(c+=4),-157.5>b&&b>=-202.5&&(c-=4),b>202.5&&247.5>=b&&(c+=5),-202.5>b&&b>=-247.5&&(c-=5),b>247.5&&292.5>=b&&(c+=6),-247.5>b&&b>=-292.5&&(c-=6),b>292.5&&337.5>=b&&(c+=7),-292.5>b&&b>=-337.5&&(c-=7),c>8&&(c-=8),0>=c&&(c+=8),d[c]}}),Ib.network.interaction.CreateElementInteraction=function(a,b){b||(b=Ld),this.elementFunction=Ib.Util.isTypeOf(b,Ld)?function(a){var c=new b;return c instanceof Ld&&c.setCenterLocation(a),c}:b,Ib.network.interaction.CreateElementInteraction.superClass.constructor.call(this,a)},Jb.ext("twaver.network.interaction.CreateElementInteraction",Ib.network.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown")},tearDown:function(){this.removeListener("mousedown")},handle_mousedown:function(a){var b=this.network.getLogicalPoint(a);if(b){var c=this.elementFunction(b);c&&this.network.addElementByInteraction(c)}}}),Ib.network.interaction.CreateLinkInteraction=function(a,b){b||(b=Ib.Link),this.linkFunction=Ib.Util.isTypeOf(b,Ib.Link)?function(a,c){var d=new b;return d instanceof Ib.Link&&(d.setFromNode(a),d.setToNode(c)),d}:b,Ib.network.interaction.CreateLinkInteraction.superClass.constructor.call(this,a)},Jb.ext("twaver.network.interaction.CreateLinkInteraction",Ib.network.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown","mousemove")},tearDown:function(){this.removeListener("mousedown","mousemove"),this.clear()},clear:function(){var a=this;setTimeout(function(){a._fromRectangle&&(a.network.getTopDiv().removeChild(a._fromRectangle),a._fromRectangle=null),a._currentRectangle&&(a.network.getTopDiv().removeChild(a._currentRectangle),a._currentRectangle=null),a._line&&(a.network.getTopDiv().removeChild(a._line),a._line=null)}),this.currentPoint=null,this.currentNode=null,this.fromNode=null,this.toNode=null},createLink:function(){return this.linkFunction(this.fromNode,this.toNode)},handle_mousedown:function(a){if(this.network.isValidEvent(a))if(this.fromNode){if(this.toNode=this.currentNode,this.toNode){var b=this.createLink();b&&this.network.addElementByInteraction(b)}this.clear()}else this.fromNode=this.currentNode,this.currentNode=null,this.currentPoint=null,this.updateMark()},handle_mousemove:function(a){var b=this.network.getLogicalPoint(a);if(b){if(this.network.isMovingElement()||this.network.isEditingElement())return void this.clear();var c=null;this.fromNode?(this.currentNode=this.getToNode(a),this.currentPoint=b,this.updateMark()):(c=this.getFromNode(a),this.currentNode!==c&&(this.currentNode=c,this.updateMark()))}},getFromNode:function(a){return this.getNode(a)},getToNode:function(a){return this.getNode(a)},getNode:function(a){var b=this.network.getElementAt(a);return b instanceof Ld&&this.network.isLinkable(b)?b:null},updateMark:function(){var a;this.fromNode&&!this._fromRectangle&&this._currentRectangle&&(this._fromRectangle=this._currentRectangle,this._currentRectangle=null),!this.fromNode&&this._fromRectangle&&(this.network.getTopDiv().removeChild(this._fromRectangle),this._fromRectangle=null),this.currentNode&&!this._currentRectangle&&(a=this.network.getElementUI(this.currentNode),this._currentRectangle=Wb.createDiv(),this.network.getTopDiv().appendChild(this._currentRectangle),Wb.setDiv(this._currentRectangle,a._viewRect,null,this.network.getEditLineWidth(),this.network.getEditLineColor())),!this.currentNode&&this._currentRectangle&&(this.network.getTopDiv().removeChild(this._currentRectangle),this._currentRectangle=null),this.updateLine()},updateLine:function(){if(this.currentPoint){var a=this.fromNode.getCenterLocation(),b=a.x,c=a.y,d=this.currentPoint.x,e=this.currentPoint.y;this._line||(this._line=Wb.createCanvas(),this.network.getTopDiv().appendChild(this._line));var f=Wb.setCanvas(this._line,Math.min(b,d),Math.min(c,e),Math.abs(b-d),Math.abs(c-e));f.lineWidth=this.network.getEditLineWidth(),f.strokeStyle=this.network.getEditLineColor(),f.beginPath(),f.moveTo(b,c),f.lineTo(d,e),f.stroke()}else this._line&&(this.network.getTopDiv().removeChild(this._line),this._line=null)}}),Ib.network.interaction.CreateShapeNodeInteraction=function(a,b){b||(b=Ib.ShapeNode),this.shapeNodeFunction=Ib.Util.isTypeOf(b,Ib.ShapeNode)?function(a){var c=new b;return c instanceof Ib.ShapeNode&&a&&c.setPoints(a),c}:b,Ib.network.interaction.CreateShapeNodeInteraction.superClass.constructor.call(this,a),this.timeStamp=-1},Jb.ext("twaver.network.interaction.CreateShapeNodeInteraction",Ib.network.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown","mousemove")},tearDown:function(){this.removeListener("mousedown","mousemove"),this.clear()},clear:function(){this.network.setEditingElement(!1),this.points=null,this.currentPoint=null,this.lastPoint=null,this.horizontal=!1,this.vertical=!1,this.mark&&(this.network.getTopDiv().removeChild(this.mark),this.mark=null)},handle_mousedown:function(a){if(0===a.button){var b=this.network.getLogicalPoint(a);if(b){if(2===a.detail||a.timeStamp-this.timeStamp<300){if(this.points){var c=this.shapeNodeFunction(this.points);this.network.addElementByInteraction(c),this.clear();var d=this;setTimeout(function(){d.network.setEditingElement(!1)},0)}}else{if(this.network.isEditingElement()||this.network.setEditingElement(!0),this.points||(this.points=new nd),this.points.size()>0){var e=this.points.get(this.points.size()-1);if(e.x===b.x&&e.y===b.y)return}this._handle_mousedown(a),this.points.size()>0&&Jb.isCtrlDown(a)&&(this.horizontal&&(b.y=e.y),this.vertical&&(b.x=e.x),this.horizontal=!1,this.vertical=!1),this.lastPoint=b,this.points.add(b),this.updateMark()}this.timeStamp=a.timeStamp}}},handle_mousemove:function(a){if(this.points){if(this.currentPoint=this.network.getLogicalPoint(a),Jb.isCtrlDown(a)){var b=this.currentPoint.x-this.lastPoint.x,c=this.currentPoint.y-this.lastPoint.y;this.horizontal=Math.abs(b)>=Math.abs(c),this.vertical=!this.horizontal}else this.horizontal=!1,this.vertical=!1;this.horizontal&&(this.currentPoint.y=this.lastPoint.y),this.vertical&&(this.currentPoint.x=this.lastPoint.x),this.updateMark()}},updateMark:function(a){if(this.points&&this.points.size()>0&&this.currentPoint){this.mark||(this.mark=Wb.createCanvas(),this.network.getTopDiv().appendChild(this.mark));var b=new nd(this.points);b.add(this.currentPoint);var c=Tb.getRect(b),d=this.network.getEditLineWidth();Jb.math.grow(c,d,d);var e=Wb.setCanvas(this.mark,c);e.lineWidth=d,e.strokeStyle=this.network.getEditLineColor(),e.beginPath(),Xb.drawLinePoints(e,b),e.stroke()}}}),Ib.network.interaction.CreateShapeLinkInteraction=function(a,b){Ib.network.interaction.CreateShapeLinkInteraction.superClass.constructor.call(this,a),b||(b=Ib.ShapeLink),this.linkFunction=Ib.Util.isTypeOf(b,Ib.ShapeLink)?function(a,c,d){var e=new b;return e instanceof Ib.ShapeLink&&(e.setFromNode(a),e.setToNode(c),d&&e.setPoints(d)),e}:b},Jb.ext("twaver.network.interaction.CreateShapeLinkInteraction",Ib.network.interaction.CreateLinkInteraction,{clear:function(){this.network.setEditingElement(!1),this.points=null,this.polyline&&(this.network.getTopDiv().removeChild(this.polyline),this.polyline=null),Ib.network.interaction.CreateShapeLinkInteraction.superClass.clear.call(this)},createLink:function(){return this.linkFunction(this.fromNode,this.toNode,this.points)},handle_mousedown:function(a){if(0===a.button){var b=this.network.getLogicalPoint(a);if(b)if(this.fromNode)if(this.toNode=this.currentNode,this.toNode){var c=this.createLink();c&&this.network.addElementByInteraction(c),this.clear()}else{if(this.points||(this.points=new nd),this.points.size()>0){var d=this.points.get(this.points.size()-1);if(d.x===b.x&&d.y===b.y)return}this.points.add(b),this.updateMark()}else this.fromNode=this.currentNode,this.fromNode&&(this.polyline||(this.polyline=Wb.createCanvas(),this.network.getTopDiv().appendChild(this.polyline))),this.points=null,this.currentNode=null,this.currentPoint=null,this.updateMark()}},updateLine:function(){if(this.currentPoint&&this.polyline){var a=new nd(this.points);a.add(this.fromNode.getCenterLocation(),0),a.add(this.currentPoint);var b=Tb.getRect(a),c=Wb.setCanvas(this.polyline,b);c.lineWidth=this.network.getEditLineWidth(),c.strokeStyle=this.network.getEditLineColor(),c.beginPath(),Xb.drawLinePoints(c,a),c.stroke()}}}),Ib.network.interaction.CreateOrthogonalLinkInteraction=function(a,b,c,d,e,f){Ib.network.interaction.CreateOrthogonalLinkInteraction.superClass.constructor.call(this,a,b),this.linkType=c||"orthogonal",this.isByControlPoint=d,this.splitPercent=e,this.isSplitByPercent=f,this.link=new Ib.Link,this.link.setStyle("link.type",this.linkType),this.link.setStyle("link.split.by.percent",this.isSplitByPercent),xc.isFlexionalTypeLink(this.linkType)||xc.isExtendTypeLink(this.linkType)?(this.splitPercent<0&&(this.splitPercent=Ib.Styles.getStyle("link.extend")),this.link.setStyle("link.extend",this.splitPercent)):xc.isSplitTypeLink(this.linkType)&&(this.splitPercent<0&&(this.splitPercent=Ib.Styles.getStyle(this.isSplitByPercent?"link.split.percent":"link.split.value")),this.isSplitByPercent?this.link.setStyle("link.split.percent",this.splitPercent):this.link.setStyle("link.split.value",this.splitPercent))},Jb.ext("twaver.network.interaction.CreateOrthogonalLinkInteraction",Ib.network.interaction.CreateLinkInteraction,{clear:function(){this.path&&(this.network.getTopDiv().removeChild(this.path),this.path=null),Ib.network.interaction.CreateOrthogonalLinkInteraction.superClass.clear.call(this)},createLink:function(){var a=Ib.network.interaction.CreateOrthogonalLinkInteraction.superClass.createLink.call(this);if(a.setStyle("link.type",this.linkType),a.setStyle("link.split.by.percent",this.isSplitByPercent),this.isByControlPoint){var b=xc.getControlPoint(a);if(b)return a.SetStyle("link.control.point",b),a}else xc.isFlexionalTypeLink(this.linkType)||xc.isExtendTypeLink(this.linkType)?(this.splitPercent<0&&(this.splitPercent=Ib.Styles.getStyle("link.extend")),a.setStyle("link.extend",this.splitPercent)):xc.isSplitTypeLink(this.linkType)&&(this.splitPercent<0&&(this.splitPercent=Ib.Styles.getStyle(this.isSplitByPercent?"link.split.percent":"link.split.value")),this.isSplitByPercent?a.setStyle("link.split.percent",this.splitPercent):a.setStyle("link.split.value",this.splitPercent));return a},updateLine:function(){if(this.currentPoint){if(!this.fromNode||this.currentNode===this.fromNode)return;var a,b=this.network.getElementUI(this.fromNode);if(!b)return;if(a=b.getBodyRect(),null==a)return;var c;if(this.currentNode&&this.currentNode!==this.fromNode){var d=this.network.getElementUI(this.currentNode);if(!d)return;c=d.getBodyRect()}else c={x:this.currentPoint.x,y:this.currentPoint.y,width:1,height:1};if(!c)return;var e=xc.calculateOrthogonalAndFlexionalLinkPoints(this.linkType,a,c,this.link);if(xc.drawCorner(e,this.link),e.size()<2)return;this.line||(this.line=Wb.createCanvas(),this.network.getTopDiv().appendChild(this.line));var f=Wb.setCanvas(this.line,Tb.getLineRect(e));f.lineWidth=this.network.getEditLineWidth(),f.strokeStyle=this.network.getEditLineColor(),f.beginPath(),Xb.drawLinePoints(f,e),f.stroke()}else this.line&&(this.network.getTopDiv().removeChild(this.line),this.line=null)}}),Ib.network.interaction.MagnifyInteraction=function(a,b,c,d,e){Ib.network.interaction.MagnifyInteraction.superClass.constructor.call(this,a),this.zoom=b||2,this.xRadius=c||100,this.yRadius=d||100,this.shape=e||"circle",this.borderColor="black",this.borderWidth=1,this.backgroundColor="white",this.markCanvas=Wb.createCanvas(),this.markCanvas._isIgnored=!0},Jb.ext("twaver.network.interaction.MagnifyInteraction",Ib.network.interaction.BaseInteraction,{setUp:function(){this.addListener("mousemove")},tearDown:function(){this.removeListener("mousemove"),this._clear()},handle_mousemove:function(a){var b=this.network.getLogicalPoint(a);b&&(this.lastPoint||this.network.getView().appendChild(this.markCanvas),this.lastPoint=b,this.updateMark())},updateMark:function(){var a,b=this.network._zoom,c=this.zoom*b,d=this.lastPoint.x*b-this.xRadius,e=this.lastPoint.y*b-this.yRadius,f=2*this.xRadius,g=2*this.yRadius,h={x:this.lastPoint.x-this.xRadius/c,y:this.lastPoint.y-this.yRadius/c,width:f/c,height:g/c},i=this.borderWidth,j=Wb.createCanvas();j.width=f,j.height=g,this.network.toCanvasByRegion(h,c,j),Wb.setCanvas(this.markCanvas,d,e,f,g),a=this.markCanvas.getContext("2d"),a.save(),a.beginPath(),Xb.drawVector(a,this.shape,null,d,e,f,g),a.clip(),a.fillStyle=this.backgroundColor,a.beginPath(),a.rect(d,e,f,g),a.fill(),a.drawImage(j,d,e),a.restore(),a.beginPath(),a.lineWidth=i,Xb.drawVector(a,this.shape,null,d+i/2,e+i/2,f-i,g-i),a.strokeStyle=this.borderColor,a.stroke()},_clear:function(a){this.lastPoint&&(this.network.getView().removeChild(this.markCanvas),this.lastPoint=null)},getZoom:function(){return this.zoom},setZoom:function(a){this.zoom=a,this.updateMark()},getShape:function(){return this.shape},setShape:function(a){this.shape=a,this.updateMark()},getXRadius:function(){return this.xRadius},setXRadius:function(a){this.xRadius=a,this.updateMark()},getYRadius:function(){return this.yRadius},setYRadius:function(a){this.yRadius=a,this.updateMark()},getBorderColor:function(){return this.borderColor},setBorderColor:function(a){this.borderColor=a,this.updateMark()},getBorderWidth:function(){return this.borderWidth},setBorderWidth:function(a){this.borderWidth=a,this.updateMark()},getBackgroundColor:function(){return this.backgroundColor},setBackgroundColor:function(a){this.backgroundColor=a,this.updateMark()}}),Ib.network.interaction.TouchInteraction=function(a){Ib.network.interaction.TouchInteraction.superClass.constructor.call(this,a)},Jb.ext("twaver.network.interaction.TouchInteraction",Ib.network.interaction.BaseInteraction,{setUp:function(){var a=this.network.getView();Wb.addEventListener("touchstart","handleTouchstart",a,this),Wb.addEventListener("touchmove","handleTouchmove",a,this),Wb.addEventListener("touchend","handleTouchend",a,this),Wb.addEventListener("touchcancel","handleTouchend",a,this)},tearDown:function(){var a=this.network.getView();Wb.removeEventListener("touchstart",a,this),Wb.removeEventListener("touchmove",a,this),Wb.removeEventListener("touchend",a,this),Wb.removeEventListener("touchcancel",a,this)},handleTouchstart:function(a){if(Wb.preventDefault(a),a.touches&&1==a.touches.length){var b=this.network.getLogicalPoint(a),c=this.network.getElementAt(b);this._startTouchTime=new Date,this._startTouchPoint=b;var d=this;c?(this._haveElementUnderTouch=!0,this._startTouchElement=c):(this._haveElementUnderTouch=!1,this._startTouchElement=null),this.timer=setTimeout(function(){Cc.handleLongClicked(d.network,a,c)},1e3)}else a.touches&&2==a.touches.length&&(this._distance=zc.getDistance(a),this._zoom=this.network.getZoom(),this._startTouchPoint={x:a.touches[0].clientX,y:a.touches[0].clientY});this._touchCount=a.touches.length},handleTouchmove:function(a){if(Wb.preventDefault(a),2==this._touchCount&&a.touches&&2==a.touches.length)if(this.timer&&clearTimeout(this.timer),Math.abs(this._distance-zc.getDistance(a))>=Ed.TOUCH_ZOOM_THRESHOLD||this._zoomFlag){this._zoomFlag=!0;var b=zc.getDistance(a)/this._distance;this.network.setTouchZoom(this._zoom*b,!1)}else{var c=a.touches[0],d=this._startTouchPoint.x-c.clientX,e=this._startTouchPoint.y-c.clientY,f=this.network.panByOffset(d,e);this._startTouchPoint.x-=d-f.x,this._startTouchPoint.y-=e-f.y}else if(1==this._touchCount&&a.touches&&1==a.touches.length)if(this._haveElementUnderTouch||!this.network.isRectSelectEnabled()){var g=this.network.getLogicalPoint(a),h=this.network.getElementAt(g);if(this.network.isMovingElement()||null!=this._startTouchElement&&this._startTouchElement==h&&this.network.getMovableSelectedElements().contains(h)){
var d=g.x-this._startTouchPoint.x,e=g.y-this._startTouchPoint.y;(Math.abs(d)>=Ed.TOUCH_MOVE_THRESHOLD||Math.abs(e)>=Ed.TOUCH_MOVE_THRESHOLD)&&(this._startTouchPoint=g,this.network.moveSelectedElements(d,e),this.network.isMovingElement()?this.network.fireInteractionEvent({kind:"liveMoveBetween",event:a}):(this.network.setMovingElement(!0),this.network.fireInteractionEvent({kind:"liveMoveStart",event:a}),this.timer&&clearTimeout(this.timer)))}else{var d=g.x-this._startTouchPoint.x,e=g.y-this._startTouchPoint.y;(Math.abs(d)>=Ed.TOUCH_MOVE_THRESHOLD||Math.abs(e)>=Ed.TOUCH_MOVE_THRESHOLD)&&this.timer&&clearTimeout(this.timer)}}else{this._moveTouchPoint=this.network.getLogicalPoint(a);var d=this._moveTouchPoint.x-this._startTouchPoint.x,e=this._moveTouchPoint.y-this._startTouchPoint.y;if(Math.abs(d)>=Ed.TOUCH_RECT_SELECT_THRESHOLD&&Math.abs(e)>=Ed.TOUCH_RECT_SELECT_THRESHOLD){this.mark?this.network.fireInteractionEvent({kind:"selectBetween",event:a}):(this.mark=Wb.createDiv(),this.network.getTopDiv().appendChild(this.mark),this.network.setSelectingElement(!0),this.network.fireInteractionEvent({kind:"selectStart",event:a}),this.timer&&clearTimeout(this.timer));var i=Tb.getRect([this._startTouchPoint,this._moveTouchPoint]);Wb.setDiv(this.mark,i,this.getIntersectMode()?this.network.getSelectFillColor():null,this.network.getSelectOutlineWidth(),this.network.getSelectOutlineColor())}}},handleTouchend:function(a){if(Wb.preventDefault(a),this.network.isMovingElement())this.network.setMovingElement(!1),this.network.fireInteractionEvent({kind:"liveMoveEnd",event:a});else if(this.network.isSelectingElement()){var b=this.network.getElementsAtRect(this.mark._viewRect,this.getIntersectMode(),this.network.getRectSelectFilter());if(b&&b.size()>0){var c=this.network.getSelectionModel(),d=c.toSelection();b.forEach(function(a){c.contains(a)?d.remove(a):d.add(a)},this),c.setSelection(d)}this.network.fireInteractionEvent({kind:"selectEnd",event:a}),this.network.getTopDiv().removeChild(this.mark),this.mark=null,this.network.setSelectingElement(!1),this.timer&&clearTimeout(this.timer)}else if(this._startTouchPoint){this._zoomFlag=!1;var e=new Date,f=this.network.getLogicalPoint(a),g=this.network.getElementAt(this._startTouchPoint);this._startTouchPoint&&f&&e.getTime()-this._startTouchTime.getTime()<=500&&Tb.getDistance(this._startTouchPoint,f)<=20&&(g?this.network.getSelectionModel().contains(g)||this.network.getSelectionModel().setSelection(g):this.network.getSelectionModel().clearSelection(),Cc.handleClicked(this.network,a,g),this.timer&&clearTimeout(this.timer),this._endTouchTime&&e.getTime()-this._endTouchTime.getTime()<=500&&Tb.getDistance(this._endTouchPoint,f)<=20?(delete this._endTouchTime,delete this._endTouchPoint,Cc.handleDoubleClicked(this.network,a,g),this.timer&&clearTimeout(this.timer)):(this._endTouchTime=e,this._endTouchPoint=f))}},getIntersectMode:function(){return"intersect"===this.network.getSelectMode()?!0:"contain"===this.network.getSelectMode()?!1:this._startTouchPoint.x>this._moveTouchPoint.x&&this._startTouchPoint.y>this._moveTouchPoint.y}}),Ib.network.interaction.MSTouchInteraction=function(a){Ib.network.interaction.MSTouchInteraction.superClass.constructor.call(this,a),this._pointerMap={},this._pointerIdArray=[]},Jb.ext("twaver.network.interaction.MSTouchInteraction",Ib.network.interaction.BaseInteraction,{setUp:function(){var a=this.network.getView();Wb.addEventListener("MSPointerDown","handleTouchstart",a,this),Wb.addEventListener("MSPointerMove","handleTouchmove",a,this),Wb.addEventListener("MSPointerUp","handleTouchend",a,this),Wb.addEventListener("MSPointerCancel","handleTouchend",a,this)},tearDown:function(){var a=this.network.getView();Wb.removeEventListener("MSPointerDown",a,this),Wb.removeEventListener("MSPointerMove",a,this),Wb.removeEventListener("MSPointerUp",a,this),Wb.removeEventListener("MSPointerCancel",a,this)},handleTouchstart:function(a){if(this.network.isFocusOnClick()&&Ib.Util.setFocus(this.network._view),!this.network.isSelectingElement()||a.pointerType!=a.MSPOINTER_TYPE_MOUSE){var b=this.network.getLogicalPoint(a),c=new Date;if(a.isPrimary&&this._pointerIdArray.length>0&&this.handle_mouseup(a),this._pointerMap[a.pointerId]||(this._pointerIdArray.push(a.pointerId),this._pointerMap[a.pointerId]=a),1==this._pointerIdArray.length){var d=this.network.getElementAt(b);this._startTouchElement=d,this._startClientPoint={x:a.clientX,y:a.clientY},Cc.handleClicked(this.network,a,d),this._startTouchTime&&this._startTouchPoint&&c.getTime()-this._startTouchTime.getTime()<=500&&Tb.getDistance(this._startTouchPoint,b)<=20?(Cc.handleDoubleClicked(this.network,a,d),this._doubleClick=!0):(Wb.handle_mousedown(this,a),this._startTouchPoint=b,this._startTouchTime=c);var e=this.network.getSelectionModel();d?Jb.isCtrlDown(a)?e.contains(d)?e.removeSelection(d):e.appendSelection(d):e.contains(d)||e.setSelection(d):Jb.isCtrlDown(a)||e.clearSelection()}else 2==this._pointerIdArray.length&&(this._distance=this._getDistance(),this._zoom=this.network.getZoom())}},handleTouchmove:function(a){if(null!=this._startTouchPoint&&0!=this._pointerIdArray.length&&this._pointerMap[a.pointerId]&&!(Tb.getDistance({x:this._pointerMap[a.pointerId].pageX,y:this._pointerMap[a.pointerId].pageY},{x:a.pageX,y:a.pageY})<=10)&&(this._pointerMap[a.pointerId]=a,2==this._pointerIdArray.length)){var b=this._getDistance()/this._distance;this.network.setZoom(this._zoom*b,!1)}},handleTouchend:function(a){if(this.network.isMovingElement()&&(this.network.setMovingElement(!1),this.network.fireInteractionEvent({kind:"liveMoveEnd",event:a})),this.network.isSelectingElement()){var b=this.network.getElementsAtRect(this.mark._viewRect,this.getIntersectMode(),this.network.getRectSelectFilter());if(b&&b.size()>0){var c=this.network.getSelectionModel(),d=c.toSelection();b.forEach(function(a){c.contains(a)?d.remove(a):d.add(a)},this),c.setSelection(d)}this.network.fireInteractionEvent({kind:"selectEnd",event:a}),this.network.getTopDiv().removeChild(this.mark),this.mark=null,this.network.setSelectingElement(!1)}this._doubleClick&&(delete this._doubleClick,delete this._startTouchPoint,delete this._startTouchTime);for(var e=-1,f=0;f<this._pointerIdArray.length;f++)if(this._pointerIdArray[f]==a.pointerId){e=f;break}e>=0&&this._pointerIdArray.splice(e,1),delete this._pointerMap[a.pointerId]},_getDistance:function(){return Tb.getDistance({x:this._pointerMap[this._pointerIdArray[0]].pageX,y:this._pointerMap[this._pointerIdArray[0]].pageY},{x:this._pointerMap[this._pointerIdArray[1]].pageX,y:this._pointerMap[this._pointerIdArray[1]].pageY})},getIntersectMode:function(){return"intersect"===this.network.getSelectMode()?!0:"contain"===this.network.getSelectMode()?!1:this._startTouchPoint.x>this._moveTouchPoint.x&&this._startTouchPoint.y>this._moveTouchPoint.y},handle_mousemove:function(a){if(this._startTouchPoint&&1==this._pointerIdArray.length){if(this._moveTouchPoint={x:this._startTouchPoint.x+(a.clientX-this._startClientPoint.x)/this.network.getZoom(),y:this._startTouchPoint.y+(a.clientY-this._startClientPoint.y)/this.network.getZoom()},Tb.getDistance(this._startTouchPoint,this._moveTouchPoint)<3)return;if(null==this._startTouchElement&&this.network.isRectSelectEnabled()){this.mark?this.network.fireInteractionEvent({kind:"selectBetween",event:a}):(this.mark=Wb.createDiv(),this.network.getTopDiv().appendChild(this.mark),this.network.setSelectingElement(!0),this.network.fireInteractionEvent({kind:"selectStart",event:a}));var b=Tb.getRect([this._startTouchPoint,this._moveTouchPoint]);Wb.setDiv(this.mark,b,this.getIntersectMode()?this.network.getSelectFillColor():null,this.network.getSelectOutlineWidth(),this.network.getSelectOutlineColor())}else{var c=this.network.getElementAt(this._moveTouchPoint),d=this._moveTouchPoint.x-this._startTouchPoint.x,e=this._moveTouchPoint.y-this._startTouchPoint.y;null!=this._startTouchElement||this.network.isRectSelectEnabled()?(this.network.isMovingElement()||null!=this._startTouchElement&&c==this._startTouchElement&&this.network.getMovableSelectedElements().contains(c))&&(this.network.moveSelectedElements(d,e),this.network.isMovingElement()?this.network.fireInteractionEvent({kind:"liveMoveBetween",event:a}):(this.network.setMovingElement(!0),this.network.fireInteractionEvent({kind:"liveMoveStart",event:a}))):this.network.panByOffset(-d,-e),this._startClientPoint.x=a.clientX,this._startClientPoint.y=a.clientY}}},handle_mouseup:function(a){this.handleTouchend(a),this._pointerIdArray=[],this._pointerMap={}}});var Od={_hitCanvas:null,getHitCanvas:function(a,b){null==this._hitCanvas&&(this._hitCanvas=Wb.createCanvas()),0==arguments.length&&(a=2,b=2),this._hitCanvas.setAttribute("width",""+a-1),this._hitCanvas.setAttribute("height",""+b-1),this._hitCanvas.setAttribute("width",""+a),this._hitCanvas.setAttribute("height",""+b);var c=this.getCtx(this._hitCanvas);return c.clearRect(0,0,a,b),this._hitCanvas},disposeHitCanvas:function(){this._hitCanvas=null},getCtx:function(a){return a.getContext("2d")},render:function(a,c,d){c!=b&&(a.fillStyle=c,a.fill()),d!=b&&(a.strokeStyle=d,a.stroke())},text:function(a,b,c,d,e,f){a.textAlign="center",a.textBaseline="middle",null!=e&&(a.fillStyle=e,a.fillText(b,c,d)),f&&(a.strokeStyle=f,a.strokeText(b,c,d))},circle:function(a,b,c,d,e,f){a.arc(b,c,d,0,2*Math.PI,!0),a.closePath(),this.render(a,e,f)},rect:function(a,b,c,d,e,f,g){a.rect(b,c,d,e),a.closePath(),this.render(a,f,g)},OUT_LEFT:1,OUT_TOP:2,OUT_RIGHT:4,OUT_BOTTOM:8,outcode:function(a,b,c,d,e,f){var g=0;return 0>=e?g|=this.OUT_LEFT|this.OUT_RIGHT:c>a?g|=this.OUT_LEFT:a>c+e&&(g|=this.OUT_RIGHT),0>=f?g|=this.OUT_TOP|this.OUT_BOTTOM:d>b?g|=this.OUT_TOP:b>d+f&&(g|=this.OUT_BOTTOM),g},intersectsLine:function(a,b,c,d,e,f,g,h){var i,j;if(0==(j=this.outcode(c,d,e,f,g,h)))return!0;for(;0!=(i=this.outcode(a,b,e,f,g,h));){if(0!=(i&j))return!1;if(0!=(i&(this.OUT_LEFT|this.OUT_RIGHT))){var k=e;0!=(i&this.OUT_RIGHT)&&(k+=g),b+=(k-a)*(d-b)/(c-a),a=k}else{var l=f;0!=(i&this.OUT_BOTTOM)&&(l+=h),a+=(l-b)*(c-a)/(d-b),b=l}}return!0}};Ib.canvas={},Ib.canvas.interaction={},Ib.canvas.Network=function(a){Ib.canvas.Network.superClass.constructor.apply(this,arguments),this._rootCanvas=Wb.createCanvas(),this._topCanvas=Wb.createCanvas(),this.realWidth=0,this.realHeight=0,this._unionBounds={x:0,y:0,width:0,height:0},this._zoom=1,this._elementUIMap={},this._visibleMap={},this.viewRect={x:0,y:0,width:0,height:0},this.hScrollBarVisible=!1,this.vScrollBarVisible=!1,this.markerList=new Ib.List,this._topAttachmentList=new Ib.List,this.setElementBox(a?a:new Ib.ElementBox),Mb||(this._view=Wb.createView("hidden"),this._view.appendChild(this._rootCanvas),this._view.appendChild(this._topCanvas),Qb.isTouchable?Qb.isMSTouchable?this.setMSTouchInteractions():this.setTouchInteractions():this.setDefaultInteractions(!1),this.setToolTipEnabled(Ib.Defaults.NETWORK_TOOLTIP_ENABLED));var b=this;this._flowLink=function(){if(!(b.isMovingElement()||b.isSelectingElement()||b.isEditingElement()||b._box._layoutMovingElements)){b._flowLinkQuickFinder||(b._flowLinkQuickFinder=new Ib.QuickFinder(b._box,"link.flow","style"));var a=b._flowLinkQuickFinder.find(!0);a.forEach(function(a){a._styleMap["link.flow.offset"]=b.getLinkFlowOffset(a);var c=b.getElementUI(a);c.invalidate(!1)})}},Ib.imageUtil.addEventListener(this.invalidateElementUIs,this)},Jb.ext("twaver.canvas.Network",Ib.controls.View,{__accessor:["selectMode","makeVisibleOnSelected","movableFunction","editPointSize","editPointFillColor","scrollBarWidth","editPointOutlineWidth","editPointOutlineColor","editLineColor","editLineWidth","resizePointSize","resizePointFillColor","resizePointOutlineWidth","resizePointOutlineColor","resizeLineColor","resizeLineWidth","rotatePointSize","rotatePointFillColor","rotatePointOffset","rotatePointOutlineWidth","rotatePointOutlineColor","rotateScaleFillColor","rotateScaleFontColor","rotateScaleWidth","rotateScaleHeight","selectOutlineColor","selectOutlineWidth","selectFillColor","lazyMoveOutlineColor","lazyMoveOutlineWidth","lazyMoveFillColor","rectSelectFilter","paddingRight","paddingBottom","selectionTolerance"],__bool:["doubleClickToUpSubNetwork","doubleClickToSubNetwork","doubleClickToEmptySubNetwork","doubleClickToLinkBundle","doubleClickToGroupExpand","scrollBarVisible","limitViewInCanvas","autoValidateCanvasSize","subNetworkAnimate","lazyMoveAnimate","resizeAnimate","noAgentLinkVisible","keyboardRemoveEnabled","keyboardSelectEnabled","sendToTopOnSelected","lazyMoveFill","editingElement","rotatingElement","movingElement","selectingElement","rectSelectEnabled","limitElementInPositiveLocation","showRotateScale","transparentSelectionEnable","debug","showShadowInEdit"],_currentSubNetwork:null,_subNetworkAnimate:Ib.Defaults.NETWORK_SUBNETWORK_ANIMATE,_scrollBarWidth:10,_scrollBarVisible:!0,_limitViewInCanvas:!0,_autoValidateCanvasSize:!0,_makeVisibleOnSelected:Ib.Defaults.NETWORK_MAKE_VISIBLE_ON_SELECTED,_keyboardRemoveEnabled:Ib.Defaults.NETWORK_KEYBOARD_REMOVE_ENABLED,_keyboardSelectEnabled:Ib.Defaults.NETWORK_KEYBOARD_SELECT_ENABLED,_rectSelectEnabled:Ed.NETWORK_RECT_SELECT_ENABLED,_rectSelectFilter:null,_elementUIFunction:Ib.Defaults.CANVASUI_FUNCTION,_doubleClickToUpSubNetwork:Ib.Defaults.NETWORK_DOUBLECLICK_TO_UPSUBNETWORK,_doubleClickToSubNetwork:Ib.Defaults.NETWORK_DOUBLECLICK_TO_SUBNETWORK,_doubleClickToEmptySubNetwork:Ib.Defaults.NETWORK_DOUBLECLICK_TO_EMPTYSUBNETWORK,_doubleClickToLinkBundle:Ib.Defaults.NETWORK_DOUBLECLICK_TO_LINKBUNDLE,_doubleClickToGroupExpand:Ib.Defaults.NETWORK_DOUBLECLICK_TO_GROUPEXPAND,_selectOutlineColor:Ib.Defaults.NETWORK_SELECT_OUTLINE_COLOR,_selectOutlineWidth:Ib.Defaults.NETWORK_SELECT_OUTLINE_WIDTH,_selectFillColor:Ib.Defaults.NETWORK_SELECT_FILL_COLOR,_sendToTopOnSelected:Ib.Defaults.NETWORK_SENDTOTOP_ON_SELECTED,_lazyMoveOutlineColor:Ib.Defaults.NETWORK_LAZYMOVE_OUTLINE_COLOR,_lazyMoveOutlineWidth:Ib.Defaults.NETWORK_LAZYMOVE_OUTLINE_WIDTH,_lazyMoveFillColor:Ib.Defaults.NETWORK_LAZYMOVE_FILL_COLOR,_lazyMoveFill:Ib.Defaults.NETWORK_LAZYMOVE_FILL,_lazyMoveAnimate:Ib.Defaults.NETWORK_LAZYMOVE_ANIMATE,_resizePointSize:Ib.Defaults.NETWORK_RESIZE_POINT_SIZE,_resizePointFillColor:Ib.Defaults.NETWORK_RESIZE_POINT_FILL_COLOR,_resizePointOutlineColor:Ib.Defaults.NETWORK_RESIZE_POINT_OUTLINE_COLOR,_resizePointOutlineWidth:Ib.Defaults.NETWORK_RESIZE_POINT_OUTLINE_WIDTH,_resizeLineColor:Ib.Defaults.NETWORK_RESIZE_LINE_COLOR,_resizeLineWidth:Ib.Defaults.NETWORK_RESIZE_LINE_WIDTH,_resizeAnimate:Ib.Defaults.NETWORK_RESIZE_ANIMATE,_editPointSize:Ib.Defaults.NETWORK_EDIT_POINT_SIZE,_editPointFillColor:Ib.Defaults.NETWORK_EDIT_POINT_FILL_COLOR,_editPointOutlineColor:Ib.Defaults.NETWORK_EDIT_POINT_OUTLINE_COLOR,_editPointOutlineWidth:Ib.Defaults.NETWORK_EDIT_POINT_OUTLINE_WIDTH,_editLineColor:Ib.Defaults.NETWORK_EDIT_LINE_COLOR,_editLineWidth:Ib.Defaults.NETWORK_EDIT_LINE_WIDTH,_rotatePointSize:Ib.Defaults.NETWORK_ROTATE_POINT_SIZE,_rotatePointFillColor:Ib.Defaults.NETWORK_ROTATE_POINT_FILL_COLOR,_rotatePointOffset:Ib.Defaults.NETWORK_ROTATE_POINT_OFFSET,_rotatePointOutlineWidth:Ib.Defaults.NETWORK_ROTATE_POINT_OUTLINE_WIDTH,_rotatePointOutlineColor:Ib.Defaults.NETWORK_ROTATE_POINT_OUTLINE_COLOR,_rotateScaleWidth:Ed.NETWORK_ROTATE_SCALE_WIDTH,_rotateScaleHeight:Ed.NETWORK_ROTATE_SCALE_HEIGHT,_rotateScaleFillColor:Ed.NETWORK_ROTATE_SCALE_FILL_COLOR,_rotateScaleFontColor:Ed.NETWORK_ROTATE_SCALE_FONT_COLOR,_limitElementInPositiveLocation:Ed.NETWORK_LIMIT_ELEMENT_INPOSITIVE_LOCATION,_linkFlowInterval:Ed.NETWORK_LINK_FLOW_INTERVAL,_selectionTolerance:Ed.NETWORK_SELECTION_TOLERANCE,_invalidateElementVisibility:!1,_invalidateViewRectFlag:!1,_repaintTopFlag:!1,_invalidateCanvasSizeFlag:!1,_isEditingElement:!1,_isRotatingElement:!1,_isMovingElement:!1,_isSelectingElement:!1,_hasEditInteraction:!1,_showRotateScale:!0,_paddingRight:0,_paddingBottom:0,_transparentSelectionEnable:Ib.Defaults.NETWORK_TRANSPARENT_SELECTION_ENABLE,_debug:!1,_showShadowInEdit:!1,adjustBounds:function(a){if(Mb)this._rootCanvas=new Lb(a.width,a.height),this._topCanvas=new Lb(a.width,a.height),this.setViewRect(a.x,a.y,a.width,a.height);else{var b=!1,c=this._view.style;if(c.left==a.x+"px"&&c.top==a.y+"px"&&c.width==a.width+"px"&&c.height==a.height+"px"&&(b=!0),Ib.canvas.Network.superClass.adjustBounds.apply(this,arguments),1==b)return;var d=this._view.offsetWidth,e=this._view.offsetHeight;this._rootCanvas.setAttribute("width",d),this._rootCanvas.setAttribute("height",e),this._topCanvas.setAttribute("width",d),this._topCanvas.setAttribute("height",e),this.setViewRect(this.viewRect.x,this.viewRect.y,d,e)}"undefined"==typeof Ib.gis&&(Ib.Util.makeHighRes(this._rootCanvas),Ib.Util.makeHighRes(this._topCanvas)),this.invalidateElementVisibility()},getLabel:function(a){return a.getStyle("network.label")||a.getName()},getBackgroundImage:function(){return this._backgroundImage},setBackgroundImage:function(a){if(this._backgroundImage!=a){var b=this._backgroundImage;this._backgroundImage=a;var c=this._backgroundImage;if(c&&!c._viewRect)if(c.width>0)c._viewRect={x:0,y:0,width:c.width,height:c.height},this.validateCanvasSize(),this.firePropertyChange("backgroundImage",b,c);else{var d=this;c.onload=function(){c._viewRect={x:0,y:0,width:c.width,height:c.height},d.validateCanvasSize(),d.firePropertyChange("backgroundImage",b,c),c.onload=null}}else this.firePropertyChange("backgroundImage",b,c),this.validateCanvasSize()}},getRootCanvas:function(){return this._rootCanvas},getTopCanvas:function(){return this._topCanvas},validateImpl:function(){if(!Mb&&oc.twm(this),1==this._invalidateElementVisibility){this._invalidateElementVisibility=!1;var a,b,c,d=this.getElementBox().getDatas()._as,e=d.length,f={},g=this._visibleFunction,h=1===this._box._layerBox.size()?this._box._layerBox._defaultLayer:null;for(a=0;e>a;a++)b=d[a],f[b._id]=this.isVisible(b,g,h);if(this._visibleMap)for(a=0;e>a;a++)b=d[a],f[b._id]!==this._visibleMap[b._id]&&(c=this._elementUIMap[b._id],c&&c.invalidate());for(a=0;e>a;a++)b=d[a],c=this._elementUIMap[b._id],c&&c.validate();this._visibleMap=f,this.paintRoot()}this.validateCanvasSize(),1==this._repaintTopFlag&&(this._repaintTopFlag=!1,this.paintTopCanvas())},isLinkFlowEnabled:function(){return this._linkFlowEnabled?!0:!1},setLinkFlowEnabled:function(a){a?(this._linkFlowEnabled||(this._linkFlowEnabled=!0,this.firePropertyChange("linkFlowEnabled",!1,!0)),clearInterval(this._linkFlowTimerId),this._linkFlowTimerId=setInterval(this._flowLink,this._linkFlowInterval)):(this._linkFlowEnabled&&(this._linkFlowEnabled=!1,this.firePropertyChange("linkFlowEnabled",!0,!1)),clearInterval(this._linkFlowTimerId),delete this._linkFlowTimerId)},getLinkFlowInterval:function(){return this._linkFlowInterval},setLinkFlowInterval:function(a){var b=this._linkFlowInterval;this._linkFlowInterval=a,this.firePropertyChange("linkFlowInterval",b,a),clearInterval(this._linkFlowTimerId),this.isLinkFlowEnabled()&&(this._linkFlowTimerId=setInterval(this._flowLink,this._linkFlowInterval))},getElementBox:function(){return this._box},setElementBox:function(a){if(!a)throw"ElementBox can not be null";if(this._box!==a){var b=this._box;b&&(b.removeDataBoxChangeListener(this.handleElementBoxChange,this),b.removeDataPropertyChangeListener(this.handleElementPropertyChange,this),b.removePropertyChangeListener(this.handleElementBoxPropertyChange,this),b.removeIndexChangeListener(this.handleIndexChange,this),b.getLayerBox().removeDataBoxChangeListener(this.handleLayerBoxChange,this),b.getLayerBox().removeDataPropertyChangeListener(this.handleLayerPropertyChange,this),b.getLayerBox().removeHierarchyChangeListener(this.handleLayerHierarchyChange,this),this._selectionModel||b.getSelectionModel().removeSelectionChangeListener(this.handleSelectionChange,this)),this._box=a,this._box.addDataBoxChangeListener(this.handleElementBoxChange,this),this._box.addDataPropertyChangeListener(this.handleElementPropertyChange,this),this._box.addPropertyChangeListener(this.handleElementBoxPropertyChange,this),this._box.addIndexChangeListener(this.handleIndexChange,this),this._box.getLayerBox().addDataBoxChangeListener(this.handleLayerBoxChange,this),this._box.getLayerBox().addDataPropertyChangeListener(this.handleLayerPropertyChange,this),this._box.getLayerBox().addHierarchyChangeListener(this.handleLayerHierarchyChange,this),this._flowLinkQuickFinder&&(this._flowLinkQuickFinder.dispose(),this._flowLinkQuickFinder=new Ib.QuickFinder(this._box,"link.flow","style")),this._selectionModel?this._selectionModel._setDataBox(a):this._box.getSelectionModel().addSelectionChangeListener(this.handleSelectionChange,this),this._elementUIMap={},this._box.forEach(this.createElementUI,this),this.invalidateElementVisibility(),this.invalidateCanvasSize(),this.firePropertyChange("elementBox",b,this._box)}},handleElementBoxChange:function(a){var b=a.data;if("add"===a.kind)this.createElementUI(b),this.invalidateBundleLink(b);else if("remove"===a.kind){var c=this.getElementUI(b);c&&(c.dispose(),delete this._elementUIMap[b.getId()]),b===this._currentSubNetwork&&null!=this._currentSubNetwork&&this._setCurrentSubNetwork(null)}else if("clear"===a.kind){for(var d in this._elementUIMap)this._elementUIMap[d]&&this._elementUIMap[d].dispose&&this._elementUIMap[d].dispose();this._elementUIMap={},null!=this._currentSubNetwork&&this._setCurrentSubNetwork(null)}this.invalidateElementVisibility(),this.invalidateCanvasSize()},handleElementPropertyChange:function(a){var b=a.source,c=this.getElementUI(b);c&&c.handlePropertyChange(a),this.invalidateBundleLink(b),this.invalidateElementVisibility(),this.invalidateCanvasSize()},handleElementBoxPropertyChange:function(){this.invalidateElementVisibility()},handleIndexChange:function(a){this.invalidateElementVisibility()},handleLayerBoxChange:function(){this.invalidateElementVisibility()},handleLayerPropertyChange:function(a){"editable"===a.property&&this.invalidateSelectedElementUIs(!0),this.invalidateElementVisibility()},handleLayerHierarchyChange:function(){this.invalidateElementVisibility()},handleSelectionChange:function(a){a.datas.forEach(function(b){var c=this.getElementUI(b);c&&c.handleSelectionChange(a)},this);var b=this.getSelectionModel().getLastData();b&&("append"===a.kind||"set"===a.kind)&&(this.isMakeVisibleOnSelected()&&this.makeVisible(b),this.isSendToTopOnSelected()&&this.sendToTop(b)),this.invalidateElementVisibility()},sendToTop:function(a){if(this._box.contains(a)){for(var b=a;b._parent&&this.isVisible(b._parent)&&(b=b._parent););b!==a&&this._box.adjustElementIndex(b),this._box.adjustElementIndex(a)}},getScopeRect:function(a){var b=this._zoom;if("viewsize"===a)return{x:this._unionBounds.x-this.viewRect.x,y:this._unionBounds.y-this.viewRect.y,width:this._unionBounds.width,height:this._unionBounds.height};if("viewport"===a){if(this.viewRect)return Jb.cloneRect(this.viewRect)}else if("rootcanvas"===a)return{x:this.viewRect.x,y:this.viewRect.y,width:(Math.abs(this.viewRect.x-this._unionBounds.x)+this._unionBounds.width)*b,height:(Math.abs(this.viewRect.y-this._unionBounds.y)+this._unionBounds.height)*b};return{x:0,y:0,width:0,height:0}},getViewRect:function(){return this.viewRect?Jb.clone(this.viewRect):{x:0,y:0,width:0,height:0}},getCanvasSize:function(){return{width:this.realWidth,height:this.realHeight}},getUnionBounds:function(){return this._unionBounds},setViewOffSet:function(a,b){var c=this.viewRect.x,d=this.viewRect.y,e=this.viewRect.width,f=this.viewRect.height;this.setViewRect(c+a,d+b,e,f)},setViewRect:function(a,b,c,d){1==this.isLimitViewInCanvas()&&(0>a&&(a=0),c>this.realWidth?a=0:a+c>this.realWidth&&(a=this.realWidth-c),0>b&&(b=0),d>this.realHeight?b=0:b+d>this.realHeight&&(b=this.realHeight-d));var e=this.viewRect;(null==this.viewRect||a!=this.viewRect.x||b!=this.viewRect.y||c!=this.viewRect.width||d!=this.viewRect.height)&&(this.viewRect={x:a,y:b,width:c,height:d},this.firePropertyChange("viewRect",e,this.viewRect),this.invalidateElementVisibility())},isHScrollBarVisible:function(){return this.hScrollBarVisible},setHScrollBarVisible:function(a){this.hScrollBarVisible=a},isVScrollBarVisible:function(){return this.vScrollBarVisible},setVScrollBarVisible:function(a){this.vScrollBarVisible=a},dispose:function(){Ib.imageUtil.removeEventListener(this.invalidateElementUIs,this);for(var a in this._elementUIMap){var b=this._elementUIMap[a];b.curInterval&&clearTimeout(b.curInterval)}this.setInteractions(null)},invalidateElementVisibility:function(){this._invalidateElementVisibility||(this._invalidateElementVisibility=!0,this.invalidate())},repaintTopCanvas:function(){this._repaintTopFlag||(this._repaintTopFlag=!0,this.invalidate())},invalidateCanvasSize:function(a){this._invalidateCanvasSizeFlag||(this._invalidateCanvasSizeFlag=!0,this.invalidate())},validateCanvasSize:function(){0!=this._invalidateCanvasSizeFlag&&(this._invalidateCanvasSizeFlag=!1,this._validateCanvasSize())},_validateCanvasSize:function(){if(!this.isMovingElement()){if(0==this.isAutoValidateCanvasSize())return this.realWidth=0,this.realHeight=0,void(this._unionBounds={x:0,y:0,width:0,height:0});var a=this.getElementBox().getDatas(),b=a.size();if(b>0){for(var c={x:0,y:0,width:0,height:0},d=0;b>d;d++){var e=a.get(d);if(this._visibleMap[e._id]){var f=this._elementUIMap[e._id];f&&(c=Tb.unionRect(c,f._viewRect))}}var g=this.getBackgroundImage();if(g&&(c=Tb.unionRect(c,g._viewRect)),c.x<0&&(c.width+=c.x,c.x=0),c.y<0&&(c.height+=c.y,c.y=0),this.realWidth==(c.x+c.width)*this.getZoom()&&this.realHeight==(c.y+c.height)*this.getZoom())return;var h=this.getZoom();this.realWidth=(c.x+c.width)*h+this._paddingRight,this.realHeight=(c.y+c.height)*h+this._paddingBottom,this._unionBounds={x:c.x*h,y:c.y*h,width:c.width*h+this._paddingRight,height:c.height*h+this._paddingRight}}else this.realWidth=0,this.realHeight=0,this._unionBounds={x:0,y:0,width:0,height:0};this.setViewRect(this.viewRect.x,this.viewRect.y,this.viewRect.width,this.viewRect.height),this.firePropertyChange("canvasSizeChange",null,this.viewRect)}},getElementUI:function(a){return null==a?null:this._elementUIMap[a._id]},createElementUI:function(a){var b=this._elementUIMap[a.getId()];b||(b=this._elementUIFunction(this,a),b&&(this._elementUIMap[a.getId()]=b))},getElementUIFunction:function(){return this._elementUIFunction},setElementUIFunction:function(a){if(!a)throw"ElementUIFunction can not be null";if(this._elementUIFunction!==a){var b=this._elementUIFunction;this._elementUIFunction=a,this.firePropertyChange("elementUIFunction",b,a),this._box.isEmpty()||(this._elementUIMap={},this._box.forEach(this.createElementUI,this),this.invalidateElementVisibility(),this.invalidateCanvasSize())}},invalidateElementUI:function(a,b){var c=this.getElementUI(a);c&&c.invalidate(b)},invalidateElementUIs:function(a){for(var b in this._elementUIMap){var c=this._elementUIMap[b];c.invalidate(a)}},invalidateSelectedElementUIs:function(a){this.getSelectionModel().getSelection().forEach(function(b){this.invalidateElementUI(b,a)},this)},invalidateBundleLink:function(a){if(a instanceof Ib.Link&&a._bundleLinks){var b=this._elementUIMap;a._bundleLinks.forEachSiblingLink(function(c){if(c!==a){var d=b[c._id];d&&d.invalidate(!1)}},this)}},paintRoot:function(){var a=this._rootCanvas.getContext("2d");if(a.clearRect(0,0,this._rootCanvas.width,this._rootCanvas.height),this.visibleList=new Ib.List,this._topAttachmentList=new Ib.List,null!=this.getElementBox()){ld.draw(a,this);var c=this.getElementBox().getDatas()._as,d=c.length;a.save(),a.scale(this.getZoom(),this.getZoom()),a.translate(-this.viewRect.x/this.getZoom(),-this.viewRect.y/this.getZoom()),this.paintBottom(a);var e={x:this.viewRect.x/this.getZoom(),y:this.viewRect.y/this.getZoom(),width:this.viewRect.width/this.getZoom(),height:this.viewRect.height/this.getZoom()},f=this.getBackgroundImage(),g=this.getBackgroundImageRect();if(f instanceof Pb&&(g?a.drawImage(f,g.x,g.y,g.width,g.height):a.drawImage(f,0,0,f.width,f.height),f._viewRect={x:0,y:0,width:f.width,height:f.height}),"string"==typeof f){var h=Jb.getImageAsset(f),i={x:0,y:0,width:h.getWidth(),height:h.getHeight()};Nc(a,f,null,i,null,this)}var j,k,l,m,n=this._box._layerBox;if(1===n.size())for(j=0;d>j;j++)k=c[j],this._visibleMap[k._id]&&(l=this._elementUIMap[k._id],null!=l&&this._isInView(l,e)?(l.paint(a),l.setAttachmentVisible&&l.setAttachmentVisible(!0),this.visibleList.add(k)):l.setAttachmentVisible&&l.setAttachmentVisible(!1));else n.forEachByDepthFirst(function(b){for(j=0;d>j;j++)k=c[j],n.getLayerByElement(k)===b&&this._visibleMap[k._id]&&(l=this._elementUIMap[k._id],null!=l&&this._isInView(l,e)?(l.paint(a),l.setAttachmentVisible&&l.setAttachmentVisible(!0),this.visibleList.add(k)):l.setAttachmentVisible&&l.setAttachmentVisible(!1))},null,this);for(d=this._topAttachmentList.size(),j=0;d>j;j++)m=this._topAttachmentList.get(j),m.getElementUI().paintAttachment(a,m);if(this._xyz){var d,o=this._xyz,p=o.markText,q=o.type,r=(o.expired,o.innerHTML),s=0,t=0,u=this.viewRect;a.translate(this.viewRect.x/this.getZoom(),this.viewRect.y/this.getZoom()),a.scale(1/this.getZoom(),1/this.getZoom()),this.getZoom(),p!=b&&null!=p&&""!=p||"2"==q?(a.font="15px Arial sans-serif",d=Jb.g.getTextSize(a.font,r),a.fillStyle="red",s=u.width-d.width,t=u.height-20):(a.font="10px Arial sans-serif",d=Jb.g.getTextSize(a.font,r),s=u.width/2-d.width/2,t=u.height/2),a.fillText(r,s,t)}a.restore()}},paintBottom:function(a){},_isInView:function(a,b){return Tb.intersects(b,a._viewRect)},paintTopCanvas:function(){var a=this._topCanvas.getContext("2d");a.clearRect(0,0,this._topCanvas.width,this._topCanvas.height),this.paintMarker(a)},paintMarker:function(a){for(var b=this.markerList.size(),c=0;b>c;c++){var d=this.markerList.get(c);d.paint(a)}},getLayerByElement:function(a){return this._box.getLayerBox().getLayerByElement(a)},getLogicalPoint:function(a){var b;if(Qb.isTouchable&&a.changedTouches&&a.changedTouches.length>0){var c=this._view.getBoundingClientRect(),d=a.changedTouches[0],e=Qb.isAndroid?0:zc.scrollLeft(),f=Qb.isAndroid?0:zc.scrollTop();return b={x:(d.clientX+this.viewRect.x-c.left-e)/this._zoom,y:(d.clientY+this.viewRect.y-c.top-f)/this._zoom}}return b=Qb.isFirefox?{x:(a.layerX+this.viewRect.x)/this.getZoom(),y:(a.layerY+this.viewRect.y)/this.getZoom()}:{x:(a.offsetX+this.viewRect.x)/this.getZoom(),y:(a.offsetY+this.viewRect.y)/this.getZoom()}},getElementAt:function(a,b){if(null==this.visibleList)return null;1===arguments.length&&(b=!0);var c,d;if(a.target?c=this.getLogicalPoint(a):a.event?a.event.target&&(c=this.getLogicalPoint(a.event)):c=a,null!=this._topAttachmentList)for(var e=this._topAttachmentList.size(),f=e-1;f>=0;f--){var g=this._topAttachmentList.get(f);if(d=g.getElement(),(!b||this.isSelectable(d))&&g.hit(c.x,c.y))return d}if(null!=this.visibleList)for(var h=this.visibleList.size(),i=h-1;i>=0;i--){var j=this.visibleList.get(i),k=this.getElementUI(j);if((!b||this.isSelectable(j))&&k&&k.hit(c.x,c.y))return j}return null},hitTest:function(a){var b=this.getElementAt(a);if(!b)return null;var c=this.getElementUI(b);if(!c)return null;var d;return d=a.target?this.getLogicalPoint(a):a,c.hitTest(d.x,d.y)},getElementsAtRect:function(a,c,d,e){var f=new Ib.List;if(null==this.visibleList)return f;e=e===b?!0:e;for(var g=this.visibleList.size(),h=g-1;h>=0;h--){var i=this.visibleList.get(h),j=this.getElementUI(i);j&&(!d||d(j._element))&&(e&&this.isSelectable(j._element)||!e)&&(c?j.intersects(a)&&f.add(i):Tb.contains(a,j.getViewRect())&&f.add(i))}return f},getPosition:function(a,b,c,d,e){var f,g=b instanceof Ib.canvas.ElementUI?b:this.getElementUI(b);if(g)if("from"===a||"to"===a){if(g.getFromPosition&&(f="from"===a?g.getFromPosition(d,e):g.getToPosition(d,e)))return c?{x:f.x-c.width/2,y:f.y-c.height/2}:f}else f="hotspot"===a?g.getHotSpot():Vb.get(a,g.getBodyRect(),c);if(!f&&b.getRect&&(f=Vb.get(a,b.getRect(),c)),f)return{x:f.x+d,y:f.y+e};throw"position '"+a+"' object '"+b+"'"},isValidEvent:function(a){if(!a)return!1;var b,c;if(a.currentTarget===this._view){if(Qb.isFirefox?(b=a.layerX,c=a.layerY):(b=a.offsetX,
c=a.offsetY),1==this.isHScrollBarVisible()&&c>=this.viewRect.height-this.getScrollBarWidth())return!1;if(1==this.isVScrollBarVisible()&&b>=this.viewRect.width-this.getScrollBarWidth())return!1}return!0},addMarker:function(a){this.markerList.add(a),this.repaintTopCanvas()},removeMarker:function(a){this.markerList.remove(a),this.repaintTopCanvas()},clearMarker:function(){this.markerList.clear(),this.repaintTopCanvas()},isMovable:function(a){return this._box.contains(a)?a instanceof Ib.Link?!1:this._movableFunction&&!this._movableFunction(a)?!1:this.getLayerByElement(a).isMovable():!1},hasMovableSelectedElements:function(){for(var a=this.getSelectionModel().getSelection(),b=0;b<a.size();b++){var c=a.get(b);if(this.isMovable(c))return!0}return!1},getMovableSelectedElements:function(){return this.getSelectionModel().toSelection(function(a){return this.isMovable(a)},this)},moveSelectedElements:function(a,b,c,d){if(0!==a||0!==b){var e=this.getMovableSelectedElementsRect();null!=e&&(this._limitElementInPositiveLocation&&(e.x+a<0&&(a=-e.x),e.y+b<0&&(b=-e.y)),Ib.Util.moveElements(this.getMovableSelectedElements(),a,b,c,d,this))}},getMovableSelectedElementsRect:function(){var a=this.getMovableSelectedElements();if(0===a.size())return null;for(var b=null,c=0,d=a.size();d>c;c++){var e=a.get(c);if(e instanceof Ld){var f=this.getElementUI(e);f&&(b=Tb.unionRect(b,f.getViewRect()))}}return b},isVisible:function(a,b,c){if(!this._box.contains(a))return!1;if(!a.isVisible())return!1;if(3!==arguments.length&&(b=this._visibleFunction),b&&!b(a))return!1;if(!(c||this._box._layerBox.getLayerByElement(a))._visible)return!1;if(vc.getSubNetwork(a)!==this._currentSubNetwork)return!1;if(a instanceof Ib.Link){if(!this._noAgentLinkVisible){if(!a._fromAgent||!a._toAgent)return!1;if(!this.isVisible(a._fromAgent,b,c)||!this.isVisible(a._toAgent,b,c))return!1}if(a.getBundleIndex()>0&&a.getBundleCount()>1&&!a.getStyle("link.bundle.expanded"))return!1}else for(var d=a._parent;d&&!d.ISubNetwork;){if(d instanceof Ib.Group&&(!d.isExpanded()||!this.isVisible(d,b,c)))return!1;d=d._parent}return a.IDummy?!1:!0},getVisibleFunction:function(){return this._visibleFunction},setVisibleFunction:function(a){var b=this._visibleFunction;this._visibleFunction=a,this.firePropertyChange("visibleFunction",b,a),this.invalidateElementVisibility()},isEditable:function(a){return this._box.contains(a)?this._editableFunction&&!this._editableFunction(a)?!1:this.getLayerByElement(a).isEditable():!1},getEditableFunction:function(){return this._editableFunction},setEditableFunction:function(a){var b=this._editableFunction;this._editableFunction=a,this.firePropertyChange("editableFunction",b,a),this.invalidateSelectedElementUIs(!0)},isRotatable:function(a){return this._rotatableFunction&&!this._rotatableFunction(a)?!1:!0},getRotatableFunction:function(){return this._rotatableFunction},setRotatableFunction:function(a){var b=this._rotatableFunction;this._rotatableFunction=a,this.firePropertyChange("rotatableFunction",b,a),this.invalidateSelectedElementUIs(!0)},isLinkable:function(a){return null==this._linkableFunction||this._linkableFunction(a)},getLinkableFunction:function(){return this._linkableFunction},setLinkableFunction:function(a){var b=this._linkableFunction;this._linkableFunction=a,this.firePropertyChange("linkableFunction",b,a),this.invalidateSelectedElementUIs(!0)},onShareSelectionModelChanged:function(){this.invalidateElementUIs()},getShadowColor:function(a){var b=a.getStyle("shadow.color");return!b&&this.isSelected(a)&&"shadow"===a.getStyle("select.style")?a.getStyle("select.color"):b},getSelectColor:function(a){return a.getStyle("select.color")},getAlarmLabel:function(a){var b=a.getAlarmState().getHighestNewAlarmSeverity();if(b){var c=a.getAlarmState().getNewAlarmCount(b)+b.nickName;return a.getAlarmState().hasLessSevereNewAlarms()&&(c+="+"),c}return null},getLinkHandlerLabel:function(a){return a.isBundleAgent()?"+("+a.getBundleCount()+")":null},setInteractions:function(a){var b=this._interactions;b&&b.forEach(function(a){a.tearDown()}),this._interactions=a,a&&a.forEach(function(a){a.setUp()}),this.invalidateSelectedElementUIs(!0),this.firePropertyChange("interactions",b,a)},getInteractions:function(){return this._interactions},setDefaultInteractions:function(a){this.setInteractions([new Ib.canvas.interaction.DefaultInteraction(this),new Ib.canvas.interaction.SelectInteraction(this),new Ib.canvas.interaction.MoveInteraction(this,a),new Ib.canvas.interaction.ScrollInteraction(this)])},setTouchInteractions:function(){this.setInteractions([new Ib.canvas.interaction.DefaultInteraction(this),new Ib.canvas.interaction.SelectInteraction(this),new Ib.canvas.interaction.MoveInteraction(this,!1),new Ib.canvas.interaction.ScrollInteraction(this),new Ib.canvas.interaction.TouchInteraction(this)])},setMSTouchInteractions:function(){this.setInteractions([new Ib.canvas.interaction.ScrollInteraction(this),new Ib.canvas.interaction.MSTouchInteraction(this)])},setEditInteractions:function(a){this.setInteractions([new Ib.canvas.interaction.DefaultInteraction(this),new Ib.canvas.interaction.SelectInteraction(this),new Ib.canvas.interaction.EditInteraction(this,a),new Ib.canvas.interaction.MoveInteraction(this,a),new Ib.canvas.interaction.ScrollInteraction(this)])},setCreateElementInteractions:function(a){this.setInteractions([new Ib.canvas.interaction.DefaultInteraction(this),new Ib.canvas.interaction.CreateElementInteraction(this,a)])},setCreateLinkInteractions:function(a){this.setInteractions([new Ib.canvas.interaction.DefaultInteraction(this),new Ib.canvas.interaction.CreateLinkInteraction(this,a),new Ib.canvas.interaction.ScrollInteraction(this)])},setCreateShapeLinkInteractions:function(a){this.setInteractions([new Ib.canvas.interaction.DefaultInteraction(this),new Ib.canvas.interaction.CreateShapeLinkInteraction(this,a),new Ib.canvas.interaction.ScrollInteraction(this)])},setCreateShapeNodeInteractions:function(a){this.setInteractions([new Ib.canvas.interaction.DefaultInteraction(this),new Ib.canvas.interaction.CreateShapeNodeInteraction(this,a),new Ib.canvas.interaction.ScrollInteraction(this)])},setPanInteractions:function(){this.setInteractions([new Ib.canvas.interaction.DefaultInteraction(this),new Ib.canvas.interaction.PanInteraction(this),new Ib.canvas.interaction.ScrollInteraction(this)])},setMagnifyInteractions:function(){this.setInteractions([new Ib.canvas.interaction.DefaultInteraction(this),new Ib.canvas.interaction.SelectInteraction(this),new Ib.canvas.interaction.MoveInteraction(this),new Ib.canvas.interaction.ScrollInteraction(this),new Ib.canvas.interaction.MagnifyInteraction(this)])},hasEditInteraction:function(){return this._hasEditInteraction},setHasEditInteraction:function(a){var b=this._hasEditInteraction;this._hasEditInteraction=a,this.firePropertyChange("hasEditInteraction",b,a)},addElementByInteraction:function(a){a.getParent()||a.setParent(this._currentSubNetwork),this._box.add(a),this.getSelectionModel().setSelection(a),this.fireInteractionEvent({kind:"createElement",element:a})},getToolTip:function(a){if(a){var b=a.getToolTip();return b?b:a.getName()}return null},isToolTipEnabled:function(){return this._toolTipEnabled?!0:!1},setToolTipEnabled:function(a){if(this._toolTipEnabled=a,a){if(!this._toolTipListener){var b=this;this._toolTipListener=function(a){if(b.isMovingElement())return void Bc.hideToolTip();var c=b.getElementAt(a);if(b._preElement!==c)if(b._preElement=c,c){var d=b.getToolTip(c);Bc.showToolTip({x:a.pageX,y:a.pageY},d);var e=Bc.getToolTipDiv(),e=Bc.getToolTipDiv();if(e.children.length>0){var f=b._view.getBoundingClientRect(),g=e.getBoundingClientRect();g.width+g.left>f.width+f.left&&(e.style.left=f.width+f.left-g.width+(Ob.documentElement.scrollLeft||Ob.body.scrollLeft)+"px"),g.height+g.top>f.height+f.top&&(e.style.top=f.height+f.top-g.height+(Ob.documentElement.scrollTop||Ob.body.scrollTop)+"px")}}else Bc.hideToolTip()},this._view.addEventListener("mousemove",this._toolTipListener,!1),this.firePropertyChange("toolTipEnabled",!1,!0)}}else this._toolTipListener&&(Bc.hideToolTip(),this._view.removeEventListener("mousemove",this._toolTipListener,!1),delete this._toolTipListener,this.firePropertyChange("toolTipEnabled",!0,!1))},setZoom:function(a){a=this.checkZoom(a);var b=this._zoom;if(this._zoom!=a){var c={x:(this.viewRect.x+this.viewRect.width/2)/this.getZoom()*a,y:(this.viewRect.y+this.viewRect.height/2)/this.getZoom()*a};this._zoom=a,this.invalidateElementVisibility(),this.invalidateCanvasSize(),this.validateCanvasSize(),this.setViewRect(c.x-this.viewRect.width/2,c.y-this.viewRect.height/2,this.viewRect.width,this.viewRect.height),this.firePropertyChange("zoom",b,this._zoom)}},getZoom:function(){return this._zoom},setTouchZoom:function(a){this.setZoom(a,!1)},zoomOverview:function(a){if(!(this.realWidth<=0||this.realHeight<=0)){var b=this.realWidth/this.getZoom(),c=this.realHeight/this.getZoom(),d=this.viewRect.width/b,e=this.viewRect.height/c,f=Math.min(d,e);this.setZoom(f)}},zoomReset:function(){this.setZoom(1)},zoomIn:function(){this.setZoom(1.2*this.getZoom())},zoomOut:function(){this.setZoom(this.getZoom()/1.2)},upSubNetwork:function(a,b){this._currentSubNetwork&&this.setCurrentSubNetwork(vc.getSubNetwork(this._currentSubNetwork),a,b)},getCurrentSubNetwork:function(){return this._currentSubNetwork},setCurrentSubNetwork:function(a,b,c){if(Ib.animate.AnimateManager.endAnimate(),b){if(this._currentSubNetwork===a)return;if(a&&!this._box.contains(a))throw a+" is not contained in this network's elementBox";var d=new Ib.animate.AnimateSubNetwork(this,a,c);Ib.animate.AnimateManager.start(d)}else this._setCurrentSubNetwork(a),c&&c()},_setCurrentSubNetwork:function(a){if(this._currentSubNetwork!==a){if(a&&!this._box.contains(a))throw a+" is not contained in this network's elementBox";var b=this._currentSubNetwork;this._currentSubNetwork=a,this.firePropertyChange("currentSubNetwork",b,a),this.invalidateElementVisibility(),this.invalidateCanvasSize()}},makeVisible:function(a){var b=this.getElementUI(a);if(b){var c=vc.getSubNetwork(a);if(c!==this._currentSubNetwork){var d=this;return void this.setCurrentSubNetwork(c,this.isSubNetworkAnimate(),function(){Jb.callLater(d.makeVisible,d,[a])})}for(var e=a;(e=e.getParent())&&e!==c;)e instanceof Ib.Group&&e.setExpanded(!0);var f=b.getViewRect();if(f){var g={x:f.x*this.getZoom(),y:f.y*this.getZoom(),width:f.width*this.getZoom(),height:f.height*this.getZoom()};Tb.intersects(this.viewRect,g)||this.isVisible(a)&&Jb.callLater(this.centerByLogicalPoint,this,[g.x+g.width/2,g.y+g.height/2])}}},centerByLogicalPoint:function(a,b,c){var d=a-this.viewRect.width/2,e=b-this.viewRect.height/2;this.setViewRect(d,e,this.viewRect.width,this.viewRect.height)},panByOffset:function(a,b){this.setViewOffSet(a,b)},getIconsNames:function(a){return a.getStyle("icons.names")},getIconsColors:function(a){return a.getStyle("icons.colors")},getLinkFlowStepping:function(a){var b=parseInt(a.getStyle("link.flow.stepping"));return b||(b=Ed.NETWORK_LINK_FLOW_STEPPING),b},getLinkFlowOffset:function(a){var b=a.getStyle("link.flow.offset");return isNaN(b)&&(b=0),b+this.getLinkFlowStepping(a)},toCanvas:function(a,b,c){c||(c=Wb.createCanvas()),c.setAttribute("width",a),c.setAttribute("height",b),c._viewRect?(c._viewRect.width=a,c._viewRect.height=b):c._viewRect={x:0,y:0,width:a,height:b};var d=c.getContext("2d");if(d.clearRect(0,0,a,b),ld.draw(d,this),0===this._view.clientWidth||0===this._view.clientHeight)return c;var e=a/this.realWidth*this._zoom,f=b/this.realHeight*this._zoom;d.scale(e,f);var g=this.getBackgroundImage();if(g&&g._viewRect){var h=g._viewRect;try{d.drawImage(g,h.x,h.y,h.width,h.height)}catch(i){}}var j=this.getElementBox().getDatas()._as,k=j.length;this._topAttachmentList=new Ib.List;var l,m,n,o,p,q,r=this.getElementBox().getLayerBox(),s=r.getRoots(),t=s.size();if(1===t)for(n=0;k>n;n++)o=j[n],this._visibleMap[o._id]&&(p=this._elementUIMap[o._id],null!=p&&p.paint(d));else for(l=0;t>l;l++)for(m=s.get(l),n=0;k>n;n++)o=j[n],r.getLayerByElement(o)===m&&this._visibleMap[o._id]&&(p=this._elementUIMap[o._id],null!=p&&p.paint(d));for(k=this._topAttachmentList.size(),n=0;k>n;n++)q=this._topAttachmentList.get(n),q.getElementUI().paintAttachment(d,q);return c},toCanvasByRegion:function(a,b,c){c||(c=Wb.createCanvas());var d=a.width*b,e=a.height*b;c.setAttribute("width",d),c.setAttribute("height",e),c._viewRect?(c._viewRect.width=d,c._viewRect.height=e):c._viewRect={x:0,y:0,width:d,height:e};var f=c.getContext("2d");if(f.clearRect(0,0,d,e),ld.draw(f,this),0===this._view.clientWidth||0===this._view.clientHeight)return c;f.save(),f.scale(b,b),f.beginPath(),f.translate(-a.x,-a.y);var g=this.getElementBox().getDatas()._as,h=g.length;this._topAttachmentList=new Ib.List;var i=this.getBackgroundImage();if(i&&i._viewRect&&Tb.intersects(a,i._viewRect)){var a=Tb.intersection(a,i._viewRect),j=i._viewRect;try{f.drawImage(i,j.x,j.y,j.width,j.height)}catch(k){}}var l,m,n,o,p,q,r=this.getElementBox().getLayerBox(),s=r.getRoots(),t=s.size();if(1===t)for(n=0;h>n;n++)o=g[n],this._visibleMap[o._id]&&(p=this._elementUIMap[o._id],null!=p&&Tb.intersects(a,p._viewRect)&&p.paint(f));else for(l=0;t>l;l++)for(m=s.get(l),n=0;h>n;n++)o=g[n],r.getLayerByElement(o)===m&&this._visibleMap[o._id]&&(p=this._elementUIMap[o._id],null!=p&&Tb.intersects(a,p._viewRect)&&p.paint(f));for(h=this._topAttachmentList.size(),n=0;h>n;n++)q=this._topAttachmentList.get(n),q.getElementUI().paintAttachment(f,q);return f.restore(),c},getGroupChildrenRects:function(a){var b=new nd;return a.getChildren().forEach(function(a){if(a instanceof Ld){var c=this.getElementUI(a);if(c){var d=c.getViewRect();d&&b.add(d)}}},this),b},getBackgroundImageRect:function(){return null},getLinkPathFunction:function(){return this._linkPathFunction},setLinkPathFunction:function(a){var b=this._linkPathFunction;this._linkPathFunction=a,this.firePropertyChange("linkPathFunction",b,a),this.invalidateElementUIs()},onClickElement:function(a,b){},onClickBackground:function(a){},onDoubleClickElement:function(a,b){},onDoubleClickBackground:function(a){},onLongClickElement:function(a,b){},onLongClickBackground:function(a){},onMouseMove:function(a,b){},onMouseEnter:function(a,b){},onMouseLeave:function(a,b){},setMovingElement:function(a){if(a!=this._movingElement){var b=this._movingElement;this._movingElement=a,this.firePropertyChange("movingElement",b,a),this._box._undoManager._enabled&&(a?this._box._undoManager.startBatch():this._box._undoManager.endBatch())}},setEditingElement:function(a){if(a!=this._editingElement){var b=this._editingElement;this._editingElement=a,this.firePropertyChange("editingElement",b,a),this._box._undoManager._enabled&&(a?this._box._undoManager.startBatch():this._box._undoManager.endBatch())}}}),Ib.canvas.Overview=function(a){Ib.canvas.Overview.superClass.constructor.apply(this,a),this._view=Wb.createView(),this._rootDiv=Wb.createDiv(),this._imageCanvas=Wb.createCanvas(),this._imageDiv=Wb.createDiv(),this._maskCanvas=Wb.createCanvas(),this._selectDiv=Wb.createDiv(),this._isNetworkDirty=!1,this._isMaskDirty=!1,Wb.setVisible(this._selectDiv,!1),this._view.appendChild(this._rootDiv),this._rootDiv.appendChild(this._imageDiv),this._rootDiv.appendChild(this._maskCanvas),this._rootDiv.appendChild(this._selectDiv),this._imageDiv.appendChild(this._imageCanvas),this.setNetwork(a),Qb.isTouchable?Qb.isMSTouchable?new Ib.canvas.OverviewMSTouchInteraction(this):(new Ib.canvas.OverviewTouchInteraction(this),new Ib.canvas.OverviewInteraction(this)):new Ib.canvas.OverviewInteraction(this)},Jb.ext("twaver.canvas.Overview",Ib.controls.ControlBase,{__accessor:["fillColor","outlineColor","outlineWidth","selectColor","selectWidth","padding","maxPackingWidth","maxPackingHeight"],__bool:["animate"],_fillColor:Ed.OVERVIEW_FILL_COLOR,_outlineColor:Ed.OVERVIEW_OUTLINE_COLOR,_outlineWidth:Ed.OVERVIEW_OUTLINE_WIDTH,_selectColor:Ed.OVERVIEW_SELECT_COLOR,_selectWidth:Ed.OVERVIEW_SELECT_WIDTH,_padding:Ed.OVERVIEW_PADDING,_animate:Ed.OVERVIEW_ANIMATE,_maxPackingWidth:Ed.OVERVIEW_MAX_PACKING_WIDTH,_maxPackingHeight:Ed.OVERVIEW_MAX_PACKING_HEIGHT,getNetwork:function(){return this._network},onPropertyChanged:function(a){this._invalidateMask()},setNetwork:function(a){a!==this._network&&(this._network&&(this._network.removePropertyChangeListener(this._handleNetworkPropertyChange,this),this._network.removeViewListener(this._handleNetworkViewChange,this),Wb.removeEventListener("scroll","_handleScrollChange",this._network.getView(),this)),this._network=a,this._network&&(this._network.addPropertyChangeListener(this._handleNetworkPropertyChange,this),this._network.addViewListener(this._handleNetworkViewChange,this),Wb.addEventListener("scroll","_handleScrollChange",this._network.getView(),this)),this.invalidate())},_handleNetworkPropertyChange:function(a){("zoom"===a.property||"currentSubNetwork"===a.property||"elementBox"===a.property||"dataBox"===a.property||"canvasSizeChange"===a.property)&&this.invalidate()},_handleNetworkViewChange:function(a){"validateEnd"===a.kind&&this.invalidate()},_handleScrollChange:function(){this._invalidateMask()},invalidate:function(a){this._isNetworkDirty&&this._isMaskDirty||(this._isNetworkDirty||(this._isNetworkDirty=!0),this._isMaskDirty||(this._isMaskDirty=!0),Jb.callLater(this.validate,this,null,a))},_invalidateMask:function(){this._isMaskDirty||(this._isMaskDirty=!0,Jb.callLater(this.validate,this,[],100))},validate:function(){if((this._isMaskDirty||this._isNetworkDirty)&&this._network&&(this._maxPackingWidth>0&&this._maxPackingHeight>0||this._view.clientWidth>0&&this._view.clientHeight>0)&&0!==this._network.getViewRect().width&&0!==this._network.getViewRect().height&&!this._network._invalidate){var a,b=this._maxPackingWidth>0&&this._maxPackingHeight>0;a=b?{x:0,y:0,width:this._maxPackingWidth,height:this._maxPackingHeight}:{x:0,y:0,width:this._view.clientWidth,height:this._view.clientHeight},Tb.grow(a,-this._padding,-this._padding);var c=Math.min(a.width/this._network.getCanvasSize().width,a.height/this._network.getCanvasSize().height);b&&(Wb.setDiv(this._view,{x:0,y:0,width:this._imageDiv._viewRect.width,height:this._imageDiv._viewRect.height},null,0,null),a.width=this._imageDiv._viewRect.width,a.height=this._imageDiv._viewRect.height);var d=this._network.getCanvasSize().width*c,e=this._network.getCanvasSize().height*c,f=a.x+(a.width-d)/2,g=a.y+(a.height-e)/2;if(this._isNetworkDirty){var h={x:f,y:g,width:d,height:e};this._network.toCanvas(h.width,h.height,this._imageCanvas),Wb.setDiv(this._imageDiv,h,null,0,null),this._network.getElementBox&&(this._imageDiv.style.backgroundColor=(this._network.getCurrentSubNetwork()||this._network.getElementBox()).getStyle("background.color")||""),this._isNetworkDirty=!1}if(this._isMaskDirty){var i={x:this._network.getViewRect().x*c,y:this._network.getViewRect().y*c,width:d*this._network._view.clientWidth/this._network.getCanvasSize().width,height:e*this._network._view.clientHeight/this._network.getCanvasSize().height};i.x=i.x<0?0:i.x,i.y=i.y<0?0:i.y;var j=Wb.setCanvas(this._maskCanvas,f,g,d,e);j.lineWidth=0,j.fillStyle=this._fillColor,j.beginPath(),Xb.drawVector(j,"rectangle",null,f,g,d,e),j.fill(),j.clearRect(f+i.x,g+i.y,i.width,i.height);var k=this._outlineWidth<0?0:this._outlineWidth;j.lineWidth=k,j.strokeStyle=this._outlineColor;var l=i.width-2*k,m=i.height-2*k;l=Math.min(l,d-2-i.x-this._outlineWidth),m=Math.min(m,e-2-i.y-this._outlineWidth),j.beginPath(),Xb.drawVector(j,"rectangle",null,f+i.x+k,g+i.y+k,l,m),k>=0&&j.stroke(),this._isMaskDirty=!1}}else this._isNetworkDirty=!1,this._isMaskDirty=!1},getLogicalPoint:function(a){return Wb.getLogicalPoint(this._view,a,1,this._rootDiv)},centerNetwork:function(a,b){var c=this._imageDiv._viewRect;Tb.containsPoint(c,a)&&(this._network.centerByLogicalPoint((a.x-c.x)/c.width*this._network.getCanvasSize().width,(a.y-c.y)/c.height*this._network.getCanvasSize().height,b),this._invalidateMask())}}),Ib.canvas.OverviewTouchInteraction=function(a){this.overview=a,this.network=a.getNetwork(),this.view=a._view,Wb.addEventListener("touchstart","handleTouchstart",this.view,this)},Jb.ext("twaver.canvas.OverviewTouchInteraction",Object,{handleTouchstart:function(a){Wb.preventDefault(a),this.clear(),this.endPoint=this.overview.getLogicalPoint(a),zc.isMultiTouch(a)&&(this.distance=zc.getDistance(a),this.zoom=this.network.getZoom()),Wb.addEventListener("touchmove","handleTouchmove",this.view,this),Wb.addEventListener("touchend","handleTouchend",this.view,this)},handleTouchmove:function(a){if(this.moved||(this.moved=!0),this.endPoint=this.overview.getLogicalPoint(a),zc.isSingleTouch(a))this.overview.centerNetwork(this.endPoint,!1);else if(this.distance){var b=zc.getDistance(a)/this.distance;this.network.setZoom(this.zoom*b,!1)}},handleTouchend:function(a){if(!this.moved){this.endPoint=this.overview.getLogicalPoint(a);var b=this.lastPoint&&this.lastTouchStartTime&&(new Date).getTime()-this.lastTouchStartTime.getTime()<=300&&Math.abs(this.endPoint.x-this.lastPoint.x)<=10&&Math.abs(this.endPoint.y-this.lastPoint.y)<=10;b?(this.lastPoint=null,this.lastTouchStartTime=null):(this.lastPoint=this.endPoint,this.lastTouchStartTime=new Date),b?Jb.callLater(this.network.zoomReset,this.network,[this.overview._animate]):this.overview.centerNetwork(this.endPoint,this.overview._animate)}this.clear()},clear:function(){this.endPoint&&(this.endPoint=null,Wb.removeEventListener("touchmove",this.view,this),Wb.removeEventListener("touchend",this.view,this)),this.moved=!1}}),Ib.canvas.OverviewMSTouchInteraction=function(a){this.overview=a,this.network=a.getNetwork(),this.view=a._view,this._pointerMap={},this._pointerIdArray=[],Wb.addEventListener("MSPointerDown","handleTouchstart",this.view,this),Wb.addEventListener("MSPointerMove","handleTouchmove",this.view,this),Wb.addEventListener("MSPointerUp","handleTouchend",this.view,this),Wb.addEventListener("MSPointerCancel","handleTouchend",this.view,this)},Jb.ext("twaver.canvas.OverviewMSTouchInteraction",Object,{handleTouchstart:function(a){Wb.preventDefault(a),a.isPrimary&&this._pointerIdArray.length>0&&(this._pointerMap={},this._pointerIdArray=[]),!this._pointerMap[a.pointerId]&&this.overview.getLogicalPoint(a)&&(this._pointerIdArray.push(a.pointerId),this._pointerMap[a.pointerId]=a),1==this._pointerIdArray.length?(this._startTouchPoint=this.overview.getLogicalPoint(a),this._startTouchTime=new Date):2==this._pointerIdArray.length&&(this._distance=this._getDistance(),this._zoom=this.network.getZoom())},handleTouchmove:function(a){if(0!=this._pointerIdArray.length&&this._pointerMap[a.pointerId]&&!(Tb.getDistance({x:this._pointerMap[a.pointerId].pageX,y:this._pointerMap[a.pointerId].pageY},{x:a.pageX,y:a.pageY})<=10))if(this._pointerMap[a.pointerId]=a,2==this._pointerIdArray.length){var b=this._getDistance()/this._distance;this.network.setZoom(this._zoom*b,!1)}else if(1==this._pointerIdArray.length&&this._startTouchPoint){var c=this.overview.getLogicalPoint(a);if(null==c)return;this._startTouchPoint=c,this.overview.centerNetwork(this._startTouchPoint,!1)}},handleTouchend:function(a){var b=this.overview.getLogicalPoint(a);if(1==this._pointerIdArray.length&&b){var c=this._endTouchPoint&&this._endTouchTime&&(new Date).getTime()-this._endTouchTime.getTime()<=500&&Tb.getDistance(this._endTouchPoint,b)<=10;c?(this._endTouchPoint=null,this._endTouchTime=null):(this._endTouchPoint=b,this._endTouchTime=new Date),c?Jb.callLater(this.network.zoomReset,this.network,[this.overview._animate]):this.overview.centerNetwork(this._endTouchPoint,this.overview._animate)}this._pointerMap={},this._pointerIdArray=[]},_getDistance:function(){return Tb.getDistance({x:this._pointerMap[this._pointerIdArray[0]].pageX,y:this._pointerMap[this._pointerIdArray[0]].pageY},{x:this._pointerMap[this._pointerIdArray[1]].pageX,y:this._pointerMap[this._pointerIdArray[1]].pageY})}}),Ib.canvas.OverviewInteraction=function(a){this.overview=a,this.network=a.getNetwork(),this.view=a._view,Wb.addEventListener("mousedown","handleMousedown",this.view,this)},Jb.ext("twaver.canvas.OverviewInteraction",Object,{handleMousedown:function(a){0===a.button&&(this.clear(),this.endPoint=this.overview.getLogicalPoint(a),Jb.isCtrlDown(a)&&(this.startPoint=this.endPoint,Wb.setVisible(this.overview._selectDiv,!0)),Wb.addEventListener("mousemove","handleMousemove",this.view,this),Wb.addEventListener("mouseup","handleMouseup",this.view,this))},handleMouseup:function(a){if(this.endPoint=this.overview.getLogicalPoint(a),"detail"in a&&2===a.detail)Jb.callLater(this.network.zoomReset,this.network,[this.overview._animate]);else if(Wb.isVisible(this.overview._selectDiv)&&this.startPoint){var b=this.overview._imageDiv._viewRect,c=this.overview._selectDiv._viewRect.x,d=this.overview._selectDiv._viewRect.y,e=b.width/this.overview._selectDiv._viewRect.width,f=b.height/this.overview._selectDiv._viewRect.height,g=Math.min(e,f);this.network.setZoom(g*Math.min(this.network.getViewRect().width/this.network.getCanvasSize().width,this.network.getViewRect().height/this.network.getCanvasSize().height)*this.network.getZoom(),!1);var h=this.network.getCanvasSize().width*((c-b.x+this.overview._selectDiv._viewRect.width/2)/b.width),i=this.network.getCanvasSize().height*((d-b.y+this.overview._selectDiv._viewRect.height/2)/b.height);Jb.callLater(this.network.centerByLogicalPoint,this.network,[h,i,this.overview._animate]),Wb.setVisible(this.overview._selectDiv,!1),Wb.setDiv(this.overview._selectDiv,{x:0,y:0,width:0,height:0},null,0,null),this.startPoint=null}else this.overview.centerNetwork(this.endPoint,this.overview._animate);this.clear()},handleMousemove:function(a){var b=this.overview.getLogicalPoint(a);if(this.endPoint=b,Wb.isVisible(this.overview._selectDiv)&&this.startPoint){var c=b.x>this.startPoint.x?this.startPoint.x:b.x,d=b.x>this.startPoint.x?this.startPoint.y:b.y;b.x>this.startPoint.x&&b.y<this.startPoint.y&&(d=b.y),b.x<this.startPoint.x&&b.y>this.startPoint.y&&(d=this.startPoint.y);var e=this.overview._imageDiv._viewRect;c<e.x&&(c=e.x),c>e.x+e.width&&(c=e.x+e.width),d<e.y&&(d=e.y),d>e.y+e.height&&(d=e.y+e.height);var f=Math.abs(b.x-this.startPoint.x),g=Math.abs(b.y-this.startPoint.y);c+f>e.x+e.width&&(f=e.x+e.width-c),d+g>e.y+e.height&&(g=e.y+e.height-d),Wb.setDiv(this.overview._selectDiv,{x:c,y:d,width:f,height:g},null,this.overview._selectWidth,this.overview._selectColor)}else this.overview.centerNetwork(b,!1)},clear:function(){this.endPoint&&(this.endPoint=null,Wb.removeEventListener("mousemove",this.view,this),Wb.removeEventListener("mouseup",this.view,this))}}),Ib.canvas.ElementUI=function(a,b){this._network=a,this._element=b,this._attachments=new Ib.List,this._bodyBounds=new Ib.List,this._hitTest=!1,this._hitTest=!1,this._intersectTest=!1,this.invalidate(!0)},Jb.ext("twaver.canvas.ElementUI",Object,{getElement:function(){return this._element},getNetwork:function(){return this._network},handlePropertyChange:function(a){this.invalidate(!0)},handleSelectionChange:function(a){this.invalidate(!0)},invalidate:function(a){a===b&&(a=!0),a&&(this._invalidateAttachmentsFlag=!0),this._invalidateFlag||(this._hotSpot=null,this._bodyRect=null,this._invalidateFlag=!0,this._network.invalidateElementVisibility())},updateStyle:function(){this._innerColor=this._network.getInnerColor(this._element),this._outerColor=this._network.getOuterColor(this._element),this._shadowColor=this._network.getShadowColor(this._element),this._shadowXOffset=this._element.getStyle("shadow.xoffset"),this._shadowYOffset=this._element.getStyle("shadow.yoffset"),this._shadowBlur=this._element.getStyle("shadow.blur"),this._wholeAlpha=this._element.getStyle("whole.alpha")},validate:function(){if(0!=this._invalidateFlag){this._bodyBounds.clear(),this._invalidateAttachmentsFlag&&(this._invalidateAttachmentsFlag=!1,this.checkAttachments()),this._invalidateFlag=!1,this.updateStyle(),this.validateImpl(),this._attachments.forEach(function(a){a.validate()});var a;this._bodyBounds.forEach(function(b){a=Tb.unionRect(a,b)}),this._unionBodyBounds=Jb.clone(a),this._attachments.forEach(function(b){a=Tb.unionRect(a,b.getViewRect())}),this._viewRect=a}},validateImpl:function(){},setShadow:function(a,b){var c=a.isShadowable()&&this._shadowColor&&!this._editAttachment;return b.shadowOffsetX===this._shadowXOffset&&b.shadowOffsetY===this._shadowYOffset&&b.shadowBlur===this._shadowBlur?b:((c||this._network._showShadowInEdit)&&(b.shadowOffsetX=this._shadowXOffset,b.shadowOffsetY=this._shadowYOffset,b.shadowBlur=this._shadowBlur,b.shadowColor=this._shadowColor),b)},clearShadow:function(a){(0!=a.shadowOffsetX||0!=a.shadowOffsetY||0!=a.shadowBlur)&&(a.shadowOffsetX=0,a.shadowOffsetY=0,a.shadowBlur=0)},appendShadowBound:function(a,b){var c=a.isShadowable()&&this._shadowColor&&!this._editAttachment;return c&&(this._shadowXOffset>0?b.width+=this._shadowXOffset:(b.x+=this._shadowXOffset,b.width+=-this._shadowXOffset),this._shadowYOffset>0?b.height+=this._shadowYOffset:(b.y+=this._shadowYOffset,b.height+=-this._shadowYOffset),Tb.grow(b,this._shadowBlur,this._shadowBlur)),b},isShadowable:function(){return this._shadowColor&&this._network.isSelected(this._element)&&"shadow"===this._element.getStyle("select.style")?!0:!1},addAttachment:function(a){this._attachments.add(a)},removeAttachment:function(a){this._attachments.remove(a)},getAttachments:function(){return this._attachments},checkAttachments:function(){this.checkLabelAttachment(),this.checkAlarmAttachment(),this.checkIconsAttachment(),this.checkEditAttachment()},checkLabelAttachment:function(){var a=this._network.getLabel(this._element);null!=a&&""!==a?this._labelAttachment||(this._labelAttachment=new Ib.canvas.LabelAttachment(this,Ed.SHOW_LABEL_IN_ATTACHMENT_DIV),this.addAttachment(this._labelAttachment)):this._labelAttachment&&(this.removeAttachment(this._labelAttachment),this._labelAttachment=null)},checkAlarmAttachment:function(){var a=this._network.getAlarmLabel(this._element);null!=a&&""!==a?this._alarmAttachment||(this._alarmAttachment=new Ib.canvas.AlarmAttachment(this,Ed.SHOW_ALARM_IN_ATTACHMENT_DIV),this.addAttachment(this._alarmAttachment)):this._alarmAttachment&&(this.removeAttachment(this._alarmAttachment),this._alarmAttachment=null)},checkIconsAttachment:function(){var a=this._network.getIconsNames(this._element);a&&a.length>0?this._iconsAttachment||(this._iconsAttachment=new Ib.canvas.IconsAttachment(this),this.addAttachment(this._iconsAttachment)):this._iconsAttachment&&(this.removeAttachment(this._iconsAttachment),this._iconsAttachment=null)},checkEditAttachment:function(){this._network.hasEditInteraction()&&this._network.isSelected(this._element)&&this._network.isEditable(this._element)&&this.isEditable()?this._editAttachment||(this._editAttachment=new Ib.canvas.EditAttachment(this),this.addAttachment(this._editAttachment)):this._editAttachment&&(this.removeAttachment(this._editAttachment),this._editAttachment=null)},getLabelAttachment:function(){return this._labelAttachment},getAlarmAttachment:function(){return this._alarmAttachment},getIconsAttachment:function(){return this._iconsAttachment},getEditAttachment:function(){return this._editAttachment},isEditable:function(){return!0},getInnerColor:function(){return this._innerColor},getOuterColor:function(){return this._outerColor},getShadowColor:function(){return this._shadowColor},getDyeColor:function(a){return this._innerColor?this._innerColor:this.getStyle(a)},getStyle:function(a){return this._element.getStyle(a)},getFont:function(a){var b=this._element.getStyle(a);return b?b:Ib.Defaults.FONT},paint:function(a){a.save(),a.globalAlpha=this._wholeAlpha,a.beginPath(),this.paintBody(a),this.clearShadow(a),a.closePath(),a.beginPath(),this.paintAttachments(a),a.closePath(),a.restore()},paintBody:function(a){},paintAttachments:function(a){a.beginPath();for(var b=this._attachments.size(),c=0;b>c;c++){var d=this._attachments.get(c);1==this._hitTest&&0==d.isShowOnTop()&&this.paintAttachment(a,d),1==this._intersectTest&&this.paintAttachment(a,d),
0==this._hitTest&&0==this._intersectTest&&(d.isShowOnTop()?this._network._topAttachmentList.add(d):this.paintAttachment(a,d))}},paintAttachment:function(a,b){a.beginPath(),b.paint(a),this.clearShadow(a)},getViewRect:function(){return Jb.clone(this._viewRect)},getUnionBodyBounds:function(){return Jb.clone(this._unionBodyBounds)},addBodyBounds:function(a){a&&this._bodyBounds.add(a)},getBodyRect:function(){return this._bodyRect||(this._bodyRect=this.createBodyRect()),Jb.clone(this._bodyRect)},getHotSpot:function(){return this._hotSpot?Jb.clone(this._hotSpot):{x:0,y:0}},setHotSpot:function(a){this._hotSpot=a},hit:function(a,b){return!1},intersects:function(a){return Tb.contains(a,this.getViewRect())?!0:!1},hitCanvasRectAtBody:function(a){var b=Od.getHitCanvas(a.width,a.height),c=Od.getCtx(b);if(c.save(),c.translate(-a.x,-a.y),this._element.getImage){var d=Jb.getImageAsset(this._element.getImage());if(d&&d.getImage()instanceof Hd)return 1}this.paintBody(c);try{for(var e=c.getImageData(0,0,a.width,a.height),f=e.data,g=0;g<e.width;g++)for(var h=0;h<e.height;h++){var i=4*(h*e.width+g),j=f[i+3];if(0!==j)return c.restore(),1}}catch(k){if(Od.disposeHitCanvas(),Tb.contains(this.getUnionBodyBounds(),a))return 0}return c.restore(),-1},hitCanvasRectAtAttachments:function(a){var b=Od.getHitCanvas(a.width,a.height),c=Od.getCtx(b);c.save(),c.translate(-a.x,-a.y),this.paintAttachments(c);try{for(var d=c.getImageData(0,0,a.width,a.height),e=d.data,f=0;f<d.width;f++)for(var g=0;g<d.height;g++){var h=4*(g*d.width+f),i=e[h+3];if(0!==i)return c.restore(),1}}catch(j){Od.disposeHitCanvas()}return c.restore(),-1},hitCanvasRect:function(a){this._intersectTest=!0,1==this._hitTest&&(this._intersectTest=!1);var b=Tb.intersection(a,this._viewRect),c=this.hitCanvasRectAtBody(b);if(1==c)return this._intersectTest=!1,!0;var d=this.hitCanvasRectAtAttachments(b);return 1==d?(this._intersectTest=!1,!0):(this._intersectTest=!1,0==c)},hitCanvasPoint:function(a,b){var c={x:a,y:b,width:0,height:0},d=this._network.getSelectionTolerance();if(d&&d>0&&Tb.grow(c,d,d),!Tb.intersects(this._viewRect,c))return!1;this._hitTest=!0;var e=this.hitCanvasRect(c);return this._hitTest=!1,e},hitTest:function(a,b){var c={x:a,y:b,width:0,height:0},d=this._network.getSelectionTolerance();if(d&&d>0&&Tb.grow(c,d,d),!Tb.intersects(this._viewRect,c))return null;var e=Tb.intersection(c,this._viewRect),f=this.hitCanvasRectAtBody(e);if(1==f)return this;for(var g=this._attachments.size(),h=0;g>h;h++){var i=this._attachments.get(h);if(i.hit(a,b))return i}return 0==f?this:null},dispose:function(){this._attachments.forEach(function(a){a.dispose()}),this._attachments.clear()}}),Ib.canvas.NodeUI=function(a,b){Ib.canvas.NodeUI.superClass.constructor.call(this,a,b)},Jb.ext("twaver.canvas.NodeUI",Ib.canvas.ElementUI,{invalidate:function(a){Ib.canvas.NodeUI.superClass.invalidate.call(this,a),this.curInterval&&clearInterval(this.curInterval);var b=this._element.getAgentLinks();b&&b.forEach(function(a){this._network.invalidateElementUI(a,!1)},this);var c=this._element.getParent();c instanceof Ib.Group&&this._network.invalidateElementUI(c,!1)},createBodyRect:function(){return this._element.getRect()},validateImpl:function(){Ib.canvas.NodeUI.superClass.validateImpl.call(this);var a=this.getStyle("vector.shape"),b=this.getBodyRect();this._hotSpot=Tb.getHotSpot(b.x,b.y,b.width,b.height,a),this.validateBodyBounds()},validate:function(){0!=this._invalidateFlag&&Ib.canvas.NodeUI.superClass.validate.call(this)},validateBodyBounds:function(){var a=this.getStyle("body.type");"default"===a?this.addBodyBounds(this.getDefaultBodyRect()):"vector"===a?this.addBodyBounds(this.getVectorBody()):"default.vector"===a?(this.addBodyBounds(this.getVectorBody()),this.addBodyBounds(this.getDefaultBodyRect())):"vector.default"===a&&(this.addBodyBounds(this.getDefaultBodyRect()),this.addBodyBounds(this.getVectorBody())),this._outerColor&&this.addBodyBounds(this.getOuterBorderRect()),!this._editAttachment&&"border"===this.getStyle("select.style")&&this._network.isSelected(this._element)&&this.addBodyBounds(this.getSelectBorderRect())},getDefaultBodyRect:function(){var a=this._element,b=Jb.getImageAsset(a.getImage()),c=this.getBodyRect();if(!b)return c;Tb.addPadding(c,this._element,"image.padding",1),this._defaultRect=c;var d=Jb.clone(c);return this.appendShadowBound(this,d),c=d},getVectorBody:function(){var a=this.getPathRect("vector");return a},getOuterBorderRect:function(){return this._getBorderRect("outer")},getSelectBorderRect:function(){return this._getBorderRect("select")},_getBorderRect:function(a){var b=this._element,c=b.getStyle(a+".width");if(c>0){var d=this.getBodyRect();Tb.addPadding(d,b,a+".padding",1);var e=Jb.clone(d);return Tb.grow(e,c/2,c/2),e}return null},getPathRect:function(a,b){var c=this._element,d=this.getBodyRect();b&&Tb.addPadding(d,c,a+".padding",1);var e=Jb.clone(d),f=c.getStyle(a+".outline.width");return f>0&&Tb.grow(e,f/2,f/2),this.appendShadowBound(this,e),e},paintBody:function(a){this.curInterval&&clearInterval(this.curInterval);var b=this.getStyle("body.type");"default"===b?this.drawDefaultBody(a):"vector"===b?this.drawVectorBody(a):"default.vector"===b?(this.drawVectorBody(a),this.drawDefaultBody(a)):"vector.default"===b&&(this.drawDefaultBody(a),this.drawVectorBody(a)),this._outerColor&&this.drawOuterBorder(a),"border"===this.getStyle("select.style")&&this._network.isSelected(this._element)&&this.drawSelectBorder(a)},drawOuterBorder:function(a){var b=this._element,c=b.getStyle("outer.width");if(c>0){var d=this.getBodyRect();Tb.addPadding(d,b,"outer.padding",1),a.lineWidth=c,a.lineCap=b.getStyle("outer.cap"),a.lineJoin=b.getStyle("outer.join"),a.strokeStyle=this._outerColor,Xb.drawVector(a,b.getStyle("outer.shape"),null,d),a.stroke()}},drawDefaultBody:function(a){var b=this._element,c=Jb.getImageAsset(b.getImage()),d=this._defaultRect;if(c&&c.getImage()){if(0!=b.getAngle()&&(a.save(),d=b.getOriginalRect(),Ib.Util.rotateCanvas(a,d,b.getAngle())),this.setShadow(this,a),c.getImage()instanceof Hd){var e,f=c.getImage().frames,g=c.getImage().size,h=0;e=Jd(f,g,0),a.drawImage(e,d.x,d.y,d.width,d.height),this.curInterval=setInterval(function(){h=(h+f.length)%f.length,e=Jd(f,g,h),a.drawImage(e,d.x,d.y,d.width,d.height),h++},100)}else Nc(a,b.getImage(),this.getInnerColor(),d,b,this._network);0!=b.getAngle()&&a.restore()}},drawSelectBorder:function(a){var b=this._element,c=b.getStyle("select.width");if(c>0){var d=this.getBodyRect();d=Jb.clone(d);var e=b.getStyle("select.physicalZoom")?1:this._network.getGraphicsZoom();Tb.addPadding(d,b,"select.padding",1/e),Tb.grow(d,c/2/e,c/2/e),a.lineWidth=c/e,a.lineCap=b.getStyle("select.cap"),a.lineJoin=b.getStyle("select.join"),a.strokeStyle=b.getStyle("select.color"),Xb.drawVector(a,b.getStyle("select.shape"),null,d),a.stroke()}},drawVectorBody:function(a){this.drawPath(a,"vector",!0,this._element.getStyle("vector.outline.pattern"));var b=this.getStyle("vector.deep"),c=this.getStyle("vector.fill.color"),d=this.getBodyRect();if(0!==b&&c){var e=this._element.getAngle();0!=e&&(a.save(),d=this._element.getOriginalRect(),Ib.Util.rotateCanvas(a,d,e)),"rectangle"===this.getStyle("vector.shape")&&Xb.draw3DRect(a,c,b,d),0!=e&&a.restore()}},drawPath:function(a,b,c,d,e,f,g){var h=this._element,i=this.getBodyRect();c&&Tb.addPadding(i,h,b+".padding",1);var j=h.getStyle(b+".outline.width");this.setShadow(this,a),0!=h.getAngle()&&(h instanceof Nd||(i=h.getOriginalRect()),a.save(),Ib.Util.rotateCanvas(a,i,h.getAngle()));var k,l=h.getStyle(b+".fill");if(l){k=this._innerColor&&!vc.hasDefault(this._element)?this._innerColor:h.getStyle(b+".fill.color");var m=h.getStyle(b+".gradient");m?Xb.fill(a,k,m,h.getStyle(b+".gradient.color"),i):a.fillStyle=k}var n=h.getStyle(b+".shape"),o=h.getStyle("group.shape.roundrect.radius");l&&(a.beginPath(),e?Xb.drawLinePoints(a,e,null,f,g):"roundrect"===n&&"group"===b?Xb.drawVector(a,n,null,i,o):Xb.drawVector(a,n,null,i),a.fill()),j>0&&(a.lineWidth=j,a.lineCap=h.getStyle(b+".cap"),a.lineJoin=h.getStyle(b+".join"),a.strokeStyle=h.getStyle(b+".outline.color"),a.beginPath(),e?Xb.drawLinePoints(a,e,d,f,g):"roundrect"===n&&"group"===b?Xb.drawVector(a,n,d,i,o):Xb.drawVector(a,n,d,i),a.stroke()),0!=h.getAngle()&&a.restore()},hit:function(a,b){var c={x:a,y:b,width:0,height:0},d=this._network.getSelectionTolerance();if(d&&d>0&&Tb.grow(c,d,d),this._network._transparentSelectionEnable){var e=this.getBodyRect();if(Jb.math.intersects(e,c))return!0}return Tb.intersects(this.getViewRect(),c)?this.hitCanvasPoint(a,b):!1},intersects:function(a){var b=Ib.canvas.NodeUI.superClass.intersects.apply(this,arguments);if(1==b)return!0;if(this._network._transparentSelectionEnable){var c=this.getBodyRect();if(Jb.math.intersects(c,a))return!0}return Tb.intersects(a,this.getViewRect())?this.hitCanvasRect(a):!1}}),Ib.canvas.LinkUI=function(a,b){Ib.canvas.LinkUI.superClass.constructor.call(this,a,b)},Jb.ext("twaver.canvas.LinkUI",Ib.canvas.ElementUI,{isEditable:function(){return xc.isOrthogonalLink(this._element)&&this.getControlPoint()?!0:!1},invalidate:function(a){this._linkPoints=null,this._fromPoint=null,this._toPoint=null,this._angle=null,Ib.canvas.LinkUI.superClass.invalidate.call(this,a)},validateImpl:function(){this.validateBodyBounds(),Ib.canvas.LinkUI.superClass.validateImpl.call(this)},validateBodyBounds:function(){var a=this.getLinkPoints();if(a&&!(a.size()<2)){var b=this._element,c=Tb.getLineRect(a),d=b.getStyle("link.width"),e=d;if(this._outerColor){var f=b.getStyle("outer.width");e+=2*f}var g=!this._editAttachment&&"border"===b.getStyle("select.style")&&this._network.isSelected(this._element);if(g){var h=b.getStyle("select.width");e+=2*h}Tb.grow(c,e/2,e/2),b.getStyle("arrow.from")&&(this._network._debug&&(this._arrowFromRect=od.getArrowRect(this,a,!0,b.getStyle("arrow.from.shape"),b.getStyle("arrow.from.width"),b.getStyle("arrow.from.height"),b.getStyle("arrow.from.xoffset"),b.getStyle("arrow.from.yoffset"))),c=Tb.unionRect(c,od.getArrowRect(this,a,!0,b.getStyle("arrow.from.shape"),b.getStyle("arrow.from.width"),b.getStyle("arrow.from.height"),b.getStyle("arrow.from.xoffset"),b.getStyle("arrow.from.yoffset")))),b.getStyle("arrow.to")&&(this._network._debug&&(this._arrowToRect=od.getArrowRect(this,a,!1,b.getStyle("arrow.to.shape"),b.getStyle("arrow.to.width"),b.getStyle("arrow.to.height"),b.getStyle("arrow.to.xoffset"),b.getStyle("arrow.to.yoffset"))),c=Tb.unionRect(c,od.getArrowRect(this,a,!1,b.getStyle("arrow.to.shape"),b.getStyle("arrow.to.width"),b.getStyle("arrow.to.height"),b.getStyle("arrow.to.xoffset"),b.getStyle("arrow.to.yoffset")))),this.appendShadowBound(this,c),this.addBodyBounds(c)}},createBodyRect:function(){var a=this.getHotSpot();return a?{x:a.x-1,y:a.y-1,width:2,height:2}:null},paintBody:function(a){var b=this._linkPoints;if(b&&!(b.size()<2)){var c=this._element,d=c.getStyle("link.width"),e=d;if(this._outerColor){var f=c.getStyle("outer.width");e+=2*f}var g=!this._editAttachment&&"border"===c.getStyle("select.style")&&this._network.isSelected(this._element);if(g){var h=c.getStyle("select.width");e+=2*h}this.setShadow(this,a),a.lineCap=c.getStyle("link.cap"),a.lineJoin=c.getStyle("link.join");var i=c.getStyle("link.pattern");g&&this.drawLinePoints(a,b,e,c.getStyle("select.color"),i),this._outerColor&&this.drawLinePoints(a,b,d+2*f,this._outerColor,i),this.drawLinePoints(a,b,d,this._innerColor||c.getStyle("link.color"),i),od.drawLinkArrow(this,a,b)}},drawLinePoints:function(a,b,c,d,e){if(a.lineWidth=c,a.strokeStyle=d,this._element.getStyle("link.flow")===!0&&e&&e.length>1){var f=new uc(a,e[0],e[1]),g=this._element.getStyle("link.flow.offset"),h=Math.floor(g/(e[0]+e[1]));h>2&&(g-=(e[0]+e[1])*h),this._element.getStyle("link.flow.converse")?g<e[0]?f.overflow=e[0]-g:g>=e[0]&&g<=e[0]+e[1]?(f.overflow=e[1]-(g-e[0]),f.overflow&&(f.isLine=!1)):(g-=e[0]+e[1],f.overflow=e[0]-g):g<=e[1]?(f.overflow=g,g&&(f.isLine=!1)):g>e[1]&&g<=e[0]+e[1]?f.overflow=g-e[1]:(g-=e[0]+e[1],g&&(f.isLine=!1),f.overflow=g),this._element._styleMap["link.flow.offset"]=g,a.beginPath(),Xb._drawLine(b,a),a.stroke(),a.shadowColor="transparent",a.beginPath();var i=this._element.getStyle("link.flow.color");i=i?i:Ed.NETWORK_LINK_FLOW_COLOR,a.strokeStyle=i,Xb._drawLine(b,f),a.stroke(),a.shadowColor=this._shadowColor}else a.beginPath(),Xb.drawLinePoints(a,b,e),a.stroke()},getLinkPoints:function(){return this._linkPoints||(this._linkPoints=this.createLinkPoints(),this._lineLength=Tb.calculateLineLength(this._linkPoints)),this._linkPoints},getFromPosition:function(a,b){var c=this.getFromPoint();return c?{x:c.x+a,y:c.y+b}:null},getToPosition:function(a,b){var c=this.getToPoint();return c?{x:c.x+a,y:c.y+b}:null},getFromPoint:function(){return this._fromPoint||(this._fromPoint=xc.createFromPoint(this)),this._fromPoint},getToPoint:function(){return this._toPoint||(this._toPoint=xc.createToPoint(this)),this._toPoint},createLinkPoints:function(){var a=this.getFromPoint(),b=this.getToPoint(),c=this.getStyle("link.type"),d=new Ib.List;if(xc.isOrthogonalOrFlexionalLink(this._element))d=xc.orthogonalAndFlexional(this,c);else if(this._element.isLooped()){var e=this._network.getElementUI(this._element.getFromAgent());null!=e&&(this._hotSpot=xc.fillLoopedPoints(this,e.getBodyRect(),d))}else{if("arc"!==c&&"triangle"!==c&&"parallel"!==c)throw"Can not resolve link type '"+c+"'";this._hotSpot=xc.fillBundlePoints(this,c,a,b,d)}if(this._network._linkPathFunction){var f=this._network._linkPathFunction(this,d);f&&(d=f)}return d},checkAttachments:function(){Ib.canvas.LinkUI.superClass.checkAttachments.call(this),this.checkLinkHandlerAttachment()},checkLinkHandlerAttachment:function(){var a=this._network.getLinkHandlerLabel(this._element);null!=a&&""!==a?this._linkHandlerAttachment||(this._linkHandlerAttachment=new Ib.canvas.LinkHandlerAttachment(this),this.addAttachment(this._linkHandlerAttachment)):this._linkHandlerAttachment&&(this.removeAttachment(this._linkHandlerAttachment),this._linkHandlerAttachment=null)},getLinkHandlerAttachment:function(){return this._linkHandlerAttachment},getControlPoint:function(){return xc.getControlPoint(this._element,this)},setControlPoint:function(a){if(a){var b=this.getStyle("link.type");if(xc.hasControlPoint(b)){var c=xc.getLinkSourceBounds(this),d=xc.getLinkTargetBounds(this);xc.setParamsByControlPoint(a,c,d,b,this._element)}}},getLineLength:function(){return this._lineLength},hit:function(a,b){var c={x:a,y:b,width:0,height:0},d=this._network.getSelectionTolerance();return d&&d>0&&Tb.grow(c,d,d),Tb.intersects(this.getViewRect(),c)?this.hitCanvasPoint(a,b):!1},intersects:function(a){var b=Ib.canvas.LinkUI.superClass.intersects.apply(this,arguments);if(1==b)return!0;if(0==Tb.intersects(a,this.getViewRect()))return!1;var c=this.getLinkPoints(),d=c.size();if(2==d)for(var e=0;d>e;e+=2){var f=c.get(e);if(d>e+1){var g=c.get(e+1);if(Od.intersectsLine(f.x,f.y,g.x,g.y,a.x,a.y,a.width,a.height))return!0}}return this.hitCanvasRect(a)},getAngle:function(){return!this._angle&&this._fromPoint&&this._toPoint&&(this._angle=Tb.getAngle(this._fromPoint,this._toPoint)),this._angle||0}}),Ib.canvas.GroupUI=function(a,b){Ib.canvas.GroupUI.superClass.constructor.call(this,a,b)},Jb.ext("twaver.canvas.GroupUI",Ib.canvas.NodeUI,{isEditable:function(){return!this._element.isExpanded()},paintBody:function(a){this._shapeRect?this.drawExpandedGroup(a):Ib.canvas.GroupUI.superClass.paintBody.apply(this,arguments)},validateBodyBounds:function(){this.getBodyRect(),this._shapeRect?this.addBodyBounds(this.getPathRect("group",!1)):Ib.canvas.GroupUI.superClass.validateBodyBounds.call(this)},drawExpandedGroup:function(a){this.drawPath(a,"group",!1,this._element.getStyle("vector.outline.pattern"));var b=this.getStyle("group.deep"),c=this.getStyle("group.fill.color");0!==b&&c&&"rectangle"===this.getStyle("group.shape")&&Xb.draw3DRect(a,c,b,this._bodyRect)},getChildrenRects:function(){return this._network.getGroupChildrenRects(this._element)},createBodyRect:function(){this._shapeRect=null;var a=this._element,b=this._network;if(a.isExpanded()){a.getChildren().forEach(function(a){var c=b.getElementUI(a);c&&c.validate()});var c=this.getChildrenRects();if(!c.isEmpty()){var d=a.getStyle("group.shape"),e=Ub[d];if(!e)throw"Can not resolve group shape '"+d+"'";this._shapeRect=e(c)}}return this._shapeRect?(Tb.addPadding(this._shapeRect,a,"group.padding",1),this._shapeRect):Ib.canvas.GroupUI.superClass.createBodyRect.call(this)}}),Ib.canvas.ShapeNodeUI=function(a,b){Ib.canvas.ShapeNodeUI.superClass.constructor.call(this,a,b)},Jb.ext("twaver.canvas.ShapeNodeUI",Ib.canvas.NodeUI,{getDefaultBodyRect:function(){return this._element._points.size()<2?null:this.getPathRect("vector",!0)},drawDefaultBody:function(a){this._element._points.size()<2||(this.drawPath(a,"vector",!0,this._element.getStyle("vector.outline.pattern"),this._element._points,this._element._segments,this._element.getStyle("shapenode.closed")),od.drawLinkArrow(this,a,Tb.getPointObject(this._element._points,this._element._segments)))},drawSelectBorder:function(a){var b=this._element,c=b.getStyle("select.width");if(c>0){var d=this.getBodyRect();d=Jb.clone(d);var e=b.getStyle("select.physicalZoom")?1:this._network.getGraphicsZoom();Tb.addPadding(d,b,"select.padding",1/e),Tb.grow(d,c/2,c/2);var f=b.getStyle("vector.outline.width");f>0&&Tb.grow(d,f/2/e,f/2/e),a.lineWidth=c/e,a.lineCap=b.getStyle("select.cap"),a.lineJoin=b.getStyle("select.join"),a.strokeStyle=b.getStyle("select.color"),Xb.drawVector(a,b.getStyle("select.shape"),null,d),a.stroke()}}}),Ib.canvas.ShapeLinkUI=function(a,b){Ib.canvas.ShapeLinkUI.superClass.constructor.call(this,a,b)},Jb.ext("twaver.canvas.ShapeLinkUI",Ib.canvas.LinkUI,{isEditable:function(){return!0},createLinkPoints:function(){var a=this.getFromPoint(),b=this.getToPoint(),c=new Ib.List,d=this.getStyle("shapelink.type");c.add(a),null!=this._element._points&&c.addAll(this._element._points),c.add(b);var e,f,g,h,i,j,k,l=Tb.calculateLineLength(c)/2,m=c.size(),n=0,o=0;for(e=0;m>e;e++)if(h=c.get(e),0!=e){if(g=h,g instanceof nd&&(g=g._as),g instanceof Array?(i=Tb.calculateCurveLength(f,g,1),f=g[g.length-1]):(k=h.y-f.y,j=h.x-f.x,i=Math.sqrt(j*j+k*k),f=g),o+=i,l>=n&&o>=l){var p=l-n,q=c.get(e-1);q instanceof nd&&(q=q._as,q instanceof Array&&(q=q[q.length-1]));var r=c.get(e),s=Tb.getPathInfo(r,q,p,0,-1).point;this._hotSpot=Jb.clone(s)}n=o}else f=h;var t,u,v;if("lineto"===d);else if("quadto"===d){for(t=new Ib.List(c.get(0)),u=1,pointCount=c.size();u<pointCount;u++)t.add(u<pointCount-1?new Ib.List([c.get(u++),c.get(u)]):c.get(u));c=t}else if("cubicto"===d){for(t=new Ib.List(c.get(0)),u=1,pointCount=c.size();u<pointCount;u++)t.add(u<pointCount-2?new Ib.List([c.get(u++),c.get(u++),c.get(u)]):u<pointCount-1?new Ib.List([c.get(u++),c.get(u)]):c.get(u));c=t}else{if("orthogonalto"!==d)throw"Can not resolve shapelink type '"+d+"'";for(v=c.get(0),t=new Ib.List(v),u=1,pointCount=c.size();u<pointCount;u++)if(u<pointCount-1){var h=Jb.clone(c.get(u)),w=h.x,x=h.y,j=w-v.x,k=x-v.y;Math.abs(j)>Math.abs(k)?(h.x=w,h.y=v.y):(h.x=v.x,h.y=x),v=h,t.add(v)}else t.add(c.get(u));c=t}return c}}),Ib.canvas.GridUI=function(a,b){Ib.canvas.GridUI.superClass.constructor.call(this,a,b)},Jb.ext("twaver.canvas.GridUI",Ib.canvas.NodeUI,{drawDefaultBody:function(a){this._element.getImage()?Ib.canvas.GridUI.superClass.drawDefaultBody.apply(this,arguments):this.drawGridBody(a)},validateBodyBounds:function(){if(this._element.getImage())Ib.canvas.GridUI.superClass.validateBodyBounds.call(this);else{var a=this.getBodyRect(),b=Jb.clone(a);this.appendShadowBound(this,b),this.addBodyBounds(b)}},drawGridBody:function(a){var b=this.getStyle("grid.fill"),c=this.getStyle("grid.deep"),d=this.getStyle("grid.cell.deep");if(b||0!==c||0!==d){a.beginPath();var e=this._element.getRect(),f=this.getDyeColor("grid.fill.color");if(this.setShadow(this,a),b&&(a.fillStyle=f,a.rect(e.x,e.y,e.width,e.height),a.fill()),a.closePath(),this.clearShadow(a),a.beginPath(),0!=c&&Xb.draw3DRect(a,f,c,e.x,e.y,e.width,e.height),a.closePath(),0!=d)for(var g=this.getStyle("grid.row.count"),h=this.getStyle("grid.column.count"),i=0;g>i;i++)for(var j=0;h>j;j++){var k=this._element.getCellRect(i,j);null!=k&&(a.beginPath(),Xb.draw3DRect(a,f,d,k.x,k.y,k.width,k.height),a.closePath())}}}}),Ib.canvas.RotatableNodeUI=function(a,b){Ib.canvas.RotatableNodeUI.superClass.constructor.call(this,a,b)},Jb.ext("twaver.canvas.RotatableNodeUI",Ib.canvas.NodeUI,{isEditable:function(){return!1},getDefaultBodyRect:function(){var a=this._element,b=Jb.getImageAsset(a.getImage()),c=this.getBodyRect();return b?(Tb.addPadding(c,this._element,"image.padding",1),c):c},drawDefaultBody:function(a){var b=this._element,c=Jb.getImageAsset(b.getImage()),d=this.getBodyRect();if(Tb.addPadding(d,this._element,"image.padding",1),c.getImage()){var e=this._element._getOrignalWidth(),f=this._element._getOrignalHeight(),g=this._element._getRotateRect();a.save(),a.translate(d.x-g.x+e/2,d.y-g.y+f/2),a.rotate(this._element._angle*Math.PI/180);var d={x:-e/2,y:-f/2,width:e,height:f};Nc(a,c.getImage(this._innerColor,d.width,d.height),this._innerColor,d,b,this._network),a.restore()}else if(c.getSrc());else if(!c.getFunction())throw"ImageAsset '"+b.getImage()+" ' is empty"}}),Ib.canvas.HTMLNodeUI=function(a,b){Ib.canvas.HTMLNodeUI.superClass.constructor.call(this,a,b)},Jb.ext("twaver.canvas.HTMLNodeUI",Ib.canvas.NodeUI,{checkAttachments:function(){Ib.canvas.NodeUI.prototype.checkAttachments.call(this)},checkLabelAttachment:function(){var a=this._element.getStyle("attachment.label.style");if(a&&"none"===a)return void Ib.canvas.HTMLNodeUI.superClass.checkLabelAttachment.call(this);var b=this._network.getLabel(this._element);null!=b&&""!==b?this._labelAttachment||(this._labelAttachment=new Ib.canvas.HTMLLabelAttachment(this,Ed.SHOW_LABEL_IN_ATTACHMENT_DIV),this.addAttachment(this._labelAttachment)):this._labelAttachment&&(this.removeAttachment(this._labelAttachment),this._labelAttachment=null)},checkAlarmAttachment:function(){var a=this._element.getStyle("attachment.alarm.style");if(a&&"none"===a)return void Ib.canvas.HTMLNodeUI.superClass.checkAlarmAttachment.call(this);var b=this._network.getAlarmLabel(this._element);null!=b&&""!==b?this._alarmAttachment||(this._alarmAttachment=new Ib.canvas.HTMLAlarmAttachment(this,!1),this.addAttachment(this._alarmAttachment)):this._alarmAttachment&&(this.removeAttachment(this._alarmAttachment),this._alarmAttachment=null)},setAttachmentVisible:function(a){a?(this._labelAttachment&&this._labelAttachment.setVisibility("visible"),this._alarmAttachment&&this._alarmAttachment.setVisibility("visible")):(this._labelAttachment&&this._labelAttachment.setVisibility("hidden"),this._alarmAttachment&&this._alarmAttachment.setVisibility("hidden"))}}),Ib.canvas.HTMLLinkUI=function(a,b){Ib.canvas.HTMLLinkUI.superClass.constructor.call(this,a,b)},Jb.ext("twaver.canvas.HTMLLinkUI",Ib.canvas.LinkUI,{checkAttachments:function(){Ib.canvas.LinkUI.prototype.checkAttachments.call(this)},checkLabelAttachment:function(){var a=this._element.getStyle("attachment.label.style");if(a&&"none"===a)return void Ib.canvas.HTMLLinkUI.superClass.checkLabelAttachment.call(this);var b=this._network.getLabel(this._element);null!=b&&""!==b?this._labelAttachment||(this._labelAttachment=new Ib.canvas.HTMLLabelAttachment(this),this.addAttachment(this._labelAttachment)):this._labelAttachment&&(this.removeAttachment(this._labelAttachment),this._labelAttachment=null)},checkAlarmAttachment:function(){var a=this._element.getStyle("attachment.alarm.style");if(a&&"none"===a)return void Ib.canvas.HTMLLinkUI.superClass.checkAlarmAttachment.call(this);var b=this._network.getAlarmLabel(this._element);null!=b&&""!==b?this._alarmAttachment||(this._alarmAttachment=new Ib.canvas.HTMLAlarmAttachment(this,!1),this.addAttachment(this._alarmAttachment)):this._alarmAttachment&&(this.removeAttachment(this._alarmAttachment),this._alarmAttachment=null)}}),Ib.canvas.Attachment=function(a,b){this._ui=a,this._element=this._ui.getElement(),this._network=a.getNetwork(),this._showOnTop=b},Jb.ext("twaver.canvas.Attachment",Object,{getElement:function(){return this._element},getElementUI:function(){return this._ui},getNetwork:function(){return this._network},isShowOnTop:function(){return this._showOnTop===!0},setShowOnTop:function(a){this._showOnTop=a},getStyle:function(a){return this._ui.getStyle(a)},getFont:function(a){return this._ui.getFont(a)},getViewRect:function(){return Jb.clone(this._viewRect)},getAlpha:function(){return 1},validate:function(){},paint:function(a){},hit:function(a,b){return Tb.containsPoint(this._viewRect,a,b)?this.hitCanvasRect({x:a-1,y:b-1,width:2,height:2}):!1},hitCanvasRect:function(a){var b=Od.getHitCanvas(a.width,a.height),c=Od.getCtx(b);c.save(),c.translate(-a.x,-a.y),this.paint(c);try{for(var d=c.getImageData(0,0,a.width,a.height),e=d.data,f=0;f<d.width;f++)for(var g=0;g<d.height;g++){var h=4*(g*d.width+f),i=e[h+3];if(0!==i)return c.restore(),!0}}catch(j){Od.disposeHitCanvas()}return c.restore(),!1},dispose:function(){},_rotatePoint:function(a,b,c){var d=Tb.createMatrix(b*Math.PI/180,c.x+c.width/2,c.y+c.height/2),e=d.transform(a);return e},_rotatePointList:function(a,b,c){var d=this,e=new Ib.List;return a.forEach(function(a){e.add(d._rotatePoint(a,b,c))}),e}}),Ib.canvas.BasicAttachment=function(a,b){Ib.canvas.BasicAttachment.superClass.constructor.call(this,a,b),this._roundRect={x:0,y:0,width:0,height:0},this._contentRect={x:0,y:0,width:0,height:0}},Jb.ext("twaver.canvas.BasicAttachment",Ib.canvas.Attachment,{paint:function(a){Ib.canvas.BasicAttachment.superClass.paint.apply(this,arguments);var b=this.isFill(),c=this.getOutlineWidth();if(this.getElementUI().setShadow(this,a),(c>0||b)&&(Xb.drawRoundRect(a,this._roundRect.x,this._roundRect.y,this._roundRect.width,this._roundRect.height,this.getCornerRadius()),this._pointers&&(a.moveTo(this._pointers[0].x,this._pointers[0].y),a.lineTo(this._pointers[1].x,this._pointers[1].y),a.lineTo(this._pointers[2].x,this._pointers[2].y)),a.closePath(),c>0&&(a.lineWidth=c,a.strokeStyle=this.getOutlineColor(),a.lineCap=this.getCap(),a.lineJoin=this.getJoin(),a.stroke()),b)){var d=this.getFillColor(),e=this.getGradient();e?Xb.fill(a,d,e,this.getGradientColor(),this._viewRect):a.fillStyle=d,a.fill()}},validate:function(){Ib.canvas.BasicAttachment.superClass.validate.call(this),this.calculateMeasure();var a=this.getOutlineWidth();this._viewRect=Tb.getRect(this._pointers),this._viewRect=Tb.unionRect(this._viewRect,this._roundRect),a>0&&Tb.grow(this._viewRect,a/2,a/2),this._viewRect=this._ui.appendShadowBound(this,this._viewRect)},calculateMeasure:function(){var a=this.getContentWidth(),b=this.getContentHeight(),c=this.getCornerRadius(),d=this.getPointerLength(),e=this.getPointerWidth(),f=this.getPosition(),g=this.getXOffset(),h=this.getYOffset(),i=this._roundRect;i.width=a+c,i.height=b;var j;if(this._ui._element instanceof Ib.Link){var k,l=this._ui.getLinkPoints();k=this._ui.getLineLength?this._ui.getLineLength():this._ui._element.getLineLength(),Math.abs(g)>0&&Math.abs(g)<1?"from"===f?g*=k:"to"===f?g=k*(1-g):(g/=2,g+=.5,g*=k):"from"===f?g=g:"to"===f?g=k-g:g+=k/2;var m,n=Tb.calculatePointInfoAlongLine(l,!0,g,h),o=n.point;n.angle,m="from"===f?this._ui.getFromPoint():"to"===f?this._ui.getToPoint():this._ui._hotSpot,g=o.x-m.x,h=o.y-m.y}if(d>0){var p=this.getDirection();j=this._network.getPosition(f,this._ui,null,g,h,!1);var q;if("aboveleft"===p)i.y=j.y-d-i.height,i.x=j.x-(i.width-c),q=Math.max(j.x-e,j.x-(i.width-c)+c/2),this._pointers=[j,{x:j.x,y:j.y-d},{x:q,y:j.y-d}];else if("aboveright"===p)i.y=j.y-d-i.height,i.x=j.x-c,q=Math.min(j.x+e,j.x-c+i.width-c/2),this._pointers=[j,{x:j.x,y:j.y-d},{x:q,y:j.y-d}];else if("belowleft"===p)i.y=j.y+d,i.x=j.x-(i.width-c),q=Math.max(j.x-e,j.x-(i.width-c)+c/2),this._pointers=[j,{x:j.x,y:j.y+d},{x:q,y:j.y+d}];else if("belowright"===p)i.y=j.y+d,i.x=j.x-c,q=Math.min(j.x+e,j.x-c+i.width-c/2),this._pointers=[j,{x:j.x,y:j.y+d},{x:q,y:j.y+d}];else if("leftabove"===p)i.y=j.y+c-i.height,i.x=j.x-d-i.width,q=Math.max(j.y-e,j.y+c-i.height+c/2),this._pointers=[j,{x:j.x-d,y:j.y},{x:j.x-d,y:q}];else if("leftbelow"===p)i.y=j.y-c,i.x=j.x-d-i.width,q=Math.min(j.y+e,j.y-c+i.height-c/2),this._pointers=[j,{x:j.x-d,y:j.y},{x:j.x-d,y:q}];else if("rightabove"===p)i.y=j.y+c-i.height,i.x=j.x+d,q=Math.max(j.y-e,j.y+c-i.height+c/2),this._pointers=[j,{x:j.x+d,y:j.y},{x:j.x+d,y:q}];else if("rightbelow"===p)i.y=j.y-c,i.x=j.x+d,q=Math.min(j.y+e,j.y-c+i.height-c/2),this._pointers=[j,{x:j.x+d,y:j.y},{x:j.x+d,y:q}];else if("above"===p)i.y=j.y-d-i.height,i.x=j.x-i.width/2,q=Math.min(a/2,e/2),this._pointers=[j,{x:j.x-q,y:j.y-d},{x:j.x+q,y:j.y-d}];else if("below"===p)i.y=j.y+d,i.x=j.x-i.width/2,q=Math.min(a/2,e/2),this._pointers=[j,{x:j.x-q,y:j.y+d},{x:j.x+q,y:j.y+d}];else if("left"===p)i.y=j.y-i.height/2,i.x=j.x-d-i.width,q=Math.min(b/2,e/2),this._pointers=[j,{x:j.x-d,y:j.y+q},{x:j.x-d,y:j.y-q}];else{if("right"!==p)throw"Can not resolve '"+p+"' attachment direction";i.y=j.y-i.height/2,i.x=j.x+d,q=Math.min(b/2,e/2),this._pointers=[j,{x:j.x+d,y:j.y+q},{x:j.x+d,y:j.y-q}]}}else j=this._network.getPosition(f,this._ui,{width:i.width,height:i.height},g,h,!1),i.x=j.x,i.y=j.y,this._pointers=null;this._contentRect.x=i.x+(i.width-a)/2,this._contentRect.y=i.y+(i.height-b)/2,this._contentRect.width=a,this._contentRect.height=b;var r=this.getPadding();0!=r&&Tb.grow(i,r,r),r=this.getPaddingLeft(),0!=r&&(i.x-=r,i.width+=r),r=this.getPaddingRight(),0!=r&&(i.width+=r),r=this.getPaddingTop(),0!=r&&(i.y-=r,i.height+=r),r=this.getPaddingBottom(),0!=r&&(i.height+=r),i.width<0&&(i.width=i.width,i.x-=i.width),i.height<0&&(i.height=-i.height,i.y-=i.height)},getContentWidth:function(){return Ib.Defaults.ATTACHMENT_CONTENT_WIDTH},getContentHeight:function(){return Ib.Defaults.ATTACHMENT_CONTENT_HEIGHT},getCornerRadius:function(){return Ib.Defaults.ATTACHMENT_CORNER_RADIUS},getPointerLength:function(){return Ib.Defaults.ATTACHMENT_POINTER_LENGTH},getPointerWidth:function(){return Ib.Defaults.ATTACHMENT_POINTER_WIDTH},getPosition:function(){return Ib.Defaults.ATTACHMENT_POSITION},getXOffset:function(){return Ib.Defaults.ATTACHMENT_XOFFSET},getYOffset:function(){return Ib.Defaults.ATTACHMENT_YOFFSET},getPadding:function(){return Ib.Defaults.ATTACHMENT_PADDING},getPaddingLeft:function(){return Ib.Defaults.ATTACHMENT_PADDING_LEFT},getPaddingRight:function(){return Ib.Defaults.ATTACHMENT_PADDING_RIGHT},getPaddingTop:function(){return Ib.Defaults.ATTACHMENT_PADDING_TOP},getPaddingBottom:function(){return Ib.Defaults.ATTACHMENT_PADDING_BOTTOM},getDirection:function(){return Ib.Defaults.ATTACHMENT_DIRECTION},isFill:function(){return Ib.Defaults.ATTACHMENT_FILL},getFillColor:function(){return Ib.Defaults.ATTACHMENT_FILL_COLOR},getGradient:function(){return Ib.Defaults.ATTACHMENT_GRADIENT},getGradientColor:function(){return Ib.Defaults.ATTACHMENT_GRADIENT_COLOR},getOutlineWidth:function(){return Ib.Defaults.ATTACHMENT_OUTLINE_WIDTH},getOutlineColor:function(){return Ib.Defaults.ATTACHMENT_OUTLINE_COLOR},getCap:function(){return Ib.Defaults.ATTACHMENT_CAP},getJoin:function(){return Ib.Defaults.ATTACHMENT_JOIN},isShadowable:function(){return Ib.Defaults.ATTACHMENT_SHADOWABLE},getRoundRect:function(){return Jb.clone(this._roundRect)},getContentRect:function(){return Jb.clone(this._contentRect)}}),Ib.canvas.LabelAttachment=function(a,b){Ib.canvas.LabelAttachment.superClass.constructor.call(this,a,b)},Jb.ext("twaver.canvas.LabelAttachment",Ib.canvas.BasicAttachment,{paint:function(a){var b=this._element instanceof Ib.Link&&this._element.getStyle("link.label.rotatable");if(b){a.save();var c=this._viewRect.x+this._viewRect.width/2,d=this._viewRect.y+this._viewRect.height/2;a.translate(c,d),a.rotate(this._network.getElementUI(this._element).getAngle()),a.translate(-c,-d)}Ib.canvas.LabelAttachment.superClass.paint.apply(this,arguments);var e=this._element.getStyle("label.align"),f=this._element&&this._element.getStyle("label.rotate.angle");0!==f&&(a.save(),Ib.Util.rotateCanvas(a,this._contentRect,f)),
Xb.drawText(a,this.text,this._contentRect,this.font,this.getStyle("label.color"),e),(b||0!==f)&&a.restore()},validate:function(){this.font=this.getFont("label.font");var a=this.getLabel(),b=Jb.g.getTextSize(this.font,a),c=this.getMaxLength();0!==c&&b.width>c?(this.text=Jb.g.getCollapseTextInLength(this.font,a,c),this._textSize=Jb.g.getTextSize(this.font,this.text)):(this.text=a,this._textSize=b),Ib.canvas.LabelAttachment.superClass.validate.call(this);var d=this._viewRect,e=this._element&&this._element.getStyle("label.rotate.angle");if(0!==e){var f=new Ib.List;f.add({x:d.x,y:d.y}),f.add({x:d.x+d.width,y:d.y}),f.add({x:d.x+d.width,y:d.y+d.height}),f.add({x:d.x,y:d.y+d.height}),f=this._rotatePointList(f,e,d);var g=Ib.Util.getRect(f);this._viewRect=g}},getLabel:function(){return this._network.getLabel(this._element)},getContentWidth:function(){return this._textSize?this._textSize.width:0},getContentHeight:function(){return this._textSize?this._textSize.height:0},getCornerRadius:function(){return this.getStyle("label.corner.radius")},getPointerLength:function(){return this.getStyle("label.pointer.length")},getPointerWidth:function(){return this.getStyle("label.pointer.width")},getPosition:function(){return this.getStyle("label.position")},getXOffset:function(){return this.getStyle("label.xoffset")},getYOffset:function(){return this.getStyle("label.yoffset")},getPadding:function(){return this.getStyle("label.padding")},getPaddingLeft:function(){return this.getStyle("label.padding.left")},getPaddingRight:function(){return this.getStyle("label.padding.right")},getPaddingTop:function(){return this.getStyle("label.padding.top")},getPaddingBottom:function(){return this.getStyle("label.padding.bottom")},getDirection:function(){return this.getStyle("label.direction")},isFill:function(){return this.getStyle("label.fill")},getFillColor:function(){return this.getStyle("label.fill.color")},getGradient:function(){return this.getStyle("label.gradient")},getGradientColor:function(){return this.getStyle("label.gradient.color")},getOutlineWidth:function(){return this.getStyle("label.outline.width")},getOutlineColor:function(){return this.getStyle("label.outline.color")},getCap:function(){return this.getStyle("label.cap")},getJoin:function(){return this.getStyle("label.join")},getAlpha:function(){return this.getStyle("label.alpha")},getMaxLength:function(){return this.getStyle("label.maxlength")},isShadowable:function(){return this.getStyle("label.shadowable")}}),Ib.canvas.AlarmAttachment=function(a,b){Ib.canvas.AlarmAttachment.superClass.constructor.call(this,a,b)},Jb.ext("twaver.canvas.AlarmAttachment",Ib.canvas.BasicAttachment,{paint:function(a){Ib.canvas.AlarmAttachment.superClass.paint.apply(this,arguments),Xb.drawText(a,this.text,this._contentRect,this.font,this.getStyle("alarm.color"))},validate:function(){this.font=this.getFont("alarm.font"),this.text=this._network.getAlarmLabel(this._element),this._textSize=Xb.getTextSize(this.font,this.text),this._fillColor=this._network.getAlarmFillColor(this._element),Ib.canvas.LabelAttachment.superClass.validate.call(this)},getContentWidth:function(){return this._textSize?this._textSize.width:0},getContentHeight:function(){return this._textSize?this._textSize.height:0},getCornerRadius:function(){return this.getStyle("alarm.corner.radius")},getPointerLength:function(){return this.getStyle("alarm.pointer.length")},getPointerWidth:function(){return this.getStyle("alarm.pointer.width")},getPosition:function(){return this.getStyle("alarm.position")},getXOffset:function(){return this.getStyle("alarm.xoffset")},getYOffset:function(){return this.getStyle("alarm.yoffset")},getPadding:function(){return this.getStyle("alarm.padding")},getPaddingLeft:function(){return this.getStyle("alarm.padding.left")},getPaddingRight:function(){return this.getStyle("alarm.padding.right")},getPaddingTop:function(){return this.getStyle("alarm.padding.top")},getPaddingBottom:function(){return this.getStyle("alarm.padding.bottom")},getDirection:function(){return this.getStyle("alarm.direction")},isFill:function(){return null!=this._fillColor},getFillColor:function(){return this._fillColor},getGradient:function(){return this.getStyle("alarm.gradient")},getGradientColor:function(){return this.getStyle("alarm.gradient.color")},getOutlineWidth:function(){return this.getStyle("alarm.outline.width")},getOutlineColor:function(){return this.getStyle("alarm.outline.color")},getCap:function(){return this.getStyle("alarm.cap")},getJoin:function(){return this.getStyle("alarm.join")},getAlpha:function(){return this.getStyle("alarm.alpha")},isShadowable:function(){return this.getStyle("alarm.shadowable")}}),Ib.canvas.LinkHandlerAttachment=function(a,b){Ib.canvas.LinkHandlerAttachment.superClass.constructor.call(this,a,b)},Jb.ext("twaver.canvas.LinkHandlerAttachment",Ib.canvas.BasicAttachment,{paint:function(a){Ib.canvas.LinkHandlerAttachment.superClass.paint.apply(this,arguments),Xb.drawText(a,this.linkHandlerLabel,this._contentRect,this.linkHandlerFont,this.getStyle("link.handler.color"))},validate:function(){this.linkHandlerFont=this.getFont("link.handler.font"),this.linkHandlerLabel=this._network.getLinkHandlerLabel(this._element),this._textSize=Xb.getTextSize(this.linkHandlerFont,this.linkHandlerLabel),Ib.canvas.LinkHandlerAttachment.superClass.validate.call(this)},getContentWidth:function(){return this._textSize?this._textSize.width:0},getContentHeight:function(){return this._textSize?this._textSize.height:0},getCornerRadius:function(){return this.getStyle("link.handler.corner.radius")},getPointerLength:function(){return this.getStyle("link.handler.pointer.length")},getPointerWidth:function(){return this.getStyle("link.handler.pointer.width")},getPosition:function(){return this.getStyle("link.handler.position")},getXOffset:function(){return this.getStyle("link.handler.xoffset")},getYOffset:function(){return this.getStyle("link.handler.yoffset")},getPadding:function(){return this.getStyle("link.handler.padding")},getPaddingLeft:function(){return this.getStyle("link.handler.padding.left")},getPaddingRight:function(){return this.getStyle("link.handler.padding.right")},getPaddingTop:function(){return this.getStyle("link.handler.padding.top")},getPaddingBottom:function(){return this.getStyle("link.handler.padding.bottom")},getDirection:function(){return this.getStyle("link.handler.direction")},isFill:function(){return this.getStyle("link.handler.fill")},getFillColor:function(){return this.getStyle("link.handler.fill.color")},getGradient:function(){return this.getStyle("link.handler.gradient")},getGradientColor:function(){return this.getStyle("link.handler.gradient.color")},getOutlineWidth:function(){return this.getStyle("link.handler.outline.width")},getOutlineColor:function(){return this.getStyle("link.handler.outline.color")},getCap:function(){return this.getStyle("link.handler.cap")},getJoin:function(){return this.getStyle("link.handler.join")},getAlpha:function(){return this.getStyle("link.handler.alpha")},isShadowable:function(){return this.getStyle("link.handler.shadowable")}}),Ib.canvas.IconsAttachment=function(a,b){Ib.canvas.IconsAttachment.superClass.constructor.call(this,a,b)},Jb.ext("twaver.canvas.IconsAttachment",Ib.canvas.Attachment,{isShadowable:function(){return Ib.Defaults.ATTACHMENT_SHADOWABLE},validate:function(){if(Ib.canvas.IconsAttachment.superClass.validate.call(this),this.iconsNames=this._network.getIconsNames(this._element),this.iconsNames&&0!=this.iconsNames.length){var a=this._makeGroup(this.iconsNames),b=this._makeGroup(this._network.getIconsColors(this._element));len=a.length,this.iconsOrientation=this._makeArray(this._element.getStyle("icons.orientation"),len,"right"),this.iconsPosition=this._makeArray(this._element.getStyle("icons.position"),len,"topleft.bottomright"),this.iconsXoffset=this._makeArray(this._element.getStyle("icons.xoffset"),len,0),this.iconsYoffset=this._makeArray(this._element.getStyle("icons.yoffset"),len,0),this.iconsXgap=this._makeArray(this._element.getStyle("icons.xgap"),len,1),this.iconsYgap=this._makeArray(this._element.getStyle("icons.ygap"),len,1),this.locations=[],this.iconsSizes=[];var c,d;for(i=0;i<len;i++){var e=a[i],f=this.iconsOrientation[i]||"right",g=this.iconsPosition[i]||"topleft.bottomright",h=this.iconsXgap[i]||1,j=this.iconsYgap[i]||1,k=this.iconsXoffset[i]||0,l=this.iconsYoffset[i]||0;if(this._ui._element instanceof Ib.Link){var m,n=this._ui.getLinkPoints();m=this._ui.getLineLength?this._ui.getLineLength():this._ui._element.getLineLength(),Math.abs(k)>0&&Math.abs(k)<1?"from"===g?k*=m:"to"===g?k=m*(1-k):(k/=2,k+=.5,k*=m):"from"===g?k=k:"to"===g?k=m-k:k+=m/2;var o,p=Tb.calculatePointInfoAlongLine(n,!0,k,l),q=p.point;p.angle,o="from"===g?this._ui.getFromPoint():"to"===g?this._ui.getToPoint():this._ui._hotSpot,k=q.x-o.x,l=q.y-o.y}d=null,c=this._getIconsSize(e,f,h,j),c&&(d=this._network.getPosition(g,this._ui,c,k,l),"top"===f?d.y+=c.height:"left"===f&&(d.x+=c.width)),this.locations.push(d),this.iconsSizes.push(c)}var r=null;for(i=0;i<this.locations.length;i++)d=this.locations[i],c=this.iconsSizes[i],null!=d&&(r=null==r?{x:d.x,y:d.y,width:c.width,height:c.height}:Tb.unionRect(r,{x:d.x,y:d.y,width:c.width,height:c.height}));this._viewRect=r||{x:this._element.getLocation().x,y:this._element.getLocation().y,width:0,height:0},this.iconsGroups=a,this.colorGroups=b;var s=this._element instanceof Ib.Link&&this._element.getStyle("link.icons.rotatable");for(i=0;i<len;i++)if(s instanceof Array&&s[i]&&this._viewRect){var t=this._viewRect.x+this._viewRect.width/2,u=this._viewRect.y+this._viewRect.height/2,v=Math.sqrt(this._viewRect.height*this._viewRect.height+this._viewRect.width*this._viewRect.width);this._viewRect={x:t-v/2,y:u-v/2,width:v,height:v}}}},_makeGroup:function(a){if(!Array.isArray(a))return[[a]];var b,c,d,e=[],f=!1,g=a.length;for(b=0;g>b;b++)c=a[b],Array.isArray(c)?(f=!0,e.push(c)):(d=[c],e.push(d));return f||(e.length=0,e.push(a)),e},_makeArray:function(a,b,c){if(Array.isArray(a))return a;for(var d=[],e=0;b>e;e++)d.push(a||c);return d},paint:function(a){if(Ib.canvas.IconsAttachment.superClass.paint.apply(this,arguments),this.iconsNames&&0!=this.iconsNames.length&&this.locations){var b,c,d,e,f,g,h,i,j,k;for(b=0;b<this.iconsGroups.length;b++)if(c=this.locations[b]){f=c.x,g=c.y,e=this.iconsGroups[b],h=this.colorGroups[b],i=this.iconsOrientation[b],j=this.iconsXgap[b]||1,k=this.iconsYgap[b]||1,d=0;for(var l in e){var m=null,n=null;h&&h.length>d&&(n=h[d++]);var o=Jb.getImageAsset(e[l]);if(null!=o){if("right"===i)m={x:f,y:g,width:o.getWidth(),height:o.getHeight()},f+=m.width+j;else if("left"===i)m={x:f-o.getWidth(),y:g,width:o.getWidth(),height:o.getHeight()},f-=m.width+j;else if("top"===i)m={x:f,y:g-o.getHeight(),width:o.getWidth(),height:o.getHeight()},g-=m.height+k;else{if("bottom"!==i)throw"Can not resolve '"+i+"' orientation";m={x:f,y:g,width:o.getWidth(),height:o.getHeight()},g+=m.height+k}var p=this._element instanceof Ib.Link&&this._element.getStyle("link.icons.rotatable");if(p instanceof Array&&p[b]){a.save();var q=m,f=q.x+q.width/2,g=q.y+q.height/2;a.translate(f,g),a.rotate(this._network.getElementUI(this._element).getAngle()),a.translate(-f,-g),Nc(a,o.getImage(n,m.width,m.height),n,m,this._element,this._network),a.restore()}else Nc(a,o.getImage(n,m.width,m.height),n,m,this._element,this._network);if(this._network._debug){var m=this._viewRect;Xb.strokeRect(a,m,"#FCFC00",1),Xb.strokeRect(a,m,"#FCFC00",1)}}}}}},_getIconsSize:function(a,b,c,d){var e=0,f=0,g=null,h=null,i=null;for(var j in a)if(h=Jb.getImageAsset(a[j])){if("right"===b)g={x:e,y:f,width:h.getWidth(),height:h.getHeight()},e+=g.width+c;else if("left"===b)g={x:e-h.getWidth(),y:f,width:h.getWidth(),height:h.getHeight()},e-=g.width+c;else if("top"===b)g={x:e,y:f-h.getHeight(),width:h.getWidth(),height:h.getHeight()},f-=g.height+d;else{if("bottom"!==b)throw"Can not resolve '"+b+"' orientation";g={x:e,y:f,width:h.getWidth(),height:h.getHeight()},f+=g.height+d}i=null==i?Jb.clone(g):Tb.unionRect(i,g)}return i?{width:Math.abs(i.width),height:Math.abs(i.height)}:null}}),Ib.canvas.EditAttachment=function(a,b){Ib.canvas.EditAttachment.superClass.constructor.call(this,a,b)},Jb.ext("twaver.canvas.EditAttachment",Ib.canvas.Attachment,{paint:function(a){Ib.canvas.EditAttachment.superClass.paint.apply(this,arguments),this._viewRect=null,this.paintResizingPoints(a),this.paintEditPoints(a),this.paintRotatePoints(a)},paintResizingPoints:function(a){var b=this.resizingPoints.size();if(!(0>=b)){var c=2*this.resizePointSize,d=2*this.resizePointSize,e=this._network.getResizePointFillColor(),f=this._network.getResizePointOutlineWidth(),g=this._network.getResizePointOutlineColor(),h=this._element.getAngle(),i=this._element.getOriginalRect();a.lineWidth=f;for(var j=0;b>j;j++){var k=this.resizingPoints.get(j),l={x:k.x-this.resizePointSize,y:k.y-this.resizePointSize,width:2*this.resizePointSize,height:2*this.resizePointSize},m=this._getRotateRect(l,h,{x:i.x+i.width/2,y:i.y+i.height/2});a.save(),Ib.Util.rotateCanvas(a,m,h),Od.rect(a,m.x,m.y,c,d),a.restore()}a.fillStyle=e,a.strokeStyle=g,a.fill(),a.stroke()}},paintEditPoints:function(a){var b=this.editPoints.size();if(!(0>=b)){var c=this._network.getEditPointOutlineColor(),d=this._network.getEditPointFillColor(),e=this._network.getEditPointOutlineWidth();a.beginPath(),a.lineWidth=e;for(var f=0;b>f;f++){var g=this.editPoints.get(f);a.beginPath(),Od.circle(a,g.x,g.y,this.editPointSize,d,c),a.closePath()}}},paintRotatePoints:function(a){var b=this.rotatePoints.size();if(!(0>=b)){var c=this._network.getRotatePointOutlineColor(),d=this._network.getRotatePointFillColor(),e=this._network.getRotatePointOutlineWidth();a.beginPath(),a.lineWidth=e;for(var f=0;b>f;f++){var g=this.rotatePoints.get(f);a.beginPath(),Od.circle(a,g.x,g.y,this.rotatePointSize,d,c),a.closePath()}}},validate:function(){Ib.canvas.EditAttachment.superClass.validate.call(this),this.editPointSize=this._network.getEditPointSize(),this.resizePointSize=this._network.getResizePointSize(),this.rotatePointSize=this._network.getRotatePointSize(),this.resizingPoints=new Ib.List,this.editPoints=new Ib.List,this.rotatePoints=new Ib.List,this._element instanceof Ib.Node&&this._addResizingPoint(this._element),!(this._network.isRotatable(this._element)&&this._element instanceof Ld)||this._element instanceof Ib.ShapeNode||this._element instanceof Ib.Grid||this._element instanceof Ib.Group||this._addRotatePoint(this._element),this._element instanceof Ib.ShapeNode&&(this._addResizingPoint(this._element),this._addShapeNodePoint(this._element)),this._ui instanceof Ib.canvas.ShapeLinkUI&&this._addShapeLinkPoints(this._element),this._ui instanceof Ib.canvas.LinkUI&&this._addLinkControlPoint(this._ui)},_addResizingPoint:function(a){var b=a.getOriginalRect();if(b){var c=this._network.getResizePointSize();if(!(0>=c)){var d=new nd([{x:b.x,y:b.y},{x:b.x+b.width/2,y:b.y},{x:b.x+b.width,y:b.y},{x:b.x,y:b.y+b.height/2},{x:b.x+b.width,y:b.y+b.height/2},{x:b.x,y:b.y+b.height},{x:b.x+b.width/2,y:b.y+b.height},{x:b.x+b.width,y:b.y+b.height}]),e=this._network.getResizePointOutlineWidth(),f=this._network.getResizePointOutlineColor(),g=this._network.getResizePointFillColor();this._addPoints(a.getRect(),d,e,f,g,!0)}}},_addRotatePoint:function(a){var b=a.getOriginalRect();if(b){var c=this._network.getRotatePointSize();if(!(0>=c)){var d=2*c,e=new Ib.List([{x:b.x+b.width/2,y:b.y-this._network.getRotatePointOffset()-d/2}]),f=a.getAngle();0!=f&&(e=this._rotatePointList(e,f,a.getOriginalRect()));var g=e.get(0),h={x:g.x-d/2,y:g.y-d/2,width:d,height:d},i=this._network.getRotatePointOutlineWidth(),j=this.rotatePointSize+i;Tb.grow(b,j,j);var k=Tb.unionRect(a.getRect(),h);this._viewRect=Tb.unionRect(k,this._viewRect),this.rotatePoints=e}}},_addShapeNodePoint:function(a){this._addEditPoints(a.getPoints())},_addShapeLinkPoints:function(a){this._addEditPoints(a.getPoints())},_addLinkControlPoint:function(a){if(xc.isOrthogonalLink(a._element)){var b=a.getControlPoint();if(b){var c=new Ib.List;c.add(b),this._addEditPoints(c)}}},_addEditPoints:function(a){var b=Tb.getRect(a);if(b){var c=this._network.getEditPointSize();if(!(0>=c)){var d=this._network.getEditPointOutlineWidth();this._addPoints(b,a,d,!1)}}},_addPoints:function(a,b,c,d,e,f){var g=f?this._network.getResizePointSize():this._network.getEditPointSize();if(!(0>g)){var h=g+c;Tb.grow(a,h,h),this._viewRect=Tb.unionRect(a,this._viewRect),1==f?this.resizingPoints=b:this.editPoints=b}},_rotatePoint:function(a,b,c){var d=Tb.createMatrix(b*Math.PI/180,c.x+c.width/2,c.y+c.height/2),e=d.transform(a);return e},_rotatePointList:function(a,b,c){var d=this,e=new Ib.List;return a.forEach(function(a){e.add(d._rotatePoint(a,b,c))}),e},_getRotateRect:function(a,b,c){var d=Tb.createMatrix(b*Math.PI/180,c.x,c.y),e={x:a.x+a.width/2,y:a.y+a.height/2},f=d.transform(e),g=new Ib.List([{x:f.x-a.width/2,y:f.y-a.height/2},{x:f.x+a.width/2,y:f.y-a.height/2},{x:f.x+a.width/2,y:f.y+a.height/2},{x:f.x-a.width/2,y:f.y+a.height/2}]);return Tb.getRect(g)}}),Ib.canvas.HTMLLabelAttachment=function(a,b){Ib.canvas.HTMLLabelAttachment.superClass.constructor.call(this,a,b),this._triangleDiv=Ib.Util.createDiv(),this._roundDiv=Ib.Util.createDiv(),this._contentDiv=Ib.Util.createDiv(),this._network.getView().appendChild(this._roundDiv),this._roundDiv.appendChild(this._contentDiv)},Jb.ext("twaver.canvas.HTMLLabelAttachment",Ib.canvas.LabelAttachment,{validate:function(){var a=this._element.getStyle("attachment.htmllabel.hyperlink");a?(Ib.Util.setCSSStyle(this._triangleDiv,"pointer-events","auto"),Ib.Util.setCSSStyle(this._contentDiv,"pointer-events","auto")):(Ib.Util.setCSSStyle(this._triangleDiv,"pointer-events","none"),Ib.Util.setCSSStyle(this._contentDiv,"pointer-events","none")),Ib.Util.setCSSStyle(this._triangleDiv,"border-style","solid"),Ib.Util.setCSSStyle(this._contentDiv,"white-space","nowrap");var b=(this.getFont("label.font"),this.getLabel());this._contentDiv.innerHTML=b,this._contentDiv.style.visibility="hidden",Ib.canvas.HTMLLabelAttachment.superClass.validate.call(this)},getContentWidth:function(){return this._contentDiv.scrollWidth||parseInt(Ib.Util.getCSSStyle(this._contentDiv.firstChild,"width"))},getContentHeight:function(){return this._contentDiv.scrollHeight||parseInt(Ib.Util.getCSSStyle(this._contentDiv.firstChild,"height"))},paint:function(a){var b=this.isFill(),c=this.getOutlineWidth(),d=this._contentRect;if(this.getElementUI().setShadow(this,a),c>0||b){if(Xb.drawRoundRect(a,d.x,d.y,d.width,d.height,this.getCornerRadius()),this._pointers){var e=this._pointers;a.moveTo(e[0].x,e[0].y),a.lineTo(e[1].x,e[1].y),a.lineTo(e[2].x,e[2].y)}if(a.closePath(),c>0&&(a.lineWidth=c,a.strokeStyle=this.getOutlineColor(),a.lineCap=this.getCap(),a.lineJoin=this.getJoin(),a.stroke()),b){var f=this.getFillColor(),g=this.getGradient();g?Xb.fill(a,f,g,this.getGradientColor(),this._viewRect):a.fillStyle=f,a.fill()}}var h=(this.getFont("label.font"),this.getLabel(),this._network.getViewRect().x),i=this._network.getViewRect().y,j=this._network.getZoom(),k={x:this._contentRect.x+this._contentRect.width/2,y:this._contentRect.y+this._contentRect.height/2},l=k.x*j-h-this._contentDiv.offsetWidth/2*j+"px",m=k.y*j-i-this._contentDiv.offsetHeight/2*j+"px";this._contentDiv.style.left=l,this._contentDiv.style.top=m,this._contentDiv.style.setProperty("-webkit-transform","scale("+j+")",null),this._contentDiv.style.setProperty("-webkit-transform-origin","0 0",null),this._network._debug&&Xb.strokeRect(a,this._contentRect,"#AAAAAA")},setVisibility:function(a){this._contentDiv.style.visibility=a},dispose:function(){this._network.getView().removeChild(this._roundDiv)},getView:function(){return this._roundDiv}}),Ib.canvas.HTMLAlarmAttachment=function(a,b){Ib.canvas.HTMLAlarmAttachment.superClass.constructor.call(this,a,b),this._triangleDiv=Ib.Util.createDiv(),this._roundDiv=Ib.Util.createDiv(),this._contentDiv=Ib.Util.createDiv(),Ib.Util.setCSSStyle(this._triangleDiv,"border-style","solid"),Ib.Util.setCSSStyle(this._triangleDiv,"pointer-events","none"),Ib.Util.setCSSStyle(this._contentDiv,"white-space","nowrap"),Ib.Util.setCSSStyle(this._contentDiv,"pointer-events","none"),this._network.getView().appendChild(this._roundDiv),this._roundDiv.appendChild(this._contentDiv)},Jb.ext("twaver.canvas.HTMLAlarmAttachment",Ib.canvas.AlarmAttachment,{validate:function(){var a=(this.getFont("alarm.font"),this._network.getAlarmLabel(this._element));this._contentDiv.innerHTML=a,this._contentDiv.style.visibility="hidden",Ib.canvas.HTMLAlarmAttachment.superClass.validate.call(this)},getContentWidth:function(){return this._contentDiv.scrollWidth||parseInt(Ib.Util.getCSSStyle(this._contentDiv.firstChild,"width"))},getContentHeight:function(){return this._contentDiv.scrollHeight||parseInt(Ib.Util.getCSSStyle(this._contentDiv.firstChild,"height"))},paint:function(a){var b=this.isFill(),c=this.getOutlineWidth(),d=this._contentRect;if(this.getElementUI().setShadow(this,a),c>0||b){if(Xb.drawRoundRect(a,d.x,d.y,d.width,d.height,this.getCornerRadius()),this._pointers){var e=this._pointers;a.moveTo(e[0].x,e[0].y),a.lineTo(e[1].x,e[1].y),a.lineTo(e[2].x,e[2].y)}if(a.closePath(),c>0&&(a.lineWidth=c,a.strokeStyle=this.getOutlineColor(),a.lineCap=this.getCap(),a.lineJoin=this.getJoin(),a.stroke()),b){var f=this.getFillColor(),g=this.getGradient();g?Xb.fill(a,f,g,this.getGradientColor(),this._viewRect):a.fillStyle=f,a.fill()}}var h=(this.getFont("alarm.font"),this._network.getAlarmLabel(this._element),this._network.getViewRect().x),i=this._network.getViewRect().y,j=this._network.getZoom(),k={x:this._contentRect.x+this._contentRect.width/2,y:this._contentRect.y+this._contentRect.height/2},l=k.x*j-h-this._contentDiv.offsetWidth/2*j+"px",m=k.y*j-i-this._contentDiv.offsetHeight/2*j+"px";this._contentDiv.style.left=l,this._contentDiv.style.top=m,this._contentDiv.style.setProperty("-webkit-transform","scale("+j+")",null),this._contentDiv.style.setProperty("-webkit-transform-origin","0 0",null),this._network._debug&&Xb.strokeRect(a,this._contentRect,"#AAAAAB"),Ib.canvas.AlarmAttachment.superClass.paint.apply(this,arguments)},setVisibility:function(a){this._contentDiv.style.visibility=a},dispose:function(){this._network.getView().removeChild(this._roundDiv)},getView:function(){return this._roundDiv}}),Ib.canvas.interaction.BaseInteraction=function(a){this.network=a},Jb.ext("twaver.canvas.interaction.BaseInteraction",Object,{setUp:function(){},tearDown:function(){},repaint:function(){this.network.repaintTopCanvas()},convertPointFromView:function(a){var b=a.x*this.network.getZoom()-this.network.getViewRect().x,c=a.y*this.network.getZoom()-this.network.getViewRect().y;return{x:b,y:c}},convertFromUIToMarkerRect:function(a,b,c){var d=this.network.getZoom();return{x:a.x*d-this.network.getViewRect().x+b*d,y:a.y*d-this.network.getViewRect().y+c*d,width:a.width*d,height:a.height*d}},getMarkerPoint:function(a){var b;if(Qb.isTouchable&&a.changedTouches&&a.changedTouches.length>0){var c=a.changedTouches[0];return b={x:c.clientX,y:c.clientY}}return b=Qb.isFirefox?{x:a.layerX,y:a.layerY}:{x:a.offsetX,y:a.offsetY}},paint:function(a){},addListener:function(){for(var a=0;a<arguments.length;a++){var b=arguments[a];Wb.addEventListener(b,"handle_"+b,this.network.getView(),this)}},removeListener:function(){for(var a=0;a<arguments.length;a++)Wb.removeEventListener(arguments[a],this.network.getView(),this)},_handle_mousedown:function(a){0===a.button&&(this._startLogical=this.network.getLogicalPoint(a),this._startClient=Wb.getClientPoint(a),this._startLogical&&Wb.handle_mousedown(this,a))},_handle_mousemove:function(a){this._endLogical={x:this._startLogical.x+(a.clientX-this._startClient.x)/this.network.getZoom(),y:this._startLogical.y+(a.clientY-this._startClient.y)/this.network.getZoom()}},_handle_mouseup:function(a){delete this._startClient,delete this._startLogical,delete this._endLogical}}),Ib.canvas.interaction.SelectInteraction=function(a){Ib.canvas.interaction.SelectInteraction.superClass.constructor.call(this,a)},Jb.ext("twaver.canvas.interaction.SelectInteraction",Ib.canvas.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown","mouseup"),this.network.addMarker(this)},tearDown:function(){this.removeListener("mousedown","mouseup"),this.end(),this.network.removeMarker(this)},paint:function(a){if(null!=this.startPoint&&null!=this.endPoint){var b=this.convertPointFromView(this.startPoint),c=this.convertPointFromView(this.endPoint),d=b.x,e=b.y,f=c.x,g=c.y,h=Tb.getRect([{x:d,y:e},{x:f,y:g}]);if(null!=h){a.beginPath();var i=this.network.getSelectOutlineWidth(),j=this.getIntersectMode()?this.network.getSelectFillColor():null;a.strokeStyle=this.network.getSelectOutlineColor(),a.lineWidth=i,Od.rect(a,h.x,h.y,h.width,h.height,j,this.network.getSelectOutlineColor()),a.closePath()}}},handle_mousedown:function(a){if(this.network.isValidEvent(a)&&!this.network.isMovingElement()&&!this.network.isEditingElement()&&!a.shiftKey){var b=this.network.getElementAt(a),c=this.network.getSelectionModel();b?Jb.isCtrlDown(a)?c.contains(b)?c.removeSelection(b):c.appendSelection(b):c.contains(b)||c.setSelection(b):(Jb.isCtrlDown(a)||c.clearSelection(),this.end(a),this.startPoint=this.network.getLogicalPoint(a),this.startPoint&&this.network.isRectSelectEnabled()&&this.addListener("mousemove"))}},handle_mouseup:function(a){this.end(a)},handle_mousemove:function(a){if(this.network.isMovingElement()||this.network.isEditingElement())return void this.end(a);var b=this.network.getLogicalPoint(a);b&&(this.network.setSelectingElement(!0),this.network.fireInteractionEvent(null==this.endPoint?{kind:"selectStart",event:a}:{kind:"selectBetween",event:a}),this.endPoint=b,this.repaint())},end:function(a){if(this.startPoint){if(this.endPoint&&this.startPoint.x!==this.endPoint.x&&this.startPoint.y!==this.endPoint.y){var b=Tb.getRect([this.startPoint,this.endPoint]),c=this.network.getElementsAtRect(b,this.getIntersectMode(),this.network.getRectSelectFilter());if(c&&c.size()>0){var d=this.network.getSelectionModel(),e=d.toSelection();c.forEach(function(a){d.contains(a)?e.remove(a):e.add(a)},this),d.setSelection(e)}this.network.fireInteractionEvent({kind:"selectEnd",event:a})}this.network.setSelectingElement(!1),this.removeListener("mousemove"),this.startPoint=null,this.endPoint=null,this.repaint()}},getIntersectMode:function(){return"intersect"===this.network.getSelectMode()?!0:"contain"===this.network.getSelectMode()?!1:this.startPoint.x>this.endPoint.x&&this.startPoint.y>this.endPoint.y}}),Ib.canvas.interaction.MoveInteraction=function(a,b){this.lazyMode=b,Ib.canvas.interaction.MoveInteraction.superClass.constructor.call(this,a)},Jb.ext("twaver.canvas.interaction.MoveInteraction",Ib.canvas.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown","mouseup","keydown","mouseout"),this.network.addMarker(this)},tearDown:function(){this.removeListener("mousedown","mouseup","keydown","mouseout"),this.end(),this.network.removeMarker(this)},handle_keydown:function(a){this.currentKeyEvent=a,this.addListener("keyup")},handle_keyup:function(a){this.currentKeyEvent=null,this.removeListener("keyup")},isParenting:function(){return this.pressPoint&&null!=this.currentKeyEvent&&80===this.currentKeyEvent.keyCode},parentProcess:function(a,b){var c=null;this.parent=null;var d=this;if(!b&&this.isParenting()){var e={},f=this.network.getLogicalPoint(a);e.x=f.x-1,e.y=f.y-1,e.width=2,e.height=2;var g=this.network.getElementsAtRect(e,!0);if(g&&g.size()>0)for(var h=g.size(),i=0;h>i;i++){var j=g.get(i);if(!d.network.getElementBox().getSelectionModel().contains(j)){d.parent=j;break}}}else this.parent=null;null!=this.parent&&(c=this.network.getElementUI(this.parent).getViewRect()),this.parentRect=null==c||b?null:c},paint:function(a){if(this.lazyMode){if(null==this.pressPoint||null==this.dragPoint)return;a.beginPath();var b=this.dragPoint.x-this.pressPoint.x,c=this.dragPoint.y-this.pressPoint.y,d=this.network.getMovableSelectedElements(),e=d.size(),f=this.network.isLazyMoveFill()?this.network.getLazyMoveFillColor():null,g=this.network.getLazyMoveOutlineWidth(),h=this.network.getLazyMoveOutlineColor();a.strokeStyle=h,a.lineWidth=g,a.fillStyle=f;for(var i=0;e>i;i++){var j=d.get(i),k=this.network.getElementUI(j);if(k){var l=this.convertFromUIToMarkerRect(k.getViewRect(),b,c);Od.rect(a,l.x,l.y,l.width,l.height)}}a.fill(),a.stroke()}if(this.parentRect){a.beginPath();var f=this.network.isLazyMoveFill()?this.network.getLazyMoveFillColor():null,g=this.network.getLazyMoveOutlineWidth(),h=this.network.getLazyMoveOutlineColor();a.strokeStyle=h,a.lineWidth=g,a.fillStyle=f;var l=this.parentRect;Od.rect(a,l.x,l.y,l.width,l.height),a.fill(),a.stroke()}},handle_mousedown:function(a){if(0===a.button&&this.network.isValidEvent(a)&&!this.network.isSelectingElement()&&!this.network.isEditingElement()){var b=this.network.getElementAt(a);this.network.isMovable(b)&&(this.end(a),this.lastPoint=this.network.getLogicalPoint(a),this.lazyMode&&(this.pressPoint=this.lastPoint),this.lastPoint&&this.addListener("mousemove"))}},handle_mouseup:function(a){this.end(a)},handle_mouseout:function(a){this.end(a)},handle_mousemove:function(a){if(this.network.isSelectingElement()||this.network.isEditingElement()||!this.network.hasMovableSelectedElements())return void this.end(a);var b=this.network.getLogicalPoint(a);b&&this.lastPoint&&(this.xoffset=b.x-this.lastPoint.x,this.yoffset=b.y-this.lastPoint.y,Math.abs(this.xoffset)<1&&Math.abs(this.yoffset)<1||(this.lazyMode?null==this.dragPoint?(this.network.fireInteractionEvent({kind:"lazyMoveStart",event:a}),this.network.setMovingElement(!0)):this.network.fireInteractionEvent({kind:"lazyMoveBetween",event:a}):(this.lastPoint=b,this.network.isMovingElement()?this.network.fireInteractionEvent({kind:"liveMoveBetween",event:a}):(this.network.setMovingElement(!0),this.network.fireInteractionEvent({kind:"liveMoveStart",event:a})),this.network.moveSelectedElements(this.xoffset,this.yoffset)),this.parentProcess(a,!1),this.lazyMode&&(this.dragPoint=b),(this.lazyMode||this.isParenting())&&this.repaint()))},end:function(a){if(this.lazyMode){if(null!=this.dragPoint&&null!=this.pressPoint){var b=this,c=function(){b.network.fireInteractionEvent({kind:"lazyMoveEnd",event:a}),b.network.setMovingElement(!1)},d=this.dragPoint.x-this.pressPoint.x,e=this.dragPoint.y-this.pressPoint.y;this.network.moveSelectedElements(d,e,this.network.isLazyMoveAnimate(),c)}}else this.network.isMovingElement()&&(this.network.setMovingElement(!1),this.network.fireInteractionEvent({kind:"liveMoveEnd",event:a}));if(this.isParenting()){null==this.parent&&(this.parent=this.network.getCurrentSubNetwork());var b=this;this.network.getMovableSelectedElements().forEach(function(a){a.setParent(b.parent)},this.network)}this.parentProcess(a,!0),this.isParenting()&&this.repaint(),this.network.invalidateCanvasSize(),this.removeListener("mousemove"),this.lastPoint=null,this.dragPoint=null,this.pressPoint=null}}),Ib.canvas.interaction.ScrollInteraction=function(a){Ib.canvas.interaction.ScrollInteraction.superClass.constructor.call(this,a),this.hThumbRect=null,this.vThumbRect=null,this.scrollBarVisible=!1},Jb.ext("twaver.canvas.interaction.ScrollInteraction",Ib.canvas.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown","mouseover","mouseout"),Qb.isFirefox?Wb.addEventListener("DOMMouseScroll","handleMouseWheel",this.network.getView(),this):Wb.addEventListener("mousewheel","handleMouseWheel",this.network.getView(),this),Wb.addEventListener("mouseup","handleMouseUp",a,this),Wb.addEventListener("mousemove","handleMouseMove",a,this),this.network.addPropertyChangeListener(this.handleViewRectChange,this),this.validateScrollBar(),this.network.addMarker(this)},tearDown:function(){this.removeListener("mousedown","mouseover","mouseout"),Qb.isFirefox?Wb.removeEventListener("DOMMouseScroll",this.network.getView(),this):Wb.removeEventListener("mousewheel",this.network.getView(),this),
Wb.removeEventListener("mouseup",a,this),Wb.removeEventListener("mousemove",a,this),this.network.removePropertyChangeListener(this.handleViewRectChange,this),this.network.removeMarker(this)},handleViewRectChange:function(a){("viewRect"==a.property||"canvasSizeChange"==a.property)&&this.validateScrollBar()},getScrollBarWidth:function(){return this.network.getScrollBarWidth()},getScrollBarColor:function(){return"#cccccc"},validateScrollBar:function(){if(this.hThumbRect=null,this.vThumbRect=null,0==this.network.isScrollBarVisible())return void this.repaint();var a=this.network.getViewRect().height,b=this.network.getViewRect().width,c=this.network.getViewRect().x,d=this.network.getViewRect().y,e=this.network.getCanvasSize(),f=e.width,g=e.height;if(f>b&&(0>c||c+b>f))return void this.repaint();if(g>a&&(0>d||d+a>g))return void this.repaint();var h=0,i=g>a,j=f>b,k=this.getScrollBarWidth();if(g>a){h=j?a*(a-k)/g:a*a/g;var l=d/(g-a)*(a-h-k);this.vThumbRect={x:b-k,y:l,width:k,height:h}}var m=0;if(f>b){m=i?b*(b-k)/f:b*b/f;var n=c/(f-b)*(b-m-k);this.hThumbRect={x:n,y:a-k,width:m,height:k}}this.network.setHScrollBarVisible(null!=this.hThumbRect),this.network.setVScrollBarVisible(null!=this.vThumbRect),this.repaint()},scrollXOffset:function(a){var b=this.network.getViewRect().height,c=this.network.getViewRect().width,d=this.network.getViewRect().x,e=this.network.getViewRect().y,f=30;a&&(f=-30),this.network.setViewRect(d+f,e,c,b)},scrollYOffset:function(a){var b=this.network.getViewRect().height,c=this.network.getViewRect().width,d=this.network.getViewRect().x,e=this.network.getViewRect().y,f=30;a&&(f=-30),this.network.setViewRect(d,e+f,c,b)},handle_mousedown:function(a){if(1!=this.network.isValidEvent(a)){var b=this.getMarkerPoint(a);this.hBarDownPoint=null,this.vBarDownPoint=null,null!=this.vThumbRect&&Tb.containsPoint(this.vThumbRect,b.x,b.y)&&(this.vBarDownPoint={x:a.screenX,y:a.screenY},this.vBarDownOffset=this.vBarDownPoint.y-this.vThumbRect.y),null!=this.hThumbRect&&Tb.containsPoint(this.hThumbRect,b.x,b.y)&&(this.hBarDownPoint={x:a.screenX,y:a.screenY},this.hBarDownOffset=this.hBarDownPoint.x-this.hThumbRect.x)}},handle_mouseover:function(a){1!=this.scrollBarVisible&&(this.scrollBarVisible=!0,this.repaint())},handle_mouseout:function(a){0!=this.scrollBarVisible&&(this.scrollBarVisible=!1,this.repaint())},handleMouseUp:function(a){this.vBarDownPoint=null,this.hBarDownPoint=null,this.repaint()},handleMouseMove:function(a){var b={x:a.screenX,y:a.screenY},c=this.network.getCanvasSize(),d=this.network.getViewRect().height,e=this.network.getViewRect().width,f=this.getScrollBarWidth();if(null!=this.hBarDownPoint){var g=b.x-this.hBarDownPoint.x;return this.hBarDownPoint=b,void this.network.setViewOffSet(g*c.width/(e-f),0)}if(null!=this.vBarDownPoint){var h=b.y-this.vBarDownPoint.y;return this.vBarDownPoint=b,void this.network.setViewOffSet(0,h*c.height/(d-f))}},handleMouseWheel:function(a){var b=!1;a.wheelDelta!==a.wheelDeltaX?(a.wheelDelta?a.wheelDelta>0&&(b=!0):a.detail<0&&(b=!0),this.scrollYOffset(b)):(a.wheelDelta?a.wheelDelta>0&&(b=!0):a.detail<0&&(b=!0),this.scrollYOffset(b))},paintRoundRect:function(a,b,c,d,e,f,g,h){a.beginPath(),a.globalAlpha=c,a.fillStyle=b,Xb.drawRoundRect(a,d,e,f,g,h),a.fill()},paint:function(a){if(0!=this.network.isScrollBarVisible()&&(0!=this.scrollBarVisible||null!=this.hBarDownPoint||null!=this.vBarDownPoint)){var b=this.getScrollBarWidth(),c=this.network.getViewRect().height,d=this.network.getViewRect().width;a.save();var e,f=this.getScrollBarColor();null!=this.hThumbRect&&(e=a.createLinearGradient(this.hThumbRect.x,this.hThumbRect.y,this.hThumbRect.x,this.hThumbRect.y+this.hThumbRect.height),e.addColorStop(0,f),e.addColorStop(1,"#666666"),this.paintRoundRect(a,this.getScrollBarColor(),.5,0,c-b,d-b,b,b/2),this.paintRoundRect(a,e,.9,this.hThumbRect.x,this.hThumbRect.y+1,this.hThumbRect.width,this.hThumbRect.height-2,b/2)),null!=this.vThumbRect&&(e=a.createLinearGradient(this.vThumbRect.x,this.vThumbRect.y,this.vThumbRect.x+this.vThumbRect.width,this.vThumbRect.y),e.addColorStop(0,f),e.addColorStop(1,"#666666"),this.paintRoundRect(a,this.getScrollBarColor(),.5,d-b,0,b,c-b,b/2),this.paintRoundRect(a,e,.9,this.vThumbRect.x+1,this.vThumbRect.y,this.vThumbRect.width-2,this.vThumbRect.height,b/2)),a.restore()}}}),Ib.canvas.interaction.DefaultInteraction=function(a){Ib.canvas.interaction.DefaultInteraction.superClass.constructor.call(this,a)},Jb.ext("twaver.canvas.interaction.DefaultInteraction",Ib.canvas.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown","mousemove","keydown")},tearDown:function(){this.removeListener("mousedown","mousemove","keydown")},handle_mousedown:function(a){if(this.network.isValidEvent(a)){this.network.isFocusOnClick()&&Ib.Util.setFocus(this.network.getView());var b=this.network.getElementAt(a);2===a.detail?this.handleDoubleClicked(a,b):this.handleClicked(a,b)}},handleClicked:function(a,b){Cc.handleClicked(this.network,a,b)},handleDoubleClicked:function(a,b){Cc.handleDoubleClicked(this.network,a,b)},handle_keydown:function(a){Cc.handleKeyDown(this.network,a)},handle_mousemove:function(a){var b=this.network.getElementAt(a),c=this._preElement,d=Dc(c),e=Dc(b);c!==b&&(c&&(d&&d.onMouseLeave&&d.onMouseLeave(c,this.network),this.network.onMouseLeave(c,a)),b&&(e&&e.onMouseEnter&&e.onMouseEnter(b,this.network),this.network.onMouseEnter(b,a))),b&&e&&e.onMouseMove&&e.onMouseMove(b,this.network),this.network.onMouseMove(b,a),this._preElement=b}}),Ib.canvas.interaction.PanInteraction=function(a){Ib.canvas.interaction.PanInteraction.superClass.constructor.call(this,a)},Jb.ext("twaver.canvas.interaction.PanInteraction",Ib.canvas.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown","mouseup"),this._oldCursor=this.network.getView().style.cursor},tearDown:function(){this.removeListener("mousedown","mouseup")},handle_mousedown:function(a){this.network.isValidEvent(a)&&(this.lastPoint=this.getMarkerPoint(a),this.lastPoint&&(this.addListener("mousemove"),this.network.getView().style.cursor="pointer"))},handle_mouseup:function(a){this._clear()},handle_mousemove:function(a){if(this.lastPoint){var b=this.getMarkerPoint(a);if(b){var c=b.x-this.lastPoint.x,d=b.y-this.lastPoint.y;this.network.panByOffset(-c,-d),this.lastPoint=b}}},_clear:function(a){this.lastPoint&&(this.lastPoint=null,this.network.getView().style.cursor=this._oldCursor,this.removeListener("mousemove"))}}),Ib.canvas.interaction.CreateElementInteraction=function(a,b){b||(b=Ib.Node),this.elementFunction=Ib.Util.isTypeOf(b,Ib.Node)?function(a){var c=new b;return c instanceof Ib.Node&&c.setCenterLocation(a),c}:b,Ib.canvas.interaction.CreateElementInteraction.superClass.constructor.call(this,a)},Jb.ext("twaver.canvas.interaction.CreateElementInteraction",Ib.canvas.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown")},tearDown:function(){this.removeListener("mousedown")},handle_mousedown:function(a){var b=this.network.getLogicalPoint(a);if(b){var c=this.elementFunction(b);c&&this.network.addElementByInteraction(c)}}}),Ib.canvas.interaction.EditInteraction=function(a,b){this.lazyMode=b,this.pointIndex=-1,Ib.canvas.interaction.EditInteraction.superClass.constructor.call(this,a)},Jb.ext("twaver.canvas.interaction.EditInteraction",Ib.canvas.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown","mouseup","mousemove"),this.oldCursor=this.network.getView().style.cursor,this.network.setHasEditInteraction(!0),this.network.addMarker(this)},tearDown:function(){this.removeListener("mousedown","mouseup","mousemove"),this.network.getView().style.cursor=this.oldCursor,this.network.setHasEditInteraction(!1),this.clear(),this.network.removeMarker(this)},paint:function(a){if(1==this.lazyMode&&null!=this.resizingRect){a.lineWidth=this.network.getResizeLineWidth();var b=this.convertFromUIToMarkerRect(this.resizingRect,0,0);a.save(),Ib.Util.rotateCanvas(a,b,this.node.getAngle()),a.beginPath(),Od.rect(a,b.x,b.y,b.width,b.height,null,this.network.getResizeLineColor()),a.restore()}this.isStartRotate&&this.showRotateScale(a)},clear:function(){this.network.setEditingElement(!1),this.network.setRotatingElement(!1),this.isStart=!1,this.isStartRotate=!1,this.node=null,this.shapeNode=null,this.shapeLink=null,this.linkUI=null,this.resizingRect=null,this.resizeDirection=null,this.pointIndex=-1,this._removeCursor(),this.oldCursor=null,this.network.repaintTopCanvas()},_removeCursor:function(){this.cursorID&&(this.network.getView().style.cursor=this.oldCursor||"default",this.cursorID=null),this.resizeDirection=null,this.isCrossCursor=!1},_setCrossCursor:function(){this.isCrossCursor||(this._removeCursor(),this._setCursor("crosshair"),this.isCrossCursor=!0)},_setCursor:function(a){this.cursorID=a,this.network.getView().style.cursor!==this.cursorID&&(this.network.getView().style.cursor=this.cursorID)},handle_mousedown:function(a){if(0===a.button)if(!Jb.isAltDown(a)||this.network.isEditingElement())!this.network.isEditingElement()||this.isStart||this.isStartRotate||(this.node&&this.resizeDirection?(this.isStart=!0,this._handle_mousedown(a),this.network.fireInteractionEvent({kind:this.lazyMode?"lazyResizeStart":"liveResizeStart",event:a,element:this.node,resizeDirection:this.resizeDirection})):this.shapeNode&&this.pointIndex>=0?Jb.isAltDown(a)?(this.shapeNode.removeAt(this.pointIndex),this.network.fireInteractionEvent({kind:"removePoint",event:a,element:this.shapeNode})):(this.isStart=!0,this._handle_mousedown(a),this.network.fireInteractionEvent({kind:"liveMovePointStart",event:a,element:this.shapeNode,pointIndex:this.pointIndex})):this.shapeLink&&this.pointIndex>=0?Jb.isAltDown(a)?(this.shapeLink.removeAt(this.pointIndex),this.network.fireInteractionEvent({kind:"removePoint",event:a,element:this.shapeLink})):(this.isStart=!0,this._handle_mousedown(a),this.network.fireInteractionEvent({kind:"liveMovePointStart",event:a,element:this.shapeLink,pointIndex:this.pointIndex})):this.linkUI?(this.isStart=!0,this.network.fireInteractionEvent({kind:"liveMovePointStart",event:a,element:this.linkUI._element})):this.node&&(this.isStartRotate=!0,this._handle_mousedown(a)));else{var b=this.network.getElementAt(a),c=this.network.getLogicalPoint(a);if(b instanceof Ib.ShapeNode){var d=this.getPointIndex(b.getPoints(),c,!0);d>0&&(this._handle_mousedown(a),this.pointIndex=d,this.shapeNode=b,b.addPoint(c,d),this._setCrossCursor(),this.network.setEditingElement(!0),this.isStart=!0,this.network.fireInteractionEvent({kind:"addPoint",event:a,element:b,pointIndex:d}),this.network.fireInteractionEvent({kind:"liveMovePointStart",event:a,element:b,pointIndex:d}))}if(b instanceof Ib.ShapeLink){var e=new Ib.List(b.getPoints()),f=this.network.getElementUI(b);e.add(f.getFromPoint(),0),e.add(f.getToPoint());var d=this.getPointIndex(e,c)-1;d>0&&(this._handle_mousedown(a),this.pointIndex=d,this.shapeLink=b,b.addPoint(c,d),this._setCrossCursor(),this.network.setEditingElement(!0),this.isStart=!0,this.network.fireInteractionEvent({kind:"addPoint",event:a,element:b,pointIndex:d}),this.network.fireInteractionEvent({kind:"liveMovePointStart",event:a,element:b,pointIndex:d}))}}},handle_mouseup:function(a){if(this.isStart){var b=this.network.getLogicalPoint(a);if(this.resizingRect)if(this.lazyMode)if(this.network.isResizeAnimate()){var c=this,d=new Ib.animate.AnimateBounds(this.node,this.resizingRect,function(){c.network.fireInteractionEvent({kind:"lazyResizeEnd",event:a,element:c.node,resizeDirection:c.resizeDirection}),c.clear()});Ib.animate.AnimateManager.start(d)}else this.node.setLocation(this.resizingRect.x,this.resizingRect.y),this.node.setSize(this.resizingRect.width,this.resizingRect.height),this.network.fireInteractionEvent({kind:"lazyResizeEnd",event:a,element:this.node,resizeDirection:this.resizeDirection});else this.node.setLocation(this.resizingRect.x,this.resizingRect.y),this.node.setSize(this.resizingRect.width,this.resizingRect.height),this.network.fireInteractionEvent({kind:"liveResizeEnd",event:a,element:this.node,resizeDirection:this.resizeDirection});else this.shapeNode&&this.pointIndex>=0&&b?(this.shapeNode.setPoint(this.pointIndex,b),this.network.fireInteractionEvent({kind:"liveMovePointEnd",event:a,element:this.shapeNode,pointIndex:this.pointIndex})):this.shapeLink&&this.pointIndex>=0&&b?(this.shapeLink.setPoint(this.pointIndex,b),this.network.fireInteractionEvent({kind:"liveMovePointEnd",event:a,element:this.shapeLink,pointIndex:this.pointIndex})):this.linkUI&&b&&(this.linkUI.setControlPoint(b),this.network.fireInteractionEvent({kind:"liveMovePointEnd",event:a,element:this.linkUI._element}))}this._handle_mouseup(a),this.lazyMode||this.clear()},handle_mousemove:function(a){if(this.network.isValidEvent(a)){if(this.isStartRotate&&this.node)return this._handleRotateElement(a,this.node),void(this.network.isShowRotateScale()&&this.repaint());if(this.isStart){if(this.shapeNode&&this.pointIndex>=0)return void this._handleMovingShapeNodePoint(a);if(this.shapeLink&&this.pointIndex>=0)return void this._handleMovingShapeLinkPoint(a);if(this.node&&this.resizeDirection)return void this._handleResizing(a);if(this.linkUI)return void this._handleMovingLinkControlPoint(a)}if(this.network.isSelectingElement()||this.network.isMovingElement()||0===this.network.getSelectionModel().size())return void this.clear();var b=this.network.getElementAt(a),c=this.network.getElementUI(b);if(!c||!c.getEditAttachment())return void this.clear();var d=this.network.getLogicalPoint(a);if(b instanceof Ib.Node){if(this.node=b,this._isEditingShapeNode(d)||this._isResizingNode(d))return void this.network.setEditingElement(!0);if(this._isRotatingElement(d))return this.network.setRotatingElement(!0),void this.network.setEditingElement(!0)}else if(b instanceof Ib.ShapeLink){if(this.shapeLink=b,this._isEditingShapeLink(d))return void this.network.setEditingElement(!0)}else if(c instanceof Ib.canvas.LinkUI){var e=this.network.getEditPointSize();if(xc.isOrthogonalLink(c._element)){this.linkUI=c;var f=this.linkUI.getControlPoint();return void(f&&this._contains(d,f,e)&&(this._setCrossCursor(),this.network.setEditingElement(!0)))}}this.clear()}},_isRotatingElement:function(a){var b=this.network.getRotatePointSize();if(0>=b)return!1;var c=this.node.getOriginalRect(),d=this.node.getAngle();return this._isRotating(a,"crosshair",c,d)},_isRotating:function(a,b,c,d){var e=this.network.getRotatePointSize(),f={x:c.x+c.width/2,y:c.y-this.network.getRotatePointOffset()-e},g=this._rotatePoint(f,d,c),h={x:g.x-e,y:g.y-e,width:2*e,height:2*e};return Tb.containsPoint(h,a)?(this._removeCursor(),this._setCursor(b),!0):!1},_handleRotateElement:function(a,b){this._handle_mousemove(a);var c=this._calculateAngle(this.network.getLogicalPoint(a),b);b.setAngle(c)},_calculateAngle:function(a,b){var c=b.getCenterLocation();return Math.round(180*Math.atan2(c.x-a.x,a.y-c.y)/Math.PI+180)},_handleMovingShapeNodePoint:function(a){var b=this.network.getLogicalPoint(a);this.shapeNode.setPoint(this.pointIndex,b),this.network.fireInteractionEvent({kind:"liveMovePointBetween",e:a,element:this.shapeNode,pointIndex:this.pointIndex})},_handleMovingShapeLinkPoint:function(a){var b=this.network.getLogicalPoint(a);this.shapeLink.setPoint(this.pointIndex,b),this.network.fireInteractionEvent({kind:"liveMovePointBetween",e:a,element:this.shapeLink,pointIndex:this.pointIndex})},_handleMovingLinkControlPoint:function(a){this.linkUI.setControlPoint(this.network.getLogicalPoint(a)),this.network.fireInteractionEvent({kind:"liveMovePointBetween",e:a,element:this.linkUI._element})},_handleResizing:function(a){this._handle_mousemove(a);var b=this.node.getAngle(),c=this.node.getLocation(),d=this.node.getWidth()/2,e=this.node.getHeight()/2,f={x:c.x+d,y:c.y+e},g={x:-d,y:-e},h={x:-d,y:e},i={x:d,y:e},j={x:d,y:-e},k={x:0,y:-e},l={x:d,y:0},m={x:0,y:e},n={x:-d,y:0};if("northwest"===this.resizeDirection&&(this._transformPoint(i,f,b),g.x=this._endLogical.x,g.y=this._endLogical.y,f.x=(g.x+i.x)/2,f.y=(g.y+i.y)/2,this._reversPoint(g,f,b),this._reversPoint(i,f,b),this.resizingRect={x:g.x,y:g.y,width:i.x-g.x,height:i.y-g.y}),"north"===this.resizeDirection){var o={x:this._endLogical.x,y:this._endLogical.y};this._reversPoint(o,f,b),k.y=o.y-f.y,this._transformPoint(k,f,b),this._transformPoint(m,f,b),f.x=(k.x+m.x)/2,f.y=(k.y+m.y)/2,this._reversPoint(k,f,b),this._reversPoint(m,f,b),this.resizingRect={x:f.x-this.node.getWidth()/2,y:f.y-(m.y-k.y)/2,width:this.node.getWidth(),height:m.y-k.y}}if("northeast"===this.resizeDirection&&(this._transformPoint(h,f,b),j.x=this._endLogical.x,j.y=this._endLogical.y,f.x=(h.x+j.x)/2,f.y=(h.y+j.y)/2,this._reversPoint(h,f,b),this._reversPoint(j,f,b),this.resizingRect={x:h.x,y:j.y,width:j.x-h.x,height:h.y-j.y}),"west"===this.resizeDirection){var o={x:this._endLogical.x,y:this._endLogical.y};this._reversPoint(o,f,b),n.x=o.x-f.x,this._transformPoint(l,f,b),this._transformPoint(n,f,b),f.x=(l.x+n.x)/2,f.y=(l.y+n.y)/2,this._reversPoint(l,f,b),this._reversPoint(n,f,b),this.resizingRect={x:f.x-(l.x-n.x)/2,y:f.y-this.node.getHeight()/2,width:l.x-n.x,height:this.node.getHeight()}}if("east"===this.resizeDirection){var o={x:this._endLogical.x,y:this._endLogical.y};this._reversPoint(o,f,b),l.x=o.x-f.x,this._transformPoint(l,f,b),this._transformPoint(n,f,b),f.x=(l.x+n.x)/2,f.y=(l.y+n.y)/2,this._reversPoint(l,f,b),this._reversPoint(n,f,b),this.resizingRect={x:f.x-(l.x-n.x)/2,y:f.y-this.node.getHeight()/2,width:l.x-n.x,height:this.node.getHeight()}}if("southwest"===this.resizeDirection&&(this._transformPoint(j,f,b),h.x=this._endLogical.x,h.y=this._endLogical.y,f.x=(h.x+j.x)/2,f.y=(h.y+j.y)/2,this._reversPoint(h,f,b),this._reversPoint(j,f,b),this.resizingRect={x:h.x,y:j.y,width:j.x-h.x,height:h.y-j.y}),"south"===this.resizeDirection){var o={x:this._endLogical.x,y:this._endLogical.y};this._reversPoint(o,f,b),m.y=o.y-f.y,this._transformPoint(k,f,b),this._transformPoint(m,f,b),f.x=(k.x+m.x)/2,f.y=(k.y+m.y)/2,this._reversPoint(k,f,b),this._reversPoint(m,f,b),this.resizingRect={x:f.x-this.node.getWidth()/2,y:f.y-(m.y-k.y)/2,width:this.node.getWidth(),height:m.y-k.y}}"southeast"===this.resizeDirection&&(this._transformPoint(g,f,b),i.x=this._endLogical.x,i.y=this._endLogical.y,f.x=(g.x+i.x)/2,f.y=(g.y+i.y)/2,this._reversPoint(g,f,b),this._reversPoint(i,f,b),this.resizingRect={x:g.x,y:g.y,width:i.x-g.x,height:i.y-g.y}),this.lazyMode?(this.repaint(),this.network.fireInteractionEvent({kind:"lazyResizeBetween",event:a,element:this.node,resizeDirection:this.resizeDirection})):(this.node.setLocation(this.resizingRect.x,this.resizingRect.y),this.node.setSize(this.resizingRect.width,this.resizingRect.height),this.network.fireInteractionEvent({kind:"liveResizeBetween",event:a,element:this.node,resizeDirection:this.resizeDirection}))},_isEditingShapeNode:function(a){var b=this.network.getEditPointSize();if(this.node instanceof Ib.ShapeNode){this.shapeNode=this.node;for(var c=this.shapeNode.getPoints(),d=0,e=c.size();e>d;d++){var f=c.get(d);if(this._contains(a,f,b))return this._setCrossCursor(),this.pointIndex=d,!0}}return this.pointIndex=-1,!1},_isEditingShapeLink:function(a){for(var b=this.network.getEditPointSize(),c=this.shapeLink.getPoints(),d=0,e=c.size();e>d;d++){var f=c.get(d);if(this._contains(a,f,b))return this._setCrossCursor(),this.pointIndex=d,!0}return this.pointIndex=-1,!1},_isResizingNode:function(a){var b=this.network.getResizePointSize();if(0>=b)return!1;var c=this.node.getOriginalRect(),d=this.node.getAngle(),e={x:c.x,y:c.y},f=this._rotatePoint(e,d,c);return this._isResizing(a,f.x,f.y,"northwest","nwse-resize")?!0:(e={x:c.x+c.width/2,y:c.y},f=this._rotatePoint(e,d,c),this._isResizing(a,f.x,f.y,"north","ns-resize")?!0:(e={x:c.x+c.width,y:c.y},f=this._rotatePoint(e,d,c),this._isResizing(a,f.x,f.y,"northeast","nesw-resize")?!0:(e={x:c.x,y:c.y+c.height/2},f=this._rotatePoint(e,d,c),this._isResizing(a,f.x,f.y,"west","ew-resize")?!0:(e={x:c.x+c.width,y:c.y+c.height/2},f=this._rotatePoint(e,d,c),this._isResizing(a,f.x,f.y,"east","ew-resize")?!0:(e={x:c.x,y:c.y+c.height},f=this._rotatePoint(e,d,c),this._isResizing(a,f.x,f.y,"southwest","nesw-resize")?!0:(e={x:c.x+c.width/2,y:c.y+c.height},f=this._rotatePoint(e,d,c),this._isResizing(a,f.x,f.y,"south","ns-resize")?!0:(e={x:c.x+c.width,y:c.y+c.height},f=this._rotatePoint(e,d,c),this._isResizing(a,f.x,f.y,"southeast","nwse-resize")?!0:!1)))))))},_rotatePoint:function(a,b,c){var d=Tb.createMatrix(b*Math.PI/180,c.x+c.width/2,c.y+c.height/2),e=d.transform(a);return e},_isResizing:function(a,b,c,d,e){var f=this.network.getResizePointSize();return this._contains(a,{x:b,y:c},f)?(this.resizeDirection!==d&&(this._removeCursor(),e=this._changeCursorWithAngle(d,this.node.getAngle()),this._setCursor(e),this.resizeDirection=d),!0):!1},_getRect:function(a,b,c,d){var e=c>a?a:c,f=d>b?b:d,g=Math.abs(a-c),h=Math.abs(b-d);return{x:e,y:f,width:g,height:h}},_contains:function(a,b,c){var d={x:b.x-c,y:b.y-c,width:2*c,height:2*c};return Tb.containsPoint(d,a)},getPointIndex:function(a,b,c){if(a.size()<2)return 0;for(var d,e=a.get(0),f=1;f<a.size();f++){if(d=a.get(f),this.isPointOnLine(b,e,d,6))return f;e=d}return e=a.get(0),c&&this.isPointOnLine(b,e,d,6)?a.size():0},showRotateScale:function(a){var b,c,d,e,f,g=(new Ib.List,this.network.getRotateScaleWidth()),h=this.network.getRotateScaleHeight(),i=this.network.getRotatePointSize(),j=this.node.getAngle(),k=this.node.getOriginalRect(),l={x:k.x+k.width/2,y:k.y-this.network.getRotatePointOffset()-i},m=this._rotatePoint(l,j,k),n="13px Arial",o=j+"°";this.node.getAngle()>=0&&this.node.getAngle()<=180?(c={x:m.x+i,y:m.y},d={x:c.x+g,y:c.y},e={x:d.x,y:d.y-h},f={x:c.x,y:e.y}):this.node.getAngle()>180&&this.node.getAngle()<=360&&(c={x:m.x-i,y:m.y},d={x:c.x-g,y:c.y},e={x:d.x,y:d.y-h},f={x:c.x,y:e.y});var p=new Ib.List([c,d,e,f]),b=Jb.math.getRect(p);a.fillStyle=this.network.getRotateScaleFillColor(),a.fillRect(b.x,b.y,b.width,b.height),a.fillStyle=this.network.getRotateScaleFontColor(),a.textBaseline="middle",a.textAlign="center",a.font=n,a.fillText(o,b.x+b.width/2,b.y+b.height/2)},isPointOnLine:function(a,b,c,d){0>d&&(d=0);var e=this.getDistanceFromPointToLine(a,b,c);return d>=e&&a.x>=Math.min(b.x,c.x)-d&&a.x<=Math.max(b.x,c.x)+d&&a.y>=Math.min(b.y,c.y)-d&&a.y<=Math.max(b.y,c.y)+d},getDistanceFromPointToLine:function(a,b,c){if(b.x===c.x)return Math.abs(a.x-b.x);var d=(c.y-b.y)/(c.x-b.x),e=(c.x*b.y-b.x*c.y)/(c.x-b.x);return Math.abs(d*a.x-a.y+e)/Math.sqrt(d*d+1)},_transformPoint:function(a,b,c){var d=Math.cos(c*Math.PI/180),e=Math.sin(c*Math.PI/180),f=a.x,g=a.y,h=f*d-g*e,i=f*e+g*d;a.x=h+b.x,a.y=i+b.y},_reversPoint:function(a,b,c){c*=-1;var d=Math.cos(c*Math.PI/180),e=Math.sin(c*Math.PI/180),f=a.x-b.x,g=a.y-b.y,h=f*d-g*e,i=f*e+g*d;a.x=h+b.x,a.y=i+b.y},_changeCursorWithAngle:function(a,b){var c,d=["auto","nwse-resize","ns-resize","nesw-resize","ew-resize","nwse-resize","ns-resize","nesw-resize","ew-resize"];switch(a){case"northwest":c=1;break;case"north":c=2;break;case"northeast":c=3;break;case"east":c=4;break;case"southeast":c=5;break;case"south":c=6;break;case"southwest":c=7;break;case"west":c=8;break;default:c=0}return(b>=360||-360>=b)&&(b%=360),b>22.5&&67.5>=b&&(c+=1),-22.5>b&&b>=-67.5&&(c-=1),b>67.5&&112.5>=b&&(c+=2),-67.5>b&&b>=-112.5&&(c-=2),b>112.5&&157.5>=b&&(c+=3),-112.5>b&&b>=-157.5&&(c-=3),b>157.5&&202.5>=b&&(c+=4),-157.5>b&&b>=-202.5&&(c-=4),b>202.5&&247.5>=b&&(c+=5),-202.5>b&&b>=-247.5&&(c-=5),b>247.5&&292.5>=b&&(c+=6),-247.5>b&&b>=-292.5&&(c-=6),b>292.5&&337.5>=b&&(c+=7),-292.5>b&&b>=-337.5&&(c-=7),c>8&&(c-=8),0>=c&&(c+=8),d[c]}}),Ib.canvas.interaction.CreateLinkInteraction=function(a,b){b||(b=Ib.Link),this.linkFunction=Ib.Util.isTypeOf(b,Ib.Link)?function(a,c){var d=new b;return d instanceof Ib.Link&&(d.setFromNode(a),d.setToNode(c)),d}:b,Ib.canvas.interaction.CreateLinkInteraction.superClass.constructor.call(this,a)},Jb.ext("twaver.canvas.interaction.CreateLinkInteraction",Ib.canvas.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown","mousemove"),this.network.addMarker(this)},tearDown:function(){this.removeListener("mousedown","mousemove"),this.clear(),this.network.removeMarker(this)},paint:function(a){a.beginPath();var b,c;a.lineWidth=this.network.getEditLineWidth();var d=this.network.getEditLineColor();this.currentNode&&this.currentNode!==this.fromNode&&(b=this.network.getElementUI(this.currentNode).getViewRect(),c=this.convertFromUIToMarkerRect(b,0,0),Od.rect(a,c.x,c.y,c.width,c.height,null,d)),this.fromNode&&(b=this.network.getElementUI(this.fromNode).getViewRect(),c=this.convertFromUIToMarkerRect(b,0,0),Od.rect(a,c.x,c.y,c.width,c.height,null,d)),this.currentPoint&&this.paintLine(a),a.closePath()},paintLine:function(a){var b=this.network.getEditLineColor(),c=this.convertPointFromView(this.fromNode.getCenterLocation()),d=c.x,e=c.y,f=this.currentPoint.x,g=this.currentPoint.y;a.strokeStyle=b,a.beginPath(),a.moveTo(d,e),a.lineTo(f,g),a.stroke()},clear:function(){this.currentPoint=null,this.currentNode=null,this.fromNode=null,this.toNode=null},createLink:function(){return this.linkFunction(this.fromNode,this.toNode)},handle_mousedown:function(a){if(this.network.isValidEvent(a))if(this.fromNode){if(this.toNode=this.currentNode,this.toNode){var b=this.createLink();b&&this.network.addElementByInteraction(b)}this.clear()}else this.fromNode=this.currentNode,this.currentNode=null,this.currentPoint=null,this.repaint()},handle_mousemove:function(a){var b=this.getMarkerPoint(a);if(b){if(this.network.isMovingElement()||this.network.isEditingElement())return void this.clear();var c=null;this.fromNode?(this.currentNode=this.getToNode(a),this.currentPoint=b,this.repaint()):(c=this.getFromNode(a),this.currentNode!==c&&(this.currentNode=c,this.repaint()))}},getFromNode:function(a){return this.getNode(a)},getToNode:function(a){return this.getNode(a)},getNode:function(a){var b=this.network.getElementAt(a);return b instanceof Ld&&this.network.isLinkable(b)&&this.network.getElementBox().getSelectionModel().isSelectable(b)?b:null}}),Ib.canvas.interaction.CreateShapeLinkInteraction=function(a,b){Ib.canvas.interaction.CreateShapeLinkInteraction.superClass.constructor.call(this,a),b||(b=Ib.ShapeLink),this.linkFunction=Ib.Util.isTypeOf(b,Ib.ShapeLink)?function(a,c,d){var e=new b;return e instanceof Ib.ShapeLink&&(e.setFromNode(a),e.setToNode(c),d&&e.setPoints(d)),e}:b},Jb.ext("twaver.canvas.interaction.CreateShapeLinkInteraction",Ib.canvas.interaction.CreateLinkInteraction,{clear:function(){this.points=null,Ib.canvas.interaction.CreateShapeLinkInteraction.superClass.clear.call(this)},createLink:function(){return this.linkFunction(this.fromNode,this.toNode,this.points)},handle_mousedown:function(a){if(0===a.button){var b=this.network.getLogicalPoint(a);if(b){if(this.fromNode)if(this.toNode=this.currentNode,this.toNode){var c=this.createLink();c&&this.network.addElementByInteraction(c),this.clear()}else{if(this.points||(this.points=new Ib.List),this.points.size()>0){var d=this.points.get(this.points.size()-1);if(d.x===b.x&&d.y===b.y)return}this.points.add(b)}else this.fromNode=this.currentNode,this.points=null,this.currentNode=null,this.currentPoint=null;this.repaint()}}},paintLine:function(a){if(this.currentPoint){var b,c=new Ib.List;if(b=this.convertPointFromView(this.fromNode.getCenterLocation()),c.add(b,0),this.points&&this.points.size()>0)for(var d=this.points.size(),e=0;d>e;e++)b=this.convertPointFromView(this.points.get(e)),c.add(b);b=this.currentPoint,c.add(b),a.lineWidth=this.network.getEditLineWidth(),a.strokeStyle=this.network.getEditLineColor(),a.beginPath(),Xb.drawLinePoints(a,c),a.stroke()}}}),Ib.canvas.interaction.CreateShapeNodeInteraction=function(a,b){b||(b=Ib.ShapeNode),this.shapeNodeFunction=Ib.Util.isTypeOf(b,Ib.ShapeNode)?function(a){var c=new b;return c instanceof Ib.ShapeNode&&a&&c.setPoints(a),c}:b,Ib.canvas.interaction.CreateShapeNodeInteraction.superClass.constructor.call(this,a),this.timeStamp=-1},Jb.ext("twaver.canvas.interaction.CreateShapeNodeInteraction",Ib.canvas.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown","mousemove"),this.network.addMarker(this)},tearDown:function(){this.removeListener("mousedown","mousemove"),this.clear(),this.network.removeMarker(this),this.network.setEditingElement(!1)},clear:function(){this.points=null,this.currentPoint=null},paint:function(a){if(this.points&&this.points.size()>0&&this.currentPoint){for(var b,c=new Ib.List,d=this.points.size(),e=0;d>e;e++)b=this.convertPointFromView(this.points.get(e)),c.add(b);b=this.convertPointFromView(this.currentPoint),c.add(b),a.lineWidth=this.network.getEditLineWidth(),a.strokeStyle=this.network.getEditLineColor(),a.beginPath(),Xb.drawLinePoints(a,c),a.stroke()}},handle_mousedown:function(a){if(0===a.button){var b=this.network.getLogicalPoint(a);if(b){if(2===a.detail||a.timeStamp-this.timeStamp<300){if(this.points){var c=this.shapeNodeFunction(this.points);this.network.addElementByInteraction(c),this.clear();var d=this;setTimeout(function(){d.network.setEditingElement(!1)},0)}}else{if(this.network.isEditingElement()||this.network.setEditingElement(!0),this.points||(this.points=new Ib.List),this.points.size()>0){var e=this.points.get(this.points.size()-1);if(e.x===b.x&&e.y===b.y)return}this.points.add(b)}this.timeStamp=a.timeStamp,this.repaint()}}},handle_mousemove:function(a){this.points&&(this.currentPoint=this.network.getLogicalPoint(a),this.repaint())}}),Ib.canvas.interaction.MagnifyInteraction=function(a,b,c,d,e){Ib.canvas.interaction.MagnifyInteraction.superClass.constructor.call(this,a),this.zoom=b||2,this.xRadius=c||100,this.yRadius=d||100,this.shape=e||"circle",this.borderColor="black",this.borderWidth=1,this.backgroundColor="white",this.markCanvas=Wb.createCanvas()},Jb.ext("twaver.canvas.interaction.MagnifyInteraction",Ib.canvas.interaction.BaseInteraction,{setUp:function(){this.addListener("mousemove"),this.network.addMarker(this)},tearDown:function(){this.removeListener("mousemove"),this.network.removeMarker(this)},paint:function(a){if(this.point){var b=this.network._zoom,c=this.zoom*b,d=this.point.x*b-this.network.viewRect.x-this.xRadius,e=this.point.y*b-this.network.viewRect.y-this.yRadius,f=2*this.xRadius,g=2*this.yRadius,h={x:this.point.x-this.xRadius/c,y:this.point.y-this.yRadius/c,width:f/c,height:g/c},i=this.borderWidth,j=Wb.createCanvas();j.width=f,j.height=g,this.network.toCanvasByRegion(h,c,j),a.save(),a.beginPath(),Xb.drawVector(a,this.shape,null,d,e,f,g),a.clip(),a.fillStyle=this.backgroundColor,a.beginPath(),a.rect(d,e,f,g),a.fill(),a.drawImage(j,d,e),a.restore(),a.beginPath(),a.lineWidth=i,Xb.drawVector(a,this.shape,null,d+i/2,e+i/2,f-i,g-i),a.strokeStyle=this.borderColor,a.stroke()}},handle_mousemove:function(a){this.point=this.network.getLogicalPoint(a),this.point&&this.repaint()},getZoom:function(){return this.zoom},setZoom:function(a){this.zoom=a,this.network.repaintTopCanvas()},getShape:function(){return this.shape},setShape:function(a){this.shape=a,this.network.repaintTopCanvas()},getXRadius:function(){return this.xRadius},setXRadius:function(a){this.xRadius=a,this.network.repaintTopCanvas()},getYRadius:function(){return this.yRadius},setYRadius:function(a){this.yRadius=a,this.network.repaintTopCanvas()},getBorderColor:function(){return this.borderColor},setBorderColor:function(a){this.borderColor=a,this.network.repaintTopCanvas()},getBorderWidth:function(){return this.borderWidth},setBorderWidth:function(a){this.borderWidth=a,this.network.repaintTopCanvas()},getBackgroundColor:function(){return this.backgroundColor},setBackgroundColor:function(a){this.backgroundColor=a,this.network.repaintTopCanvas()}}),Ib.canvas.interaction.TouchInteraction=function(a){Ib.canvas.interaction.TouchInteraction.superClass.constructor.call(this,a)},Jb.ext("twaver.canvas.interaction.TouchInteraction",Ib.canvas.interaction.BaseInteraction,{setUp:function(){var a=this.network.getView();Wb.addEventListener("touchstart","handleTouchstart",a,this),Wb.addEventListener("touchmove","handleTouchmove",a,this),
Wb.addEventListener("touchend","handleTouchend",a,this),Wb.addEventListener("touchcancel","handleTouchend",a,this),this.network.addMarker(this)},tearDown:function(){var a=this.network.getView();Wb.removeEventListener("touchstart",this.network.getView(),this),Wb.removeEventListener("touchmove",a,this),Wb.removeEventListener("touchend",a,this),Wb.removeEventListener("touchcancel",a,this),this.network.removeMarker(this)},handleTouchstart:function(a){if(Wb.preventDefault(a),a.touches&&1==a.touches.length){var b=this.network.getLogicalPoint(a),c=this.network.getElementAt(b);this._startTouchTime=new Date,this._startTouchPoint=b,this._startTouchClient=this.getMarkerPoint(a),c?(this._haveElementUnderTouch=!0,this._startTouchElement=c):(this._haveElementUnderTouch=!1,this._startTouchElement=null),this.timer=setTimeout(function(){Cc.handleLongClicked(self.network,a,c)},1e3)}else a.touches&&2==a.touches.length&&(this._distance=zc.getDistance(a),this._zoom=this.network.getZoom());this._touchCount=a.touches.length},handleTouchmove:function(a){if(Wb.preventDefault(a),2==this._touchCount&&a.touches&&2==a.touches.length)if(this.timer&&clearTimeout(this.timer),Math.abs(this._distance-zc.getDistance(a))>=Ed.TOUCH_ZOOM_THRESHOLD||this._zoomFlag){this._zoomFlag=!0;var b=zc.getDistance(a)/this._distance;this.network.setTouchZoom(this._zoom*b,!1)}else{var c=this.getMarkerPoint(a),d=this._startTouchClient.x-c.x,e=this._startTouchClient.y-c.y;this.network.panByOffset(d,e),this._startTouchClient=c}else if(1==this._touchCount&&a.touches&&1==a.touches.length)if(this._haveElementUnderTouch||!this.network.isRectSelectEnabled()){var f=this.network.getLogicalPoint(a),g=this.network.getElementAt(f);if(this.network.isMovingElement()||null!=this._startTouchElement&&this._startTouchElement==g&&this.network.getMovableSelectedElements().contains(g)){var d=f.x-this._startTouchPoint.x,e=f.y-this._startTouchPoint.y;(Math.abs(d)>=Ed.TOUCH_MOVE_THRESHOLD||Math.abs(e)>=Ed.TOUCH_MOVE_THRESHOLD)&&(this._startTouchPoint=f,this.network.moveSelectedElements(d,e),this.network.isMovingElement()?this.network.fireInteractionEvent({kind:"liveMoveBetween",event:a}):(this.network.setMovingElement(!0),this.network.fireInteractionEvent({kind:"liveMoveStart",event:a}),this.timer&&clearTimeout(this.timer)))}else{var d=f.x-this._startTouchPoint.x,e=f.y-this._startTouchPoint.y;(Math.abs(d)>=Ed.TOUCH_MOVE_THRESHOLD||Math.abs(e)>=Ed.TOUCH_MOVE_THRESHOLD)&&this.timer&&clearTimeout(this.timer);var c=this.getMarkerPoint(a),d=this._startTouchClient.x-c.x,e=this._startTouchClient.y-c.y;this.network.panByOffset(d,e),this._startTouchClient=c}}else{var h=this.network.getLogicalPoint(a);if(!h)return;var d=h.x-this._startTouchPoint.x,e=h.y-this._startTouchPoint.y;Math.abs(d)>=Ed.TOUCH_RECT_SELECT_THRESHOLD&&Math.abs(e)>=Ed.TOUCH_RECT_SELECT_THRESHOLD&&(this.network.setSelectingElement(!0),this._moveTouchPoint?this.network.fireInteractionEvent({kind:"selectBetween",event:a}):(this.network.fireInteractionEvent({kind:"selectStart",event:a}),this.timer&&clearTimeout(this.timer)),this._moveTouchPoint=h,this.repaint())}},handleTouchend:function(a){if(Wb.preventDefault(a),this.network.isMovingElement())this.network.setMovingElement(!1),this.network.fireInteractionEvent({kind:"liveMoveEnd",event:a});else if(this.network.isSelectingElement()){var b=Tb.getRect([this._startTouchPoint,this._moveTouchPoint]),c=this.network.getElementsAtRect(b,this.getIntersectMode(),this.network.getRectSelectFilter());if(c&&c.size()>0){var d=this.network.getSelectionModel(),e=d.toSelection();c.forEach(function(a){d.contains(a)?e.remove(a):e.add(a)},this),d.setSelection(e)}this.network.fireInteractionEvent({kind:"selectEnd",event:a}),this._moveTouchPoint=null,this.network.setSelectingElement(!1),this.repaint()}else if(this._startTouchPoint){this._zoomFlag=!1;var f=new Date,g=this.network.getLogicalPoint(a),h=this.network.getElementAt(this._startTouchPoint);g&&f.getTime()-this._startTouchTime.getTime()<=500&&Tb.getDistance(this._startTouchPoint,g)<=20&&(h?this.network.getSelectionModel().contains(h)||this.network.getSelectionModel().setSelection(h):this.network.getSelectionModel().clearSelection(),Cc.handleClicked(this.network,a,h),this.timer&&clearTimeout(this.timer),this._endTouchTime&&f.getTime()-this._endTouchTime.getTime()<=500&&Tb.getDistance(this._endTouchPoint,g)<=20?(delete this._endTouchTime,delete this._endTouchPoint,Cc.handleDoubleClicked(this.network,a,h)):(this._endTouchTime=f,this._endTouchPoint=g))}},paint:function(a){if(this._startTouchPoint&&this._moveTouchPoint){var b=this.convertPointFromView(this._startTouchPoint),c=this.convertPointFromView(this._moveTouchPoint),d=b.x,e=b.y,f=c.x,g=c.y,h=Tb.getRect([{x:d,y:e},{x:f,y:g}]);if(null!=h){a.beginPath();var i=this.network.getSelectOutlineWidth(),j=this.getIntersectMode()?this.network.getSelectFillColor():null;a.strokeStyle=this.network.getSelectOutlineColor(),a.lineWidth=i,Od.rect(a,h.x,h.y,h.width,h.height,j,this.network.getSelectOutlineColor()),a.closePath()}}},getIntersectMode:function(){return"intersect"===this.network.getSelectMode()?!0:"contain"===this.network.getSelectMode()?!1:this._startTouchPoint.x>this._moveTouchPoint.x&&this._startTouchPoint.y>this._moveTouchPoint.y}}),Ib.canvas.interaction.MSTouchInteraction=function(a){Ib.canvas.interaction.MSTouchInteraction.superClass.constructor.call(this,a),this._pointerMap={},this._pointerIdArray=[]},Jb.ext("twaver.canvas.interaction.MSTouchInteraction",Ib.canvas.interaction.BaseInteraction,{setUp:function(){var a=this.network.getView();Wb.addEventListener("MSPointerDown","handleTouchstart",a,this),Wb.addEventListener("MSPointerMove","handleTouchmove",a,this),Wb.addEventListener("MSPointerUp","handleTouchend",a,this),Wb.addEventListener("MSPointerCancel","handleTouchend",a,this),this.network.addMarker(this)},tearDown:function(){var a=this.network.getView();Wb.removeEventListener("MSPointerDown",a,this),Wb.removeEventListener("MSPointerMove",a,this),Wb.removeEventListener("MSPointerUp",a,this),Wb.removeEventListener("MSPointerCancel",a,this),this.network.removeMarker(this)},handleTouchstart:function(a){if(this.network.isFocusOnClick()&&Ib.Util.setFocus(this.network._view),!this.network.isSelectingElement()||a.pointerType!=a.MSPOINTER_TYPE_MOUSE){var b=this.network.getLogicalPoint(a),c=new Date;if(a.isPrimary&&this._pointerIdArray.length>0&&this.handle_mouseup(a),this._pointerMap[a.pointerId]||(this._pointerIdArray.push(a.pointerId),this._pointerMap[a.pointerId]=a),1==this._pointerIdArray.length){var d=this.network.getElementAt(b);this._startTouchElement=d,this._startClientPoint={x:a.clientX,y:a.clientY},Cc.handleClicked(this.network,a,d),this._startTouchTime&&this._startTouchPoint&&c.getTime()-this._startTouchTime.getTime()<=500&&Tb.getDistance(this._startTouchPoint,b)<=20?(Cc.handleDoubleClicked(this.network,a,d),this._doubleClick=!0):(Wb.handle_mousedown(this,a),this._startTouchPoint=b,this._startTouchTime=c);var e=this.network.getSelectionModel();d?Jb.isCtrlDown(a)?e.contains(d)?e.removeSelection(d):e.appendSelection(d):e.contains(d)||e.setSelection(d):Jb.isCtrlDown(a)||e.clearSelection()}else 2==this._pointerIdArray.length&&(this._distance=this._getDistance(),this._zoom=this.network.getZoom())}},handleTouchmove:function(a){if(null!=this._startTouchPoint&&0!=this._pointerIdArray.length&&this._pointerMap[a.pointerId]&&!(Tb.getDistance({x:this._pointerMap[a.pointerId].pageX,y:this._pointerMap[a.pointerId].pageY},{x:a.pageX,y:a.pageY})<=10)&&(this._pointerMap[a.pointerId]=a,2==this._pointerIdArray.length)){var b=this._getDistance()/this._distance;this.network.setZoom(this._zoom*b,!1)}},handleTouchend:function(a){if(this.network.isMovingElement()&&(this.network.setMovingElement(!1),this.network.fireInteractionEvent({kind:"liveMoveEnd",event:a})),this.network.isSelectingElement()){var b=Tb.getRect([this._startTouchPoint,this._moveTouchPoint]),c=this.network.getElementsAtRect(b,this.getIntersectMode(),this.network.getRectSelectFilter());if(c&&c.size()>0){var d=this.network.getSelectionModel(),e=d.toSelection();c.forEach(function(a){d.contains(a)?e.remove(a):e.add(a)},this),d.setSelection(e)}this.network.fireInteractionEvent({kind:"selectEnd",event:a}),this._moveTouchPoint=null,this.network.setSelectingElement(!1),this.repaint()}this._doubleClick&&(delete this._doubleClick,delete this._startTouchPoint,delete this._startTouchTime);for(var f=-1,g=0;g<this._pointerIdArray.length;g++)if(this._pointerIdArray[g]==a.pointerId){f=g;break}f>=0&&this._pointerIdArray.splice(f,1),delete this._pointerMap[a.pointerId],this._startTouchPoint=null,this._moveTouchPoint=null},_getDistance:function(){return Tb.getDistance({x:this._pointerMap[this._pointerIdArray[0]].pageX,y:this._pointerMap[this._pointerIdArray[0]].pageY},{x:this._pointerMap[this._pointerIdArray[1]].pageX,y:this._pointerMap[this._pointerIdArray[1]].pageY})},getIntersectMode:function(){return"intersect"===this.network.getSelectMode()?!0:"contain"===this.network.getSelectMode()?!1:this._startTouchPoint.x>this._moveTouchPoint.x&&this._startTouchPoint.y>this._moveTouchPoint.y},handle_mousemove:function(a){var b={x:a.clientX,y:a.clientY};if(!(Tb.getDistance(this._startClientPoint,b)<3)&&this._startTouchPoint&&1==this._pointerIdArray.length)if(this._moveTouchPoint={x:this._startTouchPoint.x+(b.x-this._startClientPoint.x)/this.network.getZoom(),y:this._startTouchPoint.y+(b.y-this._startClientPoint.y)/this.network.getZoom()},null==this._startTouchElement&&this.network.isRectSelectEnabled()){var c=this.network.getLogicalPoint(a);if(!c)return;this.network.setSelectingElement(!0),this.network.fireInteractionEvent(this._moveTouchPoint?{kind:"selectBetween",event:a}:{kind:"selectStart",event:a}),this.repaint()}else{var d=this.network.getElementAt(this._moveTouchPoint);if(null!=this._startTouchElement||this.network.isRectSelectEnabled()){if(this.network.isMovingElement()||null!=this._startTouchElement&&d==this._startTouchElement&&this.network.getMovableSelectedElements().contains(d)){var e=this._moveTouchPoint.x-this._startTouchPoint.x,f=this._moveTouchPoint.y-this._startTouchPoint.y;this.network.moveSelectedElements(e,f),this.network.isMovingElement()?this.network.fireInteractionEvent({kind:"liveMoveBetween",event:a}):(this.network.setMovingElement(!0),this.network.fireInteractionEvent({kind:"liveMoveStart",event:a}))}}else{var e=this._startClientPoint.x-b.x,f=this._startClientPoint.y-b.y;this.network.panByOffset(e,f)}this._startClientPoint=b}},handle_mouseup:function(a){this.handleTouchend(a),this._pointerIdArray=[],this._pointerMap={}},paint:function(a){if(this._startTouchPoint&&this._moveTouchPoint&&!this._startTouchElement&&this.network.isRectSelectEnabled()){var b=this.convertPointFromView(this._startTouchPoint),c=this.convertPointFromView(this._moveTouchPoint),d=b.x,e=b.y,f=c.x,g=c.y,h=Tb.getRect([{x:d,y:e},{x:f,y:g}]);if(null!=h){a.beginPath();var i=this.network.getSelectOutlineWidth(),j=this.getIntersectMode()?this.network.getSelectFillColor():null;a.strokeStyle=this.network.getSelectOutlineColor(),a.lineWidth=i,Od.rect(a,h.x,h.y,h.width,h.height,j,this.network.getSelectOutlineColor()),a.closePath()}}}});var Pd=function(a,b){Jb.registerImage(a,b),Qd[a]=1},Qd={};Pd("node_image",{w:32,h:24,origin:{x:0,y:0},v:[{shape:"path",data:"M32,23.5c0,0.276-0.224,0.5-0.5,0.5h-31C0.224,24,0,23.776,0,23.5v-2C0,21.224,0.224,21,0.5,21h31  c0.276,0,0.5,0.224,0.5,0.5V23.5z",gradient:{id:"SVGID_1_",type:"linear",x1:"15.9995",y1:"21",x2:"15.9995",y2:"24",stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"path",data:"M15,22.3c0-0.165-0.134-0.3-0.3-0.3H3.3C3.134,22,3,22.135,3,22.3V24h12V22.3z",gradient:{id:"SVGID_2_",type:"linear",x1:"9",y1:"22",x2:"9",y2:"25",stop:[{offset:"0",color:"#69B4A5"},{offset:"0.1",color:"#61AD9C"}]}},{shape:"path",data:"M31,20H1V1c0-0.553,0.448-1,1-1h28c0.553,0,1,0.447,1,1V20z",gradient:{id:"SVGID_3_",type:"linear",x1:"15.9995",y1:"-0.1221",x2:"15.9995",y2:"19.9471",stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:2,y:1,w:28,h:18,fill:"#FFFFFF"},{shape:"rect",x:3,y:2,w:26,h:16,gradient:{id:"SVGID_4_",type:"linear",x1:"15.9995",y1:"2.0654",x2:"15.9995",y2:"17.3835",stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#0089C1"}]}},{shape:"path",data:"9.649,17.034 6.815,17.034 9.935,2.966 12.768,2.966 z",fill:"#FFFFFF"},{shape:"path",data:"12.065,17.034 10.815,17.034 13.935,2.966 15.185,2.966 z",fill:"#FFFFFF"},{shape:"path",data:"14.065,17.034 13.315,17.034 16.435,2.966 17.185,2.966 z",fill:"#FFFFFF"}]}),Pd("group_image",{w:32,h:24,origin:{x:0,y:0},v:[{shape:"path",data:"M32,16.5c0,0.276-0.224,0.5-0.5,0.5h-24C7.224,17,7,16.776,7,16.5v-1C7,15.224,7.224,15,7.5,15h24   c0.276,0,0.5,0.224,0.5,0.5V16.5z",gradient:{id:"SVGID_1_",type:"linear",x1:"19.5",y1:"15",x2:"19.5",y2:"17",stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"path",data:"M19,16.5c0-0.277-0.224-0.5-0.5-0.5h-8c-0.276,0-0.5,0.223-0.5,0.5V17h9V16.5z",gradient:{id:"SVGID_2_",type:"linear",x1:"14.4995",y1:"15.9209",x2:"14.4995",y2:"17.0459",stop:[{offset:"0",color:"#58AC9A"},{offset:"1",color:"#248576"}]}},{shape:"path",data:"M31,14H8V1c0-0.553,0.448-1,1-1h21c0.553,0,1,0.447,1,1V14z",gradient:{id:"SVGID_3_",type:"linear",x1:"19.5",y1:"0",x2:"19.5",y2:"14.0005",stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:9,y:1,w:21,h:12,fill:"#FFFFFF"},{shape:"rect",x:10,y:2,w:19,h:10,gradient:{id:"SVGID_4_",type:"linear",x1:"19.5",y1:"1.9619",x2:"19.5",y2:"11.9744",stop:[{offset:"0",color:"#58AC9A"},{offset:"1",color:"#248576"}]}},{shape:"path",data:"M25,23.5c0,0.276-0.224,0.5-0.5,0.5h-24C0.224,24,0,23.776,0,23.5v-1C0,22.224,0.224,22,0.5,22h24   c0.276,0,0.5,0.224,0.5,0.5V23.5z",gradient:{id:"SVGID_5_",type:"linear",x1:"12.4995",y1:"22",x2:"12.4995",y2:"24",stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"path",data:"M12,23.5c0-0.277-0.224-0.5-0.5-0.5h-8C3.224,23,3,23.223,3,23.5V24h9V23.5z",gradient:{id:"SVGID_6_",type:"linear",x1:"7.5",y1:"22.9209",x2:"7.5",y2:"24.0459",stop:[{offset:"0",color:"#58AC9A"},{offset:"1",color:"#248576"}]}},{shape:"path",data:"M24,21H1V8c0-0.553,0.448-1,1-1h21c0.553,0,1,0.447,1,1V21z",gradient:{id:"SVGID_7_",type:"linear",x1:"12.4995",y1:"7",x2:"12.4995",y2:"21.0005",stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:2,y:8,w:21,h:12,fill:"#FFFFFF"},{shape:"rect",x:3,y:9,w:19,h:10,gradient:{id:"SVGID_8_",type:"linear",x1:"12.4995",y1:"8.9619",x2:"12.4995",y2:"18.9749",stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#0089C1"}]}}]}),Pd("subnetwork_image",{w:32,h:24,origin:{x:0,y:0},v:[{shape:"path",data:"M32,14.499c0,0.276-0.224,0.5-0.5,0.5h-20c-0.276,0-0.5-0.224-0.5-0.5v-1c0-0.276,0.224-0.5,0.5-0.5  h20c0.276,0,0.5,0.224,0.5,0.5V14.499z",gradient:{id:"SVGID_1_",type:"linear",x1:21.5,y1:12.999,x2:21.5,y2:14.9995,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"path",data:"M22,14.499c0-0.277-0.224-0.5-0.5-0.5h-7c-0.276,0-0.5,0.223-0.5,0.5v0.5h8V14.499z",gradient:{id:"SVGID_2_",type:"linear",x1:18,y1:13.9199,x2:18,y2:15.0449,stop:[{offset:"0",color:"#58AC9A"},{offset:"1",color:"#248576"}]}},{shape:"path",data:"M31,11.499c0,0.276-0.224,0.5-0.5,0.5h-18c-0.276,0-0.5-0.224-0.5-0.5v-11c0-0.276,0.224-0.5,0.5-0.5  h18c0.276,0,0.5,0.224,0.5,0.5V11.499z",gradient:{id:"SVGID_3_",type:"linear",x1:21.5,y1:-.9502,x2:21.5,y2:12.5498,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:13,y:.999,w:17,h:10,fill:"#FFFFFF"},{shape:"rect",x:14,y:1.999,w:15,h:8,gradient:{id:"SVGID_4_",type:"linear",x1:21.5,y1:1.9312,x2:21.5,y2:9.6537,stop:[{offset:"0",color:"#58AC9A"},{offset:"1",color:"#248576"}]}},{shape:"path",data:"M21,23.5c0,0.276-0.224,0.5-0.5,0.5h-20C0.224,24,0,23.776,0,23.5v-1C0,22.224,0.224,22,0.5,22h20  c0.276,0,0.5,0.224,0.5,0.5V23.5z",gradient:{id:"SVGID_5_",type:"linear",x1:10.4995,y1:22,x2:10.4995,y2:24,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:22,y:20.5,w:3,h:1.999,gradient:{id:"SVGID_6_",type:"linear",x1:-464.9424,y1:-722.2754,x2:-462.9424,y2:-722.2754,stop:[{offset:"0",color:"#58AC9A"},{offset:"1",color:"#248576"}]}},{shape:"rect",x:28,y:16,w:2,h:3,gradient:{id:"SVGID_7_",type:"linear",x1:29,y1:16,x2:29,y2:19,stop:[{offset:"0",color:"#58AC9A"},{offset:"1",color:"#248576"}]}},{shape:"path",data:"M11,23.5c0-0.277-0.224-0.5-0.5-0.5h-7C3.224,23,3,23.223,3,23.5V24h8V23.5z",gradient:{id:"SVGID_8_",type:"linear",x1:7,y1:22.9209,x2:7,y2:24.0459,stop:[{offset:"0",color:"#58AC9A"},{offset:"1",color:"#248576"}]}},{shape:"path",data:"M20,20.5c0,0.276-0.224,0.5-0.5,0.5h-18C1.224,21,1,20.776,1,20.5v-11C1,9.224,1.224,9,1.5,9h18  C19.776,9,20,9.224,20,9.5V20.5z",gradient:{id:"SVGID_9_",type:"linear",x1:10.4995,y1:8.0508,x2:10.4995,y2:21.5513,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:2,y:10,w:17,h:10,fill:"#FFFFFF"},{shape:"rect",x:3,y:11,w:15,h:8,gradient:{id:"SVGID_10_",type:"linear",x1:10.4995,y1:10.9321,x2:10.4995,y2:18.6551,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#0089C1"}]}},{shape:"path",data:"M32,22.7c0,0.165-0.135,0.3-0.301,0.3h-5.4C26.134,23,26,22.865,26,22.7v-2.4  c0-0.165,0.134-0.3,0.299-0.3h5.4C31.865,20,32,20.135,32,20.3V22.7z",gradient:{id:"SVGID_11_",type:"linear",x1:29,y1:20,x2:29,y2:23,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}}]}),Pd("bus_icon",{w:16,h:16,origin:{x:0,y:0},v:[{shape:"rect",x:4,y:6,w:1,h:1,fill:"#232424"},{shape:"path",data:"M7,4c0,0.552-0.448,1-1,1H3C2.448,5,2,4.552,2,4V3c0-0.552,0.448-1,1-1h3c0.552,0,1,0.448,1,1V4z",gradient:{id:"SVGID_1_",type:"linear",x1:4.5,y1:2,x2:4.5,y2:5,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:3,y:3,w:3,h:1,fill:"#232424"},{shape:"rect",x:3,y:3,w:3,h:1,fill:"#FFFFFF"},{shape:"path",data:"M6,5.5C6,5.776,5.776,6,5.5,6h-2C3.224,6,3,5.776,3,5.5l0,0C3,5.224,3.224,5,3.5,5h2  C5.776,5,6,5.224,6,5.5L6,5.5z",gradient:{id:"SVGID_2_",type:"linear",x1:4.5,y1:6,x2:4.5,y2:5,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"rect",x:12,y:6,w:1,h:1,fill:"#232424"},{shape:"path",data:"M15,4c0,0.552-0.447,1-1,1h-3c-0.553,0-1-0.448-1-1V3c0-0.552,0.447-1,1-1h3c0.553,0,1,0.448,1,1V4z",gradient:{id:"SVGID_3_",type:"linear",x1:12.5,y1:2,x2:12.5,y2:5,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:11,y:3,w:3,h:1,fill:"#232424"},{shape:"rect",x:11,y:3,w:3,h:1,fill:"#FFFFFF"},{shape:"path",data:"M14,5.5C14,5.776,13.777,6,13.5,6h-2C11.225,6,11,5.776,11,5.5l0,0C11,5.224,11.225,5,11.5,5h2  C13.777,5,14,5.224,14,5.5L14,5.5z",gradient:{id:"SVGID_4_",type:"linear",x1:12.5,y1:6,x2:12.5,y2:5,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"rect",x:8,y:10,w:1,h:1,fill:"#232424"},{shape:"path",data:"M6,13c0-0.553,0.448-1,1-1h3c0.553,0,1,0.447,1,1v1c0,0.553-0.447,1-1,1H7c-0.552,0-1-0.447-1-1V13z",gradient:{id:"SVGID_5_",type:"linear",x1:-1428.3853,y1:-571.5747,x2:-1428.3853,y2:-568.5747,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:7,y:13,w:3,h:1,fill:"#232424"},{shape:"rect",x:7,y:13,w:3,h:1,fill:"#FFFFFF"},{shape:"path",data:"M7,11.5C7,11.223,7.224,11,7.5,11h2c0.277,0,0.5,0.223,0.5,0.5l0,0c0,0.275-0.223,0.5-0.5,0.5h-2  C7.224,12,7,11.775,7,11.5L7,11.5z",gradient:{id:"SVGID_6_",type:"linear",x1:-1428.3862,y1:-567.5737,x2:-1428.3862,y2:-568.5737,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"path",data:"M15,7.5C15,7.776,14.777,8,14.5,8h-12C2.224,8,2,7.776,2,7.5l0,0C2,7.224,2.224,7,2.5,7h12  C14.777,7,15,7.224,15,7.5L15,7.5z",gradient:{id:"SVGID_7_",type:"linear",x1:8.4995,y1:6.1152,x2:8.4995,y2:7.5558,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"path",data:"M15,9.5c0,0.275-0.223,0.5-0.5,0.5h-12C2.224,10,2,9.775,2,9.5l0,0C2,9.223,2.224,9,2.5,9h12  C14.777,9,15,9.223,15,9.5L15,9.5z",gradient:{id:"SVGID_8_",type:"linear",x1:8.4995,y1:8.1147,x2:8.4995,y2:9.556,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}}]}),Pd("data_icon",{w:16,h:16,origin:{x:0,y:0},v:[{shape:"path",data:"M15,12c0,0.553-0.447,1-1,1H7c-0.552,0-1-0.447-1-1V8c0-0.552,0.448-1,1-1h7c0.553,0,1,0.448,1,1V12   z",gradient:{id:"SVGID_1_",type:"linear",x1:10.5,y1:6.959,x2:10.5,y2:12.2259,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:7,y:8,w:7,h:4,fill:"#FFFFFF"},{shape:"rect",x:8,y:9,w:5,h:2,gradient:{id:"SVGID_2_",type:"linear",x1:10.5,y1:8.6997,x2:10.5,y2:11.0333,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"path",data:"M15,14.5c0,0.275-0.225,0.5-0.5,0.5h-8C6.224,15,6,14.775,6,14.5l0,0C6,14.223,6.224,14,6.5,14h8   C14.775,14,15,14.223,15,14.5L15,14.5z",gradient:{id:"SVGID_3_",type:"linear",x1:10.5,y1:13.125,x2:10.5,y2:14.5518,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:8,y:14,w:1,h:1,gradient:{id:"SVGID_4_",type:"linear",x1:8.4995,y1:14.0049,x2:8.4995,y2:14.9471,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"path",data:"M12,4H6c0,0-0.152-0.275-0.5-1C5.021,2,5.021,2,4,2C3.057,2,2,2,2,2C1.448,2,1,2.448,1,3v8  c0,0.553,0.448,1,1,1h3v-1H2V3h2.387l1.024,1.998L12,5v1h1V5C13,4.448,12.553,4,12,4z",gradient:{id:"SVGID_5_",type:"linear",x1:6.9995,y1:2.0527,x2:6.9995,y2:11.4757,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"path",data:"M12,5L5.411,4.998L4.387,3H2v8h3v-0.645V7.254V7c0-0.552,0.448-1,1-1h0.324h3.032H12V5z",gradient:{id:"SVGID_6_",type:"linear",x1:6.9995,y1:2.9902,x2:6.9995,y2:11.0032,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}}]}),Pd("grid_icon",{w:16,h:16,origin:{x:0,y:0},v:[{shape:"path",data:"M15,14c0,0.553-0.447,1-1,1H3c-0.552,0-1-0.447-1-1V3c0-0.552,0.448-1,1-1h11c0.553,0,1,0.448,1,1V14  z",gradient:{id:"SVGID_1_",type:"linear",x1:8.4995,y1:2.1255,x2:8.4995,y2:14.909,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:3,y:3,w:11,h:11,fill:"#FFFFFF"},{shape:"rect",x:3,y:5,w:11,h:1,gradient:{id:"SVGID_2_",type:"linear",x1:8.4995,y1:3.209,x2:8.4995,y2:13.8043,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"rect",x:3,y:8,w:11,h:1,gradient:{id:"SVGID_3_",type:"linear",x1:8.4995,y1:3.209,x2:8.4995,y2:13.8043,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"rect",x:3,y:11,w:11,h:1,gradient:{id:"SVGID_4_",type:"linear",x1:8.4995,y1:3.2095,x2:8.4995,y2:13.8048,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"rect",x:11,y:3,w:1,h:11,gradient:{id:"SVGID_5_",type:"linear",x1:11.5,y1:3.209,x2:11.5,y2:13.8048,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"rect",x:8,y:3,w:1,h:11,gradient:{id:"SVGID_6_",type:"linear",x1:8.4995,y1:3.209,x2:8.4995,y2:13.8048,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"rect",x:5,y:3,w:1,h:11,gradient:{id:"SVGID_7_",type:"linear",x1:5.5,y1:3.209,x2:5.5,y2:13.8048,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}}]}),Pd("databox_icon",{w:16,h:16,origin:{x:0,y:0},v:[{shape:"path",data:"M14.5,6h-12H2v0.5v7C2,13.776,2.224,14,2.5,14h12c0.276,0,0.5-0.224,0.5-0.5v-7V6H14.5z",gradient:{id:"SVGID_1_",type:"linear",x1:8.4995,y1:6.0625,x2:8.4995,y2:14.063,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"path",data:"M14.776,5.553l-1.553-3.105C13.101,2.201,12.775,2,12.5,2h-8C4.225,2,3.899,2.201,3.776,2.447  L2.224,5.553L2,6h0.5h12H15L14.776,5.553z",gradient:{id:"SVGID_2_",type:"linear",x1:8.5005,y1:3.104,x2:8.5005,y2:-5.6467,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"path",data:"12,2 9.5,2 7.5,2 5,2 3,6 7.5,6 9.5,6 14,6 z",gradient:{id:"SVGID_3_",type:"linear",x1:8.5005,y1:9.2295,x2:8.5005,y2:5.4586,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"path",data:"M11.5,9c0,0.276-0.224,0.5-0.5,0.5H6C5.724,9.5,5.5,9.276,5.5,9l0,0c0-0.276,0.224-0.5,0.5-0.5h5  C11.276,8.5,11.5,8.724,11.5,9L11.5,9z",fill:"#FFFFFF"}]}),Pd("group_icon",{w:16,h:16,origin:{x:0,y:0},v:[{shape:"path",data:"M15,8.5C15,8.776,14.776,9,14.5,9h-10C4.224,9,4,8.776,4,8.5v-7C4,1.224,4.224,1,4.5,1h10    C14.776,1,15,1.224,15,1.5V8.5z",gradient:{id:"SVGID_1_",type:"linear",x1:9.5,y1:.9512,x2:9.5,y2:8.9787,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:5,y:2,w:9,h:6,fill:"#FFFFFF"},{shape:"rect",x:6,y:3,w:7,h:4,gradient:{id:"SVGID_2_",type:"linear",x1:9.5,y1:3.02,x2:9.5,y2:6.9606,stop:[{offset:"0",color:"#58AC9A"},{offset:"1",color:"#248576"}]}},{shape:"path",data:"M16,10.5c0,0.276-0.224,0.5-0.5,0.5h-12C3.224,11,3,10.776,3,10.5l0,0C3,10.224,3.224,10,3.5,10h12    C15.776,10,16,10.224,16,10.5L16,10.5z",gradient:{id:"SVGID_3_",type:"linear",x1:9.5,y1:9.9941,x2:9.5,y2:10.9976,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:6,y:10.001,w:2,h:.999,gradient:{id:"SVGID_4_",type:"linear",x1:7,y1:10.0059,x2:7,y2:10.9472,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"path",data:"M12,12.5c0,0.276-0.224,0.5-0.5,0.5h-10C1.224,13,1,12.776,1,12.5v-7C1,5.224,1.224,5,1.5,5h10    C11.776,5,12,5.224,12,5.5V12.5z",gradient:{id:"SVGID_5_",type:"linear",x1:6.4995,y1:4.9512,x2:6.4995,y2:12.9792,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:2,y:6,w:9,h:6,fill:"#FFFFFF"},{shape:"rect",x:3,y:7,w:7,h:4,gradient:{id:"SVGID_6_",type:"linear",x1:6.4995,y1:7.02,x2:6.4995,y2:10.9611,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"path",data:"M13,14.5c0,0.276-0.224,0.5-0.5,0.5h-12C0.224,15,0,14.776,0,14.5l0,0C0,14.224,0.224,14,0.5,14h12    C12.776,14,13,14.224,13,14.5L13,14.5z",gradient:{id:"SVGID_7_",type:"linear",x1:6.4995,y1:13.9941,x2:6.4995,y2:14.9976,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:3,y:14.001,w:2,h:.999,gradient:{id:"SVGID_8_",type:"linear",x1:4,y1:14.0059,x2:4,y2:14.9472,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}}]}),Pd("link_icon",{w:16,h:16,origin:{x:0,y:0},v:[{shape:"line",p1:{x:2.5,y:2.5},p2:{x:13.5,y:13.5},lineColor:"url(#SVGID_1_)",lineWidth:1},{shape:"ellipse",cx:13,cy:13,rx:2,ry:2,gradient:{id:"SVGID_2_",type:"linear",x1:11.5371,y1:11.5371,x2:14.2155,y2:14.2155,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"ellipse",cx:13,cy:13,rx:1,ry:1,fill:"#FFFFFF"},{shape:"ellipse",cx:3,cy:3,rx:2,ry:2,gradient:{id:"SVGID_3_",type:"linear",x1:1.4956,y1:1.4956,x2:4.1473,y2:4.1473,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"ellipse",cx:3,cy:3,rx:1,ry:1,fill:"#FFFFFF"}]}),Pd("linksubnetwork_icon",{w:16,h:16,origin:{x:0,y:0},v:[{shape:"path",data:"M15,7.661c0-1.202-0.642-2.247-1.596-2.835C12.848,3.188,11.314,2,9.486,2  c-1.587,0-2.95,0.902-3.649,2.211C4.573,4.22,3.548,5.194,3.438,6.432C3.389,6.429,3.342,6.417,3.292,6.417  C2.026,6.417,1,7.443,1,8.708C1,9.975,2.026,11,3.292,11h8.371l0,0C13.506,11,15,9.506,15,7.661z",gradient:{id:"SVGID_1_",type:"linear",x1:7.9995,y1:1.959,x2:7.9995,y2:11.0921,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"path",data:"M3.292,10C2.58,10,2,9.42,2,8.708c0-0.712,0.58-1.292,1.292-1.292C3.286,7.422,3.332,7.427,3.379,7.43  l0.969,0.058L4.435,6.52C4.5,5.779,5.106,5.216,5.844,5.211l0.595-0.004l0.28-0.524C7.273,3.645,8.334,3,9.486,3  c1.342,0,2.535,0.863,2.971,2.147l0.116,0.341l0.307,0.189C13.581,6.11,14,6.851,14,7.661C14,8.951,12.951,10,11.661,10H3.292z",fill:"#FFFFFF"},{shape:"path",data:"M3.292,10h8.37c1.11,0,2.04-0.781,2.276-1.821c-0.131-0.615-0.5-1.158-1.058-1.501l-0.307-0.189  l-0.116-0.341C12.021,4.863,10.828,4,9.486,4C8.334,4,7.273,4.645,6.719,5.682l-0.28,0.524L5.844,6.211  C5.106,6.216,4.5,6.779,4.435,7.52L4.349,8.487L3.379,8.43C3.332,8.427,3.286,8.422,3.292,8.417c-0.535,0-0.994,0.328-1.19,0.792  C2.297,9.672,2.757,10,3.292,10z",gradient:{id:"SVGID_2_",type:"linear",x1:8.019,y1:4.084,x2:8.019,y2:9.8062,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"line",p1:{x:8.01,y:8.01},p2:{x:13.186,y:13.186},lineColor:"url(#SVGID_3_)",lineWidth:1},{shape:"ellipse",cx:8,cy:8,rx:2,ry:2,gradient:{id:"SVGID_4_",type:"linear",x1:6.7881,y1:6.7881,x2:9.9924,y2:9.9924,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"ellipse",cx:8,cy:8,rx:1,ry:1,fill:"#FFFFFF"},{shape:"ellipse",cx:13,cy:13,rx:2,ry:2,gradient:{id:"SVGID_5_",type:"linear",x1:11.5791,y1:11.5791,x2:14.3132,y2:14.3132,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"ellipse",cx:13,cy:13,rx:1,ry:1,fill:"#FFFFFF"}]}),Pd("node_icon",{w:16,h:16,origin:{x:0,y:0},v:[{shape:"path",data:"M15,11.5c0,0.276-0.224,0.5-0.5,0.5h-13C1.224,12,1,11.776,1,11.5v-9C1,2.224,1.224,2,1.5,2h13  C14.776,2,15,2.224,15,2.5V11.5z",gradient:{id:"SVGID_1_",type:"linear",x1:7.9995,y1:1.939,x2:7.9995,y2:11.9739,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:2,y:3,w:12,h:8,fill:"#FFFFFF"},{shape:"rect",x:3,y:4,w:10,h:6,gradient:{id:"SVGID_2_",type:"linear",x1:7.9995,y1:4.0513,x2:7.9995,y2:9.865,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"path",data:"M16,14.5c0,0.276-0.224,0.5-0.5,0.5h-15C0.224,15,0,14.776,0,14.5v-1C0,13.224,0.224,13,0.5,13h15  c0.276,0,0.5,0.224,0.5,0.5V14.5z",gradient:{id:"SVGID_3_",type:"linear",x1:7.9995,y1:13.0508,x2:7.9995,y2:14.9258,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"path",data:"M9,14.5C9,14.224,8.776,14,8.5,14h-5C3.224,14,3,14.224,3,14.5V15h6V14.5z",gradient:{id:"SVGID_4_",type:"linear",x1:5.9995,y1:14.0508,x2:5.9995,y2:15.9258,stop:[{offset:"0",color:"#69B4A5"},{offset:"0.1",color:"#61AD9C"},{offset:"0.4637",color:"#449981"},{offset:"0.7764",color:"#2C8E73"},{offset:"1",color:"#218A6E"}]}}]}),Pd("shapelink_icon",{w:16,h:16,origin:{x:0,y:0},v:[{shape:"line",p1:{x:7.5,y:2.5},p2:{x:2.5,y:7.5},lineColor:"url(#SVGID_1_)",lineWidth:1},{shape:"line",p1:{x:2.5,y:7.5},p2:{x:8.5,y:13.5},lineColor:"url(#SVGID_2_)",lineWidth:1},{shape:"line",p1:{x:9,y:13.186},p2:{x:13.5,y:6.5},lineColor:"url(#SVGID_3_)",lineWidth:1},{shape:"ellipse",cx:7,cy:3,rx:2,ry:2,gradient:{id:"SVGID_4_",type:"linear",x1:5.5864,y1:1.5864,x2:8.4149,y2:4.4149,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"ellipse",cx:7,cy:3,rx:1,ry:1,fill:"#FFFFFF"},{shape:"ellipse",cx:2,cy:8,rx:2,ry:2,gradient:{id:"SVGID_5_",type:"linear",x1:.5864,y1:6.5864,x2:3.4142,y2:9.4142,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"ellipse",cx:2,cy:8,rx:1,ry:1,fill:"#FFFFFF"},{shape:"ellipse",cx:8,cy:13,rx:2,ry:2,gradient:{id:"SVGID_6_",type:"linear",x1:6.5869,y1:11.5869,x2:9.4147,y2:14.4147,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"ellipse",cx:8,cy:13,rx:1,ry:1,fill:"#FFFFFF"},{shape:"ellipse",cx:13,cy:7,rx:2,ry:2,gradient:{id:"SVGID_7_",type:"linear",x1:11.5859,y1:5.5859,x2:14.4144,y2:8.4144,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"ellipse",cx:13,cy:7,rx:1,ry:1,fill:"#FFFFFF"}]}),Pd("shapenode_icon",{w:16,h:16,origin:{x:0,y:0},v:[{shape:"path",data:"M14.5,3h-9l-4,4v7h13L9,8.5L14.5,3z M12.086,13H2.5V7.414L5.914,4h6.172l-4.5,4.5L12.086,13z",gradient:{id:"SVGID_1_",type:"linear",x1:7.9995,y1:3.209,x2:7.9995,y2:13.6621,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"ellipse",cx:6,cy:3,rx:2,ry:2,gradient:{id:"SVGID_2_",type:"linear",x1:4.5859,y1:1.5859,x2:7.4151,y2:4.4151,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"ellipse",cx:6,cy:3,rx:1,ry:1,fill:"#FFFFFF"},{shape:"ellipse",cx:13,cy:3,rx:2,ry:2,gradient:{id:"SVGID_3_",type:"linear",x1:11.5869,y1:1.5864,x2:14.4153,y2:4.4149,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"ellipse",cx:13,cy:3,rx:1,ry:1,fill:"#FFFFFF"},{shape:"ellipse",cx:9,cy:8,rx:2,ry:2,gradient:{id:"SVGID_4_",type:"linear",
x1:7.5864,y1:6.5864,x2:10.4149,y2:9.4149,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"ellipse",cx:9,cy:8,rx:1,ry:1,fill:"#FFFFFF"},{shape:"ellipse",cx:2,cy:7,rx:2,ry:2,gradient:{id:"SVGID_5_",type:"linear",x1:.5859,y1:5.5859,x2:3.4144,y2:8.4144,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"ellipse",cx:2,cy:7,rx:1,ry:1,fill:"#FFFFFF"},{shape:"ellipse",cx:12.825,cy:13,rx:2,ry:2,gradient:{id:"SVGID_6_",type:"linear",x1:11.4111,y1:11.5869,x2:14.2396,y2:14.4153,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"ellipse",cx:12.825,cy:13,rx:1,ry:1,fill:"#FFFFFF"}]}),Pd("shapesubnetwork_icon",{w:16,h:16,origin:{x:0,y:0},v:[{shape:"path",data:"M15,6.661c0-1.202-0.642-2.247-1.596-2.835C12.848,2.188,11.314,1,9.486,1  c-1.587,0-2.95,0.902-3.649,2.211C4.573,3.22,3.548,4.194,3.438,5.432C3.389,5.429,3.342,5.417,3.292,5.417  C2.026,5.417,1,6.443,1,7.708S2.026,10,3.292,10h8.371l0,0C13.506,10,15,8.505,15,6.661z",gradient:{id:"SVGID_1_",type:"linear",x1:7.9995,y1:1.3755,x2:7.9995,y2:9.733,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"path",data:"M3.292,9C2.58,9,2,8.42,2,7.708s0.58-1.292,1.292-1.292C3.286,6.422,3.332,6.427,3.379,6.43l0.969,0.058  L4.435,5.52C4.5,4.779,5.106,4.216,5.844,4.211l0.595-0.004l0.28-0.524C7.273,2.645,8.334,2,9.486,2  c1.342,0,2.535,0.863,2.971,2.147l0.116,0.341l0.307,0.189C13.581,5.11,14,5.851,14,6.661C14,7.951,12.951,9,11.661,9H3.292z",fill:"#FFFFFF"},{shape:"path",data:"M3.272,9h8.37c1.11,0,2.039-0.689,2.275-1.729c-0.131-0.615-0.499-1.249-1.057-1.593l-0.307-0.189  l-0.116-0.341C12.002,3.863,10.809,3,9.468,3C8.314,3,7.254,3.645,6.7,4.682L6.42,5.207L5.825,5.211  C5.087,5.216,4.481,5.779,4.416,6.52L4.33,7.487L3.36,7.43C3.313,7.427,3.267,7.422,3.272,7.417c-0.535,0-0.994,0.327-1.19,0.792  C2.278,8.672,2.738,9,3.272,9z",gradient:{id:"SVGID_2_",type:"linear",x1:7.9995,y1:3.459,x2:7.9995,y2:8.4597,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"path",data:"M11.516,7.102h-8l2.469,6h8.5L11.516,7.102z M5.024,8.123h5.905l1.938,3.979H6.662L5.024,8.123z",gradient:{id:"SVGID_3_",type:"linear",x1:7.4443,y1:7.1724,x2:10.1111,y2:12.8383,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"path",data:"5,8.112 10.904,8.112 12.842,12.092 6.638,12.092 z",fill:"#FFFFFF"},{shape:"ellipse",cx:5,cy:8,rx:2,ry:2,gradient:{id:"SVGID_4_",type:"linear",x1:3,y1:8,x2:7,y2:8,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"ellipse",cx:5,cy:8,rx:1,ry:1,fill:"#FFFFFF"},{shape:"ellipse",cx:12,cy:8,rx:2,ry:2,gradient:{id:"SVGID_5_",type:"linear",x1:10,y1:8,x2:14,y2:8,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"ellipse",cx:12,cy:8,rx:1,ry:1,fill:"#FFFFFF"},{shape:"ellipse",cx:7,cy:12,rx:2,ry:2,gradient:{id:"SVGID_6_",type:"linear",x1:5,y1:12,x2:9,y2:12,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"ellipse",cx:7,cy:12,rx:1,ry:1,fill:"#FFFFFF"},{shape:"ellipse",cx:14,cy:12,rx:2,ry:2,gradient:{id:"SVGID_7_",type:"linear",x1:12,y1:12,x2:16,y2:12,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"ellipse",cx:14,cy:12,rx:1,ry:1,fill:"#FFFFFF"}]}),Pd("subnetwork_icon",{w:16,h:16,origin:{x:0,y:0},v:[{shape:"rect",x:10,y:14.001,w:2,h:1,gradient:{id:"SVGID_1_",type:"linear",x1:11,y1:14.0059,x2:11,y2:14.9481,stop:[{offset:"0",color:"#58AC9A"},{offset:"1",color:"#248576"}]}},{shape:"rect",x:14,y:10.001,w:1,h:2,gradient:{id:"SVGID_2_",type:"linear",x1:14.5,y1:10.0117,x2:14.5,y2:11.8962,stop:[{offset:"0",color:"#58AC9A"},{offset:"1",color:"#248576"}]}},{shape:"path",data:"M16,6.001c0,0.552-0.447,1-1,1H8c-0.552,0-1-0.448-1-1v-4c0-0.552,0.448-1,1-1h7   c0.553,0,1,0.448,1,1V6.001z",gradient:{id:"SVGID_3_",type:"linear",x1:11.5,y1:.96,x2:11.5,y2:6.2265,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:8,y:2.001,w:7,h:4,fill:"#FFFFFF"},{shape:"rect",x:9,y:3.001,w:5,h:2,gradient:{id:"SVGID_4_",type:"linear",x1:11.5,y1:2.7007,x2:11.5,y2:5.0337,stop:[{offset:"0",color:"#58AC9A"},{offset:"1",color:"#248576"}]}},{shape:"path",data:"M16,8.501c0,0.276-0.225,0.5-0.5,0.5h-8c-0.276,0-0.5-0.224-0.5-0.5l0,0c0-0.276,0.224-0.5,0.5-0.5   h8C15.775,8.001,16,8.225,16,8.501L16,8.501z",gradient:{id:"SVGID_5_",type:"linear",x1:11.5,y1:7.126,x2:11.5,y2:8.5535,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:9,y:8.001,w:1,h:.999,gradient:{id:"SVGID_6_",type:"linear",x1:9.5,y1:8.0063,x2:9.5,y2:8.9477,stop:[{offset:"0",color:"#58AC9A"},{offset:"1",color:"#248576"}]}},{shape:"path",data:"M9,12c0,0.553-0.447,1-1,1H1c-0.552,0-1-0.447-1-1V8c0-0.552,0.448-1,1-1h7c0.553,0,1,0.448,1,1V12z   ",gradient:{id:"SVGID_7_",type:"linear",x1:4.4995,y1:6.959,x2:4.4995,y2:12.2259,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:1,y:8,w:7,h:4,fill:"#FFFFFF"},{shape:"rect",x:2,y:9,w:5,h:2,gradient:{id:"SVGID_8_",type:"linear",x1:4.5,y1:8.6997,x2:4.5,y2:11.0333,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"path",data:"M9,14.5C9,14.776,8.775,15,8.5,15h-8C0.224,15,0,14.776,0,14.5l0,0C0,14.224,0.224,14,0.5,14h8   C8.775,14,9,14.224,9,14.5L9,14.5z",gradient:{id:"SVGID_9_",type:"linear",x1:4.4995,y1:13.125,x2:4.4995,y2:14.5518,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:2,y:14,w:1,h:1,gradient:{id:"SVGID_10_",type:"linear",x1:2.5,y1:14.0049,x2:2.5,y2:14.9471,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"path",data:"M16,14.501c0,0.276-0.224,0.5-0.5,0.5h-2c-0.276,0-0.5-0.224-0.5-0.5v-1c0-0.276,0.224-0.5,0.5-0.5  h2c0.276,0,0.5,0.224,0.5,0.5V14.501z",gradient:{id:"SVGID_11_",type:"linear",x1:14.5,y1:13.0117,x2:14.5,y2:14.8962,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}}]});var Od={_hitCanvas:null,getHitCanvas:function(a,b){null==this._hitCanvas&&(this._hitCanvas=Wb.createCanvas()),0==arguments.length&&(a=2,b=2),this._hitCanvas.setAttribute("width",""+a-1),this._hitCanvas.setAttribute("height",""+b-1),this._hitCanvas.setAttribute("width",""+a),this._hitCanvas.setAttribute("height",""+b);var c=this.getCtx(this._hitCanvas);return c.clearRect(0,0,a,b),this._hitCanvas},disposeHitCanvas:function(){this._hitCanvas=null},getCtx:function(a){return a.getContext("2d")},render:function(a,c,d){c!=b&&(a.fillStyle=c,a.fill()),d!=b&&(a.strokeStyle=d,a.stroke())},text:function(a,b,c,d,e,f){a.textAlign="center",a.textBaseline="middle",null!=e&&(a.fillStyle=e,a.fillText(b,c,d)),f&&(a.strokeStyle=f,a.strokeText(b,c,d))},circle:function(a,b,c,d,e,f){a.arc(b,c,d,0,2*Math.PI,!0),a.closePath(),this.render(a,e,f)},rect:function(a,b,c,d,e,f,g){a.rect(b,c,d,e),a.closePath(),this.render(a,f,g)},OUT_LEFT:1,OUT_TOP:2,OUT_RIGHT:4,OUT_BOTTOM:8,outcode:function(a,b,c,d,e,f){var g=0;return 0>=e?g|=this.OUT_LEFT|this.OUT_RIGHT:c>a?g|=this.OUT_LEFT:a>c+e&&(g|=this.OUT_RIGHT),0>=f?g|=this.OUT_TOP|this.OUT_BOTTOM:d>b?g|=this.OUT_TOP:b>d+f&&(g|=this.OUT_BOTTOM),g},intersectsLine:function(a,b,c,d,e,f,g,h){var i,j;if(0==(j=this.outcode(c,d,e,f,g,h)))return!0;for(;0!=(i=this.outcode(a,b,e,f,g,h));){if(0!=(i&j))return!1;if(0!=(i&(this.OUT_LEFT|this.OUT_RIGHT))){var k=e;0!=(i&this.OUT_RIGHT)&&(k+=g),b+=(k-a)*(d-b)/(c-a),a=k}else{var l=f;0!=(i&this.OUT_BOTTOM)&&(l+=h),a+=(l-b)*(c-a)/(d-b),b=l}}return!0}};Ib.vector={},Ib.vector.interaction={},Ib.vector.Network=function(a){Ib.vector.Network.superClass.constructor.apply(this,arguments),this.zoomManager=new Ib.vector.PhysicalZoomManager(this),this._view=Wb.createView("hidden"),this._rootCanvas=Wb.createCanvas(),this._topCanvas=Wb.createCanvas(),this._view.appendChild(this._rootCanvas),this._view.appendChild(this._topCanvas),this.realWidth=0,this.realHeight=0,this._unionBounds={x:0,y:0,width:0,height:0},this._zoom=1,this._elementUIMap={},this._zoomMap={},this._viewRectMap={},this.viewRect={x:0,y:0,width:0,height:0},this.state={zooming:!1,panning:!1,autoLayout:!1},this.hScrollBarVisible=!1,this.vScrollBarVisible=!1,this.markerList=new Ib.List,this._topAttachmentList=new Ib.List,this._hitTestTopAttachmentList=new Ib.List,this.setElementBox(a?a:new Ib.ElementBox),Qb.isTouchable?Qb.isMSTouchable?this.setDefaultInteractions(!1):this.setTouchInteractions():this.setDefaultInteractions(!1);var b=this;this._flowLink=function(){if(!(b.isMovingElement()||b.isSelectingElement()||b.isEditingElement()||b._box._layoutMovingElements)){b._flowLinkQuickFinder||(b._flowLinkQuickFinder=new Ib.QuickFinder(b._box,"link.flow","style"));var a=b._flowLinkQuickFinder.find(!0);a.forEach(function(a){a._styleMap["link.flow.offset"]=b.getLinkFlowOffset(a),b.invalidateElementUI(a)})}},this.setToolTipEnabled(Ib.Defaults.NETWORK_TOOLTIP_ENABLED),this._paintAll=!0,this._dirtyRects=new nd,this._invalidateMap={},this._invalidateAll=!0,b._count=0,b._invalidate=!0,function c(a){b._loopId=requestAnimationFrame(c),b._invalidate&&(b._count++,b._now=a,b.validate())}(0),Ib.imageUtil.addEventListener(this.invalidateElementUIs,this)},Jb.ext("twaver.vector.Network",Ib.controls.View,{__accessor:["selectMode","makeVisibleOnSelected","movableFunction","editPointSize","editPointFillColor","scrollBarWidth","editPointOutlineWidth","editPointOutlineColor","editLineColor","editLineWidth","resizePointSize","resizePointFillColor","resizePointOutlineWidth","resizePointOutlineColor","resizeLineColor","resizeLineWidth","rotatePointSize","rotatePointFillColor","rotatePointOffset","rotatePointOutlineWidth","rotatePointOutlineColor","rotateScaleFillColor","rotateScaleFontColor","rotateScaleWidth","rotateScaleHeight","selectOutlineColor","selectOutlineWidth","selectFillColor","lazyMoveOutlineColor","lazyMoveOutlineWidth","lazyMoveFillColor","rectSelectFilter","selectionTolerance"],__bool:["doubleClickToUpSubNetwork","doubleClickToSubNetwork","doubleClickToEmptySubNetwork","doubleClickToLinkBundle","doubleClickToGroupExpand","scrollBarVisible","limitViewInCanvas","autoValidateCanvasSize","subNetworkAnimate","lazyMoveAnimate","resizeAnimate","noAgentLinkVisible","keyboardRemoveEnabled","keyboardSelectEnabled","sendToTopOnSelected","lazyMoveFill","editingElement","rotatingElement","movingElement","selectingElement","rectSelectEnabled","limitElementInPositiveLocation","showRotateScale","transparentSelectionEnable","edgeDetect","dragToPan","wheelToZoom","asyncZoomAndViewRect","debug","zoomDivVisible","showShadowInEdit","showAttachmentsInZoomPanOrAutoLayout"],_currentSubNetwork:null,_subNetworkAnimate:Ib.Defaults.NETWORK_SUBNETWORK_ANIMATE,_scrollBarWidth:10,_scrollBarVisible:!0,_limitViewInCanvas:!1,_autoValidateCanvasSize:!0,_makeVisibleOnSelected:Ib.Defaults.NETWORK_MAKE_VISIBLE_ON_SELECTED,_keyboardRemoveEnabled:Ib.Defaults.NETWORK_KEYBOARD_REMOVE_ENABLED,_keyboardSelectEnabled:Ib.Defaults.NETWORK_KEYBOARD_SELECT_ENABLED,_rectSelectEnabled:Ed.NETWORK_RECT_SELECT_ENABLED,_rectSelectFilter:null,_elementUIFunction:Ib.Defaults.VECTORUI_FUNCTION,_doubleClickToUpSubNetwork:Ib.Defaults.NETWORK_DOUBLECLICK_TO_UPSUBNETWORK,_doubleClickToSubNetwork:Ib.Defaults.NETWORK_DOUBLECLICK_TO_SUBNETWORK,_doubleClickToEmptySubNetwork:Ib.Defaults.NETWORK_DOUBLECLICK_TO_EMPTYSUBNETWORK,_doubleClickToLinkBundle:Ib.Defaults.NETWORK_DOUBLECLICK_TO_LINKBUNDLE,_doubleClickToGroupExpand:Ib.Defaults.NETWORK_DOUBLECLICK_TO_GROUPEXPAND,_selectOutlineColor:Ib.Defaults.NETWORK_SELECT_OUTLINE_COLOR,_selectOutlineWidth:Ib.Defaults.NETWORK_SELECT_OUTLINE_WIDTH,_selectFillColor:Ib.Defaults.NETWORK_SELECT_FILL_COLOR,_sendToTopOnSelected:Ib.Defaults.NETWORK_SENDTOTOP_ON_SELECTED,_lazyMoveOutlineColor:Ib.Defaults.NETWORK_LAZYMOVE_OUTLINE_COLOR,_lazyMoveOutlineWidth:Ib.Defaults.NETWORK_LAZYMOVE_OUTLINE_WIDTH,_lazyMoveFillColor:Ib.Defaults.NETWORK_LAZYMOVE_FILL_COLOR,_lazyMoveFill:Ib.Defaults.NETWORK_LAZYMOVE_FILL,_lazyMoveAnimate:Ib.Defaults.NETWORK_LAZYMOVE_ANIMATE,_resizePointSize:Ib.Defaults.NETWORK_RESIZE_POINT_SIZE,_resizePointFillColor:Ib.Defaults.NETWORK_RESIZE_POINT_FILL_COLOR,_resizePointOutlineColor:Ib.Defaults.NETWORK_RESIZE_POINT_OUTLINE_COLOR,_resizePointOutlineWidth:Ib.Defaults.NETWORK_RESIZE_POINT_OUTLINE_WIDTH,_resizeLineColor:Ib.Defaults.NETWORK_RESIZE_LINE_COLOR,_resizeLineWidth:Ib.Defaults.NETWORK_RESIZE_LINE_WIDTH,_resizeAnimate:Ib.Defaults.NETWORK_RESIZE_ANIMATE,_rotatePointSize:Ib.Defaults.NETWORK_ROTATE_POINT_SIZE,_rotatePointFillColor:Ib.Defaults.NETWORK_ROTATE_POINT_FILL_COLOR,_rotatePointOffset:Ib.Defaults.NETWORK_ROTATE_POINT_OFFSET,_rotatePointOutlineWidth:Ib.Defaults.NETWORK_ROTATE_POINT_OUTLINE_WIDTH,_rotatePointOutlineColor:Ib.Defaults.NETWORK_ROTATE_POINT_OUTLINE_COLOR,_rotateScaleWidth:Ed.NETWORK_ROTATE_SCALE_WIDTH,_rotateScaleHeight:Ed.NETWORK_ROTATE_SCALE_HEIGHT,_rotateScaleFillColor:Ed.NETWORK_ROTATE_SCALE_FILL_COLOR,_rotateScaleFontColor:Ed.NETWORK_ROTATE_SCALE_FONT_COLOR,_editPointSize:Ib.Defaults.NETWORK_EDIT_POINT_SIZE,_editPointFillColor:Ib.Defaults.NETWORK_EDIT_POINT_FILL_COLOR,_editPointOutlineColor:Ib.Defaults.NETWORK_EDIT_POINT_OUTLINE_COLOR,_editPointOutlineWidth:Ib.Defaults.NETWORK_EDIT_POINT_OUTLINE_WIDTH,_editLineColor:Ib.Defaults.NETWORK_EDIT_LINE_COLOR,_editLineWidth:Ib.Defaults.NETWORK_EDIT_LINE_WIDTH,_limitElementInPositiveLocation:!1,_linkFlowInterval:Ed.NETWORK_LINK_FLOW_INTERVAL,_selectionTolerance:Ed.NETWORK_SELECTION_TOLERANCE,_invalidateViewRectFlag:!1,_repaintTopFlag:!1,_invalidateCanvasSizeFlag:!1,_isEditingElement:!1,_isRotatingElement:!1,_isMovingElement:!1,_isSelectingElement:!1,_hasEditInteraction:!1,_showRotateScale:!0,_transparentSelectionEnable:Ib.Defaults.NETWORK_TRANSPARENT_SELECTION_ENABLE,_edgeDetect:!1,_dragToPan:!0,_wheelToZoom:!0,_asyncZoomAndViewRect:!1,_debug:!1,_zoomDivVisible:!0,_showShadowInEdit:!1,_showAttachmentsInZoomPanOrAutoLayout:!0,adjustBounds:function(a){var b=!1,c=this._view.style;if(c.left==a.x+"px"&&c.top==a.y+"px"&&c.width==a.width+"px"&&c.height==a.height+"px"&&(b=!0),Ib.vector.Network.superClass.adjustBounds.apply(this,arguments),1!=b){var d=this._view.offsetWidth,e=this._view.offsetHeight;this._rootCanvas.setAttribute("width",d),this._rootCanvas.setAttribute("height",e),this._topCanvas.setAttribute("width",d),this._topCanvas.setAttribute("height",e),this.setViewRect(this.viewRect.x,this.viewRect.y,d,e),"undefined"==typeof Ib.gis&&(Ib.Util.makeHighRes(this._rootCanvas),Ib.Util.makeHighRes(this._topCanvas)),this.invalidateElementVisibility()}},getLabel:function(a){return a.getStyle("network.label")||a.getName()},getLabel2:function(a){return a.getStyle("network.label")||a.getName2()},setZoomManager:function(a){var b=this.zoomManager;b!=a&&(this.zoomManager=a,this.invalidateElementVisibility(),this.invalidateCanvasSize(),this.validateCanvasSize(),this.invalidateElementUIs(),this.firePropertyChange("zoomManager",b,a))},getZoomManager:function(){return this.zoomManager},getRootCanvas:function(){return this._rootCanvas},getTopCanvas:function(){return this._topCanvas},validateImpl:function(){oc.twm(this);var a,b,c,d,e=this.getElementBox().getDatas()._as,f=e.length,g={},h=this._visibleFunction,i=1===this._box._layerBox.size()?this._box._layerBox._defaultLayer:null;for(a=0;f>a;a++)c=e[a],g[c._id]=this.isVisible(c,h,i);var j=this.getGraphicsZoom(),k=null,l={x:this.viewRect.x/j,y:this.viewRect.y/j,width:this.viewRect.width/j,height:this.viewRect.height/j};if(this._invalidateAll){if(this._visibleMap)for(a=0;f>a;a++)c=e[a],g[c._id]!==this._visibleMap[c._id]&&(d=this._elementUIMap[c._id],d&&d.invalidate());for(a=0;f>a;a++)c=e[a],d=this._elementUIMap[c._id],d&&d.validate();this._paintAll=!0}else if(this._paintAll){for(b in this._invalidateMap)d=this._elementUIMap[b],d&&d.invalidate();for(b in this._invalidateMap)d=this._elementUIMap[b],d&&d.validate()}else{for(b in this._invalidateMap)d=this._elementUIMap[b],d&&(this._dirtyRects.add(d.getZoomViewRect(!1)),d.invalidate());for(b in this._invalidateMap)d=this._elementUIMap[b],d&&(d.validate(),this._dirtyRects.add(d.getZoomViewRect(!0)))}this._paintAll?k=l:(this._dirtyRects.forEach(function(a){k=null==k?Jb.cloneRect(a):Tb.unionRect(k,a)}),k?(Tb.grow(k,2,2),k=Tb.intersection(k,l)):k=l),this._visibleMap=g,k&&this.paintRoot(k),this.validateCanvasSize(),1==this._repaintTopFlag&&(this._repaintTopFlag=!1,this.paintTopCanvas())},isLinkFlowEnabled:function(){return this._linkFlowEnabled?!0:!1},setLinkFlowEnabled:function(a){a?(this._linkFlowEnabled||(this._linkFlowEnabled=!0,this.firePropertyChange("linkFlowEnabled",!1,!0)),clearInterval(this._linkFlowTimerId),this._linkFlowTimerId=setInterval(this._flowLink,this._linkFlowInterval)):(this._linkFlowEnabled&&(this._linkFlowEnabled=!1,this.firePropertyChange("linkFlowEnabled",!0,!1)),clearInterval(this._linkFlowTimerId),delete this._linkFlowTimerId)},getLinkFlowInterval:function(){return this._linkFlowInterval},setLinkFlowInterval:function(a){var b=this._linkFlowInterval;this._linkFlowInterval=a,this.firePropertyChange("linkFlowInterval",b,a),clearInterval(this._linkFlowTimerId),this.isLinkFlowEnabled()&&(this._linkFlowTimerId=setInterval(this._flowLink,this._linkFlowInterval))},getElementBox:function(){return this._box},setElementBox:function(a){if(!a)throw"ElementBox can not be null";if(this._box!==a){var b=this._box;b&&(b.removeDataBoxChangeListener(this.handleElementBoxChange,this),b.removeDataPropertyChangeListener(this.handleElementPropertyChange,this),b.removePropertyChangeListener(this.handleElementBoxPropertyChange,this),b.removeIndexChangeListener(this.handleIndexChange,this),b.getLayerBox().removeDataBoxChangeListener(this.handleLayerBoxChange,this),b.getLayerBox().removeDataPropertyChangeListener(this.handleLayerPropertyChange,this),b.getLayerBox().removeHierarchyChangeListener(this.handleLayerHierarchyChange,this),this._selectionModel||b.getSelectionModel().removeSelectionChangeListener(this.handleSelectionChange,this)),this._box=a,this._box.addDataBoxChangeListener(this.handleElementBoxChange,this),this._box.addDataPropertyChangeListener(this.handleElementPropertyChange,this),this._box.addPropertyChangeListener(this.handleElementBoxPropertyChange,this),this._box.addIndexChangeListener(this.handleIndexChange,this),this._box.getLayerBox().addDataBoxChangeListener(this.handleLayerBoxChange,this),this._box.getLayerBox().addDataPropertyChangeListener(this.handleLayerPropertyChange,this),this._box.getLayerBox().addHierarchyChangeListener(this.handleLayerHierarchyChange,this),this._flowLinkQuickFinder&&(this._flowLinkQuickFinder.dispose(),this._flowLinkQuickFinder=new Ib.QuickFinder(this._box,"link.flow","style")),this._selectionModel?this._selectionModel._setDataBox(a):this._box.getSelectionModel().addSelectionChangeListener(this.handleSelectionChange,this),this._elementUIMap={},this._box.forEach(this.createElementUI,this),this.invalidateElementVisibility(),this.invalidateCanvasSize(),this.firePropertyChange("elementBox",b,this._box)}},handleElementBoxChange:function(a){var b=a.data;if("add"===a.kind)this.createElementUI(b),this.invalidateBundleLink(b);else if("remove"===a.kind){var c=this.getElementUI(b);c&&(this._dirtyRects.add(c.getZoomViewRect()),c.dispose(),delete this._elementUIMap[b.getId()]),b===this._currentSubNetwork&&null!=this._currentSubNetwork&&this._setCurrentSubNetwork(null),delete this._invalidateMap[b._id]}else if("clear"===a.kind){for(var d in this._elementUIMap)this._elementUIMap[d]&&this._elementUIMap[d].dispose&&this._elementUIMap[d].dispose();this._elementUIMap={},null!=this._currentSubNetwork&&this._setCurrentSubNetwork(null),this._paintAll=!0}else"layoutEnd"===a.kind?this.state.layouting=!1:"layouting"===a.kind&&(this.state.layouting=!0);this.invalidateElementVisibility(),this.invalidateCanvasSize()},handleElementPropertyChange:function(a){var b=a.source,c=this.getElementUI(b);c&&(this.invalidateElementUI(b),c.handlePropertyChange(a)),this.invalidateBundleLink(b),this.invalidateElementVisibility(),this.invalidateCanvasSize()},handleElementBoxPropertyChange:function(){this.invalidateElementVisibility()},handleIndexChange:function(a){this.invalidateElementVisibility()},handleLayerBoxChange:function(){this.invalidateElementVisibility()},handleLayerPropertyChange:function(a){"editable"===a.property&&this.invalidateSelectedElementUIs(!0),this.invalidateElementVisibility()},handleLayerHierarchyChange:function(){this.invalidateElementVisibility()},handleSelectionChange:function(a){var b=this.getSelectionModel().getLastData();b&&("append"===a.kind||"set"===a.kind)&&(this.isMakeVisibleOnSelected()&&this.makeVisible(b),this.isSendToTopOnSelected()&&this.sendToTop(b)),a.datas.forEach(function(b){var c=this.getElementUI(b);c&&c.handleSelectionChange(a),this.invalidateElementUI(b)},this),this.invalidateElementVisibility()},sendToTop:function(a){if(this._box.contains(a)){for(var b=a;b._parent&&this.isVisible(b._parent)&&(b=b._parent););b!==a&&this._box.adjustElementIndex(b),this._box.adjustElementIndex(a)}},getScopeRect:function(a){var b=this.getGraphicsZoom();if(this.zoomManager,"viewsize"===a)return{x:this._unionBounds.x-this.viewRect.x,y:this._unionBounds.y-this.viewRect.y,width:this._unionBounds.width,height:this._unionBounds.height};if("viewport"===a){if(this.viewRect)return Jb.cloneRect(this.viewRect)}else if("rootcanvas"===a)return{x:this.viewRect.x,y:this.viewRect.y,width:(Math.abs(this.viewRect.x-this._unionBounds.x)+this._unionBounds.width)*b,height:(Math.abs(this.viewRect.y-this._unionBounds.y)+this._unionBounds.height)*b};return{x:0,y:0,width:0,height:0}},getViewRect:function(){return this.viewRect?Jb.cloneRect(this.viewRect):{x:0,y:0,width:0,height:0}},getCanvasSize:function(){return{width:this.realWidth,height:this.realHeight}},setViewOffSet:function(a,b){var c=this.viewRect.x,d=this.viewRect.y,e=this.viewRect.width,f=this.viewRect.height;this.setViewRect(c+a,d+b,e,f)},setViewRect:function(a,b,c,d){1==this.isLimitViewInCanvas()&&(0>a&&(a=0),c>this.realWidth?a=0:a+c>this.realWidth&&(a=this.realWidth-c),0>b&&(b=0),d>this.realHeight?b=0:b+d>this.realHeight&&(b=this.realHeight-d));var e=this.viewRect;(null==this.viewRect||a!=this.viewRect.x||b!=this.viewRect.y||c!=this.viewRect.width||d!=this.viewRect.height)&&(this.viewRect={x:a,y:b,width:c,height:d},this.firePropertyChange("viewRect",e,this.viewRect),this.invalidateElementVisibility(),this._paintAll=!0)},isHScrollBarVisible:function(){return this.hScrollBarVisible},setHScrollBarVisible:function(a){this.hScrollBarVisible=a},isVScrollBarVisible:function(){return this.vScrollBarVisible},setVScrollBarVisible:function(a){this.vScrollBarVisible=a},setZoomVisibilityThresholds:function(a){var b=this._visibilityThresholds;this._zoomVisibilityThresholds=a,this.firePropertyChange("zoomVisibilityThresholds",b,a),this.invalidateElementVisibility()},getZoomVisibilityThresholds:function(){return this._zoomVisibilityThresholds||{}},invalidateElementVisibility:function(){this.invalidate()},repaintTopCanvas:function(){this._repaintTopFlag||(this._repaintTopFlag=!0,this.invalidate())},invalidateCanvasSize:function(a){this._invalidateCanvasSizeFlag||(this._invalidateCanvasSizeFlag=!0,this.invalidate())},validateCanvasSize:function(){0!=this._invalidateCanvasSizeFlag&&(this._invalidateCanvasSizeFlag=!1,this._validateCanvasSize())},_validateCanvasSize:function(){if(0==this.isAutoValidateCanvasSize())return this.realWidth=0,this.realHeight=0,void(this._unionBounds={x:0,y:0,width:0,height:0});var a,b=this.getElementBox().getDatas(),c=b.size();if(c>0){for(var d=0;c>d;d++){var e=b.get(d);if(this._visibleMap[e._id]){var f=this._elementUIMap[e._id];f&&(a=a?Tb.unionRect(a,f.getZoomViewRect(!0)):Jb.cloneRect(f.getZoomViewRect(!0)))}}null==a&&(a={x:0,y:0,width:0,height:0});var g=this.getGraphicsZoom();if(this.realWidth==(a.x+a.width)*g&&this.realHeight==(a.y+a.height)*g)return;this.realWidth=(a.x+a.width)*g,this.realHeight=(a.y+a.height)*g,this._unionBounds={x:a.x*g,y:a.y*g,width:a.width*g,height:a.height*g}}else this.realWidth=0,this.realHeight=0,this._unionBounds={x:0,y:0,width:0,height:0};this.setViewRect(this.viewRect.x,this.viewRect.y,this.viewRect.width,this.viewRect.height),this.firePropertyChange("canvasSizeChange",null,this.viewRect)},getElementUI:function(a){return null==a?null:this._elementUIMap[a._id]},getUnionBounds:function(){return this._unionBounds},getZoomBodyRect:function(a){var b=this.getElementUI(a);return b?b.getZoomBodyRect():null},getShapeNodeZoomPoints:function(a,b){if(a._points){var c=this.getElementUI(a);if(c)return c._getZoomPoints()}return null},createElementUI:function(a){var b=this._elementUIMap[a.getId()];if(!b){if(b=this._elementUIFunction(this,a),!b){var c=a.getClassName(),d=c.substr(c.indexOf(".")+1)+"UI",e=Ib.vector[d];e&&(b=new e(this,a))}b&&(this._elementUIMap[a.getId()]=b)}return this._invalidateMap&&(this._invalidateMap[a._id]=a),b},getElementUIFunction:function(){return this._elementUIFunction},setElementUIFunction:function(a){if(!a)throw"ElementUIFunction can not be null";if(this._elementUIFunction!==a){var b=this._elementUIFunction;this._elementUIFunction=a,this.firePropertyChange("elementUIFunction",b,a),this._box.isEmpty()||(this._elementUIMap={},this._box.forEach(this.createElementUI,this),this.invalidateElementVisibility(),this.invalidateCanvasSize())}},invalidateElementUI:function(a,b){if(!this._invalidateAll){if(this._invalidateMap[a._id]=a,this.getElementUI(a),a instanceof Ld){var c=a.getAgentLinks();null!=c&&c.forEach(this.invalidateElementUI,this);var d=a.getParent();d instanceof Ib.Group&&this.invalidateElementUI(d)}this.invalidateElementVisibility()}},invalidateElementUIs:function(a){this._invalidateAll=!0,this._invalidateMap={},this._visibleMap={},this.invalidateElementVisibility(),this.invalidateCanvasSize(),this.invalidate()},invalidateSelectedElementUIs:function(a){this.getSelectionModel().getSelection().forEach(function(b){this.invalidateElementUI(b,a)},this)},invalidateBundleLink:function(a){if(a instanceof Ib.Link&&a._bundleLinks){var b=this._elementUIMap;a._bundleLinks.forEachSiblingLink(function(c){if(c!==a){var d=b[c._id];d&&d.invalidate(!1)}},this)}},paintRoot:function(a){var c=this._rootCanvas.getContext("2d");c.save();var d=this.getGraphicsZoom();c.beginPath(),c.rect(Math.round(a.x*d-this.viewRect.x),Math.round(a.y*d-this.viewRect.y),Math.round(a.width*d),Math.round(a.height*d)),c.clip(),c.clearRect(Math.round(a.x*d-this.viewRect.x),Math.round(a.y*d-this.viewRect.y),Math.round(a.width*d),Math.round(a.height*d)),this.visibleList=new Ib.List,this._topAttachmentList=new Ib.List,ld.draw(c,this);var e=this.getElementBox().getDatas()._as,f=e.length,g=this.zoomManager;g._zoomGraphicsBegin(c),this.paintBottom(c,a);var h,i,j,k,l=this._box._layerBox,d=this.getGraphicsZoom(),m={x:this.viewRect.x/d,y:this.viewRect.y/d,width:this.viewRect.width/d,height:this.viewRect.height/d};if(this.adjustLinkIndex(),1===l.size())for(h=0;f>h;h++)i=e[h],this._visibleMap[i._id]?(j=this._elementUIMap[i._id],this._debug&&Xb.strokeRect(c,a,"red"),null!=j&&this._isInView(j,a)&&(j.paint(c),j.setAttachmentVisible&&j.setAttachmentVisible(!0)),null!=j&&Tb.intersects(m,j.getZoomViewRect())?j.setAttachmentVisible&&j.setAttachmentVisible(!0):j.setAttachmentVisible&&j.setAttachmentVisible(!1),this.visibleList.add(i)):(j=this._elementUIMap[i._id],j&&j.setAttachmentVisible&&j.setAttachmentVisible(!1));else l.forEachByDepthFirst(function(b){for(h=0;f>h;h++)i=e[h],l.getLayerByElement(i)===b&&this._visibleMap[i._id]?(j=this._elementUIMap[i._id],null!=j&&this._isInView(j,a)&&(j.paint(c),j.setAttachmentVisible&&j.setAttachmentVisible(!0)),null!=j&&Tb.intersects(m,j.getZoomViewRect())?j.setAttachmentVisible&&j.setAttachmentVisible(!0):j.setAttachmentVisible&&j.setAttachmentVisible(!1),j&&j.validateZIndex&&j.validateZIndex(l.getDatas().indexOf(b)),this.visibleList.add(i)):j=this._elementUIMap[i._id]},null,this);for(f=this._topAttachmentList.size(),h=0;f>h;h++)k=this._topAttachmentList.get(h),k.getElementUI().paintAttachment(c,k);if(this.paintTop(c,a),this._xyz!==b){var f,n=this._xyz,o=n.markText,p=n.type,q=(n.expired,n.innerHTML),r=0,s=0,t=this.viewRect;c.translate(this.viewRect.x/this.getZoom(),this.viewRect.y/this.getZoom()),c.scale(1/this.getZoom(),1/this.getZoom());var d=this.getZoom();o!=b&&null!=o&&""!=o||"2"==p?(c.font="15px Arial sans-serif",f=Jb.g.getTextSize(c.font,q),c.fillStyle="red",r=t.width-f.width,s=t.height-20):(c.font="10px Arial sans-serif",f=Jb.g.getTextSize(c.font,q),r=t.width/2-f.width/2,s=t.height/2),c.fillText(q,r,s)}c.restore(),this._invalidateMap={},this._invalidateAll=!1,this._paintAll=!1,this._dirtyRects=new nd},adjustLinkIndex:function(){var a,b,c=this._box.getDatas()._as,d=this.hasEditInteraction();if(d){for(i=0;i<c.length;i++)if(a=c[i],a instanceof Ib.Link)if(this.isEditable(a)&&this.getElementUI(a).isEditable()&&this.isSelected(a))b=this._box.getDatas().indexOf(a),this._box.getDatas().removeAt(b),this._box.getDatas().add(a);else{var e=a.getToNode();b=this._box.getDatas().indexOf(e),this._box.getDatas().removeAt(b),this._box.getDatas().add(e);var f=a.getFromNode();b=this._box.getDatas().indexOf(f),this._box.getDatas().removeAt(b),this._box.getDatas().add(f)}}else for(i=0;i<c.length;i++)if(a=c[i],a instanceof Ib.Link){var e=a.getToNode();b=this._box.getDatas().indexOf(e),this._box.getDatas().removeAt(b),this._box.getDatas().add(e);var f=a.getFromNode();b=this._box.getDatas().indexOf(f),this._box.getDatas().removeAt(b),this._box.getDatas().add(f)}},paintBottom:function(a,b){},paintTop:function(a,b){},_isInView:function(a,b){return Tb.intersects(b,a.getZoomViewRect())},paintTopCanvas:function(){var a=this._topCanvas.getContext("2d");a.clearRect(0,0,this._topCanvas.width,this._topCanvas.height),this.paintMarker(a)},paintMarker:function(a){for(var b=this.markerList.size(),c=0;b>c;c++){var d=this.markerList.get(c);d.paint(a)}},getLayerByElement:function(a){return this._box.getLayerBox().getLayerByElement(a)},getLogicalPoint2:function(a){return this.zoomManager._getLogicalPoint(a)},getLogicalPoint:function(a){return this.zoomManager._getLogicalPoint(a,!0)},getElementAt:function(a){if(null==this.visibleList)return null;var b;if(a.target?b=this.getLogicalPoint2(a):a.event?a.event.target&&(b=this.getLogicalPoint2(a.event)):b=a,null!=this._hitTestTopAttachmentList)for(var c=this._hitTestTopAttachmentList.size(),d=c-1;d>=0;d--){var e=this._hitTestTopAttachmentList.get(d);if(e.hit(b.x,b.y))return e.getElement()}if(null!=this.visibleList)for(var f=this.visibleList.size(),g=f-1;g>=0;g--){var h=this.visibleList.get(g),i=this.getElementUI(h);if(i&&i.hit(b.x,b.y))return h}return null},hitTest:function(a){var b=this.getElementAt(a);if(!b)return null;var c=this.getElementUI(b);if(!c)return null;var d;return d=a.target?this.getLogicalPoint2(a):a.event?this.getLogicalPoint2(a.event):a,c.hitTest(d.x,d.y)},getElementsAtRect:function(a,c,d,e){var f=new Ib.List;if(null==this.visibleList)return f;e=e===b?!0:e;for(var g=this.visibleList.size(),h=g-1;h>=0;h--){var i=this.visibleList.get(h),j=this.getElementUI(i);j&&(!d||d(j._element))&&(e&&this.isSelectable(j._element)||!e)&&(c?j.intersects(a)&&f.add(i):Tb.contains(a,j.getZoomViewRect(lc))&&f.add(i))}return f},getPosition:function(a,b,c,d,e,f){var g,h=b instanceof Ib.vector.ElementUI?b:this.getElementUI(b);if(h)if("from"===a||"to"===a){if(h.getFromPosition&&(g="from"===a?h.getFromPosition(d,e):h.getToPosition(d,e)))return c?{x:g.x-c.width/2,y:g.y-c.height/2}:g}else g="hotspot"===a?f?h.getZoomHotSpot(this.zoomManager):h.getHotSpot():Vb.get(a,f?h.getZoomBodyRect():h.getBodyRect(),c);if(!g&&b.getRect&&(g=Vb.get(a,b.getRect(),c)),g)return{x:g.x+d,y:g.y+e};throw"position '"+a+"' object '"+b+"'"},isValidEvent:function(a){if(!a)return!1;var b,c;if(a.currentTarget===this._view){if(Qb.isFirefox?(b=a.layerX,c=a.layerY):(b=a.offsetX,c=a.offsetY),1==this.isHScrollBarVisible()&&c>=this.viewRect.height-this.getScrollBarWidth())return!1;if(1==this.isVScrollBarVisible()&&b>=this.viewRect.width-this.getScrollBarWidth())return!1}return!0},addMarker:function(a){this.markerList.add(a),this.repaintTopCanvas()},removeMarker:function(a){this.markerList.remove(a),
this.repaintTopCanvas()},clearMarker:function(){this.markerList.clear(),this.repaintTopCanvas()},isMovable:function(a){return this._box.contains(a)&&a.isMovable()?a instanceof Ib.Link?!1:this._movableFunction&&!this._movableFunction(a)?!1:this.getLayerByElement(a).isMovable():!1},hasMovableSelectedElements:function(){for(var a=this.getSelectionModel().getSelection(),b=0;b<a.size();b++){var c=a.get(b);if(this.isMovable(c))return!0}return!1},getMovableSelectedElements:function(){return this.getSelectionModel().toSelection(function(a){return this.isMovable(a)},this)},moveSelectedElements:function(a,b,c,d){if(0!==a||0!==b){var e=this.getMovableSelectedElementsRect();null!=e&&(this._limitElementInPositiveLocation&&(e.x+a<0&&(a=-e.x),e.y+b<0&&(b=-e.y)),Ib.Util.moveElements(this.getMovableSelectedElements(),a,b,c,d,this))}},getMovableSelectedElementsRect:function(){var a=this.getMovableSelectedElements();if(0===a.size())return null;for(var b=null,c=0,d=a.size();d>c;c++){var e=a.get(c);if(e instanceof Ld){var f=this.getElementUI(e);f&&(b=Tb.unionRect(b,f.getViewRect()))}}return b},isVisibleAttachment:function(a){return!this.state.zooming&&!this.state.panning&&!this.state.layouting},isVisible:function(a,b,c){if(!this._box.contains(a))return!1;if(!a.isVisible())return!1;if(3!==arguments.length&&(b=this._visibleFunction),b&&!b(a))return!1;if(!(c||this._box._layerBox.getLayerByElement(a))._visible)return!1;if(vc.getSubNetwork(a)!==this._currentSubNetwork)return!1;if(!this.zoomManager.isElementVisible(a))return!1;if(a instanceof Ib.Link){if(!this._noAgentLinkVisible){if(!a._fromAgent||!a._toAgent)return!1;if(!this.isVisible(a._fromAgent,b,c)||!this.isVisible(a._toAgent,b,c))return!1}if(a.getBundleIndex()>0&&a.getBundleCount()>1&&!a.getStyle("link.bundle.expanded"))return!1}else for(var d=a._parent;d&&!d.ISubNetwork;){if(d instanceof Ib.Group&&(!d.isExpanded()||!this.isVisible(d,b,c)))return!1;d=d._parent}return a.IDummy?!1:!0},getVisibleFunction:function(){return this._visibleFunction},setVisibleFunction:function(a){var b=this._visibleFunction;this._visibleFunction=a,this.firePropertyChange("visibleFunction",b,a),this.invalidateElementVisibility()},isEditable:function(a){return this._box.contains(a)?this._editableFunction&&!this._editableFunction(a)?!1:this.getLayerByElement(a).isEditable():!1},getEditableFunction:function(){return this._editableFunction},setEditableFunction:function(a){var b=this._editableFunction;this._editableFunction=a,this.firePropertyChange("editableFunction",b,a),this.invalidateSelectedElementUIs(!0)},isRotatable:function(a){return this._rotatableFunction&&!this._rotatableFunction(a)?!1:!0},getRotatableFunction:function(){return this._rotatableFunction},setRotatableFunction:function(a){var b=this._rotatableFunction;this._rotatableFunction=a,this.firePropertyChange("rotatableFunction",b,a),this.invalidateSelectedElementUIs(!0)},isLinkable:function(a,b){return null==this._linkableFunction||this._linkableFunction(a,b)},getLinkableFunction:function(){return this._linkableFunction},setLinkableFunction:function(a){var b=this._linkableFunction;this._linkableFunction=a,this.firePropertyChange("linkableFunction",b,a),this.invalidateSelectedElementUIs(!0)},onShareSelectionModelChanged:function(){this.invalidateElementUIs()},getShadowColor:function(a){var b=a.getStyle("shadow.color");return!b&&this.isSelected(a)&&"shadow"===a.getStyle("select.style")?a.getStyle("select.color"):b},getSelectColor:function(a){return a.getStyle("select.color")},getAlarmLabel:function(a){var b=a.getAlarmState().getHighestNewAlarmSeverity();if(b){var c=a.getAlarmState().getNewAlarmCount(b)+b.nickName;return a.getAlarmState().hasLessSevereNewAlarms()&&(c+="+"),c}return null},getLinkHandlerLabel:function(a){return a.isBundleAgent()?"+("+a.getBundleCount()+")":null},setInteractions:function(a){var b=this._interactions;b&&b.forEach(function(a){a.tearDown()}),this._interactions=a,a&&a.forEach(function(a){a.setUp()}),this.invalidateSelectedElementUIs(!0),this.firePropertyChange("interactions",b,a)},getInteractions:function(){return this._interactions},setDefaultInteractions:function(a){this.setInteractions([new Ib.vector.interaction.DefaultInteraction(this,a)])},setTouchInteractions:function(){this.setInteractions([new Ib.vector.interaction.DefaultInteraction(this,!1),new Ib.vector.interaction.TouchInteraction(this)])},setMSTouchInteractions:function(){this.setInteractions([new Ib.vector.interaction.MSTouchInteraction(this)])},setEditInteractions:function(a){this.setInteractions([new Ib.vector.interaction.EditInteraction(this,a),new Ib.vector.interaction.DefaultInteraction(this)])},setCreateElementInteractions:function(a){this.setInteractions([new Ib.vector.interaction.CreateElementInteraction(this,a),new Ib.vector.interaction.DefaultInteraction(this)])},setCreateLinkInteractions:function(a){this.setInteractions([new Ib.vector.interaction.CreateLinkInteraction(this,a),new Ib.vector.interaction.DefaultInteraction(this)])},setCreateShapeLinkInteractions:function(a){this.setInteractions([new Ib.vector.interaction.CreateShapeLinkInteraction(this,a),new Ib.vector.interaction.DefaultInteraction(this)])},setCreateShapeNodeInteractions:function(a){this.setInteractions([new Ib.vector.interaction.CreateShapeNodeInteraction(this,a),new Ib.vector.interaction.DefaultInteraction(this)])},setMagnifyInteractions:function(){this.setInteractions([new Ib.vector.interaction.DefaultInteraction(this),new Ib.vector.interaction.MagnifyInteraction(this)])},hasEditInteraction:function(){return this._hasEditInteraction},setHasEditInteraction:function(a){var b=this._hasEditInteraction;this._hasEditInteraction=a,this.firePropertyChange("hasEditInteraction",b,a)},addElementByInteraction:function(a){a.getParent()||a.setParent(this._currentSubNetwork),this._box.add(a),this.getSelectionModel().setSelection(a),this.fireInteractionEvent({kind:"createElement",element:a})},getToolTip:function(a){if(a){var b=a.getToolTip();return b?b:a.getName()}return null},isToolTipEnabled:function(){return this._toolTipEnabled?!0:!1},setToolTipEnabled:function(a){if(this._toolTipEnabled=a,a){if(!this._toolTipListener){var b=this;this._toolTipListener=function(a){if(b.isMovingElement())return void Bc.hideToolTip();var c=b.getElementAt(a);if(b._preElement!==c)if(b._preElement=c,c){var d=b.getToolTip(c);Bc.showToolTip({x:a.pageX,y:a.pageY},d);var e=Bc.getToolTipDiv();if(e.children.length>0){var f=b._view.getBoundingClientRect(),g=e.getBoundingClientRect();g.width+g.left>f.width+f.left&&(e.style.left=f.width+f.left-g.width+(Ob.documentElement.scrollLeft||Ob.body.scrollLeft)+"px"),g.height+g.top>f.height+f.top&&(e.style.top=f.height+f.top-g.height+(Ob.documentElement.scrollTop||Ob.body.scrollTop)+"px")}}else Bc.hideToolTip()},this._view.addEventListener("mousemove",this._toolTipListener,!1),this.firePropertyChange("toolTipEnabled",!1,!0)}}else this._toolTipListener&&(Bc.hideToolTip(),this._view.removeEventListener("mousemove",this._toolTipListener,!1),delete this._toolTipListener,this.firePropertyChange("toolTipEnabled",!0,!1))},setZoom:function(a,b){if(a=this.checkZoom(a),this.isAsyncZoomAndViewRect())var c=this._zoomMap[this._currentSubNetwork].zoom;else var c=this._zoom;if(a!=c){var d=this.getViewRect();b||(b={x:d.width/2,y:d.height/2});var e=this.viewRect,f=b.x-(b.x+e.x)*a/c,g=b.y-(b.y+e.y)*a/c;this.isAsyncZoomAndViewRect()?this._zoomMap[this._currentSubNetwork].zoom=a:this._zoom=a,this._paintAll=!0,this.invalidateElementVisibility(),this.invalidateCanvasSize(),this.zoomManager._invalidateZoom(),this.setViewRect(-f,-g,this.viewRect.width,this.viewRect.height),this._asyncZoomAndViewRect?this.firePropertyChange("zoom",c,this._zoomMap[this._currentSubNetwork].zoom):this.firePropertyChange("zoom",c,this._zoom),this.state.zooming=!0;var h=null,i=this;h?clearTimeout(h):h=setTimeout(function(){h=null,i.state.zooming=!1,i.invalidateElementUIs(!0)},100)}},getZoom:function(){if(this.isAsyncZoomAndViewRect()){var a=this._zoomMap[this._currentSubNetwork];return a||(this._zoomMap[this._currentSubNetwork]={zoom:1}),this._zoomMap[this._currentSubNetwork].zoom}return this._zoom},getSizeZoom:function(a){return this.zoomManager.getSizeZoom(a)},getLocationZoom:function(){return this.zoomManager.getLocationZoom()},getGraphicsZoom:function(){return this.zoomManager.getGraphicsZoom()},zoomOverview:function(a){if(!(this._unionBounds.width<=0||this._unionBounds.width<=0)){var b=this.getZoom(),c=this._unionBounds,d=c.width/b,e=c.height/b,f=this.viewRect.width/d,g=this.viewRect.height/e,h=Math.min(f,g);this.setZoom(h);var i=this.getZoom(),j=this.viewRect.width/2-this._unionBounds.width/2*i/b,k=this.viewRect.height/2-this._unionBounds.height/2*i/b;if(this.setViewRect(this._unionBounds.x*i/b-j,this._unionBounds.y*i/b-k,this.viewRect.width,this.viewRect.height),1!=this.getLocationZoom()){var l=null==arguments[1]?5:arguments[1];if(l>0){l--;var m=this;setTimeout(function(){m.zoomOverview(a,l)},25)}}}},zoomReset:function(a){this.setZoom(1,a)},zoomIn:function(a){this.setZoom(1.2*this.getZoom(),a)},zoomOut:function(a){this.setZoom(this.getZoom()/1.2,a)},upSubNetwork:function(a,b){this._currentSubNetwork&&this.setCurrentSubNetwork(vc.getSubNetwork(this._currentSubNetwork),a,b)},getCurrentSubNetwork:function(){return this._currentSubNetwork},setCurrentSubNetwork:function(a,b,c){if(Ib.animate.AnimateManager.endAnimate(),b){if(this._currentSubNetwork===a)return;if(a&&!this._box.contains(a))throw a+" is not contained in this network's elementBox";var d=new Ib.animate.AnimateSubNetwork(this,a,c);Ib.animate.AnimateManager.start(d)}else this._setCurrentSubNetwork(a),c&&c()},_setCurrentSubNetwork:function(a){if(this._currentSubNetwork!==a){if(a&&!this._box.contains(a))throw a+" is not contained in this network's elementBox";if(this.isAsyncZoomAndViewRect()){var b=this._viewRectMap[this._currentSubNetwork];this._viewRectMap[this._currentSubNetwork]=b?this.viewRect:this.viewRect?this.viewRect:{x:0,y:0,width:this.viewRect.width,height:this.viewRect.height}}var c=this._currentSubNetwork;if(this._currentSubNetwork=a,this.firePropertyChange("currentSubNetwork",c,a),this.isAsyncZoomAndViewRect()){this._viewRectMap[this._currentSubNetwork]||(this._viewRectMap[this._currentSubNetwork]={x:0,y:0,width:this.viewRect.width,height:this.viewRect.height});var b=this._viewRectMap[this._currentSubNetwork];this.setViewRect(b.x,b.y,b.width,b.height),this.invalidateElementUIs()}this.invalidateElementVisibility(),this.invalidateCanvasSize(),this._paintAll=!0}},makeVisible:function(a){var b=this.getElementUI(a);if(b){var c=vc.getSubNetwork(a);if(c!==this._currentSubNetwork){var d=this;return void this.setCurrentSubNetwork(c,this.isSubNetworkAnimate(),function(){Jb.callLater(d.makeVisible,d,[a])})}for(var e=a;(e=e.getParent())&&e!==c;)e instanceof Ib.Group&&e.setExpanded(!0);var f=b.getViewRect();if(f){var g,h=b.getZoomViewRect(this.zoomManager);g=f.x==h.x&&f.y==h.y&&f.width==h.width&&f.height==h.height?{x:f.x*this.getGraphicsZoom(),y:f.y*this.getGraphicsZoom(),width:f.width*this.getGraphicsZoom(),height:f.height*this.getGraphicsZoom()}:h,Tb.intersects(this.viewRect,g)||this.isVisible(a)&&Jb.callLater(this.centerByLogicalPoint,this,[g.x+g.width/2,g.y+g.height/2])}}},centerByLogicalPoint:function(a,b,c){var d=a-this.viewRect.width/2,e=b-this.viewRect.height/2;this.setViewRect(d,e,this.viewRect.width,this.viewRect.height)},panByOffset:function(a,b){this.setViewOffSet(a,b)},getIconsNames:function(a){return a.getStyle("icons.names")},getIconsColors:function(a){return a.getStyle("icons.colors")},getLinkFlowStepping:function(a){var b=parseInt(a.getStyle("link.flow.stepping"));return b||(b=Ed.NETWORK_LINK_FLOW_STEPPING),b},getLinkFlowOffset:function(a){var b=a.getStyle("link.flow.offset");return isNaN(b)&&(b=0),b+this.getLinkFlowStepping(a)},toCanvas:function(a,b,c,d,e,f){c||(c=Wb.createCanvas()),c.setAttribute("width",a),c.setAttribute("height",b),c._viewRect?(c._viewRect.width=a,c._viewRect.height=b):c._viewRect={x:0,y:0,width:a,height:b};var g=c.getContext("2d");if(g.translate(-e,-f),g.clearRect(0,0,a,b),ld.draw(g,this),0===this._view.clientWidth||0===this._view.clientHeight)return c;a/this.realWidth*this.getGraphicsZoom(),b/this.realHeight*this.getGraphicsZoom(),g.scale(d,d);var h=this.getElementBox().getDatas()._as,i=h.length;this._topAttachmentList=new Ib.List;var j,k,l,m,n,o,p=this.getElementBox().getLayerBox(),q=p.getRoots(),r=q.size();if(this.adjustLinkIndex(),1===r)for(l=0;i>l;l++)m=h[l],this._visibleMap[m._id]&&(n=this._elementUIMap[m._id],null!=n&&n.paint(g));else for(j=0;r>j;j++)for(k=q.get(j),l=0;i>l;l++)m=h[l],p.getLayerByElement(m)===k&&this._visibleMap[m._id]&&(n=this._elementUIMap[m._id],null!=n&&n.paint(g));for(i=this._topAttachmentList.size(),l=0;i>l;l++)o=this._topAttachmentList.get(l),o.getElementUI().paintAttachment(g,o);return c},toCanvasByRegion:function(a,b,c){c||(c=Wb.createCanvas());var d=a.width*b,e=a.height*b;c.setAttribute("width",d),c.setAttribute("height",e),c._viewRect?(c._viewRect.width=d,c._viewRect.height=e):c._viewRect={x:0,y:0,width:d,height:e};var f=c.getContext("2d");if(f.clearRect(0,0,d,e),ld.draw(f,this),0===this._view.clientWidth||0===this._view.clientHeight)return c;f.save(),f.scale(b,b),f.beginPath(),f.translate(-a.x,-a.y);var g=this.getElementBox().getDatas()._as,h=g.length;this._topAttachmentList=new Ib.List;var i,j,k,l,m,n,o=this.getElementBox().getLayerBox(),p=o.getRoots(),q=p.size();if(this.adjustLinkIndex(),1===q)for(k=0;h>k;k++)l=g[k],this._visibleMap[l._id]&&(m=this._elementUIMap[l._id],null!=m&&Tb.intersects(a,m.getZoomViewRect())&&m.paint(f));else for(i=0;q>i;i++)for(j=p.get(i),k=0;h>k;k++)l=g[k],o.getLayerByElement(l)===j&&this._visibleMap[l._id]&&(m=this._elementUIMap[l._id],null!=m&&Tb.intersects(a,m.getZoomViewRect())&&m.paint(f));for(h=this._topAttachmentList.size(),k=0;h>k;k++)n=this._topAttachmentList.get(k),n.getElementUI().paintAttachment(f,n);return f.restore(),c},getGroupChildrenRects:function(a){return this.zoomManager._getGroupChildrenRects(a)},convertPointFromView:function(a){return this.zoomManager._convertPointFromView(a)},getOffset:function(a,b){return this.zoomManager._getOffset(a,b)},panToCenter:function(){this.setViewRect((this.realWidth-this.viewRect.width)/2,(this.realHeight-this.viewRect.height)/2,this.viewRect.width,this.viewRect.height)},moveElementsToCenter:function(){if(this._limitViewInCanvas){var a=this.viewRect,b=this._unionBounds,c=a.x+a.width/2-b.x-b.width/2,d=a.y+a.height/2-b.y-b.height/2;Ib.Util.moveElements(this._box.toDatas(),c,d)}else{var c=this.viewRect.width/2-this._unionBounds.width/2,d=this.viewRect.height/2-this._unionBounds.height/2;this.setViewRect(this._unionBounds.x-c,this._unionBounds.y-d,this.viewRect.width,this.viewRect.height)}},getLinkPathFunction:function(){return this._linkPathFunction},setLinkPathFunction:function(a){var b=this._linkPathFunction;this._linkPathFunction=a,this.firePropertyChange("linkPathFunction",b,a),this.invalidateElementUIs()},invalidate:function(){this._invalidate||(this._invalidate=!0,this.fireViewEvent({kind:"invalidate"}))},validate:function(){this._invalidate&&(Mb||0!==this._view.offsetWidth||0!==this._view.offsetHeight)&&(this._invalidate=!1,this._isValidating=!0,this.fireViewEvent({kind:"validateStart"}),this.validateImpl(),this.fireViewEvent({kind:"validateEnd"}),this._isValidating=!1)},onClickElement:function(a,b){},onClickBackground:function(a){},onDoubleClickElement:function(a,b){},onDoubleClickBackground:function(a){},onLongClickElement:function(a,b){},onLongClickBackground:function(a){},onMouseMove:function(a,b){},onMouseEnter:function(a,b){},onMouseLeave:function(a,b){},setMovingElement:function(a){if(a!=this._movingElement){var b=this._movingElement;this._movingElement=a,this.firePropertyChange("movingElement",b,a),this._box._undoManager._enabled&&(a?this._box._undoManager.startBatch():this._box._undoManager.endBatch())}},setEditingElement:function(a){if(a!=this._editingElement){var b=this._editingElement;this._editingElement=a,this.firePropertyChange("editingElement",b,a),this._box._undoManager._enabled&&(a?this._box._undoManager.startBatch():this._box._undoManager.endBatch())}},dispose:function(){Ib.imageUtil.removeEventListener(this.invalidateElementUIs,this),this.setInteractions(null),cancelAnimationFrame(this._loopId)}}),Ib.vector.Overview=function(a){Ib.vector.Overview.superClass.constructor.apply(this,a),this._view=Wb.createView(),this._rootDiv=Wb.createDiv(),this._imageCanvas=Wb.createCanvas(),this._imageDiv=Wb.createDiv(),this._maskCanvas=Wb.createCanvas(),this._selectDiv=Wb.createDiv(),this._isNetworkDirty=!1,this._isMaskDirty=!1,Wb.setVisible(this._selectDiv,!1),this._view.appendChild(this._rootDiv),this._rootDiv.appendChild(this._imageDiv),this._rootDiv.appendChild(this._maskCanvas),this._rootDiv.appendChild(this._selectDiv),this._imageDiv.appendChild(this._imageCanvas),this._exportImageCanvas=Wb.createCanvas(),this._imageCtx=this._imageCanvas.getContext("2d"),this.setNetwork(a),Qb.isTouchable?Qb.isMSTouchable?new Ib.vector.OverviewMSTouchInteraction(this):(new Ib.vector.OverviewTouchInteraction(this),new Ib.vector.OverviewInteraction(this)):new Ib.vector.OverviewInteraction(this)},Jb.ext("twaver.vector.Overview",Ib.controls.ControlBase,{__accessor:["fillColor","outlineColor","outlineWidth","selectColor","selectWidth","padding","maxPackingWidth","maxPackingHeight"],__bool:["animate"],_fillColor:Ed.OVERVIEW_FILL_COLOR,_outlineColor:Ed.OVERVIEW_OUTLINE_COLOR,_outlineWidth:Ed.OVERVIEW_OUTLINE_WIDTH,_selectColor:Ed.OVERVIEW_SELECT_COLOR,_selectWidth:Ed.OVERVIEW_SELECT_WIDTH,_padding:Ed.OVERVIEW_PADDING,_animate:Ed.OVERVIEW_ANIMATE,_maxPackingWidth:Ed.OVERVIEW_MAX_PACKING_WIDTH,_maxPackingHeight:Ed.OVERVIEW_MAX_PACKING_HEIGHT,getNetwork:function(){return this._network},onPropertyChanged:function(a){this._invalidateMask()},setNetwork:function(a){a!==this._network&&(this._network&&(this._network.removePropertyChangeListener(this._handleNetworkPropertyChange,this),this._network.removeViewListener(this._handleNetworkViewChange,this),Wb.removeEventListener("scroll","_handleScrollChange",this._network.getView(),this)),this._network=a,this._network&&(this._network.addPropertyChangeListener(this._handleNetworkPropertyChange,this),this._network.addViewListener(this._handleNetworkViewChange,this),Wb.addEventListener("scroll","_handleScrollChange",this._network.getView(),this)),this.invalidate())},_handleNetworkPropertyChange:function(a){("zoom"===a.property||"currentSubNetwork"===a.property||"elementBox"===a.property||"dataBox"===a.property||"canvasSizeChange"===a.property)&&this.invalidate()},_handleNetworkViewChange:function(a){"validateEnd"===a.kind&&this.invalidate()},_handleScrollChange:function(){this._invalidateMask()},invalidate:function(a){this._isNetworkDirty&&this._isMaskDirty||(this._isNetworkDirty||(this._isNetworkDirty=!0),this._isMaskDirty||(this._isMaskDirty=!0),Jb.callLater(this.validate,this,null,a))},_invalidateMask:function(){this._isMaskDirty||(this._isMaskDirty=!0,Jb.callLater(this.validate,this,[],100))},validate:function(){if((this._isMaskDirty||this._isNetworkDirty)&&this._network&&(this._maxPackingWidth>0&&this._maxPackingHeight>0||this._view.clientWidth>0&&this._view.clientHeight>0)&&0!==this._network.getViewRect().width&&0!==this._network.getViewRect().height&&!this._network._invalidate){var a,b=this._maxPackingWidth>0&&this._maxPackingHeight>0;a=b?{x:0,y:0,width:this._maxPackingWidth,height:this._maxPackingHeight}:{x:0,y:0,width:this._view.clientWidth,height:this._view.clientHeight},Tb.grow(a,-this._padding,-this._padding),b&&(Wb.setDiv(this._view,{x:0,y:0,width:this._imageDiv._viewRect.width,height:this._imageDiv._viewRect.height},null,0,null),a.width=this._imageDiv._viewRect.width,a.height=this._imageDiv._viewRect.height);var c=this._network.getGraphicsZoom(),d=this._network._unionBounds;d=Tb.unionRect(d,{x:0,y:0,width:d.x,height:d.y}),d={x:d.x/c,y:d.y/c,width:d.width/c,height:d.height/c};var e={x:this._network.viewRect.x/c,y:this._network.viewRect.y/c,width:this._network.viewRect.width/c,height:this._network.viewRect.height/c},f=Tb.unionRect(d,e),g=Math.min(a.width/f.width,a.height/f.height),h=f.width*g,i=f.height*g,j=f.width*g,k=f.height*g,l=a.x+(a.width-j)/2,m=a.y+(a.height-k)/2;if(this._isNetworkDirty){var n={x:l,y:m,width:j,height:k};this._network.toCanvas(h,i,this._exportImageCanvas,g,f.x*g,f.y*g),this._imageCanvas.setAttribute("width",j),this._imageCanvas.setAttribute("height",k),this._imageCtx.drawImage(this._exportImageCanvas,0,0,h,i),Wb.setDiv(this._imageDiv,n,null,0,null),this._network.getElementBox&&(this._imageDiv.style.backgroundColor=(this._network.getCurrentSubNetwork()||this._network.getElementBox()).getStyle("background.color")||""),this._isNetworkDirty=!1}if(this._isMaskDirty){var o={x:(e.x-f.x)*g,y:(e.y-f.y)*g,width:e.width*g,height:e.height*g},p=Wb.setCanvas(this._maskCanvas,l,m,j,k);p.lineWidth=0,p.fillStyle=this._fillColor,Xb.drawVector(p,"rectangle",null,l,m,j,k),p.closePath(),p.fill(),p.stroke(),p.clearRect(l+o.x,m+o.y,o.width,o.height),p.lineWidth=this._outlineWidth,p.strokeStyle=this._outlineColor;var q=o.width-2*this._outlineWidth,r=o.height-2*this._outlineWidth;q=Math.min(q,j-2-o.x-this._outlineWidth),r=Math.min(r,k-2-o.y-this._outlineWidth),Xb.drawVector(p,"rectangle",null,l+o.x+this._outlineWidth,m+o.y+this._outlineWidth,q,r),p.closePath(),p.stroke(),this._isMaskDirty=!1}}else this._isNetworkDirty=!1,this._isMaskDirty=!1},getLogicalPoint:function(a){return Wb.getLogicalPoint(this._view,a,1,this._rootDiv)},centerNetwork:function(a,b){var c=this._imageDiv._viewRect;if(Tb.containsPoint(c,a)){var d=this._network.getGraphicsZoom(),e=this._network._unionBounds;e=Tb.unionRect(e,{x:0,y:0,width:e.x,height:e.y}),e={x:e.x/d,y:e.y/d,width:e.width/d,height:e.height/d};var f={x:this._network.viewRect.x/d,y:this._network.viewRect.y/d,width:this._network.viewRect.width/d,height:this._network.viewRect.height/d},g=Tb.unionRect(e,f);this._network.centerByLogicalPoint((g.x+(a.x-c.x)/c.width*g.width)*d,(g.y+(a.y-c.y)/c.height*g.height)*d,b),this._invalidateMask()}}}),Ib.vector.OverviewTouchInteraction=function(a){this.overview=a,this.network=a.getNetwork(),this.view=a._view,Wb.addEventListener("touchstart","handleTouchstart",this.view,this)},Jb.ext("twaver.vector.OverviewTouchInteraction",Object,{handleTouchstart:function(a){Wb.preventDefault(a),this.clear(),this.endPoint=this.overview.getLogicalPoint(a),zc.isMultiTouch(a)&&(this.distance=zc.getDistance(a),this.zoom=this.network.getZoom()),Wb.addEventListener("touchmove","handleTouchmove",this.view,this),Wb.addEventListener("touchend","handleTouchend",this.view,this)},handleTouchmove:function(a){if(this.moved||(this.moved=!0),this.endPoint=this.overview.getLogicalPoint(a),zc.isSingleTouch(a))this.overview.centerNetwork(this.endPoint,!1);else if(this.distance){var b=zc.getDistance(a)/this.distance;this.network.setZoom(this.zoom*b,!1)}},handleTouchend:function(a){if(!this.moved){this.endPoint=this.overview.getLogicalPoint(a);var b=this.lastPoint&&this.lastTouchStartTime&&(new Date).getTime()-this.lastTouchStartTime.getTime()<=300&&Math.abs(this.endPoint.x-this.lastPoint.x)<=10&&Math.abs(this.endPoint.y-this.lastPoint.y)<=10;b?(this.lastPoint=null,this.lastTouchStartTime=null):(this.lastPoint=this.endPoint,this.lastTouchStartTime=new Date),b?Jb.callLater(this.network.zoomReset,this.network,[this.overview._animate]):this.overview.centerNetwork(this.endPoint,this.overview._animate)}this.clear()},clear:function(){this.endPoint&&(this.endPoint=null,Wb.removeEventListener("touchmove",this.view,this),Wb.removeEventListener("touchend",this.view,this)),this.moved=!1}}),Ib.vector.OverviewMSTouchInteraction=function(a){this.overview=a,this.network=a.getNetwork(),this.view=a._view,this._pointerMap={},this._pointerIdArray=[],Wb.addEventListener("MSPointerDown","handleTouchstart",this.view,this),Wb.addEventListener("MSPointerMove","handleTouchmove",this.view,this),Wb.addEventListener("MSPointerUp","handleTouchend",this.view,this),Wb.addEventListener("MSPointerCancel","handleTouchend",this.view,this)},Jb.ext("twaver.vector.OverviewMSTouchInteraction",Object,{handleTouchstart:function(a){Wb.preventDefault(a),a.isPrimary&&this._pointerIdArray.length>0&&(this._pointerMap={},this._pointerIdArray=[]),!this._pointerMap[a.pointerId]&&this.overview.getLogicalPoint(a)&&(this._pointerIdArray.push(a.pointerId),this._pointerMap[a.pointerId]=a),1==this._pointerIdArray.length?(this._startTouchPoint=this.overview.getLogicalPoint(a),this._startTouchTime=new Date):2==this._pointerIdArray.length&&(this._distance=this._getDistance(),this._zoom=this.network.getZoom())},handleTouchmove:function(a){if(0!=this._pointerIdArray.length&&this._pointerMap[a.pointerId]&&!(Tb.getDistance({x:this._pointerMap[a.pointerId].pageX,y:this._pointerMap[a.pointerId].pageY},{x:a.pageX,y:a.pageY})<=10))if(this._pointerMap[a.pointerId]=a,2==this._pointerIdArray.length){var b=this._getDistance()/this._distance;this.network.setZoom(this._zoom*b,!1)}else if(1==this._pointerIdArray.length&&this._startTouchPoint){var c=this.overview.getLogicalPoint(a);if(null==c)return;this._startTouchPoint=c,this.overview.centerNetwork(this._startTouchPoint,!1)}},handleTouchend:function(a){var b=this.overview.getLogicalPoint(a);if(1==this._pointerIdArray.length&&b){var c=this._endTouchPoint&&this._endTouchTime&&(new Date).getTime()-this._endTouchTime.getTime()<=500&&Tb.getDistance(this._endTouchPoint,b)<=10;c?(this._endTouchPoint=null,this._endTouchTime=null):(this._endTouchPoint=b,this._endTouchTime=new Date),c?Jb.callLater(this.network.zoomReset,this.network,[this.overview._animate]):this.overview.centerNetwork(this._endTouchPoint,this.overview._animate)}this._pointerMap={},this._pointerIdArray=[]},_getDistance:function(){return Tb.getDistance({x:this._pointerMap[this._pointerIdArray[0]].pageX,y:this._pointerMap[this._pointerIdArray[0]].pageY},{x:this._pointerMap[this._pointerIdArray[1]].pageX,y:this._pointerMap[this._pointerIdArray[1]].pageY})}}),Ib.vector.OverviewInteraction=function(a){this.overview=a,this.network=a.getNetwork(),this.view=a._view,Wb.addEventListener("mousedown","handleMousedown",this.view,this)},Jb.ext("twaver.vector.OverviewInteraction",Object,{handleMousedown:function(a){this.clear(),this.endPoint=this.overview.getLogicalPoint(a),Jb.isCtrlDown(a)&&(this.startPoint=this.endPoint,Wb.setVisible(this.overview._selectDiv,!0)),Wb.addEventListener("mousemove","handleMousemove",this.view,this),Wb.addEventListener("mouseup","handleMouseup",this.view,this)},handleMouseup:function(a){if(this.endPoint=this.overview.getLogicalPoint(a),"detail"in a&&2===a.detail)Jb.callLater(this.network.zoomReset,this.network,[this.endPoint,this.overview._animate]);else if(Wb.isVisible(this.overview._selectDiv)&&this.startPoint){var b=this.overview._imageDiv._viewRect,c=this.overview._selectDiv._viewRect.x,d=this.overview._selectDiv._viewRect.y,e=b.width/this.overview._selectDiv._viewRect.width,f=b.height/this.overview._selectDiv._viewRect.height,g=Math.min(e,f);this.network.setZoom(g*Math.min(this.network.getViewRect().width/this.network.getCanvasSize().width,this.network.getViewRect().height/this.network.getCanvasSize().height)*this.network.getZoom(),!1);var h=this.network.getCanvasSize().width*((c-b.x+this.overview._selectDiv._viewRect.width/2)/b.width),i=this.network.getCanvasSize().height*((d-b.y+this.overview._selectDiv._viewRect.height/2)/b.height);Jb.callLater(this.network.centerByLogicalPoint,this.network,[h,i,this.overview._animate]),Wb.setVisible(this.overview._selectDiv,!1),Wb.setDiv(this.overview._selectDiv,{x:0,y:0,width:0,height:0},null,0,null),this.startPoint=null}else this.overview.centerNetwork(this.endPoint,this.overview._animate);this.clear()},handleMousemove:function(a){var b=this.overview.getLogicalPoint(a);if(this.endPoint=b,Wb.isVisible(this.overview._selectDiv)&&this.startPoint){var c=b.x>this.startPoint.x?this.startPoint.x:b.x,d=b.x>this.startPoint.x?this.startPoint.y:b.y;b.x>this.startPoint.x&&b.y<this.startPoint.y&&(d=b.y),b.x<this.startPoint.x&&b.y>this.startPoint.y&&(d=this.startPoint.y);var e=this.overview._imageDiv._viewRect;c<e.x&&(c=e.x),c>e.x+e.width&&(c=e.x+e.width),d<e.y&&(d=e.y),d>e.y+e.height&&(d=e.y+e.height);var f=Math.abs(b.x-this.startPoint.x),g=Math.abs(b.y-this.startPoint.y);c+f>e.x+e.width&&(f=e.x+e.width-c),d+g>e.y+e.height&&(g=e.y+e.height-d),Wb.setDiv(this.overview._selectDiv,{x:c,y:d,width:f,height:g},null,this.overview._selectWidth,this.overview._selectColor)}else this.overview.centerNetwork(b,!1)},clear:function(){this.endPoint&&(this.endPoint=null,Wb.removeEventListener("mousemove",this.view,this),Wb.removeEventListener("mouseup",this.view,this))}}),Ib.vector.ElementUI=function(a,b){this._network=a,this._element=b,this._attachments=new Ib.List,this._bodyBounds=new Ib.List,this._hitTest=!1,this._hitTest=!1,this._intersectTest=!1,this.invalidate(!0)},Jb.ext("twaver.vector.ElementUI",Object,{getElement:function(){return this._element},getNetwork:function(){return this._network},handlePropertyChange:function(a){},handleSelectionChange:function(a){},invalidate:function(a){a===b&&(a=!0),a&&(this._invalidateAttachmentsFlag=!0),this._invalidateFlag||(this._hotSpot=null,this._bodyRect=null,this._invalidateFlag=!0,this.invalidateZoom(),this.setAttachmentVisible&&this.setAttachmentVisible(!1))},invalidateZoom:function(){this._zoomBodyRect=null,this._zoomViewRect=null,this._zoomHotSpot=null},updateStyle:function(){this._innerColor=this._network.getInnerColor(this._element),this._outerColor=this._network.getOuterColor(this._element),this._glowBlur=this._element.getStyle("glow.blur"),this._shadowColor=this._network.getShadowColor(this._element),this._shadowXOffset=this._element.getStyle("shadow.xoffset"),this._shadowYOffset=this._element.getStyle("shadow.yoffset"),this._shadowBlur=this._element.getStyle("shadow.blur"),this._wholeAlpha=this._element.getStyle("whole.alpha")},validate:function(){var a=this;if(0!=this._invalidateFlag){this._bodyBounds.clear(),this._invalidateAttachmentsFlag&&(this._invalidateAttachmentsFlag=!1,this.checkAttachments()),this._invalidateFlag=!1,this.updateStyle(),this.validateImpl(),this._attachments.forEach(function(a){a.validate()});var b;this._bodyBounds.forEach(function(a){b=Tb.unionRect(b,a)}),null==b&&(b=Jb.cloneRect(this._element.getLocation()),b.width=0,b.height=0),this._unionBodyBounds={x:b.x,y:b.y,width:b.width,height:b.height},this._attachments.forEach(function(c){b=c instanceof Ib.vector.EditAttachment?c.getElementUI()instanceof Ib.vector.LinkUI?Tb.unionRect(b,c._viewRect):Tb.unionRect(b,a._network.zoomManager._reverseElementZoomRect(a,c._viewRect)):c.getElementUI()instanceof Ib.vector.LinkUI?Tb.unionRect(b,a._network.zoomManager._getAttachmentZoomOutLineRect(c,c._viewRect)):c.getElementUI()instanceof Ib.vector.GroupUI&&c.getElementUI()._shapeRect?c instanceof Ib.vector.IconsAttachment?Tb.unionRect(b,c._viewRect):Tb.unionRect(b,a._network.zoomManager._getAttachmentZoomOutLineRect(c,c._viewRect)):Tb.unionRect(b,c._viewRect)}),this._viewRect=b}},validateImpl:function(){},setGlow:function(a,b){"glow"===this._element.getStyle("outer.style")&&(b.shadowColor=this._outerColor,b.shadowOffsetX=0,b.shadowOffsetY=0,b.shadowBlur=this._glowBlur)},clearGlow:function(a){(0!=a.shadowOffsetX||0!=a.shadowOffsetY||0!=a.shadowBlur)&&(a.shadowOffsetX=0,a.shadowOffsetY=0,a.shadowBlur=0)},setShadow:function(a,b){var c=this._network.zoomManager,d=a.isShadowable()&&this._shadowColor&&!this._editAttachment;if(b.shadowOffsetX===this._shadowXOffset&&b.shadowOffsetY===this._shadowYOffset&&b.shadowBlur===this._shadowBlur)return b;if(d||this._network._showShadowInEdit){var e=c.getGraphicsZoom(),f=c.getSizeZoom();e*=f,e>1&&(e=1),b.shadowOffsetX=this._shadowXOffset*e,b.shadowOffsetY=this._shadowYOffset*e,b.shadowBlur=this._shadowBlur*e,b.shadowColor=this._shadowColor}return b},clearShadow:function(a){(0!=a.shadowOffsetX||0!=a.shadowOffsetY||0!=a.shadowBlur)&&(a.shadowOffsetX=0,
a.shadowOffsetY=0,a.shadowBlur=0)},appendShadowBound:function(a,b){var c=a.isShadowable()&&this._shadowColor&&!this._editAttachment;if(c){var d=this._network.zoomManager,e=d.getGraphicsZoom(),f=d.getSizeZoom();e*=f,e>1&&(e=1),this._shadowXOffset>0?b.width+=this._shadowXOffset:(b.x+=this._shadowXOffset,b.width+=-this._shadowXOffset),this._shadowYOffset>0?b.height+=this._shadowYOffset:(b.y+=this._shadowYOffset,b.height+=-this._shadowYOffset);var g=this._shadowBlur;g=Math.ceil(g/e),Tb.grow(b,g+1,g+1)}return b},appendGlowBound:function(a,b){if("glow"===this._element.getStyle("outer.style")){var c=this._network.zoomManager,d=c.getGraphicsZoom(),e=c.getSizeZoom();d*=e,d>1&&(d=1);var f=this._glowBlur;f=Math.ceil(f/d),Tb.grow(b,f+1,f+1)}},isShadowable:function(){return this._shadowColor&&this._network.isSelected(this._element)&&"shadow"===this._element.getStyle("select.style")?!0:!1},addAttachment:function(a){this._attachments.add(a),this.invalidate(!1)},removeAttachment:function(a){this._attachments.remove(a),this.invalidate(!1)},getAttachments:function(){return this._attachments},checkAttachments:function(){this.checkLabelAttachment(),this.checkLabel2Attachment(),this.checkAlarmAttachment(),this.checkIconsAttachment(),this.checkEditAttachment()},checkLabelAttachment:function(){var a=this._network.getLabel(this._element);null!=a&&""!==a?this._labelAttachment||(this._labelAttachment=new Ib.vector.LabelAttachment(this,Ed.SHOW_LABEL_IN_ATTACHMENT_DIV),this.addAttachment(this._labelAttachment)):this._labelAttachment&&(this.removeAttachment(this._labelAttachment),this._labelAttachment=null)},checkLabel2Attachment:function(){var a=this._network.getLabel2(this._element);null!=a&&""!==a?this._label2Attachment||(this._label2Attachment=new Ib.vector.Label2Attachment(this,Ed.SHOW_LABEL2_IN_ATTACHMENT_DIV),this.addAttachment(this._label2Attachment)):this._label2Attachment&&(this.removeAttachment(this._label2Attachment),this._label2Attachment=null)},checkAlarmAttachment:function(){var a=this._network.getAlarmLabel(this._element);null!=a&&""!==a?this._alarmAttachment||(this._alarmAttachment=new Ib.vector.AlarmAttachment(this,Ed.SHOW_ALARM_IN_ATTACHMENT_DIV),this.addAttachment(this._alarmAttachment)):this._alarmAttachment&&(this.removeAttachment(this._alarmAttachment),this._alarmAttachment=null)},checkIconsAttachment:function(){var a=this._network.getIconsNames(this._element);a&&a.length>0?this._iconsAttachment||(this._iconsAttachment=new Ib.vector.IconsAttachment(this,Ed.SHOW_ICON_IN_ATTACHMENT_DIV),this.addAttachment(this._iconsAttachment)):this._iconsAttachment&&(this.removeAttachment(this._iconsAttachment),this._iconsAttachment=null)},checkEditAttachment:function(){this._network.hasEditInteraction()&&this._network.isSelected(this._element)&&this._network.isEditable(this._element)&&this.isEditable()?this._editAttachment||(this._editAttachment=new Ib.vector.EditAttachment(this,Ed.SHOW_EDIT_IN_ATTACHMENT_DIV),this.addAttachment(this._editAttachment)):this._editAttachment&&(this.removeAttachment(this._editAttachment),this._editAttachment=null)},getLabelAttachment:function(){return this._labelAttachment},getAlarmAttachment:function(){return this._alarmAttachment},getIconsAttachment:function(){return this._iconsAttachment},getEditAttachment:function(){return this._editAttachment},isEditable:function(){return!0},getInnerColor:function(){return this._innerColor},getOuterColor:function(){return this._outerColor},getShadowColor:function(){return this._shadowColor},getDyeColor:function(a){return this._innerColor?this._innerColor:this.getStyle(a)},getStyle:function(a){return this._element.getStyle(a)},getFont:function(a){var b=this._element.getStyle(a);return b?b:Ib.Defaults.FONT},paint:function(a){a.save(),a.globalAlpha=this._wholeAlpha,a.beginPath(),this.paintBody(a),this.clearShadow(a),this.clearGlow(a),a.closePath(),a.beginPath(),this.paintAttachments(a),a.closePath(),a.restore(),this._network._debug&&Xb.strokeRect(a,this.getZoomBodyRect(),"orange")},paintBody:function(a){},getZoomBodyRect:function(a){return this._network.zoomManager._getElementZoomRect(this,this.getBodyRect())},getZoomHotSpot:function(){return this._zoomHotSpot||(this._zoomHotSpot=this._network.zoomManager._getZoomHotSpot(this,this._hotSpot)),Jb.clone(this._zoomHotSpot)},getZoomPointers:function(a,b){return this._network.zoomManager._getZoomPointers(a,this,b)},_getZoomViewRect:function(a,b,c){var d=this._network.zoomManager;if(b){var e=Jb.cloneRect(d._getAttachmentZoomRect(b,a));return e}var f=d.getLocationZoom(),g=d.getSizeZoom(this),h=this._bodyRect?this._bodyRect:this.getBodyRect();a=a||{x:h.x,y:h.y,width:0,height:0};var i=h.x+h.width/2,j=h.y+h.height/2;return{x:i*f+(a.x-i)*g,y:j*f+(a.y-j)*g,width:a.width*g,height:a.height*g}},getZoomViewRect:function(a){var b=this._network.zoomManager,c=b.getLocationZoom();if(b.getGraphicsZoom(),1==c)return Jb.cloneRect(this._viewRect);if(!this._zoomViewRect||a){var d,e=this._getZoomViewRect(Jb.cloneRect(this._unionBodyBounds),!1);d=Tb.unionRect(d,e),this._attachments.forEach(function(a){d=a instanceof Ib.vector.EditAttachment?Tb.unionRect(d,a._viewRect):Tb.unionRect(d,a.getZoomViewRect())}),this._zoomViewRect=d}return Jb.cloneRect(this._zoomViewRect)},paintAttachments:function(a){a.beginPath();for(var b=this._attachments.size(),c=0;b>c;c++){var d=this._attachments.get(c);(this._network.isShowAttachmentsInZoomPanOrAutoLayout()||this._network.isVisibleAttachment(d))&&(1==this._hitTest&&0==d.isShowOnTop()&&this.paintAttachment(a,d),1==this._intersectTest&&this.paintAttachment(a,d),0==this._hitTest&&0==this._intersectTest&&(d.isShowOnTop()?this._network._topAttachmentList.add(d):this.paintAttachment(a,d)))}},paintAttachment:function(a,b){var c=this._network.zoomManager;c.isAttachmentVisible(this._element)&&(b!=this._labelAttachment&&b!=this._label2Attachment||c.isLabelVisible(this._element))&&(b!=this._alarmAttachment||c.isAlarmBalloonVisible(this._element))&&(a.beginPath(),b.paint(a),this.clearShadow(a))},getViewRect:function(){return Jb.cloneRect(this._viewRect)},getUnionBodyBounds:function(){return Jb.cloneRect(this._unionBodyBounds)},addBodyBounds:function(a){a&&this._bodyBounds.add(a)},getBodyRect:function(a){return a==b&&(a=!0),this._bodyRect||(this._bodyRect=this.createBodyRect()),a?Jb.cloneRect(this._bodyRect):this._bodyRect},getHotSpot:function(){return this._hotSpot?Jb.clone(this._hotSpot):{x:0,y:0}},setHotSpot:function(a){this._hotSpot=a},hit:function(a,b){return!1},intersects:function(a){return Tb.contains(a,this.getZoomViewRect())?!0:!1},hitCanvasRectAtBody:function(a){var b=Od.getHitCanvas(a.width,a.height),c=Od.getCtx(b);if(c.save(),c.translate(-a.x,-a.y),this._element.getImage){var d=Jb.getImageAsset(this._element.getImage());if(d&&d.getImage()instanceof Hd)return 1}this.paintBody(c);try{for(var e=c.getImageData(0,0,a.width,a.height),f=e.data,g=0;g<e.width;g++)for(var h=0;h<e.height;h++){var i=4*(h*e.width+g),j=f[i+3];if(0!==j)return c.restore(),1}}catch(k){if(Od.disposeHitCanvas(),Tb.contains(this.getUnionBodyBounds(),a))return 0}return c.restore(),-1},hitCanvasRectAtAttachments:function(a){var b=Od.getHitCanvas(a.width,a.height),c=Od.getCtx(b);c.save(),c.translate(-a.x,-a.y),this.paintAttachments(c);try{for(var d=c.getImageData(0,0,a.width,a.height),e=d.data,f=0;f<d.width;f++)for(var g=0;g<d.height;g++){var h=4*(g*d.width+f),i=e[h+3];if(0!==i)return c.restore(),1}}catch(j){Od.disposeHitCanvas()}return c.restore(),-1},hitCanvasRect:function(a){this._intersectTest=!0,1==this._hitTest&&(this._intersectTest=!1);var b=Tb.intersection(a,this.getZoomViewRect()),c=this.hitCanvasRectAtBody(b);if(1==c)return this._intersectTest=!1,!0;var d=this.hitCanvasRectAtAttachments(b);return 1==d?(this._intersectTest=!1,!0):(this._intersectTest=!1,0==c)},hitCanvasPoint:function(a,b){var c={x:a,y:b,width:0,height:0},d=this._network.getSelectionTolerance();if(d&&d>0&&Tb.grow(c,d,d),!Tb.intersects(this.getZoomViewRect(),c))return!1;this._hitTest=!0;var e=this.hitCanvasRect(c);return this._hitTest=!1,e},hitTest:function(a,b){var c={x:a,y:b,width:0,height:0},d=this._network.getSelectionTolerance();if(d&&d>0&&Tb.grow(c,d,d),!Tb.intersects(this.getZoomViewRect(),c))return null;for(var e=Tb.intersection(c,this.getZoomViewRect()),f=this._attachments.size(),g=0;f>g;g++){var h=this._attachments.get(g);if(h.hit(a,b))return h}var i=this.hitCanvasRectAtBody(e);return 1==i?this:0==i?this:null},dispose:function(){this._attachments.forEach(function(a){a.dispose()}),this._attachments.clear()}}),Ib.vector.NodeUI=function(a,b){Ib.vector.NodeUI.superClass.constructor.call(this,a,b)},Jb.ext("twaver.vector.NodeUI",Ib.vector.ElementUI,{invalidate:function(a){this.curInterval&&clearInterval(this.curInterval),Ib.vector.NodeUI.superClass.invalidate.call(this,a)},createBodyRect:function(){return this._element.getRect()},validateImpl:function(){Ib.vector.NodeUI.superClass.validateImpl.call(this);var a=this.getStyle("vector.shape"),b=this.getBodyRect();this._hotSpot=Tb.getHotSpot(b.x,b.y,b.width,b.height,a),this.validateBodyBounds()},validate:function(){0!=this._invalidateFlag&&Ib.vector.NodeUI.superClass.validate.call(this)},validateBodyBounds:function(){var a=this.getStyle("body.type");"default"===a?this.addBodyBounds(this.getDefaultBodyRect()):"vector"===a?this.addBodyBounds(this.getVectorBody()):"default.vector"===a?(this.addBodyBounds(this.getVectorBody()),this.addBodyBounds(this.getDefaultBodyRect())):"vector.default"===a&&(this.addBodyBounds(this.getDefaultBodyRect()),this.addBodyBounds(this.getVectorBody())),this._outerColor&&"border"===this.getStyle("outer.style")&&this.addBodyBounds(this.getOuterBorderRect()),!this._editAttachment&&"border"===this.getStyle("select.style")&&this._network.isSelected(this._element)&&this.addBodyBounds(this.getSelectBorderRect())},getDefaultBodyRect:function(){var a=this._element,b=this.getBodyRect();if(!a.getImage()||"string"==typeof a.getImage()&&!Jb.getImageAsset(a.getImage()))return b;Tb.addPadding(b,this._element,"image.padding",1);var c=Jb.cloneRect(b);return this.appendGlowBound(this,c),this.appendShadowBound(this,c),b=c},getVectorBody:function(){var a=this.getPathRect("vector");return a},getOuterBorderRect:function(){return this._getBorderRect("outer")},getSelectBorderRect:function(){return this._getBorderRect("select")},_getBorderRect:function(a){var b=this._element,c=b.getStyle(a+".width"),d=b.getStyle("select.physicalZoom")?1:this._network.getGraphicsZoom();if(c>0){c="select"===a?c/d:c;var e=this.getBodyRect();Tb.addPadding(e,b,a+".padding","select"===a?1/d:1);var f=Jb.cloneRect(e);return Tb.grow(f,2*c,2*c),f}return null},getPathRect:function(a,b){var c=this._element,d=this.getBodyRect();this._network.zoomManager.getSizeZoom(),b&&Tb.addPadding(d,c,a+".padding",1);var e=Jb.cloneRect(d),f=c.getStyle(a+".outline.width");if(f>0)if(this._getZoomPoints){for(var g=this._element._points,h=g.size(),i=0,j=0;h>j;j++){if(0==j)var k=g.get(j),l=g.get(h-1),m=g.get(j+1);else if(j==h-1)var k=g.get(j),l=g.get(j-1),m=g.get(0);else var k=g.get(j),l=g.get(j-1),m=g.get(j+1);var n=Tb.getCenterPoint(l,m),o=Tb.getAngle(n,k),p=Math.abs(5*(f+1)*Math.sin(o));i=p>i?p:i,p=Math.abs(5*(f+1)*Math.cos(o)),i=p>i?p:i}Tb.grow(e,i,i)}else Tb.grow(e,f/2,f/2);return this.appendGlowBound(this,e),this.appendShadowBound(this,e),e},getZoomPathRect:function(a,b){var c=this._element,d=this.getZoomBodyRect();this._network.zoomManager.getSizeZoom(),b&&Tb.addPadding(d,c,a+".padding",1);var e=Jb.cloneRect(d),f=c.getStyle(a+".outline.width");if(f>0)if(this._getZoomPoints){for(var g=this._getZoomPoints(),h=g.size(),i=0,j=0;h>j;j++){if(0==j)var k=g.get(j),l=g.get(h-1),m=g.get(j+1);else if(j==h-1)var k=g.get(j),l=g.get(j-1),m=g.get(0);else var k=g.get(j),l=g.get(j-1),m=g.get(j+1);var n=Tb.getCenterPoint(l,m),o=Tb.getAngle(n,k),p=Math.abs(5*(f+1)*Math.sin(o));i=p>i?p:i,p=Math.abs(5*(f+1)*Math.cos(o)),i=p>i?p:i}Tb.grow(e,i,i)}else Tb.grow(e,f/2,f/2);return this.appendGlowBound(this,e),this.appendShadowBound(this,e),e},paintBody:function(a){this.curInterval&&clearInterval(this.curInterval);var b=this.getStyle("body.type");"default"===b?this.drawDefaultBody(a):"vector"===b?this.drawVectorBody(a):"default.vector"===b?(this.drawVectorBody(a),this.drawDefaultBody(a)):"vector.default"===b&&(this.drawDefaultBody(a),this.drawVectorBody(a)),this._outerColor&&"border"===this.getStyle("outer.style")&&this.drawOuterBorder(a),"border"===this.getStyle("select.style")&&this._network.isSelected(this._element)&&this.drawSelectBorder(a)},drawOuterBorder:function(a){var b=this._element,c=b.getStyle("outer.width");if(c>0){var d=this.getZoomBodyRect();Tb.addPadding(d,b,"outer.padding",1),a.lineWidth=c,a.lineCap=b.getStyle("outer.cap"),a.lineJoin=b.getStyle("outer.join"),a.strokeStyle=this._outerColor,Xb.drawVector(a,b.getStyle("outer.shape"),null,d),a.stroke()}},drawDefaultBody:function(a){var b,c=this._element;if(c.getImage()&&("string"!=typeof c.getImage()||(b=Jb.getImageAsset(c.getImage())))&&(!this._shapeRect||c.getStyle("group.expend.image")&&("string"!=typeof c.getStyle("group.expend.image")||(b=Jb.getImageAsset(c.getStyle("group.expend.image")))))){var d=this.getZoomBodyRect();if(Tb.addPadding(d,this._element,"image.padding",1),0!=c.getAngle()&&(a.save(),d=c.getOriginalRect(),d=this._network.zoomManager._getElementZoomRect(this,d),Ib.Util.rotateCanvas(a,d,c.getAngle())),this.setGlow(this,a),this.setShadow(this,a),b&&b.getImage()instanceof Hd){var e,f=b.getImage().frames,g=b.getImage().size,h=0;e=Jd(f,g,0),a.drawImage(e,d.x,d.y,d.width,d.height),this.curInterval=setInterval(function(){h=(h+f.length)%f.length,e=Jd(f,g,h),a.drawImage(e,d.x,d.y,d.width,d.height),h++},100)}else this._shapeRect?Nc(a,c.getStyle("group.expend.image"),this.getInnerColor(),d,c,this._network):Nc(a,c.getImage(),this.getInnerColor(),d,c,this._network);0!=c.getAngle()&&a.restore()}},drawSelectBorder:function(a){this.clearGlow(a);var b=this._element,c=b.getStyle("select.width");if(c>0){var d=this.getZoomBodyRect();d=Jb.cloneRect(d);var e=b.getStyle("select.physicalZoom")?1:this._network.getGraphicsZoom();Tb.addPadding(d,b,"select.padding",1/e),Tb.grow(d,c/2/e,c/2/e),a.lineWidth=c/e,a.lineCap=b.getStyle("select.cap"),a.lineJoin=b.getStyle("select.join"),a.strokeStyle=b.getStyle("select.color"),Xb.drawVector(a,b.getStyle("select.shape"),null,d),a.stroke()}},drawVectorBody:function(a){this.drawPath(a,"vector",!0,this._element.getStyle("vector.outline.pattern"));var b=this.getStyle("vector.deep"),c=this.getStyle("vector.fill.color");if(0!==b&&c&&"rectangle"===this.getStyle("vector.shape")){var d=this.getZoomBodyRect(),e=this._element.getAngle();if(0!=e){a.save();var f=this._element.getOriginalRect();f=this._network.zoomManager._getElementZoomRect(this,f),Ib.Util.rotateCanvas(a,f,e)}Xb.draw3DRect(a,c,b,d),0!=e&&a.restore()}},drawPath:function(a,b,c,d,e,f,g){var h=this._network.zoomManager,i=this._element,j=null;j="group"==b?this._shapeRect:this.getZoomBodyRect(),c&&Tb.addPadding(j,i,b+".padding",1);var k=i.getStyle(b+".outline.width");this.setGlow(this,a),this.setShadow(this,a),0!=i.getAngle()&&(i instanceof Nd||(j=i.getOriginalRect(),j=h._getElementZoomRect(this,j)),a.save(),Ib.Util.rotateCanvas(a,j,i.getAngle()));var l,m=i.getStyle(b+".fill");if(m){l=this._innerColor&&!vc.hasDefault(this._element)?this._innerColor:i.getStyle(b+".fill.color");var n=i.getStyle(b+".gradient");n?Xb.fill(a,l,n,i.getStyle(b+".gradient.color"),j):a.fillStyle=l}var o=i.getStyle(b+".shape"),p=i.getStyle("group.shape.roundrect.radius");m&&(a.beginPath(),e?Xb.drawLinePoints(a,e,null,f,g):"roundrect"===o&&"group"===b?Xb.drawVector(a,o,null,j,p):Xb.drawVector(a,o,null,j),a.fill()),k>0&&(a.lineWidth=k,a.lineCap=i.getStyle(b+".cap"),a.lineJoin=i.getStyle(b+".join"),a.strokeStyle=i.getStyle(b+".outline.color"),a.beginPath(),e?Xb.drawLinePoints(a,e,d,f,g):"roundrect"===o&&"group"===b?Xb.drawVector(a,o,d,j,p):Xb.drawVector(a,o,d,j),a.stroke()),0!=i.getAngle()&&a.restore()},hit:function(a,b){var c={x:a,y:b,width:0,height:0},d=this._network.getSelectionTolerance();if(d&&d>0&&Tb.grow(c,d,d),this._network._transparentSelectionEnable){var e=this.getBodyRect();if(Jb.math.intersects(e,c))return!0}return Tb.intersects(this.getZoomViewRect(),c)?this.hitCanvasPoint(a,b):!1},intersects:function(a){var b=Ib.vector.NodeUI.superClass.intersects.apply(this,arguments);if(1==b)return!0;if(this._network._transparentSelectionEnable){var c=this.getBodyRect();if(Jb.math.intersects(c,a))return!0}return Tb.intersects(a,this.getZoomViewRect())?this.hitCanvasRect(a):!1}}),Ib.vector.LinkUI=function(a,b){Ib.vector.LinkUI.superClass.constructor.call(this,a,b)},Jb.ext("twaver.vector.LinkUI",Ib.vector.ElementUI,{isEditable:function(){return!0},invalidate:function(a){this._linkPoints=null,this._fromPoint=null,this._toPoint=null,this._angle=null,Ib.vector.LinkUI.superClass.invalidate.call(this,a)},invalidateZoom:function(){this._fromPoint=null,this._toPoint=null,this._linkPoints=null,Ib.vector.LinkUI.superClass.invalidateZoom.call(this)},validateImpl:function(){this.validateBodyBounds(),Ib.vector.LinkUI.superClass.validateImpl.call(this)},validateBodyBounds:function(){var a=this.getLinkPoints();if(a&&!(a.size()<2)){var b=this._element,c=Tb.getLineRect(a),d=b.getStyle("link.width"),e=d;if(this._outerColor){var f=b.getStyle("outer.width");e+=2*f}var g=!this._editAttachment&&"border"===b.getStyle("select.style")&&this._network.isSelected(this._element);if(g){var h=b.getStyle("select.width");e+=2*h}Tb.grow(c,e/2,e/2),b.getStyle("arrow.from")&&(this._network._edgeDetect?(this._network._debug&&(this._arrowFromRect=od.getArrowRect(this,a,!0,b.getStyle("arrow.from.shape"),b.getStyle("arrow.from.width"),b.getStyle("arrow.from.height"),0,0,this._network.zoomManager)),c=Tb.unionRect(c,od.getArrowRect(this,a,!0,b.getStyle("arrow.from.shape"),b.getStyle("arrow.from.width"),b.getStyle("arrow.from.height"),0,0,this._network.zoomManager))):(this._network._debug&&(this._arrowFromRect=od.getArrowRect(this,a,!0,b.getStyle("arrow.from.shape"),b.getStyle("arrow.from.width"),b.getStyle("arrow.from.height"),b.getStyle("arrow.from.xoffset"),b.getStyle("arrow.from.yoffset"),this._network.zoomManager)),c=Tb.unionRect(c,od.getArrowRect(this,a,!0,b.getStyle("arrow.from.shape"),b.getStyle("arrow.from.width"),b.getStyle("arrow.from.height"),b.getStyle("arrow.from.xoffset"),b.getStyle("arrow.from.yoffset"),this._network.zoomManager)))),b.getStyle("arrow.to")&&(this._network._edgeDetect?(this._network._debug&&(this._arrowToRect=od.getArrowRect(this,a,!1,b.getStyle("arrow.to.shape"),b.getStyle("arrow.to.width"),b.getStyle("arrow.to.height"),0,0,this._network.zoomManager)),c=Tb.unionRect(c,od.getArrowRect(this,a,!1,b.getStyle("arrow.to.shape"),b.getStyle("arrow.to.width"),b.getStyle("arrow.to.height"),0,0,this._network.zoomManager))):(this._network._debug&&(this._arrowToRect=od.getArrowRect(this,a,!1,b.getStyle("arrow.to.shape"),b.getStyle("arrow.to.width"),b.getStyle("arrow.to.height"),b.getStyle("arrow.to.xoffset"),b.getStyle("arrow.to.yoffset"),this._network.zoomManager)),c=Tb.unionRect(c,od.getArrowRect(this,a,!1,b.getStyle("arrow.to.shape"),b.getStyle("arrow.to.width"),b.getStyle("arrow.to.height"),b.getStyle("arrow.to.xoffset"),b.getStyle("arrow.to.yoffset"),this._network.zoomManager)))),this.appendShadowBound(this,c),this.addBodyBounds(c),this._growLinkJoinBounds(c,e)}},_growLinkJoinBounds:function(a,b){},createBodyRect:function(){var a=this.getHotSpot();return a?{x:a.x-1,y:a.y-1,width:2,height:2}:null},paintBody:function(a){var b=this.getLinkPoints();if(b&&!(b.size()<2)){var c=this._element,d=c.isBundleAgent()&&c.getStyle("link.agent"),e=c.getStyle(d?"link.agent.width":"link.width"),f=e;if(this._outerColor&&"border"===this.getStyle("outer.style")){var g=c.getStyle("outer.width");f+=2*g}var h=!this._editAttachment&&"border"===c.getStyle("select.style")&&this._network.isSelected(this._element);if(h){var i=c.getStyle("select.width");f+=2*i}this.setGlow(this,a),this.setShadow(this,a),a.lineCap=c.getStyle(d?"link.agent.cap":"link.cap"),a.lineJoin=c.getStyle(d?"link.agent.join":"link.join");var j=c.getStyle(d?"link.agent.pattern":"link.pattern");h&&this.drawLinePoints(a,b,f,c.getStyle("select.color"),j),this._outerColor&&"border"===this.getStyle("outer.style")&&this.drawLinePoints(a,b,e+2*g,this._outerColor,j),this.drawLinePoints(a,b,e,this._innerColor||c.getStyle(d?"link.agent.color":"link.color"),j),od.drawLinkArrow(this,a,b,this._network.zoomManager),this._network._debug&&(Xb.strokeRect(a,this._arrowToRect,Ib.Util.randomColor()),Xb.strokeRect(a,this._arrowFromRect,Ib.Util.randomColor()))}},drawLinePoints:function(a,b,c,d,e){a.lineWidth=c,a.strokeStyle=d;var f=this._element.isBundleAgent()&&this._element.getStyle("link.agent");if(this._element.getStyle(f?"link.agent.flow":"link.flow")===!0&&e&&e.length>1){var g=new uc(a,e[0],e[1]),h=this._element.getStyle(f?"link.agent.flow.offset":"link.flow.offset"),i=Math.floor(h/(e[0]+e[1]));i>2&&(h-=(e[0]+e[1])*i),this._element.getStyle(f?"link.agent.flow.converse":"link.flow.converse")?h<e[0]?g.overflow=e[0]-h:h>=e[0]&&h<=e[0]+e[1]?(g.overflow=e[1]-(h-e[0]),g.overflow&&(g.isLine=!1)):(h-=e[0]+e[1],g.overflow=e[0]-h):h<=e[1]?(g.overflow=h,h&&(g.isLine=!1)):h>e[1]&&h<=e[0]+e[1]?g.overflow=h-e[1]:(h-=e[0]+e[1],h&&(g.isLine=!1),g.overflow=h),this._element._styleMap[f?"link.agent.flow.offset":"link.flow.offset"]=h,a.beginPath(),Xb._drawLine(b,a),a.stroke(),a.shadowColor="transparent",a.beginPath();var j=this._element.getStyle(f?"link.agent.flow.color":"link.flow.color");j=j?j:Ed.NETWORK_LINK_FLOW_COLOR,a.strokeStyle=j,Xb._drawLine(b,g),a.stroke(),a.shadowColor=this._shadowColor}else a.beginPath(),Xb.drawLinePoints(a,b,e),a.stroke()},getLinkPoints:function(){return this._linkPoints||(this._linkPoints=this.createLinkPoints(),this._lineLength=Tb.calculateLineLength(this._linkPoints)),this._linkPoints},getFromPosition:function(a,b){var c=this.getFromPoint();return c?{x:c.x+a,y:c.y+b}:null},getToPosition:function(a,b){var c=this.getToPoint();return c?{x:c.x+a,y:c.y+b}:null},getFromPoint:function(){return this._fromPoint||(this._fromPoint=xc.createFromPoint(this,this._network.zoomManager)),this._fromPoint},getToPoint:function(){return this._toPoint||(this._toPoint=xc.createToPoint(this,this._network.zoomManager)),this._toPoint},getZoomBodyRect:function(){return this.getBodyRect()},getZoomViewRect:function(){return this._viewRect},createLinkPoints:function(){var a=this._network.zoomManager,b=this.getStyle("link.type"),c=new Ib.List;if(xc.isOrthogonalOrFlexionalLink(this._element))c=xc.orthogonalAndFlexional(this,b,a);else if(this._element.isLooped()){var d=this._network.getElementUI(this._element.getFromAgent());null!=d&&(this._hotSpot=xc.fillLoopedPoints(this,d.getZoomBodyRect(),c))}else{if("arc"!==b&&"triangle"!==b&&"parallel"!==b)throw"Can not resolve link type '"+b+"'";var e=this.getFromPoint(),f=this.getToPoint();this._hotSpot=xc.fillBundlePoints(this,b,e,f,c,a)}if(this._network._linkPathFunction){var g=this._network._linkPathFunction(this,c);g&&(c=g)}return c},checkAttachments:function(){Ib.vector.LinkUI.superClass.checkAttachments.call(this),this.checkLinkHandlerAttachment()},checkLinkHandlerAttachment:function(){var a=this._network.getLinkHandlerLabel(this._element);null!=a&&""!==a?this._linkHandlerAttachment||(this._linkHandlerAttachment=new Ib.vector.LinkHandlerAttachment(this),this.addAttachment(this._linkHandlerAttachment)):this._linkHandlerAttachment&&(this.removeAttachment(this._linkHandlerAttachment),this._linkHandlerAttachment=null)},getLinkHandlerAttachment:function(){return this._linkHandlerAttachment},getControlPoint:function(){return xc.getControlPoint(this._element,this,this._network.zoomManager)},setControlPoint:function(a){if(a){var b=this.getStyle("link.type");if(xc.hasControlPoint(b)){var c=xc.getLinkSourceBounds(this,this._network.zoomManager),d=xc.getLinkTargetBounds(this,this._network.zoomManager);xc.setParamsByControlPoint(a,c,d,b,this._element)}}},getLineLength:function(){return this._lineLength},hit:function(a,b){var c={x:a,y:b,width:0,height:0},d=this._network.getSelectionTolerance();return d&&d>0&&Tb.grow(c,d,d),Tb.intersects(this._viewRect,c)?this.hitCanvasPoint(a,b):!1},intersects:function(a){var b=Ib.vector.NodeUI.superClass.intersects.apply(this,arguments);if(1==b)return!0;if(0==Tb.intersects(a,this._viewRect))return!1;var c=this.getLinkPoints(),d=c.size();if(2==d)for(var e=0;d>e;e+=2){var f=c.get(e);if(d>e+1){var g=c.get(e+1);if(Od.intersectsLine(f.x,f.y,g.x,g.y,a.x,a.y,a.width,a.height))return!0}}return this.hitCanvasRect(a)},getAngle:function(){return!this._angle&&this._fromPoint&&this._toPoint&&(this._angle=Tb.getAngle(this._fromPoint,this._toPoint)),this._angle||0},getAbsoluteAngle:function(){var a={x:10,y:0},b=this._fromPoint,c=this._toPoint,d={x:c.x-b.x,y:c.y-b.y},e=180*Math.acos((d.x*a.x+d.y*a.y)/(Math.sqrt(a.x*a.x+a.y*a.y)*Math.sqrt(d.x*d.x+d.y*d.y)))/Math.PI;return e=b.y<=c.y?e:360-e,e=e%360*Math.PI/180},appendShadowBound:function(a,b){var c=a.isShadowable()&&this._shadowColor&&!this._editAttachment;if(c){this._shadowXOffset>0?b.width+=this._shadowXOffset:(b.x+=this._shadowXOffset,b.width+=-this._shadowXOffset),this._shadowYOffset>0?b.height+=this._shadowYOffset:(b.y+=this._shadowYOffset,b.height+=-this._shadowYOffset);var d=this._shadowBlur;Tb.grow(b,d+1,d+1)}return b}}),Ib.vector.GroupUI=function(a,b){Ib.vector.GroupUI.superClass.constructor.call(this,a,b)},Jb.ext("twaver.vector.GroupUI",Ib.vector.NodeUI,{isEditable:function(){return!this._element.isExpanded()},paintBody:function(a){this._shapeRect?this._element.getStyle("group.expend.image")?(Ib.vector.GroupUI.superClass.paintBody.apply(this,arguments),this._element.getStyle("group.expend.image.vector")&&this.drawExpandedGroup(a)):this.drawExpandedGroup(a):Ib.vector.GroupUI.superClass.paintBody.apply(this,arguments)},validateBodyBounds:function(){if(this.getBodyRect(),this._shapeRect){var a=this.getPathRect("group",!1),b=this.getStyle("group.deep");Tb.grow(a,b+1,b+1),this.addBodyBounds(a)}else Ib.vector.GroupUI.superClass.validateBodyBounds.call(this)},getZoomBodyRect:function(){return this._element.isExpanded()?this.getBodyRect():Ib.vector.GroupUI.superClass.getZoomBodyRect.call(this)},getZoomViewRect:function(){return this._element.isExpanded()?this.getViewRect():Ib.vector.GroupUI.superClass.getZoomViewRect.call(this)},drawExpandedGroup:function(a){this.drawPath(a,"group",!1,this._element.getStyle("vector.outline.pattern"));var b=this.getStyle("group.deep"),c=this.getStyle("group.fill.color");0!==b&&c&&"rectangle"===this.getStyle("group.shape")&&Xb.draw3DRect(a,c,b,this._shapeRect)},getChildrenRects:function(){return this._network.getGroupChildrenRects(this._element)},createBodyRect:function(){this._shapeRect=null;var a=this._element,b=this._network;if(a.isExpanded()){a.getChildren().forEach(function(a){var c=b.getElementUI(a);c&&c.validate()});var c=this.getChildrenRects();if(!c.isEmpty()){var d=a.getStyle("group.shape"),e=Ub[d];if(!e)throw"Can not resolve group shape '"+d+"'";this._shapeRect=e(c)}}return this._shapeRect?(Tb.addPadding(this._shapeRect,a,"group.padding",1),this._shapeRect):Ib.vector.GroupUI.superClass.createBodyRect.call(this)},appendShadowBound:function(a,b){var c=a.isShadowable()&&this._shadowColor&&!this._editAttachment;if(c){this._shadowXOffset>0?b.width+=this._shadowXOffset:(b.x+=this._shadowXOffset,b.width+=-this._shadowXOffset),this._shadowYOffset>0?b.height+=this._shadowYOffset:(b.y+=this._shadowYOffset,b.height+=-this._shadowYOffset);var d=this._shadowBlur;Tb.grow(b,d+1,d+1)}return b}}),Ib.vector.ShapeNodeUI=function(a,b){Ib.vector.ShapeNodeUI.superClass.constructor.call(this,a,b)},Jb.ext("twaver.vector.ShapeNodeUI",Ib.vector.NodeUI,{getDefaultBodyRect:function(){return this._element._points.size()<2?null:this._reverseZoomPathRect()},drawDefaultBody:function(a){this._element._points.size()<2||(this.drawPath(a,"vector",!0,this._element.getStyle("vector.outline.pattern"),this._getZoomPoints(),this._element._segments,this._element.getStyle("shapenode.closed")),od.drawLinkArrow(this,a,Tb.getPointObject(this._element._points,this._element._segments)))},invalidateZoom:function(){this._zoomPoints=null,Ib.vector.LinkUI.superClass.invalidateZoom.call(this)},_getZoomPoints:function(){return this._zoomPoints=this._network.zoomManager._getShapeNodeZoomPoints(this,this._element._points),this._zoomPoints},_reverseZoomPathRect:function(){return this._network.zoomManager._reverseElementZoomRect(this,this.getZoomPathRect("vector",!0))}}),Ib.vector.ShapeLinkUI=function(a,b){Ib.vector.ShapeLinkUI.superClass.constructor.call(this,a,b)},Jb.ext("twaver.vector.ShapeLinkUI",Ib.vector.LinkUI,{isEditable:function(){return!0},createLinkPoints:function(){var a=this.getFromPoint(),b=this.getToPoint(),c=new Ib.List,d=this.getStyle("shapelink.type");c.add(a),null!=this._element._points&&c.addAll(this._network.zoomManager._getShapeLinkZoomPoints(this._element._points)),c.add(b);var e,f,g;if("lineto"===d);else if("quadto"===d){for(e=new Ib.List(c.get(0)),f=1,pointCount=c.size();f<pointCount;f++)e.add(f<pointCount-1?new Ib.List([c.get(f++),c.get(f)]):c.get(f));c=e}else if("cubicto"===d){for(e=new Ib.List(c.get(0)),f=1,pointCount=c.size();f<pointCount;f++)e.add(f<pointCount-2?new Ib.List([c.get(f++),c.get(f++),c.get(f)]):f<pointCount-1?new Ib.List([c.get(f++),c.get(f)]):c.get(f));c=e}else{if("orthogonalto"!==d)throw"Can not resolve shapelink type '"+d+"'";for(g=c.get(0),e=new Ib.List(g),f=1,pointCount=c.size();f<pointCount;f++)if(f<pointCount-1){var h=Jb.clone(c.get(f)),i=h.x,j=h.y,k=i-g.x,l=j-g.y;Math.abs(k)>Math.abs(l)?(h.x=i,h.y=g.y):(h.x=g.x,h.y=j),g=h,e.add(g)}else e.add(c.get(f));c=e}var m,n,o,h,p,k,l,q=Tb.calculateLineLength(c)/2,r=c.size(),s=0,t=0;for(m=0;r>m;m++)if(h=c.get(m),0!=m){if(o=h,o instanceof nd&&(o=o._as),o instanceof Array?(p=Tb.calculateCurveLength(n,o,1),n=o[o.length-1]):(l=h.y-n.y,k=h.x-n.x,p=Math.sqrt(k*k+l*l),n=o),t+=p,q>=s&&t>=q){var u=q-s,v=c.get(m-1);v instanceof nd&&(v=v._as,v instanceof Array&&(v=v[v.length-1]));var w=c.get(m),x=Tb.getPathInfo(w,v,u,0,-1).point;this._hotSpot=Jb.clone(x)}s=t}else n=h;return c},_growLinkJoinBounds:function(a,b){Tb.grow(a,3*b,3*b)}}),Ib.vector.GridUI=function(a,b){Ib.vector.GridUI.superClass.constructor.call(this,a,b)},Jb.ext("twaver.vector.GridUI",Ib.vector.NodeUI,{drawDefaultBody:function(a){this._element.getImage()?Ib.vector.GridUI.superClass.drawDefaultBody.apply(this,arguments):this.drawGridBody(a)},validateBodyBounds:function(){if(this._element.getImage())Ib.vector.GridUI.superClass.validateBodyBounds.call(this);else{var a=this.getBodyRect(),b=Jb.clone(a),c=this._element.getStyle("outer.width");Tb.grow(b,c,c),this.appendShadowBound(this,b),this.addBodyBounds(b)}},_getZoomCellRect:function(a,b){var c=this._element.getCellRect(a,b),d=this._element.getRect(),e=d.x+d.width/2,f=d.y+d.height/2,g=this.getZoomBodyRect(),h=g.width/d.width,i=g.x+g.width/2,j=0==e?1:i/e;return{x:e*j+(c.x-e)*h,y:f*j+(c.y-f)*h,width:c.width*h,height:c.height*h}},drawGridBody:function(a){var b=this.getStyle("grid.fill"),c=this.getStyle("grid.deep"),d=this.getStyle("grid.cell.deep");if(b||0!==c||0!==d){a.beginPath();var e=this.getZoomBodyRect(),f=this.getDyeColor("grid.fill.color");if(this.setGlow(this,a),this.setShadow(this,a),b&&(a.fillStyle=f,a.rect(e.x,e.y,e.width,e.height),a.fill()),a.closePath(),this.clearShadow(a),a.beginPath(),0!=c&&Xb.draw3DRect(a,f,c,e.x,e.y,e.width,e.height),a.closePath(),0!=d)for(var g=this.getStyle("grid.row.count"),h=this.getStyle("grid.column.count"),i=0;g>i;i++)for(var j=0;h>j;j++){var k=this._getZoomCellRect(i,j);null!=k&&(a.beginPath(),Xb.draw3DRect(a,f,d,k.x,k.y,k.width,k.height),a.closePath())}}}}),Ib.vector.RotatableNodeUI=function(a,b){Ib.vector.RotatableNodeUI.superClass.constructor.call(this,a,b)},Jb.ext("twaver.vector.RotatableNodeUI",Ib.vector.NodeUI,{isEditable:function(){return!1},getDefaultBodyRect:function(){var a=this._element,b=Jb.getImageAsset(a.getImage()),c=this.getBodyRect();return b?(Tb.addPadding(c,this._element,"image.padding",1),
c):c},drawDefaultBody:function(a){var b=this._element,c=Jb.getImageAsset(b.getImage());if(c){var d=this.getBodyRect();if(Tb.addPadding(d,this._element,"image.padding",1),c.getImage()){var e=this._element._getOrignalWidth(),f=this._element._getOrignalHeight(),g=this._element._getRotateRect();a.save(),a.translate(d.x-g.x+e/2,d.y-g.y+f/2),a.rotate(this._element._angle*Math.PI/180),a.drawImage(c.getImage(this._innerColor),-e/2,-f/2,e,f),a.restore()}else if(c.getSrc());else if(!c.getFunction())throw"ImageAsset '"+b.getImage()+" ' is empty"}}}),Ib.vector.HTMLNodeUI=function(a,b){Ib.vector.HTMLNodeUI.superClass.constructor.call(this,a,b)},Jb.ext("twaver.vector.HTMLNodeUI",Ib.vector.NodeUI,{checkAttachments:function(){Ib.vector.NodeUI.prototype.checkAttachments.call(this)},checkLabelAttachment:function(){var a=this._element.getStyle("attachment.label.style");if(a&&"none"===a)return void Ib.vector.HTMLNodeUI.superClass.checkLabelAttachment.call(this);var b=this._network.getLabel(this._element);null!=b&&""!==b?this._labelAttachment||(this._labelAttachment=new Ib.vector.HTMLLabelAttachment(this,Ed.SHOW_LABEL_IN_ATTACHMENT_DIV),this.addAttachment(this._labelAttachment)):this._labelAttachment&&(this.removeAttachment(this._labelAttachment),this._labelAttachment=null)},checkLabel2Attachment:function(){var a=this._element.getStyle("attachment.label2.style");if(a&&"none"===a)return void Ib.vector.HTMLNodeUI.superClass.checkLabel2Attachment.call(this);var b=this._network.getLabel2(this._element);null!=b&&""!==b?this._label2Attachment||(this._label2Attachment=new Ib.vector.HTMLLabel2Attachment(this,Ed.SHOW_LABEL_IN_ATTACHMENT_DIV),this.addAttachment(this._label2Attachment)):this._label2Attachment&&(this.removeAttachment(this._label2Attachment),this._label2Attachment=null)},checkAlarmAttachment:function(){var a=this._element.getStyle("attachment.alarm.style");if(a&&"none"===a)return void Ib.vector.HTMLNodeUI.superClass.checkAlarmAttachment.call(this);var b=this._network.getAlarmLabel(this._element);null!=b&&""!==b?this._alarmAttachment||(this._alarmAttachment=new Ib.vector.HTMLAlarmAttachment(this,!1),this.addAttachment(this._alarmAttachment)):this._alarmAttachment&&(this.removeAttachment(this._alarmAttachment),this._alarmAttachment=null)},setAttachmentVisible:function(a){a?(this._labelAttachment&&this._labelAttachment.setVisibility("visible"),this._label2Attachment&&this._label2Attachment.setVisibility("visible"),this._alarmAttachment&&this._alarmAttachment.setVisibility("visible")):(this._labelAttachment&&this._labelAttachment.setVisibility("hidden"),this._label2Attachment&&this._label2Attachment.setVisibility("hidden"),this._alarmAttachment&&this._alarmAttachment.setVisibility("hidden"))},validateZIndex:function(a){this._labelAttachment&&this._labelAttachment.validateZIndex(a)}}),Ib.vector.HTMLLinkUI=function(a,b){Ib.vector.HTMLLinkUI.superClass.constructor.call(this,a,b)},Jb.ext("twaver.vector.HTMLLinkUI",Ib.vector.LinkUI,{checkAttachments:function(){Ib.vector.LinkUI.prototype.checkAttachments.call(this)},checkLabelAttachment:function(){var a=this._element.getStyle("attachment.label.style");if(a&&"none"===a)return void Ib.vector.HTMLLinkUI.superClass.checkLabelAttachment.call(this);var b=this._network.getLabel(this._element);null!=b&&""!==b?this._labelAttachment||(this._labelAttachment=new Ib.vector.HTMLLabelAttachment(this,Ed.SHOW_LABEL_IN_ATTACHMENT_DIV),this.addAttachment(this._labelAttachment)):this._labelAttachment&&(this.removeAttachment(this._labelAttachment),this._labelAttachment=null)},checkLabel2Attachment:function(){var a=this._element.getStyle("attachment.label2.style");if(a&&"none"===a)return void Ib.vector.HTMLNodeUI.superClass.checkLabelAttachment.call(this);var b=this._network.getLabel2(this._element);null!=b&&""!==b?this._label2Attachment||(this._label2Attachment=new Ib.vector.HTMLLabel2Attachment(this,Ed.SHOW_LABEL_IN_ATTACHMENT_DIV),this.addAttachment(this._label2Attachment)):this._label2Attachment&&(this.removeAttachment(this._label2Attachment),this._label2Attachment=null)},checkAlarmAttachment:function(){var a=this._element.getStyle("attachment.alarm.style");if(a&&"none"===a)return void Ib.vector.HTMLLinkUI.superClass.checkAlarmAttachment.call(this);var b=this._network.getAlarmLabel(this._element);null!=b&&""!==b?this._alarmAttachment||(this._alarmAttachment=new Ib.vector.HTMLAlarmAttachment(this,!1),this.addAttachment(this._alarmAttachment)):this._alarmAttachment&&(this.removeAttachment(this._alarmAttachment),this._alarmAttachment=null)},setAttachmentVisible:function(a){a?(this._labelAttachment&&this._labelAttachment.setVisibility("visible"),this._label2Attachment&&this._label2Attachment.setVisibility("visible"),this._alarmAttachment&&this._alarmAttachment.setVisibility("visible")):(this._labelAttachment&&this._labelAttachment.setVisibility("hidden"),this._label2Attachment&&this._label2Attachment.setVisibility("hidden"),this._alarmAttachment&&this._alarmAttachment.setVisibility("hidden"))}}),Ib.vector.Attachment=function(a,b){this._ui=a,this._element=this._ui.getElement(),this._network=a.getNetwork(),this._showOnTop=b,b&&this._network._hitTestTopAttachmentList.add(this)},Jb.ext("twaver.vector.Attachment",Object,{getElement:function(){return this._element},getElementUI:function(){return this._ui},getNetwork:function(){return this._network},isShowOnTop:function(){return this._showOnTop===!0},setShowOnTop:function(a){this._showOnTop=a},getStyle:function(a){return this._ui.getStyle(a)},getFont:function(a){return this._ui.getFont(a)},getViewRect:function(){return Jb.clone(this._viewRect)},getAlpha:function(){return 1},validate:function(){},paint:function(a){},getZoomViewRect:function(){var a=this._network.zoomManager._getAttachmentZoomOutLineRect(this,this._viewRect);return a},hit:function(a,b){return Tb.containsPoint(this.getZoomViewRect(),a,b)?this.hitCanvasRect({x:a-1,y:b-1,width:2,height:2}):!1},hitCanvasRect:function(a){var b=Od.getHitCanvas(a.width,a.height),c=Od.getCtx(b);c.save(),c.translate(-a.x,-a.y),this.paint(c);try{for(var d=c.getImageData(0,0,a.width,a.height),e=d.data,f=0;f<d.width;f++)for(var g=0;g<d.height;g++){var h=4*(g*d.width+f),i=e[h+3];if(0!==i)return c.restore(),!0}}catch(j){Od.disposeHitCanvas()}return c.restore(),!1},dispose:function(){this._network._hitTestTopAttachmentList.remove(this)},_rotatePoint:function(a,b,c){var d=Tb.createMatrix(b*Math.PI/180,c.x+c.width/2,c.y+c.height/2),e=d.transform(a);return e},_rotatePointList:function(a,b,c){var d=this,e=new Ib.List;return a.forEach(function(a){e.add(d._rotatePoint(a,b,c))}),e}}),Ib.vector.BasicAttachment=function(a,b){Ib.vector.BasicAttachment.superClass.constructor.call(this,a,b),this._roundRect={x:0,y:0,width:0,height:0},this._contentRect={x:0,y:0,width:0,height:0}},Jb.ext("twaver.vector.BasicAttachment",Ib.vector.Attachment,{paint:function(a){Ib.vector.BasicAttachment.superClass.paint.apply(this,arguments);var b=this.isFill(),c=this.getOutlineWidth(),d=this._network.zoomManager._getAttachmentZoomOutLineRect(this,this._roundRect);if(this.getElementUI().setGlow(this,a),this.getElementUI().setShadow(this,a),c>0||b){if(Xb.drawRoundRect(a,d.x,d.y,d.width,d.height,this.getCornerRadius()),this._network._debug&&Xb.strokeRect(a,d,"#C71585"),this._pointers){var e=this._ui.getZoomPointers(this,this._pointers);a.moveTo(e[0].x,e[0].y),a.lineTo(e[1].x,e[1].y),a.lineTo(e[2].x,e[2].y)}if(a.closePath(),c>0&&(a.lineWidth=c,a.strokeStyle=this.getOutlineColor(),a.lineCap=this.getCap(),a.lineJoin=this.getJoin(),a.stroke()),b){var f=this.getFillColor(),g=this.getGradient();g?Xb.fill(a,f,g,this.getGradientColor(),this._viewRect):a.fillStyle=f,a.fill()}}},validate:function(){Ib.vector.BasicAttachment.superClass.validate.call(this),this.calculateMeasure();var a=this.getOutlineWidth();(null==a||0>=a)&&(a=1),this._viewRect=Tb.getRect(this._pointers),this._viewRect=Tb.unionRect(this._viewRect,this._roundRect),a>0&&Tb.grow(this._viewRect,2*a,2*a),this._viewRect=this._ui.appendShadowBound(this,this._viewRect);var b=this._element instanceof Ib.Link&&this._element.getStyle("link.label.rotatable");if(b){var c=this._viewRect.x+this._viewRect.width/2,d=this._viewRect.y+this._viewRect.height/2,e=Math.sqrt(this._viewRect.height*this._viewRect.height+this._viewRect.width*this._viewRect.width);this._viewRect={x:c-e,y:d-e,width:2*e,height:2*e}}},calculateMeasure:function(){var a=this.getContentWidth(),b=this.getContentHeight(),c=this.getCornerRadius(),d=this.getPointerLength(),e=this.getPointerWidth(),f=this.getPosition(),g=this.getXOffset(),h=this.getYOffset(),i=this._roundRect;i.width=a+c,i.height=b;var j;if(this._ui._element instanceof Ib.Link){var k,l=this._ui.getLinkPoints();k=this._ui.getLineLength?this._ui.getLineLength():this._ui._element.getLineLength(),Math.abs(g)>0&&Math.abs(g)<1?"from"===f?g*=k:"to"===f?g=k*(1-g):(g/=2,g+=.5,g*=k):"from"===f?g=g:"to"===f?g=k-g:g+=k/2;var m,n=Tb.calculatePointInfoAlongLine(l,!0,g,h),o=n.point;n.angle,m="from"===f?this._ui.getFromPoint():"to"===f?this._ui.getToPoint():this._ui._hotSpot,g=o.x-m.x,h=o.y-m.y}if(d>0){var p=this.getDirection();j=this._network.getPosition(f,this._ui,null,g,h,!1);var q;if("aboveleft"===p)i.y=j.y-d-i.height,i.x=j.x-(i.width-c),q=Math.max(j.x-e,j.x-(i.width-c)+c/2),this._pointers=[j,{x:j.x,y:j.y-d},{x:q,y:j.y-d}];else if("aboveright"===p)i.y=j.y-d-i.height,i.x=j.x-c,q=Math.min(j.x+e,j.x-c+i.width-c/2),this._pointers=[j,{x:j.x,y:j.y-d},{x:q,y:j.y-d}];else if("belowleft"===p)i.y=j.y+d,i.x=j.x-(i.width-c),q=Math.max(j.x-e,j.x-(i.width-c)+c/2),this._pointers=[j,{x:j.x,y:j.y+d},{x:q,y:j.y+d}];else if("belowright"===p)i.y=j.y+d,i.x=j.x-c,q=Math.min(j.x+e,j.x-c+i.width-c/2),this._pointers=[j,{x:j.x,y:j.y+d},{x:q,y:j.y+d}];else if("leftabove"===p)i.y=j.y+c-i.height,i.x=j.x-d-i.width,q=Math.max(j.y-e,j.y+c-i.height+c/2),this._pointers=[j,{x:j.x-d,y:j.y},{x:j.x-d,y:q}];else if("leftbelow"===p)i.y=j.y-c,i.x=j.x-d-i.width,q=Math.min(j.y+e,j.y-c+i.height-c/2),this._pointers=[j,{x:j.x-d,y:j.y},{x:j.x-d,y:q}];else if("rightabove"===p)i.y=j.y+c-i.height,i.x=j.x+d,q=Math.max(j.y-e,j.y+c-i.height+c/2),this._pointers=[j,{x:j.x+d,y:j.y},{x:j.x+d,y:q}];else if("rightbelow"===p)i.y=j.y-c,i.x=j.x+d,q=Math.min(j.y+e,j.y-c+i.height-c/2),this._pointers=[j,{x:j.x+d,y:j.y},{x:j.x+d,y:q}];else if("above"===p)i.y=j.y-d-i.height,i.x=j.x-i.width/2,q=Math.min(a/2,e/2),this._pointers=[j,{x:j.x-q,y:j.y-d},{x:j.x+q,y:j.y-d}];else if("below"===p)i.y=j.y+d,i.x=j.x-i.width/2,q=Math.min(a/2,e/2),this._pointers=[j,{x:j.x-q,y:j.y+d},{x:j.x+q,y:j.y+d}];else if("left"===p)i.y=j.y-i.height/2,i.x=j.x-d-i.width,q=Math.min(b/2,e/2),this._pointers=[j,{x:j.x-d,y:j.y+q},{x:j.x-d,y:j.y-q}];else{if("right"!==p)throw"Can not resolve '"+p+"' attachment direction";i.y=j.y-i.height/2,i.x=j.x+d,q=Math.min(b/2,e/2),this._pointers=[j,{x:j.x+d,y:j.y+q},{x:j.x+d,y:j.y-q}]}}else j=this._network.getPosition(f,this._ui,{width:i.width,height:i.height},g,h,!1),i.x=j.x,i.y=j.y,this._pointers=null;this._contentRect.x=i.x+(i.width-a)/2,this._contentRect.y=i.y+(i.height-b)/2,this._contentRect.width=a,this._contentRect.height=b;var r=this.getPadding();0!=r&&Tb.grow(i,r,r),r=this.getPaddingLeft(),0!=r&&(i.x-=r,i.width+=r),r=this.getPaddingRight(),0!=r&&(i.width+=r),r=this.getPaddingTop(),0!=r&&(i.y-=r,i.height+=r),r=this.getPaddingBottom(),0!=r&&(i.height+=r),i.width<0&&(i.width=i.width,i.x-=i.width),i.height<0&&(i.height=-i.height,i.y-=i.height)},getContentWidth:function(){return Ib.Defaults.ATTACHMENT_CONTENT_WIDTH},getContentHeight:function(){return Ib.Defaults.ATTACHMENT_CONTENT_HEIGHT},getCornerRadius:function(){return Ib.Defaults.ATTACHMENT_CORNER_RADIUS},getPointerLength:function(){return Ib.Defaults.ATTACHMENT_POINTER_LENGTH},getPointerWidth:function(){return Ib.Defaults.ATTACHMENT_POINTER_WIDTH},getPosition:function(){return Ib.Defaults.ATTACHMENT_POSITION},getXOffset:function(){return Ib.Defaults.ATTACHMENT_XOFFSET},getYOffset:function(){return Ib.Defaults.ATTACHMENT_YOFFSET},getPadding:function(){return Ib.Defaults.ATTACHMENT_PADDING},getPaddingLeft:function(){return Ib.Defaults.ATTACHMENT_PADDING_LEFT},getPaddingRight:function(){return Ib.Defaults.ATTACHMENT_PADDING_RIGHT},getPaddingTop:function(){return Ib.Defaults.ATTACHMENT_PADDING_TOP},getPaddingBottom:function(){return Ib.Defaults.ATTACHMENT_PADDING_BOTTOM},getDirection:function(){return Ib.Defaults.ATTACHMENT_DIRECTION},isFill:function(){return Ib.Defaults.ATTACHMENT_FILL},getFillColor:function(){return Ib.Defaults.ATTACHMENT_FILL_COLOR},getGradient:function(){return Ib.Defaults.ATTACHMENT_GRADIENT},getGradientColor:function(){return Ib.Defaults.ATTACHMENT_GRADIENT_COLOR},getOutlineWidth:function(){return Ib.Defaults.ATTACHMENT_OUTLINE_WIDTH},getOutlineColor:function(){return Ib.Defaults.ATTACHMENT_OUTLINE_COLOR},getCap:function(){return Ib.Defaults.ATTACHMENT_CAP},getJoin:function(){return Ib.Defaults.ATTACHMENT_JOIN},isShadowable:function(){return Ib.Defaults.ATTACHMENT_SHADOWABLE},getRoundRect:function(){return Jb.clone(this._roundRect)},getContentRect:function(){return Jb.clone(this._contentRect)}}),Ib.vector.LabelAttachment=function(a,b){Ib.vector.LabelAttachment.superClass.constructor.call(this,a,b)},Jb.ext("twaver.vector.LabelAttachment",Ib.vector.BasicAttachment,{paint:function(a){var b=this._element instanceof Ib.Link&&this._element.getStyle("link.label.rotatable");if(b){a.save();var c=this.getZoomViewRect(),d=c.x+c.width/2,e=c.y+c.height/2;a.translate(d,e),a.rotate(this._network.getElementUI(this._element).getAngle()),a.translate(-d,-e)}Ib.vector.LabelAttachment.superClass.paint.apply(this,arguments);var f=this._network.zoomManager,g=f._getAttachmentZoomRect(this,this._contentRect),h=this._element.getStyle("label.align"),i=this._element&&this._element.getStyle("label.rotate.angle");if(0!==i&&(a.save(),Ib.Util.rotateCanvas(a,this._contentRect,i)),f._drawText(this,a,this.text,g,this.font,this.getStyle("label.color"),h),(b||0!==i)&&a.restore(),this._network._debug){var j=this._viewRect;Xb.strokeRect(a,j,"#AAABBB")}},validate:function(){this.font=this.getFont("label.font");var a=this.getLabel(),b=Jb.g.getTextSize(this.font,a),c=this.getMaxLength();0!==c&&b.width>c?(this.text=Jb.g.getCollapseTextInLength(this.font,a,c),this._textSize=Jb.g.getTextSize(this.font,this.text)):(this.text=a,this._textSize=b),Ib.vector.LabelAttachment.superClass.validate.call(this);var d=this._viewRect,e=this._element&&this._element.getStyle("label.rotate.angle");if(0!==e){var f=new Ib.List;f.add({x:d.x,y:d.y}),f.add({x:d.x+d.width,y:d.y}),f.add({x:d.x+d.width,y:d.y+d.height}),f.add({x:d.x,y:d.y+d.height}),f=this._rotatePointList(f,e,d);var g=Ib.Util.getRect(f);this._viewRect=g}},getLabel:function(){return this._network.getLabel(this._element)},getContentWidth:function(){return this._textSize?this._textSize.width:0},getContentHeight:function(){return this._textSize?this._textSize.height:0},getCornerRadius:function(){return this.getStyle("label.corner.radius")},getPointerLength:function(){return this.getStyle("label.pointer.length")},getPointerWidth:function(){return this.getStyle("label.pointer.width")},getPosition:function(){return this.getStyle("label.position")},getXOffset:function(){return this.getStyle("label.xoffset")},getYOffset:function(){return this.getStyle("label.yoffset")},getPadding:function(){return this.getStyle("label.padding")},getPaddingLeft:function(){return this.getStyle("label.padding.left")},getPaddingRight:function(){return this.getStyle("label.padding.right")},getPaddingTop:function(){return this.getStyle("label.padding.top")},getPaddingBottom:function(){return this.getStyle("label.padding.bottom")},getDirection:function(){return this.getStyle("label.direction")},isFill:function(){return this.getStyle("label.fill")},getFillColor:function(){return this.getStyle("label.fill.color")},getGradient:function(){return this.getStyle("label.gradient")},getGradientColor:function(){return this.getStyle("label.gradient.color")},getOutlineWidth:function(){return this.getStyle("label.outline.width")},getOutlineColor:function(){return this.getStyle("label.outline.color")},getCap:function(){return this.getStyle("label.cap")},getJoin:function(){return this.getStyle("label.join")},getAlpha:function(){return this.getStyle("label.alpha")},getMaxLength:function(){return this.getStyle("label.maxlength")},isShadowable:function(){return this.getStyle("label.shadowable")}}),Ib.vector.Label2Attachment=function(a,b){Ib.vector.Label2Attachment.superClass.constructor.call(this,a,b)},Jb.ext("twaver.vector.Label2Attachment",Ib.vector.BasicAttachment,{paint:function(a){var b=this._element instanceof Ib.Link&&this._element.getStyle("link.label.rotatable");if(b){a.save();var c=this.getZoomViewRect(),d=c.x+c.width/2,e=c.y+c.height/2;a.translate(d,e),a.rotate(this._network.getElementUI(this._element).getAngle()),a.translate(-d,-e)}Ib.vector.Label2Attachment.superClass.paint.apply(this,arguments);var f=this._network.zoomManager,g=f._getAttachmentZoomRect(this,this._contentRect),h=this._element.getStyle("label.align"),i=this._element&&this._element.getStyle("label2.rotate.angle");if(0!==i&&(a.save(),Ib.Util.rotateCanvas(a,this._contentRect,i)),f._drawText(this,a,this.text,g,this.font,this.getStyle("label2.color"),h),(b||0!==i)&&a.restore(),this._network._debug){var j=f.getAttachmentSizeZoom(this),k=g;k.width*=j,k.height*=j,Xb.strokeRect(a,k,"#AAABBB")}},validate:function(){this.font=this.getFont("label2.font");var a=this.getLabel(),b=Jb.g.getTextSize(this.font,a),c=this.getMaxLength();0!==c&&b.width>c?(this.text=Jb.g.getCollapseTextInLength(this.font,a,c),this._textSize=Jb.g.getTextSize(this.font,this.text)):(this.text=a,this._textSize=b),Ib.vector.LabelAttachment.superClass.validate.call(this);var d=this._viewRect,e=this._element&&this._element.getStyle("label2.rotate.angle");if(0!==e){var f=new Ib.List;f.add({x:d.x,y:d.y}),f.add({x:d.x+d.width,y:d.y}),f.add({x:d.x+d.width,y:d.y+d.height}),f.add({x:d.x,y:d.y+d.height}),f=this._rotatePointList(f,e,d);var g=Ib.Util.getRect(f);this._viewRect=g}},getLabel:function(){return this._network.getLabel2(this._element)},getContentWidth:function(){return this._textSize?this._textSize.width:0},getContentHeight:function(){return this._textSize?this._textSize.height:0},getCornerRadius:function(){return this.getStyle("label2.corner.radius")},getPointerLength:function(){return this.getStyle("label2.pointer.length")},getPointerWidth:function(){return this.getStyle("label2.pointer.width")},getPosition:function(){return this.getStyle("label2.position")},getXOffset:function(){return this.getStyle("label2.xoffset")},getYOffset:function(){return this.getStyle("label2.yoffset")},getPadding:function(){return this.getStyle("label2.padding")},getPaddingLeft:function(){return this.getStyle("label2.padding.left")},getPaddingRight:function(){return this.getStyle("label2.padding.right")},getPaddingTop:function(){return this.getStyle("label2.padding.top")},getPaddingBottom:function(){return this.getStyle("label2.padding.bottom")},getDirection:function(){return this.getStyle("label2.direction")},isFill:function(){return this.getStyle("label2.fill")},getFillColor:function(){return this.getStyle("label2.fill.color")},getGradient:function(){return this.getStyle("label2.gradient")},getGradientColor:function(){return this.getStyle("label2.gradient.color")},getOutlineWidth:function(){return this.getStyle("label2.outline.width")},getOutlineColor:function(){return this.getStyle("label2.outline.color")},getCap:function(){return this.getStyle("label2.cap")},getJoin:function(){return this.getStyle("label2.join")},getAlpha:function(){return this.getStyle("label2.alpha")},getMaxLength:function(){return this.getStyle("label2.maxlength")},isShadowable:function(){return this.getStyle("label2.shadowable")}}),Ib.vector.AlarmAttachment=function(a,b){Ib.vector.AlarmAttachment.superClass.constructor.call(this,a,b)},Jb.ext("twaver.vector.AlarmAttachment",Ib.vector.BasicAttachment,{paint:function(a){Ib.vector.AlarmAttachment.superClass.paint.apply(this,arguments);var b=this._network.zoomManager,c=b._getAttachmentZoomRect(this,this._contentRect);b._drawText(this,a,this.text,c,this.font,this.getStyle("alarm.color"))},validate:function(){this.font=this.getFont("alarm.font"),this.text=this._network.getAlarmLabel(this._element),this._textSize=Xb.getTextSize(this.font,this.text),this._fillColor=this._network.getAlarmFillColor(this._element),Ib.vector.AlarmAttachment.superClass.validate.call(this)},getContentWidth:function(){return this._textSize?this._textSize.width:0},getContentHeight:function(){return this._textSize?this._textSize.height:0},getCornerRadius:function(){return this.getStyle("alarm.corner.radius")},getPointerLength:function(){return this.getStyle("alarm.pointer.length")},getPointerWidth:function(){return this.getStyle("alarm.pointer.width")},getPosition:function(){return this.getStyle("alarm.position")},getXOffset:function(){return this.getStyle("alarm.xoffset")},getYOffset:function(){return this.getStyle("alarm.yoffset")},getPadding:function(){return this.getStyle("alarm.padding")},getPaddingLeft:function(){return this.getStyle("alarm.padding.left")},getPaddingRight:function(){return this.getStyle("alarm.padding.right")},getPaddingTop:function(){return this.getStyle("alarm.padding.top")},getPaddingBottom:function(){return this.getStyle("alarm.padding.bottom")},getDirection:function(){return this.getStyle("alarm.direction")},isFill:function(){return null!=this._fillColor},getFillColor:function(){return this._fillColor},getGradient:function(){return this.getStyle("alarm.gradient")},getGradientColor:function(){return this.getStyle("alarm.gradient.color")},getOutlineWidth:function(){return this.getStyle("alarm.outline.width")},getOutlineColor:function(){return this.getStyle("alarm.outline.color")},getCap:function(){return this.getStyle("alarm.cap")},getJoin:function(){return this.getStyle("alarm.join")},getAlpha:function(){return this.getStyle("alarm.alpha")},isShadowable:function(){return this.getStyle("alarm.shadowable")}}),Ib.vector.LinkHandlerAttachment=function(a,b){Ib.vector.LinkHandlerAttachment.superClass.constructor.call(this,a,b)},Jb.ext("twaver.vector.LinkHandlerAttachment",Ib.vector.BasicAttachment,{paint:function(a){var b=this._network.zoomManager;Ib.vector.LinkHandlerAttachment.superClass.paint.apply(this,arguments);var c=b._getAttachmentZoomRect(this,this._contentRect);b._drawText(this,a,this.linkHandlerLabel,c,this.linkHandlerFont,this.getStyle("link.handler.color"))},validate:function(){this.linkHandlerFont=this.getFont("link.handler.font"),this.linkHandlerLabel=this._network.getLinkHandlerLabel(this._element),this._textSize=Xb.getTextSize(this.linkHandlerFont,this.linkHandlerLabel),Ib.vector.LinkHandlerAttachment.superClass.validate.call(this)},getContentWidth:function(){return this._textSize?this._textSize.width:0},getContentHeight:function(){return this._textSize?this._textSize.height:0},getCornerRadius:function(){return this.getStyle("link.handler.corner.radius")},getPointerLength:function(){return this.getStyle("link.handler.pointer.length")},getPointerWidth:function(){return this.getStyle("link.handler.pointer.width")},getPosition:function(){return this.getStyle("link.handler.position")},getXOffset:function(){return this.getStyle("link.handler.xoffset")},getYOffset:function(){return this.getStyle("link.handler.yoffset")},getPadding:function(){return this.getStyle("link.handler.padding")},getPaddingLeft:function(){return this.getStyle("link.handler.padding.left")},getPaddingRight:function(){return this.getStyle("link.handler.padding.right")},getPaddingTop:function(){return this.getStyle("link.handler.padding.top")},getPaddingBottom:function(){return this.getStyle("link.handler.padding.bottom")},getDirection:function(){return this.getStyle("link.handler.direction")},isFill:function(){return this.getStyle("link.handler.fill")},getFillColor:function(){return this.getStyle("link.handler.fill.color")},getGradient:function(){return this.getStyle("link.handler.gradient")},getGradientColor:function(){return this.getStyle("link.handler.gradient.color")},getOutlineWidth:function(){return this.getStyle("link.handler.outline.width")},getOutlineColor:function(){return this.getStyle("link.handler.outline.color")},getCap:function(){return this.getStyle("link.handler.cap")},getJoin:function(){return this.getStyle("link.handler.join")},getAlpha:function(){return this.getStyle("link.handler.alpha")},isShadowable:function(){return this.getStyle("link.handler.shadowable")}}),Ib.vector.IconsAttachment=function(a,b){Ib.vector.IconsAttachment.superClass.constructor.call(this,a,b)},Jb.ext("twaver.vector.IconsAttachment",Ib.vector.Attachment,{isShadowable:function(){return Ib.Defaults.ATTACHMENT_SHADOWABLE},validate:function(){if(Ib.vector.IconsAttachment.superClass.validate.call(this),this.iconsNames=this._network.getIconsNames(this._element),this.iconsNames&&0!=this.iconsNames.length){var a=this._makeGroup(this.iconsNames),b=this._makeGroup(this._network.getIconsColors(this._element)),c=this._network.zoomManager;len=a.length,this.iconsOrientation=this._makeArray(this._element.getStyle("icons.orientation"),len,"right"),this.iconsPosition=this._makeArray(this._element.getStyle("icons.position"),len,"topleft.bottomright"),this.iconsXoffset=this._makeArray(this._element.getStyle("icons.xoffset"),len,0),this.iconsYoffset=this._makeArray(this._element.getStyle("icons.yoffset"),len,0),this.iconsXgap=this._makeArray(this._element.getStyle("icons.xgap"),len,1),this.iconsYgap=this._makeArray(this._element.getStyle("icons.ygap"),len,1),this.locations=[],this.iconsSizes=[],this.iconsOrientations=[];var d,e,f;for(i=0;i<len;i++){var g=a[i],f=this.iconsOrientation[i]||"right",h=this.iconsPosition[i]||"topleft.bottomright",j=this.iconsXgap[i]||1,k=this.iconsYgap[i]||1,l=this.iconsXoffset[i]||0,m=this.iconsYoffset[i]||0;if(this._ui._element instanceof Ib.Link){var n,o=this._ui.getLinkPoints();n=this._ui.getLineLength?this._ui.getLineLength():this._ui._element.getLineLength(),Math.abs(l)>0&&Math.abs(l)<1?"from"===h?l*=n:"to"===h?l=n*(1-l):(l/=2,l+=.5,l*=n):"from"===h?l=l:"to"===h?l=n-l:l+=n/2;var p,q=Tb.calculatePointInfoAlongLine(o,!0,l,m),r=q.point;q.angle,p="from"===h?this._ui.getFromPoint():"to"===h?this._ui.getToPoint():this._ui._hotSpot,l=r.x-p.x,m=r.y-p.y}e=null,d=this._getIconsSize(g,f,j,k,c),d&&(e=this._network.getPosition(h,this._ui,d,l,m),this._iconLocation=e,"top"===f?e.y+=d.height:"left"===f&&(e.x+=d.width)),this.locations.push(e),this.iconsSizes.push(d),this.iconsOrientations.push(f)}var s=null;for(i=0;i<this.locations.length;i++)e=this.locations[i],d=this.iconsSizes[i],f=this.iconsOrientations[i],null!=e&&(s=null==s?"top"===f?{x:e.x,y:e.y-d.height,width:d.width,height:d.height}:"left"===f?{x:e.x-d.width,y:e.y,width:d.width,height:d.height}:{x:e.x,y:e.y,width:d.width,height:d.height}:"top"===f?Tb.unionRect(s,{x:e.x,y:e.y-d.height,width:d.width,height:d.height}):"left"===f?Tb.unionRect(s,{x:e.x-d.width,y:e.y,width:d.width,height:d.height}):Tb.unionRect(s,{x:e.x,y:e.y,width:d.width,height:d.height}));this._viewRect=c?s||this.getElementUI().getViewRect():s||{x:this._element.getLocation().x,y:this._element.getLocation().y,width:0,height:0},this.iconsGroups=a,this.colorGroups=b;var t=this._element instanceof Ib.Link&&this._element.getStyle("link.icons.rotatable");for(i=0;i<len;i++)if(t instanceof Array&&t[i]&&this._viewRect){var u=this._viewRect.x+this._viewRect.width/2,v=this._viewRect.y+this._viewRect.height/2,w=Math.sqrt(this._viewRect.height*this._viewRect.height+this._viewRect.width*this._viewRect.width);this._viewRect={x:u-w/2,y:v-w/2,width:w,height:w}}}},_makeGroup:function(a){if(!Array.isArray(a))return[[a]];var b,c,d,e=[],f=!1,g=a.length;for(b=0;g>b;b++)c=a[b],Array.isArray(c)?(f=!0,e.push(c)):(d=[c],e.push(d));return f||(e.length=0,e.push(a)),e},_makeArray:function(a,b,c){if(Array.isArray(a))return a;for(var d=[],e=0;b>e;e++)d.push(a||c);return d},paint:function(a){if(Ib.vector.IconsAttachment.superClass.paint.apply(this,arguments),this.iconsNames&&0!=this.iconsNames.length&&this.locations){var b,c,d,e,f,g,h,i,j,k,l=this._network.zoomManager;for(b=0;b<this.iconsGroups.length;b++)if(c=this.locations[b]){f=c.x,g=c.y,e=this.iconsGroups[b],h=this.colorGroups[b],i=this.iconsOrientation[b],j=this.iconsXgap[b]||1,k=this.iconsYgap[b]||1,d=0;for(var m in e){var n=null,o=null;h&&h.length>d&&(o=h[d++]);var p=Jb.getImageAsset(e[m]);if(null!=p){if(l&&this._ui instanceof Ib.vector.GroupUI&&this._ui._shapeRect){var q=l.getAttachmentSizeZoom(this),r=p.getWidth()*q,s=p.getHeight()*q;if("right"===i)n={x:f,y:g,width:r,height:s},f+=n.width+j;else if("left"===i)n={x:f-r,y:g,width:r,height:s},f-=n.width+j;else if("top"===i)n={x:f,y:g-s,width:r,height:s},g-=n.height+k;else{if("bottom"!==i)throw"Can not resolve '"+i+"' orientation";n={x:f,y:g,width:r,height:s},g+=n.height+k}}else{if("right"===i)n={x:f,y:g,width:p.getWidth(),height:p.getHeight()},f+=n.width+j;else if("left"===i)n={x:f-p.getWidth(),y:g,width:p.getWidth(),height:p.getHeight()},f-=n.width+j;else if("top"===i)n={x:f,y:g-p.getHeight(),width:p.getWidth(),height:p.getHeight()},g-=n.height+k;else{if("bottom"!==i)throw"Can not resolve '"+i+"' orientation";n={x:f,y:g,width:p.getWidth(),height:p.getHeight()},g+=n.height+k}n=l._getAttachmentZoomOutLineRect(this,n)}var t=this._element instanceof Ib.Link&&this._element.getStyle("link.icons.rotatable");if(t instanceof Array&&t[b]){a.save();var u=n,f=u.x+u.width/2,g=u.y+u.height/2;a.translate(f,g),a.rotate(this._network.getElementUI(this._element).getAbsoluteAngle()),a.translate(-f,-g),Nc(a,p.getImage(o,n.width,n.height),o,n,this._element,this._network),a.restore()}else Nc(a,p.getImage(o,n.width,n.height),o,n,this._element,this._network);if(this._network._debug){var n=this._viewRect;Xb.strokeRect(a,n,"#FCFC00",1),Xb.strokeRect(a,n,"#FCFC00",1)}}}}}},_getIconsSize:function(a,b,c,d,e){var f=0,g=0,h=null,i=null,j=null;for(var k in a)if(i=Jb.getImageAsset(a[k])){if("right"===b)h={x:f,y:g,width:i.getWidth(),height:i.getHeight()},f+=h.width+c;else if("left"===b)h={x:f-i.getWidth(),y:g,width:i.getWidth(),height:i.getHeight()},f-=h.width+c;else if("top"===b)h={x:f,y:g-i.getHeight(),width:i.getWidth(),height:i.getHeight()},g-=h.height+d;else{if("bottom"!==b)throw"Can not resolve '"+b+"' orientation";h={x:f,y:g,width:i.getWidth(),height:i.getHeight()},g+=h.height+d}j=null==j?Jb.clone(h):Tb.unionRect(j,h)}return j?e&&this._ui instanceof Ib.vector.GroupUI&&this._ui._shapeRect?{width:Math.abs(j.width)*e.getAttachmentSizeZoom(this),height:Math.abs(j.height)*e.getAttachmentSizeZoom(this)}:{width:Math.abs(j.width),height:Math.abs(j.height)}:null}}),Ib.vector.EditAttachment=function(a,b){Ib.vector.EditAttachment.superClass.constructor.call(this,a,b)},Jb.ext("twaver.vector.EditAttachment",Ib.vector.Attachment,{paint:function(a){Ib.vector.EditAttachment.superClass.paint.apply(this,arguments),this.paintResizingPoints(a),this.paintEditPoints(a),this.paintRotatePoints(a)},paintResizingPoints:function(a){var b=this.resizingPoints.size();if(!(0>=b)){var c=this._element.getStyle("edit.physicalZoom")?1:this._network.getGraphicsZoom(),d=this.resizePointSize/c,e=2*d,f=2*d,g=this._network.getResizePointFillColor(),h=this._network.getResizePointOutlineWidth()/c,i=this._network.getResizePointOutlineColor(),j=this._element.getAngle(),k=this._network.zoomManager,l=k._getElementZoomRect(this.getElementUI(),this._element.getOriginalRect());a.lineWidth=h;for(var m=this.resizingPoints,n=0;b>n;n++){var o=m.get(n),p={x:o.x-d,y:o.y-d,width:2*d,height:2*d},q=this._getRotateRect(p,j,{x:l.x+l.width/2,y:l.y+l.height/2});a.save(),Ib.Util.rotateCanvas(a,q,j),Od.rect(a,q.x,q.y,e,f),a.restore()}if(a.fillStyle=g,a.strokeStyle=i,a.fill(),a.stroke(),this._network._debug){var r=this.getViewRect("resize");Xb.strokeRect(a,r,"#CCDDCC");var r=k._getElementZoomRect(this.getElementUI(),this.getElementUI()._viewRect);Xb.strokeRect(a,r,"#FD7766")}}},paintEditPoints:function(a){var b=this.editPoints.size();
if(!(0>=b)){var c=this._element.getStyle("edit.physicalZoom")?1:this._network.getGraphicsZoom(),d=this._network.getEditPointOutlineColor(),e=this._network.getEditPointFillColor(),f=this._network.getEditPointOutlineWidth()/c;a.beginPath(),a.lineWidth=f;for(var g=this.editPoints,h=0;b>h;h++){var i=g.get(h);a.beginPath(),Od.circle(a,i.x,i.y,this.editPointSize,e,d),a.closePath()}if(this._network._debug){var j=this.getViewRect("edit");Xb.strokeRect(a,j,"#AAABBC")}}},paintRotatePoints:function(a){var b=this.rotatePoints.size();if(!(0>=b)){var c=this._element.getStyle("edit.physicalZoom")?1:this._network.getGraphicsZoom(),d=this._network.getRotatePointOutlineColor(),e=this._network.getRotatePointFillColor(),f=this._network.getRotatePointOutlineWidth()/c;a.beginPath(),a.lineWidth=f;for(var g=this.rotatePoints,h=0;b>h;h++){var i=g.get(h);a.beginPath(),Od.circle(a,i.x,i.y,this.rotatePointSize/c,e,d),a.closePath(),a.beginPath()}if(this._network._debug){var j=this.getViewRect("rotate");Xb.strokeRect(a,j,"green")}}},getViewRect:function(a){if(a){if("resize"===a)return this._resizeRect;if("rotate"===a)return this._rotateRect;if("edit"===a)return this._editRect}return this._viewRect||{x:0,y:0,width:0,height:0}},validate:function(){Ib.vector.EditAttachment.superClass.validate.call(this);var a=this._network.getGraphicsZoom();this.editPointSize=this._network.getEditPointSize(),this.resizePointSize=this._network.getResizePointSize(),this.rotatePointSize=this._network.getRotatePointSize(),this.resizingPoints=new Ib.List,this.editPoints=new Ib.List,this.rotatePoints=new Ib.List,this._element instanceof Ib.Node&&this._addResizingPoint(this._element),!(this._network.isRotatable(this._element)&&this._element instanceof Ld)||this._element instanceof Ib.ShapeNode||this._element instanceof Ib.Grid||this._element instanceof Ib.Group||this._addRotatePoint(this._element),this._element instanceof Ib.ShapeNode&&(this._addResizingPoint(this._element),this._addShapeNodePoint(this._element)),this._ui instanceof Ib.vector.ShapeLinkUI&&this._addShapeLinkPoints(this._element),this._ui instanceof Ib.vector.LinkUI&&this._addLinkControlPoint(this._ui);var b=this._network.getResizePointOutlineWidth()/a,c=this.getElementUI().getZoomBodyRect(),d=2*Math.sqrt(2);if(this._resizeOffset=(this.resizePointSize+b+1)*d,Tb.grow(c,this._resizeOffset,this._resizeOffset),this._resizeRect=c,b=this._network.getEditPointOutlineWidth()/a,this.editPoints.size()>0){var e=Tb.getRect(this.editPoints);Tb.grow(e,2*this.editPointSize+2*b),c=Tb.unionRect(c,e)}this._editRect=e,b=this._network.getRotatePointOutlineWidth()/a;var f=this.rotatePointSize;if(this.rotatePoints.size()>0){var g=this.rotatePoints.get(0),h={x:g.x-f-b-1,y:g.y-f-b-1,width:2*f+2*b+2,height:2*f+2*b+2};c=Tb.unionRect(c,h),this._rotateRect=h}this._viewRect=c},_addResizingPoint:function(a){var b=this._network.zoomManager._getElementZoomRect(this.getElementUI(),a.getOriginalRect());if(b){var c=this._network.getResizePointSize();if(!(0>=c)){var d=new nd([{x:b.x,y:b.y},{x:b.x+b.width/2,y:b.y},{x:b.x+b.width,y:b.y},{x:b.x,y:b.y+b.height/2},{x:b.x+b.width,y:b.y+b.height/2},{x:b.x,y:b.y+b.height},{x:b.x+b.width/2,y:b.y+b.height},{x:b.x+b.width,y:b.y+b.height}]),e=this._network.getResizePointOutlineWidth(),f=this._network.getResizePointOutlineColor(),g=this._network.getResizePointFillColor();this._addPoints(a.getRect(),d,e,f,g,!0)}}},_addRotatePoint:function(a){var b=this._network.zoomManager._getElementZoomRect(this.getElementUI(),a.getOriginalRect());if(b){var c=this._network.getRotatePointSize()/this._network.getGraphicsZoom();if(!(0>=c)){var d=2*c,e=new Ib.List([{x:b.x+b.width/2,y:b.y-this._network.getRotatePointOffset()/this._network.getGraphicsZoom()-c}]),f=a.getAngle();0!=f&&(e=this._rotatePointList(e,f,b));var g=e.get(0),h={x:g.x-d/2,y:g.y-d/2,width:d,height:d},i=this._network.getRotatePointOutlineWidth(),j=this.rotatePointSize+i;Tb.grow(b,j,j),Tb.unionRect(a.getRect(),h),this.rotatePoints=e}}},_addShapeNodePoint:function(a){var b=this._network.zoomManager._getShapeNodeZoomPoints(this.getElementUI(),a.getPoints());this._addEditPoints(b)},_addShapeLinkPoints:function(a){var b=this._network.zoomManager._getShapeLinkZoomPoints(a.getPoints());this._addEditPoints(b)},_addLinkControlPoint:function(a){var b,c=new Ib.List,d=a._element.getFromAgent();b=d?a._element.getFromAgent():a._element.getFromNode();var e=a._element.getStyle("link.from.xoffset"),f=a._element.getStyle("link.from.yoffset"),g=this._network.getElementUI(b),h=g.getZoomBodyRect(),i={x:h.x+h.width/2,y:h.y+h.height/2},j={x:i.x+e,y:i.y+f};c.add(j);var k,l=a._element.getToAgent();k=l?a._element.getToAgent():a._element.getToNode();var m=a._element.getStyle("link.to.xoffset"),n=a._element.getStyle("link.to.yoffset"),o=this._network.getElementUI(k),p=o.getZoomBodyRect(),q={x:p.x+p.width/2,y:p.y+p.height/2},r={x:q.x+m,y:q.y+n};if(c.add(r),xc.isOrthogonalLink(a._element)&&a.getControlPoint()){var s=a.getControlPoint();s&&c.add(s)}var t=this.editPoints.size();if(t>0)for(var u=0;t>u;u++)c.add(this.editPoints.get(u));this._addEditPoints(c)},_addEditPoints:function(a){var b=Tb.getRect(a);if(b){var c=this._network.getEditPointSize();if(!(0>=c)){var d=this._network.getEditPointOutlineWidth();this._addPoints(b,a,d,!1)}}},_addPoints:function(a,b,c,d,e,f){var g=f?this._network.getResizePointSize():this._network.getEditPointSize();if(!(0>g)){var h=g+c;Tb.grow(a,h,h),1==f?this.resizingPoints=b:this.editPoints=b}},_rotatePoint:function(a,b,c){var d=Tb.createMatrix(b*Math.PI/180,c.x+c.width/2,c.y+c.height/2),e=d.transform(a);return e},_rotatePointList:function(a,b,c){var d=this,e=new Ib.List;return a.forEach(function(a){e.add(d._rotatePoint(a,b,c))}),e},_getRotateRect:function(a,b,c){var d=Tb.createMatrix(b*Math.PI/180,c.x,c.y),e={x:a.x+a.width/2,y:a.y+a.height/2},f=d.transform(e),g=new Ib.List([{x:f.x-a.width/2,y:f.y-a.height/2},{x:f.x+a.width/2,y:f.y-a.height/2},{x:f.x+a.width/2,y:f.y+a.height/2},{x:f.x-a.width/2,y:f.y+a.height/2}]);return Tb.getRect(g)}}),Ib.vector.HTMLLabelAttachment=function(a,b){Ib.vector.HTMLLabelAttachment.superClass.constructor.call(this,a,b),this._triangleDiv=Ib.Util.createDiv(),this._roundDiv=Ib.Util.createDiv(),this._contentDiv=Ib.Util.createDiv(),this._network.getView().appendChild(this._roundDiv),this._roundDiv.appendChild(this._contentDiv)},Jb.ext("twaver.vector.HTMLLabelAttachment",Ib.vector.LabelAttachment,{validate:function(){this.validateZIndex(0);var b=this._element.getStyle("attachment.htmllabel.hyperlink");b?(Ib.Util.setCSSStyle(this._triangleDiv,"pointer-events","auto"),Ib.Util.setCSSStyle(this._contentDiv,"pointer-events","auto")):(Ib.Util.setCSSStyle(this._triangleDiv,"pointer-events","none"),Ib.Util.setCSSStyle(this._contentDiv,"pointer-events","none")),Ib.Util.setCSSStyle(this._triangleDiv,"border-style","solid"),Ib.Util.setCSSStyle(this._contentDiv,"white-space","nowrap");var c=(this.getFont("label.font"),this.getLabel());c!==this.text&&(this.text&&("object"==typeof this.text?a.jquery?a.jquery(this.text).remove():this._contentDiv.removeChild(this.text):this._contentDiv.innerHTML=""),c&&("object"==typeof c?a.jquery?a.jquery(this._contentDiv).append(c):this._contentDiv.appendChild(c):this._contentDiv.innerHTML=c),this.text=c),this._contentDiv.style.visibility="hidden",Ib.vector.HTMLLabelAttachment.superClass.validate.call(this)},validateZIndex:function(a){this._roundDiv.style.zIndex=1e5*a+this._network.getElementBox().getDatas().indexOf(this._element)},getContentWidth:function(){return this._contentDiv.scrollWidth||parseInt(Ib.Util.getCSSStyle(this._contentDiv.firstChild,"width"))},getContentHeight:function(){return this._contentDiv.scrollHeight||parseInt(Ib.Util.getCSSStyle(this._contentDiv.firstChild,"height"))},paint:function(a){var b=this.isFill(),c=this.getOutlineWidth(),d=this._contentRect;if(this.getElementUI().setGlow(this,a),this.getElementUI().setShadow(this,a),c>0||b){if(Xb.drawRoundRect(a,d.x,d.y,d.width,d.height,this.getCornerRadius()),this._pointers){var e=this._ui.getZoomPointers(this,this._pointers);a.moveTo(e[0].x,e[0].y),a.lineTo(e[1].x,e[1].y),a.lineTo(e[2].x,e[2].y)}if(a.closePath(),c>0&&(a.lineWidth=c,a.strokeStyle=this.getOutlineColor(),a.lineCap=this.getCap(),a.lineJoin=this.getJoin(),a.stroke()),b){var f=this.getFillColor(),g=this.getGradient();g?Xb.fill(a,f,g,this.getGradientColor(),this._viewRect):a.fillStyle=f,a.fill()}}var h=(this.getFont("label.font"),this.getLabel(),this._network.getViewRect().x),i=this._network.getViewRect().y,j=this._network.getZoom(),k={x:this._contentRect.x+this._contentRect.width/2,y:this._contentRect.y+this._contentRect.height/2},l=k.x*j-h-this._contentDiv.offsetWidth/2*j+"px",m=k.y*j-i-this._contentDiv.offsetHeight/2*j+"px";this._contentDiv.style.left=l,this._contentDiv.style.top=m,Qb.isFirefox?(Ib.Util.setCSSStyle(this._contentDiv,"-moz-transform","scale("+j+")"),Ib.Util.setCSSStyle(this._contentDiv,"-moz-transform-origin","0 0")):Qb.isOpera?(Ib.Util.setCSSStyle(this._contentDiv,"-o-transform","scale("+j+")"),Ib.Util.setCSSStyle(this._contentDiv,"-o-transform-origin","0 0")):Qb.isChrome||Qb.isSafari?(Ib.Util.setCSSStyle(this._contentDiv,"-webkit-transform","scale("+j+")"),Ib.Util.setCSSStyle(this._contentDiv,"-webkit-transform-origin","0 0")):Qb.isIE?(Ib.Util.setCSSStyle(this._contentDiv,"-ms-transform","scale("+j+")"),Ib.Util.setCSSStyle(this._contentDiv,"-ms-transform-origin","0 0")):(Ib.Util.setCSSStyle(this._contentDiv,"transform","scale("+j+")"),Ib.Util.setCSSStyle(this._contentDiv,"transform-origin","0 0")),this._network._debug&&(Xb.strokeRect(a,this._contentRect,"blue"),Xb.strokeRect(a,this._roundRect,"red"),Xb.strokeRect(a,this._viewRect,"green"));var n=this._element instanceof Ib.Link&&this._element.getStyle("link.label.rotatable");if(n){var o=this.getZoomViewRect(),p=(o.x+o.width/2,o.y+o.height/2,180*this._network.getElementUI(this._element).getAbsoluteAngle()/Math.PI);this._contentDiv.offsetWidth/2*j,this._contentDiv.offsetHeight/2*j,Qb.isFirefox?Ib.Util.setCSSStyle(this._contentDiv,"-moz-transform","translate(0px,0px) rotate("+p+"deg) scale("+j+")"):Qb.isOpera?Ib.Util.setCSSStyle(this._contentDiv,"-o-transform","translate(0px,0px) rotate("+p+"deg) scale("+j+")"):Qb.isChrome||Qb.isSafari?Ib.Util.setCSSStyle(this._contentDiv,"-webkit-transform","translate(0px, 0px) rotate("+p+"deg) scale("+j+")"):Qb.isIE?Ib.Util.setCSSStyle(this._contentDiv,"-ms-transform","translate(0px,0px) rotate("+p+"deg) scale("+j+")"):Ib.Util.setCSSStyle(this._contentDiv,"transform","translate(0px,0px) rotate("+p+"deg) scale("+j+")")}},setVisibility:function(a){this._contentDiv.style.visibility=a},dispose:function(){this._network.getView().removeChild(this._roundDiv)},getView:function(){return this._roundDiv}}),Ib.vector.HTMLLabel2Attachment=function(a,b){Ib.vector.HTMLLabel2Attachment.superClass.constructor.call(this,a,b),this._triangleDiv=Ib.Util.createDiv(),this._roundDiv=Ib.Util.createDiv(),this._contentDiv=Ib.Util.createDiv(),this._network.getView().appendChild(this._roundDiv),this._roundDiv.appendChild(this._contentDiv)},Jb.ext("twaver.vector.HTMLLabel2Attachment",Ib.vector.LabelAttachment,{validate:function(){this.validateZIndex(0);var b=this._element.getStyle("attachment.htmllabel2.hyperlink");b?(Ib.Util.setCSSStyle(this._triangleDiv,"pointer-events","auto"),Ib.Util.setCSSStyle(this._contentDiv,"pointer-events","auto")):(Ib.Util.setCSSStyle(this._triangleDiv,"pointer-events","none"),Ib.Util.setCSSStyle(this._contentDiv,"pointer-events","none")),Ib.Util.setCSSStyle(this._triangleDiv,"border-style","solid"),Ib.Util.setCSSStyle(this._contentDiv,"white-space","nowrap");var c=(this.getFont("label2.font"),this.getLabel());c!==this.text&&(this.text&&("object"==typeof this.text?a.jquery?a.jquery(this.text).remove():this._contentDiv.removeChild(this.text):this._contentDiv.innerHTML=""),c&&("object"==typeof c?a.jquery?a.jquery(this._contentDiv).append(c):this._contentDiv.appendChild(c):this._contentDiv.innerHTML=c),this.text=c),this._contentDiv.style.visibility="hidden",Ib.vector.HTMLLabelAttachment.superClass.validate.call(this)},validateZIndex:function(a){this._roundDiv.style.zIndex=1e5*a+this._network.getElementBox().getDatas().indexOf(this._element)},getContentWidth:function(){return this._contentDiv.scrollWidth||parseInt(Ib.Util.getCSSStyle(this._contentDiv.firstChild,"width"))},getContentHeight:function(){return this._contentDiv.scrollHeight||parseInt(Ib.Util.getCSSStyle(this._contentDiv.firstChild,"height"))},paint:function(a){var b=this.isFill(),c=this.getOutlineWidth(),d=this._contentRect;if(this.getElementUI().setGlow(this,a),this.getElementUI().setShadow(this,a),c>0||b){if(Xb.drawRoundRect(a,d.x,d.y,d.width,d.height,this.getCornerRadius()),this._pointers){var e=this._ui.getZoomPointers(this,this._pointers);a.moveTo(e[0].x,e[0].y),a.lineTo(e[1].x,e[1].y),a.lineTo(e[2].x,e[2].y)}if(a.closePath(),c>0&&(a.lineWidth=c,a.strokeStyle=this.getOutlineColor(),a.lineCap=this.getCap(),a.lineJoin=this.getJoin(),a.stroke()),b){var f=this.getFillColor(),g=this.getGradient();g?Xb.fill(a,f,g,this.getGradientColor(),this._viewRect):a.fillStyle=f,a.fill()}}var h=(this.getFont("label2.font"),this.getLabel(),this._network.getViewRect().x),i=this._network.getViewRect().y,j=this._network.getZoom(),k={x:this._contentRect.x+this._contentRect.width/2,y:this._contentRect.y+this._contentRect.height/2},l=k.x*j-h-this._contentDiv.offsetWidth/2*j+"px",m=k.y*j-i-this._contentDiv.offsetHeight/2*j+"px";this._contentDiv.style.left=l,this._contentDiv.style.top=m,this._contentDiv.style.setProperty("-webkit-transform","scale("+j+")",null),this._contentDiv.style.setProperty("-webkit-transform-origin","0 0",null),this._network._debug&&(Xb.strokeRect(a,this._contentRect,"blue"),Xb.strokeRect(a,this._roundRect,"red"),Xb.strokeRect(a,this._viewRect,"green"));var n=this._element instanceof Ib.Link&&this._element.getStyle("link.label2.rotatable");if(n){var o=this.getZoomViewRect(),p=(o.x+o.width/2,o.y+o.height/2,180*this._network.getElementUI(this._element).getAbsoluteAngle()/Math.PI);this._contentDiv.offsetWidth/2*j,this._contentDiv.offsetHeight/2*j,Qb.isFirefox?Ib.Util.setCSSStyle(this._contentDiv,"-moz-transform","translate(0px,0px) rotate("+p+"deg) scale("+j+")"):Qb.isOpera?Ib.Util.setCSSStyle(this._contentDiv,"-o-transform","translate(0px,0px) rotate("+p+"deg) scale("+j+")"):Qb.isChrome||Qb.isSafari?Ib.Util.setCSSStyle(this._contentDiv,"-webkit-transform","translate(0px, 0px) rotate("+p+"deg) scale("+j+")"):Qb.isIE?Ib.Util.setCSSStyle(this._contentDiv,"-ms-transform","translate(0px,0px) rotate("+p+"deg) scale("+j+")"):Ib.Util.setCSSStyle(this._contentDiv,"transform","translate(0px,0px) rotate("+p+"deg) scale("+j+")")}},setVisibility:function(a){this._contentDiv.style.visibility=a},dispose:function(){this._network.getView().removeChild(this._roundDiv)},getView:function(){return this._roundDiv},getLabel:function(){return this._network.getLabel2(this._element)},getCornerRadius:function(){return this.getStyle("label2.corner.radius")},getPointerLength:function(){return this.getStyle("label2.pointer.length")},getPointerWidth:function(){return this.getStyle("label2.pointer.width")},getPosition:function(){return this.getStyle("label2.position")},getXOffset:function(){return this.getStyle("label2.xoffset")},getYOffset:function(){return this.getStyle("label2.yoffset")},getPadding:function(){return this.getStyle("label2.padding")},getPaddingLeft:function(){return this.getStyle("label2.padding.left")},getPaddingRight:function(){return this.getStyle("label2.padding.right")},getPaddingTop:function(){return this.getStyle("label2.padding.top")},getPaddingBottom:function(){return this.getStyle("label2.padding.bottom")},getDirection:function(){return this.getStyle("label2.direction")},isFill:function(){return this.getStyle("label2.fill")},getFillColor:function(){return this.getStyle("label2.fill.color")},getGradient:function(){return this.getStyle("label2.gradient")},getGradientColor:function(){return this.getStyle("label2.gradient.color")},getOutlineWidth:function(){return this.getStyle("label2.outline.width")},getOutlineColor:function(){return this.getStyle("label2.outline.color")},getCap:function(){return this.getStyle("label2.cap")},getJoin:function(){return this.getStyle("label2.join")},getAlpha:function(){return this.getStyle("label2.alpha")},isShadowable:function(){return this.getStyle("label2.shadowable")}}),Ib.vector.HTMLAlarmAttachment=function(a,b){Ib.vector.HTMLAlarmAttachment.superClass.constructor.call(this,a,b),this._triangleDiv=Ib.Util.createDiv(),this._roundDiv=Ib.Util.createDiv(),this._contentDiv=Ib.Util.createDiv(),Ib.Util.setCSSStyle(this._triangleDiv,"border-style","solid"),Ib.Util.setCSSStyle(this._triangleDiv,"pointer-events","none"),Ib.Util.setCSSStyle(this._contentDiv,"white-space","nowrap"),Ib.Util.setCSSStyle(this._contentDiv,"pointer-events","none"),this._network.getView().appendChild(this._roundDiv),this._roundDiv.appendChild(this._contentDiv)},Jb.ext("twaver.vector.HTMLAlarmAttachment",Ib.vector.AlarmAttachment,{validate:function(){var a=(this.getFont("alarm.font"),this._network.getAlarmLabel(this._element));this._contentDiv.innerHTML=a,this._contentDiv.style.visibility="hidden",Ib.vector.HTMLAlarmAttachment.superClass.validate.call(this)},getContentWidth:function(){return this._contentDiv.scrollWidth||parseInt(Ib.Util.getCSSStyle(this._contentDiv.firstChild,"width"))},getContentHeight:function(){return this._contentDiv.scrollHeight||parseInt(Ib.Util.getCSSStyle(this._contentDiv.firstChild,"height"))},paint:function(a){var b=this.isFill(),c=this.getOutlineWidth(),d=this._contentRect;if(this.getElementUI().setShadow(this,a),c>0||b){if(Xb.drawRoundRect(a,d.x,d.y,d.width,d.height,this.getCornerRadius()),this._pointers){var e=this._ui.getZoomPointers(this,this._pointers);a.moveTo(e[0].x,e[0].y),a.lineTo(e[1].x,e[1].y),a.lineTo(e[2].x,e[2].y)}if(a.closePath(),c>0&&(a.lineWidth=c,a.strokeStyle=this.getOutlineColor(),a.lineCap=this.getCap(),a.lineJoin=this.getJoin(),a.stroke()),b){var f=this.getFillColor(),g=this.getGradient();g?Xb.fill(a,f,g,this.getGradientColor(),this._viewRect):a.fillStyle=f,a.fill()}}var h=(this.getFont("alarm.font"),this._network.getAlarmLabel(this._element),this._network.getViewRect().x),i=this._network.getViewRect().y,j=this._network.getZoom(),k={x:this._contentRect.x+this._contentRect.width/2,y:this._contentRect.y+this._contentRect.height/2},l=k.x*j-h-this._contentDiv.offsetWidth/2*j+"px",m=k.y*j-i-this._contentDiv.offsetHeight/2*j+"px";this._contentDiv.style.left=l,this._contentDiv.style.top=m,this._contentDiv.style.setProperty("-webkit-transform","scale("+j+")",null),this._contentDiv.style.setProperty("-webkit-transform-origin","0 0",null),this._network._debug&&Xb.strokeRect(a,this._contentRect,"#DDDDDD"),Ib.vector.AlarmAttachment.superClass.paint.apply(this,arguments)},setVisibility:function(a){this._contentDiv.style.visibility=a},dispose:function(){this._network.getView().removeChild(this._roundDiv)},getView:function(){return this._roundDiv}}),Ib.vector.BaseZoomManager=function(a){this.network=a,this.visibilityThresholds=a.visibilityThresholds},Jb.ext("twaver.vector.BaseZoomManager",Object,{getZoom:function(){return this.network.getZoom()},getGraphicsZoom:function(){return 1},getSizeZoom:function(a){return 1},getAttachmentSizeZoom:function(a){var b=a.getElementUI();return this.getSizeZoom(b)},getLocationZoom:function(){return 1},_getZoomVisibilityThresholds:function(){return this.network.getZoomVisibilityThresholds()},_convertPointFromView:function(a){var b=a.x*this.getGraphicsZoom()-this.network.getViewRect().x,c=a.y*this.getGraphicsZoom()-this.network.getViewRect().y;return{x:b,y:c}},_getElementViewRect:function(a,b){var c=this.getLocationZoom(),d=this.getSizeZoom(a);if(1==c&&1==d)return b;var e=this._getZoomPoint(a),f=e.x,g=e.y;return null==b&&console.log("View rect is null"),{x:f*c+(b.x-f)*d,y:g*c+(b.y-g)*d,width:b.width*d,height:b.height*d}},_invalidateZoom:function(){this.network.invalidateElementUIs()},_getGroupChildrenRects:function(a){var b=new nd;return a.getChildren().forEach(function(a){if(a instanceof Ld){var c=this.network.getElementUI(a);if(c){var d=c.getZoomViewRect(this);d&&b.add(d)}}},this),b},_zoomGraphicsBegin:function(a){var b=this.network,c=this.getGraphicsZoom();a.scale(c,c),a.translate(-b.viewRect.x/c,-b.viewRect.y/c)},_getEditZoomPoints:function(a,b){var c=this.getLocationZoom(),d=this.getSizeZoom(a);if(1==c&&1==d||a instanceof Ib.vector.LinkUI&&!(a instanceof Ib.vector.ShapeLinkUI))return b;var e;e=a instanceof Ib.vector.ShapeLinkUI?Tb.getCenterPoint(Tb.getRect(b)):this._getZoomPoint(a);var f=e.x,g=e.y;if(b.forEach){var h,i=new nd;return b.forEach(function(a){a instanceof nd?(h=new nd,a.forEach(function(a){h.add({x:f*c+(a.x-f)*d,y:g*c+(a.y-g)*d})}),i.add(h)):i.add({x:f*c+(a.x-f)*d,y:g*c+(a.y-g)*d})}),i}return b.x?{x:f*c+(b.x-f)*d,y:g*c+(b.y-g)*d}:void 0},_getShapeNodeZoomPoints:function(a,b,c){var d=this.getLocationZoom(),e=this.getSizeZoom(a);if(1==d&&1==e)return b;c&&(d=1/d,e=1/e);var f,g=Tb.getRect(b),h=g.x+g.width/2,i=g.y+g.height/2,j=new nd;return b.forEach(function(a){a instanceof nd?(f=new nd,a.forEach(function(a){f.add({x:h*d+(a.x-h)*e,y:i*d+(a.y-i)*e})}),j.add(f)):j.add({x:h*d+(a.x-h)*e,y:i*d+(a.y-i)*e})}),j},_getShapeLinkZoomPoints:function(a,b){var c=this.getLocationZoom(),d=c;if(1==c&&1==d)return a;b&&(c=1/c,d=1/d);var e,f=Tb.getRect(a),g=f.x+f.width/2,h=f.y+f.height/2,i=new nd;return a.forEach(function(a){a instanceof nd?(e=new nd,a.forEach(function(a){e.add({x:g*c+(a.x-g)*d,y:h*c+(a.y-h)*d})}),i.add(e)):i.add({x:g*c+(a.x-g)*d,y:h*c+(a.y-h)*d})}),i},_getLogicalPoint:function(a,b){var c,d=b?this.getZoom():this.getGraphicsZoom(),e=this.network;if(Qb.isTouchable&&a.changedTouches&&a.changedTouches.length>0){var f=e._view.getBoundingClientRect(),g=a.changedTouches[0],h=Qb.isAndroid?0:zc.scrollLeft(),i=Qb.isAndroid?0:zc.scrollTop();return c={x:(g.clientX+e.viewRect.x-f.left-h)/d,y:(g.clientY+e.viewRect.y-f.top-i)/d}}return c=Qb.isFirefox?{x:(a.layerX+e.viewRect.x)/d,y:(a.layerY+e.viewRect.y)/d}:{x:(a.offsetX+e.viewRect.x)/d,y:(a.offsetY+e.viewRect.y)/d}},_getVisibleRect:function(a){return a},_getElementZoomRect:function(a,b){var c=this.getLocationZoom(),d=this.getSizeZoom(a);if(1==c&&1==d)return Jb.cloneRect(b);var e=null!=a?this._getZoomPoint(a):{x:b.x+b.width/2,y:b.y+b.height/2},f=e.x,g=e.y;return{x:f*c+(b.x-f)*d,y:g*c+(b.y-g)*d,width:b.width*d,height:b.height*d}},_reverseElementZoomRect:function(a,b){var c=this.getLocationZoom(),d=this.getSizeZoom(a);if(1==c&&1==d)return Jb.cloneRect(b);var e=null!=a?this._getZoomPoint(a):{x:b.x+b.width/2,y:b.y+b.height/2},f=e.x,g=e.y;return{x:f+(b.x-f*c)/d,y:g+(b.y-g*c)/d,width:b.width/d,height:b.height/d}},_getZoomContentRect:function(a,c,d,e,f,g){var h=this.getSizeZoom(a.getElementUI()),i=this.getAttachmentSizeZoom(a),j=a.getElementUI();return g==b?j instanceof Ib.vector.GroupUI&&j._shapeRect?{x:e.x*f+1*(c.x-e.x)+(d.x-c.x)*i,y:e.y*f+1*(c.y-e.y)+(d.y-c.y)*i,width:d.width,height:d.height}:{x:e.x*f+(c.x-e.x)*h+(d.x-c.x)*i,y:e.y*f+(c.y-e.y)*h+(d.y-c.y)*i,width:d.width,height:d.height}:{x:e.x*f+(c.x-e.x)*h+(d.x-c.x)*i,y:e.y*f+(c.y-e.y)*h+(d.y-c.y)*i+g*(a.textHeight-4)*i,width:d.width,height:a.textHeight}},_getAttachmentZoomRect:function(a,c,d){var e=this.getLocationZoom(),f=a.getElementUI(),g=this.getSizeZoom(a.getElementUI()),h=this.getAttachmentSizeZoom(a),i=a._pointers;if(1==e&&1==h&&1==g)return d==b?c:{x:c.x,y:c.y+d*(a.textHeight-4),width:c.width,height:a.textHeight};var f=a.getElementUI(),j=this._getZoomPoint(f,a),k=(j.x,j.y,a.getPosition?a.getPosition():"center"),l=i?i[0]:Rd.get(k,c);return d==b?f instanceof Ib.vector.LinkUI||f instanceof Ib.vector.GroupUI&&f._shapeRect?this._getZoomContentRect(a,l,c,j,1):this._getZoomContentRect(a,l,c,j,e):this._getZoomContentRect(a,l,c,j,e,d)},_getZoomPoint:function(a,b){var c,d,e=a._element;if(e instanceof Ib.Follower&&e.getHost()&&e.getHost()instanceof Ib.Grid)return c=e.getHost(),d=c.getRect(),{x:d.x+d.width/2,y:d.y+d.height/2};if(d=a.getBodyRect(),a instanceof Ib.vector.LinkUI&&b&&b.getPosition){if(b.getXOffset(),b.getYOffset(),"from"===b.getPosition())return a._fromPoint;if("to"===b.getPosition())return a._toPoint}return{x:d.x+d.width/2,y:d.y+d.height/2}},_getZoomPointers:function(a,b,c){if(c){var d=this._getZoomPoint(b),e=this.getLocationZoom(),f=this.getSizeZoom(b),g=this.getAttachmentSizeZoom(a),h=c[0];return b instanceof Ib.vector.LinkUI?[{x:d.x+(h.x-d.x)*f,y:d.y+(h.y-d.y)*f},{x:d.x+(h.x-d.x)*f+(c[1].x-h.x)*g,y:d.y+(h.y-d.y)*f+(c[1].y-h.y)*g},{x:d.x+(h.x-d.x)*f+(c[2].x-h.x)*g,y:d.y+(h.y-d.y)*f+(c[2].y-h.y)*g}]:b instanceof Ib.vector.GroupUI&&b._shapeRect?[{x:d.x+1*(h.x-d.x),y:d.y+1*(h.y-d.y)},{x:d.x+1*(h.x-d.x)+(c[1].x-h.x)*g,y:d.y+1*(h.y-d.y)+(c[1].y-h.y)*g},{x:d.x+1*(h.x-d.x)+(c[2].x-h.x)*g,y:d.y+1*(h.y-d.y)+(c[2].y-h.y)*g}]:[{x:d.x*e+(h.x-d.x)*f,y:d.y*e+(h.y-d.y)*f},{x:d.x*e+(h.x-d.x)*f+(c[1].x-h.x)*g,y:d.y*e+(h.y-d.y)*f+(c[1].y-h.y)*g},{x:d.x*e+(h.x-d.x)*f+(c[2].x-h.x)*g,y:d.y*e+(h.y-d.y)*f+(c[2].y-h.y)*g}]}},_getZoomHotSpot:function(a,b){if(b){var c=this._getZoomPoint(a),d=this.getLocationZoom(),e=this.getSizeZoom(a);return{x:c.x*d+(b.x-c.x)*e,y:c.y*d+(b.y-c.y)*e}}return null},limitZoom:function(a){return a},_isVisible:function(a){var b,c=this._getZoomVisibilityThresholds(),d=c[a];if(null!=d){var e=c.zoomName;if(b="sizeZoom"==e?this.getSizeZoom():"locationZoom"==e?this.getLocationZoom():"graphicsZoom"==e?this.getGraphicsZoom():this.getZoom(),d>b)return!1}return!0},isElementVisible:function(a){var b=this.getZoom(),c=this._isVisible("element",b);return c&&a instanceof Ib.Link?this.isLinkVisible(a):c},isLinkVisible:function(a){var b=this.getZoom();return this._isVisible("link",b)},isLabelVisible:function(a){var b=this.getZoom();return this._isVisible("label",b)},isAttachmentVisible:function(a){var b=this.getZoom();return this._isVisible("attachment",b)},isAlarmBalloonVisible:function(a){var b=this.getZoom();return this._isVisible("alarmBallon",b)},_getAttachmentOutLineWidth:function(a){return a.getOutlineWidth()},_getAttachmentZoomOutLineRect:function(a,b){var c=this.getLocationZoom(),d=this.getAttachmentSizeZoom(a);if(1==c&&1==d)return b;var e=this._getAttachmentZoomRect(a,b,null),f=a.getElement();return this.isAttachmentVisible(f)?(a instanceof Ib.vector.LabelAttachment||a instanceof Ib.vector.Label2Attachment)&&!this.isLabelVisible(f)?{x:e.x,y:e.x,width:0,height:0}:a instanceof Ib.vector.AlarmAttachment&&!this.isAlarmBalloonVisible(f)?{x:e.x,y:e.x,width:0,height:0}:{x:e.x,y:e.y,width:e.width*d,height:e.height*d}:{x:e.x,y:e.x,width:0,height:0}},_drawText:function(a,b,c,d,e,f,g){var h=this.getLocationZoom(),i=this.getAttachmentSizeZoom(a);1!=h&&1!=i?(b.translate(d.x,d.y),b.scale(i,i),Xb.drawText(b,c,{x:0,y:0,width:d.width,height:d.height},e,f,g),b.scale(1/i,1/i),b.translate(-d.x,-d.y)):Xb.drawText(b,c,d,e,f,g)},_getOffset:function(a,b){var c=this.getLocationZoom();return{x:(a.x-b.x)/c,y:(a.y-b.y)/c}}});var Rd={"topleft.topleft":function(a){return{x:a.x+a.width,y:a.y+a.height}},"topleft.topright":function(a){return{x:a.x,y:a.y+a.height}},"top.top":function(a){return{x:a.x+a.width/2,y:a.y+a.height}},"topright.topleft":function(a){return{x:a.x+a.width,y:a.y+a.height}},"topright.topright":function(a){return{x:a.x,y:a.y+a.height}},topleft:function(a){return{x:a.x+a.width/2,y:a.y+a.height/2}},top:function(a){return{x:a.x+a.width/2,y:a.y+a.height/2}},topright:function(a){return{x:a.x+a.width/2,y:a.y+a.height/2}},"topleft.bottomleft":function(a){return{x:a.x+a.width,y:a.y}},"topleft.bottomright":function(a){return{x:a.x,y:a.y}},"top.bottom":function(a){return{x:a.x+a.width/2,y:a.y}},"topright.bottomleft":function(a){return{x:a.x+a.width,y:a.y}},"topright.bottomright":function(a){return{x:a.x,y:a.y}},"left.left":function(a){return{x:a.x+a.width,y:a.y+a.height/2}},left:function(a){return{x:a.x+a.width/2,y:a.y+a.height/2}},"left.right":function(a){return{x:a.x,y:a.y+a.height/2}},center:function(a){return{x:a.x+a.width/2,y:a.y+a.height/2}},"right.left":function(a){return{x:a.x+a.width,y:a.y+a.height/2}},right:function(a){return{x:a.x+a.width/2,y:a.y+a.height/2}},"right.right":function(a){return{x:a.x,y:a.y+a.height/2}},"bottomleft.topleft":function(a){return{x:a.x+a.width,y:a.y+a.height}},"bottomleft.topright":function(a){return{x:a.x,y:a.y+a.height}},"bottom.top":function(a){return{x:a.x+a.width/2,y:a.y+a.height}},"bottomright.topleft":function(a){return{x:a.x+a.width,y:a.y+a.height}},"bottomright.topright":function(a){return{x:a.x,y:a.y+a.height}},bottomleft:function(a){return{x:a.x+a.width/2,y:a.y+a.height/2}},bottom:function(a){return{x:a.x+a.width/2,y:a.y+a.height/2}},bottomright:function(a){return{x:a.x+a.width/2,y:a.y+a.height/2}},"bottomleft.bottomleft":function(a){return{x:a.x+a.width,y:a.y}},"bottomleft.bottomright":function(a){return{x:a.x,y:a.y}},"bottom.bottom":function(a){return{x:a.x+a.width/2,y:a.y}},"bottomright.bottomleft":function(a){return{x:a.x+a.width,y:a.y}},"bottomright.bottomright":function(a){return{x:a.x,y:a.y}},from:function(a){return{x:a.x+a.width/2,y:a.y+a.height/2}},to:function(a){return{x:a.x+a.width/2,y:a.y+a.height/2}},get:function(a,b){if(!b)throw"rect can not be null";var c=Rd[a];if(c)return c(b);throw"Can not resolve '"+a+"' position"}};Ib.vector.PhysicalZoomManager=function(a){Ib.vector.PhysicalZoomManager.superClass.constructor.apply(this,arguments)},Jb.ext("twaver.vector.PhysicalZoomManager",Ib.vector.BaseZoomManager,{getGraphicsZoom:function(){return this.getZoom()},_invalidateZoom:function(){}}),Ib.vector.LogicalZoomManager=function(a,b){Ib.vector.LogicalZoomManager.superClass.constructor.apply(this,arguments),this.sizeChange=b},Jb.ext("twaver.vector.LogicalZoomManager",Ib.vector.BaseZoomManager,{getLocationZoom:function(){return this.getZoom()},getSizeZoom:function(a){return this.sizeChange?this.getZoom():1}}),Ib.vector.MixedZoomManager=function(a,b){Ib.vector.MixedZoomManager.superClass.constructor.call(this,a,b)},Jb.ext("twaver.vector.MixedZoomManager",Ib.vector.LogicalZoomManager,{}),function(){function a(a){d[a]=function(){return this.getZoom()>1?b[a].apply(this,arguments):c[a].apply(this,arguments)}}var b=Ib.vector.LogicalZoomManager.prototype,c=Ib.vector.PhysicalZoomManager.prototype,d=Ib.vector.MixedZoomManager.prototype;for(var e in c)"function"==typeof c[e]&&"constructor"!=e&&(b.hasOwnProperty(e)||c.hasOwnProperty(e))&&a(e);d._invalidateZoom=function(){this.network.invalidateElementUIs()}}(),Ib.vector.interaction.BaseInteraction=function(a){this.network=a},Jb.ext("twaver.vector.interaction.BaseInteraction",Object,{setUp:function(){},tearDown:function(){},repaint:function(){this.network.repaintTopCanvas()},getOffset:function(a,b){return this.network.getOffset(a,b)},convertPointFromView:function(a){return this.network.convertPointFromView(a)},convertFromUIToMarkerRect:function(a,b,c,d){var e=this.network.zoomManager,f=e.getLocationZoom(),g=e.getGraphicsZoom(),h=e.getSizeZoom(this.network.getElementUI(d));return{x:a.x*f*g-this.network.getViewRect().x+b*f*g,y:a.y*f*g-this.network.getViewRect().y+c*f*g,width:a.width*h*g,height:a.height*h*g}},getMarkerPoint:function(a){var b;if(Qb.isTouchable&&a.changedTouches&&a.changedTouches.length>0){var c=a.changedTouches[0];return b={x:c.clientX,y:c.clientY}}return b=Qb.isFirefox?{x:a.layerX,y:a.layerY}:{x:a.offsetX,y:a.offsetY}},paint:function(a){},addListener:function(){for(var a=0;a<arguments.length;a++){var b=arguments[a];Wb.addEventListener(b,"handle_"+b,this.network.getView(),this)}},removeListener:function(){for(var a=0;a<arguments.length;a++)Wb.removeEventListener(arguments[a],this.network.getView(),this)},_handle_mousedown:function(a){0===a.button&&(this._startLogical=this.network.getLogicalPoint2(a),this._startClient=Wb.getClientPoint(a),this._startLogical&&Wb.handle_mousedown(this,a))},_handle_mousemove:function(a){this._endLogical={x:this._startLogical.x+(a.clientX-this._startClient.x)/this.network.getGraphicsZoom(),y:this._startLogical.y+(a.clientY-this._startClient.y)/this.network.getGraphicsZoom()
}},_handle_mouseup:function(a){delete this._startClient,delete this._startLogical,delete this._endLogical}}),Ib.vector.interaction.DefaultInteraction=function(a,b){Ib.vector.interaction.DefaultInteraction.superClass.constructor.call(this,a),this.lazyMode=b},Jb.ext("twaver.vector.interaction.DefaultInteraction",Ib.vector.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown","mouseover","mouseout","keydown"),Qb.isFirefox?Wb.addEventListener("DOMMouseScroll","handleMouseWheel",this.network.getView(),this):Wb.addEventListener("mousewheel","handleMouseWheel",this.network.getView(),this),Wb.addEventListener("mouseup","handle_mouseup",a,this),Wb.addEventListener("dblclick","handleDoubleClicked",this.network.getView(),this),this._oldCursor=this.network.getView().style.cursor,this.network.addPropertyChangeListener(this.handleViewRectChange,this),this.validateScrollBar(),this.network.addMarker(this),this.network.getView().oncontextmenu=function(a){a.preventDefault()},this._createZoomDiv()},tearDown:function(){this.removeListener("mousedown","mouseover","mouseout","keydown"),Qb.isFirefox?Wb.removeEventListener("DOMMouseScroll",this.network.getView(),this):Wb.removeEventListener("mousewheel",this.network.getView(),this),Wb.removeEventListener("mouseup",a,this),Wb.removeEventListener("dblclick",this.network.getView(),this),this.network.removePropertyChangeListener(this.handleViewRectChange,this),this.end(),this.network.removeMarker(this),this._zoomDiv=null},_createZoomDiv:function(){if(null==this._zoomDiv){this._zoomDiv=Ob.createElement("div"),this._zoomLabel=Ob.createElement("span"),this._zoomLabel.style.display="block",this._zoomLabel.style.textAlign="center";var b=Ob.createElement("button");b.innerHTML="Reset to default",this._zoomDiv.appendChild(this._zoomLabel),this._zoomDiv.appendChild(b);var c=Ed,d=this._zoomDiv.style;d.position="absolute",d.color=c.TOOLTIP_COLOR,d.background=c.TOOLTIP_BACKGROUND,d.fontSize=c.TOOLTIP_FONT_SIZE,d.padding=c.TOOLTIP_PADDING,d.border=c.TOOLTIP_BORDER,d.borderRadius=c.TOOLTIP_BORDER_RADIUS,d.boxShadow=c.TOOLTIP_BOX_SHADOW,d.zIndex=c.TOOLTIP_ZINDEX,d.setProperty&&d.setProperty("-webkit-box-shadow",c.TOOLTIP_BOX_SHADOW,null);var e=this;b.onclick=function(a){e.network.setZoom(1),e._setZoomDivVisible(!1)};var f=this._zoomDiv,g=function(){return f.style.opacity=parseFloat(f.style.opacity)-.05,parseFloat(f.style.opacity)<=.05?(e._setZoomDivVisible(!1),void(f._clearTimeout=null)):void(f._clearTimeout=setTimeout(f._clearFunc,100))};f._clearFunc=g,f.onmouseover=function(b){b||(b=a.event);for(var c=b.relatedTarget?b.relatedTarget:b.fromElement;c&&c!=f;)c=c.parentNode;c!=f&&(f._clearTimeout&&(clearTimeout(f._clearTimeout),f._clearTimeout=null),f.style.opacity=1)},f.onmouseout=function(b){b||(b=a.event);for(var c=b.relatedTarget?b.relatedTarget:b.toElement;c&&c!=f;)c=c.parentNode;c!=f&&(f._clearTimeout=setTimeout(f._clearFunc,10))}}},_isZoomDivVisible:function(){return null!=this._zoomDiv&&null!=this._zoomDiv.parentNode},_getZoomDiv:function(){return this._zoomDiv||this._createZoomDiv(),this._zoomDiv},_setZoomDivVisible:function(a,b,c){var d=this._getZoomDiv();a?(this._zoomLabel.innerHTML=c,d.style.opacity=1,this._isZoomDivVisible()||this.network.getView().appendChild(d),d.style.left=Ed.TOOLTIP_XOFFSET+"px",d.style.top=Ed.TOOLTIP_YOFFSET+"px",d._clearTimeout&&(clearTimeout(d._clearTimeout),d._clearTimeout=null),d._clearTimeout=setTimeout(d._clearFunc,250)):d.parentNode&&d.parentNode.removeChild(d)},handleViewRectChange:function(a){("viewRect"==a.property||"canvasSizeChange"==a.property)&&this.validateScrollBar()},getScrollBarWidth:function(){return this.network.getScrollBarWidth()},getScrollBarColor:function(){return"#cccccc"},validateScrollBar:function(){if(this.hThumbRect=null,this.vThumbRect=null,0==this.network.isScrollBarVisible())return void this.repaint();var a=this.network.getViewRect().height,b=this.network.getViewRect().width,c=this.network.getViewRect().x,d=this.network.getViewRect().y,e=this.network.getCanvasSize(),f=this.network._unionBounds,g=f.x,h=f.y,i=f.width,j=f.height,k=e.width,l=e.height,m=b,n=a,o=!1,p=!1;(c>g||k>b+c)&&(p=!0),(d>h||l>d+a)&&(o=!0);var q,r,s,t=0,u=0,v=0,w=0,x=m,y=n,z=this.getScrollBarWidth();p&&(o&&(x-=z),w=z,u=n-z,c>g&&c+b>k?(q=c-g,q=q*x/(q+m),t=q,v=x-q):g>c&&k>c+b?(q=k-(c+b),q=x*q/(q+m),t=0,v=x-q):(r=c-g,s=k-(c+b),r=x*r/i,s=x*s/i,t=r,v=m-r-s),this.hThumbRect={x:t,y:u,width:v,height:w}),t=0,u=0,v=0,w=0,x=m,y=n,o&&(p&&(y-=z),v=z,t=m-z,d>h&&d+a>l?(q=d-h,q=y*q/(q+n),u=q,w=y-q):h>d&&l>d+a?(q=l-(d+a),q=y*q/(q+n),u=0,w=y-q):(r=d-h,s=l-(d+a),r=y*r/j,s=y*s/j,u=r,w=y-r-s),this.vThumbRect={x:t,y:u,width:v,height:w}),this.network.setHScrollBarVisible(null!=this.hThumbRect),this.network.setVScrollBarVisible(null!=this.vThumbRect),this.repaint()},scrollXOffset:function(a){var b=this.network.getViewRect().height,c=this.network.getViewRect().width,d=this.network.getViewRect().x,e=this.network.getViewRect().y,f=30;a&&(f=-30),this.network.setViewRect(d+f,e,c,b)},scrollYOffset:function(a){var b=this.network.getViewRect().height,c=this.network.getViewRect().width,d=this.network.getViewRect().x,e=this.network.getViewRect().y,f=30;a&&(f=-30),this.network.setViewRect(d,e+f,c,b)},handle_mouseover:function(a){1!=this.scrollBarVisible&&(this.scrollBarVisible=!0,this.repaint())},handle_mouseout:function(a){0!=this.scrollBarVisible&&(this.scrollBarVisible=!1,this.repaint(),this.end(a))},handle_keydown:function(a){this.currentKeyEvent=a,this.addListener("keyup"),Cc.handleKeyDown(this.network,a)},handle_keyup:function(a){this.currentKeyEvent=null,this.removeListener("keyup")},start:function(b){this.end(b,!0),this.lastPoint=this.network.getLogicalPoint2(b),this.startPoint=this.network.getLogicalPoint2(b),this.lastPanPoint=this.getMarkerPoint(b),this.lazyMode&&(this.pressPoint=this.lastPoint),Wb.addEventListener("mousemove","handle_mousemove",a,this)},end:function(b,c){if(this.vBarDownPoint=null,this.hBarDownPoint=null,this.network.state.panning&&(this.network.state.panning=!1,this.network.invalidateElementUIs(!0)),c||(this.network.getView().style.cursor=this._oldCursor),this.isMoving){if(this.lazyMode){if(null!=this.dragPoint&&null!=this.pressPoint){var d=this,e=function(){d.network.fireInteractionEvent({kind:"lazyMoveEnd",event:b}),d.network.setMovingElement(!1)},f=this.getOffset(this.dragPoint,this.pressPoint),g=f.x,h=f.y;this.network.moveSelectedElements(g,h,this.network.isLazyMoveAnimate(),e)}}else this.network.isMovingElement()&&(this.network.setMovingElement(!1),this.network.fireInteractionEvent({kind:"liveMoveEnd",event:b}));if(this.isParenting()){null==this.parent&&(this.parent=this.network.getCurrentSubNetwork());var d=this;this.network.getMovableSelectedElements().forEach(function(a){a.setParent(d.parent)},this.network)}this.parentProcess(b,!0),this.isParenting()&&this.repaint(),this.network.invalidateCanvasSize(),this.lastPoint=null,this.dragPoint=null,this.pressPoint=null,this.repaint()}if(this.isSelecting&&this.startPoint){if(this.endPoint&&this.startPoint.x!==this.endPoint.x&&this.startPoint.y!==this.endPoint.y){var i=Tb.getRect([this.startPoint,this.endPoint]),j=this.network.getElementsAtRect(i,this.getIntersectMode(),this.network.getRectSelectFilter());if(j&&j.size()>0){var k=this.network.getSelectionModel(),l=k.toSelection();j.forEach(function(a){k.contains(a)?l.remove(a):l.add(a)},this),k.setSelection(l)}this.network.fireInteractionEvent({kind:"selectEnd",event:b})}this.network.setSelectingElement(!1),this.startPoint=null,this.endPoint=null,this.repaint()}this.isMouseDown=!1,Wb.removeEventListener("mousemove",a,this)},_isDragToSelect:function(a){return!this.network._dragToPan},handle_mousedown:function(a){var b=this.network;if(a.target==b.getView()||a.target==b._topCanvas||a.target==b._rootCanvas){if(this.isMoving=!1,this.isSelecting=!1,this.hBarDownPoint=null,this.vBarDownPoint=null,this._setZoomDivVisible(!1),!this.network.isValidEvent(a)){var c=this.getMarkerPoint(a);return this.start(a),null!=this.vThumbRect&&Tb.containsPoint(this.vThumbRect,c.x,c.y)&&(this.vBarDownPoint={x:a.screenX,y:a.screenY},this.vBarDownOffset=this.vBarDownPoint.y-this.vThumbRect.y),void(null!=this.hThumbRect&&Tb.containsPoint(this.hThumbRect,c.x,c.y)&&(this.hBarDownPoint={x:a.screenX,y:a.screenY},this.hBarDownOffset=this.hBarDownPoint.x-this.hThumbRect.x))}this.network.isFocusOnClick()&&Ib.Util.setFocus(this.network.getView());var d=this.network.getElementAt(a);if(this.network.isSelectingElement()||this.network.isEditingElement()||null==d||(this.network.isMovable(d)&&this.network.getElementBox().getSelectionModel().isSelectable(d)?this.isMoving=!0:this.network.getView().style.cursor="pointer",this.start(a)),!this.network.isSelectingElement()&&!this.network.isEditingElement()){var e=this.network.getSelectionModel();null==d||d&&!this.network.getElementBox().getSelectionModel().isSelectable(d)?(Jb.isCtrlDown(a)?this.isSelecting=!0:this._isDragToSelect(a)?(this.isSelecting=!0,e.clearSelection()):this.network.isRectSelectEnabled()&&(e.clearSelection(),this.network.getView().style.cursor="pointer"),this.start(a)):Jb.isCtrlDown(a)?e.contains(d)?e.removeSelection(d):e.appendSelection(d):e.contains(d)||e.setSelection(d)}this.handleClicked(a,d),this.isMouseDown=!0}},handle_mousemove:function(a){this._setZoomDivVisible(!1);var b=this.network.getLogicalPoint2(a);if(b){var c={x:a.screenX,y:a.screenY},d=this.network.getCanvasSize(),e=this.network.getViewRect().height,f=this.network.getViewRect().width,g=this.getScrollBarWidth();if(null!=this.hBarDownPoint){var h=c.x-this.hBarDownPoint.x;return this.hBarDownPoint=c,void this.network.setViewOffSet(h*d.width/(f-g),0)}if(null!=this.vBarDownPoint){var i=c.y-this.vBarDownPoint.y;return this.vBarDownPoint=c,void this.network.setViewOffSet(0,i*d.height/(e-g))}if(this.network.isSelectingElement()||this.network.isEditingElement()||!this.isMoving||!this.isMouseDown||Jb.isCtrlDown(a))if(this.isSelecting&&(Jb.isCtrlDown(a)||this._isDragToSelect()))this.network.setSelectingElement(!0),this.network.fireInteractionEvent(null==this.endPoint?{kind:"selectStart",event:a}:{kind:"selectBetween",event:a}),this.endPoint=b,this.repaint();else if(this.isMoving||this.isSelecting||!this.isMouseDown)this.end(a);else{if(!this.lastPanPoint||!this.network._dragToPan)return;var b=this.getMarkerPoint(a);if(!b)return;var j=b.x-this.lastPanPoint.x,k=b.y-this.lastPanPoint.y;this.network.panByOffset(-j,-k),this.network.fireInteractionEvent({kind:"panning",event:a}),this.network.state.panning=!0,this.lastPanPoint=b}else{var l=this.getOffset(b,this.lastPoint);if(this.xoffset=l.x,this.yoffset=l.y,Math.abs(this.xoffset)<1&&Math.abs(this.yoffset)<1)return;this.lazyMode?null==this.dragPoint?(this.network.fireInteractionEvent({kind:"lazyMoveStart",event:a}),this.network.setMovingElement(!0)):this.network.fireInteractionEvent({kind:"lazyMoveBetween",event:a}):(this.lastPoint=b,this.network.isMovingElement()?this.network.fireInteractionEvent({kind:"liveMoveBetween",event:a}):(this.network.setMovingElement(!0),this.network.fireInteractionEvent({kind:"liveMoveStart",event:a})),this.network.moveSelectedElements(this.xoffset,this.yoffset)),this.parentProcess(a,!1),this.lazyMode&&(this.dragPoint=b),(this.lazyMode||this.isParenting())&&this.repaint()}}},handleMouseWheel:function(a){if(Ob.activeElement===this.network.getView()){if(!this.network._wheelToZoom)return void this._handleMouseWheelScroll(a);Wb.preventDefault(a);var b={x:a.offsetX||a.layerX,y:a.offsetY||a.layerY},c=this.network.getZoom();a.wheelDelta&&a.wheelDelta>0||a.detail&&a.detail<0?this.network.setZoom(1.1*c,b):this.network.setZoom(c/1.1,b),this._setZoomDivVisible(this.network.isZoomDivVisible(),a,"Zoom : "+parseFloat(this.network.getZoom().toFixed(4)))}},_handleMouseWheelScroll:function(a){Wb.preventDefault(a);var b=!1,c=this._getVisibleScrollBar();null!=c&&(b=a.wheelDelta?a.wheelDelta>0:a.detail<0,"v"==c?this.scrollYOffset(b):this.scrollXOffset(b))},handle_mouseup:function(a){this.end(a)},isParenting:function(){return this.pressPoint&&null!=this.currentKeyEvent&&80===this.currentKeyEvent.keyCode},parentProcess:function(a,b){var c=null;this.parent=null;var d=this;if(!b&&this.isParenting()){var e={},f=this.network.getLogicalPoint2(a);e.x=f.x-1,e.y=f.y-1,e.width=2,e.height=2;var g=this.network.getElementsAtRect(e,!0);if(g&&g.size()>0)for(var h=g.size(),i=0;h>i;i++){var j=g.get(i);if(!d.network.getElementBox().getSelectionModel().contains(j)){d.parent=j;break}}}else this.parent=null;null!=this.parent&&(c=this.network.getElementUI(this.parent).getViewRect()),this.parentRect=null==c||b?null:c},getIntersectMode:function(){return"intersect"===this.network.getSelectMode()?!0:"contain"===this.network.getSelectMode()?!1:this.startPoint.x>this.endPoint.x&&this.startPoint.y>this.endPoint.y},_getVisibleScrollBar:function(){return 0==this.network.isScrollBarVisible()?null:null!=this.vThumbRect?"v":null!=this.hThumbRect?"h":null},paintScroll:function(a){if(0!=this.network.isScrollBarVisible()&&(0!=this.scrollBarVisible||null!=this.hBarDownPoint||null!=this.vBarDownPoint)){var b=this.getScrollBarWidth(),c=this.network.getViewRect().height,d=this.network.getViewRect().width;a.save();var e,f=this.getScrollBarColor();null!=this.hThumbRect&&(e=a.createLinearGradient(this.hThumbRect.x,this.hThumbRect.y,this.hThumbRect.x,this.hThumbRect.y+this.hThumbRect.height),e.addColorStop(0,f),e.addColorStop(1,"#666666"),this.paintRoundRect(a,this.getScrollBarColor(),.5,0,c-b,d-b,b,b/2),this.paintRoundRect(a,e,.9,this.hThumbRect.x,this.hThumbRect.y+1,this.hThumbRect.width,this.hThumbRect.height-2,b/2)),null!=this.vThumbRect&&(e=a.createLinearGradient(this.vThumbRect.x,this.vThumbRect.y,this.vThumbRect.x+this.vThumbRect.width,this.vThumbRect.y),e.addColorStop(0,f),e.addColorStop(1,"#666666"),this.paintRoundRect(a,this.getScrollBarColor(),.5,d-b,0,b,c-b,b/2),this.paintRoundRect(a,e,.9,this.vThumbRect.x+1,this.vThumbRect.y,this.vThumbRect.width-2,this.vThumbRect.height,b/2)),a.restore()}},paintRoundRect:function(a,b,c,d,e,f,g,h){a.beginPath(),a.globalAlpha=c,a.fillStyle=b,Xb.drawRoundRect(a,d,e,f,g,h),a.fill()},paint:function(a){if(this.paintScroll(a),this.network.isSelectingElement()){if(null==this.startPoint||null==this.endPoint)return;var b=this.convertPointFromView(this.startPoint),c=this.convertPointFromView(this.endPoint),d=b.x,e=b.y,f=c.x,g=c.y,h=Tb.getRect([{x:d,y:e},{x:f,y:g}]);if(null!=h){a.beginPath();var i=this.network.getSelectOutlineWidth(),j=this.getIntersectMode()?this.network.getSelectFillColor():null;a.strokeStyle=this.network.getSelectOutlineColor(),a.lineWidth=i,Od.rect(a,h.x,h.y,h.width,h.height,j,this.network.getSelectOutlineColor()),a.closePath()}}else{if(this.lazyMode){if(null==this.pressPoint||null==this.dragPoint)return;a.beginPath();var k=this.getOffset(this.dragPoint,this.pressPoint),l=k.x,m=k.y,n=this.network.getMovableSelectedElements(),o=n.size(),p=this.network.isLazyMoveFill()?this.network.getLazyMoveFillColor():null,i=this.network.getLazyMoveOutlineWidth(),q=this.network.getLazyMoveOutlineColor();a.strokeStyle=q,a.lineWidth=i,a.fillStyle=p;for(var r=0;o>r;r++){var s=n.get(r),t=this.network.getElementUI(s);if(t){var u=this.convertFromUIToMarkerRect(t.getViewRect(),l,m);Od.rect(a,u.x,u.y,u.width,u.height)}}a.fill(),a.stroke()}if(this.parentRect){a.beginPath();var p=this.network.isLazyMoveFill()?this.network.getLazyMoveFillColor():null,i=this.network.getLazyMoveOutlineWidth(),q=this.network.getLazyMoveOutlineColor();a.strokeStyle=q,a.lineWidth=i,a.fillStyle=p;var u=this.parentRect;Od.rect(a,u.x,u.y,u.width,u.height),a.fill(),a.stroke()}}},handleClicked:function(a,b){Cc.handleClicked(this.network,a,b)},handleDoubleClicked:function(a){var b=this.network.getElementAt(a);Cc.handleDoubleClicked(this.network,a,b)}}),Ib.vector.interaction.CreateElementInteraction=function(a,b){b||(b=Ib.Node),this.elementFunction=Ib.Util.isTypeOf(b,Ib.Node)?function(a){var c=new b;return c instanceof Ib.Node&&c.setCenterLocation(a),c}:b,Ib.vector.interaction.CreateElementInteraction.superClass.constructor.call(this,a)},Jb.ext("twaver.vector.interaction.CreateElementInteraction",Ib.vector.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown")},tearDown:function(){this.removeListener("mousedown")},handle_mousedown:function(a){var b=this.network.getLogicalPoint2(a);if(b){var c=this.elementFunction(b);c&&this.network.addElementByInteraction(c)}}}),Ib.vector.interaction.EditInteraction=function(a,b){this.lazyMode=b,this.pointIndex=-1,this.linkPointsType=null,Ib.vector.interaction.EditInteraction.superClass.constructor.call(this,a)},Jb.ext("twaver.vector.interaction.EditInteraction",Ib.vector.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown","mouseup","mousemove"),this.oldCursor=this.network.getView().style.cursor,this.network.setHasEditInteraction(!0),this.network.addMarker(this)},tearDown:function(){this.removeListener("mousedown","mouseup","mousemove"),this.network.getView().style.cursor=this.oldCursor,this.network.setHasEditInteraction(!1),this.clear(),this.network.removeMarker(this)},paint:function(a){if(1==this.lazyMode&&null!=this.resizingRect){a.lineWidth=this.network.getResizeLineWidth();var b=this.convertFromUIToMarkerRect(this.resizingRect,0,0,this.node);a.save(),Ib.Util.rotateCanvas(a,b,this.node.getAngle()),a.beginPath(),Od.rect(a,b.x,b.y,b.width,b.height,null,this.network.getResizeLineColor()),a.restore()}this.isStartRotate&&this.showRotateScale(a)},clear:function(){this.network.setEditingElement(!1),this.network.setRotatingElement(!1),this.isStart=!1,this.isStartRotate=!1,this.node=null,this.shapeNode=null,this.shapeLink=null,this.linkUI=null,this.resizingRect=null,this.resizeDirection=null,this.pointIndex=-1,this._removeCursor(),this.oldCursor=null,this.network.repaintTopCanvas()},_removeCursor:function(){this.cursorID&&(this.network.getView().style.cursor=this.oldCursor||"default",this.cursorID=null),this.resizeDirection=null,this.isCrossCursor=!1},_setCrossCursor:function(){this.isCrossCursor||(this._removeCursor(),this._setCursor("crosshair"),this.isCrossCursor=!0)},_setCursor:function(a){this.cursorID=a,this.network.getView().style.cursor!==this.cursorID&&(this.network.getView().style.cursor=this.cursorID)},handle_mousedown:function(a){if(0===a.button)if(!Jb.isAltDown(a)||this.network.isEditingElement())!this.network.isEditingElement()||this.isStart||this.isStartRotate||(this.node&&this.resizeDirection?(this.isStart=!0,this._handle_mousedown(a),this.network.fireInteractionEvent({kind:this.lazyMode?"lazyResizeStart":"liveResizeStart",event:a,element:this.node,resizeDirection:this.resizeDirection})):this.shapeNode&&this.pointIndex>=0?Jb.isAltDown(a)?(this.shapeNode.removeAt(this.pointIndex),this.network.fireInteractionEvent({kind:"removePoint",event:a,element:this.shapeNode})):(this.isStart=!0,this._handle_mousedown(a),this.network.fireInteractionEvent({kind:"liveMovePointStart",event:a,element:this.shapeNode,pointIndex:this.pointIndex})):this.shapeLink?Jb.isAltDown(a)?this.pointIndex>=0&&(this.shapeLink.removeAt(this.pointIndex),this.network.fireInteractionEvent({kind:"removePoint",event:a,element:this.shapeLink})):(this.isStart=!0,this._handle_mousedown(a),this.network.fireInteractionEvent({kind:"liveMovePointStart",event:a,element:this.shapeLink,pointIndex:this.pointIndex})):this.linkUI?(this.isStart=!0,this.network.fireInteractionEvent({kind:"liveMovePointStart",event:a,element:this.linkUI._element})):this.node&&(this.isStartRotate=!0,this._handle_mousedown(a)));else{var b=this.network.getElementAt(a),c=this.network.getLogicalPoint2(a);if(b instanceof Ib.ShapeNode){var d=this.getPointIndex(this.network.getShapeNodeZoomPoints(b),c,!0);d>0&&(this._handle_mousedown(a),this.pointIndex=d,this.shapeNode=b,b.addPoint(c,d),this._setCrossCursor(),this.network.setEditingElement(!0),this.isStart=!0,this.network.fireInteractionEvent({kind:"addPoint",event:a,element:b,pointIndex:d}),this.network.fireInteractionEvent({kind:"liveMovePointStart",event:a,element:b,pointIndex:d}))}if(b instanceof Ib.ShapeLink){var e=new Ib.List(b.getPoints()),f=this.network.getElementUI(b);e.add(f.getFromPoint(),0),e.add(f.getToPoint());var d=this.getPointIndex(e,c)-1;d>0&&(this._handle_mousedown(a),this.pointIndex=d,this.shapeLink=b,b.addPoint(c,d),this._setCrossCursor(),this.network.setEditingElement(!0),this.isStart=!0,this.network.fireInteractionEvent({kind:"addPoint",event:a,element:b,pointIndex:d}),this.network.fireInteractionEvent({kind:"liveMovePointStart",event:a,element:b,pointIndex:d}))}}},handle_mouseup:function(a){if(this.isStart){var b=this.network.getLogicalPoint2(a);if(this.resizingRect)if(this.lazyMode)if(this.network.isResizeAnimate()){var c=this,d=new Ib.animate.AnimateBounds(this.node,this.resizingRect,function(){c.network.fireInteractionEvent({kind:"lazyResizeEnd",event:a,element:c.node,resizeDirection:c.resizeDirection}),c.clear()});Ib.animate.AnimateManager.start(d)}else this.node.setLocation(this.resizingRect.x,this.resizingRect.y),this.node.setSize(this.resizingRect.width,this.resizingRect.height),this.network.fireInteractionEvent({kind:"lazyResizeEnd",event:a,element:this.node,resizeDirection:this.resizeDirection});else this.node.setLocation(this.resizingRect.x,this.resizingRect.y),this.node.setSize(this.resizingRect.width,this.resizingRect.height),this.network.fireInteractionEvent({kind:"liveResizeEnd",event:a,element:this.node,resizeDirection:this.resizeDirection});else this.shapeNode&&this.pointIndex>=0&&b?(this._resetShapeNodePoints(b),this.network.fireInteractionEvent({kind:"liveMovePointEnd",event:a,element:this.shapeNode,pointIndex:this.pointIndex})):b&&(this.shapeLink||this.linkUI)&&("from"===this.linkPointsType?this._setFromPoint(b):"to"===this.linkPointsType?this._setToPoint(b):"shapeControl"===this.linkPointsType?(this._resetShapeLinkPoints(b),this.network.fireInteractionEvent({kind:"liveMovePointEnd",event:a,element:this.shapeLink,pointIndex:this.pointIndex})):"control"===this.linkPointsType&&xc.isOrthogonalLink(this.linkUI._element)&&this.linkUI.getControlPoint()&&(this._setLinkControlPoint(b),this.network.fireInteractionEvent({kind:"liveMovePointEnd",event:a,element:this.linkUI._element})))}this._handle_mouseup(a),this.lazyMode||this.clear()},handle_mousemove:function(a){var b=this.network.getEditPointSize();if(this.network.isValidEvent(a)){if(this.isStartRotate&&this.node)return this._handleRotateElement(a,this.node),void(this.network.isShowRotateScale()&&this.repaint());if(this.isStart){if(this.shapeNode&&this.pointIndex>=0)return void this._handleMovingShapeNodePoint(a);if(this.node&&this.resizeDirection)return void this._handleResizing(a);if((this.shapeLink||this.linkUI)&&this.linkPointsType){if("from"===this.linkPointsType)return void this._handleMovingFromPoint(a);if("to"===this.linkPointsType)return void this._handleMovingToPoint(a);if("shapeControl"===this.linkPointsType)return void this._handleMovingShapeLinkPoint(a);if("control"===this.linkPointsType&&xc.isOrthogonalLink(this.linkUI._element)&&this.linkUI.getControlPoint())return void this._handleMovingLinkControlPoint(a)}}if(this.network.isSelectingElement()||this.network.isMovingElement()||0===this.network.getSelectionModel().size())return void this.clear();var c=this.network.getElementAt(a),d=this.network.getElementUI(c);if(!d||!d.getEditAttachment())return void this.clear();var e=this.network.getLogicalPoint2(a);if(c instanceof Ib.Node){if(this.node=c,this._isEditingShapeNode(e)||this._isResizingNode(e))return void this.network.setEditingElement(!0);if(this._isRotatingElement(e))return this.network.setRotatingElement(!0),void this.network.setEditingElement(!0)}else if(c instanceof Ib.Link){c instanceof Ib.ShapeLink?this.shapeLink=c:d instanceof Ib.vector.LinkUI&&(this.linkUI=d);var f,g=c.getFromAgent();f=g?c.getFromAgent():c.getFromNode();var h,i=c.getStyle("link.from.xoffset"),j=c.getStyle("link.from.yoffset"),k=this.network.getElementUI(f),l=k.getZoomBodyRect(),m={x:l.x+l.width/2,y:l.y+l.height/2},n={x:m.x+i,y:m.y+j},o=c.getToAgent();h=o?c.getToAgent():c.getToNode();var p=c.getStyle("link.to.xoffset"),q=c.getStyle("link.to.yoffset"),r=this.network.getElementUI(h),s=r.getZoomBodyRect(),t={x:s.x+s.width/2,y:s.y+s.height/2},u={x:t.x+p,y:t.y+q};if(n&&this._contains(e,n,b))return this.linkPointsType="from",this._setCrossCursor(),void this.network.setEditingElement(!0);if(u&&this._contains(e,u,b))return this.linkPointsType="to",this._setCrossCursor(),void this.network.setEditingElement(!0);if(c instanceof Ib.ShapeLink){if(this._isEditingShapeLink(e))return this.linkPointsType="shapeControl",void this.network.setEditingElement(!0)}else if(d instanceof Ib.vector.LinkUI){if(xc.isOrthogonalLink(d._element)){var v=this.linkUI.getControlPoint();if(v&&this._contains(e,v,b))return this.linkPointsType="control",this._setCrossCursor(),void this.network.setEditingElement(!0)}return void(this.linkPointsType=null)}this.linkPointsType=null}this.clear()}},_isRotatingElement:function(a){var b=this.network.getRotatePointSize();if(0>=b)return!1;var c=this.network.zoomManager,d=this.network.getElementUI(this.node),e=c.getSizeZoom(d),f=c._getElementZoomRect(d,this.node.getOriginalRect()),g=this.node.getAngle();return this._isRotating(a,"crosshair",f,g,e)},_isRotating:function(a,b,c,d,e){var f=this.network.getRotatePointSize()/this.network.getGraphicsZoom(),g={x:c.x+c.width/2,y:c.y-this.network.getRotatePointOffset()/this.network.getGraphicsZoom()-f},h=this._rotatePoint(g,d,c),i={x:h.x-f,y:h.y-f,width:2*f,height:2*f};return Tb.containsPoint(i,a)?(this._removeCursor(),this._setCursor(b),!0):!1},_handleRotateElement:function(a,b){this._handle_mousemove(a);var c=this._calculateAngle(this.network.getLogicalPoint2(a),b);b.setAngle(c)},_calculateAngle:function(a,b){var c=this.network.getZoomBodyRect(b),d=Tb.getCenterPoint(c);return Math.round(180*Math.atan2(d.x-a.x,a.y-d.y)/Math.PI+180)},_resetShapeNodePoints:function(a){var b=this.network.getShapeNodeZoomPoints(this.shapeNode);b.set(this.pointIndex,a);var c=this.network.getElementUI(this.shapeNode),d=this.network.zoomManager._getShapeNodeZoomPoints(c,b,!0);this.shapeNode.setPoints(d)},_handleMovingShapeNodePoint:function(a){var b=this.network.getLogicalPoint2(a);this._resetShapeNodePoints(b),this.network.fireInteractionEvent({kind:"liveMovePointBetween",e:a,element:this.shapeNode,pointIndex:this.pointIndex})},_resetShapeLinkPoints:function(a){var b=this.network.zoomManager._getShapeLinkZoomPoints(this.shapeLink._points);b.set(this.pointIndex,a);var c=this.network.zoomManager._getShapeLinkZoomPoints(b,!0);this.shapeLink.setPoints(c)},_handleMovingShapeLinkPoint:function(a){var b=this.network.getLogicalPoint2(a);this._resetShapeLinkPoints(b),this.network.fireInteractionEvent({kind:"liveMovePointBetween",e:a,element:this.shapeLink,pointIndex:this.pointIndex})},_setLinkControlPoint:function(a){var b=this.linkUI.getControlPoint(),c=this.linkUI.getControlPoint(),d=(this.network.zoomManager,{x:a.x-c.x,y:a.y-c.y});b.x+=d.x,b.y+=d.y,this.linkUI.setControlPoint(b)},_handleMovingLinkControlPoint:function(a){var b=this.network.getLogicalPoint2(a);this._setLinkControlPoint(b),this.network.fireInteractionEvent({kind:"liveMovePointBetween",e:a,element:this.linkUI._element})},_setFromPoint:function(a){var b;if(this.linkUI)b=this.linkUI._element;else{if(!this.shapeLink)return;b=this.shapeLink}var c,d=b.getFromAgent();c=d?b.getFromAgent():b.getFromNode();var e=this.network.getElementUI(c),f=e.getZoomBodyRect(),g={x:f.x+f.width/2,y:f.y+f.height/2},h={x:a.x-g.x,y:a.y-g.y};b.setStyle("link.from.xoffset",h.x),b.setStyle("link.from.yoffset",h.y)},_handleMovingFromPoint:function(a){var b=this.network.getLogicalPoint2(a);this._setFromPoint(b)},_setToPoint:function(a){var b;if(this.linkUI)b=this.linkUI._element;else{if(!this.shapeLink)return;b=this.shapeLink}var c,d=b.getToAgent();c=d?b.getToAgent():b.getToNode();var e=this.network.getElementUI(c),f=e.getZoomBodyRect(),g={x:f.x+f.width/2,y:f.y+f.height/2},h={x:a.x-g.x,y:a.y-g.y};b.setStyle("link.to.xoffset",h.x),b.setStyle("link.to.yoffset",h.y)},_handleMovingToPoint:function(a){var b=this.network.getLogicalPoint2(a);this._setToPoint(b)},convertFromUIToMarkerRect:function(a,b,c,d){var e=this.network.zoomManager,f=e.getLocationZoom(),g=e.getGraphicsZoom(),h=this.network.getElementUI(d),i=e.getSizeZoom(h),j=a.x+a.width/2,k=a.y+a.height/2,l=j-a.x,m=k-a.y;return{x:j*f*g-this.network.getViewRect().x+b*f*g-l*i*g,y:k*f*g-this.network.getViewRect().y+c*f*g-m*i*g,width:a.width*i*g,height:a.height*i*g}},_getReverseZoomPoint:function(a,b,c){var d=this.network.zoomManager,e=d.getLocationZoom(),f=d.getSizeZoom(this.network.getElementUI(a));return b.x*=e,b.y*=e,{x:b.x/e+(c.x-b.x)/f,y:b.y/e+(c.y-b.y)/f}},_getReverseZoomRect:function(a,b){var c=this.network.zoomManager,d=c.getLocationZoom(),e=c.getSizeZoom(f);if(d==e)return a;var f=this.network.getElementUI(b),g=f.getBodyRect(),h=g.x+g.width/2,i=g.y+g.height/2,j={x:h*d+(a.x-h)*e,y:i*d+(a.y-i)*e,width:a.width*e,height:a.height*e};return h=j.x+j.width/2,i=j.y+j.height/2,{x:h/d+(j.x-h)*e,y:i/d+(j.y-i)*e,width:a.width,height:a.height}},_handleResizing:function(a){this._handle_mousemove(a);var b=this.node.getAngle(),c=this.node.getLocation(),d=this.node.getWidth()/2,e=this.node.getHeight()/2,f={x:c.x+d,y:c.y+e},g={x:-d,y:-e},h={x:-d,y:e},i={x:d,y:e},j={x:d,y:-e},k={x:0,y:-e},l={x:d,y:0},m={x:0,y:e},n={x:-d,y:0},o=this._getReverseZoomPoint(this.node,Jb.clone(f),this._endLogical);if("northwest"===this.resizeDirection&&(this._transformPoint(i,f,b),g.x=o.x,g.y=o.y,f.x=(g.x+i.x)/2,f.y=(g.y+i.y)/2,this._reversPoint(g,f,b),this._reversPoint(i,f,b),this.resizingRect={x:g.x,y:g.y,width:i.x-g.x,height:i.y-g.y},Jb.isShiftDown(a)&&this._revertResizeRect(this.node,this.resizingRect,1)),"north"===this.resizeDirection){var p={x:o.x,y:o.y};this._reversPoint(p,f,b),k.y=p.y-f.y,this._transformPoint(k,f,b),this._transformPoint(m,f,b),f.x=(k.x+m.x)/2,f.y=(k.y+m.y)/2,this._reversPoint(k,f,b),this._reversPoint(m,f,b),this.resizingRect={x:f.x-this.node.getWidth()/2,y:f.y-(m.y-k.y)/2,width:this.node.getWidth(),height:m.y-k.y}}if("northeast"===this.resizeDirection&&(this._transformPoint(h,f,b),j.x=o.x,j.y=o.y,f.x=(h.x+j.x)/2,f.y=(h.y+j.y)/2,this._reversPoint(h,f,b),this._reversPoint(j,f,b),this.resizingRect={x:h.x,y:j.y,width:j.x-h.x,height:h.y-j.y},Jb.isShiftDown(a)&&this._revertResizeRect(this.node,this.resizingRect,2)),"west"===this.resizeDirection){var p={x:o.x,y:o.y};this._reversPoint(p,f,b),n.x=p.x-f.x,this._transformPoint(l,f,b),this._transformPoint(n,f,b),f.x=(l.x+n.x)/2,f.y=(l.y+n.y)/2,this._reversPoint(l,f,b),this._reversPoint(n,f,b),this.resizingRect={x:f.x-(l.x-n.x)/2,y:f.y-this.node.getHeight()/2,width:l.x-n.x,height:this.node.getHeight()}}if("east"===this.resizeDirection){var p={x:o.x,y:o.y};this._reversPoint(p,f,b),l.x=p.x-f.x,this._transformPoint(l,f,b),this._transformPoint(n,f,b),f.x=(l.x+n.x)/2,f.y=(l.y+n.y)/2,this._reversPoint(l,f,b),this._reversPoint(n,f,b),this.resizingRect={x:f.x-(l.x-n.x)/2,y:f.y-this.node.getHeight()/2,width:l.x-n.x,height:this.node.getHeight()}}if("southwest"===this.resizeDirection&&(this._transformPoint(j,f,b),h.x=o.x,h.y=o.y,f.x=(h.x+j.x)/2,f.y=(h.y+j.y)/2,this._reversPoint(h,f,b),this._reversPoint(j,f,b),this.resizingRect={x:h.x,y:j.y,width:j.x-h.x,height:h.y-j.y},Jb.isShiftDown(a)&&this._revertResizeRect(this.node,this.resizingRect,4)),"south"===this.resizeDirection){var p={x:o.x,y:o.y};this._reversPoint(p,f,b),m.y=p.y-f.y,this._transformPoint(k,f,b),this._transformPoint(m,f,b),f.x=(k.x+m.x)/2,f.y=(k.y+m.y)/2,this._reversPoint(k,f,b),this._reversPoint(m,f,b),this.resizingRect={x:f.x-this.node.getWidth()/2,y:f.y-(m.y-k.y)/2,width:this.node.getWidth(),height:m.y-k.y}}"southeast"===this.resizeDirection&&(this._transformPoint(g,f,b),i.x=o.x,i.y=o.y,f.x=(g.x+i.x)/2,f.y=(g.y+i.y)/2,this._reversPoint(g,f,b),this._reversPoint(i,f,b),this.resizingRect={x:g.x,y:g.y,width:i.x-g.x,height:i.y-g.y},Jb.isShiftDown(a)&&this._revertResizeRect(this.node,this.resizingRect,3)),
this.resizingRect=this._getReverseZoomRect(this.resizingRect,this.node),this.lazyMode?(this.repaint(),this.network.fireInteractionEvent({kind:"lazyResizeBetween",event:a,element:this.node,resizeDirection:this.resizeDirection})):(this.node.setLocation(this.resizingRect.x,this.resizingRect.y),this.node.setSize(this.resizingRect.width,this.resizingRect.height),this.network.fireInteractionEvent({kind:"liveResizeBetween",event:a,element:this.node,resizeDirection:this.resizeDirection}))},_revertResizeRect:function(a,b,c){var d=a.getOriginalRect(),e=Math.max(b.width/d.width,b.height/d.height),f=d.width*e,g=d.height*e,h=b.x,i=b.y;1==c?(h+=b.width-f,i+=b.height-g):2==c?i+=b.height-g:3==c||4==c&&(h+=b.width-f),b.x=h,b.y=i,b.width=f,b.height=g},_isEditingShapeNode:function(a){var b=this.network.getEditPointSize();if(this.node instanceof Ib.ShapeNode){this.shapeNode=this.node;for(var c=this.network.getShapeNodeZoomPoints(this.node),d=0,e=c.size();e>d;d++){var f=c.get(d);if(this._contains(a,f,b))return this._setCrossCursor(),this.pointIndex=d,!0}}return this.pointIndex=-1,!1},_isEditingShapeLink:function(a){for(var b=this.network.getEditPointSize(),c=this.network.zoomManager._getShapeLinkZoomPoints(this.shapeLink.getPoints()),d=0,e=c.size();e>d;d++){var f=c.get(d);if(this._contains(a,f,b))return this._setCrossCursor(),this.pointIndex=d,!0}return this.pointIndex=-1,!1},_isResizingNode:function(a){var b=this.network.getResizePointSize();if(0>=b)return!1;var c=this.network.zoomManager,d=this.network.getElementUI(this.node),e=c._getElementZoomRect(d,this.node.getOriginalRect()),f=this.node.getAngle(),g={x:e.x,y:e.y},h=this._rotatePoint(g,f,e);return this._isResizing(a,h.x,h.y,"northwest","nwse-resize")?!0:(g={x:e.x+e.width/2,y:e.y},h=this._rotatePoint(g,f,e),this._isResizing(a,h.x,h.y,"north","ns-resize")?!0:(g={x:e.x+e.width,y:e.y},h=this._rotatePoint(g,f,e),this._isResizing(a,h.x,h.y,"northeast","nesw-resize")?!0:(g={x:e.x,y:e.y+e.height/2},h=this._rotatePoint(g,f,e),this._isResizing(a,h.x,h.y,"west","ew-resize")?!0:(g={x:e.x+e.width,y:e.y+e.height/2},h=this._rotatePoint(g,f,e),this._isResizing(a,h.x,h.y,"east","ew-resize")?!0:(g={x:e.x,y:e.y+e.height},h=this._rotatePoint(g,f,e),this._isResizing(a,h.x,h.y,"southwest","nesw-resize")?!0:(g={x:e.x+e.width/2,y:e.y+e.height},h=this._rotatePoint(g,f,e),this._isResizing(a,h.x,h.y,"south","ns-resize")?!0:(g={x:e.x+e.width,y:e.y+e.height},h=this._rotatePoint(g,f,e),this._isResizing(a,h.x,h.y,"southeast","nwse-resize")?!0:!1)))))))},_rotatePoint:function(a,b,c){var d=Tb.createMatrix(b*Math.PI/180,c.x+c.width/2,c.y+c.height/2),e=d.transform(a);return e},_isResizing:function(a,b,c,d,e){var f=this.network.getGraphicsZoom(),g=this.network.getResizePointSize()/f;return this._contains(a,{x:b,y:c},g)?(this.resizeDirection!==d&&(this._removeCursor(),e=this._changeCursorWithAngle(d,this.node.getAngle()),this._setCursor(e),this.resizeDirection=d),!0):!1},_getRect:function(a,b,c,d){var e=c>a?a:c,f=d>b?b:d,g=Math.abs(a-c),h=Math.abs(b-d);return{x:e,y:f,width:g,height:h}},_contains:function(a,b,c){var d={x:b.x-c,y:b.y-c,width:2*c,height:2*c};return Tb.containsPoint(d,a)},getPointIndex:function(a,b,c){if(a.size()<2)return 0;for(var d,e=a.get(0),f=1;f<a.size();f++){if(d=a.get(f),this.isPointOnLine(b,e,d,6))return f;e=d}return e=a.get(0),c&&this.isPointOnLine(b,e,d,6)?a.size():0},showRotateScale:function(a){var b,c,d,e,f,g=(new Ib.List,this.network.getRotateScaleWidth()),h=this.network.getRotateScaleHeight(),i=this.network.getRotatePointSize(),j=this.node.getAngle(),k=this.network.zoomManager,l=this.network.getElementUI(this.node),m=k._getElementZoomRect(l,this.node.getOriginalRect()),n={x:m.x+m.width/2,y:m.y-this.network.getRotatePointOffset()-i},o=this._rotatePoint(n,j,m),p="13px Arial",q=j+"°",r=this.network.getViewRect();1===k.getLocationZoom()&&(a.translate(-r.x,-r.y),a.scale(this.network.getZoom(),this.network.getZoom())),this.node.getAngle()>=0&&this.node.getAngle()<=180?(c={x:o.x+i,y:o.y},d={x:c.x+g,y:c.y},e={x:d.x,y:d.y-h},f={x:c.x,y:e.y}):this.node.getAngle()>180&&this.node.getAngle()<=360&&(c={x:o.x-i,y:o.y},d={x:c.x-g,y:c.y},e={x:d.x,y:d.y-h},f={x:c.x,y:e.y});var s=new Ib.List([c,d,e,f]),b=Jb.math.getRect(s);1!==k.getLocationZoom()&&(b.x-=r.x,b.y-=r.y),a.fillStyle=this.network.getRotateScaleFillColor(),a.fillRect(b.x,b.y,b.width,b.height),a.fillStyle=this.network.getRotateScaleFontColor(),a.textBaseline="middle",a.textAlign="center",a.font=p,a.fillText(q,b.x+b.width/2,b.y+b.height/2),1===k.getLocationZoom()&&(a.scale(1/this.network.getZoom(),1/this.network.getZoom()),a.translate(r.x,r.y))},isPointOnLine:function(a,b,c,d){0>d&&(d=0);var e=this.getDistanceFromPointToLine(a,b,c);return d>=e&&a.x>=Math.min(b.x,c.x)-d&&a.x<=Math.max(b.x,c.x)+d&&a.y>=Math.min(b.y,c.y)-d&&a.y<=Math.max(b.y,c.y)+d},getDistanceFromPointToLine:function(a,b,c){if(b.x===c.x)return Math.abs(a.x-b.x);var d=(c.y-b.y)/(c.x-b.x),e=(c.x*b.y-b.x*c.y)/(c.x-b.x);return Math.abs(d*a.x-a.y+e)/Math.sqrt(d*d+1)},_transformPoint:function(a,b,c){var d=Math.cos(c*Math.PI/180),e=Math.sin(c*Math.PI/180),f=a.x,g=a.y,h=f*d-g*e,i=f*e+g*d;a.x=h+b.x,a.y=i+b.y},_reversPoint:function(a,b,c){c*=-1;var d=Math.cos(c*Math.PI/180),e=Math.sin(c*Math.PI/180),f=a.x-b.x,g=a.y-b.y,h=f*d-g*e,i=f*e+g*d;a.x=h+b.x,a.y=i+b.y},_changeCursorWithAngle:function(a,b){var c,d=["auto","nwse-resize","ns-resize","nesw-resize","ew-resize","nwse-resize","ns-resize","nesw-resize","ew-resize"];switch(a){case"northwest":c=1;break;case"north":c=2;break;case"northeast":c=3;break;case"east":c=4;break;case"southeast":c=5;break;case"south":c=6;break;case"southwest":c=7;break;case"west":c=8;break;default:c=0}return(b>=360||-360>=b)&&(b%=360),b>22.5&&67.5>=b&&(c+=1),-22.5>b&&b>=-67.5&&(c-=1),b>67.5&&112.5>=b&&(c+=2),-67.5>b&&b>=-112.5&&(c-=2),b>112.5&&157.5>=b&&(c+=3),-112.5>b&&b>=-157.5&&(c-=3),b>157.5&&202.5>=b&&(c+=4),-157.5>b&&b>=-202.5&&(c-=4),b>202.5&&247.5>=b&&(c+=5),-202.5>b&&b>=-247.5&&(c-=5),b>247.5&&292.5>=b&&(c+=6),-247.5>b&&b>=-292.5&&(c-=6),b>292.5&&337.5>=b&&(c+=7),-292.5>b&&b>=-337.5&&(c-=7),c>8&&(c-=8),0>=c&&(c+=8),d[c]}}),Ib.vector.interaction.CreateLinkInteraction=function(a,b){b||(b=Ib.Link),this.linkFunction=Ib.Util.isTypeOf(b,Ib.Link)?function(a,c){var d=new b;return d instanceof Ib.Link&&(d.setFromNode(a),d.setToNode(c)),d}:b,Ib.vector.interaction.CreateLinkInteraction.superClass.constructor.call(this,a)},Jb.ext("twaver.vector.interaction.CreateLinkInteraction",Ib.vector.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown","mousemove"),this.network.addMarker(this)},tearDown:function(){this.removeListener("mousedown","mousemove"),this.clear(),this.network.removeMarker(this)},paint:function(a){a.beginPath();var b,c;a.lineWidth=this.network.getEditLineWidth();var d=this.network.getEditLineColor();this.currentNode&&this.currentNode!==this.fromNode&&(b=this.network.getElementUI(this.currentNode).getZoomViewRect(!0),c=this.convertFromUIToMarkerRect(b,0,0),Od.rect(a,c.x,c.y,c.width,c.height,null,d)),this.fromNode&&(b=this.network.getElementUI(this.fromNode).getZoomViewRect(!0),c=this.convertFromUIToMarkerRect(b,0,0),Od.rect(a,c.x,c.y,c.width,c.height,null,d)),this.currentPoint&&this.paintLine(a),a.closePath()},convertFromUIToMarkerRect:function(a,b,c){var d=this.network.zoomManager,e=d.getGraphicsZoom();return{x:a.x*e-this.network.getViewRect().x+b*e,y:a.y*e-this.network.getViewRect().y+c*e,width:a.width*e,height:a.height*e}},getZoomNodeRectOrPoint:function(a,b){var c=this.network.getElementUI(a).getZoomBodyRect();return b?{x:c.x+c.width/2,y:c.y+c.height/2}:c},paintLine:function(a){var b=this.network.getEditLineColor(),c=this.network.getElementUI(this.fromNode).getZoomBodyRect(),d=this.convertPointFromView({x:c.x+c.width/2,y:c.y+c.height/2}),e=d.x,f=d.y,g=this.currentPoint.x,h=this.currentPoint.y;a.strokeStyle=b,a.beginPath(),a.moveTo(e,f),a.lineTo(g,h),a.stroke()},clear:function(){this.currentPoint=null,this.currentNode=null,this.fromNode=null,this.toNode=null},createLink:function(){return this.linkFunction(this.fromNode,this.toNode)},handle_mousedown:function(a){if(this.network.isValidEvent(a))if(this.fromNode){if(this.toNode=this.currentNode,this.toNode){var b=this.createLink();b&&this.network.addElementByInteraction(b)}this.clear()}else this.fromNode=this.currentNode,this.currentNode=null,this.currentPoint=null,this.repaint()},handle_mousemove:function(a){var b=this.getMarkerPoint(a);if(b){if(this.network.isMovingElement()||this.network.isEditingElement())return void this.clear();var c=null;this.fromNode?(this.currentNode=this.getToNode(a,this.fromNode),this.currentPoint=b,this.repaint()):(c=this.getFromNode(a),this.currentNode!==c&&(this.currentNode=c,this.repaint()))}},getFromNode:function(a){return this.getNode(a)},getToNode:function(a,b){return this.getNode(a,b)},getNode:function(a,b){var c=this.network.getElementAt(a);return c instanceof Ld&&this.network.isLinkable(c,b)&&this.network.getElementBox().getSelectionModel().isSelectable(c)?c:null}}),Ib.vector.interaction.CreateShapeLinkInteraction=function(a,b){Ib.vector.interaction.CreateShapeLinkInteraction.superClass.constructor.call(this,a),b||(b=Ib.ShapeLink),this.linkFunction=Ib.Util.isTypeOf(b,Ib.ShapeLink)?function(a,c,d){var e=new b;if(e instanceof Ib.ShapeLink&&(e.setFromNode(a),e.setToNode(c),d)){var f=this.network.zoomManager;e.setPoints(f._getShapeLinkZoomPoints(d,!0))}return e}:b},Jb.ext("twaver.vector.interaction.CreateShapeLinkInteraction",Ib.vector.interaction.CreateLinkInteraction,{clear:function(){this.points=null,Ib.vector.interaction.CreateShapeLinkInteraction.superClass.clear.call(this)},createLink:function(){return this.linkFunction(this.fromNode,this.toNode,this.points)},handle_mousedown:function(a){if(0===a.button){var b=this.network.getLogicalPoint2(a);if(b){if(this.fromNode)if(this.toNode=this.currentNode,this.toNode){var c=this.createLink();c&&this.network.addElementByInteraction(c),this.clear()}else{if(this.points||(this.points=new Ib.List),this.points.size()>0){var d=this.points.get(this.points.size()-1);if(d.x===b.x&&d.y===b.y)return}this.points.add(b)}else this.fromNode=this.currentNode,this.points=null,this.currentNode=null,this.currentPoint=null;this.repaint()}}},paintLine:function(a){if(this.currentPoint){var b,c=new Ib.List;if(b=this.convertPointFromView(this.getZoomNodeRectOrPoint(this.fromNode,!0)),c.add(b,0),this.points&&this.points.size()>0)for(var d=this.points.size(),e=0;d>e;e++)b=this.convertPointFromView(this.points.get(e)),c.add(b);b=this.currentPoint,c.add(b),a.lineWidth=this.network.getEditLineWidth(),a.strokeStyle=this.network.getEditLineColor(),a.beginPath(),Xb.drawLinePoints(a,c),a.stroke()}}}),Ib.vector.interaction.CreateShapeNodeInteraction=function(a,b){b||(b=Ib.ShapeNode),this.shapeNodeFunction=Ib.Util.isTypeOf(b,Ib.ShapeNode)?function(a){var c=new b;if(c instanceof Ib.ShapeNode){var d=this.network.zoomManager,e=this.network.createElementUI(c);if(a){var f=d._getShapeNodeZoomPoints(e,a,!0);e.invalidateZoom(),c.setPoints(f)}}return c}:b,Ib.vector.interaction.CreateShapeNodeInteraction.superClass.constructor.call(this,a),this.timeStamp=-1},Jb.ext("twaver.vector.interaction.CreateShapeNodeInteraction",Ib.vector.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown","mousemove"),this.network.addMarker(this)},tearDown:function(){this.removeListener("mousedown","mousemove"),this.clear(),this.network.removeMarker(this),this.network.setEditingElement(!1)},clear:function(){this.points=null,this.currentPoint=null},paint:function(a){if(this.points&&this.points.size()>0&&this.currentPoint){for(var b,c=new Ib.List,d=this.points.size(),e=0;d>e;e++)b=this.convertPointFromView(this.points.get(e)),c.add(b);b=this.convertPointFromView(this.currentPoint),c.add(b),a.lineWidth=this.network.getEditLineWidth(),a.strokeStyle=this.network.getEditLineColor(),a.beginPath(),Xb.drawLinePoints(a,c),a.stroke()}},handle_mousedown:function(a){if(0===a.button){var b=this.network.getLogicalPoint2(a);if(b){if(2===a.detail||a.timeStamp-this.timeStamp<300){if(this.points){var c=this.shapeNodeFunction(this.points);this.network.addElementByInteraction(c),this.clear();var d=this;setTimeout(function(){d.network.setEditingElement(!1)},0)}}else{if(this.network.isEditingElement()||this.network.setEditingElement(!0),this.points||(this.points=new Ib.List),this.points.size()>0){var e=this.points.get(this.points.size()-1);if(e.x===b.x&&e.y===b.y)return}this.points.add(b)}this.timeStamp=a.timeStamp,this.repaint()}}},handle_mousemove:function(a){this.points&&(this.currentPoint=this.network.getLogicalPoint2(a),this.repaint())}}),Ib.vector.interaction.MagnifyInteraction=function(a,b,c,d,e){Ib.vector.interaction.MagnifyInteraction.superClass.constructor.call(this,a),this.scale=b||2,this.xRadius=c||100,this.yRadius=d||100,this.shape=e||"circle",this.borderColor="black",this.borderWidth=1,this.backgroundColor="white",this.markCanvas=Wb.createCanvas()},Jb.ext("twaver.vector.interaction.MagnifyInteraction",Ib.vector.interaction.BaseInteraction,{setUp:function(){this.addListener("mousemove"),this.addListener("mousewheel"),this.network.addMarker(this)},tearDown:function(){this.removeListener("mousemove"),this.removeListener("mousewheel"),this.network.removeMarker(this)},paint:function(a){if(this.point){var b=this.network.zoomManager,c=b.getLocationZoom(),d=b.getGraphicsZoom(),e=(b.getSizeZoom(),this.network.getZoom(),this.xRadius/this.scale/d),f=this.yRadius/this.scale/d;if("mousewheel"===this.mouseFlag){var g={x:this.zoomPoint.x-e,y:this.zoomPoint.y-f,width:2*e,height:2*f};this.network.toCanvasByRegion(g,this.scale*d,this.markCanvas,"white");var h={x:this.zoomPoint.x-this.xRadius-this.network.viewRect.x,y:this.zoomPoint.y-this.yRadius-this.network.viewRect.y,width:this.markCanvas.width,height:this.markCanvas.height}}else{var g={x:this.point.x*c-e,y:this.point.y*c-f,width:2*e,height:2*f};this.network.toCanvasByRegion(g,this.scale*d,this.markCanvas,"white");var h={x:this.point.x*c*d-this.xRadius-this.network.viewRect.x,y:this.point.y*c*d-this.yRadius-this.network.viewRect.y,width:this.markCanvas.width,height:this.markCanvas.height}}a.save(),a.beginPath(),Xb.drawVector(a,this.shape,null,h.x,h.y,2*g.width*d,2*g.height*d),a.clip(),a.fillStyle=this.backgroundColor,a.beginPath(),a.rect(h.x,h.y,h.width,h.height),a.fill(),a.drawImage(this.markCanvas,h.x,h.y),a.restore(),a.beginPath(),a.lineWidth=this.borderWidth,Xb.drawVector(a,this.shape,null,h.x+this.borderWidth/2,h.y+this.borderWidth/2,2*g.width*d-this.borderWidth,2*g.height*d-this.borderWidth),a.strokeStyle=this.borderColor,a.stroke(),this.mouseFlag=null}},handle_mousemove:function(a){this.point=this.network.getLogicalPoint(a),this.point&&(this.mouseFlag="mousemove",this.repaint())},handle_mousewheel:function(a){var b=this.network.zoomManager,c=b.getLocationZoom();1!==c&&(this.zoomPoint=this.network.getLogicalPoint2(a)),this.zoomPoint&&(this.mouseFlag="mousewheel",this.repaint())},getScale:function(){return this.scale},setScale:function(a){this.scale=a,this.network.repaintTopCanvas()},getShape:function(){return this.shape},setShape:function(a){this.shape=a,this.network.repaintTopCanvas()},getXRadius:function(){return this.xRadius},setXRadius:function(a){this.xRadius=a,this.network.repaintTopCanvas()},getYRadius:function(){return this.yRadius},setYRadius:function(a){this.yRadius=a,this.network.repaintTopCanvas()},getBorderColor:function(){return this.borderColor},setBorderColor:function(a){this.borderColor=a,this.network.repaintTopCanvas()},getBorderWidth:function(){return this.borderWidth},setBorderWidth:function(a){this.borderWidth=a,this.network.repaintTopCanvas()},getBackgroundColor:function(){return this.backgroundColor},setBackgroundColor:function(a){this.backgroundColor=a,this.network.repaintTopCanvas()}}),Ib.vector.interaction.TouchInteraction=function(a){Ib.vector.interaction.TouchInteraction.superClass.constructor.call(this,a)},Jb.ext("twaver.vector.interaction.TouchInteraction",Ib.vector.interaction.BaseInteraction,{setUp:function(){var a=this.network.getView();Wb.addEventListener("touchstart","handleTouchstart",a,this),Wb.addEventListener("touchmove","handleTouchmove",a,this),Wb.addEventListener("touchend","handleTouchend",a,this),Wb.addEventListener("touchcancel","handleTouchend",a,this)},tearDown:function(){var a=this.network.getView();Wb.removeEventListener("touchstart",a,this),Wb.removeEventListener("touchmove",a,this),Wb.removeEventListener("touchend",a,this),Wb.removeEventListener("touchcancel",a,this)},handleTouchstart:function(a){if(Wb.preventDefault(a),1==a.touches.length){var b=this.network.getLogicalPoint2(a),c=this._element=this.network.getElementAt(b);this._startTouchTime=new Date,this._currentTouchPoint=b,this._startTouchClient=this._currentTouchClient=this.getMarkerPoint(a),c?this.network.getSelectionModel().contains(c)||this.network.getSelectionModel().setSelection(c):this.network.getSelectionModel().clearSelection(),Cc.handleClicked(this.network,a,c),this._endTouchTime&&this._startTouchTime.getTime()-this._endTouchTime.getTime()<=500&&Tb.getDistance(this._endTouchClient,this._startTouchClient)<=20?(delete this._endTouchTime,delete this._endTouchClient,Cc.handleDoubleClicked(this.network,a,c)):(this._endTouchTime=this._startTouchTime,this._endTouchClient=this._startTouchClient)}else this._distance=zc.getDistance(a),this._zoom=this.network.getZoom()},handleTouchmove:function(a){if(Wb.preventDefault(a),a.touches.length>1){var b=zc.getDistance(a);if(Math.abs(b-this._distance)<20)return;var c=b/this._distance;this.network.setZoom(this._zoom*c,!1)}else if(null==this._zoom){var d=this.getMarkerPoint(a);if(Tb.getDistance(this._startTouchClient,d)<20)return;if(this._element){var e=this.network.getLogicalPoint2(a),f=this.getOffset(e,this._currentTouchPoint),g=f.x,h=f.y;this._currentTouchPoint=e,this.network.moveSelectedElements(g,h),this.network.isMovingElement()?this.network.fireInteractionEvent({kind:"liveMoveBetween",event:a}):(this.network.setMovingElement(!0),this.network.fireInteractionEvent({kind:"liveMoveStart",event:a}))}else{var g=this._currentTouchClient.x-d.x,h=this._currentTouchClient.y-d.y;this.network.panByOffset(g,h),this._currentTouchClient=d}}},handleTouchend:function(a){Wb.preventDefault(a),this.network.isMovingElement()&&(this.network.setMovingElement(!1),this.network.fireInteractionEvent({kind:"liveMoveEnd",event:a})),0===a.touches.length&&(this._distance=null,this._zoom=null,this._element=null,this._startTouchTime=null,this._currentTouchPoint=null,this._startTouchClient=this._currentTouchClient=null)}}),Ib.vector.interaction.MSTouchInteraction=function(a){Ib.vector.interaction.MSTouchInteraction.superClass.constructor.call(this,a),this._pointerMap={},this._pointerIdArray=[]},Jb.ext("twaver.vector.interaction.MSTouchInteraction",Ib.vector.interaction.BaseInteraction,{setUp:function(){var a=this.network.getView();Wb.addEventListener("MSPointerDown","handleTouchstart",a,this),Wb.addEventListener("MSPointerMove","handleTouchmove",a,this),Wb.addEventListener("MSPointerUp","handleTouchend",a,this),Wb.addEventListener("MSPointerCancel","handleTouchend",a,this),this.network.addMarker(this)},tearDown:function(){var a=this.network.getView();Wb.removeEventListener("MSPointerDown",a,this),Wb.removeEventListener("MSPointerMove",a,this),Wb.removeEventListener("MSPointerUp",a,this),Wb.removeEventListener("MSPointerCancel",a,this),this.network.removeMarker(this)},handleTouchstart:function(a){if(this.network.isFocusOnClick()&&Ib.Util.setFocus(this.network._view),!this.network.isSelectingElement()||a.pointerType!=a.MSPOINTER_TYPE_MOUSE){var b=this.network.getLogicalPoint2(a),c=new Date;if(a.isPrimary&&this._pointerIdArray.length>0&&this.handle_mouseup(a),this._pointerMap[a.pointerId]||(this._pointerIdArray.push(a.pointerId),this._pointerMap[a.pointerId]=a),1==this._pointerIdArray.length){var d=this.network.getElementAt(b);this._startTouchElement=d,this._startClientPoint={x:a.clientX,y:a.clientY};var e=this.network.getSelectionModel();d?Jb.isCtrlDown(a)?e.contains(d)?e.removeSelection(d):e.appendSelection(d):e.contains(d)||e.setSelection(d):Jb.isCtrlDown(a)||e.clearSelection(),Cc.handleClicked(this.network,a,d),this._startTouchTime&&this._startTouchPoint&&c.getTime()-this._startTouchTime.getTime()<=500&&Tb.getDistance(this._startTouchPoint,b)<=20?(Cc.handleDoubleClicked(this.network,a,d),this._doubleClick=!0):(Wb.handle_mousedown(this,a),this._startTouchPoint=b,this._startTouchTime=c)}else 2==this._pointerIdArray.length&&(this._distance=this._getDistance(),this._zoom=this.network.getZoom())}},handleTouchmove:function(a){if(null!=this._startTouchPoint&&0!=this._pointerIdArray.length&&this._pointerMap[a.pointerId]&&!(Tb.getDistance({x:this._pointerMap[a.pointerId].pageX,y:this._pointerMap[a.pointerId].pageY},{x:a.pageX,y:a.pageY})<=10)&&(this._pointerMap[a.pointerId]=a,2==this._pointerIdArray.length)){var b=this._getDistance()/this._distance;this.network.setZoom(this._zoom*b,!1)}},handleTouchend:function(a){if(this.network.isMovingElement()&&(this.network.setMovingElement(!1),this.network.fireInteractionEvent({kind:"liveMoveEnd",event:a})),this.network.isSelectingElement()){var b=Tb.getRect([this._startTouchPoint,this._moveTouchPoint]),c=this.network.getElementsAtRect(b,this.getIntersectMode(),this.network.getRectSelectFilter());if(c&&c.size()>0){var d=this.network.getSelectionModel(),e=d.toSelection();c.forEach(function(a){d.contains(a)?e.remove(a):e.add(a)},this),d.setSelection(e)}this.network.fireInteractionEvent({kind:"selectEnd",event:a}),this._moveTouchPoint=null,this.network.setSelectingElement(!1),this.repaint()}this._doubleClick&&(delete this._doubleClick,delete this._startTouchPoint,delete this._startTouchTime);for(var f=-1,g=0;g<this._pointerIdArray.length;g++)if(this._pointerIdArray[g]==a.pointerId){f=g;break}f>=0&&this._pointerIdArray.splice(f,1),delete this._pointerMap[a.pointerId],this._moveTouchPoint=null},_getDistance:function(){return Tb.getDistance({x:this._pointerMap[this._pointerIdArray[0]].pageX,y:this._pointerMap[this._pointerIdArray[0]].pageY},{x:this._pointerMap[this._pointerIdArray[1]].pageX,y:this._pointerMap[this._pointerIdArray[1]].pageY})},getIntersectMode:function(){return"intersect"===this.network.getSelectMode()?!0:"contain"===this.network.getSelectMode()?!1:this._startTouchPoint.x>this._moveTouchPoint.x&&this._startTouchPoint.y>this._moveTouchPoint.y},handle_mousemove:function(a){var b={x:a.clientX,y:a.clientY};if(!(Tb.getDistance(this._startClientPoint,b)<3)&&this._startTouchPoint&&1==this._pointerIdArray.length)if(this._moveTouchPoint={x:this._startTouchPoint.x+(b.x-this._startClientPoint.x)/this.network.getZoom(),y:this._startTouchPoint.y+(b.y-this._startClientPoint.y)/this.network.getZoom()},null==this._startTouchElement&&this.network.isRectSelectEnabled()){var c=this.network.getLogicalPoint2(a);if(!c)return;this.network.setSelectingElement(!0),this.network.fireInteractionEvent(this._moveTouchPoint?{kind:"selectBetween",event:a}:{kind:"selectStart",event:a}),this.repaint()}else{var d=this.network.getElementAt(this._moveTouchPoint);if(null!=this._startTouchElement||this.network.isRectSelectEnabled()){if(this.network.isMovingElement()||null!=this._startTouchElement&&d==this._startTouchElement&&this.network.getMovableSelectedElements().contains(d)){var e=this._moveTouchPoint.x-this._startTouchPoint.x,f=this._moveTouchPoint.y-this._startTouchPoint.y;this.network.moveSelectedElements(e,f),this.network.isMovingElement()?this.network.fireInteractionEvent({kind:"liveMoveBetween",event:a}):(this.network.setMovingElement(!0),this.network.fireInteractionEvent({kind:"liveMoveStart",event:a}))}}else{var e=this._startClientPoint.x-b.x,f=this._startClientPoint.y-b.y;this.network.panByOffset(e,f)}this._startClientPoint=b}},handle_mouseup:function(a){this.handleTouchend(a),this._pointerIdArray=[],this._pointerMap={}},paint:function(a){if(this._startTouchPoint&&this._moveTouchPoint&&!this._startTouchElement&&this.network.isRectSelectEnabled()){var b=this.convertPointFromView(this._startTouchPoint),c=this.convertPointFromView(this._moveTouchPoint),d=b.x,e=b.y,f=c.x,g=c.y,h=Tb.getRect([{x:d,y:e},{x:f,y:g}]);if(null!=h){a.beginPath();var i=this.network.getSelectOutlineWidth(),j=this.getIntersectMode()?this.network.getSelectFillColor():null;a.strokeStyle=this.network.getSelectOutlineColor(),a.lineWidth=i,Od.rect(a,h.x,h.y,h.width,h.height,j,this.network.getSelectOutlineColor()),a.closePath()}}}}),Ib.XmlSerializer=function(a,b,c){this.dataBox=a,this.settings=b?b:new Ib.SerializationSettings,this.filterFunction=c,this.ref=0,this.refMap={},this.idMap={},this.xmlString=""},Jb.ext("twaver.XmlSerializer",Object,{serialize:function(){return this.xmlString="<twaver version='"+Ib.Util.getVersion()+"' platform='html5'>\n",this.serializeBody(),this.xmlString+="</twaver>\n",this.xmlString},serializeBody:function(){this.ref=0,this.dataBox.getRoots().forEach(this.initRefs,this),this.settings.isDataBoxSerializable&&(this.xmlString+="<dataBox class='"+this.dataBox.getClassName()+"'>\n",this.dataBox.serializeXml(this,this.dataBox.newInstance()),this.xmlString+="</dataBox>\n"),this.dataBox.getRoots().forEach(this.serializeData,this)},initRefs:function(a){this.refMap[a.getId()]=this.ref++,a.getChildren().forEach(this.initRefs,this)},isSerializable:function(a){return this.dataBox.contains(a)?this.filterFunction&&!this.filterFunction(a)?!1:!0:!1},serializeData:function(a){if(this.isSerializable(a)){var b=a.newInstance(),c=this.refMap[a.getId()];this.xmlString+="<data class='"+a.getClassName()+"' ref='"+c+"'",null!=this.settings.getPropertyType("id")&&(this.xmlString+=" id='"+a.getId()+"'"),this.xmlString+=">\n",a.serializeXml(this,b),this.xmlString+="</data>\n"}a.getChildren().forEach(this.serializeData,this)},serializePropertyXml:function(a,b,c){var d=this.settings.getPropertyType(b);if(d){var e=Jb.getValue(a,b,d),f=Jb.getValue(c,b,d);e!==f&&this.serializeValue("p",b,e,f,d)}},serializeStyleXml:function(a,b,c){var d=this.settings.getStyleType(b);if(d){var e=a.getStyle(b),f=c.getStyle(b);e!=f&&this.serializeValue("s",b,e,f,d)}},serializeClientXml:function(a,b,c){var d=this.settings.getClientType(b);if(null!=d){var e=a.getClient(b),f=c.getClient(b);e!=f&&this.serializeValue("c",b,e,f,d)}},serializeValue:function(a,b,c,d,e){if(null==c)this.xmlString+="	<"+a+" n='"+b+"' none=''/>\n";else if("cdata"===e)this.xmlString+="	<"+a+" n='"+b+"'><![CDATA["+c+"]]></"+a+">\n";else if("data"===e){var f=this.refMap[c.getId()];null!=f&&(this.xmlString+="	<"+a+" n='"+b+"' ref='"+f+"'/>\n")}else"point"===e?d&&c.x===d.x&&c.y===d.y||(this.xmlString+="	<"+a+" n='"+b+"' x='"+c.x+"' y='"+c.y+"'/>\n"):"list.point"===e?(this.xmlString+="	<"+a+" n='"+b+"'>\n",c.forEach(function(a){this.xmlString+="		<p x='"+a.x+"' y='"+a.y+"'/>\n"},this),this.xmlString+="	</"+a+">\n"):"list.string"===e||"list.number"===e?(this.xmlString+="	<"+a+" n='"+b+"'>\n",c.forEach(function(a){this.xmlString+="		<s>"+a+"</s>\n"},this),this.xmlString+="	</"+a+">\n"):this.xmlString+="rectangle"===e?"	<"+a+" n='"+b+"' x='"+c.x+"' y='"+c.y+"' w='"+c.width+"' h='"+c.height+"'/>\n":"	<"+a+" n='"+b+"'>"+c+"</"+a+">\n"},deserialize:function(a,b){Jb.isDeserializing=!0,this.xmlString=a;var c=Jb.xml(a).documentElement;this.refMap={},this.idMap={};var d,e,f,g=new nd,h=new nd,i=c.getElementsByTagName("data"),j=i.length;for(f=0;j>f;f++){e=i[f];var k=e.getAttribute("class"),l=this.settings.getPropertyType("id");if(l&&e.hasAttribute("id")){var m=null;if("string"===l)m=e.getAttribute("id");else if("int"===l)m=parseInt(e.getAttribute("id"));else{if("number"!==l)throw"Unsupported id type '"+l+"'";m=parseFloat(e.getAttribute("id"))}if("remove"===e.getAttribute("action")){this.dataBox.removeById(m);continue}d=this.dataBox.getDataById(m),d||(d=Jb.newInstance(k,m))}else d=Jb.newInstance(k);if(e.hasAttribute("ref")){var n=e.getAttribute("ref");this.refMap[n]=d}g.add(d),h.add(e),this.idMap[d.getId()]=d}for(this.dataBox.forEach(function(a){this.idMap[a.getId()]=a},this),j=g.size(),f=0;j>f;f++)d=g.get(f),e=h.get(f),d.deserializeXml(this,e);for(f=0;j>f;f++)d=g.get(f),this.dataBox.containsById(d.getId())||(b&&!d.getParent()&&d.setParent(b),this.dataBox.add(d));this.settings.isDataBoxSerializable&&1===c.getElementsByTagName("dataBox").length&&this.dataBox.deserializeXml(this,c.getElementsByTagName("dataBox")[0]),Jb.isDeserializing=!1},deserializePropertyXml:function(a,b,c){var d=this.settings.getPropertyType(c);d&&Jb.setValue(a,c,this.deserializeValue(b,d))},deserializeStyleXml:function(a,b,c){var d=this.settings.getStyleType(c);d&&a.setStyle(c,this.deserializeValue(b,d))},deserializeClientXml:function(a,b,c){var d=this.settings.getClientType(c);d&&a.setClient(c,this.deserializeValue(b,d))},deserializeValue:function(a,b){if(a.hasAttribute("@none"))return null;if("string"===b)return a.textContent;if("number"===b)return parseFloat(a.textContent);if("boolean"===b)return"true"===a.textContent;if("int"===b)return parseInt(a.textContent);if("point"===b)return{x:parseFloat(a.getAttribute("x")),y:parseFloat(a.getAttribute("y"))};if("data"===b){var c=a.getAttribute("ref"),d=this.refMap[c];return d?d:this.idMap[c]}var e,f,g,h;if("list.point"===b){var i=new nd,j=a.getElementsByTagName("p");for(e=j.length,h=0;e>h;h++){var k=j[h];i.add({x:parseFloat(k.getAttribute("x")),y:parseFloat(k.getAttribute("y"))})}return i}if("list.string"===b){var l=new nd;for(g=a.getElementsByTagName("s"),e=g.length,h=0;e>h;h++)l.add(g[h].textContent);return l}if("list.number"===b){for(f=new nd,g=a.getElementsByTagName("s"),e=g.length,h=0;e>h;h++)f.add(parseFloat(g[h].textContent));return f}if("array.string"===b)return a.textContent.split(",");if("array.number"===b){for(f=a.textContent.split(","),e=f.length,h=0;e>h;h++)f[h]=parseFloat(f[h]);return f}return"rectangle"===b?{x:parseFloat(a.getAttribute("x")),y:parseFloat(a.getAttribute("y")),width:parseFloat(a.getAttribute("w")),height:parseFloat(a.getAttribute("h"))}:a.textContent}}),Jb.addMethod(Ib.Data,{serializeXml:function(a,b){if(a.settings.isClientSerializable&&this._clientMap)for(var c in this._clientMap)this.serializeClientXml(a,c,b);this.serializePropertyXml(a,"name",b),this.serializePropertyXml(a,"icon",b),this.serializePropertyXml(a,"toolTip",b),this.serializePropertyXml(a,"parent",b)},serializePropertyXml:function(a,b,c){a.serializePropertyXml(this,b,c)},serializeClientXml:function(a,b,c){a.serializeClientXml(this,b,c)},deserializeXml:function(a,b){var c,d,e,f,g=b.getElementsByTagName("p"),h=g.length;for(c=0;h>c;c++)d=g[c],d.hasAttribute("n")&&this.deserializePropertyXml(a,d,d.getAttribute("n"));if(a.settings.isClientSerializable)for(e=b.getElementsByTagName("c"),h=e.length,c=0;h>c;c++)f=e[c],f.hasAttribute("n")&&this.deserializeClientXml(a,f,f.getAttribute("n"))},deserializePropertyXml:function(a,b,c){a.deserializePropertyXml(this,b,c)},deserializeClientXml:function(a,b,c){a.deserializeClientXml(this,b,c)}}),Jb.addMethod(Ib.Element,{serializeXml:function(a,b){if(a.settings.isStyleSerializable&&this._styleMap)for(var c in this._styleMap)this.serializeStyleXml(a,c,b);Ib.Element.superClass.serializeXml.call(this,a,b),this.serializePropertyXml(a,"layerId",b),this._alarmState.getHighestNativeAlarmSeverity()&&"alarmstate"===a.settings.getPropertyType("alarmState")&&(a.xmlString+="	<p n='alarmState'>\n",Ib.AlarmSeverity.forEach(function(b){var c=this.getNewAlarmCount(b);c>0&&(a.xmlString+="		<n n='"+b.name+"' c='"+c+"'/>\n")},this._alarmState),Ib.AlarmSeverity.forEach(function(b){var c=this.getAcknowledgedAlarmCount(b);c>0&&(a.xmlString+="		<a n='"+b.name+"' c='"+c+"'/>\n")},this._alarmState),a.xmlString+="	</p>\n")},serializeStyleXml:function(a,b,c){a.serializeStyleXml(this,b,c)},deserializeXml:function(a,b){if(Ib.Element.superClass.deserializeXml.call(this,a,b),a.settings.isStyleSerializable){var c,d,e=b.getElementsByTagName("s"),f=e.length;for(c=0;f>c;c++)d=e[c],d.hasAttribute("n")&&this.deserializeStyleXml(a,d,d.getAttribute("n"))}},deserializeStyleXml:function(a,b,c){
a.deserializeStyleXml(this,b,c)},deserializePropertyXml:function(a,b,c){if("alarmState"===c){if("alarmstate"===a.settings.getPropertyType("alarmState")){var d,e,f,g=b.getElementsByTagName("n");for(e=0;e<g.length;e++)f=g[e],d=Ib.AlarmSeverity.getByName(f.getAttribute("n")),this._alarmState.setNewAlarmCount(d,parseInt(f.getAttribute("c")));for(g=b.getElementsByTagName("a"),e=0;e<g.length;e++)f=g[e],d=Ib.AlarmSeverity.getByName(f.getAttribute("n")),this._alarmState.setAcknowledgedAlarmCount(d,parseInt(f.getAttribute("c")))}}else Ib.Element.superClass.deserializePropertyXml.call(this,a,b,c)}}),Jb.addMethod(Ld,{serializeXml:function(a,b){Ld.superClass.serializeXml.call(this,a,b),this.serializePropertyXml(a,"image",b),this.serializePropertyXml(a,"location",b),Jb.num(this._width)&&this._width>=0&&this.serializePropertyXml(a,"width",b),Jb.num(this._height)&&this._height>=0&&this.serializePropertyXml(a,"height",b)}}),Jb.addMethod(Ib.Link,{serializeXml:function(a,b){Ib.Link.superClass.serializeXml.call(this,a,b),this.serializePropertyXml(a,"fromNode",b),this.serializePropertyXml(a,"toNode",b)}}),Jb.addMethod(Ib.Follower,{serializeXml:function(a,b){Ib.Follower.superClass.serializeXml.call(this,a,b),this.serializePropertyXml(a,"host",b)}}),Jb.addMethod(Nd,{serializeXml:function(a,b){Nd.superClass.serializeXml.call(this,a,b),this.serializePropertyXml(a,"expanded",b)}}),Jb.addMethod(Ib.ShapeNode,{serializeXml:function(a,b){Ib.ShapeNode.superClass.serializeXml.call(this,a,b),this.serializePropertyXml(a,"points",b),this.serializePropertyXml(a,"segments",b)}}),Jb.addMethod(Ib.ShapeLink,{serializeXml:function(a,b){Ib.ShapeLink.superClass.serializeXml.call(this,a,b),this.serializePropertyXml(a,"points",b)}}),Jb.addMethod(Ib.RotatableNode,{serializeXml:function(a,b){Ib.RotatableNode.superClass.serializeXml.call(this,a,b),this.serializePropertyXml(a,"angle",b)}}),Jb.addMethod(Ib.DataBox,{serializeXml:function(a,b){if(a.settings.isClientSerializable&&this._clientMap)for(var c in this._clientMap)this.serializeClientXml(a,c,b);this.serializePropertyXml(a,"name",b),this.serializePropertyXml(a,"icon",b),this.serializePropertyXml(a,"toolTip",b)},serializePropertyXml:function(a,b,c){a.serializePropertyXml(this,b,c)},serializeClientXml:function(a,b,c){a.serializeClientXml(this,b,c)},deserializeXml:function(a,b){var c,d,e,f,g=b.getElementsByTagName("p"),h=g.length;for(c=0;h>c;c++)d=g[c],d.hasAttribute("n")&&this.deserializePropertyXml(a,d,d.getAttribute("n"));if(a.settings.isClientSerializable)for(e=b.getElementsByTagName("c"),h=e.length,c=0;h>c;c++)f=e[c],f.hasAttribute("n")&&this.deserializeClientXml(a,f,f.getAttribute("n"))},deserializePropertyXml:function(a,b,c){a.deserializePropertyXml(this,b,c)},deserializeClientXml:function(a,b,c){a.deserializeClientXml(this,b,c)}}),Jb.addMethod(Ib.ElementBox,{serializeXml:function(a,b){if(a.settings.isLayerBoxSerializable&&(a.xmlString+="	<layerBox>\n",this._layerBox.forEachByDepthFirst(function(b){a.xmlString+=this._layerBox.getDefaultLayer()===b?"		<layer ":"		<layer id='"+b.getId()+"' ",b.getName()&&(a.xmlString+="name='"+b.getName()+"' "),a.xmlString+="visible='"+b.isVisible()+"' editable='"+b.isEditable()+"' movable='"+b.isMovable()+"'/>\n"},null,this),a.xmlString+="	</layerBox>\n"),a.settings.isStyleSerializable&&this._styleMap)for(var c in this._styleMap)this.serializeStyleXml(a,c,b);Ib.ElementBox.superClass.serializeXml.call(this,a,b)},serializeStyleXml:function(a,b,c){a.serializeStyleXml(this,b,c)},deserializeStyleXml:function(a,b,c){a.deserializeStyleXml(this,b,c)},deserializeXml:function(a,b){if(Ib.ElementBox.superClass.deserializeXml.call(this,a,b),a.settings.isLayerBoxSerializable&&1==b.getElementsByTagName("layerBox").length)for(var c=b.getElementsByTagName("layerBox")[0].getElementsByTagName("layer"),d=0;d<c.length;d++){var e,f=c[d];if(f.hasAttribute("id")){var g=a.settings.getPropertyType("layerId");if("string"===g)e=new Ib.Layer(f.getAttribute("id"));else if("int"===g)e=new Ib.Layer(parseInt(f.getAttribute("id")));else{if("number"!==g)throw"Unsupported layer id type '"+g+"'";e=new Ib.Layer(parseFloat(f.getAttribute("id")))}this._layerBox.getDataById(e.getId())?e=this._layerBox.getDataById(e.getId()):this._layerBox.add(e)}else e=this._layerBox.getDefaultLayer(),this._layerBox.moveToBottom(e);f.hasAttribute("name")&&e.setName(f.getAttribute("name")),f.hasAttribute("visible")&&e.setVisible("true"===f.getAttribute("visible")),f.hasAttribute("editable")&&e.setEditable("true"===f.getAttribute("editable")),f.hasAttribute("movable")&&e.setMovable("true"===f.getAttribute("movable"))}if(a.settings.isStyleSerializable)for(var h=b.getElementsByTagName("s"),i=h.length,d=0;i>d;d++){var j=h[d];j.hasAttribute("n")&&this.deserializeStyleXml(a,j,j.getAttribute("n"))}}}),Ib.JsonSerializer=function(a,b,c){this.dataBox=a,this.settings=b?b:new Ib.SerializationSettings,this.filterFunction=c,this.ref=0,this.refMap={},this.idMap={},this.jsonObject={}},Jb.ext("twaver.JsonSerializer",Object,{serialize:function(){return this.jsonObject={version:Ib.Util.getVersion(),platform:"html5"},this.settings.isImageSerializable&&(this.jsonObject.images={}),this.serializeBody(),JSON.stringify(this.jsonObject)},serializeBody:function(){if(this.ref=0,this.dataBox.getRoots().forEach(this.initRefs,this),this.settings.isDataBoxSerializable){var a={"class":this.dataBox.getClassName(),p:{},s:{},c:{}};this.jsonObject.dataBox=a,this.dataBox.serializeJson(this,this.dataBox.newInstance(),a),Jb.isEmptyObject(a.p)&&delete a.p,Jb.isEmptyObject(a.s)&&delete a.s,Jb.isEmptyObject(a.c)&&delete a.c}this.jsonObject.datas=[],this.dataBox.getRoots().forEach(this.serializeData,this)},initRefs:function(a){this.refMap[a.getId()]=this.ref++,a.getChildren().forEach(this.initRefs,this)},isSerializable:function(a){return this.dataBox.contains(a)?this.filterFunction&&!this.filterFunction(a)?!1:!0:!1},serializeData:function(a){if(this.isSerializable(a)){var b=a.newInstance(),c=this.refMap[a.getId()],d={"class":a.getClassName(),ref:c,p:{},s:{},c:{}};if(this.settings.getPropertyType("id")&&(this.jsonObject.id=a.getId()),this.jsonObject.datas.push(d),a.serializeJson(this,b,d),Jb.isEmptyObject(d.p)&&delete d.p,Jb.isEmptyObject(d.s)&&delete d.s,Jb.isEmptyObject(d.c)&&delete d.c,this.settings.isImageSerializable&&a.getImage){var e=a.getImage();if("string"==typeof e&&!Qd[e]&&!this.jsonObject.images[e]){var f=Jb.getImageAsset(e),g=f&&f.getImage();g&&!cd(g)&&(this.jsonObject.images[e]=g)}}}a.getChildren().forEach(this.serializeData,this)},serializePropertyJson:function(a,b,c,d){var e=this.settings.getPropertyType(b);if(e){var f=Jb.getValue(a,b,e),g=Jb.getValue(c,b,e);f!==g&&this.serializeValue(b,f,g,e,d.p)}},serializeStyleJson:function(a,b,c,d){var e=this.settings.getStyleType(b);if(e){var f=a.getStyle(b),g=c.getStyle(b);f!=g&&this.serializeValue(b,f,g,e,d.s)}},serializeClientJson:function(a,b,c,d){var e=this.settings.getClientType(b);if(null!=e){var f=a.getClient(b),g=c.getClient(b);f!=g&&this.serializeValue(b,f,g,e,d.c)}},serializeValue:function(a,b,c,d,e){if(null==b)e[a]=null;else if(b instanceof nd)e[a]=b._as;else if("data"===d){var f=this.refMap[b.getId()];null!=f&&(e[a]=f)}else e[a]=b},deserialize:function(a,b){Jb.isDeserializing=!0,this.jsonObject=JSON.parse(a);var c=this.jsonObject.images;this.settings.isImageSerializable&&c&&Object.keys(c).forEach(function(a){Jb.registerImage(a,c[a])}),this.refMap={},this.idMap={};for(var d,e=new nd,f=new nd,g=this.jsonObject.datas.length,h=0;g>h;h++){var i=this.jsonObject.datas[h],j=i["class"],k=this.settings.getPropertyType("id");if(k&&null!=i.id){if("remove"===i.action){this.dataBox.removeById(i.id);continue}d=this.dataBox.getDataById(i.id),d||(d=Jb.newInstance(j,i.id))}else d=Jb.newInstance(j);null!=i.ref&&(this.refMap[i.ref]=d),e.add(d),f.add(i),this.idMap[d.getId()]=d}for(this.dataBox.forEach(function(a){this.idMap[a.getId()]=a},this),g=e.size(),h=0;g>h;h++)d=e.get(h),d.deserializeJson(this,f.get(h));for(h=0;g>h;h++)d=e.get(h),this.dataBox.containsById(d.getId())||(b&&!d.getParent()&&d.setParent(b),this.dataBox.add(d));this.settings.isDataBoxSerializable&&this.jsonObject.dataBox&&this.dataBox.deserializeJson(this,this.jsonObject.dataBox),Jb.isDeserializing=!1},deserializePropertyJson:function(a,b,c){var d=this.settings.getPropertyType(c);d&&Jb.setValue(a,c,this.deserializeValue(b,d))},deserializeStyleJson:function(a,b,c){var d=this.settings.getStyleType(c);d&&a.setStyle(c,this.deserializeValue(b,d))},deserializeClientJson:function(a,b,c){var d=this.settings.getClientType(c);d&&a.setClient(c,this.deserializeValue(b,d))},deserializeValue:function(a,b){if("data"===b){var c=this.refMap[a];return c?c:this.idMap[a]}return"array.number"===b?a:a instanceof Array?new nd(a):a}}),Jb.addMethod(Ib.Data,{serializeJson:function(a,b,c){if(a.settings.isClientSerializable&&this._clientMap)for(var d in this._clientMap)this.serializeClientJson(a,d,b,c);this.serializePropertyJson(a,"name",b,c),this.serializePropertyJson(a,"icon",b,c),this.serializePropertyJson(a,"toolTip",b,c),this.serializePropertyJson(a,"parent",b,c)},serializePropertyJson:function(a,b,c,d){a.serializePropertyJson(this,b,c,d)},serializeClientJson:function(a,b,c,d){a.serializeClientJson(this,b,c,d)},deserializeJson:function(a,b){var c;for(c in b.p)this.deserializePropertyJson(a,b.p[c],c);if(a.settings.isClientSerializable)for(c in b.c)this.deserializeClientJson(a,b.c[c],c)},deserializePropertyJson:function(a,b,c){a.deserializePropertyJson(this,b,c)},deserializeClientJson:function(a,b,c){a.deserializeClientJson(this,b,c)}}),Jb.addMethod(Ib.Element,{serializeJson:function(a,b,c){if(a.settings.isStyleSerializable&&this._styleMap)for(var d in this._styleMap)this.serializeStyleJson(a,d,b,c);if(Ib.Element.superClass.serializeJson.call(this,a,b,c),this.serializePropertyJson(a,"layerId",b,c),this._alarmState.getHighestNativeAlarmSeverity()&&"alarmstate"===a.settings.getPropertyType("alarmState")){var e={n:{},a:{}};c.p.alarmState=e,Ib.AlarmSeverity.forEach(function(a){var b=this.getNewAlarmCount(a);b>0&&(e.n[a.name]=b)},this._alarmState),Ib.AlarmSeverity.forEach(function(a){var b=this.getAcknowledgedAlarmCount(a);b>0&&(e.a[a.name]=b)},this._alarmState),Jb.isEmptyObject(e.n)&&delete e.n,Jb.isEmptyObject(e.a)&&delete e.a,Jb.isEmptyObject(e)&&delete c.p.alarmState}},serializeStyleJson:function(a,b,c,d){a.serializeStyleJson(this,b,c,d)},deserializeJson:function(a,b){if(Ib.Element.superClass.deserializeJson.call(this,a,b),a.settings.isStyleSerializable)for(var c in b.s)this.deserializeStyleJson(a,b.s[c],c)},deserializeStyleJson:function(a,b,c){a.deserializeStyleJson(this,b,c)},deserializePropertyJson:function(a,b,c){if("alarmState"===c){if("alarmstate"===a.settings.getPropertyType("alarmState")){var d;for(d in b.n)this._alarmState.setNewAlarmCount(Ib.AlarmSeverity.getByName(d),b.n[d]);for(d in b.a)this._alarmState.setAcknowledgedAlarmCount(Ib.AlarmSeverity.getByName(d),b.a[d])}}else Ib.Element.superClass.deserializePropertyJson.call(this,a,b,c)}}),Jb.addMethod(Ld,{serializeJson:function(a,b,c){Ld.superClass.serializeJson.call(this,a,b,c),this.serializePropertyJson(a,"image",b,c),this.serializePropertyJson(a,"location",b,c),Jb.num(this._width)&&this._width>=0&&this.serializePropertyJson(a,"width",b,c),Jb.num(this._height)&&this._height>=0&&this.serializePropertyJson(a,"height",b,c)}}),Jb.addMethod(Ib.Link,{serializeJson:function(a,b,c){Ib.Link.superClass.serializeJson.call(this,a,b,c),this.serializePropertyJson(a,"fromNode",b,c),this.serializePropertyJson(a,"toNode",b,c)}}),Jb.addMethod(Ib.Follower,{serializeJson:function(a,b,c){Ib.Follower.superClass.serializeJson.call(this,a,b,c),this.serializePropertyJson(a,"host",b,c)}}),Jb.addMethod(Nd,{serializeJson:function(a,b,c){Nd.superClass.serializeJson.call(this,a,b,c),this.serializePropertyJson(a,"expanded",b,c)}}),Jb.addMethod(Ib.ShapeNode,{serializeJson:function(a,b,c){Ib.ShapeNode.superClass.serializeJson.call(this,a,b,c),this.serializePropertyJson(a,"points",b,c),this.serializePropertyJson(a,"segments",b,c)}}),Jb.addMethod(Ib.ShapeLink,{serializeJson:function(a,b,c){Ib.ShapeLink.superClass.serializeJson.call(this,a,b,c),this.serializePropertyJson(a,"points",b,c)}}),Jb.addMethod(Ib.RotatableNode,{serializeJson:function(a,b,c){Ib.RotatableNode.superClass.serializeJson.call(this,a,b,c),this.serializePropertyJson(a,"angle",b,c)}}),Jb.addMethod(Ib.DataBox,{serializeJson:function(a,b,c){if(a.settings.isClientSerializable&&this._clientMap)for(var d in this._clientMap)this.serializeClientJson(a,d,b,c);this.serializePropertyJson(a,"name",b,c),this.serializePropertyJson(a,"icon",b,c),this.serializePropertyJson(a,"toolTip",b,c)},serializePropertyJson:function(a,b,c,d){a.serializePropertyJson(this,b,c,d)},serializeClientJson:function(a,b,c,d){a.serializeClientJson(this,b,c,d)},deserializeJson:function(a,b){var c;for(c in b.p)this.deserializePropertyJson(a,b.p[c],c);if(a.settings.isClientSerializable)for(c in b.c)this.deserializeClientJson(a,b.c[c],c)},deserializePropertyJson:function(a,b,c){a.deserializePropertyJson(this,b,c)},deserializeClientJson:function(a,b,c){a.deserializeClientJson(this,b,c)}}),Jb.addMethod(Ib.ElementBox,{serializeJson:function(a,b,c){if(a.settings.isLayerBoxSerializable&&(c.layers=[],this._layerBox.forEachByDepthFirst(function(a){var b={};c.layers.push(b),this._layerBox.getDefaultLayer()!==a&&(b.id=a.getId()),a.getName()&&(b.name=a.getName()),b.visible=a.isVisible(),b.editable=a.isEditable(),b.movable=a.isMovable()},null,this)),a.settings.isStyleSerializable&&this._styleMap)for(var d in this._styleMap)this.serializeStyleJson(a,d,b,c);Ib.ElementBox.superClass.serializeJson.call(this,a,b,c)},serializeStyleJson:function(a,b,c,d){a.serializeStyleJson(this,b,c,d)},deserializeStyleJson:function(a,b,c){a.deserializeStyleJson(this,b,c)},deserializeJson:function(a,b){if(Ib.ElementBox.superClass.deserializeJson.call(this,a,b),a.settings.isLayerBoxSerializable&&b.layers&&b.layers)for(var c=b.layers.length,d=0;c>d;d++){var e,f=b.layers[d];null!=f.id?(e=new Ib.Layer(f.id),this._layerBox.getDataById(e.getId())?e=this._layerBox.getDataById(e.getId()):this._layerBox.add(e)):(e=this._layerBox.getDefaultLayer(),this._layerBox.moveToBottom(e)),f.name&&e.setName(f.name),null!=f.visible&&e.setVisible(f.visible),null!=f.editable&&e.setEditable(f.editable),null!=f.movable&&e.setMovable(f.movable)}if(a.settings.isStyleSerializable)for(var g in b.s)this.deserializeStyleJson(a,b.s[g],g)}}),Ib.layout.SpringLayouter=function(a){this._network=a,this._damper=1,this._maxMotion=0,this._motionRatio=0,this._isAdjusting=!1,this._timer=null,this._snodeMap={},this._snodes=new nd,this._slinks=new nd,this._network.getElementBox().addDataBoxChangeListener(this._handleDataBoxChange,this),this._network.getElementBox().addDataPropertyChangeListener(this._handleDataPropertyChange,this),this._network.addPropertyChangeListener(this._handleNetworkPropertyChange,this)},Jb.ext("twaver.layout.SpringLayouter",Object,{_nodeRepulsionFactor:.6,_linkRepulsionFactor:.6,_limitBounds:null,_interval:50,_stepCount:10,_motionLimit:.01,start:function(){if(!this._timer){var b=this,c=function(){b.relax.call(b)};this._timer=a.setInterval(c,this._interval),this._damper=1}},stop:function(){this._timer&&(a.clearInterval(this._timer),this._timer=null)},relax:function(){if(!(this._damper<.1&&this._maxMotion<this._motionLimit)){this._rebuild();for(var a=this._snodes.size(),b=0;b<this._stepCount;b++){this._slinks.forEach(this._relaxLink,this);for(var c=0;a>c;c++)for(var d=0;a>d;d++){var e=this._snodes.get(c),f=this._snodes.get(d);e!=f&&this._relaxNodePair(e,f)}this._moveNodes()}this._isAdjusting=!0;for(var b=0;a>b;b++){var g=this._snodes.get(b);g.fix||g.element.setLocation(g.x,g.y)}this._isAdjusting=!1}},isRunning:function(){return!!this._timer},getNetwork:function(){return this._network},isVisible:function(a){return this._network.isVisible(a)},isMovable:function(a){return this._network.isMovable(a)?this._network.getSelectionModel().contains(a)?!1:a instanceof Nd?!1:!0:!1},getNodeRepulsionFactor:function(){return this._nodeRepulsionFactor},setNodeRepulsionFactor:function(a){.02>a&&(a=.02),this._nodeRepulsionFactor=a,this._damper=1},getLinkRepulsionFactor:function(){return this._linkRepulsionFactor},setLinkRepulsionFactor:function(a){.02>a&&(a=.02),this._linkRepulsionFactor=a,this._damper=1},getStepCount:function(){return this._stepCount},setStepCount:function(a){this._stepCount=a,this._damper=1},getInterval:function(){return this._interval},setInterval:function(b){if(this._interval!==b&&(this._interval=b,this._timer)){a.clearInterval(this._timer);var c=this,d=function(){c.relax.call(c)};this._timer=a.setInterval(d,this._interval)}},getLimitBounds:function(){return this._limitBounds},setLimitBounds:function(a){this._limitBounds=a,this._damper=1},_handleDataPropertyChange:function(a){this._isAdjusting||(this._damper=1)},_handleDataBoxChange:function(a){this._damper=0===this._network.getElementBox().size()?0:1},_handleNetworkPropertyChange:function(a){if("elementBox"===a.property){var b=a.oldValue;null!=b&&(b.removeDataBoxChangeListener(this._handleDataBoxChange,this),b.removeDataPropertyChangeListener(this._handleDataPropertyChange,this)),this._network.getElementBox().addDataBoxChangeListener(this._handleDataBoxChange,this),this._network.getElementBox().addDataPropertyChangeListener(this._handleDataPropertyChange,this)}},_relaxLink:function(a){var b=a.toNode.x-a.fromNode.x,c=a.toNode.y-a.fromNode.y,d=Math.sqrt(b*b+c*c),e=.25*b,f=.25*c;e/=100*a.length;var g=a.length,h=100*g,i=f;f/=h,i/=100*a.length,a.toNode.dx=a.toNode.dx-e*d,a.toNode.dy=a.toNode.dy-f*d,a.fromNode.dx=a.fromNode.dx+e*d,a.fromNode.dy=a.fromNode.dy+f*d},_relaxNodePair:function(a,b){var c=0,d=0,e=a.x-b.x,f=a.y-b.y,g=e*e+f*f;0===g?(c=Ib.Util.random(),d=Ib.Util.random()):36e4>g&&(c=e/g,d=f/g);var h=a.repulsion*b.repulsion/100,i=.25*h;a.dx+=c*i,a.dy+=d*i,b.dx-=c*i,b.dy-=d*i},_moveNodes:function(){for(var a=this._maxMotion,b=0,c=0,d=this._snodes.size();d>c;c++){var e=this._snodes.get(c),f=e.dx,g=e.dy;f*=this._damper,g*=this._damper,e.dx=f/2,e.dy=g/2;var h=Math.sqrt(f*f+g*g);if(!e.fix)if(e.x=e.x+Math.max(-30,Math.min(30,f)),e.y=e.y+Math.max(-30,Math.min(30,g)),this._limitBounds){e.x<this._limitBounds.x&&(e.x=this._limitBounds.x,this._adjustLocation(1,0)),e.y<this._limitBounds.y&&(e.y=this._limitBounds.y,this._adjustLocation(0,1));var i,j=this._network.getElementUI(e.element);i=j?j._viewRect:e.element.getRect(),i&&(e.x+i.width>this._limitBounds.x+this._limitBounds.width&&(e.x=this._limitBounds.x+this._limitBounds.width-i.width,this._adjustLocation(-1,0)),e.y+i.height>this._limitBounds.y+this._limitBounds.height&&(e.y=this._limitBounds.y+this._limitBounds.height-i.height,this._adjustLocation(0,-1)))}else e.x<1&&this._adjustLocation(1,0),e.y<1&&this._adjustLocation(0,1);b=Math.max(h,b)}this._maxMotion=b,this._motionRatio=this._maxMotion>0?a/this._maxMotion-1:0,this._damp()},_damp:function(){this._motionRatio<=.001&&((this._maxMotion<.2||this._maxMotion>1&&this._damper<.9)&&this._damper>.01?this._damper-=.01:this._maxMotion<.4&&this._damper>.003?this._damper-=.003:this._damper>1e-4&&(this._damper-=1e-4)),this._maxMotion<this._motionLimit&&(this._damper=0)},_rebuild:function(){this._snodeMap={},this._snodes.clear(),this._slinks.clear(),this._network.getElementBox().forEach(function(a){this.isVisible(a)&&(a instanceof Ib.Link?this._addLink(a):a instanceof Ld&&this._addNode(a))},this)},_addNode:function(a){var b=this._snodeMap[a.getId()];return b?b:(b={},b.element=a,b.repulsion=this._getRepulsion(a),b.x=a.getX(),b.y=a.getY(),b.dx=0,b.dy=0,b.fix=!this.isMovable(a),this._snodeMap[a.getId()]=b,this._snodes.add(b),b)},_addLink:function(a){var b={};b.fromNode=this._addNode(a.getFromNode()),b.toNode=this._addNode(a.getToNode()),b.element=a;var c,d,e=this._network.getElementUI(a.getToNode()),f=this._network.getElementUI(a.getFromNode());e&&e._viewRect&&f&&f._viewRect?(c=e._viewRect.width+f._viewRect.width,d=e._viewRect.height+f._viewRect.height):(c=a.getToNode().getWidth()+a.getFromNode().getWidth(),d=a.getToNode().getHeight()+a.getFromNode().getHeight()),b.length=Math.floor(Math.sqrt(c*c+d*d)*this._linkRepulsionFactor),b.length<=0&&(b.length=100),this._slinks.add(b)},_getRepulsion:function(a){var b,c=this._network.getElementUI(a);if(c&&c._viewRect){var d=c._viewRect;b=Math.floor(Math.sqrt(d.width*d.width+d.height*d.height)*this._nodeRepulsionFactor)}else b=100;return 0>=b&&(b=100),b},_adjustLocation:function(a,b){for(var c=0,d=this._snodes.size();d>c;c++){var e,f=this._snodes.get(c),g=this._network.getElementUI(f.element);if(e=g?g._viewRect:f.element.getRect(),!e)return;a>0?(!this._limitBounds||f.x+e.width+a<this._limitBounds.x+this._limitBounds.width)&&(f.x+=a):(!this._limitBounds||f.x+a>this._limitBounds.x)&&(f.x+=a),b>0?(!this._limitBounds||f.y+e.height+b<this._limitBounds.y+this._limitBounds.height)&&(f.y+=b):(!this._limitBounds||f.y+b>this._limitBounds.y)&&(f.y+=b)}}}),Ib.layout.CloudLayouter=function(a){Ib.layout.CloudLayouter.superClass.constructor.apply(this,arguments),this._network=a,this._centerX=0,this._centerY=0,this._radius=1,this._rect=null,this._localPoint=null,this._lastWidth=-1e3,this._lastHeight=-1e3,this._nodes=new nd,this._sa=0,this._ca=0,this._sb=0,this._cb=0,this._sc=0,this._cc=0,this._lasta=0,this._lastb=0,this._active=!1,this._horizontalElliptical=1,this._verticalElliptical=1,this._timer=null,this._centering=!1,this._centeringNode=null,this._freeze=!1,this._network.setInteractions("twaver.network.Network"===this._network.getClassName()?[new Ib.network.interaction.SelectInteraction(this._network)]:[new Ib.canvas.interaction.SelectInteraction(this._network)])},Jb.ext("twaver.layout.CloudLayouter",Ib.PropertyChangeDispatcher,{__accessor:["updateNodeFunction","mouseMoveFunction","mouseOverFunction","percentPadding","ceaseRate","ceaseLimit"],__bool:["elliptical","active","updateLayoutRectOnResized","reloadOnDataBoxChanged"],_moveSpeed:2,_ceaseRate:.9,_ceaseLimit:.01,_percentPadding:.2,_elliptical:!0,_interval:50,_reloadOnDataBoxChanged:!0,_updateLayoutRectOnResized:!0,getNetwork:function(){return this._network},isLayoutable:function(a){return this._network.isVisible(a)&&this._network.isMovable(a)},start:function(b){if(0===arguments.length&&(b=!0),!this._timer){this._installListeners(),b&&this.updateLayoutRect(!0);var c=this,d=function(){c._update.call(c)};this._timer=a.setInterval(d,this._interval),this._update()}},stop:function(){this._timer&&(a.clearInterval(this._timer),this._timer=null)},isRunning:function(){return!!this._timer},getInterval:function(){return this._interval},setInterval:function(b){if(this._interval!==b){var c=this._interval;if(this._interval=b,this._timer){a.clearInterval(this._timer);var d=this,e=function(){d._update.call(d)};this._timer=a.setInterval(e,this._interval)}this.firePropertyChange("interval",c,b)}},getMoveSpeed:function(){return this._moveSpeed},setMoveSpeed:function(a){var b=this._moveSpeed;this._moveSpeed=a,this.firePropertyChange("moveSpeed",b,a)},getLayoutRect:function(){var a=this._network.getView().offsetWidth/this._network.getZoom(),b=this._network.getView().offsetHeight/this._network.getZoom(),c=a*this._percentPadding,d=b*this._percentPadding;return{x:c,y:d,width:a-2*c,height:b-2*d}},getCount:function(){return this._nodes.size()},updateLayoutRect:function(a){var b=this._radius;if(this._rect=this.getLayoutRect(),this._rect.width<=2&&(this._rect.width=2),this._rect.height<=2&&(this._rect.height=2),this._radius=Math.min(this._rect.width/2,this._rect.height/2),this.isElliptical()?(this._horizontalElliptical=this._rect.width/2/this._radius,this._verticalElliptical=this._rect.height/2/this._radius):(this._horizontalElliptical=1,this._verticalElliptical=1),this._centerX=this._rect.x+this._rect.width/2,this._centerY=this._rect.y+this._rect.height/2,a)this.reload();else{this._lasta=1,this._lastb=1;for(var c=this._nodes.size(),d=0;c>d;d++){var e=this._nodes.get(d);e.cx*=this._radius/b,e.cy*=this._radius/b,e.cz*=this._radius/b}this._freeze?this._updateNodes(0,0,0):this._update()}this._lastWidth=this._network.getView().offsetWidth,this._lastHeight=this._network.getView().offsetHeight},reload:function(){this._freeze=!1,this._centeringNode=null,this._localPoint=null,this._centering=!1,this._nodes=new nd,this._box.forEach(function(a){if(a&&this.isLayoutable(a)){var b={};b.node=a,this._nodes.add(b)}},this),this._sineCosine(0,0,0),this._active=!1,this._lasta=1,this._lastb=1;for(var a=0,b=0,c=this._nodes.size(),d=0;c>d;d++){a=Math.acos(-1+(2*(d+1)-1)/c),b=Math.sqrt(c*Math.PI)*a;var e=this._nodes.get(d);e.cx=this._radius*Math.cos(b)*Math.sin(a),e.cy=this._radius*Math.sin(b)*Math.sin(a),e.cz=this._radius*Math.cos(a)}},_sineCosine:function(a,b,c){var d=Math.PI/180;this._sa=Math.sin(a*d),this._ca=Math.cos(a*d),this._sb=Math.sin(b*d),this._cb=Math.cos(b*d),this._sc=Math.sin(c*d),this._cc=Math.cos(c*d)},handleSelectionChange:function(a){this.centerNode(this._network.getSelectionModel().getLastData())},handleDataBoxChange:function(a){(this._reloadOnDataBoxChanged||"clear"===a.kind)&&this.reload()},handleMouseMove:function(a){this._centering||this._updateLogicalPoint(a),this._active=this._mouseMoveFunction?this._mouseMoveFunction(a):!0},handleMouseOver:function(a){this._centering||this._updateLogicalPoint(a),this._active=this._mouseOverFunction?this._mouseOverFunction(a):!0},_updateLogicalPoint:function(a){this._localPoint=this._network.getLogicalPoint(a)},handleRollOut:function(a){this._active=!1},handleResize:function(a){if("validateEnd"===a.kind){if(!this._updateLayoutRectOnResized)return;if(Math.abs(this._network.getView().offsetWidth-this._lastWidth)<=2&&Math.abs(this._network.getView().offsetHeight-this._lastHeight)<=2)return;this.updateLayoutRect()}},handleNetworkPropertyChange:function(a){"elementBox"===a.property&&(this._box.removeDataBoxChangeListener(this.handleDataBoxChange,this),this._box=this._network.getElementBox(),this._box.addDataBoxChangeListener(this.handleDataBoxChange,this),this.reload()),"zoom"===a.property&&(this._localPoint=null,this.updateLayoutRect())},_adjustIndex:function(){this._nodes.sort(this._sortFunction);for(var a=this._nodes.size(),b=0;a>b;b++){var c=this._nodes.get(b).node,d=this._box.getDatas().indexOf(c);this._box.getDatas().removeAt(d),this._box.getDatas().add(c,b),this._box.fireIndexChange(c,d,b),this.updateNode(c,b,a,this._nodes.get(b).alpha)}},_sortFunction:function(a,b){return b.cz>a.cz?1:b.cz<a.cz?-1:0},updateNode:function(a,b,c,d){this._updateNodeFunction&&this._updateNodeFunction(a,b,c,d)},_update:function(){if(!this._freeze){var a,b;if(this._centering&&this._centeringNode){var c=this.isAtCenter(this._centeringNode.node,this._centeringNode.perspective,this._centeringNode.cx,this._centeringNode.cy,this._centeringNode.cz);if(c)return this._freeze=!0,this._centering=!1,void(this._centeringNode=null)}if(!this._freeze&&(this._active||this._centering)&&this._localPoint?this.isElliptical()?(a=(this._centerY-this._localPoint.y)/(this._rect.height/2)*this._moveSpeed,b=(this._localPoint.x-this._centerX)/(this._rect.width/2)*this._moveSpeed):(a=(this._centerY-this._localPoint.y)/this._radius*this._moveSpeed,b=(this._localPoint.x-this._centerX)/this._radius*this._moveSpeed):(a=this._lasta*this._ceaseRate,b=this._lastb*this._ceaseRate),this._lasta=a,this._lastb=b,Math.abs(a)>this._ceaseLimit||Math.abs(b)>this._ceaseLimit){var d=0;this._sineCosine(a,b,d);for(var e=0,f=this._nodes.size();f>e;e++){var g=this._nodes.get(e),h=g.cx,i=g.cy*this._ca+g.cz*-this._sa,j=g.cy*this._sa+g.cz*this._ca,k=h*this._cb+j*this._sb,l=i,m=h*-this._sb+j*this._cb,n=k*this._cc+l*-this._sc,o=k*this._sc+l*this._cc,p=m;g.cx=n,g.cy=o,g.cz=p;var q=2*this._radius;q/=q+p,g.perspective=q,g.alpha=(this._radius-p)/(2*this._radius);var r=this._horizontalElliptical*n*q-2*this._horizontalElliptical+this._centerX,s=o*q*this._verticalElliptical+this._centerY;g.node.setCenterLocation(r,s)}this._adjustIndex()}}},centerNode:function(a){if(a&&this.isLayoutable(a)){if(this._centeringNode&&a===this._centeringNode.node&&this._freeze)return;for(var b=0,c=this._nodes.size();c>b;b++){var d=this._nodes.get(b);if(d&&a===d.node){this._centering=!0,this._freeze=!1,this._active=!0,this._centeringNode=d,this._localPoint=this.createControlPoint(this._centeringNode.node);break}}}else this._centering=!1,this._freeze=!1,this._active=!1,this._localPoint=null},createControlPoint:function(a){var b=a.getCenterLocation(),c=this.getLayoutRect(),d=c.x+c.width/2,e=c.y+c.height/2,f=Math.atan2(b.y-e,b.x-d),g=c.width+c.height;return{x:d+g*Math.cos(f),y:e+g*Math.sin(f)}},isAtCenter:function(a,b,c,d,e){if(this._moveSpeed<=0)return!0;var f=16/this._moveSpeed;return f>20?f=20:2>f&&(f=2),-e/Math.sqrt(c*c+d*d)>f},_updateNodes:function(a,b,c){this._sineCosine(a,b,c);for(var d=0,e=this._nodes.size();e>d;d++){var f=this._nodes.get(d),g=f.cx,h=f.cy*this._ca+f.cz*-this._sa,i=f.cy*this._sa+f.cz*this._ca,j=g*this._cb+i*this._sb,k=h,l=g*-this._sb+i*this._cb,m=j*this._cc+k*-this._sc,n=j*this._sc+k*this._cc,o=l;f.cx=m,f.cy=n,f.cz=o;var p=2*this._radius;p/=p+o,f.perspective=p;var q=this._horizontalElliptical*m*p-2*this._horizontalElliptical+this._centerX,r=n*p*this._verticalElliptical+this._centerY;f.node.setCenterLocation(q,r)}this._adjustIndex()},_installListeners:function(){this._box=this._network.getElementBox(),this._box.addDataBoxChangeListener(this.handleDataBoxChange,this),this._network.getSelectionModel().addSelectionChangeListener(this.handleSelectionChange,this),this._network.addViewListener(this.handleResize,this),Wb.addEventListener("mouseout","handleRollOut",this._network.getView(),this),Wb.addEventListener("mousemove","handleMouseMove",this._network.getView(),this),Wb.addEventListener("mouseover","handleMouseOver",this._network.getView(),this),this._network.addPropertyChangeListener(this.handleNetworkPropertyChange,this)},_uninstallListeners:function(){this._box.removeDataBoxChangeListener(this.handleDataBoxChange,this),this._network.getSelectionModel().removeSelectionChangeListener(this.handleSelectionChange,this),this._network.removeViewListener(this.handleResize,this),Wb.removeEventListener("mouseout",this._network.getView(),this),Wb.removeEventListener("mousemove",this._network.getView(),this),Wb.removeEventListener("mouseover",this._network.getView(),this),this._network.removePropertyChangeListener(this.handleNetworkPropertyChange,this)}}),Ib.layout.AutoLayouter=function(a){this._box=a},Jb.ext("twaver.layout.AutoLayouter",Object,{_expandGroup:!1,_repulsion:1,_type:null,_animate:!0,_explicitXOffset:Number.NaN,_explicitYOffset:Number.NaN,_xOffset:0,_yOffset:0,isExpandGroup:function(){return this._expandGroup},setExpandGroup:function(a){this._expandGroup=a},getRepulsion:function(){return this._repulsion},setRepulsion:function(a){this._repulsion=a},getType:function(){return this._type},isAnimate:function(){return this._animate},setAnimate:function(a){this._animate=a},getElementBox:function(){return this._box},getExplicitXOffset:function(){return this._explicitXOffset},setExplicitXOffset:function(a){this._explicitXOffset=a},getExplicitYOffset:function(){return this._explicitYOffset},setExplicitYOffset:function(a){this._explicitYOffset=a},getDimension:function(a){if(a instanceof Nd&&a.getChildrenSize()>0){for(var b=null,c=0,d=a.getChildrenSize();d>c;c++){var e=a.getChildAt(c);e instanceof Ld&&(b=b?Tb.unionRect(b,e.getRect()):e.getRect())}return b?{width:b.width,height:b.height}:null}return{width:a.getWidth(),height:a.getHeight()}},isVisible:function(a){return!0},isMovable:function(a){return!0},getGroupLayoutType:function(a){return this._type},getElements:function(){var a,b=this._box,c=b.getSelectionModel().size()>1;c?a=b.getSelectionModel().getSelection():(a=new nd,b.forEachByBreadthFirst(a.add,null,a)),this._xOffset=-1,this._yOffset=-1;for(var d=new nd,e=0,f=a.size();f>e;e++){var g=a.get(e);this.isVisible(g)&&(g instanceof Ib.Link?d.add(g):this.isMovable(g)&&g instanceof Ld&&(d.add(g),c&&((this._xOffset<0||g.getX()<this._xOffset)&&(this._xOffset=g.getX()),
(this._yOffset<0||g.getY()<this._yOffset)&&(this._yOffset=g.getY()))))}return c||(this._xOffset=isNaN(this._explicitXOffset)?50/this._repulsion:this._explicitXOffset,this._yOffset=isNaN(this._explicitYOffset)?50/this._repulsion:this._explicitYOffset),d},getLayoutResult:function(a){var b={};return this.doLayoutImpl(a,null,b),b},doLayout:function(a,b){return this.doLayoutImpl(a,b)},doLayoutImpl:function(a,b,c){var d=this,e=b;b=function(){d._box._layoutMovingElements=!1,e&&e()},this._type=a;var f=null;if("round"===a?f=new df:"symmetry"===a?f=new sf:"hierarchic"===a?f=new Cf:("topbottom"===a||"bottomtop"===a||"rightleft"===a||"leftright"===a)&&(f=new Re),null==f)return!1;d._box._layoutMovingElements=!0;var g={},h=this.getElements(),i=new tf(this,h,!0,null);h=i.process();var j=new nf(this,h,a,!0,null);try{f.i2(j)}catch(k){return i.resetGroup(),null!=b&&b(),!1}var l,m;for(l in j._a){m=j._a[l];var n=j.g4(m);g[l]={x:n.x+this._xOffset,y:n.y+this._yOffset}}var o;if("rightleft"===a||"leftright"===a||"bottomtop"===a){var p=tf.createMatrix(a),q=Number.MAX_VALUE,r=Number.MAX_VALUE;for(l in g){m=j._a[l],o=g[l];var s=p.transform(o);o.x=s.x,o.y=s.y;var t;"rightleft"===a||"leftright"===a?(t=s.x-j.g9(m)/2/this._repulsion,q>t&&(q=t),t=s.y-j.gj(m)/2/this._repulsion,r>t&&(r=t)):(t=s.x-j.gj(m)/2/this._repulsion,q>t&&(q=t),t=s.y-j.g9(m)/2/this._repulsion,r>t&&(r=t))}for(l in g)m=j._a[l],o=g[l],o.x=o.x-q+this._xOffset,o.y=o.y-r+this._yOffset}if(null==c&&this._animate){var u=new nd,v=new nd;for(l in g)u.add(j._a[l].node),v.add(g[l]);Ib.animate.AnimateManager.endAnimate(),d._box._dataBoxChangeDispatcher.fire({kind:"layouting"}),Ib.animate.AnimateManager.start(new Ib.animate.AnimateCenterLocation(u,v,function(){i.resetGroup(),d._box._dataBoxChangeDispatcher.fire({kind:"layoutEnd"}),null!=b&&Jb.callLater(b)}))}else{d._box._dataBoxChangeDispatcher.fire({kind:"layouting"});for(l in g)m=j._a[l],o=g[l],null==c?m.node.setCenterLocation(o.x,o.y):c[m.node.getId()]=o;i.resetGroup(),d._box._dataBoxChangeDispatcher.fire({kind:"layoutEnd"}),null!=b&&Jb.callLater(b)}return!0}});var Sd=function(a,b){this.x=a,this.y=b};Jb.ext(Sd,Object,{equals:function(a){return this===a?!0:a instanceof Sd?a.x==this.x&&a.y==this.y:!1}});var Td=function(a,b){this.width=a,this.height=b};Jb.ext(Td,Object,{});var Ud=function(a,b){this.x=a,this.y=b};Jb.ext(Ud,Object,{});var Vd=function(){2===arguments.length?(Vd.superClass.constructor.call(this,arguments[1].width,arguments[1].height),this.x=arguments[0].x,this.y=arguments[0].y):(Vd.superClass.constructor.call(this,arguments[2],arguments[3]),this.x=arguments[0],this.y=arguments[1])};Jb.ext(Vd,Td,{});var Wd=function(a,b){if(Wd.a2(a.x,b.x))this._a=1,this._b=0,this._c=-a.x;else{this._b=-1;var c=(b.y-a.y)/(b.x-a.x),d=a.y-a.x*c;this._a=c,this._c=d}};Jb.ext(Wd,Object,{a3:function(){return this._a},a4:function(){return this._b},a5:function(){return this._c}}),Wd.a6=function(a,b){if(Wd.a1(a.a3())&&Wd.a1(b.a3()))return null;if(Wd.a1(a.a4())&&Wd.a1(b.a4()))return null;if(Wd.a1(b.a4())){var c=a;a=b,b=c}var d,e,f=a.a3(),g=a.a4(),h=-a.a5();Wd.a1(a.a3())?(d=b.a4(),e=-b.a5()):(d=b.a4()-b.a3()/a.a3()*a.a4(),e=-b.a5()-b.a3()/a.a3()*-a.a5());var i=e/d,j=(h-i*g)/f;return new Sd(j,i)},Wd.a1=function(a){return Wd.a2(a,0)},Wd.a2=function(a,b){return Math.abs(a-b)<1e-5};var Xd=function(a){if(this._a=new qe,a)for(var b=0;b<a.size();b++)this._a.aa(a.get(b))};Jb.ext(Xd,Object,{c:function(){return this._a.ah()},d:function(){return this._a.ah()},a:function(){for(var a=new nd,b=this.c();b.i1();b.i2())a.add(b.i6(),0);return new Xd(a)},b:function(){return this._a.ay()}});var Yd=function(a,b){this.x=a,this.y=b};Jb.ext(Yd,Object,{a:function(a,b){this.x=a,this.y=b}});var Zd=function(a,b){this.x=a||0,this.y=b||0};Jb.ext(Zd,Object,{b:function(){return new Zd(this.x,this.y)},a:function(a){this.z=a},c:function(){return this.x},d:function(){return this.y},f:function(a,b){this.x=a,this.y=b}});var $d=function(a){this._c=new qe,a?(this.ac(a.a8().b()),this.ad(a.a9().b())):(this.ac(new Zd),this.ad(new Zd))};Jb.ext($d,Object,{a6:function(){return this.a5(this)},ac:function(a){a.a(this),this._a=a},ad:function(a){a.a(this),this._b=a},a8:function(){return this._a},a9:function(){return this._b},a1:function(a,b){return this.a4(a,b,this.aa())},a2:function(){return this._c.ay()},a7:function(a){return this._c.ak(a)},aa:function(){return 0===this._c.ay()?null:this._c.as()},a3:function(){this._c.af()},i2:function(a){var b=this.a7(a);return null!=b?new Sd(b.x,b.y):null},i1:function(){return this.a2()},i6:function(){var a=this.a8();return new Sd(a.c(),a.d())},i7:function(){var a=this.a9();return new Sd(a.c(),a.d())},i8:function(a){this.a8().f(a.x,a.y)},i9:function(a){this.a9().f(a.x,a.y)},i3:function(a,b,c){var d=this.a7(a);null!=d&&d.a(b,c)},i4:function(a,b){this.a1(a,b)},i5:function(){this.a3()}});var _d=function(a){_d.superClass.constructor.call(this,a)};Jb.ext(_d,$d,{a5:function(a){return new _d(a)},a4:function(a,b,c){var d=new Yd(a,b);return this.ab(d,c),d},ab:function(a,b){this._c.an(a,this._c.al(b))}});var ae=function(){if(2===arguments.length){var a=arguments[0],b=arguments[1];this._s=!1,this._w=30,this._h=30,this._x=a-this._w/2,this._y=b-this._h/2}else{var c=arguments[0];this._s=c._s,this._w=c._w,this._h=c._h,this._x=c._x,this._y=c._y}};Jb.ext(ae,Object,{m3:function(){return this.m2(this)},m4:function(){return this._x+this._w/2},m5:function(){return this._y+this._h/2},m6:function(a,b){this._x=a-this._w/2,this._y=b-this._h/2},i1:function(){return this._x},i2:function(){return this._y},i5:function(a,b){this._x=a,this._y=b},i3:function(){return this._w},i4:function(){return this._h},i6:function(a,b){var c=(this._w-a)/2,d=(this._h-b)/2;this._x+=c,this._y+=d,this._w=a,this._h=b},m1:function(a){var b,c,d,e;a.width<=0?(b=this._x,c=this._x+this._w,d=this._y,e=this._y+this._h):(b=Math.min(this._x,a.x),c=Math.max(this._x+this._w,a.x+a.width),d=Math.min(this._y,a.y),e=Math.max(this._y+this._h,a.y+a.height)),a.x=b,a.y=d,a.width=c-b,a.height=e-d}});var be=function(a){a?be.superClass.constructor.call(this,a):be.superClass.constructor.call(this,0,0)};Jb.ext(be,ae,{m2:function(a){return new be(a)}});var ce={};ce.a2=function(a){var b=Ne.a2(Hf.a(a.xa()));return ce.a4(a,b,ce.a3(a,b))},ce.a3=function(a,b){for(var c=a.x9();c.i1();c.i2())b.i7(c.i9(),-1);for(var d=0,e=new we(a.xa()),f=a.x9();f.i1();f.i2()){var g=f.i9();-1===b.i2(g)&&ce.a(g,e,b,d++)}return d},ce.a6=function(a){for(var b=new re,c=ce.a2(a),d=0;d<c.length-1;d++){var e=a.xo(c[d].x2(),c[d+1].x3());b.aa(e)}return b},ce.a4=function(a,b,c){for(var d=[],e=0;c>e;e++)d[e]=new Je;for(var f=a.x9();f.i1();f.i2())d[b.i2(f.i9())].ae(f.i9());return d},ce.a=function(a,b,c,d){for(b.c(a),c.i7(a,d);!b.a();){a=b.b();for(var e=a.ag();null!=e;e=e.a8()){var f=e.a3();-1===c.i2(f)&&(c.i7(f,d),b.c(f))}for(var g=a.ae();null!=g;g=g.a7()){var h=g.a2();-1===c.i2(h)&&(c.i7(h,d),b.c(h))}}},ce.a1=function(a,b,c){var d=new le(b,c);return d.a8(a),d._i},ce.a5=function(a,b,c){for(var d=[],e=0;c>e;e++)d[e]=new re;for(var f=a.xf();f.i1();f.i2())d[b.i2(f.i8())].aa(f.i8());return d},ce.a7=function(a){var b=new re,c=Ne.a3(Hf.b(a.xa())),d=Ne.a4(Hf.a(a.xh())),e=ce.a1(a,d,c),f=ce.a5(a,d,e);if(f.length>1){for(var g=new Je,h=0;h<f.length;h++){var i=f[h],j=null;if(1===i.ay()){var k=i.c2();1===k.a2().ad()?j=k.a2():1===k.a3().ad()&&(j=k.a3())}else{for(var l=i.c1();l.i1();l.i2()){var m=l.i8();if(c.i4(m.a2()))if(null==j)j=m.a2();else if(j!==m.a2()){j=null;break}if(c.i4(m.a3()))if(null!=j){if(j!==m.a3()){j=null;break}}else j=m.a3()}if(null!=j){var n=i.c2();j=n.a2()!==j?n.a2():n.a3()}}null!=j&&g.aa(j)}for(var o,p=g.x4();!g.ar();p=o)o=g.x4(),b.ac(a.xo(p,o))}return b};var de=function(){this._c=0,this._d=0,this._e=0,this._b=!0,this._f=!1};Jb.ext(de,Object,{a6:function(a){this._f=a},a7:function(a){this._b=a},a8:function(a){0!==a.x0()&&this.a9(a,a.x9().i9())},a9:function(a,b){if(this._xx=a.xk(),this._c=a.xl(),this._d=0,this._e=0,this.a0(b),this._b)for(var c=a.x9();c.i1();c.i2()){var d=c.i9();null==this._xx.i1(d)&&(this.a1(d),this.a0(d))}a.xi(this._xx),a.xj(this._c)},a0:function(a){var b=++this._d;this._xx.z1(a,de._B),this.a5(a,b);for(var c=this._f?a.ap():a.af();c.i1();c.i2()){var d=c.i8();if(!this._c.i4(d)){this._c.i7(d,!0);var e=d.a1(a);null==this._xx.i1(e)?(this.a3(d,e,!0),this.a0(e),this.a2(d,e)):this.a3(d,e,!1)}}this.a4(a,b,++this._e),this._xx.z1(a,de._C)},a5:function(a,b){},a4:function(a,b,c){},a3:function(a,b,c){},a2:function(a,b){},a1:function(a){}}),de._B={},de._C={};var ee=function(a){this._a=a};Jb.ext(ee,de,{a5:function(a,b){var c=this._a._ah.i2(a);this._a._ad[c].ae(a)}});var fe=function(a){this._a=a};Jb.ext(fe,de,{a2:function(a,b){var c=a.a1(b),d=this._a[c.al()],e=this._a[b.al()];e._a+1>d._a?(d._c=d._a,d._b=d._d,d._a=e._a+1,d._d=a):e._a+1>d._c&&(d._c=e._a+1,d._b=a)}});var ge=function(a){this._a=a};Jb.ext(ge,de,{a3:function(a,b,c){c&&a.a2()===b&&this._a.ac(a)}});var he=function(){this._a=0,this._c=0};Jb.ext(he,Object,{});var ie=function(){this._a=0};Jb.ext(ie,Object,{a1:function(a,b){this._a=0;for(var c=b.length-1;c>=0;c--)b[c]=-1;for(var d=a.x9();d.i1();d.i2()){var e=d.i9();if(0===e.ak()){this.a2(e,e.al(),b);break}}for(var f=a.x9();f.i1();f.i2()){var g=f.i9(),h=g.al();-1===b[h]&&this.a2(g,h,b)}},a2:function(a,b,c){c[b]=-2;for(var d=a.ag();null!=d;){var e=d.a3(),f=e.al();switch(c[f]){case-1:this.a2(e,f,c);case-2:default:d=d.a8()}}c[b]=this._a++}});var je={};je.a1=function(a){var b=new ke;return b.a8(a),b._n},je.a2=function(a){var b=a.x9(),c=null,d=0;for(b.i4();b.i1();b.i2())0===b.i9().ak()&&(c=b.i9(),d++);if(1===d)return c;for(d=0,b.i4();b.i1();b.i2())0===b.i9().ao()&&(c=b.i9(),d++);return 1===d?c:je.a8(a)},je.a8=function(a){var b=Hf.a(a.x0()),c=Ne.a2(b);return je.a6(a,c)},je.a6=function(a,b){var c=a.xd(),d=Hf.d(1),e=Hf.a(a.x0(),-1),f=je.a4(a,c);je.a7(c,b,d,e,-1);for(var g=f.c1();g.i1();g.i2())a.x3(g.i8());return d[0]},je.a7=function(a,b,c,d,e){for(var f=0,g=a.ag();null!=g;g=g.a8()){var h=g.a3(),i=je.a7(h,b,c,d,e);i>e&&(e=i),f+=d[h.al()]}for(var j=f*(a._g.xa()-1-f),k=a.ag();null!=k;k=k.a8())for(var l=k.a3(),m=k.a8();null!=m;m=m.a8()){var n=m.a3();j+=d[l.al()]*d[n.al()]}return b.i7(a,j),d[a.al()]=f+1,j>e&&(e=j,c[0]=a),e},je.a4=function(a,b){var c=new re,d=new ge(c);d.a6(!1),d.a9(a,b);for(var e=c.c1();e.i1();e.i2())a.x3(e.i8());return c},je.a3=function(a){return je.a4(a,je.a2(a))};var ke=function(){this._n=!0,this.a6(!1)};Jb.ext(ke,de,{a3:function(a,b,c){c||(this._n=!1)},a1:function(a){this._n=!1}});var le=function(a,b){this._i=0,this._m=b,this._j=a,this._l=!1};Jb.ext(le,de,{a8:function(a){this._h=Hf.a(a.x0()),this._k=Hf.a(a.x0()),this._g=new we(a.xh()),le.superClass.a8.call(this,a)},a5:function(a,b){this._k[a.al()]=this._h[a.al()]=b},a3:function(a,b,c){if(this._g.c(a),!c){var d=a.a1(b);this._h[d.al()]=Math.min(this._h[d.al()],this._k[b.al()])}},a1:function(a){this._l=!1},a2:function(a,b){var c=a.a1(b);if(this._h[b.al()]>=this._k[c.al()]){for(;this._g.d()!==a;this._j.i5(this._g.b(),this._i));this._j.i5(this._g.b(),this._i),this._i++,this._g.a()?this._l?this._m.i5(c,!0):this._l=!0:this._m.i5(c,!0)}this._h[c.al()]=Math.min(this._h[c.al()],this._h[b.al()])}});var me=function(a,b){this._h=!1,this._i=a,this._g=b};Jb.ext(me,Object,{z1:function(a,b){a._c[this._i]=b},i1:function(a){return a._c[this._i]},i5:function(a,b){a._c[this._i]=b},i4:function(a){return a._c[this._i]},i7:function(a,b){a._c[this._i]=b},i2:function(a){var b=a._c[this._i];return null==b?0:b},i6:function(a,b){a._c[this._i]=b},i3:function(a){var b=a._c[this._i];return null==b?0:b},c:function(){return this._h},d:function(){this._h=!0}});var ne=function(a,b){this._c=!1,this._d=a,this._b=b};Jb.ext(ne,Object,{i8:function(a,b){a._c[this._d]=b},i1:function(a){return a._c[this._d]},i7:function(a,b){a._c[this._d]=b},i4:function(a){var b=a._c[this._d];return null==b?!1:b},i5:function(a,b){a._c[this._d]=b},i2:function(a){var b=a._c[this._d];return null==b?0:b},i6:function(a,b){a._c[this._d]=b},i3:function(a){var b=a._c[this._d];return null==b?0:b},a:function(){return this._c},b:function(){this._c=!0}});var oe=function(a){this._bb=a,this.i4()};Jb.ext(oe,Object,{i1:function(){return null!=this._aa},i2:function(){this._aa=this._aa._a},i3:function(){this._aa=this._aa._b},i4:function(){this._aa=this._bb._b},i5:function(){this._aa=this._bb._c},i7:function(){return this._bb.ay()},i6:function(){return this._aa._c}});var pe=function(a){pe.superClass.constructor.call(this,a)};Jb.ext(pe,oe,{i8:function(){return this.i6()}});var qe=function(a){if(this._id=Jb.id(),this._a=0,a)for(a.i4();a.i1();a.i2())this.ae(a.i6())};Jb.ext(qe,Object,{ac:function(a){var b=this.ag(a);return null==this._b?this._b=this._c=b:(this._b._b=b,b._a=this._b,this._b=b),this._a++,b},ae:function(a){var b=this.ag(a);return null==this._c?this._b=this._c=b:(this._c._a=b,b._b=this._c,this._c=b),this._a++,b},z1:function(a){a._b=null,a._a=null,null==this._c?this._b=this._c=a:(this._c._a=a,a._b=this._c,this._c=a),this._a++},ad:function(a){a._b=null,a._a=null,null==this._b?this._b=this._c=a:(this._b._b=a,a._a=this._b,this._b=a),this._a++},aa:function(a){return this.ae(a),!0},ab:function(a){for(;a.i1();a.i2())this.ae(a.i6())},ao:function(a,b){if(b===this._b)return this.ac(a);if(null==b)return this.ae(a);var c=this.ag(a);return this.aq(c,b),c},aq:function(a,b){if(null==b)this.ad(a);else if(b===this._b)this.ad(a);else{if(null==this._c)a._b=null,a._a=null,this._b=this._c=a;else{var c=b._b;b._b=a,a._a=b,c._a=a,a._b=c}this._a++}},ap:function(a,b){if(null==b)this.z1(a);else if(b===this._c)this.z1(a);else{if(null==this._b)a._b=null,a._a=null,this._b=this._c=a;else{var c=b._a;b._a=a,a._a=c,c._b=a,a._b=b}this._a++}},an:function(a,b){if(b===this._c)return this.ae(a);if(null==b)return this.ac(a);var c=this.ag(a);return this.ap(c,b),c},ay:function(){return this._a},ar:function(){return 0===this._a},af:function(){this._b=this._c=null,this._a=0},am:function(){return this._b._c},at:function(){var a=this.am();return this.aw(this._b),a},as:function(){return this._c._c},au:function(){return this.aw(this._c)},ak:function(a){for(var b=0,c=this._b;null!=c;){if(a===b)return c._c;c=c._a,b++}return null},aj:function(a){return null==a._a?this._b:a._a},ai:function(a){return null==a._b?this._c:a._b},aw:function(a){return a!==this._b?a._b._a=a._a:this._b=a._a,a!==this._c?a._a._b=a._b:this._c=a._b,this._a--,a._c},av:function(a){return this.aw(a._aa)},ah:function(){return new oe(this)},al:function(a){for(var b=this._b;null!=b;){if(null==b._c&&null==a)return b;if(b._c===a)return b;b=b._a}return null},a0:function(){for(var a=Hf.d(this._a),b=0,c=this._b;null!=c;)a[b]=c._c,c=c._a,b++;return a},ax:function(){for(var a=this._b;null!=a;a=a._b){var b=a._a;a._a=a._b,a._b=b}var c=this._b;this._b=this._c,this._c=c},a1:function(a){var b=this.a0();b.sort(a);for(var c=0,d=this._b;null!=d;)d._c=b[c],d=d._a,c++},a2:function(){var a=this.a0();a.sort(Hf.c);for(var b=0,c=this._b;null!=c;)c._c=a[b],c=c._a,b++},az:function(a){null==this._b?(this._b=a._b,this._c=a._c):null!=a._b&&(this._c._a=a._b,a._b._b=this._c,this._c=a._c),this._a+=a._a,a._b=a._c=null,a._a=0},ag:function(a){return new ue(a)}});var re=function(a){re.superClass.constructor.call(this,a)};Jb.ext(re,qe,{c1:function(){return new pe(this)},c2:function(){return this.am()},c3:function(){return this.at()}});var se=function(){this._c=0};Jb.ext(se,Object,{a:function(a){this._c++,a._b=this._b,a._a=null,null!=this._b?(this._b._a=a,this._b=a):this._b=this._a=a},b:function(a,b){if(null==b)return void this.a(a);var c=b._b;null!=c?c._a=a:this._a=a,a._b=c,a._a=b,b._b=a,this._c++},c:function(a){var b=a._a,c=a._b;this._c--,null!=b?b._b=c:this._b=c,null!=c?c._a=b:this._a=b}});var te=function(a,b){this._p=a,this._j=b,this._o=a._o[b]};Jb.ext(te,Object,{i1:function(){return null!=this._o},i2:function(){this._o=this._o._k[this._j]},i3:function(){this._o=this._o._f[this._j]},i4:function(){this._o=this._p._o[this._j]},i5:function(){this._o=this._p._q[this._j]},i7:function(){return this._p._n[this._j]},i6:function(){return this._o},i8:function(){return this._o}});var ue=function(a){this._c=a};Jb.ext(ue,Object,{a:function(){return this._a},b:function(){return this._b},c:function(a){this._c=a},d:function(){return this._c}});var ve=function(a,b,c,d){this._r=a,this._s=b,this._q=c,this._p=d};Jb.ext(ve,Object,{i1:function(a){return this._p[a.a5()]},i3:function(a){return this._r[a.a5()]},i2:function(a){return this._s[a.a5()]},i4:function(a){return this._q[a.a5()]},i8:function(a,b){this._p[a.a5()]=b},i6:function(a,b){this._r[a.a5()]=b},i5:function(a,b){this._s[a.a5()]=b},i7:function(a,b){this._q[a.a5()]=b}});var we=function(a){this._a=Hf.d(a),this._b=-1};Jb.ext(we,Object,{d:function(){return this._a[this._b]},b:function(){return this._a[this._b--]},c:function(a){this._a[++this._b]=a},a:function(){return this._b<0}});var xe=function(){};Jb.ext(xe,Object,{a0:function(a){this._c=Hf.d(a)}});var ye=function(a,b,c,d,e,f,g){this._g=0,a.xt(this,b,c,d,e,f,g)};Jb.ext(ye,xe,{a5:function(){return this._h._u&&this._h.b1(),this._g},a2:function(){return this._d},a3:function(){return this._e},a1:function(a){return this._d!==a?this._d:this._e},a4:function(){for(var a=0;1>=a;a++)this._k[a]=null,this._f[a]=null},a8:function(){return this._k[0]},a7:function(){return this._k[1]},a6:function(a,b,c,d){this.a0(d),this._h=a,this._k=Hf.d(2),this._f=Hf.d(2),this._d=b,this._e=c}});var ze=function(a){this._j=0,this._h=a,this.i4()};Jb.ext(ze,Object,{i2:function(){this._k=this._k._k[this._j],null==this._k&&0===this._j&&(this._k=this._h._o[1],this._j=1)},i3:function(){this._k=this._k._f[this._j],null==this._k&&1===this._j&&(this._k=this._h._q[0],this._j=0)},i4:function(){this._k=this._h._o[0],null==this._k?(this._k=this._h._o[1],this._j=1):this._j=0},i5:function(){this._k=this._h._q[1],null==this._k?(this._k=this._h._q[0],this._j=0):this._j=1},i1:function(){return null!=this._k},i6:function(){return this._k},i8:function(){return this._k},i7:function(){return this._h.ad()}});var Ae=function(){this._a=ff._A,this._b=ff._A,this._c=new nd};Jb.ext(Ae,Object,{i1:function(){return this._c.size()},i2:function(a){return this._c.get(a)},i3:function(a,b,c){this._c.set(a,new Sd(b,c))},i4:function(a,b){this._c.add(new Sd(a,b))},i5:function(){this._c.clear()},i6:function(){return this._a},i7:function(){return this._b},i8:function(a){this._a=a},i9:function(a){this._b=a}});var Be=function(){this._x=0,this._y=0,this._w=0,this._h=0};Jb.ext(Be,Object,{i5:function(a,b){this._x=a,this._y=b},i6:function(a,b){this._w=a,this._h=b},i4:function(){return this._h},i3:function(){return this._w},i1:function(){return this._x},i2:function(){return this._y}});var Ce=function(a,b,c,d){this._m=a,this._n=b,this._l=c,this._k=d};Jb.ext(Ce,Object,{i1:function(a){return this._k[a.al()]},i3:function(a){return this._m[a.al()]},i2:function(a){return this._n[a.al()]},i4:function(a){return this._l[a.al()]},z1:function(a,b){this._k[a.al()]=b},i6:function(a,b){this._m[a.al()]=b},i7:function(a,b){this._n[a.al()]=b},i5:function(a,b){this._l[a.al()]=b}});var De=function(a,b){this._b=a,this._r=b,this._a=[];for(var c=this._b-1;c>=0;c--)this._a.push(c);this._c=new nd};Jb.ext(De,Object,{a1:function(a){var b;if(0===this._a.length){this.a2(a,this._b,this._b+this._r);for(var c=this._b+this._r-1;c>this._b;c--)this._a.push(c);b=this._b,this._b+=this._r}else b=this._a.pop();return b},b:function(a){var b=this.a1(a),c=new me(b,this);return this._c.add(c),this.a4(a,b),c},c:function(a){var b=this.a1(a),c=new ne(b,this);return this._c.add(c),this.a4(a,b),c},a2:function(a,b,c){for(var d=a._a;null!=d;d=d._a){var e=Hf.d(c);Hf.f(d._c,e,b),d._c=e}},a3:function(a,b,c){var d=Hf.d(c);Hf.f(a._c,d,b),a._c=d},a4:function(a,b){for(var c=a._a;null!=c;c=c._a)c._c[b]=null},a5:function(a,b){if(a instanceof me){var c=a;if(c.c())throw"Error";c.d();var d=a._i;this._a.indexOf(d)<0&&(this.a4(b,d),this._a.push(d),this._c.remove(a))}},a6:function(a,b){if(a instanceof ne){var c=a;if(c.a())throw"Error";c.b();var d=c._d;this._a.indexOf(d)<0&&(this.a4(b,d),this._a.push(d),this._c.remove(a))}}});var Ee=function(a){this._id=Jb.id(),this._p=0,a.xs(this)};Jb.ext(Ee,xe,{ad:function(){return this._n[0]+this._n[1]},ak:function(){return this._n[1]},ao:function(){return this._n[0]},al:function(){return this._g._y&&this._g.c(),this._p},ag:function(){return this._o[0]},ae:function(){return this._o[1]},af:function(){return new ze(this)},am:function(){return new te(this,1)},ap:function(){return new te(this,0)},an:function(){return new Ge(this)},aq:function(){return new Fe(this,1)},aw:function(){return new Fe(this,0)},ah:function(a){for(var b=this._o[0];null!=b;b=b._k[0])if(b.a3()===a)return b;return null},ai:function(a){for(var b=this._o[1];null!=b;b=b._k[1])if(b.a2()===a)return b;return null},aj:function(a){var b=this.ah(a);return null==b&&(b=this.ai(a)),b},au:function(a){this.at(a,1,Hf.d(this.ak()))},av:function(a){this.at(a,0,Hf.d(this.ao()))},as:function(a,b){this.a0(b),this._g=a,this._o=Hf.d(2),this._q=Hf.d(2),this._n=Hf.a(2)},ab:function(a,b,c,d,e){if(null==b)return void this.aa(a,c,d);var f;if(f=b._d===b._e?d:this!==b._d?1:0,0===e){var g=b._k[f];a._f[d]=b,a._k[d]=g,b._k[f]=a,null==g?this._q[c]=a:g._d===g._e?g._f[d]=a:g._f[this!==g._d?1:0]=a}else{var h=b._f[f];a._k[d]=b,a._f[d]=h,b._f[f]=a,null==h?this._o[c]=a:h._d===h._e?h._k[d]=a:h._k[this!==h._d?1:0]=a}this._n[c]++},aa:function(a,b,c){var d=this._q[b];a._k[c]=null,null==d?(this._o[b]=a,a._f[c]=null):(a._f[c]=d,d._d===d._e?d._k[c]=a:d._k[this!==d._d?1:0]=a),this._q[b]=a,this._n[b]++},ar:function(a,b,c){var d,e;d=a._k[c],e=a._f[c],null==d?this._q[b]=e:d._f[d._d!==this?1:0]=e,null==e?this._o[b]=d:e._k[e._d!==this?1:0]=d,this._n[b]--},ac:function(){for(var a=0;1>=a;a++)this._o[a]=null,this._q[a]=null,this._n[a]=0},at:function(a,b,c){if(!(this._n[b]<2)){var d,e=this._n[b],f=0;for(d=this._o[b];null!=d;d=d._k[b])c[f]=d,f++;Hf.s(c,e,a);var g=this._o[b]=c[0];g._f[b]=null;for(var h=1;e>h;)d=c[h],d._f[b]=g,g._k[b]=d,h++,g=d;this._q[b]=d,d._k[b]=null}}});var Fe=function(a,b){Fe.superClass.constructor.call(this,a,b),this._h=1!==b?1:0};Jb.ext(Fe,te,{i6:function(){return this.i9()},i9:function(){return 0!==this._h?this._o._e:this._o._d}});var Ge=function(a){Ge.superClass.constructor.call(this,a)};Jb.ext(Ge,ze,{i6:function(){return this._k.a1(this._h)},i9:function(){return this._k.a1(this._h)}});var He=function(a){He.superClass.constructor.call(this,a)};Jb.ext(He,oe,{i9:function(){return this.i6()}});var Ie=function(a){this._o=a,this._c=a._a};Jb.ext(Ie,Object,{i1:function(){return null!=this._c},i2:function(){this._c=this._c._a},i3:function(){this._c=this._c._b},i5:function(){this._c=this._o._b},i4:function(){this._c=this._o._a},i7:function(){return this._o._c},i6:function(){return this._c},i9:function(){return this._c},i8:function(){return this._c}});var Je=function(a){if(a&&a.length){Je.superClass.constructor.call(this);for(var b=0;b<a.length;b++)this.ae(a[b])}else Je.superClass.constructor.call(this,a)};Jb.ext(Je,qe,{x1:function(){return new He(this)},x2:function(){return this.am()},x3:function(){return this.as()},x4:function(){return this.at()}});var Ke=function(a){this._d=a,Ke.superClass.constructor.call(this)};Jb.ext(Ke,Je,{});var Le=function(a){this._a=a,this._b=new re,this._c=new Je};Jb.ext(Le,Object,{a:function(){for(var a=this._a.x9();a.i1();a.i2())this.e(a.i9())},b:function(){this.c(),this.d()},c:function(){for(;!this._c.ar();){var a=this._c.x4();this._a.xq(a)||this.g(a)}},d:function(){for(;!this._b.ar();){var a=this._b.c3();this._a.xp(a)||this.f(a)}},e:function(a){for(var b=a.af();b.i1();b.i2())this._b.ac(b.i8()),this._a.h1(b.i8());this._c.ac(a),this._a.h2(a)},f:function(a){this._a.u1(a)},g:function(a){this._a.h3(a)}}),Le.h=function(a,b){for(b.i4();b.i1();b.i2()){var c=b.i8();a.xq(c.a2())||a.h3(c.a2()),a.xq(c.a3())||a.h3(c.a3()),a.xp(c)||a.u1(c)}},Le.i=function(a,b){for(b.i4();b.i1();b.i2()){var c=b.i8();a.xp(c)&&a.h1(c),0===c.a2().ad()&&a.h2(c.a2()),0===c.a3().ad()&&a.h2(c.a3())}};var Me=function(){this._g=arguments[0],this._f=this._g.xk(),this._h=this._g.xk(),this._d=new qe,this._e=0,1!==arguments.length&&this.a(arguments[1],arguments[2],arguments[3],arguments[4])};Jb.ext(Me,Object,{a:function(a,b,c,d){for(var e=Hf.d(c-b+1),f=b;c>=f;f++)e[f]=new Ke(f);for(var g=this._g.x9();g.i1();g.i2()){var h=g.i9();(null==d||d.i4(h))&&(this._f.z1(h,e[a.i2(h)-b].ac(h)),this._e++)}for(var i=0;i<e.length;i++)for(var j=e[i],k=this._d.ae(j),l=j.x1();l.i1();l.i2())this._h.z1(l.i9(),k)},c:function(){this._g.xi(this._h),this._g.xi(this._f)},e:function(){return 0===this._e},g:function(){for(;this._d.am().ar();this._d.at());this._e--;var a=this._d.am().x4();return this._h.z1(a,null),this._f.z1(a,null),a},f:function(){for(;this._d.as().ar();this._d.au());this._e--;var a=this._d.as().x4();return this._h.z1(a,null),this._f.z1(a,null),a},d:function(a){var b=this._f.i1(a),c=this._h.i1(a),d=c.d(),e=null,f=c.a();null!=f?(e=f.d(),this._h.z1(a,f)):(e=new Ke(d._d+1),this._h.z1(a,this._d.ae(e))),d.aw(b),this._f.z1(a,e.ac(a))},b:function(a){var b=this._f.i1(a),c=this._h.i1(a),d=c.d(),e=null,f=c.b();null!=f?(e=f.d(),this._h.z1(a,f)):(e=new Ke(d._d-1),this._h.z1(a,this._d.ac(e))),d.aw(b),this._f.z1(a,e.ac(a))}});var Ne={};Ne.a1=function(a){return new Ce(a,null,null,null)},Ne.a2=function(a){return new Ce(null,a,null,null)},Ne.a3=function(a){return new Ce(null,null,a,null)},Ne.a4=function(a){return new ve(null,a,null,null)},Ne.a5=function(a){return new ve(null,null,a,null)},Ne.a6=function(a){return new ve(null,null,null,a)};var Oe=function(){if(2===arguments.length){this._a=new qe,this._b=new qe,this._c=0;var a=arguments[0],b=arguments[1],c=new Pe(a._j2.gj(b)/2,0);this._a.ac(c),c=new Pe(a._j2.gj(b)/2,0),this._b.ac(c)}else this._a=arguments[1],this._b=arguments[2],this._c=arguments[3]};Jb.ext(Oe,Object,{});var Pe=function(a,b){this._b=a,this._a=b};Jb.ext(Pe,Object,{});var Qe=function(){this._cx=!0,this._cs=new af,this._ct=new $e,this._cw=new _e};Jb.ext(Qe,Object,{i5:function(a){this._cx=a},k:function(){var a=new bf(this);return this._cx&&(this._cs.w1(a),a=this._cs),this._cw.w1(a),a=this._cw,this._ct.w1(a),a=this._ct},i2:function(a){this.k().i2(a)},i1:function(a){return this.k().i1(a)}});var Re=function(){Re.superClass.constructor.call(this),this._jv=20,this._jw=40,this._jx=function(a,b){var c=a.a3(),d=b.a3(),e=c._g;return Math.floor(100*(e.g5(c)-e.g5(d)))}};Jb.ext(Re,Qe,{i4:function(a){return je.a1(a)},i3:function(a){if(!this.i4(a))throw"Error";var b=je.a3(a);if(this._j2=a,this._j3=new Se(a),of.c(a),this._jy=a.xk(),!a.xb()){this.bu();var c=this._j3.c1();this.f(c),this.b(this._j3),this.c(this._j3)}for(var d;!b.ar();a.x3(d))d=b.c3(),of.b(a.g2(d))},bu:function(){if(null!=this._jx)for(var a=this._j2.x9();a.i1();a.i2())a.i9().av(this._jx)},c:function(a){for(var b=this.a2(a),c=Hf.a(b.length),d=0;d<b.length;d++){for(var e=b[d],f=0,g=e.ah();g.i1();g.i2()){var h=g.i6();f=Math.max(f,this._j2.g9(h))}c[d]=f}for(var i=-this._jw,j=0;j<b.length;j++){i+=this._jw+c[j];for(var k=b[j],l=k.ah();l.i1();l.i2()){var m=l.i6();this._j2.s2(m,this._j2.g5(m),i-c[j]/2)}}},a2:function(a){for(var b=Hf.d(a.b()),c=0,d=a.b();d>c;c++)b[c]=new qe;return a.c1(),this.a1(a.c1(),0,b),b},a1:function(a,b,c){c[b].ae(a);for(var d=a.aw();d.i1();d.i2())this.a1(d.i9(),b+1,c)},b:function(a){var b=a.c1();this._j2.s2(b,0,this._j2.g6(b)),this.g(b)},g:function(a){for(var b=a.aw();b.i1();b.i2()){var c=b.i9(),d=this._jy.i1(c);this._j2.s2(c,this._j2.g5(a)+d._c,this._j2.g6(c)),this.g(c)}},f:function(a){if(this._j3.c2(a))return void this._jy.z1(a,new Oe(this,a));var b=a.aw(),c=b.i9();b.i2(),this.f(c);var d=this._jy.i1(c),e=new Oe(this,d._a,d._b,0);if(!b.i1())return e._a.ac(new Pe(this._j2.gj(a)/2,0)),e._b.ac(new Pe(this._j2.gj(a)/2,0)),void this._jy.z1(a,e);for(;b.i1();){c=b.i9(),b.i2(),this.f(c),d=this._jy.i1(c);for(var f=e._b.ah(),g=d._a.ah(),h=2147483647,i=0,j=0;f.i1()&&g.i1();){var k=f.i6();f.i2();var l=g.i6();g.i2(),j+=k._a,i+=l._a,h=Math.min(h,i-j-k._b-l._b)}d._c=this._jv-h,i+=d._c;var m=d._b.am();if(m._a=d._c,f.i1()&&!g.i1())for(var n=j-this.a3(d._b);f.i1();n=0){var o=f.i6();f.i2(),d._b.ae(new Pe(o._b,o._a+n))}else if(!f.i1()&&g.i1()){var p=this.a3(e._a);for(p=i-p;g.i1();p=0){var q=g.i6();g.i2(),e._a.ae(new Pe(q._b,q._a+p))}}e._b=d._b}this._jy.z1(a,e);for(var r=-d._c/2,s=a.aw();s.i1();){var t=s.i9();s.i2();var u=this._jy.i1(t);u._c+=r;var v=u._b.am();v._a+=r,v=u._a.am(),v._a+=r}e._a.ac(new Pe(this._j2.gj(a)/2,0)),e._b.ac(new Pe(this._j2.gj(a)/2,0))},a3:function(a){for(var b=0,c=a.ah();c.i1();c.i2()){var d=c.i6();b+=d._a}return b}});var Se=function(a){this._b=a,this.a()};Jb.ext(Se,Object,{c1:function(){return null==this._a&&this.a(),this._a},b:function(){return null==this._a?-1:this.d(this._a)},d:function(a){for(var b=0,c=a.aw();c.i1();c.i2())b=Math.max(b,this.d(c.i9()));return b+1},c2:function(a){return 0===a.ao()},a:function(){for(var a=this._b.x9();a.i1();a.i2())if(0===a.i9().ak())return void(this._a=a.i9())}});var Te=function(a){this._d=0,this._e=0,this._f=0,this._a=0,this._b=0,this._g=a,this._c=new qe};Jb.ext(Te,Object,{a:function(){return this._d+this._e+this._f}});var Ue=function(){Ue.superClass.constructor.call(this),this._kl=340,this._km=360,this._kk=40,this._ko=.5};Jb.ext(Ue,Qe,{ic:function(){return this._km},ia:function(){return this._kl},i9:function(){return this._ko},i3:function(a){if(!je.a1(a))throw"Error";this._a=a;var b=this.i8(),c=je.a4(a,b);of.c(a),this._kn=Hf.d(a.x0());for(var d=a.x9();d.i1();d.i2()){var e=d.i9();e!==b?this.aa(e,new Te(this._kk+this.q(e.aq().i9()))):this.aa(e,new Te(this._kk))}this.s(b),a.s2(b,0,0),this.t(b);for(var f;!c.ar();a.x3(f))f=c.c3()},i4:function(a){return je.a1(a)},i0:function(a){return this._kn[a.al()]},i8:function(){return je.a2(this._a)},i7:function(a){for(var b,c=this.ib(a);b=this.i6(a),!(c>=b);)for(var d=a.aw();d.i1();d.i2()){var e=d.i9();this.i0(e)._g*=1+this._ko}var f=(c-b)/(2*a.ao());b=0;for(var g=a.aw();g.i1();g.i2()){var h=this.i0(g.i9());h._d+=f,h._e+=f,b+=h._d+h._e}this.id(a)},id:function(a){for(var b=Hf.d(a.ao()),c=0,d=a.ap();d.i1();)b[c]=d.i8(),d.i2(),c++;var e=this;b.sort(function(a,b){var c=a.a3(),d=b.a3(),f=e.i0(c).a()-e.i0(d).a();return f>0?1:f>=0?0:-1});for(var f=0;f<b.length;f++)this._a.h1(b[f]);for(var g=0;g<b.length;g+=2)this._a.u1(b[g]);for(c=b.length-1,c%2===0&&c--;c>0;c-=2)this._a.u1(b[c])},ib:function(a){return 0===a.ak()?this._km:2===a.ao()?Math.min(180,this._kl):this._kl},i6:function(a){for(var b=0,c=a.ap();c.i1();c.i2()){for(var d,e=c.i8(),f=e.a3(),g=this.i0(f),h=-g._g,i=g._b,j=g._c,k=0,l=k+1,m=j._b,n=m.d();l>k;l=(d.y-i)/(d.x-h))d=n,m=j.ai(m),n=m.d(),k=(n.y-d.y)/(n.x-d.x);for(g._d=180*-Math.atan(l)/Math.PI,k=0,l=k-1,m=j._b,n=m.d();m.a().d().x===n.x;n=m.d())m=m.a();for(var o;k>l;l=(o.y-i)/(o.x-h))o=n,m=j.aj(m),n=m.d(),k=(n.y-o.y)/(n.x-o.x);g._e=180*Math.atan(l)/Math.PI,b+=g._d+g._e}return b},aa:function(a,b){this._kn[a.al()]=b},p:function(a){var b=this.i0(a),c=new qe,d=2*this.q(a);c.aa(new Sd(0,0)),c.aa(new Sd(0,d)),c.aa(new Sd(d,d)),c.aa(new Sd(d,0)),b._c=c,b._a=d/2,b._b=d/2},r:function(a){if(0===a.ao())this.p(a);else{var b=this.i0(a),c=this.q(a),d=new qe;d.aa(new Sd(-c,-c)),d.aa(new Sd(-c,c)),d.aa(new Sd(c,-c)),d.aa(new Sd(c,c));for(var e=a.aw();e.i1();e.i2()){var f=this.i0(e.i9());d.az(f._c)}for(var g=ff.h(d),h=Number.MAX_VALUE,i=Number.MAX_VALUE,j=Number.MIN_VALUE,k=Number.MIN_VALUE,l=g.ah();l.i1();l.i2()){var m=l.i6();m.x<h&&(h=m.x),m.x>j&&(j=m.x),m.y<i&&(i=m.y),m.y>k&&(k=m.y)}for(var n=new qe,o=g.ah();o.i1();o.i2()){var p=o.i6();n.aa(new Sd(p.x-h,p.y-i))}b._c=n,b._a=-h,b._b=-i}},s:function(a){if(0===a.ao())this.r(a);else{for(var b=a.aw();b.i1();b.i2())this.s(b.i9());this.i7(a);for(var c=0,d=a.aw();d.i1();d.i2()){var e=d.i9(),f=this.i0(e),g=180-(360-this.ib(a))/2-c-(f._e+f._f);c+=f.a(),g=g/180*Math.PI;for(var h=Math.sin(g),i=Math.cos(g),j=f._c._b;null!=j;j=j.a()){var k=j.d(),l=k.x+f._g,m=k.y-f._b,n=new Sd(l*i-h*m,l*h+i*m);j.c(n)}var o=f._a+f._g;f._a=o*i,f._b=o*h}this.r(a)}},t:function(a){var b=this._a.g4(a),c=0;if(a.ak()>0){var d=a.aq().i9(),e=this._a.g4(d);c=Math.PI+Math.atan2(e.y-b.y,e.x-b.x)}for(var f=a.aw();f.i1();f.i2()){var g=f.i9(),h=this.i0(g);if(0!==c){
var i=Math.cos(c),j=Math.sin(c),k=h._a*i-j*h._b,l=h._a*j+i*h._b;h._a=k,h._b=l}this._a.s2(g,b.x+h._a,b.y+h._b),this.t(g)}},q:function(a){return 1.41*(Math.max(this._a.gj(a),this._a.g9(a))/2)}});var Ve=function(){};Jb.ext(Ve,Object,{i2:function(a){return a.ad()},i1:function(a){throw"Error"},i3:function(a){throw"Error"},i4:function(a){throw"Error"}});var We=function(a){this._a=a};Jb.ext(We,Object,{i2:function(a){for(var b=0,c=a.an();c.i1();c.i2())null!=this._a.i1(c.i9())&&b++;return b},i4:function(a){return null==this._a.i1(a)},i1:function(a){throw"Error"},i3:function(a){throw"Error"}});var Xe=function(){Xe.superClass.constructor.call(this),this._kq=!1,this._kp=90};Jb.ext(Xe,Ue,{a:function(a,b){this._kr=b,this._ks=a,this._kq=!0},i7:function(a){if(!this.u(a))return void Xe.superClass.i7.call(this,a);for(var b=this.i9(),c=this.ib(a),d=(360-c)/2+c,e=new re(a.ap());;){var f=this.i6(a);f=(360-c)/2;for(var g=null,h=null,i=e._b;null!=i;i=i.a()){var j=i.d(),k=j.a3(),l=this.i0(k),m=this._ks.i3(j),n=m-(f+l._e);if(n>=0&&m+l._d>=d&&(n=f+l.a()<=d?d-f-l.a():2*(d-(m+l._d))),l._f=0,n>=0)l._f=n,g=i,h=l;else{for(-n>l._d+l._e?n=(l._d+l._e)/2:n/=-2,f-=n,d>=f&&f+l.a()>d&&(f+=n,n=f+l.a()-d,f-=n);null!=g&&n>h._f;h=this.i0(g.d().a3()))if(n-=h._f,h._f=0,g=g.b(),null==g){h=null;break}null!=g?h._f-=n:f+=n}f+=l.a()}if(d>=f){for(var o=0,p=(360-c)/2,q=a.ap();q.i1();q.i2()){var r=q.i8(),s=r.a3(),t=this._ks.i3(r),u=this.i0(s),v=p+u._f+u._e;o<Math.abs(v-t)&&(o=Math.abs(v-t)),p+=u.a()}if(o<=this._kp)break}for(var w=a.aw();w.i1();w.i2()){var x=w.i9();this.i0(x)._g*=1+b}}},ib:function(a){return this.u(a)?0===a.ak()?this.ic():this.ia():Xe.superClass.ib.call(this,a)},u:function(a){return this._kq&&0!==a.ao()?null!=this._ks.i1(a.ag()):!1}});var Ye=function(a){this._a=a};Jb.ext(Ye,Object,{i1:function(a){return this._a.i1(a)},i2:function(a){throw"Error"},i3:function(a){throw"Error"},i4:function(a){throw"Error"}});var Ze=function(){};Jb.ext(Ze,Object,{w1:function(a){this._bb=a},w2:function(){return this._bb},w4:function(a){null!=this._bb&&this._bb.i2(a)},w3:function(a){return null!=this._bb?this._bb.i1(a):!0}});var $e=function(){this._cg=45,this._ce=400,this._ch=400,this._cf=0};Jb.ext($e,Ze,{i1:function(a){if(null!=this.w2()){for(var b=!0,c=a.xk(),d=ce.a3(a,c),e=Hf.d(d),f=Hf.d(d),g=0;d>g;g++)e[g]=new Je,f[g]=new re;for(var h=a.xf();h.i1();h.i2()){var i=h.i8();f[c.i2(i.a2())].aa(i),a.h1(i)}for(var j=a.x9();j.i1();j.i2()){var k=j.i9();e[c.i2(k)].aa(k),a.h2(j.i9())}for(var l=0;d>l;l++){for(var m=e[l].x1();m.i1();m.i2())a.h3(m.i9());for(var n=f[l].c1();n.i1();n.i2())a.u1(n.i8());b=this.w3(a);for(var o=f[l].c1();o.i1();o.i2())a.h1(o.i8());for(var p=e[l].x1();p.i1();p.i2())a.h2(p.i9());if(!b)break}for(var q=0;d>q;q++)for(var r=e[q].x1();r.i1();r.i2())a.h3(r.i9());for(var s=0;d>s;s++)for(var t=f[s].c1();t.i1();t.i2())a.u1(t.i8());return a.xi(c),b}return!0},i2:function(a){if(!a.xb()){for(var b=a.xk(),c=ce.a3(a,b),d=Hf.d(c),e=Hf.d(c),f=Hf.d(c),g=Hf.d(c),h=0;c>h;h++)d[h]=new Je,e[h]=new re;for(var i=a.xf();i.i1();i.i2()){var j=i.i8();e[b.i2(j.a2())].aa(j),a.h1(j)}for(var k=a.x9();k.i1();k.i2()){var l=k.i9();d[b.i2(l)].aa(l),a.h2(k.i9())}for(var m=0;c>m;m++){for(var n=d[m].x1();n.i1();n.i2())a.h3(n.i9());for(var o=e[m].c1();o.i1();o.i2())a.u1(o.i8());this.w4(a);var p=a.g3();f[m]=new Vd(p.x,p.y,p.width,p.height);var q={};if(g[m]=q,this._cf>0){var r=this._cg+Math.ceil((p.width+1)/this._cf)*this._cf,s=this._cg+Math.ceil((p.height+1)/this._cf)*this._cf;q.x=p.x,q.y=p.y,q.width=r,q.height=s}else q.x=p.x,q.y=p.y,q.width=p.width+this._cg,q.height=p.height+this._cg;for(var t=e[m].c1();t.i1();t.i2())a.h1(t.i8());for(var u=d[m].x1();u.i1();u.i2())a.h2(u.i9())}for(var v=0;c>v;v++)for(var w=d[v].x1();w.i1();w.i2())a.h3(w.i9());for(var x=0;c>x;x++)for(var y=e[x].c1();y.i1();y.i2())a.u1(y.i8());if(of.a(g,null,this._ce/this._ch),this._cf<=0)for(var z=0;z<g.length;z++)this.w5(a,d[z],e[z],new Sd(g[z].x,g[z].y),f[z]);else for(var A=0;A<g.length;A++){var B=Math.floor((g[A].x-f[A].x)/this._cf)*this._cf,C=Math.floor((g[A].y-f[A].y)/this._cf)*this._cf,D=f[A].x+B,E=f[A].y+C;this.w5(a,d[A],e[A],new Sd(D,E),f[A])}a.xi(b)}},w5:function(a,b,c,d,e){for(var f=-e.x+d.x,g=-e.y+d.y,h=b.x1();h.i1();h.i2()){var i=a.ga(h.i9());a.s4(h.i9(),new Sd(i.x+f,i.y+g))}for(var j=c.c1();j.i1();j.i2()){for(var k=j.i8(),l=new nd,m=a.gp(k).c();m.i1();m.i2()){var n=m.i6();l.add(new Sd(n.x+f,n.y+g))}a.s5(k,new Xd(l))}}});var _e=function(){};Jb.ext(_e,Ze,{i1:function(a){return this.w3(a)},i2:function(a){this.w7(a),null!=this.w2()&&this.w4(a),this.w6(a)},w7:function(a){this.e(a),this.k(a),this.i(a)},e:function(a){for(var b=a.x9();b.i1();b.i2()){var c=a.g4(b.i9());a.s1(b.i9(),c)}},w6:function(a){this.l(a),this.j(a),this.f(a)},l:function(a){for(var b=a.x9();b.i1();b.i2()){var c=a.g4(b.i9());a.s1(b.i9(),c)}},j:function(a){for(var b=a.xf();b.i1();b.i2()){var c=a.g7(b.i8()),d=c.i6();c.i8(d),d=c.i7(),c.i9(d);for(var e=0;e<c.i1();e++){var f=c.i2(e);c.i3(e,f.x,f.y)}}},k:function(a){for(var b=a.xf();b.i1();b.i2()){var c=a.g7(b.i8()),d=c.i6();c.i8(d),d=c.i7(),c.i9(d);for(var e=0;e<c.i1();e++){var f=c.i2(e);c.i3(e,f.x,f.y)}}},f:function(a){null!=this._ca&&(a.x1("A",this._ca),this._ca=null,this._b6=null),null!=this._b8&&(a.x1("B",this._b8),this._b8=null,this._b9=null)},i:function(a){this._ca=a.xc("A"),null!=this._ca&&(this._b6=new Ye(this._ca),a.x1("A",this._b6)),this._b8=a.xc("B"),null!=this._b8&&(this._b9=new Ye(this._b8),a.x1("B",this._b9))}});var af=function(){this._a=new re,this._c=10};Jb.ext(af,Ze,{i2:function(a){this._b=a.xl(),this.w9(a),this.w4(a),this.c(a),this.w8(a,this._b),a.xj(this._b)},i1:function(a){if(null==this.w2())return!0;this._b=a.xl(),this.w9(a);var b=this.w3(a);return this.c(a),a.xj(this._b),b},w8:function(a,b){for(var c=a.xf();c.i1();c.i2()){var d=c.i8();if(null!=b.i1(d)){var e=b.i1(d);of.g(a,d,e,this._c)}}},w9:function(a){for(var b=a.xk(),c=a.x9();c.i1();c.i2()){for(var d=c.i9(),e=d.af();e.i1();e.i2()){var f=e.i8(),g=f.a1(d),h=b.i1(g);if(h!==f)if(null==h)b.z1(g,f);else{null==this._b.i1(h)&&this._b.i8(h,new re);var i=this._b.i1(h);i.aa(f),this._a.ac(f),a.h1(f)}}for(var j=d.af();j.i1();j.i2()){var k=j.i8(),l=k.a1(d);b.z1(l,null)}}a.xi(b)},c:function(a){for(;!this._a.ar();a.u1(this._a.c3()));}});var bf=function(a){this._a=a};Jb.ext(bf,Object,{i2:function(a){this._a.i3(a)},i1:function(a){return this._a.i4(a)}});var cf=function(){cf.superClass.constructor.call(this),this._jo=30,this._jp=new gf,this._jt=5};Jb.ext(cf,Qe,{i4:function(a){return!0},i3:function(a){this._ju=a,of.c(a);for(var b=this._jp.i1(a),c=0,d=a.x9();d.i1();d.i2())c=Math.max(c,this.e(d.i9()));c<this._jt&&(c=this._jt),this.a(b,c)},a:function(a,b){var c=a.i7(),d=2*Math.PI/c,e=0,f=Hf.a(c);a.i4();for(var g=0;c>g;)f[g]=this.e(a.i9())+this._jo,e+=f[g],g++,a.i2();var h=e/c,i=e/(2*Math.PI);b>i&&(i=b),a.i4();for(var j=0,k=0;c>k;){var l=d/h*f[k];j+=l/2;var m=Math.cos(j)*i,n=Math.sin(j)*i;j+=l/2,this._ju.s2(a.i9(),m,n),k++,a.i2()}return i},e:function(a){var b=this._ju.gj(a),c=this._ju.g9(a);return c>=b?c:b}});var df=function(){df.superClass.constructor.call(this),this._jm=new cf,this._jk=new Xe};Jb.ext(df,Qe,{i4:function(a){return!0},i3:function(a){if(!(a.x0()<2)){this._jn=a,of.c(this._jn),of.e(this._jn);var b=new mf(this._jn);b.a1(),b.h();var c=new Le(this._jn);c.a();for(var d=b.x9();d.i1();d.i2()){var e=d.i9(),f=b.c2(e);if(f.ay()>1){var g=b.d1(e);Le.h(this._jn,g.c1()),this._jm.i3(this._jn);var h=this._jn.g3();b.s7(e,h.width,h.height)}else if(1===f.ay()){var i=f.x2();b.s8(e,this._jn.gm(i)),this._jn.s2(i,0,0)}else b.s7(e,1,1);Le.i(this._jn,this._jn.xf())}c.b();var j=this.a7(b);je.a4(b,j);var k=b.xk(),l=b.xl();this.a2(b,l,k),this.a1(b,l),this.a3(b,j,l),this._jk.a(l,k),this._jk.i3(b),this.a5(b,j,k);for(var m=b.x9();m.i1();m.i2())for(var n=m.i9(),o=b.g4(n),p=b.c2(n).x1();p.i1();p.i2()){var q=p.i9();this._jn.s2(q,o.x+this._jn.g5(q),o.y+this._jn.g6(q))}}},a7:function(a){for(var b=-1,c=null,d=a.x9();d.i1();d.i2()){var e=d.i9();a.c2(e).ay()>b&&(c=e,b=a.c2(e).ay())}return c},a1:function(a,b){for(var c=function(a,c){var d=b.i3(a)-b.i3(c);return d>0?1:d>=0?0:-1},d=a.x9();d.i1();d.i2())d.i9().av(c)},a2:function(a,b,c){for(var d=Hf.a(this._jn.x0()),e=a.x9();e.i1();e.i2())for(var f=e.i9(),g=a.c2(f),h=g.x1();h.i1();h.i2()){var i=h.i9();d[i.al()]=f.al()}var j=je.a2(a);this.a4(a,j,d,b,c)},a3:function(a,b,c){if(a.c2(b).ay()>1){for(var d=0,e=0,f=0,g=b.ap();g.i1();g.i2()){var h=g.i8(),i=c.i3(h);i-d>e&&(e=i-d,f=(d+i)/2),d=i}360-d>e&&(f=(360+d)/2),this.a6(a,b,f);for(var j=b.ap();j.i1();j.i2()){var k=j.i8(),l=c.i3(k);for(l-=f;0>l;l+=360);c.i6(k,l)}b.av(function(a,b){var d=c.i3(a)-c.i3(b);return d>0?1:d>=0?0:-1})}},a4:function(a,b,c,d,e){for(var f=b.al(),g=e.i3(b),h=b.ap();h.i1();h.i2()){for(var i=h.i8(),j=a.b(i),k=0,l=0,m=0,n=0,o=j.c1();o.i1();o.i2()){var p=o.i8(),q=null,r=null;c[p.a2().al()]===f?(q=p.a2(),r=p.a3()):(q=p.a3(),r=p.a2()),m-=this._jn.g5(q),n+=this._jn.g6(q),k-=this._jn.g5(r),l+=this._jn.g6(r)}if(0!==m||0!==n){var s;for(s=180*Math.atan2(n,m)/Math.PI-g;0>s;s+=360);d.i6(i,s)}if(0!==k&&0!==l){var t=180*Math.atan2(l,k)/Math.PI;0>t&&(t+=360),e.i6(i.a3(),t)}this.a4(a,i.a3(),c,d,e)}},a5:function(a,b,c){for(var d=a.g4(b),e=b.ap();e.i1();e.i2()){var f=e.i8(),g=f.a3(),h=a.g4(g),i=h.x-d.x,j=h.y-d.y,k=180*Math.atan2(j,i)/Math.PI;if(null!=c.i1(g)){var l=c.i3(g);k+=l}this.a6(a,g,k),this.a5(a,g,c)}},a6:function(a,b,c){c=c/180*Math.PI;var d=a.c2(b);if(!(d.ay()<=1))for(var e=d.x1();e.i1();e.i2()){var f=e.i9(),g=this._jn.g5(f),h=this._jn.g6(f),i=Math.cos(c),j=Math.sin(c),k=g*i-j*h,l=g*j+i*h;this._jn.s2(f,k,l)}}});var ef=function(){this._a=(new Date).getTime()};Jb.ext(ef,Object,{b:function(){return(new Date).getTime()-this._a}});var ff={};ff._A=new Sd(0,0),ff.b=function(a,b,c){return ff.c(a.x,a.y,b.x,b.y,c.x,c.y)},ff.c=function(a,b,c,d,e,f){c-=a,d-=b,e-=a,f-=b;var g=e*d-f*c;return Math.abs(g)<1e-5?0:g>=0?0>=g?0:-1:1},ff.d=function(a,b,c){return ff.b(a,b,c)>0},ff.f=function(a,b,c){return ff.b(a,b,c)<0},ff.g=function(a,b,c){return 0===ff.b(a,b,c)},ff.h=function(a){return ff.i(a)},ff.i=function(a){var b=new qe(a.ah()),c=new qe;if(b.a2(),b.ar())return c;var d=b.at();for(c.ae(d);!b.ar()&&d.equals(b.am());b.at());if(b.ar())return c;d=b.at();for(var e=c.ae(d),f=b.ah();f.i1();f.i2()){var g=f.i6();if(!g.equals(d))if(d=g,2===c.ay()&&ff.g(c.am(),c.as(),g))e.c(g);else{var h;for(h=e;!ff.f(c.ai(h).d(),h.d(),g);h=c.ai(h));var i;for(i=e;!ff.d(c.aj(i).d(),i.d(),g);i=c.aj(i));for(;i!==c.aj(h);c.aw(c.aj(h)));e=c.an(g,h)}}return c},ff.j=function(){return ff.k(Number.MAX_VALUE)},ff.k=function(a){return Math.floor(Ib.Util.random()*a)},ff.l=function(a,b){return Ib.Util.random()*(b-a)+a};var gf=function(){};Jb.ext(gf,Object,{i1:function(a){this._b=a;var b=new re;b=ce.a6(a),b.az(ce.a7(a));for(var c=this.a1();!b.ar();a.x5(b.c3()));return c.x1()},a1:function(){if(this._b.x0()<3)return new Je(this._b.x9());for(var a=this._b.xk(),b=this._b.xk(),c=this._b.xl(),d=new Me(this._b,new Ve,0,this.a3(this._b)),e=this._b.x0(),f=new re,g=new re,h=new Le(this._b);e>3;e--){for(var i=d.g(),j=i.an();j.i1();j.i2())a.z1(j.i9(),e),b.i5(j.i9(),!1);for(var k=i.an();k.i1();k.i2())for(var l=k.i9(),m=l.ap();m.i1();m.i2()){var n=m.i8();a.i2(n.a3())===e&&(g.aa(n),b.i5(n.a2(),!0),b.i5(n.a3(),!0))}if(g.ay()<i.ad()-1){for(var o=null,p=i.an();p.i1();p.i2()){var q=p.i9();if(a.i2(q)===e&&!b.i4(q))if(null==o)o=q;else{var r=this._b.xo(o,q);c.i7(r,!0),g.aa(r),o=null}}if(null!=o)for(var s=i.an();s.i1();s.i2()){var t=s.i9();if(t!==o&&null==t.aj(o)){var u=this._b.xo(o,t);c.i7(u,!0),g.aa(u);break}}if(g.ay()<i.ad()-1){for(var v=2147483647,w=null,x=i.an();x.i1();x.i2()){var y=x.i9();y.ad()<v&&(w=y,v=y.ad())}for(var z=i.an();z.i1();z.i2()){var A=z.i9();if(null==w.aj(A)&&w!==A){var B=this._b.xo(w,A);if(c.i7(B,!0),g.aa(B),g.ay()>=i.ad()-1)break}}}}for(var C=i.an();C.i1();C.i2())d.b(C.i9());for(var D=g.c1();D.i1();D.i2()){var E=D.i8();c.i4(E)&&(d.d(E.a2()),d.d(E.a3()))}f.az(g),h.e(i)}h.b(),d.c();for(var F=f.c1();F.i1();F.i2()){var G=F.i8();null!=G._h&&(c.i4(G)?this._b.x5(G):this._b.h1(G))}var H=this.a4(this._b),I=new Je,J=H.ak(0),K=H.ak(1),L=null;L=J.a2()===K.a2()||J.a2()===K.a3()?J.a3():J.a2(),I.aa(L);for(var M=H.c1();M.i1();M.i2()){var N=M.i8();L=N.a1(L),I.aa(L)}for(var O=f.c1();O.i1();O.i2()){var P=O.i8();c.i4(P)||null!=P._h||this._b.u1(P)}return this._b.xi(b),this._b.xj(c),this._b.xi(a),this.a2(I),I},a2:function(a){if(a.ay()<this._b.x0()){for(var b=this._b.xk(),c=a._b;null!=c;c=c.a()){var d=c.d();b.z1(d,c)}var e;for(e=new Me(this._b,new We(b),0,a.ay(),new We(b));!e.e();){for(var f=e.f(),g=f.an();g.i1();g.i2()){var h=g.i9();if(null!=b.i1(h)){var i=b.i1(h),j=a.ai(i).d(),k=null;k=null!=f.aj(j)?a.ao(f,i):a.an(f,i),b.z1(f,k);break}}for(var l=f.an();l.i1();l.i2()){var m=l.i9();null==b.i1(m)&&e.d(m)}}this._b.xi(b),e.c()}},a3:function(a){for(var b=0,c=a.x9();c.i1();c.i2())b=Math.max(b,c.i9().ad());return b},a4:function(a){for(var b=[],c=0,d=a.x0();d>c;c++)b[c]=new he;var e=new fe(b);e.a6(!1),e.a8(a);for(var f=-1,g=null,h=a.x9();h.i1();h.i2()){var i=h.i9(),j=b[i.al()];j._a+j._c>f&&(f=j._a+j._c,g=i)}for(var k=new re,l=g,m=b[l.al()]._d;null!=m;m=b[l.al()]._d)k.ac(m),l=m.a1(l);l=g;for(var n=b[l.al()]._b;null!=n;n=b[l.al()]._d)k.ae(n),l=n.a1(l);return k}});var hf=function(){this._v=new se,this._x=new se,this._z=new De(3,5),this._w=new De(3,5),this._y=!1,this._u=!1,this._t={}};Jb.ext(hf,Object,{xm:function(){var a=new Ee(this);return a},xo:function(a,b){return this.xn(a,null,b,null,0,0)},xn:function(a,b,c,d,e,f){return new ye(this,a,b,c,d,e,f)},x4:function(a){this.b3(a)},b3:function(a){for(var b;null!=(b=a._o[0]);)this.x5(b);for(;null!=(b=a._o[1]);)this.x5(b);this._v.c(a),a._g=null,this._y=!0},x5:function(a){this.a11(a)},a11:function(a){if(a._h!==this)throw"Error";var b=a.a2(),c=a.a3();this.a12(a,b,c),this._x.c(a),a._h=null,this._u=!0},x7:function(a){a._p=this._v._c,a._g=this,a.ac(),a._c.length<this._z._b&&this._z.a3(a,a._c.length,this._z._b),this._v.a(a),this._y=!0},x8:function(a){if(null!=a._h)throw"Error";a._c.length<this._w._b&&this._w.a3(a,a._c.length,this._w._b),null==a._a||a._a._h!==this?this._x.a(a):this._x.b(a,a._a),a._h=this,a.a4(),this.b2(a,a.a2(),null,a.a3(),null,0,0),this._u=!0},xr:function(a,b,c){var d=a.a2(),e=a.a3();null==a._h?(a._d=b,a._e=c):(d!==b&&(d.ar(a,0,0),a._d=b,b.ab(a,null,0,0,0)),e!==c&&(e.ar(a,1,1),a._e=c,c.ab(a,null,1,1,0)))},x3:function(a){this.xr(a,a.a3(),a.a2())},h1:function(a){this.a11(a)},u1:function(a){this.x8(a)},h2:function(a){this.x4(a)},h3:function(a){this.x7(a)},xa:function(){return this._v._c},x0:function(){return this._v._c},xh:function(){return this._x._c},xg:function(){return this._x._c},xb:function(){return 0===this._v._c},xq:function(a){return a._g===this},xp:function(a){return a._h===this},xd:function(){return this._v._a},x9:function(){return new Ie(this._v)},xf:function(){return new Ie(this._x)},x2:function(a,b){var c=Hf.d(this.xh());if(null!=a&&null!=b)for(var d=this.x9();d.i1();d.i2())d.i9().at(a,1,c),d.i9().at(b,0,c);else if(null==b&&null!=a)for(var e=this.x9();e.i1();e.i2())e.i9().at(a,1,c);else if(null!=b&&null==a)for(var f=this.x9();f.i1();f.i2())f.i9().at(b,0,c)},xk:function(){return this._z.b(this._v)},xl:function(){return this._w.c(this._x)},xi:function(a){this._z.a5(a,this._v)},xj:function(a){this._w.a6(a,this._x)},xc:function(a){return this._t[a]},x1:function(a,b){this._t[a]=b},x6:function(a){delete this._t[a]},b2:function(a,b,c,d,e,f,g){b.ab(a,c,0,0,f),d.ab(a,e,1,1,g)},a12:function(a,b,c){b.ar(a,0,0),c.ar(a,1,1)},c:function(){for(var a=0,b=this.x9();b.i1();b.i2())b.i9()._p=a++;this._y=!1},b1:function(){for(var a=0,b=this.xf();b.i1();b.i2())b.i8()._g=a++;this._u=!1},xs:function(a){a.as(this,this._z._b),a._p=this._v._c,this._v.a(a)},xt:function(a,b,c,d,e,f,g){a.a6(this,b,d,this._w._b),a._g=this._x._c,this._x.a(a),this.b2(a,a.a2(),c,a.a3(),e,f,g)}});var jf=function(){jf.superClass.constructor.call(this)};Jb.ext(jf,hf,{gb:function(a){return this.g1(a)},g7:function(a){return this.g2(a)},g5:function(a){var b=this.g1(a);return b.i1()+b.i3()/2},g6:function(a){var b=this.g1(a);return b.i2()+b.i4()/2},g4:function(a){return new Sd(this.g5(a),this.g6(a))},gi:function(a){return this.g1(a).i1()},gh:function(a){return this.g1(a).i2()},ga:function(a){var b=this.g1(a);return new Sd(b.i1(),b.i2())},gj:function(a){return this.g1(a).i3()},g9:function(a){return this.g1(a).i4()},gm:function(a){return new Td(this.gj(a),this.g9(a))},s1:function(a,b){this.s2(a,b.x,b.y)},s2:function(a,b,c){var d=this.g1(a);d.i5(b-d.i3()/2,c-d.i4()/2)},s7:function(a,b,c){this.g1(a).i6(b,c)},s8:function(a,b){this.s7(a,b.width,b.height)},s3:function(a,b,c){this.g1(a).i5(b,c)},s4:function(a,b){this.s3(a,b.x,b.y)},gp:function(a){for(var b=this.g2(a),c=new nd,d=0;d<b.i1();d++)c.add(b.i2(d));return new Xd(c)},gf:function(a){for(var b=this.g2(a),c=new qe,d=0;d<b.i1();d++)c.aa(b.i2(d));return c},gc:function(a){var b=new nd;b.add(this.gs(a));for(var c=this.gp(a).d();c.i1();c.i2())b.add(c.i6());return b.add(this.gl(a)),new Xd(b)},gd:function(a){var b=new qe;b.aa(this.gs(a));for(var c=this.gp(a).d();c.i1();c.i2())b.aa(c.i6());return b.aa(this.gl(a)),b},m1:function(a,b){var c=this.g2(a);c.i5();var d=b.ah(),e=d.i6();this.gx(a,e);var f=b.as();for(d.i2();d.i6()!==f;d.i2()){var g=d.i6();c.i4(g.x,g.y)}this.gy(a,f)},s5:function(a,b){var c=this.g2(a);c.i5();for(var d=b.d();d.i1();d.i2()){var e=d.i6();c.i4(e.x,e.y)}},s6:function(a,b){var c=this.g2(a);c.i5();for(var d=b.ah();d.i1();d.i2()){var e=d.i6();c.i4(e.x,e.y)}},m2:function(a,b,c){this.gx(a,b),this.gy(a,c)},gn:function(a){return this.g2(a).i6()},gk:function(a){return this.g2(a).i7()},gt:function(a,b){this.g2(a).i8(b)},gz:function(a,b){this.g2(a).i9(b)},gs:function(a){var b=this.g2(a).i6();if(null==b)return this.g4(a.a2());var c=new Sd(this.g5(a.a2())+b.x,this.g6(a.a2())+b.y);return c},gl:function(a){var b=this.g2(a).i7();if(null==b)return this.g4(a.a3());var c=new Sd(this.g5(a.a3())+b.x,this.g6(a.a3())+b.y);return c},gx:function(a,b){var c=new Sd(b.x-this.g5(a.a2()),b.y-this.g6(a.a2()));this.g2(a).i8(c)},gy:function(a,b){var c=new Sd(b.x-this.g5(a.a3()),b.y-this.g6(a.a3()));this.g2(a).i9(c)},g8:function(){for(var a=new re,b=this.xf();b.i1();b.i2())a.aa(b.i8());return a},g3:function(){for(var a,b,c=a=Number.MAX_VALUE,d=b=Number.MIN_VALUE,e=this.x9();e.i1();e.i2()){var f=this.ga(e.i9()),g=this.gm(e.i9());c=Math.min(f.x,c),a=Math.min(f.y,a),d=Math.max(f.x+g.width,d),b=Math.max(f.y+g.height,b)}for(var h=this.xf();h.i1();h.i2())for(var i=this.gp(h.i8()).c();i.i1();i.i2()){var j=i.i6();c=Math.min(j.x,c),a=Math.min(j.y,a),d=Math.max(j.x,d),b=Math.max(j.y,b)}return{x:Math.floor(c),y:Math.floor(a),width:Math.floor(d-c),height:Math.floor(b-a)}}});var kf=function(){kf.superClass.constructor.call(this),this.a(new be,new _d)};Jb.ext(kf,jf,{a:function(a,b){this._a3=a,this._a4=b},xo:function(a,b){return this.l2(a,b,this._a4.a6())},l2:function(a,b,c){return this.l1(a,null,b,null,0,0,c)},xn:function(a,b,c,d,e,f){return this.l1(a,b,c,d,e,f,this._a4.a6())},l1:function(a,b,c,d,e,f,g){var h=new ye(this,a,b,c,d,e,f);return h._l=g,h},xm:function(){var a=new Ee(this);return a._r=this._a3.m3(),a},g3:function(){for(var a={x:0,y:0,width:-1,height:-1},b=this.x9();b.i1();b.i2())b.i9()._r.m1(a);return a},g1:function(a){return a._r},g2:function(a){return a._l},g5:function(a){return a._r.m4()},g6:function(a){return a._r.m5()},gi:function(a){return a._r.i1()},gh:function(a){return a._r.i2()},gj:function(a){return a._r.i3()},g9:function(a){return a._r.i4()},s2:function(a,b,c){a._r.m6(b,c)},s7:function(a,b,c){a._r.i6(b,c)},s3:function(a,b,c){a._r.i5(b,c)}});var lf=function(){lf.superClass.constructor.call(this),this._ap=this.xk(),this._as=this.xl()};Jb.ext(lf,jf,{g1:function(a){var b=this._ap.i1(a);return null==b&&(b=new Be,this._ap.z1(a,b)),b},g2:function(a){var b=this._as.i1(a);return null==b&&(b=new Ae,this._as.i8(a,b)),b}});var mf=function(a){mf.superClass.constructor.call(this),this._ay=a,this._a0=this.xk(),this._au=this.xl()};Jb.ext(mf,lf,{c2:function(a){var b=this._a0.i1(a);return b},a2:function(a,b){this._a0.z1(a,b)},h:function(){null==this._az&&(this._az=this.xk());for(var a=Hf.a(this._ay.x0()+1),b=1,c=this.x9();c.i1();){for(var d=this.c2(c.i9()),e=d.x1();e.i1();e.i2()){var f=e.i9();a[f.al()]=b}for(var g=new re,h=d.x1();h.i1();h.i2())for(var i=h.i9(),j=a[i.al()],k=i.ap();k.i1();k.i2()){var l=k.i8(),m=l.a3(),n=a[m.al()];n===j&&g.ac(l)}this._az.z1(c.i9(),g),c.i2(),b++}},d1:function(a){return this._az.i1(a)},b:function(a){return this._au.i1(a)},a3:function(a,b){this._au.i8(a,b)},a1:function(){var a=this._ay.xk(),b=Ne.a4(Hf.a(this._ay.xh())),c=ce.a1(this._ay,b,a),d=ce.a5(this._ay,b,c);this.d2(a,d),this._ay.xi(a)},c1:function(a){for(var b=null,c=-1,d=0,e=a.length;e>d;d++){var f=a[d];f.ay()>c&&(b=f,c=f.ay())}return b},d2:function(a,b){for(var c=this._ay.xl(),d=this._ay.xk(),e=b.length,f=0;e>f;f++)for(var g=b[f],h=g.c1();h.i1();h.i2())c.i8(h.i8(),g);var i=this.c1(b);this.a4(i,a,c,new nd,d);var j={};e=b.length;for(var k=0;e>k;k++){var l=b[k];if(l.ay()>1){var m=this.xm();j[l._id]=m}}for(var n=this._ay.x9();n.i1();n.i2()){var o=n.i9();if(a.i4(o)&&null==d.i1(o)){var p=this.xm();j[o._id]=p;var q=new Je;q.aa(o),this.a2(p,q)}}var r=Hf.d(2);e=b.length;for(var s=0;e>s;s++){var t=b[s];if(1===t.ay()){var u=t.c2();r[0]=u.a2(),r[1]=u.a3();for(var v=0;2>v;v++){var w=r[v];if(1===w.ad()){var x=this.xm();j[w._id]=x;var y=new Je;y.aa(w),this.a2(x,y)}}}}for(var z=this._ay.x9();z.i1();z.i2()){var A=z.i9();if(null!=d.i1(A))for(var B=d.i1(A),C=j[B._id],D=A.af();D.i1();D.i2()){var E=D.i8();if(c.i1(E)!==B){var F=j[c.i1(E)._id];if(null==F){var G=E.a1(A),H=d.i1(G);F=null!=H?j[H._id]:j[G._id]}var I=C.aj(F),J=null;null==I?(I=this.xo(C,F),J=new re):J=this.b(I),J.aa(E),this.a3(I,J)}}else if(a.i4(A))for(var K=j[A._id],L=A.af();L.i1();L.i2()){var M=L.i8(),N=M.a1(A),O=j[N._id];if(null!=O){var P=K.aj(O);if(null==P){var Q=this.xo(K,O),R=new re;R.aa(M),this.a3(Q,R)}}}}if(2===this._ay.x0()&&1===this._ay.xg()){var S=this._ay.xf().i8(),T=j[S.a2()._id],U=j[S.a3()._id];if(null!=U&&null!=T&&null==U.aj(T)){var V=this.xo(T,U),W=new re;W.aa(S),this.a3(V,W)}}var X=Hf.a(this._ay.x0()),Y=1;e=b.length;for(var Z=0;e>Z;Z++){var $=b[Z],_=j[$._id];if(null!=_){var aa=this.c2(_);null==aa&&(aa=new Je,this.a2(_,aa));for(var ba=$.c1();ba.i1();ba.i2()){var ca=ba.i8(),da=ca.a2();X[da.al()]===Y||a.i4(da)&&d.i1(da)!==$||(X[da.al()]=Y,aa.aa(da)),da=ca.a3(),X[da.al()]===Y||a.i4(da)&&d.i1(da)!==$||(X[da.al()]=Y,aa.aa(da))}}}this._ay.xj(c),this._ay.xi(d)},a4:function(a,b,c,d,e){if(!d.contains(a)){d.add(a);for(var f=[],g=a.c1();g.i1();g.i2()){var h=g.i8();f[0]=h.a2(),f[1]=h.a3();for(var i=0;2>i;i++){var j=f[i];if(b.i4(j)&&null==e.i1(j)){a.ay()>1&&e.z1(j,a);for(var k=j.af();k.i1();k.i2()){var l=c.i1(k.i8());this.a4(l,b,c,d,e)}}}}}}});var nf=function(a,b,c,d,e){this._a={},nf.superClass.constructor.call(this);var f,g,h=new nd;for(f=0,g=b.size();g>f;f++){var i=b.get(f);if(i instanceof Ib.Link)h.add(i);else{var j=d&&null==e&&i instanceof Nd;j&&i.setExpanded(!0);var k=a.getDimension(i);if(j&&i.setExpanded(!1),null==k)continue;var l=this.xm(),m=a._repulsion;"rightleft"===c||"leftright"===c?this.s7(l,k.height*m,k.width*m):this.s7(l,k.width*m,k.height*m),l.node=i,this._a[i.getId()]=l}}for(f=0,g=h.size();g>f;f++){var n=h.get(f),o=n.getFromAgent(),p=n.getToAgent(),q=this._a[o.getId()],r=this._a[p.getId()];null!=q&&null!=r&&q!==r&&this.xo(q,r)}};Jb.ext(nf,kf,{});var of={};of._D=new Xd,of._E=new Sd(0,0),of.b=function(a){if(a.i1()>0){for(var b=new nd,c=a.i1()-1;c>=0;c--)b.add(a.i2(c));a.i5();for(var d=0,e=b.size();e>d;d++){var f=b.get(d);a.i4(f.x,f.y)}}var g=a.i6();a.i8(a.i7()),a.i9(g)},of.c=function(a){of.d(a,!0)},of.d=function(a,b){if(b)for(var c=a.xf();c.i1();c.i2()){var d=c.i8();a.gt(d,of._E),a.gz(d,of._E),a.s5(d,of._D)}else for(var e=a.xf();e.i1();e.i2())a.s5(e.i8(),of._D)},of.e=function(a){for(var b=new Sd(0,0),c=a.xf();c.i1();c.i2()){var d=c.i8();a.gt(d,b),a.gz(d,b)}},of.f=function(a,b,c,d){for(var e=a.gc(b).b(),f=Hf.d(e),g=0,h=a.gc(b).c();h.i1();h.i2()){var i=h.i6();(0>=g||!i.equals(f[g-1]))&&(f[g]=new Sd(i.x,i.y),g++)}if(e=g,!(2>e)){var j=new nd,k=new Ud(f[1].x-f[0].x,f[1].y-f[0].y),l=of.i(k);l.x*=d,l.y*=d;for(var m=of.h(f[0],l),n=of.h(f[1],l),o=new Wd(m,n),p=1;e-1>p;p++){var q=o,r=of.i(new Ud(f[p+1].x-f[p].x,f[p+1].y-f[p].y));r.x*=d,r.y*=d;var s=of.h(f[p],r),t=of.h(f[p+1],r);o=new Wd(s,t);var u=Wd.a6(q,o);null!=u&&j.add(new Sd(u.x,u.y))}var v=new Ud(f[e-1].x-f[e-2].x,f[e-1].y-f[e-2].y);v=of.i(v),v.x*=d,v.y*=d;var w=of.h(f[e-1],v),x=new Xd(j);b.a2()===c.a2()?(a.s5(c,x),a.m2(c,m,w)):(a.s5(c,x.a()),a.m2(c,w,m))}},of.g=function(a,b,c,d){for(var e=d,f=c.c1();f.i1();f.i2()){var g=f.i8();of.f(a,b,g,e),0>e&&(e-=d),e=-e}},of.a=function(a,b,c){return of.j(a,b,c,1)},of.l=function(a,b,c){if(null==a||a.length<1)return null!=b&&(b.x=0,b.y=0,b.width=0,b.height=0),{width:0,height:0};for(var d=0,e=0,f=0;f<a.length;f++){var g=a[f];d=Math.max(d,g.width),e=Math.max(e,g.height)}var h,i,j=d*e*a.length,k=Math.sqrt(j/c),l=j/k,m=Math.floor(l/d),n=Math.ceil(l/d),o=Math.ceil(a.length/m),p=Math.ceil(a.length/n);n*p>m*o?(h=m,i=o):(h=n,i=p);var q,r=0,s=0,t=0,u=0;if(d>e)for(var v=0;v<a.length;v++)q=a[v],q.x=s*d,q.y=r*e,t=Math.max(t,q.x+q.width),u=Math.max(u,q.y+q.height),++s>=h&&(r++,s=0);else for(var w=0;w<a.length;w++)q=a[w],q.x=s*d,q.y=r*e,t=Math.max(t,q.x+q.width),u=Math.max(u,q.y+q.height),++r>=i&&(s++,r=0);return null!=b&&(b.x=0,b.y=0,b.width=t,b.height=u),{width:i,height:h}},of.j=function(a,b,c,d){if(null==a||a.length<1)return null!=b&&(b.x=0,b.y=0,b.width=0,b.height=0),0;for(var e,f,g=e=a[0].width,h=f=a[0].height,i=a.length,j=1;i>j;j++){var k=a[j].width;g=Math.min(g,k),e=Math.max(e,k);var l=a[j].height;h=Math.min(h,l),f=Math.max(f,l)}if(h/f>.95&&g/e>.95)return of.l(a,b,c).width;for(var m=new qe,n=0,o=0;i>o;o++){var p=a[o];m.aa(a[o]),n=Math.floor(n+p.width*p.height)}m.a1(function(a,b){var c=Math.floor(b.height)-Math.floor(a.height);return 0===c?Math.floor(b.width)-Math.floor(a.width):c});var q=0,r=0,s=Math.floor(c*Math.sqrt(n/c)),t=s,u=0,v=new qe;do{var w=new qe;v.aa(w);for(var x,y,z=x=y=0,A=m.ah();A.i1();A.i2()){var B=A.i6();z+B.width>t&&w.ay()>0?(y=Math.max(y,z),w=new qe,w.aa(B),v.aa(w),z=Math.floor(B.width)):(w.aa(B),z=Math.floor(z+B.width)),1===w.ay()&&(x=Math.floor(x+w.am().height))}y=Math.max(y,z),c*x>y&&u!==y&&(v.af(),t=Math.floor(1.1*t),u=y)}while(v.ar());for(var C=0,D=v.ah();D.i1();D.i2()){for(var E=0,F=D.i6(),G=F.ah();G.i1();G.i2()){var H=G.i6();H.x=E,H.y=C,E+=H.width}q=Math.max(q,E),C+=of.k(F),r=Math.max(r,C)}return null!=b&&(b.x=0,b.y=0,b.width=q,b.height=r),v.ay()},of.k=function(a){for(var b=0,c=a.ah();c.i1();c.i2())b=Math.max(c.i6().height,b);return b},of.h=function(a,b){return new Sd(a.x+b.x,a.y+b.y)},of.i=function(a){var b=Math.sqrt(a.x*a.x+a.y*a.y);return new Ud(-a.y/b,a.x/b)};var pf=function(a){this._a=a,this._b=!1};Jb.ext(pf,Object,{a:function(){return this._b},b:function(){return this._a},c:function(){return 1===this._a},d:function(){return 2===this._a},e:function(){return 4===this._a},f:function(){return 8===this._a},g:function(){return 0===this._a}}),pf.h=function(a,b){var c=a.xc("A");return null==c?null:c.i1(b)},pf.i=function(a,b){var c=a.xc("B");return null==c?null:c.i1(b)},pf.j=function(a){switch(a){case 1:return pf.k;case 2:return pf.l}return null},pf.k=new pf(1),pf.l=new pf(2);var qf=function(a,b,c,d,e){this._o=0,this._l=0,this._i=0,this._d=0,this._f=0,this._b=a,this._a=1e-4,this._r=b,this._p=1,this._e=(e.gj(a)+e.g9(a))/4;var f=.45*c*Math.sqrt(d);this._k=ff.l(-f,f),this._h=ff.l(-f,f),this._g=ff.l(-f,f)};Jb.ext(qf,Object,{});var rf=function(){this._a=0,this._c=0,this._b=0};Jb.ext(rf,Object,{});var sf=function(){sf.superClass.constructor.call(this),this._dj=0,this._dh=0,this._dq=0,this._dp=0,this._dt=0,this._de=0,this._d3=0,this._dr=0,this._ed=0,this._dw=.65,this._ea=1,this._dl=80,this._dx=3,this._d8=!0,this._eb=3e5,this._ee=2,this._di=2,this._df=1e3};Jb.ext(sf,Qe,{i4:function(a){return!0},i3:function(a){if(null!=a&&(this._d5=a,this.s(a))){var b=new rf,c=0,d=Math.floor(this._dx*this._dz.length*this._dz.length+20*this._dz.length);d=Math.max(d,1e4);var e=this._ea*this._ea*this._dz.length,f=this._df;try{for(;this._dj>e&&d>c;c++){var g=this.b(2147483647&c);0===f--&&(this._dy.b()>this._eb&&(c=d),f=this._df),this.h(g,b),this.d(g,b),this.i(g,b),this._d8?(this.g(g,b),this.j(g,b)):(this.f(g,b),this.c(g,b));var h=Math.sqrt(b._a*b._a+b._c*b._c+b._b*b._b);this.ac(g,b,h),this.aa(g,b,h)}}catch(i){}finally{this.r()}}},s:function(a){if(null==a||a.xa()<1)return!1;this._d5=a,this._dp=1,this._dy=new ef,this._dt=a.x0(),this._d2=Hf.d(this._dt),this._df=1+1e5/this._dt,this._ed=1/(2*this._di),this._de=this._ed*this._ee/(.05*this._dl),this._d3=Math.pow(this._dl,-1)*this._ed,this._dr=Math.pow(this._dl,3)*this._ed,this._dj=0,this._du=new rf,this._dq=Math.max(20*this._dl,10);var b=Math.max(.1,Math.min(this._dw*this._dl,this._dq)),c=this._dt;of.c(a),this._dz=Hf.d(c);for(var d=a.x9();d.i1();d.i2()){var e=d.i9(),f=new qf(e,b,this._dl,this._dt,a);this._dz[--c]=f,this._dj+=f._r,this._dh+=f._r*f._r,this._du._a+=f._k,this._du._c+=f._h,this._du._b+=f._g,this._d2[e.al()]=f}return this._d8=!1,this._dz.length>0},b:function(a){var b=this._dz.length,c=b-a%b-1,d=ff.k(c+1),e=this._dz[d];return this._dz[d]=this._dz[c],this._dz[c]=e,e},f:function(a,b){for(var c,d,e=c=d=0,f=a._b.ae();null!=f;f=f.a7()){var g,h=this._d2[f.a2().al()],i=h._k-a._k,j=h._h-a._h,k=h._g-a._g,l=i*i+j*j+k*k,m=Math.sqrt(l),n=m-(h._e+a._e);0>=n||(g=n*n*this._d3/m,e+=i*g,c+=j*g,d+=k*g)}for(var o=a._b.ag();null!=o;o=o.a8()){var p,q=this._d2[o.a3().al()],r=q._k-a._k,s=q._h-a._h,t=q._g-a._g,u=r*r+s*s+t*t,v=Math.sqrt(u),w=v-(q._e+a._e);0>=w||(p=w*w*this._d3/v,e+=r*p,c+=s*p,d+=t*p)}b._a+=e,b._c+=c,b._b+=d},g:function(a,b){var c,d,e=c=d=0;this._dp++,a._f=this._dp;for(var f=a._b.ae();null!=f;f=f.a7()){var g=this._d2[f.a2().al()];g._f=this._dp;var h=g._k-a._k,i=g._h-a._h,j=g._g-a._g,k=h*h+i*i+j*j,l=Math.sqrt(k);if(0!==l){var m=Math.max(1e-6,l-(a._e+g._e)),n=-this._ef[f.a5()]/(m*m);n+=m*m*this._d1[f.a5()],n/=l,e+=h*n,c+=i*n,d+=j*n}}for(var o=a._b.ag();null!=o;o=o.a8()){var p=this._d2[o.a3().al()];p._f=this._dp;var q=p._k-a._k,r=p._h-a._h,s=p._g-a._g,t=q*q+r*r+s*s,u=Math.sqrt(t);if(0!==u){var v=Math.max(1e-6,u-(a._e+p._e)),w=-this._ef[o.a5()]/(v*v);w+=v*v*this._d1[o.a5()],w/=u,e+=q*w,c+=r*w,d+=s*w}}b._a+=e,b._c+=c,b._b+=d},j:function(a,b){for(var c,d,e=c=d=0,f=this._dt-1;f>=0;f--){var g=this._d2[f];if(g._f!==a._f){var h=a._k-g._k,i=a._h-g._h,j=a._g-g._g,k=h*h+i*i+j*j;if(0!==k){var l=Math.sqrt(k),m=Math.max(1e-6,l-(a._e+g._e)),n=this._dr/(m*m*l);e+=h*n,c+=i*n,d+=j*n}}}b._a+=e,b._c+=c,b._b+=d},c:function(a,b){for(var c,d,e=c=d=0,f=this._dt-1;f>=0;f--){var g=this._d2[f],h=a._k-g._k,i=a._h-g._h,j=a._g-g._g,k=h*h+i*i+j*j;if(0!==k){var l,m=Math.sqrt(k),n=m-(a._e+g._e);l=0>=n?this._dr/(1e-8*m):this._dr/(n*n*m),e+=h*l,c+=i*l,d+=j*l}}b._a+=e,b._c+=c,b._b+=d},i:function(a,b){var c=this._du._b/this._dt-a._g;b._b+=c*this._dl*this._dt/this._dh},d:function(a,b){if(0!==this._de){var c=this._du._a/this._dt-a._k,d=this._du._c/this._dt-a._h,e=this._du._b/this._dt-a._g;b._a+=c*this._de,b._c+=d*this._de,b._b+=e*this._de}},h:function(a,b){var c=.05*(a._r+2);c>0&&(b._a=ff.l(-c,c),b._c=ff.l(-c,c),b._b=ff.l(-c,c))},ac:function(a,b,c){if(0!==c&&0!==a._a){var d=b._a*a._o+b._c*a._l+b._b*a._i,e=d/(c*a._a);this._dh-=a._r*a._r,this._dj-=a._r,a._r+=a._p*e>0?.45*e:.15*e,a._r>this._dq?a._r=this._dq:a._r<.1&&(a._r=.1),this._dj+=a._r,this._dh+=a._r*a._r,a._p=e}},aa:function(a,b,c){if(c>0){var d=a._r/c,e=b._a*d,f=b._c*d,g=b._b*d;a._k+=e,a._h+=f,a._g+=g,this._du._a+=e,this._du._c+=f,this._du._b+=g,a._a=c,a._o=b._a,a._l=b._c,a._i=b._b}},r:function(){for(var a=this._d2.length-1;a>=0;a--){var b=this._d2[a];this._d5.s2(b._b,b._k,b._h)}}});var tf=function(a,b,c,d){this._e=a,this._f=b,this._a=c,this._b=d,this._c={}};Jb.ext(tf,Object,{resetGroup:function(){if(this._a&&null==this._b)for(var a in this._c){var b=this._c[a];b.group.setExpanded(this._e.isExpandGroup()?!0:b.b)}},process:function(){for(var a=new nd,b=0,c=this._f.size();c>b;b++){var d=this._f.get(b);if(d instanceof Ib.Link)d.isLooped()||a.add(d);else{if(null==this._b&&d.getParent()instanceof Nd)continue;
(null==this._b||null!=this._b&&this._b!==d)&&a.add(d),null==this._b&&d instanceof Nd&&this.layoutGroup(d)}}return a},layoutGroup:function(a){if(this._a&&null==this._c[a.getId()]&&null==this._b){this._c[a.getId()]={group:a,b:a.isExpanded()};var b=this._e.getGroupLayoutType(a);if(b){a.setExpanded(!0);for(var c,d=new nd,e=a.getChildren(),f=0,g=e.size();g>f;f++)if(c=e.get(f),c instanceof Nd&&(this.layoutGroup(c),c.setExpanded(!1)),c instanceof Ib.Link||d.contains(c)||d.add(c),c instanceof Ld){var h=c.getLinks();if(null!=h)for(var i=0,j=h.size();j>i;i++){var k=h.get(i);d.contains(k)||d.add(k)}}var l=new nf(this._e,d,b,this._a,this._b);try{var m=null;if("round"===b?m=new df:"symmetry"===b?m=new sf:"hierarchic"===b?m=new Cf:("topbottom"===b||"bottomtop"===b||"rightleft"===b||"leftright"===b)&&(m=new Re),null!=m){m.i2(l);var n=tf.createMatrix(b),o={},p={};for(var q in l._a){var r=l._a[q],s=r.node,t=l.g4(r);if(o[q]=s.getCenterLocation(),null!=n){var u=n.transform(t);s.setCenterLocation(u.x,u.y)}else s.setCenterLocation(t.x,t.y);p[q]=s.getCenterLocation()}}}catch(v){}for(e=a.getChildren(),f=0,g=e.size();g>f;f++)c=e.get(f),c instanceof Nd&&c.setExpanded(!0)}}}}),tf.createMatrix=function(a){return"rightleft"===a?Tb.createMatrix(Math.PI/2,0,0):"leftright"===a?Tb.createMatrix(-Math.PI/2,0,0):"bottomtop"===a?Tb.createMatrix(Math.PI,0,0):null};var uf=function(){};Jb.ext(uf,Object,{i1:function(a,b,c){var d=this.a1(a,b);return this.a2(a,b,c),d},a1:function(a,b){var c=uf.i4(a);c.ax();for(var d=0,e=c.x1();e.i1();e.i2())b.i7(e.i9(),-1);for(var f=c.x1();f.i1();f.i2()){for(var g=f.i9(),h=-1,i=g.aq();i.i1();i.i2())h=Math.max(h,b.i2(i.i9()));b.i7(g,h+1),d=Math.max(d,h+1)}return d+1},a2:function(a,b,c){c.az(uf.i3(a,b))}}),uf.i3=function(a,b){for(var c=new re,d=a.xf();d.i1();d.i2()){var e=d.i8();b.i2(e.a2())>b.i2(e.a3())&&(a.x3(e),c.ac(e))}return c},uf.i4=function(a){var b=Hf.a(a.xa());return(new ie).a1(a,b),uf.i2(a,b)},uf.i2=function(a,b){for(var c=Hf.d(a.x0()),d=a.x9();d.i1();d.i2()){var e=d.i9(),f=e.al();c[b[f]]=e}return new Je(c)};var vf=function(){vf.superClass.constructor.call(this),this.c0()};Jb.ext(vf,re,{c0:function(){this._bc=1,this._bd=0}});var wf=function(){this._m1=20,this._m2=60,this._m3=5,this._m4=0};Jb.ext(wf,Object,{i4:function(a){this._m3=a},i5:function(a){this._m4=a},i3:function(a){this._m1=a},i6:function(a){this._m2=a},i2:function(a){this._m5=a},t1:function(){return this._m2},a1:function(a,b){for(var c=Hf.d(b.length),d=0;d<b.length;d++)c[d]=b[d].x1();this.a2(a,c)},a2:function(a,b){for(var c=Hf.a(b.length),d=0,e=0;e<b.length;e++){var f=0,g=b[e];for(g.i4();g.i1();g.i2())f=Math.max(f,a.g9(g.i9()));for(c[e]=f,g.i4();g.i1();g.i2()){var h=(c[e]-a.g9(g.i9()))/2;a.s4(g.i9(),new Sd(a.gi(g.i9()),d+h))}var i=this.t1();d+=c[e]+i,g.i4()}},i1:function(a,b,c){this._m6=a,this.t2(b,c)}});var xf=function(a,b){xf.superClass.constructor.call(this)};Jb.ext(xf,wf,{t2:function(a,b){var c=this._m6;this._a=c.xc("D"),this._h=c.xc("C"),this.a1(c,a),this.tg(c,a),this.tf(a,Ne.a5(this._e),this._m5,this._l),this.tb(c,this._f[0]),this.ta(a),this.th(c,this._f[0],a),this.b(a),this.tb(c,this._f[1]),this.ta(a),this.th(c,this._f[1],a),this.b(a),this.a11(this._f[1]),this.a12(a),this.tb(c,this._f[2]),this.ta(a),this.th(c,this._f[2],a),this.b(a),this.tb(c,this._f[3]),this.ta(a),this.th(c,this._f[3],a),this.b(a),this.a11(this._f[3]),this.a12(a),this.tc(c),this.tj()},a11:function(a){for(var b=0;b<a.length;b++)a[b]=-a[b]},b:function(a){for(var b=0;b<a.length;b++){var c=a[b];c.ax()}for(var d=0;d<a.length;d++)for(var e=0,f=null,g=a[d].x1();g.i1();g.i2()){var h=g.i9(),i=h.al();this._l[i]=e++,this._b[i]=f,this._k[i]=null,null!=f&&(this._k[f.al()]=h),f=h}var j=this._a;this._a=this._h,this._h=j;for(var k=this._m6.xf();k.i1();k.i2()){var l=k.i8(),m=this._m6.gn(l);this._m6.gt(l,new Sd(-m.x,m.y));var n=this._m6.gk(l);this._m6.gz(l,new Sd(-n.x,n.y))}var o=this._l,p=function(a,b){return null==a&&null!=b?1:null!=a&&null==b?-1:null==a&&null==b?0:o[a.a2().al()]-o[b.a2().al()]},q=function(a,b){return null==a&&null!=b?1:null!=a&&null==b?-1:null==a&&null==b?0:o[a.a3().al()]-o[b.a3().al()]};this._m6.x2(p,q)},a12:function(a){for(var b=this._m6.xf();b.i1();b.i2()){var c=b.i8();this._m6.x3(c);var d=this._m6.gn(c),e=this._m6.gk(c);this._m6.gz(c,d),this._m6.gt(c,e)}for(var f=new qe,g=0;g<a.length;g++)f.ae(a[g]);for(var h=0;h<a.length;h++)a[h]=f.au();var i=this._l,j=function(a,b){return null==a&&null!=b?1:null!=a&&null==b?-1:null==a&&null==b?0:i[a.a2().al()]-i[b.a2().al()]},k=function(a,b){return null==a&&null!=b?1:null!=a&&null==b?-1:null==a&&null==b?0:i[a.a3().al()]-i[b.a3().al()]};this._m6.x2(j,k)},tg:function(a,b){var c=a.x0(),d=a.xg();this._l=Hf.a(c),this._b=Hf.d(c),this._k=Hf.d(c),this._m=Hf.d(c),this._i=Hf.d(c),this._o=Hf.d(c),this._f=Hf.e(4,c),this._c=Hf.a(c),this._g=Hf.a(c),this._j=Hf.a(c),this._d=Hf.b(c),this._e=Hf.b(d);for(var e=0;e<b.length;e++)for(var f=0,g=null,h=b[e].x1();h.i1();h.i2()){var i=h.i9(),j=i.al();this._l[j]=f++,this._b[j]=g,this._k[j]=null,null!=g&&(this._k[g.al()]=i),g=i}var k=this._l,l=function(a,b){return null==a&&null!=b?1:null!=a&&null==b?-1:null==a&&null==b?0:k[a.a2().al()]-k[b.a2().al()]},m=function(a,b){return null==a&&null!=b?1:null!=a&&null==b?-1:null==a&&null==b?0:k[a.a3().al()]-k[b.a3().al()]};a.x2(l,m)},tb:function(a,b){for(var c=a.x9();c.i1();c.i2()){var d=c.i9(),e=d.al();this._m[e]=d,this._i[e]=d,b[e]=Number.MAX_VALUE,this._o[e]=d,this._c[e]=Number.MAX_VALUE,this._d[e]=!1,this._j[e]=this._g[e]=0}},ta:function(a){for(var b=1;b<a.length;b++)for(var c=-1,d=a[b]._b;null!=d;d=d.a()){var e=d.d(),f=e.al(),g=e.ak();if(0!==g){var h,i=Math.floor((g+1)/2),j=Math.ceil((g+1)/2),k=1;for(h=e.ae();i>k;h=h.a7())k++;for(var l=!1;j>=k&&!l;k++){var m=this._m6.g2(h),n=h.a2(),o=n.al();this._i[f]===e&&!this._e[h.a5()]&&c<this._l[o]&&(c=this._l[o],this._i[o]=e,this._m[f]=this._m[o],this._i[f]=this._m[f],l=!0,this._j[o]=m.i6().x,this._g[f]=m.i7().x),h=h.a7()}}}},th:function(a,b,c){for(var d=a.x9();d.i1();d.i2()){var e=d.i9(),f=e.al();this._m[f]===e&&this.td(a,e,b)}for(var g=0;g<c.length;g++){var h=c[g].x1();if(h.i1()){var i=c[g].x1().i9(),j=i.al();this._o[this._m[j].al()]===i&&this.tk(a,i,b)}}for(var k=a.x9();k.i1();k.i2()){var l=k.i9(),m=l.al(),n=this._c[this._o[this._m[m].al()].al()];n<Number.MAX_VALUE&&(b[m]+=n)}},td:function(a,b,c){var d=b.al();if(c[d]===Number.MAX_VALUE){c[d]=0;var e=b,f=0;do{var g=e.al();if(g!==d&&(f-=this._g[g]),this._l[g]>0){var h=this._b[g],i=this._m[this._b[g].al()],j=i.al();this.td(a,i,c),this._o[d]===b&&(this._o[d]=this._o[j]),this._o[d]===this._o[j]&&(c[d]=Math.max(c[d],c[h.al()]+this.ti(a,h,e)-f))}f+=this._j[g],e=this._i[g]}while(e!==b);f=0,e=b;do{var k=e.al();k!==d&&(f-=this._g[k]),c[k]=c[d]+f,f+=this._j[k],e=this._i[k]}while(e!==b)}},tk:function(a,b,c){var d=b.al();if(!this._d[d]){this._d[d]=!0;var e=b;do{var f=e.al(),g=this._k[f];if(null!=g){var h=g.al(),i=this._o[this._m[h].al()];if(i!==this._o[d]){var j=c[h]-c[d]-this.ti(a,e,g);this._c[i.al()]!==Number.MAX_VALUE&&(j+=this._c[i.al()]),this._c[this._o[d].al()]=Math.min(this._c[this._o[d].al()],j)}else this.tk(a,this._m[h],c)}e=this._i[f]}while(e!==b)}},tc:function(a){for(var b=Hf.a(4),c=Hf.a(4),d=a.x9();d.i1();d.i2()){var e=d.i9(),f=e.al();c[0]+=this._f[0][f],c[1]+=this._f[1][f],c[2]+=this._f[2][f],c[3]+=this._f[3][f]}c[0]/=a.xa(),c[1]/=a.xa(),c[2]/=a.xa(),c[3]/=a.xa();for(var g=a.x9();g.i1();g.i2()){var h=g.i9(),i=h.al(),j=a.g4(h);b[0]=this._f[0][i]-c[0],b[1]=this._f[1][i]-c[1],b[2]=this._f[2][i]-c[2],b[3]=this._f[3][i]-c[3],b.sort(Hf.n);var k=(b[1]+b[2])/2;a.s1(h,new Sd(k,j.y))}},ti:function(a,b,c){var d,e=a.gj(b),f=a.gj(c);return d=e>1&&f>1?this._m1+(e+f)/2:this._m3+(e+f)/2,this._l[b.al()]<this._l[c.al()]?(null!=this._a&&(d+=this._a.i3(c)),null!=this._h&&(d+=this._h.i3(b))):(null!=this._a&&(d+=this._a.i3(b)),null!=this._h&&(d+=this._h.i3(c))),d},tj:function(){this._l=null,this._b=null,this._k=null,this._e=null,this._m=null,this._i=null,this._f=null,this._c=null,this._o=null,this._d=null,this._j=null,this._g=null},tf:function(a,b,c,d){for(var e=a.length,f=2;e-1>f;f++)for(var g=-1,h=0,i=0,j=a[f].x1(),k=a[f].x1();k.i1();k.i2()){var l=k.i9(),m=null,n=!1;if(1===l.ak()&&(m=l.ae().a2(),null!=c.i1(m)&&null!=c.i1(l)&&(n=!0)),i===a[f].ay()-1||n){for(var o=n?d[m.al()]:a[f-1].ay();i>=h;h++){for(var p=j.i9(),q=p.am();q.i1();q.i2()){var r=q.i8(),s=d[r.a2().al()];(g>s||s>o)&&b.i7(q.i8(),!0)}j.i2()}g=o}i++}}});var yf=function(a,b){this._b=20,this._a=b,this._d=a,this._f={}};Jb.ext(yf,Object,{a3:function(a){this._b=a},a4:function(a,b,c,d,e){if(this.a2(a)){var f=this.b2(a);f._o=b,f._m=e,f._n=d,f._f=c}},b2:function(a){var b=this._f[a._id];return null==b&&(b=new zf,this._f[a._id]=b),b},a2:function(a){return null!=this._f[a._id]},c:function(){for(var a=Ne.a1(Hf.a(this._d.xa())),b=Ne.a1(Hf.a(this._d.xa())),c=this._d.x9();c.i1();c.i2()){var d=c.i9();if(this.a2(d)){var e=this.b2(d);a.i6(d,this._b*(e.c()-1)),b.i6(d,this._b*(e.b()-1))}}this._d.x1("D",a),this._d.x1("C",b)},g:function(){this._d.x6("D"),this._d.x6("C")},f:function(){for(var a=this._d.x9();a.i1();a.i2()){var b=a.i9();if(this.a2(b)){var c=this._d.gi(b),d=this._d.gh(b),e=this._d.gj(b),f=this._d.g9(b),g=this.b2(b),h=g._q.ay()+g._b.ay()+g._f,i=g._d.ay()+g._g.ay()+g._o,j=g._i.ay()+g._l.ay()+g._n,k=g._h.ay()+g._k.ay()+g._m,l=this._a.a7(e,h),m=this._a.a7(e,i),n=this._a.a7(f,k),o=this._a.a7(f,j);g.a2(this._a.a8(e,h,l),this._a.a8(e,i,m),this._a.a8(f,k,n),this._a.a8(f,j,o));for(var p=g._j.c1();p.i1();p.i2()){var q=p.i8(),r=this.a1(q),s=this.b1(q),t=new qe;r.b()===s.b()?(r.c()?(t.aa(new Sd(c+g._g._bd*m+g._c,d)),t.aa(new Sd(c+g._g._bd*m+g._c,d-this._b)),g._g._bd++,t.aa(new Sd(c+g._g._bd*m+g._c,d-this._b)),t.aa(new Sd(c+g._g._bd*m+g._c,d)),g._g._bd++,g._g._bc=Math.max(g._g._bc,2)):r.d()?(t.aa(new Sd(c+g._b._bd*l+g._p,d+f)),t.aa(new Sd(c+g._b._bd*l+g._p,d+f+this._b)),g._b._bd++,t.aa(new Sd(c+g._b._bd*l+g._p,d+f+this._b)),t.aa(new Sd(c+g._b._bd*l+g._p,d+f)),g._b._bd++,g._b._bc=Math.max(g._b._bc,2)):r.f()?(t.aa(new Sd(c,d+g._i._bd*o+g._a)),t.aa(new Sd(c-this._b,d+g._i._bd*o+g._a)),g._i._bd++,t.aa(new Sd(c-this._b,d+g._i._bd*o+g._a)),t.aa(new Sd(c,d+g._i._bd*o+g._a)),g._i._bd++,g._i._bc=Math.max(g._i._bc,2)):r.e()&&(t.aa(new Sd(c+e,d+g._h._bd*n+g._e)),t.aa(new Sd(c+e+this._b,d+g._h._bd*n+g._e)),g._h._bd++,t.aa(new Sd(c+e+this._b,d+g._h._bd*n+g._e)),t.aa(new Sd(c+e,d+g._h._bd*n+g._e)),g._h._bd++,g._h._bc=Math.max(g._h._bc,2)),this._d.m1(q,t)):r.c()||s.c()?r.e()||s.e()?(t.aa(new Sd(c+e-g._d._bd*m-g._c,d)),t.aa(new Sd(c+e-g._d._bd*m-g._c,d-this._b*g._d._bc)),t.aa(new Sd(c+e+this._b*g._h._bc,d-this._b*g._d._bc)),t.aa(new Sd(c+e+this._b*g._h._bc,d+g._h._bd*n+g._e)),t.aa(new Sd(c+e,d+g._h._bd*n+g._e)),g._d._bd++,g._d._bc++,g._h._bd++,g._h._bc++,s.c()&&t.ax(),this._d.m1(q,t)):r.f()||s.f()?(t.aa(new Sd(c+g._g._bd*m+g._c,d)),t.aa(new Sd(c+g._g._bd*m+g._c,d-this._b*g._g._bc)),t.aa(new Sd(c-this._b*g._i._bc,d-this._b*g._g._bc)),t.aa(new Sd(c-this._b*g._i._bc,d+g._i._bd*o+g._a)),t.aa(new Sd(c,d+g._i._bd*o+g._a)),g._g._bd++,g._g._bc++,g._i._bd++,g._i._bc++,s.c()&&t.ax(),this._d.m1(q,t)):(r.d()||s.d())&&(t.aa(new Sd(c+e-g._d._bd*m-g._c,d)),t.aa(new Sd(c+e-g._d._bd*m-g._c,d-this._b*g._d._bc)),t.aa(new Sd(c+e+this._b*g.b(),d-this._b*g._d._bc)),t.aa(new Sd(c+e+this._b*g.b(),d+f+this._b*g._q._bc)),t.aa(new Sd(c+e-g._q._bd*l-g._p,d+f+this._b*g._q._bc)),t.aa(new Sd(c+e-g._q._bd*l-g._p,d+f)),g._d._bd++,g._d._bc++,g._k._bc++,g._h._bc++,g._q._bc++,g._q._bd++,s.c()&&t.ax(),this._d.m1(q,t)):r.d()||s.d()?r.e()||s.e()?(t.aa(new Sd(c+e-g._q._bd*l-g._p,d+f)),t.aa(new Sd(c+e-g._q._bd*l-g._p,d+f+this._b*g._q._bc)),t.aa(new Sd(c+e+this._b*g._k._bc,d+f+this._b*g._q._bc)),t.aa(new Sd(c+e+this._b*g._k._bc,d+f-g._k._bd*n-g._e)),t.aa(new Sd(c+e,d+f-g._k._bd*n-g._e)),g._q._bd++,g._q._bc++,g._k._bd++,g._k._bc++,s.d()&&t.ax(),this._d.m1(q,t)):(r.f()||s.f())&&(t.aa(new Sd(c+g._b._bd*l+g._p,d+f)),t.aa(new Sd(c+g._b._bd*l+g._p,d+f+this._b*g._b._bc)),t.aa(new Sd(c-this._b*g._l._bc,d+f+this._b*g._b._bc)),t.aa(new Sd(c-this._b*g._l._bc,d+f-g._l._bd*o-g._a)),t.aa(new Sd(c,d+f-g._l._bd*o-g._a)),g._b._bd++,g._b._bc++,g._l._bd++,g._l._bc++,s.d()&&t.ax(),this._d.m1(q,t)):(t.aa(new Sd(c,d+f-g._l._bd*o-g._a)),t.aa(new Sd(c-this._b*g._l._bc,d+f-g._l._bd*o-g._a)),t.aa(new Sd(c-this._b*g._l._bc,d+f+this._b*g.a1())),t.aa(new Sd(c+e+this._b*g._k._bc,d+f+this._b*g.a1())),t.aa(new Sd(c+e+this._b*g._k._bc,d+f-g._k._bd*n-g._e)),t.aa(new Sd(c+e,d+f-g._k._bd*n-g._e)),g._l._bd++,g._l._bc++,g._b._bc++,g._q._bc++,g._k._bc++,g._k._bd++,s.f()&&t.ax(),this._d.m1(q,t))}}}},a5:function(a,b){for(var c=0;c<a.length;c++)for(var d=a[c],e=b[c],f=d.x1();f.i1();f.i2()){var g=f.i9();if(this.a2(g)){var h=this.b2(g);e._g=Math.max(e._g,this._b*(h.d()-1)),e._j=Math.max(e._j,this._b*(h.a1()-1))}}},a1:function(a){var b=this._d.xc("A"),c=null;if(null!=b&&(c=b.i1(a)),null==c||c.g()){var d=this._d.xc("B");if(null==d)return pf.j(1);var e=d.i1(a);if(null==e||e.g())return pf.j(1);if(e.c())return pf.j(8);if(e.f())return pf.j(1);if(e.d())return pf.j(4);if(e.e())return pf.j(2)}return c},b1:function(a){var b=this._d.xc("B"),c=null;if(null!=b&&(c=b.i1(a)),null==c||c.g()){var d=this._d.xc("A");if(null==d)return pf.j(8);var e=d.i1(a);if(null==e||e.g())return pf.j(8);if(e.c())return pf.j(8);if(e.f())return pf.j(1);if(e.d())return pf.j(4);if(e.e())return pf.j(2)}return c}});var zf=function(){this._o=0,this._f=0,this._n=0,this._m=0,this._c=0,this._p=0,this._e=0,this._a=0,this._j=new re,this._g=new vf,this._d=new vf,this._b=new vf,this._q=new vf,this._h=new vf,this._k=new vf,this._i=new vf,this._l=new vf};Jb.ext(zf,Object,{a1:function(){return Math.max(this._q._bc,this._b._bc)},d:function(){return Math.max(this._d._bc,this._g._bc)},b:function(){return Math.max(this._k._bc,this._h._bc)},c:function(){return Math.max(this._l._bc,this._i._bc)},a2:function(a,b,c,d){this._c=b,this._a=d,this._p=a,this._e=c,this._g.c0(),this._d.c0(),this._b.c0(),this._q.c0(),this._k.c0(),this._h.c0(),this._l.c0(),this._i.c0()}});var Af=function(a,b,c,d){this._k=20,this._r=.5,this._d=a,this._c=b,this._j=c,this._m=d,this._i=null!=a.xc("A")||null!=a.xc("B"),this._t=new Df(a,b,c,d),this._b=new yf(a,this)};Jb.ext(Af,Object,{a6:function(a){this._k=a,this._t.a1(a),this._b.a3(a)},g1:function(){return this._k},a9:function(a){return this.c1(),a},a5:function(a){return this.a1(),a},b3:function(a){return this.c1(),a=this.c4(a),this._b.c(),a},g2:function(a){return this._b.g(),a},e2:function(a){a=this.f(a),this._b.f()},e1:function(){this._t.d(),null!=this._n&&this._d.xi(this._n),this.a1(),this._d=null},a1:function(){this._i&&(null!=this._q&&(this._d.x1("A",this._q),this._q=null),null!=this._p&&(this._d.x1("B",this._p),this._p=null),null!=this._h&&(this._d.xj(this._h),this._h=null),null!=this._l&&(this._d.xj(this._l),this._l=null))},c1:function(){if(this._i){null==this._h&&(this._h=this._d.xl()),null==this._l&&(this._l=this._d.xl());for(var a=this._d.xf();a.i1();a.i2()){var b=a.i8(),c=null!=this._j.i1(b.a2()),d=null!=this._j.i1(b.a3());if(c&&!d){var e=this._j.i1(b.a2());this._m.i4(e)?this._l.i8(b,pf.h(this._d,e)):this._l.i8(b,pf.i(this._d,e))}else if(!c&&d){var f=this._j.i1(b.a3());this._m.i4(f)?this._h.i8(b,pf.i(this._d,f)):this._h.i8(b,pf.h(this._d,f))}else c||d||(this._m.i4(b)?(this._h.i8(b,pf.i(this._d,b)),this._l.i8(b,pf.h(this._d,b))):(this._h.i8(b,pf.h(this._d,b)),this._l.i8(b,pf.i(this._d,b))))}this._q=this._d.xc("A"),this._p=this._d.xc("B"),this._d.x1("A",this._h),this._d.x1("B",this._l)}},c4:function(a){this._n=this._d.xk(),this._a=this._d.xl(),this._g=this._d.xl();for(var b=new re,c=new re,d=new re,e=new re,f=new re,g=new re,h=new re,i=new re,j=new re,k=this._d.xk(),l=0;l<a.length;l++)for(var m=0,n=a[l].x1();n.i1();)k.i6(n.i9(),m),n.i2(),m++;for(var o=function(a,b){var c=k.i3(a.a3())-k.i3(b.a3());return 0>=c?c>=0?0:-1:1},p=function(a,b){var c=k.i3(a.a2())-k.i3(b.a2());return 0>=c?c>=0?0:-1:1},q=0;q<a.length;q++)for(var r=a[q],s=r._b;null!=s;s=s.a()){var t=s.d();t.av(o),t.au(p);var u=0;b.af(),c.af(),d.af(),e.af(),f.af(),g.af(),h.af(),i.af(),j.af();for(var v=t.ap();v.i1();){var w=v.i8(),x=this.b1(w);null==x||x.d()||x.g()?d.aa(w):x.e()?b.aa(w):x.f()?(c.aa(w),j.aa(w)):x.c()&&(i.aa(w),j.aa(w)),v.i2(),u++}u=0;for(var y=t.am();y.i1();){var z=y.i8(),A=this.a2(z);null==A||A.c()||A.g()?e.aa(z):A.e()?b.aa(z):A.f()?(c.aa(z),j.aa(z)):A.d()&&(g.aa(z),j.aa(z)),y.i2(),u++}var B=k.i3(t);if(!j.ar())for(var C=.1/j.ay(),D=B-.4;!j.ar();D+=C){var E=j.c3();if(E.a2()===t){var F=this._d.xm();this._n.z1(F,E.a2()),this._d.s7(F,1,1),this._c.z1(F,this._c.i1(t)),k.i6(F,D),this._a.i8(E,this._d.gn(E)),this._d.gt(E,ff._A),this._d.xr(E,F,E.a3()),r.ao(F,s)}else{var G=this._d.xm();this._n.z1(G,E.a3()),this._d.s7(G,1,1),this._c.z1(G,this._c.i1(t)),k.i6(G,D),this._g.i8(E,this._d.gk(E)),this._d.gz(E,ff._A),this._d.xr(E,E.a2(),G),r.ao(G,s)}}if(!b.ar())for(var H=.1/b.ay(),I=B+.1;!b.ar();I+=H){var J=b.c3();if(J.a2()===t){var K=this._d.xm();this._n.z1(K,J.a2()),this._d.s7(K,1,1),this._c.z1(K,this._c.i1(t)),k.i6(K,I),this._a.i8(J,this._d.gn(J)),this._d.gt(J,ff._A),this._d.xr(J,K,J.a3()),s=r.an(K,s)}else{var L=this._d.xm();this._n.z1(L,J.a3()),this._d.s7(L,1,1),this._c.z1(L,this._c.i1(t)),k.i6(L,I),this._g.i8(J,this._d.gk(J)),this._d.gz(J,ff._A),this._d.xr(J,J.a2(),L),s=r.an(L,s)}}var M=Af._z;this._b.a2(t)&&(M=this._b.b2(t));var N=M._b.ay()+g.ay()+t.ao()+f.ay()+M._q.ay();if(N>0)for(var O=this._d.g9(t)/2,P=this._d.gj(t),Q=this.a7(P,N),R=-.5*P+this.a8(this._d.gj(t),N,Q)+Q*(M._b.ay()+g.ay()),S=t.ap();S.i1();S.i2()){var T=S.i8();this.c2(T)||null!=this._j.i1(T.a2())||(this._d.g2(T).i8(new Sd(R,O)),R+=Q)}var U=this._t.a3(t),V=0,W=0,X=0,Y=0;if(null!=U&&(V=U._e.ay(),W=U._c.ay(),X=U._b.ay(),Y=U._d.ay()),N=M._g.ay()+V+i.ay()+t.ak()+h.ay()+W+M._d.ay(),N>0){for(var Z=this._d.gj(t),$=this.a7(Z,N),_=this.a8(Z,N,$),aa=-.5*Z+_+$*(M._g.ay()+V+i.ay()),ba=-this._d.g9(t)/2,ca=t.am();ca.i1();ca.i2()){var da=ca.i8();this.d1(da)||null!=this._j.i1(da.a3())||(this._d.g2(da).i9(new Sd(aa,ba)),aa+=$)}if(null!=U){for(var ea=-.5*Z+_+$*(M._g.ay()+i.ay()+U._e.ay()-1),fa=U._e.c1();fa.i1();fa.i2()){var ga=fa.i8();this._d.u1(ga),ga.a2()!==t||this.c2(ga)?this.d1(ga)||(this._d.g2(fa.i8()).i9(new Sd(ea,ba)),ea-=$):(this._d.g2(fa.i8()).i8(new Sd(ea,ba)),ea-=$),this._d.h1(ga)}ea=.5*Z-_-$*(M._d.ay()+h.ay());for(var ha=U._c.c1();ha.i1();ha.i2()){var ia=ha.i8();this._d.u1(ia),ia.a2()!==t||this.c2(ia)?this.d1(ia)||(this._d.g2(ha.i8()).i9(new Sd(ea,ba)),ea-=$):(this._d.g2(ha.i8()).i8(new Sd(ea,ba)),ea-=$),this._d.h1(ia)}}}this._b.a2(t)&&this._b.a4(t,V+i.ay()+t.ak()+h.ay()+W,g.ay()+t.ao()+f.ay(),X+c.ay(),Y+b.ay())}return this._d.xi(k),a},a7:function(a,b){return 1>=b?0:a/(b-1+2*this._r)},a8:function(a,b,c){return 1>=b?.5*a:.5*(a-c*(b-1))},f:function(a){var b=this.g1();this._f=this._d.xk();for(var c=0;c<a.length;c++)for(var d=a[c],e=d._b;null!=e;){var f=e.d(),g=this._n.i1(f);if(null!=g||this._t.b2(f))e=e.a();else{var h=new Je,i=new Je,j=new Je,k=new Je,l=new Je,m=new Je,n=new re,o=new re,p=new Gf(h,i,j,k,l,m,n,o);this._f.z1(f,p),n.ab(f.am()),o.ab(f.ap());for(var q=e.b();null!=q&&this._n.i1(q.d())===f;q=q.b()){var r=q.d(),s=this.c3(r);s.f()?i.ac(r):s.c()?k.ac(r):s.d()&&m.ac(r)}var t;for(t=e.a();null!=t&&this._n.i1(t.d())===f;t=t.a()){var u=t.d(),v=this.c3(u);v.e()?h.aa(u):v.c()?j.aa(u):v.d()&&l.aa(u)}e=t}}for(var w=this.d2(a),x=0,y=0;y<a.length;y++){var z=w[y];y>0&&(x+=w[y-1]._j+w[y-1]._h+w[y-1]._b),x+=z._g+z._f+z._a+z._d;for(var A=a[y].x1();A.i1();A.i2()){var B=A.i9();this._d.s3(B,this._d.gi(B),this._d.gh(B)+x)}z._c+=x,z._i+=x}for(var C=0;C<a.length;C++)for(var D=a[C],E=D.x1();E.i1();E.i2()){var F=E.i9();null!=this._n.i1(F)&&D.av(E)}for(var G=this,H=function(a,b){return G.a3(a)?G.a3(b)&&G._d.gi(a)>=G._d.gi(b)?-1:1:G.a3(b)?-1:G._d.gi(a)>=G._d.gi(b)?1:-1},I=function(a,b){return G.a3(a)?G.a3(b)?G._d.gi(a)>=G._d.gi(b)?1:-1:1:G.a3(b)?-1:G._d.gi(a)>=G._d.gi(b)?-1:1},J=0;J<a.length;J++)for(var K=w[J],L=a[J].x1();L.i1();L.i2()){var M=L.i9();if(!this._t.b2(M)){var N=this._f.i1(M),O=N._d,P=N._a,Q=N._b,R=N._h,S=N._f,T=N._c,U=N._g,V=N._e,W=0,X=0,Y=0,Z=0,$=M.ao(),_=M.ak(),aa=this._d.gi(M),ba=this._d.gh(M),ca=this._d.gj(M),da=this._d.g9(M),ea=this._t.a3(M),fa=Af._z;if(this._b.a2(M)&&(fa=this._b.b2(M)),null!=ea){if(W=ea._d.ay(),X=ea._b.ay(),Y=ea._e.ay(),Z=ea._c.ay(),W>0)for(var ga=fa._h.ay()+O.ay()+W+fa._k.ay(),ha=this.a7(da,ga),ia=this.a8(da,ga,ha),ja=ba+ia+ha*(fa._h.ay()+this.a4(O)),ka=ea._d.c1();ka.i1();ka.i2()){var la=ka.i8();this._d.u1(la),la.a2()===M?this.c2(la)||this._d.gx(la,new Sd(aa+ca,ja)):(this.d1(la),this._d.gy(la,new Sd(aa+ca,ja))),ja+=ha,this._d.h1(la)}if(X>0)for(var ma=fa._i.ay()+P.ay()+X+fa._l.ay(),na=this.a7(da,ma),oa=this.a8(da,ma,na),pa=ba+oa+na*(fa._i.ay()+this.a4(P)),qa=ea._b.c1();qa.i1();qa.i2()){var ra=qa.i8();this._d.u1(ra),ra.a2()===M?this.c2(ra)||this._d.gx(ra,new Sd(aa,pa)):this.d1(ra)||this._d.gy(ra,new Sd(aa,pa)),pa+=na,this._d.h1(ra)}}if(O.ay()>0){O.a1(H);for(var sa=fa._h.ay()+O.ay()+W+fa._k.ay(),ta=this.a7(da,sa),ua=this.a8(da,sa,ta),va=ba+ua+ta*fa._h.ay(),wa=!0;!O.ar();){var xa=O.x4();if(this.a3(xa)){wa&&(wa=!1,va+=ta*W);var ya=xa.ag(),za=this._d.gd(ya),Aa=za.at();if(za.ac(new Sd(Aa.x,K.b())),this.c2(ya)){var Ba=this._a.i1(ya);za.ac(new Sd(Aa.x,Ba.y+this._d.g6(M))),za.ac(new Sd(Ba.x+this._d.g5(M),Ba.y+this._d.g6(M)))}else za.ac(new Sd(Aa.x,va)),za.ac(new Sd(aa+ca,va));this._d.xr(ya,M,ya.a3()),this._d.m1(ya,za)}else{var Ca=xa.ae(),Da=this._d.gd(Ca),Ea=Da.au();if(Da.ae(new Sd(Ea.x,K.a())),this.d1(Ca)){var Fa=this._g.i1(Ca);Da.ae(new Sd(Ea.x,Fa.y+this._d.g6(M))),Da.ae(new Sd(Fa.x+this._d.g5(M),Fa.y+this._d.g6(M)))}else Da.ae(new Sd(Ea.x,va)),Da.ae(new Sd(aa+ca,va));this._d.xr(Ca,Ca.a2(),M),this._d.m1(Ca,Da)}this._d.x4(xa),va+=ta}}if(P.ay()>0){P.a1(I);for(var Ga=fa._i.ay()+P.ay()+X+fa._l.ay(),Ha=this.a7(da,Ga),Ia=this.a8(da,Ga,Ha),Ja=ba+Ia+Ha*fa._i.ay(),Ka=!0;!P.ar();){var La=P.x4();if(this.a3(La)){Ka&&(Ka=!1,Ja+=Ha*X);var Ma=La.ag(),Na=this._d.gd(Ma),Oa=Na.at();if(Na.ac(new Sd(Oa.x,K.b())),this.c2(Ma)){var Pa=this._a.i1(Ma);Na.ac(new Sd(Oa.x,Pa.y+this._d.g6(M))),Na.ac(new Sd(Pa.x+this._d.g5(M),Pa.y+this._d.g6(M)))}else Na.ac(new Sd(Oa.x,Ja)),Na.ac(new Sd(aa,Ja));this._d.xr(Ma,M,Ma.a3()),this._d.m1(Ma,Na)}else{var Qa=La.ae(),Ra=this._d.gd(Qa),Sa=Ra.au();if(Ra.ae(new Sd(Sa.x,K.a())),this.d1(Qa)){var Ta=this._g.i1(Qa);Ra.ae(new Sd(Sa.x,Ta.y+this._d.g6(M))),Ra.ae(new Sd(Ta.x+this._d.g5(M),Ta.y+this._d.g6(M)))}else Ra.ae(new Sd(Sa.x,Ja)),Ra.ae(new Sd(aa,Ja));this._d.xr(Qa,Qa.a2(),M),this._d.m1(Qa,Ra)}this._d.x4(La),Ja+=Ha}}var Ua=fa._g.ay()+fa._d.ay()+_+R.ay()+Q.ay()+Y+Z;ca=this._d.gj(M);var Va=this.a7(ca,Ua),Wa=this.a8(ca,Ua,Va);Ua=fa._b.ay()+fa._q.ay()+$+T.ay()+S.ay();var Xa=this.a7(ca,Ua),Ya=this.a8(ca,Ua,Xa);if(R.ay()>0)for(var Za,$a=Va,_a=b,ab=this._d.gi(M)+Wa+$a*(fa._g.ay()+R.ay()-1),bb=this._d.gh(M),cb=K._c-K._g-R.ay()*_a;!R.ar();this._d.x4(Za)){Za=R.x4();var db=Za.ag(),eb=this._d.gd(db),fb=eb.at();if(eb.ac(new Sd(fb.x,K.b())),eb.ac(new Sd(fb.x,cb)),this.c2(db)){var gb=this._a.i1(db);eb.ac(new Sd(gb.x+this._d.g5(M),cb)),eb.ac(new Sd(gb.x+this._d.g5(M),gb.y+this._d.g6(M)))}else eb.ac(new Sd(ab,cb)),eb.ac(new Sd(ab,bb)),ab-=$a;cb+=_a,this._d.xr(db,M,db.a3()),this._d.m1(db,eb)}if(Q.ay()>0)for(var hb,ib=Va,jb=b,kb=this._d.gi(M)+this._d.gj(M)-Wa-ib*fa._d.ay(),lb=this._d.gh(M),mb=K._c-K._g-jb;!Q.ar();this._d.x4(hb)){hb=Q.x4();var nb=hb.ag(),ob=this._d.gd(nb),pb=ob.at();if(ob.ac(new Sd(pb.x,K.b())),ob.ac(new Sd(pb.x,mb)),this.c2(nb)){var qb=this._a.i1(nb);ob.ac(new Sd(qb.x+this._d.g5(M),mb)),ob.ac(new Sd(qb.x+this._d.g5(M),qb.y+this._d.g6(M)))}else ob.ac(new Sd(kb,mb)),ob.ac(new Sd(kb,lb)),kb-=ib;mb-=jb,this._d.xr(nb,M,nb.a3()),this._d.m1(nb,ob)}if(T.ay()>0)for(var rb,sb=Xa,tb=b,ub=this._d.gi(M)+Ya+sb*(fa._b.ay()+T.ay()-1),vb=this._d.gh(M)+this._d.g9(M),wb=vb+T.ay()*tb;!T.ar();this._d.x4(rb)){rb=T.x4();var xb=rb.ae(),yb=this._d.gd(xb),zb=yb.au();if(yb.ae(new Sd(zb.x,K.a())),yb.ae(new Sd(zb.x,wb)),this.d1(xb)){var Ab=this._g.i1(xb);yb.ae(new Sd(Ab.x+this._d.g5(M),wb)),yb.ae(new Sd(Ab.x+this._d.g5(M),Ab.y+this._d.g6(M)))}else yb.ae(new Sd(ub,wb)),yb.ae(new Sd(ub,vb)),ub-=sb;wb-=tb,this._d.xr(xb,xb.a2(),M),this._d.m1(xb,yb)}if(S.ay()>0)for(var Bb,Cb=Xa,Db=b,Eb=this._d.gi(M)+this._d.gj(M)-Ya-Xa*fa._q.ay(),Fb=this._d.gh(M)+this._d.g9(M),Gb=Fb+Db;!S.ar();this._d.x4(Bb)){Bb=S.x4();var Hb=Bb.ae(),Ib=this._d.gd(Hb),Jb=Ib.au();if(Ib.ae(new Sd(Jb.x,K.a())),Ib.ae(new Sd(Jb.x,Gb)),this.d1(Hb)){var Kb=this._g.i1(Hb);Ib.ae(new Sd(Kb.x+this._d.g5(M),Gb)),Ib.ae(new Sd(Kb.x+this._d.g5(M),Kb.y+this._d.g6(M)))}else Ib.ae(new Sd(Eb,Gb)),Ib.ae(new Sd(Eb,Fb)),Eb-=Cb;Gb+=Db,this._d.xr(Hb,Hb.a2(),M),this._d.m1(Hb,Ib)}for(;!V.ar();){var Lb=V.c3(),Mb=this._d.gl(Lb);K.a()+12<Mb.y&&this._d.g7(Lb).i4(Mb.x,K.a())}for(;!U.ar();){var Nb=U.c3(),Ob=this._d.gs(Nb);if(K.b()-12>Ob.y){var Pb=this._d.gf(Nb);Pb.ac(new Sd(Ob.x,K.b())),this._d.s6(Nb,Pb)}}}}for(var Qb=0;Qb<a.length;Qb++)for(var Rb=a[Qb],Sb=Rb._b;null!=Sb;Sb=Sb.a()){var Tb=Sb.d(),Ub=this._t.a3(Tb);null!=Ub&&null!=Ub._a&&(this._d.x4(Ub._a),Rb.aw(Sb.b()))}return this._d.xi(this._f),this._d.xj(this._a),this._d.xj(this._g),a},c3:function(a){return this.a3(a)?this.b1(a.ag()):this.a2(a.ae())},b1:function(a){return null==this._h?Af.s:this._h.i1(a)},a2:function(a){return null==this._l?Af.u:this._l.i1(a)},c2:function(a){if(null==a)return!1;var b=this.b1(a);return null!=b&&b.a()},d1:function(a){if(null==a)return!1;var b=this.a2(a);return null!=b&&b.a()},a3:function(a){return 1===a.ao()},b2:function(a){return 1===a.ak()},a4:function(a){for(var b=0,c=a._b;null!=c;c=c.a())this.b2(c.d())&&b++;return b},d2:function(a){for(var b=this._k,c=Hf.d(a.length+1),d=0;d<a.length;d++){var e=a[d],f=new Ef;c[d]=f,f._c=Number.MAX_VALUE,f._i=Number.MIN_VALUE;for(var g=e.x1();g.i1();g.i2()){var h=g.i9(),i=this._d.gb(h);f._c=Math.min(f._c,i.i2()),f._i=Math.max(f._i,i.i2()+i.i4())}}this._b.a5(a,c);for(var j=0;j<a.length;j++)for(var k=c[j],l=a[j].x1();l.i1();l.i2()){var m=l.i9(),n=this._f.i1(m);null!=n&&(k._h=Math.max(k._h,Math.max(n._f.ay()*b,n._c.ay()*b)),k._f=Math.max(k._f,Math.max(n._b.ay()*b,n._h.ay()*b)))}return c}}),Af.s=pf.j(2),Af.u=pf.j(1),Af._z=new zf;var Bf=function(){this._af=0,this._b=0};Jb.ext(Bf,Object,{ib:function(a){this._af=a},ia:function(a,b,c){this.a6(a,b,c),this.b2(!1);var d=this.g();if(this.o()&&d>0){for(var e=this.r(),f=0;20>f&&d>0&&this.o();f++){this.b2(!0);var g=this.g();d>g&&(this.a7(e),d=g)}this.b3(e),this.b1()}return this.c()},a6:function(a,b,c){this._b=(new Date).getTime(),this._ac=a,this._ah=b;var d=this;this._p=function(a,b){var c=d._n[a.al()]-d._n[b.al()];return c>0?1:c>=0?0:-1},this._ad=Hf.d(c);for(var e=0;e<this._ad.length;e++)this._ad[e]=new Je;this._ab=Hf.a(this._ac.x0()),this._f=Hf.d(this._ac.x0()),this._n=Hf.a(this._ac.x0()+1);var f=this._ab;this._o=function(a,b){if(null==a&&null!=b)return 1;if(null!=a&&null==b)return-1;if(null==a&&null==b)return 0;var c=a,d=b,e=c._h,g=c.a2(),h=d.a2(),i=f[g.al()]-f[h.al()];if(0===i){var j=Bf.b(pf.h(e,c),e.gn(c)),k=Bf.b(pf.h(e,d),e.gn(d)),l=j-k;if(0===l){var m=f[c.a3().al()]-f[d.a3().al()];if(0===m){var n=Bf.a(pf.i(e,c),e.gk(c)),o=Bf.a(pf.i(e,d),e.gk(d));return n-o}return m}return l}return i},this._l=function(a,b){if(null==a&&null!=b)return 1;if(null!=a&&null==b)return-1;if(null==a&&null==b)return 0;var c=a,d=b,e=c._h,g=c.a3(),h=d.a3(),i=f[g.al()]-f[h.al()];if(0===i){var j=Bf.a(pf.i(e,c),e.gk(c)),k=Bf.a(pf.i(e,d),e.gk(d)),l=j-k;if(0===l){var m=f[c.a2().al()]-f[d.a2().al()];if(0===m){var n=Bf.b(pf.h(e,c),e.gn(c)),o=Bf.b(pf.h(e,d),e.gn(d));return n-o}return m}return l}return i},this._z=function(a,b){if(null==a&&null!=b)return 1;if(null!=a&&null==b)return-1;if(null==a&&null==b)return 0;var c=a,d=b,e=c._h,f=Bf.b(pf.h(e,c),e.gn(c)),g=Bf.b(pf.h(e,d),e.gn(d));return f-g},this._e=function(a,b){if(null==a&&null!=b)return 1;if(null!=a&&null==b)return-1;if(null==a&&null==b)return 0;var c=a,d=b,e=c._h,f=Bf.a(pf.i(e,c),e.gk(c)),g=Bf.a(pf.i(e,d),e.gk(d));return f-g},this._ac.x2(this._e,this._z)},c:function(){this._ah=null,this._aa=null,this._f=null,this._n=null,this._p=null,this._o=null,this._l=null,this._ac=null;var a=this._ad;return this._ad=null,a},o:function(){var a=(new Date).getTime()-this._b;return a<=this._af},m:function(){for(var a=this,b=function(b,c){return Math.ceil(a._n[b.a3().al()])-Math.ceil(a._n[c.a3().al()])},c=this._ac.x9();c.i1();c.i2()){for(var d=c.i9().aw();d.i1();d.i2())this._n[d.i9().al()]=ff.j();c.i9().av(b)}},b2:function(a){for(var b=0;b<this._ad.length;b++)this._ad[b].af();if(a){this.m();for(var c=0,d=this._ab.length;d>c;c++)this._ab[c]=0;this._ac.x2(null,this._z)}var e=this._ac.xm();this._ah.i7(e,0);for(var f=this._ac.x9();f.i1();f.i2())0===f.i9().ak()&&f.i9()!==e&&this._ac.xo(e,f.i9());var g=new ee(this);g.a6(!0),g.a9(this._ac,e),this._ad[0].at(),this._ac.x4(e),this.d()},a1:function(){this._ac.x2(this._o,this._l);for(var a=0,b=1;b<this._ad.length;b++){var c=this.a2(this._ad[b-1],this._ad[b]);a+=c}var d=0;return a+=d},a2:function(a,b){var c=a.ah(),d=b.ah(),e=new qe,f=new qe;this._aa=Hf.d(this._ac.x0());for(var g=0;c.i1()&&d.i1();d.i2())g+=this.a8(c.i6(),e,f,!0),g+=this.a8(d.i6(),f,e,!1),c.i2();for(;c.i1();c.i2())g+=this.a8(c.i6(),e,f,!0);for(;d.i1();d.i2())g+=this.a8(d.i6(),f,e,!1);return g},a8:function(a,b,c,d){var e=0,f=0,g=0;if(null!=this._aa[a.al()])for(var h=this._aa[a.al()].a(),i=b._b;i!==h;i=i.a()){var j=i._c;j===a?(e++,g+=f,b.aw(i)):f++}var k=e*c.ay()+g;if(d)for(var l=a.ag();null!=l;l=l.a8()){var m=l.a3();this._ab[m.al()]>=this._ab[a.al()]&&(this._aa[m.al()]=c.ae(m))}else for(var n=a.ae();null!=n;n=n.a7()){var o=n.a2();this._ab[o.al()]>this._ab[a.al()]&&(this._aa[o.al()]=c.ae(o))}return k},g:function(){for(var a=this.r(),b=this.a1(),c=!0,d=0;3>d&&this.o()&&b>0;){var e=this.k();b>e?(this.a7(a),b=e):d++,c=!c}if(this.b3(a),this.b1(),b>0){for(var f=1,g=0;1===f&&b>0;g++){this.e(),this.i();var h=this.a1();b>h?(f=1,this.a7(a)):f=-1,b=h}this.b3(a),this.b1()}return b},e:function(){for(var a=this.l(),b=this.r(),c=Hf.d(this._ac.x0()),d=this._ad.length-1;d>=0;d--)for(var e=this._ad[d].ah();e.i1();e.i2()){var f=e.i6();if(1===f.ak()&&1===f.ao()){var g=a.i1(f.ag());if(null!=g&&null==c[g.al()])for(var h=this.a4(f,g),i=g.al(),j=c[i]=Hf.d(h+1),k=j.length-1;k>=0;k--)j[k]=new qe}}for(var l=0;l<this._ad.length;l++)for(var m=this._ad[l].ah();m.i1();m.i2()){var n=m.i6();if(1===n.ak()&&1===n.ao()){var o=a.i1(n.ag());if(null!=o){var p=o.al(),q=this.a4(n,o)-1;c[p][q].ae(n.ae())}}else for(var r=n.ae();null!=r;r=r.a7()){var s=a.i1(r);if(null!=s){var t=s.al(),u=this.a4(n,s)-1;c[t][u].ae(r)}}}for(var v=this._ac.x9();v.i1();v.i2()){var w=v.i9();if(null!=c[w.al()])for(var x=w.ag();null!=x;x=x.a8()){var y=a.i1(x);if(null!=y)for(var z=c[y.al()];z[0].ay()>0;){for(var A,B=0;;){A=z[B].am();var C=A.a3();if(1!==C.ak()||1!==C.ao())break;B++}var D=z[B].at().a3();B--,D=A.a2(),A=z[B].at();for(var E=A.a3();B>=0;)if(b[D.al()]!==b[E.al()]&&(this._ab[D.al()]=b[E.al()]),D=D.ae().a2(),--B>=0){var F=z[B].at();E=F.a3()}}}}this.b1(),this._ac.xj(a)},i:function(){for(var a=this.f(),b=this.r(),c=Hf.d(this._ac.x0()),d=0;d<this._ad.length;d++)for(var e=this._ad[d].ah();e.i1();e.i2()){var f=e.i6();if(1===f.ak()&&1===f.ao()){var g=a.i1(f.ae());if(null!=g&&null==c[g.al()])for(var h=this.a4(g,f),i=g.al(),j=c[i]=Hf.d(h+1),k=j.length-1;k>=0;k--)j[k]=new qe}}for(var l=this._ad.length-1;l>=0;l--)for(var m=this._ad[l].ah();m.i1();m.i2()){var n=m.i6();if(1===n.ak()&&1===n.ao()){var o=a.i1(n.ae());if(null!=o){var p=o.al(),q=this.a4(o,n)-1;c[p][q].ae(n.ag())}}else for(var r=n.ag();null!=r;r=r.a8()){var s=a.i1(r);if(null!=s){var t=s.al(),u=this.a4(s,n)-1;c[t][u].ae(r)}}}for(var v=this._ac.x9();v.i1();v.i2()){var w=v.i9();if(null!=c[w.al()])for(var x=w.ae();null!=x;x=x.a7()){var y=a.i1(x);if(null!=y)for(var z=c[y.al()];z[0].ay()>0;){for(var A,B=0;;){A=z[B].am();var C=A.a2();if(1!==C.ak()||1!==C.ao())break;B++}var D=z[B].at().a2();B--,D=A.a3(),A=z[B].at();for(var E=A.a2();B>=0;)if(b[D.al()]!==b[E.al()]&&(this._ab[D.al()]=b[E.al()]),D=D.ag().a3(),--B>=0){var F=z[B].at();E=F.a2()}}}}this.b1(),this._ac.xj(a)},a4:function(a,b){return this._ah.i2(a)-this._ah.i2(b)},l:function(){for(var a=Ne.a6(Hf.d(this._ac.xg())),b=this._ac.x9();b.i1();b.i2()){
var c=b.i9();if(c.ao()>1){for(var d=0,e=c.ag();null!=e;e=e.a8()){var f=e.a3();1===f.ak()&&1===f.ao()&&d++}if(d>1)for(var g=c.ag();null!=g;g=g.a8()){var h=g,i=h.a3();if(1===i.ak()&&1===i.ao()){for(;1===i.ak()&&1===i.ao();i=h.a3())a.i8(h,c),h=i.ag();a.i8(h,c)}}}}return a},f:function(){for(var a=Ne.a6(Hf.d(this._ac.xg())),b=this._ac.x9();b.i1();b.i2()){var c=b.i9();if(c.ak()>1){for(var d=0,e=c.ae();null!=e;e=e.a7()){var f=e.a2();1===f.ak()&&1===f.ao()&&d++}if(d>1)for(var g=c.ae();null!=g;g=g.a7()){var h=g,i=h.a2();if(1===i.ak()&&1===i.ao()){for(;1===i.ak()&&1===i.ao();i=h.a2())a.i8(h,c),h=i.ae();a.i8(h,c)}}}}return a},k:function(){for(var a=1;a<this._ad.length;a++){for(var b=this._ad[a],c=b.ah();c.i1();c.i2()){var d=c.i6();this._n[d.al()]=this.a5(d,b.ay(),d.am(),this._ad[a-1].ay()),this._n[d.al()]+=this._ab[d.al()]/(3*this._ad[a-1].ay())}this.a3(b,this._p)}return this.a1()},a5:function(a,b,c,d){var e=0;if(0===c.i7())e=d*this._ab[a.al()]/b;else{for(;c.i1();c.i2()){var f=c.i8();e+=f.a2()===a?this._ab[f.a3().al()]:this._ab[f.a2().al()]}e/=c.i7()}return e},a7:function(a){Hf.f(this._ab,a,a.length)},b3:function(a){Hf.f(a,this._ab,a.length)},r:function(){var a=Hf.a(this._ab.length);return this.a7(a),a},d:function(){for(var a=0;a<this._ad.length;a++)for(var b=0,c=this._ad[a].ah();c.i1();)this._ab[c.i6().al()]=b,c.i2(),b++},b1:function(){for(var a=0;a<this._ad.length;a++){for(var b=this._ad[a],c=b._b;null!=c;c=c.a()){var d=c.d();this._f[this._ab[d.al()]]=d}for(var e=0,f=b._b;null!=f;)f.c(this._f[e]),f=f.a(),e++}},a3:function(a,b){for(var c=a.ah(),d=0;d<a.ay();c.i2())this._f[d]=c.i6(),d++;Hf.s(this._f,a.ay(),b);for(var e=0,f=a._b;null!=f;)f.c(this._f[e]),this._ab[this._f[e].al()]=e,f=f.a(),e++}}),Bf.b=function(a,b){if(null==a)return 0;var c=a.a()?Math.floor(b.x):0,d=a.a()?Math.floor(b.y):0;return a.e()?1e4-d:a.f()?-1e4+d:a.c()?-2e4-c:c},Bf.a=function(a,b){if(null==a)return 0;var c=a.a()?Math.floor(b.x):0,d=a.a()?Math.floor(b.y):0;return a.e()?1e4+d:a.f()?-1e4-d:a.d()?-2e4-c:c};var Cf=function(){Cf.superClass.constructor.call(this),this._i6=0,this._i3=2147483647,this._i0=60,this._iz=20,this._i2=20,this._i4=20,this.i5(!1),this._i7=new uf,this._i1=new Bf,this._i8=new xf};Jb.ext(Cf,Qe,{j2:function(){return this._i2},i4:function(a){return!0},i3:function(a){this._i6=(new Date).getTime(),of.d(a,!1);var b=a.xk(),c=a.xk(),d=a.xl(),e=new re,f=new Af(a,b,c,d);f.a6(this.j2()),this._i8.i3(this._iz),this._i8.i6(this._i0),this._i8.i4(this._i2),this._i8.i5(this._i4),this._i8.i2(c);for(var g=this._i7.i1(a,b,e),h=e.c1();h.i1();h.i2()){var i=h.i8();d.i7(i,!0);var j=a.gn(i);a.gt(i,a.gk(i)),a.gz(i,j)}this.a2(a,b,c),g=f.a9(g);var k=this.j1(a,b,g);k=f.a5(k),k=f.b3(k),this._i8.i1(a,k,b),k=f.g2(k),f.e2(k),this.b(a,c),this.w(a),this.a1(a,e),f.e1(),a.xj(d),a.xi(c),a.xi(b)},j1:function(a,b,c){if(this._i1 instanceof Bf){var d=this._i1,e=(new Date).getTime()-this._i6;d.ib(this._i3-e)}var f=this._i1.ia(a,b,c);return f},a1:function(a,b){for(var c=b.c1();c.i1();c.i2()){var d=c.i8(),e=a.gs(d),f=a.gl(d);a.x3(d);var g=a.gp(d);a.s5(d,g.a()),a.gy(d,e),a.gx(d,f)}},b:function(a,b){for(var c=a.x9();c.i1();c.i2()){var d=c.i9(),e=b.i1(d);if(null!=e&&!a.xp(e)){for(var f=d.am().i8().a2();null!=b.i1(f);f=d.am().i8().a2())d=f;a.u1(e);for(var g=d.ae(),h=new qe;null!=b.i1(g.a3());g=g.a3().ag()){var i=a.gs(g);h.aa(i),h.az(a.gf(g));var j=a.gl(g);j.equals(i)||h.aa(j)}var k=a.gs(g);h.aa(k),h.az(a.gf(g));var l=a.gl(g);l.equals(k)||h.aa(l),a.m1(e,h)}}for(var m=a.x9();m.i1();m.i2())null!=b.i1(m.i9())&&a.x4(m.i9())},w:function(a){for(var b=a.xf();b.i1();b.i2()){var c=b.i8(),d=a.g2(c);if(d.i1()>0){var e=new nd,f=a.gc(c),g=f.c(),h=g.i6();g.i2();var i=h.x,j=h.y;if(g.i1()){var k=g.i6(),l=k.x,m=k.y;for(g.i2();g.i1();g.i2()){var n=g.i6(),o=n.x,p=n.y,q=(i-o)*(m-p)/(j-p)+o;Math.abs(q-l)>=1&&(e.add(k),i=l,j=m),k=n,l=o,m=p}}e.size()<d.i1()&&a.s5(c,new Xd(e))}}},a2:function(a,b,c){var d=a.g8().c1();for(d.i5();d.i1();d.i3()){var e=d.i8().a2(),f=d.i8().a3(),g=b.i2(f)-b.i2(e);if(g>1){for(var h=null,i=null,j=e;g>1;g--)h=a.xm(),a.s7(h,1,1),a.s4(h,ff._A),i=a.xo(j,h),j===e&&a.gt(i,a.gn(d.i8())),b.i7(h,b.i2(j)+1),c.z1(h,d.i8()),j=h;i=a.xo(h,f),a.gz(i,a.gk(d.i8())),a.h1(d.i8())}}}});var Df=function(a,b,c,d){this._i=20,this._j=a,this._g=b,this._a=c,this._h=d};Jb.ext(Df,Object,{a1:function(a){this._i=a},b2:function(a){return null==this._e?!1:this._e.i4(a)},a3:function(a){return null==this._f?null:this._f.i1(a)},d:function(){this._j.xi(this._f),this._j.xi(this._e)}});var Ef=function(){this._c=0,this._i=0,this._g=0,this._j=0,this._f=0,this._h=0,this._d=0,this._e=0,this._a=0,this._b=0};Jb.ext(Ef,Object,{a:function(){return this._c-this._g-this._f-this._a},b:function(){return this._i+this._j+this._h+this._b}});var Ff=function(){this._d=new re,this._b=new re,this._c=new re,this._e=new re};Jb.ext(Ff,Object,{});var Gf=function(a,b,c,d,e,f,g,h){this._d=a,this._a=b,this._b=c,this._h=d,this._f=e,this._c=f,this._e=g,this._g=h};Jb.ext(Gf,Object,{});var Hf={};Hf.a=function(a,b){for(var c=[],d=0;a>d;d++)c[d]=b||0;return c},Hf.b=function(a){for(var b=[],c=0;a>c;c++)b[c]=!1;return b},Hf.c=function(a,b){if(a instanceof Sd)return a.x<b.x?-1:a.x>b.x?1:a.y<b.y?-1:a.y<=b.y?0:1;if(a instanceof Td)return b.width>a.width?-1:b.width<a.width?1:b.height>a.height?-1:b.height>=a.height?0:1;if(a instanceof Vd)return a.x<b.x?-1:a.x>b.x?1:a.y<b.y?-1:a.y>b.y?1:b.width>a.width?-1:b.width<a.width?1:b.height>a.height?-1:b.height>=a.height?0:1;throw"Unkown Type: "+a},Hf.d=function(a){for(var b=[],c=0;a>c;c++)b[c]=null;return b},Hf.e=function(a,b){for(var c=[],d=0;a>d;d++)c[d]=Hf.a(b);return c},Hf.f=function(a,b,c){for(var d=0;c>d;d++)b[d]=a[d]},Hf.s=function(a,b,c){var d=[];Hf.f(a,d,b),d.sort(c),Hf.f(d,a,b)},Hf.n=function(a,b){return a-b}}(this),function(d,e){function f(a,b,c,d,e,f){var g=e.realSize?e.realSize:e;b=b||"",b=String(b),a.font=c,a.fillStyle=d,a.strokeStyle="gray",a.textBaseline="middle",a.textAlign="center";for(var h=b.split("\n"),i=h.length,j=g.height/i,k=(e.height-g.height)/2,l=0;i>l;l++){var m=fc.getTextSize(c,h[l]).width,n=(e.height,m/2);"right"==f?(n=e.width-m/2,a.textAlign="center"):"left"==f?(n=m/2,a.textAlign="center",a.textBaseline="middle"):"center"==f&&(n=e.width/2),a.strokeText(h[l],n,j/2+l*j+k),a.fillText(h[l],n,j/2+l*j+k)}}function g(a,b){var c=0;if(a.shadowMatrix)for(var d=0,e=b.size();e>d;d++){var f=b.get(d);f.refreshShadowUniforms(a,c)&&c++}}function h(a,b){var c=0;if(a.pShadowMap)for(var d=0,e=b.size();e>d;d++){var f=b.get(d);f.refreshUniformsPointShadow(a,c)&&c++}}function k(a,b,c){b._modelViewMatrix||(b._modelViewMatrix=new ac),c.uniformMatrix4fv(a.modelViewMatrix,!1,b._modelViewMatrix.elements),a.normalMatrix&&c.uniformMatrix3fv(a.normalMatrix,!1,b._normalMatrix.elements)}function l(a,b,c){var d;return"fragment"===a?d=c.createShader(c.FRAGMENT_SHADER):"vertex"===a&&(d=c.createShader(c.VERTEX_SHADER)),c.shaderSource(d,b),c.compileShader(d),c.getShaderParameter(d,c.COMPILE_STATUS)?d:(console.log(c.getShaderInfoLog(d)),console.error(b),null)}function m(a,b){a.ambientLightColor.value=b.ambient,a.directionalLightColor.value=b.directional.colors,a.directionalLightDirection.value=b.directional.positions,a.pointLightColor.value=b.point.colors,a.pointLightPosition.value=b.point.positions,a.pointLightDistance.value=b.point.distances,a.spotLightColor.value=b.spot.colors,a.spotLightPosition.value=b.spot.positions,a.spotLightDistance.value=b.spot.distances,a.spotLightDirection.value=b.spot.directions,a.spotLightAngleCos.value=b.spot.anglesCos,a.spotLightExponent.value=b.spot.exponents,a.hemisphereLightSkyColor.value=b.hemi.skyColors,a.hemisphereLightGroundColor.value=b.hemi.groundColors,a.hemisphereLightDirection.value=b.hemi.positions}function n(a,b,c,d){a[b]=c.r*d,a[b+1]=c.g*d,a[b+2]=c.b*d}function o(a,b,c,d){a[b]=c.r*c.r*d,a[b+1]=c.g*c.g*d,a[b+2]=c.b*c.b*d}function p(a){var b=a;sc.isNaN(b._renderInterval)&&(b._renderInterval=10),b.__timeOutFunc||(b.__timeOutFunc=function(){requestAnimationFrame(b.__timeOutFunc),b.render()}),setTimeout(b.__timeOutFunc,b._renderInterval)}function q(a,b,c){null!=a&&("number"==typeof a?this.fromNumber(a,b,c):null==b&&"string"!=typeof a?this.fromString(a,256):this.fromString(a,b))}function r(){return new q(null)}function s(a,b,c,d,e,f){for(;--f>=0;){var g=b*this[a++]+c[d]+e;e=Math.floor(g/67108864),c[d++]=67108863&g}return e}function t(a,b,c,d,e,f){for(var g=32767&b,h=b>>15;--f>=0;){var i=32767&this[a],j=this[a++]>>15,k=h*i+j*g;i=g*i+((32767&k)<<15)+c[d]+(1073741823&e),e=(i>>>30)+(k>>>15)+h*j+(e>>>30),c[d++]=1073741823&i}return e}function v(a,b,c,d,e,f){for(var g=16383&b,h=b>>14;--f>=0;){var i=16383&this[a],j=this[a++]>>14,k=h*i+j*g;i=g*i+((16383&k)<<14)+c[d]+e,e=(i>>28)+(k>>14)+h*j,c[d++]=268435455&i}return e}function w(a){return Gc.charAt(a)}function x(a,b){var c=Hc[a.charCodeAt(b)];return null==c?-1:c}function y(a){for(var b=this.t-1;b>=0;--b)a[b]=this[b];a.t=this.t,a.s=this.s}function z(a){this.t=1,this.s=0>a?-1:0,a>0?this[0]=a:-1>a?this[0]=a+DV:this.t=0}function A(a){var b=r();return b.fromInt(a),b}function B(a,b){var c;if(16==b)c=4;else if(8==b)c=3;else if(256==b)c=8;else if(2==b)c=1;else if(32==b)c=5;else{if(4!=b)return void this.fromRadix(a,b);c=2}this.t=0,this.s=0;for(var d=a.length,e=!1,f=0;--d>=0;){var g=8==c?255&a[d]:x(a,d);0>g?"-"==a.charAt(d)&&(e=!0):(e=!1,0==f?this[this.t++]=g:f+c>this.DB?(this[this.t-1]|=(g&(1<<this.DB-f)-1)<<f,this[this.t++]=g>>this.DB-f):this[this.t-1]|=g<<f,f+=c,f>=this.DB&&(f-=this.DB))}8==c&&0!=(128&a[0])&&(this.s=-1,f>0&&(this[this.t-1]|=(1<<this.DB-f)-1<<f)),this.clamp(),e&&q.ZERO.subTo(this,this)}function C(){for(var a=this.s&this.DM;this.t>0&&this[this.t-1]==a;)--this.t}function D(a){if(this.s<0)return"-"+this.negate().toString(a);var b;if(16==a)b=4;else if(8==a)b=3;else if(2==a)b=1;else if(32==a)b=5;else{if(4!=a)return this.toRadix(a);b=2}var c,d=(1<<b)-1,e=!1,f="",g=this.t,h=this.DB-g*this.DB%b;if(g-->0)for(h<this.DB&&(c=this[g]>>h)>0&&(e=!0,f=w(c));g>=0;)b>h?(c=(this[g]&(1<<h)-1)<<b-h,c|=this[--g]>>(h+=this.DB-b)):(c=this[g]>>(h-=b)&d,0>=h&&(h+=this.DB,--g)),c>0&&(e=!0),e&&(f+=w(c));return e?f:"0"}function E(){var a=r();return q.ZERO.subTo(this,a),a}function F(){return this.s<0?this.negate():this}function G(a){var b=this.s-a.s;if(0!=b)return b;var c=this.t;if(b=c-a.t,0!=b)return b;for(;--c>=0;)if(0!=(b=this[c]-a[c]))return b;return 0}function H(a){var b,c=1;return 0!=(b=a>>>16)&&(a=b,c+=16),0!=(b=a>>8)&&(a=b,c+=8),0!=(b=a>>4)&&(a=b,c+=4),0!=(b=a>>2)&&(a=b,c+=2),0!=(b=a>>1)&&(a=b,c+=1),c}function I(){return this.t<=0?0:this.DB*(this.t-1)+H(this[this.t-1]^this.s&this.DM)}function J(a,b){var c;for(c=this.t-1;c>=0;--c)b[c+a]=this[c];for(c=a-1;c>=0;--c)b[c]=0;b.t=this.t+a,b.s=this.s}function K(a,b){for(var c=a;c<this.t;++c)b[c-a]=this[c];b.t=Math.max(this.t-a,0),b.s=this.s}function L(a,b){var c,d=a%this.DB,e=this.DB-d,f=(1<<e)-1,g=Math.floor(a/this.DB),h=this.s<<d&this.DM;for(c=this.t-1;c>=0;--c)b[c+g+1]=this[c]>>e|h,h=(this[c]&f)<<d;for(c=g-1;c>=0;--c)b[c]=0;b[g]=h,b.t=this.t+g+1,b.s=this.s,b.clamp()}function M(a,b){b.s=this.s;var c=Math.floor(a/this.DB);if(c>=this.t)return void(b.t=0);var d=a%this.DB,e=this.DB-d,f=(1<<d)-1;b[0]=this[c]>>d;for(var g=c+1;g<this.t;++g)b[g-c-1]|=(this[g]&f)<<e,b[g-c]=this[g]>>d;d>0&&(b[this.t-c-1]|=(this.s&f)<<e),b.t=this.t-c,b.clamp()}function N(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);e>c;)d+=this[c]-a[c],b[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d-=a.s;c<this.t;)d+=this[c],b[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d-=a[c],b[c++]=d&this.DM,d>>=this.DB;d-=a.s}b.s=0>d?-1:0,-1>d?b[c++]=this.DV+d:d>0&&(b[c++]=d),b.t=c,b.clamp()}function O(a,b){var c=this.abs(),d=a.abs(),e=c.t;for(b.t=e+d.t;--e>=0;)b[e]=0;for(e=0;e<d.t;++e)b[e+c.t]=c.am(0,d[e],b,e,0,c.t);b.s=0,b.clamp(),this.s!=a.s&&q.ZERO.subTo(b,b)}function P(a){for(var b=this.abs(),c=a.t=2*b.t;--c>=0;)a[c]=0;for(c=0;c<b.t-1;++c){var d=b.am(c,b[c],a,2*c,0,1);(a[c+b.t]+=b.am(c+1,2*b[c],a,2*c+1,d,b.t-c-1))>=b.DV&&(a[c+b.t]-=b.DV,a[c+b.t+1]=1)}a.t>0&&(a[a.t-1]+=b.am(c,b[c],a,2*c,0,1)),a.s=0,a.clamp()}function Q(a,b,c){var d=a.abs();if(!(d.t<=0)){var e=this.abs();if(e.t<d.t)return null!=b&&b.fromInt(0),void(null!=c&&this.copyTo(c));null==c&&(c=r());var f=r(),g=this.s,h=a.s,i=this.DB-H(d[d.t-1]);i>0?(d.lShiftTo(i,f),e.lShiftTo(i,c)):(d.copyTo(f),e.copyTo(c));var j=f.t,k=f[j-1];if(0!=k){var l=k*(1<<this.F1)+(j>1?f[j-2]>>this.F2:0),m=this.FV/l,n=(1<<this.F1)/l,o=1<<this.F2,p=c.t,s=p-j,t=null==b?r():b;for(f.dlShiftTo(s,t),c.compareTo(t)>=0&&(c[c.t++]=1,c.subTo(t,c)),q.ONE.dlShiftTo(j,t),t.subTo(f,f);f.t<j;)f[f.t++]=0;for(;--s>=0;){var u=c[--p]==k?this.DM:Math.floor(c[p]*m+(c[p-1]+o)*n);if((c[p]+=f.am(0,u,c,s,0,j))<u)for(f.dlShiftTo(s,t),c.subTo(t,c);c[p]<--u;)c.subTo(t,c)}null!=b&&(c.drShiftTo(j,b),g!=h&&q.ZERO.subTo(b,b)),c.t=j,c.clamp(),i>0&&c.rShiftTo(i,c),0>g&&q.ZERO.subTo(c,c)}}}function R(a){var b=r();return this.abs().divRemTo(a,null,b),this.s<0&&b.compareTo(q.ZERO)>0&&a.subTo(b,b),b}function S(a){this.m=a}function T(a){return a.s<0||a.compareTo(this.m)>=0?a.mod(this.m):a}function U(a){return a}function V(a){a.divRemTo(this.m,null,a)}function W(a,b,c){a.multiplyTo(b,c),this.reduce(c)}function X(a,b){a.squareTo(b),this.reduce(b)}function Y(){if(this.t<1)return 0;var a=this[0];if(0==(1&a))return 0;var b=3&a;return b=b*(2-(15&a)*b)&15,b=b*(2-(255&a)*b)&255,b=b*(2-((65535&a)*b&65535))&65535,b=b*(2-a*b%this.DV)%this.DV,b>0?this.DV-b:-b}function Z(a){this.m=a,this.mp=a.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<a.DB-15)-1,this.mt2=2*a.t}function $(a){var b=r();return a.abs().dlShiftTo(this.m.t,b),b.divRemTo(this.m,null,b),a.s<0&&b.compareTo(q.ZERO)>0&&this.m.subTo(b,b),b}function _(a){var b=r();return a.copyTo(b),this.reduce(b),b}function aa(a){for(;a.t<=this.mt2;)a[a.t++]=0;for(var b=0;b<this.m.t;++b){var c=32767&a[b],d=c*this.mpl+((c*this.mph+(a[b]>>15)*this.mpl&this.um)<<15)&a.DM;for(c=b+this.m.t,a[c]+=this.m.am(0,d,a,b,0,this.m.t);a[c]>=a.DV;)a[c]-=a.DV,a[++c]++}a.clamp(),a.drShiftTo(this.m.t,a),a.compareTo(this.m)>=0&&a.subTo(this.m,a)}function ba(a,b){a.squareTo(b),this.reduce(b)}function ca(a,b,c){a.multiplyTo(b,c),this.reduce(c)}function da(){return 0==(this.t>0?1&this[0]:this.s)}function ea(a,b){if(a>4294967295||1>a)return q.ONE;var c=r(),d=r(),e=b.convert(this),f=H(a)-1;for(e.copyTo(c);--f>=0;)if(b.sqrTo(c,d),(a&1<<f)>0)b.mulTo(d,e,c);else{var g=c;c=d,d=g}return b.revert(c)}function fa(a,b){var c;return c=256>a||b.isEven()?new S(b):new Z(b),this.exp(a,c)}function ga(){var a=r();return this.copyTo(a),a}function ha(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function ia(){return 0==this.t?this.s:this[0]<<24>>24}function ja(){return 0==this.t?this.s:this[0]<<16>>16}function ka(a){return Math.floor(Math.LN2*this.DB/Math.log(a))}function la(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1}function ma(a){if(null==a&&(a=10),0==this.signum()||2>a||a>36)return"0";var b=this.chunkSize(a),c=Math.pow(a,b),d=A(c),e=r(),f=r(),g="";for(this.divRemTo(d,e,f);e.signum()>0;)g=(c+f.intValue()).toString(a).substr(1)+g,e.divRemTo(d,e,f);return f.intValue().toString(a)+g}function na(a,b){this.fromInt(0),null==b&&(b=10);for(var c=this.chunkSize(b),d=Math.pow(b,c),e=!1,f=0,g=0,h=0;h<a.length;++h){var i=x(a,h);0>i?"-"==a.charAt(h)&&0==this.signum()&&(e=!0):(g=b*g+i,++f>=c&&(this.dMultiply(d),this.dAddOffset(g,0),f=0,g=0))}f>0&&(this.dMultiply(Math.pow(b,f)),this.dAddOffset(g,0)),e&&q.ZERO.subTo(this,this)}function oa(a,b,c){if("number"==typeof b)if(2>a)this.fromInt(1);else for(this.fromNumber(a,c),this.testBit(a-1)||this.bitwiseTo(q.ONE.shiftLeft(a-1),wa,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(b);)this.dAddOffset(2,0),this.bitLength()>a&&this.subTo(q.ONE.shiftLeft(a-1),this);else{var d=new Array,e=7&a;d.length=(a>>3)+1,b.nextBytes(d),e>0?d[0]&=(1<<e)-1:d[0]=0,this.fromString(d,256)}}function pa(){var a=this.t,b=new Array;b[0]=this.s;var c,d=this.DB-a*this.DB%8,e=0;if(a-->0)for(d<this.DB&&(c=this[a]>>d)!=(this.s&this.DM)>>d&&(b[e++]=c|this.s<<this.DB-d);a>=0;)8>d?(c=(this[a]&(1<<d)-1)<<8-d,c|=this[--a]>>(d+=this.DB-8)):(c=this[a]>>(d-=8)&255,0>=d&&(d+=this.DB,--a)),0!=(128&c)&&(c|=-256),0==e&&(128&this.s)!=(128&c)&&++e,(e>0||c!=this.s)&&(b[e++]=c);return b}function qa(a){return 0==this.compareTo(a)}function ra(a){return this.compareTo(a)<0?this:a}function sa(a){return this.compareTo(a)>0?this:a}function ta(a,b,c){var d,e,f=Math.min(a.t,this.t);for(d=0;f>d;++d)c[d]=b(this[d],a[d]);if(a.t<this.t){for(e=a.s&this.DM,d=f;d<this.t;++d)c[d]=b(this[d],e);c.t=this.t}else{for(e=this.s&this.DM,d=f;d<a.t;++d)c[d]=b(e,a[d]);c.t=a.t}c.s=b(this.s,a.s),c.clamp()}function ua(a,b){return a&b}function va(a){var b=r();return this.bitwiseTo(a,ua,b),b}function wa(a,b){return a|b}function xa(a){var b=r();return this.bitwiseTo(a,wa,b),b}function ya(a,b){return a^b}function za(a){var b=r();return this.bitwiseTo(a,ya,b),b}function Aa(a,b){return a&~b}function Ba(a){var b=r();return this.bitwiseTo(a,Aa,b),b}function Ca(){for(var a=r(),b=0;b<this.t;++b)a[b]=this.DM&~this[b];return a.t=this.t,a.s=~this.s,a}function Da(a){var b=r();return 0>a?this.rShiftTo(-a,b):this.lShiftTo(a,b),b}function Ea(a){var b=r();return 0>a?this.lShiftTo(-a,b):this.rShiftTo(a,b),b}function Fa(a){if(0==a)return-1;var b=0;return 0==(65535&a)&&(a>>=16,b+=16),0==(255&a)&&(a>>=8,b+=8),0==(15&a)&&(a>>=4,b+=4),0==(3&a)&&(a>>=2,b+=2),0==(1&a)&&++b,b}function Ga(){for(var a=0;a<this.t;++a)if(0!=this[a])return a*this.DB+Fa(this[a]);return this.s<0?this.t*this.DB:-1}function Ha(a){for(var b=0;0!=a;)a&=a-1,++b;return b}function Ia(){for(var a=0,b=this.s&this.DM,c=0;c<this.t;++c)a+=Ha(this[c]^b);return a}function Ja(a){var b=Math.floor(a/this.DB);return b>=this.t?0!=this.s:0!=(this[b]&1<<a%this.DB)}function Ka(a,b){var c=q.ONE.shiftLeft(a);return this.bitwiseTo(c,b,c),c}function La(a){return this.changeBit(a,wa)}function Ma(a){return this.changeBit(a,Aa)}function Na(a){return this.changeBit(a,ya)}function Oa(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);e>c;)d+=this[c]+a[c],b[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d+=a.s;c<this.t;)d+=this[c],b[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d+=a[c],b[c++]=d&this.DM,d>>=this.DB;d+=a.s}b.s=0>d?-1:0,d>0?b[c++]=d:-1>d&&(b[c++]=this.DV+d),b.t=c,b.clamp()}function Pa(a){var b=r();return this.addTo(a,b),b}function Qa(a){var b=r();return this.subTo(a,b),b}function Ra(a){var b=r();return this.multiplyTo(a,b),b}function Sa(){var a=r();return this.squareTo(a),a}function Ta(a){var b=r();return this.divRemTo(a,b,null),b}function Ua(a){var b=r();return this.divRemTo(a,null,b),b}function Va(a){var b=r(),c=r();return this.divRemTo(a,b,c),new Array(b,c)}function Wa(a){this[this.t]=this.am(0,a-1,this,0,0,this.t),++this.t,this.clamp()}function Xa(a,b){if(0!=a){for(;this.t<=b;)this[this.t++]=0;for(this[b]+=a;this[b]>=this.DV;)this[b]-=this.DV,++b>=this.t&&(this[this.t++]=0),++this[b]}}function Ya(){}function Za(a){return a}function $a(a,b,c){a.multiplyTo(b,c)}function _a(a,b){a.squareTo(b)}function ab(a){return this.exp(a,new Ya)}function bb(a,b,c){var d=Math.min(this.t+a.t,b);for(c.s=0,c.t=d;d>0;)c[--d]=0;var e;for(e=c.t-this.t;e>d;++d)c[d+this.t]=this.am(0,a[d],c,d,0,this.t);for(e=Math.min(a.t,b);e>d;++d)this.am(0,a[d],c,d,0,b-d);c.clamp()}function cb(a,b,c){--b;var d=c.t=this.t+a.t-b;for(c.s=0;--d>=0;)c[d]=0;for(d=Math.max(b-this.t,0);d<a.t;++d)c[this.t+d-b]=this.am(b-d,a[d],c,0,0,this.t+d-b);c.clamp(),c.drShiftTo(1,c)}function db(a){this.r2=r(),this.q3=r(),q.ONE.dlShiftTo(2*a.t,this.r2),this.mu=this.r2.divide(a),this.m=a}function eb(a){if(a.s<0||a.t>2*this.m.t)return a.mod(this.m);if(a.compareTo(this.m)<0)return a;var b=r();return a.copyTo(b),this.reduce(b),b}function fb(a){return a}function gb(a){for(a.drShiftTo(this.m.t-1,this.r2),a.t>this.m.t+1&&(a.t=this.m.t+1,a.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);a.compareTo(this.r2)<0;)a.dAddOffset(1,this.m.t+1);for(a.subTo(this.r2,a);a.compareTo(this.m)>=0;)a.subTo(this.m,a)}function hb(a,b){a.squareTo(b),this.reduce(b)}function ib(a,b,c){a.multiplyTo(b,c),this.reduce(c)}function jb(a,b){var c,d,e=a.bitLength(),f=A(1);if(0>=e)return f;c=18>e?1:48>e?3:144>e?4:768>e?5:6,d=8>e?new S(b):b.isEven()?new db(b):new Z(b);var g=new Array,h=3,i=c-1,j=(1<<c)-1;if(g[1]=d.convert(this),c>1){var k=r();for(d.sqrTo(g[1],k);j>=h;)g[h]=r(),d.mulTo(k,g[h-2],g[h]),h+=2}var l,m,n=a.t-1,o=!0,p=r();for(e=H(a[n])-1;n>=0;){for(e>=i?l=a[n]>>e-i&j:(l=(a[n]&(1<<e+1)-1)<<i-e,n>0&&(l|=a[n-1]>>this.DB+e-i)),h=c;0==(1&l);)l>>=1,--h;if((e-=h)<0&&(e+=this.DB,--n),o)g[l].copyTo(f),o=!1;else{for(;h>1;)d.sqrTo(f,p),d.sqrTo(p,f),h-=2;h>0?d.sqrTo(f,p):(m=f,f=p,p=m),d.mulTo(p,g[l],f)}for(;n>=0&&0==(a[n]&1<<e);)d.sqrTo(f,p),m=f,f=p,p=m,--e<0&&(e=this.DB-1,--n)}return d.revert(f)}function kb(a){var b=this.s<0?this.negate():this.clone(),c=a.s<0?a.negate():a.clone();if(b.compareTo(c)<0){var d=b;b=c,c=d}var e=b.getLowestSetBit(),f=c.getLowestSetBit();if(0>f)return b;for(f>e&&(f=e),f>0&&(b.rShiftTo(f,b),c.rShiftTo(f,c));b.signum()>0;)(e=b.getLowestSetBit())>0&&b.rShiftTo(e,b),(e=c.getLowestSetBit())>0&&c.rShiftTo(e,c),b.compareTo(c)>=0?(b.subTo(c,b),b.rShiftTo(1,b)):(c.subTo(b,c),c.rShiftTo(1,c));return f>0&&c.lShiftTo(f,c),c}function lb(a){if(0>=a)return 0;var b=this.DV%a,c=this.s<0?a-1:0;if(this.t>0)if(0==b)c=this[0]%a;else for(var d=this.t-1;d>=0;--d)c=(b*c+this[d])%a;return c}function mb(a){var b=a.isEven();if(this.isEven()&&b||0==a.signum())return q.ZERO;for(var c=a.clone(),d=this.clone(),e=A(1),f=A(0),g=A(0),h=A(1);0!=c.signum();){for(;c.isEven();)c.rShiftTo(1,c),b?(e.isEven()&&f.isEven()||(e.addTo(this,e),f.subTo(a,f)),e.rShiftTo(1,e)):f.isEven()||f.subTo(a,f),f.rShiftTo(1,f);for(;d.isEven();)d.rShiftTo(1,d),b?(g.isEven()&&h.isEven()||(g.addTo(this,g),h.subTo(a,h)),g.rShiftTo(1,g)):h.isEven()||h.subTo(a,h),h.rShiftTo(1,h);c.compareTo(d)>=0?(c.subTo(d,c),b&&e.subTo(g,e),f.subTo(h,f)):(d.subTo(c,d),b&&g.subTo(e,g),h.subTo(f,h))}return 0!=d.compareTo(q.ONE)?q.ZERO:h.compareTo(a)>=0?h.subtract(a):h.signum()<0?(h.addTo(a,h),h.signum()<0?h.add(a):h):h}function nb(a){var b,c=this.abs();if(1==c.t&&c[0]<=Ic[Ic.length-1]){for(b=0;b<Ic.length;++b)if(c[0]==Ic[b])return!0;return!1}if(c.isEven())return!1;for(b=1;b<Ic.length;){for(var d=Ic[b],e=b+1;e<Ic.length&&Jc>d;)d*=Ic[e++];for(d=c.modInt(d);e>b;)if(d%Ic[b++]==0)return!1}return c.millerRabin(a)}function ob(a){var b=this.subtract(q.ONE),c=b.getLowestSetBit();if(0>=c)return!1;var d=b.shiftRight(c);a=a+1>>1,a>Ic.length&&(a=Ic.length);for(var e=r(),f=0;a>f;++f){e.fromInt(Ic[Math.floor(Math.random()*Ic.length)]);var g=e.modPow(d,this);if(0!=g.compareTo(q.ONE)&&0!=g.compareTo(b)){for(var h=1;h++<c&&0!=g.compareTo(b);)if(g=g.modPowInt(2,this),0==g.compareTo(q.ONE))return!1;if(0!=g.compareTo(b))return!1}}return!0}function pb(){this.i=0,this.j=0,this.S=new Array}function qb(a){var b,c,d;for(b=0;256>b;++b)this.S[b]=b;for(c=0,b=0;256>b;++b)c=c+this.S[b]+a[b%a.length]&255,d=this.S[b],this.S[b]=this.S[c],this.S[c]=d;this.i=0,this.j=0}function rb(){var a;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,a=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=a,this.S[a+this.S[this.i]&255]}function sb(){return new pb}function tb(a){Lc[Mc++]^=255&a,Lc[Mc++]^=a>>8&255,Lc[Mc++]^=a>>16&255,Lc[Mc++]^=a>>24&255,Mc>=Nc&&(Mc-=Nc)}function ub(){tb((new Date).getTime())}function vb(){if(null==Kc){for(ub(),Kc=sb(),Kc.init(Lc),Mc=0;Mc<Lc.length;++Mc)Lc[Mc]=0;Mc=0}return Kc.next()}function wb(a){var b;for(b=0;b<a.length;++b)a[b]=vb()}function xb(){}function yb(a,b){return new q(a,b)}function zb(a,b){if(b<a.length+11)return null;for(var c=new Array,d=a.length-1;d>=0&&b>0;){var e=a.charCodeAt(d--);128>e?c[--b]=e:e>127&&2048>e?(c[--b]=63&e|128,c[--b]=e>>6|192):(c[--b]=63&e|128,c[--b]=e>>6&63|128,c[--b]=e>>12|224)}c[--b]=0;for(var f=new xb,g=new Array;b>2;){for(g[0]=0;0==g[0];)f.nextBytes(g);c[--b]=g[0]}return c[--b]=2,c[--b]=0,new q(c)}function Ab(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function Bb(a,b){this.n=yb(a,16),this.e=parseInt(b,16)}function Cb(a){return a.modPowInt(this.e,this.n)}function Db(a){var b=zb(a,this.n.bitLength()+7>>3);if(null==b)return null;var c=this.doPrivate(b);if(null==c)return null;var d=c.toString(16);return 0==(1&d.length)?d:"0"+d}function Eb(a,b){for(var c=a.toByteArray(),d=0;d<c.length&&0==c[d];)++d;if(c.length-d!=b-1||2!=c[d])return null;for(++d;0!=c[d];)if(++d>=c.length)return null;for(var e="";++d<c.length;){var f=255&c[d];128>f?e+=String.fromCharCode(f):f>191&&224>f?(e+=String.fromCharCode((31&f)<<6|63&c[d+1]),++d):(e+=String.fromCharCode((15&f)<<12|(63&c[d+1])<<6|63&c[d+2]),d+=2)}return e}function Fb(a,b,c){this.n=yb(a,16),this.e=parseInt(b,16),this.d=yb(c,16)}function Gb(a,b,c,d,e,f,g,h){this.n=yb(a,16),this.e=parseInt(b,16),this.d=yb(c,16),this.p=yb(d,16),this.q=yb(e,16),this.dmp1=yb(f,16),this.dmq1=yb(g,16),this.coeff=yb(h,16)}function Hb(a){if(null==this.p||null==this.q)return a.modPow(this.d,this.n);for(var b=a.mod(this.p).modPow(this.dmp1,this.p),c=a.mod(this.q).modPow(this.dmq1,this.q);b.compareTo(c)<0;)b=b.add(this.p);return b.subtract(c).multiply(this.coeff).mod(this.p).multiply(this.q).add(c)}function Ib(a){var b=yb(a,16),c=this.doPublic(b);return null==c?null:Eb(c,this.n.bitLength()+7>>3)}function Jb(a,b){a.diffuse.value=b.color,a.opacity.value=b.opacity}function Kb(a,b){a.dashSize.value=b.dashSize,a.totalSize.value=b.dashSize+b.gapSize,a.scale.value=b.scale}function Lb(a,b){a.psColor.value=b.color,a.opacity.value=b.opacity,a.size.value=b.size,a.scale.value=b.scale||1,a.map.value=b.map}function Mb(a,b){return a.distance-b.distance}function Nb(a,b,c,d,e){(a instanceof Yb.Node||a instanceof Yb.Billboard)&&Pb(a,b,c,d,e)}function Ob(a,b,c,d,f){if(a!==e)for(var g=a.getDescendants(),h=0,i=g.length;i>h;h++)Nb(g[h],b,c,d,f)}function Pb(a,b,c,d,f){if(d||0!=f.isVisible(a)){if(a instanceof Yb.Billboard){var g=b.matrixPosition;g.setFromMatrixPosition(a.worldMatrix);var h=b.ray.distanceToPoint(g),i=a.material.alignment,j=new Yb.Plane(1,1);(i.x||i.y)&&(j.setPosition(i.x,i.y,0),j=Yb.Utils.transformElement(j,!0)),j.setPosition(g);var k=(new $b).getScaleFromMatrix(a.worldMatrix);j.setScale(k.x,k.y,1);var l=b.direction.clone(),m=j.getPosition().clone(),n=a.material;n&&n.vertical&&(l.y=0),m.sub(l),j.lookAt(m),j.updateWorldMatrix(!0);var o=[];return Pb(j,b,o,!0,f),0===o.length?c:(c.push({distance:o[0].distance,point:a._position,face:null,object:a,element:a}),c)}if(a instanceof Yb.Line){var p=1;p-=1;var q=Math.sqrt(b.linePrecision+p),r=q*q,s=a;if(null==s.boundingSphere&&s.computeBoundingSphere(),ed.copy(s.boundingSphere),ed.applyMatrix4(a.worldMatrix),b.ray.isIntersectionSphere(ed)===!1)return c;bd.getInverse(a.worldMatrix),ad.copy(b.ray).transform(bd);for(var t=s.vertices,u=t.length,v=new $b,w=new $b,x=a.type===Yb.LineStrip?1:2,y=0;u-1>y;y+=x){var z=ad.distanceSqToSegment(t[y],t[y+1],w,v);if(!(z>r)){var h=ad.origin.distanceTo(w);h<b.near||h>b.far||c.push({distance:h,point:v.clone().applyMatrix4(a.worldMatrix),face:null,faceIndex:null,element:a,object:a})}}return c}if(null===a.boundingSphere&&a.computeBoundingSphere(),ed.set(a.worldMatrix.getPosition(),a.boundingSphere.radius*a.worldMatrix.getMaxScaleOnAxis()),!b.ray.isIntersectionSphere(ed))return c;var A,B,C,D,s=a,t=s.vertices,E=a.material instanceof Yb.ArrayMaterial,F=E===!0?a.material.materials:null,G=a.material.side,q=b.precision;a.rotationWorldMatrix.extractRotation(a.worldMatrix),bd.getInverse(a.worldMatrix),ad.copy(b.ray).transform(bd);for(var H=0,I=s.faces.length;I>H;H++){var J=s.faces[H],K=E===!0?F[J.materialIndex]:a.material,L=f.getOverLoadMaterial(a,K);if(L&&(K=L),!(K===e||K.visible===!1||s.visible===!1&&!d||K.transparent&&0==K.opacity)){cd.setFromNormalAndCoplanarPoint(J.normal,t[J.a]);var M=ad.distanceToPlane(cd);if(!(Math.abs(M)<q||0>M)){G=K.side;var N=ad.direction.dot(cd.normal);if((G===Yb.DoubleSide||(G===Yb.FrontSide?0>N:N>0))&&!(M<b.near||M>b.far)){dd=ad.at(M,dd);var O,P=new $b,Q=(J.materialIndex,!1);if(f&&f._selectTransparencyThreshold>0&&(Q=1==K.transparent||K.alphaTest>0),J instanceof Yb.Face3){if(A=t[J.a],B=t[J.b],C=t[J.c],!Yb.Triangle.containsPoint(dd,A,B,C))continue;P=Yb.Triangle.barycoordFromPoint(dd,A,B,C)}else{if(!(J instanceof Yb.Face4))throw Error("face type not supported");A=t[J.a],B=t[J.b],C=t[J.c],D=t[J.d];var R=Yb.Triangle.containsPoint(dd,A,B,D),S=Yb.Triangle.containsPoint(dd,B,C,D);if(!R&&!S)continue;R?P=Yb.Triangle.barycoordFromPoint(dd,A,B,D):(P=Yb.Triangle.barycoordFromPoint(dd,B,C,D),O=!0)}var T=new Zb,U=P.z,V=P.x,W=P.y;if(s.uvs&&s.uvs[H]){var X=s.uvs[H];J instanceof Yb.Face3?(T.x=X[0].x*V+X[1].x*W+X[2].x*U,T.y=X[0].y*V+X[1].y*W+X[2].y*U):O?(T.x=X[1].x*V+X[2].x*W+X[3].x*U,T.y=X[1].y*V+X[2].y*W+X[3].y*U):(T.x=X[0].x*V+X[1].x*W+X[3].x*U,T.y=X[0].y*V+X[1].y*W+X[3].y*U)}var Y,Z=1;if(T=f.debugUV||T,Q){if(K.opacity<f._selectTransparencyThreshold)continue;if(null==K.map)Z=K.opacity;else{Y=K.map._image;var $=sc.getPixelFromImage(Y,T.x,T.y);Z=$[3]/255*(null==K.opacity?1:K.opacity)}Z<K.alphaTest?Z=0:0==K.transparent&&(Z=1)}Z<f._selectTransparencyThreshold||c.push({distance:M,point:b.ray.at(M),face:J,uv:T,faceIndex:H,element:a,object:a,side:N>0?1:-1})}}}}}}function Qb(a){if(!pd[a.id]){if(rd=!0,pd[a.id]=a,a.finish=null==a.finish?a.delay+a.dur+a.interval:a.finish,null==a.from&&a.attr&&a.source){var b;(b=a.attr.match(/^S[:@](.*)/i))?a.from=a.source.getStyle(b[1]):(b=a.attr.match(/^C[:@](.*)/i))?a.from=a.source.getClient(b[1]):a.from=mono.getValue(a.source,a.attr)}Rb(a),Sb(a)}return a}function Rb(a){var b=a.type,c=a.from,d=a.to;"number"===b?(a.from=c||0,a.to=d||0):"point"===b?(c?c.length&&(a.from={x:c[0],y:c[1]}):a.from="scale"===a.attr?{x:1,y:1}:{x:0,y:0},d?d.length&&(a.to={x:d[0],y:d[1]}):a.to="scale"===a.attr?{x:1,y:1}:{x:0,y:0}):"rect"===b?(c?c.length&&(a.from={x:c[0],y:c[1],w:c[2],h:c[3]}):a.from={x:0,y:0,w:0,h:0},d?d.length&&(a.to={x:d[0],y:d[1],w:d[2],h:d[3]}):a.to={x:0,y:0,w:0,h:0}):"color"===b&&(a.from=getColorValue(c),a.to=getColorValue(d)),a.current=a.from}function Sb(a){var b=a.type,c=a.from,d=a.to;"number"===b?a.delta=d-c:"point"===b?a.delta={x:d.x-c.x,y:d.y-c.y}:"rect"===b?a.delta={x:d.x-c.x,y:d.y-c.y,w:d.w-c.w,h:d.h-c.h}:"color"===b&&(a.delta={r:d.r-c.r,g:d.g-c.g,b:d.b-c.b,a:d.a-c.a})}function Tb(a,b){return pd[a.id]&&(null==b&&(b=!0),b&&Xb(a,a.to),a.onStop&&a.onStop(),a.time=0,a.total=0,a.start=null,a.count=0,a.started=!1,a.stopped=!1,delete pd[a.id]),a}function Ub(a){null==a&&(a=!0),Object.keys(pd).forEach(function(b){var c=pd[b];a&&Xb(c,c.to),c.onStop&&c.onStop()}),pd={}}function Vb(a){Object.keys(pd).forEach(function(b){var c=pd[b];if(c){if(null==c.start&&(c.start=a),c.total=a-c.start,c.total>c.delay){c.time=c.total-c.delay;var d=!1;if(c.time>=c.dur&&(c.time=c.dur,d=!0),!c.stopped&&Xb(c,Wb(c)),c.stopped=d,c.total>=c.finish)if(c.count++,c.count>=c.repeat)Tb(c,!1),c.onDone&&c.onDone();else if(c.time=0,c.total=0,c.start=null,c.stopped=!1,c.reverse){var e=c.from;c.from=c.to,c.to=e,Sb(c)}}!rd&&(rd=!0)}})}function Wb(a,b){var c=a.type,d=a.delta,e=a.from,f=a.time,g=a.dur,h=jc[a.easing||"easeNone"];return h||(h=jc.easeNone),"number"===c?b=h(f,e,d,g):"point"===c?b={x:h(f,e.x,d.x,g),y:h(f,e.y,d.y,g)}:"rect"===c?b={x:h(f,e.x,d.x,g),y:h(f,e.y,d.y,g),w:h(f,e.w,d.w,g),h:h(f,e.h,d.h,g)}:"color"===c?b="rgba("+Math.floor(h(f,e.r,d.r,g))+","+Math.floor(h(f,e.g,d.g,g))+","+Math.floor(h(f,e.b,d.b,g))+","+Math.floor(h(f,e.a,d.a,g))+")":"set"===c?a.time&&(b=a.to):"group_set"===c&&(b=a.to[a.groupIndex]),a.current=b,b}function Xb(a,b){if(a.started||(a.started=!0,a.onPlay&&a.onPlay()),a.filter&&(b=a.filter(b)),a.attr&&a.source){var c;(c=a.attr.match(/^S[:@](.*)/i))?a.source.setStyle(c[1],b):(c=a.attr.match(/^C[:@](.*)/i))?a.source.setClient(c[1],b):mono.setValue(a.source,a.attr,b)}a.onUpdate&&a.onUpdate(b)}self.Int32Array=self.Int32Array||Array,self.Float32Array=self.Float32Array||Array,Object.create=Object.create||function(a){
var b=function(){};return b.prototype=a,new b};var Yb={version:"2.0.7",_id:["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"],id:function(a){a=null==a?"":a;for(var b=[],c=0;32>c;c++)b[c]=this._id[Math.floor(16*Math.random())];return b[12]="4",b[16]=this._id[3&b[16]|8],a+b.join("")},ip:function(a,b,c,d){var e=c+b;a[Yb.getter(b,d)]=function(){return this[e]},a[Yb.setter(b)]=function(a){var c=this[e];c!==a&&(this.setPropertyValue?this.setPropertyValue(e,a)&&(this.onPropertyChange(b,c,a),this.firePropertyChange(b,c,a)):(this[e]=a,this.onPropertyChange(b,c,a),this.firePropertyChange(b,c,a)))}},getter:function(a,b){var c=a.charAt(0).toUpperCase()+a.slice(1),d=/ble$/.test(a)||/ed$/.test(a)?"is":"get";return b&&-1!=b.indexOf(a)&&(d="is"),d+c},setter:function(a){var b=a.charAt(0).toUpperCase()+a.slice(1);return"set"+b},getValue:function(a,b,c){var d=b.charAt(0).toUpperCase()+b.slice(1),e="get"+d,f="is"+d;return c?"boolean"===c?a[f]():(null==a[e]&&console.log("get Function "+e+" not exist"),a[e]()):a[e]?a[e]():a[f]?a[f]():a[b]},setValue:function(a,b,c){a["set"+b.charAt(0).toUpperCase()+b.slice(1)](c)},clone:function(a){if(!a)return null;var b={};for(var c in a)b[c]=a[c];return b},addMethod:function(a,b){var c=a.prototype;for(var d in b)c[d]=b[d]},classCache:{},getClass:function(a){var b=Yb.classCache[a];if(!b){var c=a.split("."),e=c.length;b=d;for(var f=0;e>f;f++)b=b[c[f]];Yb.classCache[a]=b}return b},newInstance:function(a){"string"==typeof a&&(a=Yb.getClass(a),a=a.prototype);var b=a.constructor;if(!b)return null;var c=arguments.length,d=arguments;if(1===c)return new b;if(2===c)return new b(d[1]);if(3===c)return new b(d[1],d[2]);if(4===c)return new b(d[1],d[2],d[3]);if(5===c)return new b(d[1],d[2],d[3],d[4]);if(6===c)return new b(d[1],d[2],d[3],d[4],d[5]);if(7===c)return new b(d[1],d[2],d[3],d[4],d[5],d[6]);if(8===c)return new b(d[1],d[2],d[3],d[4],d[5],d[6],d[7]);throw"don't support args more than 7"},xml:function(a){if(d.DOMParser)return(new DOMParser).parseFromString(a,"text/xml");var b=new ActiveXObject("Microsoft.XmlDOM");return b.async=!1,b.loadXml(a),b}};d.TGL=Yb,d.mono=Yb;Yb.extend=function(a,b,c){if(b){var d=function(){};d.prototype=b.prototype,a.prototype=new d,a.prototype.constructor=a,a.superClass=b.prototype,b.prototype.constructor==Object.prototype.constructor&&(b.prototype.constructor=b)}var e=a.prototype;if(c){e.getClassName=function(){return c.className};for(var f in c){if("__accessor"===f)for(var g=c.__accessor,h=c.__bool,i=0;i<g.length;i++){var j=g[i];Yb.ip(e,j,"",h)}else if("___accessor"===f)for(var g=c.___accessor,i=0;i<g.length;i++){var j=g[i];Yb.ip(e,j,"_",h)}e[f]=c[f]}c.constructor&&(e.newInstance=function(){return Yb.newInstance(this)})}},Yb.defaultEulerOrder="XYZ",String.prototype.startsWith=String.prototype.startsWith||function(a){return this.slice(0,a.length)===a},String.prototype.endsWith=String.prototype.endsWith||function(a){var b=String(a),c=this.lastIndexOf(b);return(c>-1&&c)===this.length-b.length},String.prototype.trim=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")},function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!d.requestAnimationFrame;++c)d.requestAnimationFrame=d[b[c]+"RequestAnimationFrame"],d.cancelAnimationFrame=d[b[c]+"CancelAnimationFrame"]||d[b[c]+"CancelRequestAnimationFrame"];d.requestAnimationFrame===e&&(d.requestAnimationFrame=function(b,c){var e=Date.now(),f=Math.max(0,16-(e-a)),g=d.setTimeout(function(){b(e+f)},f);return a=e+f,g}),d.cancelAnimationFrame=d.cancelAnimationFrame||function(a){d.clearTimeout(a)}}(),Yb.CullFaceNone=0,Yb.CullFaceBack=1,Yb.CullFaceFront=2,Yb.CullFaceFrontBack=3,Yb.FrontFaceDirectionCW=0,Yb.FrontFaceDirectionCCW=1,Yb.BasicShadowMap=0,Yb.PCFShadowMap=1,Yb.PCFSoftShadowMap=2,Yb.FrontSide="front",Yb.BackSide="back",Yb.DoubleSide="both",Yb.BothSide="both",Yb.NoShading=0,Yb.FlatShading=1,Yb.SmoothShading=2,Yb.NormalTypeFlat="flat",Yb.NormalTypeSmooth="smooth",Yb.NoColors=0,Yb.FaceColors=1,Yb.VertexColors=2,Yb.NoBlending=0,Yb.NormalBlending=1,Yb.AdditiveBlending=2,Yb.SubtractiveBlending=3,Yb.MultiplyBlending=4,Yb.CustomBlending=5,Yb.AddEquation=100,Yb.SubtractEquation=101,Yb.ReverseSubtractEquation=102,Yb.ZeroFactor=200,Yb.OneFactor=201,Yb.SrcColorFactor=202,Yb.OneMinusSrcColorFactor=203,Yb.SrcAlphaFactor=204,Yb.OneMinusSrcAlphaFactor=205,Yb.DstAlphaFactor=206,Yb.OneMinusDstAlphaFactor=207,Yb.DstColorFactor=208,Yb.OneMinusDstColorFactor=209,Yb.SrcAlphaSaturateFactor=210,Yb.MultiplyOperation=0,Yb.MixOperation=1,Yb.AddOperation=2,Yb.UVMapping=function(){},Yb.CubeReflectionMapping=function(){},Yb.CubeRefractionMapping=function(){},Yb.SphericalReflectionMapping=function(){},Yb.SphericalRefractionMapping=function(){},Yb.RepeatWrapping="repeat",Yb.ClampToEdgeWrapping="clamp",Yb.MirroredRepeatWrapping="mirrored",Yb.NearestFilter=1003,Yb.NearestMipMapNearestFilter=1004,Yb.NearestMipMapLinearFilter=1005,Yb.LinearFilter=1006,Yb.LinearMipMapNearestFilter=1007,Yb.LinearMipMapLinearFilter=1008,Yb.UnsignedByteType=1009,Yb.ByteType=1010,Yb.ShortType=1011,Yb.UnsignedShortType=1012,Yb.IntType=1013,Yb.UnsignedIntType=1014,Yb.FloatType=1015,Yb.UnsignedShort4444Type=1016,Yb.UnsignedShort5551Type=1017,Yb.UnsignedShort565Type=1018,Yb.AlphaFormat=1019,Yb.RGBFormat=1020,Yb.RGBAFormat=1021,Yb.LuminanceFormat=1022,Yb.LuminanceAlphaFormat=1023,Yb.RGB_S3TC_DXT1_Format=2001,Yb.RGBA_S3TC_DXT1_Format=2002,Yb.RGBA_S3TC_DXT3_Format=2003,Yb.RGBA_S3TC_DXT5_Format=2004,Yb.Gradient_Linear_U=1,Yb.Gradient_Linear_V=2,Yb.Gradient_Linear_UV=3,Yb.Gradient_Linear_NUV=4,Yb.Gradient_Radial=5,Yb.Gradient_Sweep=6,Yb.Math={clamp:function(a,b,c){return b>a?b:a>c?c:a},isConcave:function(a,b,c){var d=c?1:-1;return(a.x*b.y-b.x*a.y)*d<0?!0:!1},area:function(a,b,c,d){var f=d?1:-1;if(!a||!b||!c)return e;var g=-a.x*b.y-b.x*c.y-c.x*a.y+c.x*b.y+b.x*a.y+a.x*c.y;return g*f},isClockwise:function(a,b,c){b=b||"x",c=c||"y";for(var d=0,e=a.length,f=0;e>f;f++){var g=a[f],h=a[f+1===e?0:f+1];d+=(h[b]-g[b])*(h[c]+g[c])}return 0>d},isClockwise3:function(a,b,c){(new mono.Vec3).crossVectors(a,b),(new mono.Vec3).subVectors(b,a),(new mono.Vec3).subVectors(b,a)},clampBottom:function(a,b){return b>a?b:a},mapLinear:function(a,b,c,d,e){return d+(a-b)*(e-d)/(c-b)},random16:function(){return(65280*Math.random()+255*Math.random())/65535},randInt:function(a,b){return a+Math.floor(Math.random()*(b-a+1))},randFloat:function(a,b){return a+Math.random()*(b-a)},randFloatSpread:function(a){return a*(.5-Math.random())},sign:function(a){return 0>a?-1:a>0?1:0},degToRad:function(a){return a*Yb.Math.__d2r},radToDeg:function(a){return a*Yb.Math.__r2d},smoothstep:function(a,b,c){return b>=a?0:a>=c?1:(a=(a-b)/(c-b),a*a*(3-2*a))},smootherstep:function(a,b,c){return b>=a?0:a>=c?1:(a=(a-b)/(c-b),a*a*a*(a*(6*a-15)+10))},PI2:2*Math.PI,generateUUID:function(){var a,b="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),c=new Array(36),d=0;return function(){for(var e=0;36>e;e++)8==e||13==e||18==e||23==e?c[e]="-":14==e?c[e]="4":(2>=d&&(d=33554432+16777216*Math.random()|0),a=15&d,d>>=4,c[e]=b[19==e?3&a|8:a]);return c.join("")}}()},Yb.Math.__d2r=Math.PI/180,Yb.Math.__r2d=180/Math.PI,Yb.Quat=function(a,b,c,d){this.x=a||0,this.y=b||0,this.z=c||0,this.w=d!==e?d:1},Yb.Quat.prototype={constructor:Yb.Quat,set:function(a,b,c,d){return this.x=a,this.y=b,this.z=c,this.w=d,this},copy:function(a){return this.x=a.x,this.y=a.y,this.z=a.z,this.w=a.w,this},setFromEuler:function(a,b){var c=Math.cos(a.x/2),d=Math.cos(a.y/2),f=Math.cos(a.z/2),g=Math.sin(a.x/2),h=Math.sin(a.y/2),i=Math.sin(a.z/2);return b===e||"XYZ"===b?(this.x=g*d*f+c*h*i,this.y=c*h*f-g*d*i,this.z=c*d*i+g*h*f,this.w=c*d*f-g*h*i):"YXZ"===b?(this.x=g*d*f+c*h*i,this.y=c*h*f-g*d*i,this.z=c*d*i-g*h*f,this.w=c*d*f+g*h*i):"ZXY"===b?(this.x=g*d*f-c*h*i,this.y=c*h*f+g*d*i,this.z=c*d*i+g*h*f,this.w=c*d*f-g*h*i):"ZYX"===b?(this.x=g*d*f-c*h*i,this.y=c*h*f+g*d*i,this.z=c*d*i-g*h*f,this.w=c*d*f+g*h*i):"YZX"===b?(this.x=g*d*f+c*h*i,this.y=c*h*f+g*d*i,this.z=c*d*i-g*h*f,this.w=c*d*f-g*h*i):"XZY"===b&&(this.x=g*d*f-c*h*i,this.y=c*h*f-g*d*i,this.z=c*d*i+g*h*f,this.w=c*d*f+g*h*i),this},setFromAxisAngle:function(a,b){var c=b/2,d=Math.sin(c);return this.x=a.x*d,this.y=a.y*d,this.z=a.z*d,this.w=Math.cos(c),this},setFromRotationMatrix:function(a){var b,c=a.elements,d=c[0],e=c[4],f=c[8],g=c[1],h=c[5],i=c[9],j=c[2],k=c[6],l=c[10],m=d+h+l;return m>0?(b=.5/Math.sqrt(m+1),this.w=.25/b,this.x=(k-i)*b,this.y=(f-j)*b,this.z=(g-e)*b):d>h&&d>l?(b=2*Math.sqrt(1+d-h-l),this.w=(k-i)/b,this.x=.25*b,this.y=(e+g)/b,this.z=(f+j)/b):h>l?(b=2*Math.sqrt(1+h-d-l),this.w=(f-j)/b,this.x=(e+g)/b,this.y=.25*b,this.z=(i+k)/b):(b=2*Math.sqrt(1+l-d-h),this.w=(g-e)/b,this.x=(f+j)/b,this.y=(i+k)/b,this.z=.25*b),this},inverse:function(){return this.conjugate().normalize(),this},conjugate:function(){return this.x*=-1,this.y*=-1,this.z*=-1,this},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},normalize:function(){var a=this.length();return 0===a?(this.x=0,this.y=0,this.z=0,this.w=1):(a=1/a,this.x=this.x*a,this.y=this.y*a,this.z=this.z*a,this.w=this.w*a),this},multiply:function(a){return this.multiplyQuaternions(this,a)},multiplyQuaternions:function(a,b){var c=a.x,d=a.y,e=a.z,f=a.w,g=b.x,h=b.y,i=b.z,j=b.w;return this.x=c*j+f*g+d*i-e*h,this.y=d*j+f*h+e*g-c*i,this.z=e*j+f*i+c*h-d*g,this.w=f*j-c*g-d*h-e*i,this},multiplyVector3:function(a){return console.warn("DEPRECATED: Quat's .multiplyVector3() has been removed. Use is now vector.applyQuaternion( Quat ) instead."),a.applyQuaternion(this)},slerp:function(a,b){var c=this.x,d=this.y,e=this.z,f=this.w,g=f*a.w+c*a.x+d*a.y+e*a.z;if(0>g?(this.w=-a.w,this.x=-a.x,this.y=-a.y,this.z=-a.z,g=-g):this.copy(a),g>=1)return this.w=f,this.x=c,this.y=d,this.z=e,this;var h=Math.acos(g),i=Math.sqrt(1-g*g);if(Math.abs(i)<.001)return this.w=.5*(f+this.w),this.x=.5*(c+this.x),this.y=.5*(d+this.y),this.z=.5*(e+this.z),this;var j=Math.sin((1-b)*h)/i,k=Math.sin(b*h)/i;return this.w=f*j+this.w*k,this.x=c*j+this.x*k,this.y=d*j+this.y*k,this.z=e*j+this.z*k,this},toEuler:function(){var a=this.w*this.w,b=this.x*this.x,c=this.y*this.y,d=this.z*this.z,e=180/Math.PI*Math.atan2(2*(this.y*this.z+this.x*this.w),-b-c+d+a),f=180/Math.PI*Math.asin(-2*(this.x*this.z-this.y*this.w)),g=180/Math.PI*Math.atan2(2*(this.x*this.y+this.z*this.w),b-c-d+a);return[e,f,g]},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z&&a.w===this.w},clone:function(){return new Yb.Quat(this.x,this.y,this.z,this.w)}},Yb.Quat.slerp=function(a,b,c,d){return c.copy(a).slerp(b,d)};var Zb=function(a,b){this.x=a||0,this.y=b||0};Zb.prototype={constructor:Zb,set:function(a,b){return this.x=a,this.y=b,this},setX:function(a){return this.x=a,this},setY:function(a){return this.y=a,this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;default:throw new Error("index is out of range: "+a)}},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+a)}},copy:function(a){return this.x=a.x,this.y=a.y,this},add:function(a){return this.x+=a.x,this.y+=a.y,this},addVectors:function(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this},addScalar:function(a){return this.x+=a,this.y+=a,this},sub:function(a){return this.x-=a.x,this.y-=a.y,this},subVectors:function(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this},multiplyScalar:function(a){return this.x*=a,this.y*=a,this},multiply:function(a){return this.x*=a.x,this.y*=a.y,this},divideScalar:function(a){return 0!==a?(this.x/=a,this.y/=a):this.set(0,0),this},min:function(a){return this.x>a.x&&(this.x=a.x),this.y>a.y&&(this.y=a.y),this},max:function(a){return this.x<a.x&&(this.x=a.x),this.y<a.y&&(this.y=a.y),this},clamp:function(a,b){return this.x<a.x?this.x=a.x:this.x>b.x&&(this.x=b.x),this.y<a.y?this.y=a.y:this.y>b.y&&(this.y=b.y),this},negate:function(){return this.multiplyScalar(-1)},dot:function(a){return this.x*a.x+this.y*a.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x,c=this.y-a.y;return b*b+c*c},setLength:function(a){var b=this.length();return 0!==b&&a!==b&&this.multiplyScalar(a/b),this},lerp:function(a,b){return this.x+=(a.x-this.x)*b,this.y+=(a.y-this.y)*b,this},equals:function(a){return null==a?!1:a.x===this.x&&a.y===this.y},clone:function(){return new Zb(this.x,this.y)}},Yb.Vec2=Zb;var $b=function(a,b,c){this.x=parseFloat(a)||0,this.y=parseFloat(b)||0,this.z=parseFloat(c)||0};Yb.Vec3=$b,$b.prototype={set:function(a,b,c){return this.x=a,this.y=b,this.z=c,this},setX:function(a){return this.x=a,this},setY:function(a){return this.y=a,this},setZ:function(a){return this.z=a,this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;default:throw new Error("index is out of range: "+a)}},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+a)}},center:function(a,b){return this.x=(a.x+b.x)/2,this.y=(a.y+b.y)/2,this.z=(a.z+b.z)/2,this},copy:function(a){return(null==this||null==a)&&console.log("TGL.Vec3.copy this : "+this+" v : "+a),this.x=a.x,this.y=a.y,this.z=a.z,this},add:function(a){return this.x+=a.x,this.y+=a.y,this.z+=a.z,this},addScalar:function(a){return this.x+=a,this.y+=a,this.z+=a,this},addVectors:function(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this.z=a.z+b.z,this},sub:function(a){return this.x-=a.x,this.y-=a.y,this.z-=a.z,this},subVectors:function(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this.z=a.z-b.z,this},multiply:function(a){return this.x*=a.x,this.y*=a.y,this.z*=a.z,this},multiplyScalar:function(a){return this.x*=a,this.y*=a,this.z*=a,this},multiplyVectors:function(a,b){return this.x=a.x*b.x,this.y=a.y*b.y,this.z=a.z*b.z,this},applyMatrix3:function(a){var b=this.x,c=this.y,d=this.z,e=a.elements;return this.x=e[0]*b+e[3]*c+e[6]*d,this.y=e[1]*b+e[4]*c+e[7]*d,this.z=e[2]*b+e[5]*c+e[8]*d,this},applyMatrix4:function(a){var b=this.x,c=this.y,d=this.z,e=a.elements;return this.x=e[0]*b+e[4]*c+e[8]*d+e[12],this.y=e[1]*b+e[5]*c+e[9]*d+e[13],this.z=e[2]*b+e[6]*c+e[10]*d+e[14],this},applyProjection:function(a){var b=this.x,c=this.y,d=this.z,e=a.elements,f=1/(e[3]*b+e[7]*c+e[11]*d+e[15]);return this.x=(e[0]*b+e[4]*c+e[8]*d+e[12])*f,this.y=(e[1]*b+e[5]*c+e[9]*d+e[13])*f,this.z=(e[2]*b+e[6]*c+e[10]*d+e[14])*f,this},applyQuaternion:function(a){var b=this.x,c=this.y,d=this.z,e=a.x,f=a.y,g=a.z,h=a.w,i=h*b+f*d-g*c,j=h*c+g*b-e*d,k=h*d+e*c-f*b,l=-e*b-f*c-g*d;return this.x=i*h+l*-e+j*-g-k*-f,this.y=j*h+l*-f+k*-e-i*-g,this.z=k*h+l*-g+i*-f-j*-e,this},applyEuler:function(a,b){var c=$b.__q1.setFromEuler(a,b);return this.applyQuaternion(c),this},applyAxisAngle:function(a,b){var c=$b.__q1.setFromAxisAngle(a,b);return this.applyQuaternion(c),this},divide:function(a){return this.x/=a.x,this.y/=a.y,this.z/=a.z,this},divideScalar:function(a){return 0!==a?(this.x/=a,this.y/=a,this.z/=a):(this.x=0,this.y=0,this.z=0),this},min:function(a){return this.x>a.x&&(this.x=a.x),this.y>a.y&&(this.y=a.y),this.z>a.z&&(this.z=a.z),this},max:function(a){return this.x<a.x&&(this.x=a.x),this.y<a.y&&(this.y=a.y),this.z<a.z&&(this.z=a.z),this},clamp:function(a,b){return this.x<a.x?this.x=a.x:this.x>b.x&&(this.x=b.x),this.y<a.y?this.y=a.y:this.y>b.y&&(this.y=b.y),this.z<a.z?this.z=a.z:this.z>b.z&&(this.z=b.z),this},negate:function(){return this.multiplyScalar(-1)},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(a){var b=this.length();return 0!==b&&a!==b&&this.multiplyScalar(a/b),this},lerp:function(a,b){return this.x+=(a.x-this.x)*b,this.y+=(a.y-this.y)*b,this.z+=(a.z-this.z)*b,this},lerpVectors:function(a,b,c){return this.x=a.x+(b.x-a.x)*c,this.y=a.y+(b.y-a.y)*c,this.z=a.z+(b.z-a.z)*c,this},cross:function(a){var b=this.x,c=this.y,d=this.z;return this.x=c*a.z-d*a.y,this.y=d*a.x-b*a.z,this.z=b*a.y-c*a.x,this},crossVectors:function(a,b){return this.x=a.y*b.z-a.z*b.y,this.y=a.z*b.x-a.x*b.z,this.z=a.x*b.y-a.y*b.x,this},angleTo:function(a){return Math.acos(this.dot(a)/this.length()/a.length())},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x,c=this.y-a.y,d=this.z-a.z;return b*b+c*c+d*d},getPositionFromMatrix:function(a){return this.x=a.elements[12],this.y=a.elements[13],this.z=a.elements[14],this},setEulerFromRotationMatrix:function(a,b){function c(a){return Math.min(Math.max(a,-1),1)}var d=a.elements,f=d[0],g=d[4],h=d[8],i=d[1],j=d[5],k=d[9],l=d[2],m=d[6],n=d[10];return b===e||"XYZ"===b?(this.y=Math.asin(c(h)),Math.abs(h)<.99999?(this.x=Math.atan2(-k,n),this.z=Math.atan2(-g,f)):(this.x=Math.atan2(m,j),this.z=0)):"YXZ"===b?(this.x=Math.asin(-c(k)),Math.abs(k)<.99999?(this.y=Math.atan2(h,n),this.z=Math.atan2(i,j)):(this.y=Math.atan2(-l,f),this.z=0)):"ZXY"===b?(this.x=Math.asin(c(m)),Math.abs(m)<.99999?(this.y=Math.atan2(-l,n),this.z=Math.atan2(-g,j)):(this.y=0,this.z=Math.atan2(i,f))):"ZYX"===b?(this.y=Math.asin(-c(l)),Math.abs(l)<.99999?(this.x=Math.atan2(m,n),this.z=Math.atan2(i,f)):(this.x=0,this.z=Math.atan2(-g,j))):"YZX"===b?(this.z=Math.asin(c(i)),Math.abs(i)<.99999?(this.x=Math.atan2(-k,j),this.y=Math.atan2(-l,f)):(this.x=0,this.y=Math.atan2(h,n))):"XZY"===b&&(this.z=Math.asin(-c(g)),Math.abs(g)<.99999?(this.x=Math.atan2(m,j),this.y=Math.atan2(h,f)):(this.x=Math.atan2(-k,n),this.y=0)),this},setEulerFromQuaternion:function(a,b){function c(a){return Math.min(Math.max(a,-1),1)}var d=a.x*a.x,f=a.y*a.y,g=a.z*a.z,h=a.w*a.w;return b===e||"XYZ"===b?(this.x=Math.atan2(2*(a.x*a.w-a.y*a.z),h-d-f+g),this.y=Math.asin(c(2*(a.x*a.z+a.y*a.w))),this.z=Math.atan2(2*(a.z*a.w-a.x*a.y),h+d-f-g)):"YXZ"===b?(this.x=Math.asin(c(2*(a.x*a.w-a.y*a.z))),this.y=Math.atan2(2*(a.x*a.z+a.y*a.w),h-d-f+g),this.z=Math.atan2(2*(a.x*a.y+a.z*a.w),h-d+f-g)):"ZXY"===b?(this.x=Math.asin(c(2*(a.x*a.w+a.y*a.z))),this.y=Math.atan2(2*(a.y*a.w-a.z*a.x),h-d-f+g),this.z=Math.atan2(2*(a.z*a.w-a.x*a.y),h-d+f-g)):"ZYX"===b?(this.x=Math.atan2(2*(a.x*a.w+a.z*a.y),h-d-f+g),this.y=Math.asin(c(2*(a.y*a.w-a.x*a.z))),this.z=Math.atan2(2*(a.x*a.y+a.z*a.w),h+d-f-g)):"YZX"===b?(this.x=Math.atan2(2*(a.x*a.w-a.z*a.y),h-d+f-g),this.y=Math.atan2(2*(a.y*a.w-a.x*a.z),h+d-f-g),this.z=Math.asin(c(2*(a.x*a.y+a.z*a.w)))):"XZY"===b&&(this.x=Math.atan2(2*(a.x*a.w+a.y*a.z),h-d+f-g),this.y=Math.atan2(2*(a.x*a.z+a.y*a.w),h+d-f-g),this.z=Math.asin(c(2*(a.z*a.w-a.x*a.y)))),this},getScaleFromMatrix:function(a){var b=this.set(a.elements[0],a.elements[1],a.elements[2]).length(),c=this.set(a.elements[4],a.elements[5],a.elements[6]).length(),d=this.set(a.elements[8],a.elements[9],a.elements[10]).length();return this.x=b,this.y=c,this.z=d,this},toString:function(){return this.x+"_"+this.y+"_"+this.z},equals:function(a){return null==a?!1:a.x===this.x&&a.y===this.y&&a.z===this.z},clone:function(){return new $b(this.x,this.y,this.z)},setFromMatrixPosition:function(a){return this.x=a.elements[12],this.y=a.elements[13],this.z=a.elements[14],this},rotateFromAxisAndCenter:function(a,b,c){var d=(new Yb.Mat4).makeRotationAxisAndCenter(a,b,c);return this.applyMatrix4(d),this},rotationTowards:function(a,b){var c=(new Yb.Mat4).rotationTowards(a,b);return this.setEulerFromRotationMatrix(c),this},constructor:Yb.Vec3},$b.__q1=new Yb.Quat,Yb.Vec4=function(a,b,c,d){this.x=a||0,this.y=b||0,this.z=c||0,this.w=d!==e?d:1},Yb.Vec4.prototype={constructor:Yb.Vec4,set:function(a,b,c,d){return this.x=a,this.y=b,this.z=c,this.w=d,this},setX:function(a){return this.x=a,this},setY:function(a){return this.y=a,this},setZ:function(a){return this.z=a,this},setW:function(a){return this.w=a,this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;case 3:this.w=b;break;default:throw new Error("index is out of range: "+a)}},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+a)}},copy:function(a){return this.x=a.x,this.y=a.y,this.z=a.z,this.w=a.w!==e?a.w:1,this},add:function(a,b){return b!==e?(console.warn("DEPRECATED: Vec4's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b)):(this.x+=a.x,this.y+=a.y,this.z+=a.z,this.w+=a.w,this)},addScalar:function(a){return this.x+=a,this.y+=a,this.z+=a,this.w+=a,this},addVectors:function(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this.z=a.z+b.z,this.w=a.w+b.w,this},sub:function(a,b){return b!==e?(console.warn("DEPRECATED: Vec4's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b)):(this.x-=a.x,this.y-=a.y,this.z-=a.z,this.w-=a.w,this)},subVectors:function(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this.z=a.z-b.z,this.w=a.w-b.w,this},multiplyScalar:function(a){return this.x*=a,this.y*=a,this.z*=a,this.w*=a,this},applyMatrix4:function(a){var b=this.x,c=this.y,d=this.z,e=this.w,f=a.elements;return this.x=f[0]*b+f[4]*c+f[8]*d+f[12]*e,this.y=f[1]*b+f[5]*c+f[9]*d+f[13]*e,this.z=f[2]*b+f[6]*c+f[10]*d+f[14]*e,this.w=f[3]*b+f[7]*c+f[11]*d+f[15]*e,this},divideScalar:function(a){return 0!==a?(this.x/=a,this.y/=a,this.z/=a,this.w/=a):(this.x=0,this.y=0,this.z=0,this.w=1),this},min:function(a){return this.x>a.x&&(this.x=a.x),this.y>a.y&&(this.y=a.y),this.z>a.z&&(this.z=a.z),this.w>a.w&&(this.w=a.w),this},max:function(a){return this.x<a.x&&(this.x=a.x),this.y<a.y&&(this.y=a.y),this.z<a.z&&(this.z=a.z),this.w<a.w&&(this.w=a.w),this},clamp:function(a,b){return this.x<a.x?this.x=a.x:this.x>b.x&&(this.x=b.x),this.y<a.y?this.y=a.y:this.y>b.y&&(this.y=b.y),this.z<a.z?this.z=a.z:this.z>b.z&&(this.z=b.z),this.w<a.w?this.w=a.w:this.w>b.w&&(this.w=b.w),this},negate:function(){return this.multiplyScalar(-1)},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(a){var b=this.length();return 0!==b&&a!==b&&this.multiplyScalar(a/b),this},lerp:function(a,b){return this.x+=(a.x-this.x)*b,this.y+=(a.y-this.y)*b,this.z+=(a.z-this.z)*b,this.w+=(a.w-this.w)*b,this},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z&&a.w===this.w},clone:function(){return new Yb.Vec4(this.x,this.y,this.z,this.w)},setAxisAngleFromQuaternion:function(a){this.w=2*Math.acos(a.w);var b=Math.sqrt(1-a.w*a.w);return 1e-4>b?(this.x=1,this.y=0,this.z=0):(this.x=a.x/b,this.y=a.y/b,this.z=a.z/b),this},setAxisAngleFromRotationMatrix:function(a){var b,c,d,e,f=.01,g=.1,h=a.elements,i=h[0],j=h[4],k=h[8],l=h[1],m=h[5],n=h[9],o=h[2],p=h[6],q=h[10];if(Math.abs(j-l)<f&&Math.abs(k-o)<f&&Math.abs(n-p)<f){if(Math.abs(j+l)<g&&Math.abs(k+o)<g&&Math.abs(n+p)<g&&Math.abs(i+m+q-3)<g)return this.set(1,0,0,0),this;b=Math.PI;var r=(i+1)/2,s=(m+1)/2,t=(q+1)/2,u=(j+l)/4,v=(k+o)/4,w=(n+p)/4;return r>s&&r>t?f>r?(c=0,d=.707106781,e=.707106781):(c=Math.sqrt(r),d=u/c,e=v/c):s>t?f>s?(c=.707106781,d=0,e=.707106781):(d=Math.sqrt(s),c=u/d,e=w/d):f>t?(c=.707106781,d=.707106781,e=0):(e=Math.sqrt(t),c=v/e,d=w/e),this.set(c,d,e,b),this}var x=Math.sqrt((p-n)*(p-n)+(k-o)*(k-o)+(l-j)*(l-j));return Math.abs(x)<.001&&(x=1),this.x=(p-n)/x,this.y=(k-o)/x,this.z=(l-j)/x,this.w=Math.acos((i+m+q-1)/2),this}};var _b=function(a,b,c,d,f,g,h,i,j){this.elements=new Float32Array(9),this.set(a!==e?a:1,b||0,c||0,d||0,f!==e?f:1,g||0,h||0,i||0,j!==e?j:1)};_b.prototype={constructor:_b,set:function(a,b,c,d,e,f,g,h,i){var j=this.elements;return j[0]=a,j[3]=b,j[6]=c,j[1]=d,j[4]=e,j[7]=f,j[2]=g,j[5]=h,j[8]=i,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},copy:function(a){var b=a.elements;return this.set(b[0],b[3],b[6],b[1],b[4],b[7],b[2],b[5],b[8]),this},multiplyVector3:function(a){return console.warn("DEPRECATED: Mat3's .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),a.applyMatrix3(this)},multiplyVector3Array:function(){var a=new $b;return function(b){for(var c=0,d=b.length;d>c;c+=3)a.x=b[c],a.y=b[c+1],a.z=b[c+2],a.applyMatrix3(this),b[c]=a.x,b[c+1]=a.y,b[c+2]=a.z;return b}}(),multiplyScalar:function(a){var b=this.elements;return b[0]*=a,b[3]*=a,b[6]*=a,b[1]*=a,b[4]*=a,b[7]*=a,b[2]*=a,b[5]*=a,b[8]*=a,this},determinant:function(){var a=this.elements,b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],i=a[7],j=a[8];return b*f*j-b*g*i-c*e*j+c*g*h+d*e*i-d*f*h},getInverse:function(a,b){var c=a.elements,d=this.elements;d[0]=c[10]*c[5]-c[6]*c[9],d[1]=-c[10]*c[1]+c[2]*c[9],d[2]=c[6]*c[1]-c[2]*c[5],d[3]=-c[10]*c[4]+c[6]*c[8],d[4]=c[10]*c[0]-c[2]*c[8],d[5]=-c[6]*c[0]+c[2]*c[4],d[6]=c[9]*c[4]-c[5]*c[8],d[7]=-c[9]*c[0]+c[1]*c[8],d[8]=c[5]*c[0]-c[1]*c[4];var e=c[0]*d[0]+c[1]*d[3]+c[2]*d[6];if(0===e){var f="Mat3.getInverse(): can't invert matrix, determinant is 0";if(b)throw new Error(f);return console.warn(f),this.identity(),this}return this.multiplyScalar(1/e),this},transpose:function(){var a,b=this.elements;return a=b[1],b[1]=b[3],b[3]=a,a=b[2],b[2]=b[6],b[6]=a,a=b[5],b[5]=b[7],b[7]=a,this},getNormalMatrix:function(a){return this.getInverse(a).transpose(),this},transposeIntoArray:function(a){var b=this.elements;return a[0]=b[0],a[1]=b[3],a[2]=b[6],a[3]=b[1],a[4]=b[4],a[5]=b[7],a[6]=b[2],a[7]=b[5],a[8]=b[8],this},clone:function(){var a=this.elements;return new _b(a[0],a[3],a[6],a[1],a[4],a[7],a[2],a[5],a[8])}},Yb.Mat3=_b;var ac=function(a,b,c,d,f,g,h,i,j,k,l,m,n,o,p,q){this.elements=new Float32Array(16),this.set(a!==e?a:1,b||0,c||0,d||0,f||0,g!==e?g:1,h||0,i||0,j||0,k||0,l!==e?l:1,m||0,n||0,o||0,p||0,q!==e?q:1)};ac.prototype={constructor:ac,set:function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q=this.elements;return q[0]=a,q[4]=b,q[8]=c,q[12]=d,q[1]=e,q[5]=f,q[9]=g,q[13]=h,q[2]=i,q[6]=j,q[10]=k,q[14]=l,q[3]=m,q[7]=n,q[11]=o,q[15]=p,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},copy:function(a){var b=a.elements;return this.set(b[0],b[4],b[8],b[12],b[1],b[5],b[9],b[13],b[2],b[6],b[10],b[14],b[3],b[7],b[11],b[15]),this},setRotationFromEuler:function(a,b){var c=this.elements,d=a.x,f=a.y,g=a.z,h=Math.cos(d),i=Math.sin(d),j=Math.cos(f),k=Math.sin(f),l=Math.cos(g),m=Math.sin(g);if(b===e||"XYZ"===b){var n=h*l,o=h*m,p=i*l,q=i*m;c[0]=j*l,c[4]=-j*m,c[8]=k,c[1]=o+p*k,c[5]=n-q*k,c[9]=-i*j,c[2]=q-n*k,c[6]=p+o*k,c[10]=h*j}else if("YXZ"===b){var r=j*l,s=j*m,t=k*l,u=k*m;c[0]=r+u*i,c[4]=t*i-s,c[8]=h*k,c[1]=h*m,c[5]=h*l,c[9]=-i,c[2]=s*i-t,c[6]=u+r*i,c[10]=h*j}else if("ZXY"===b){var r=j*l,s=j*m,t=k*l,u=k*m;c[0]=r-u*i,c[4]=-h*m,c[8]=t+s*i,c[1]=s+t*i,c[5]=h*l,c[9]=u-r*i,c[2]=-h*k,c[6]=i,c[10]=h*j}else if("ZYX"===b){var n=h*l,o=h*m,p=i*l,q=i*m;c[0]=j*l,c[4]=p*k-o,c[8]=n*k+q,c[1]=j*m,c[5]=q*k+n,c[9]=o*k-p,c[2]=-k,c[6]=i*j,c[10]=h*j}else if("YZX"===b){var v=h*j,w=h*k,x=i*j,y=i*k;c[0]=j*l,c[4]=y-v*m,c[8]=x*m+w,c[1]=m,c[5]=h*l,c[9]=-i*l,c[2]=-k*l,c[6]=w*m+x,c[10]=v-y*m}else if("XZY"===b){var v=h*j,w=h*k,x=i*j,y=i*k;c[0]=j*l,c[4]=-m,c[8]=k*l,c[1]=v*m+y,c[5]=h*l,c[9]=w*m-x,c[2]=x*m-w,c[6]=i*l,c[10]=y*m+v}return this},setRotationFromQuaternion:function(a){var b=this.elements,c=a.x,d=a.y,e=a.z,f=a.w,g=c+c,h=d+d,i=e+e,j=c*g,k=c*h,l=c*i,m=d*h,n=d*i,o=e*i,p=f*g,q=f*h,r=f*i;return b[0]=1-(m+o),b[4]=k-r,b[8]=l+q,b[1]=k+r,b[5]=1-(j+o),b[9]=n-p,b[2]=l-q,b[6]=n+p,b[10]=1-(j+m),this},lookAt:function(a,b,c){var d=this.elements,e=ac.__v1,f=ac.__v2,g=ac.__v3;return g.subVectors(a,b).normalize(),0===g.length()&&(g.z=1),e.crossVectors(c,g).normalize(),0===e.length()&&(g.x+=1e-4,e.crossVectors(c,g).normalize()),f.crossVectors(g,e),d[0]=e.x,d[1]=e.y,d[2]=e.z,d[4]=f.x,d[5]=f.y,d[6]=f.z,d[8]=g.x,d[9]=g.y,d[10]=g.z,this},multiply:function(a,b){return b!==e?this.multiplyMatrices(a,b):this.multiplyMatrices(this,a)},multiplyMatrices:function(a,b){var c=a.elements,d=b.elements,e=this.elements,f=c[0],g=c[4],h=c[8],i=c[12],j=c[1],k=c[5],l=c[9],m=c[13],n=c[2],o=c[6],p=c[10],q=c[14],r=c[3],s=c[7],t=c[11],u=c[15],v=d[0],w=d[4],x=d[8],y=d[12],z=d[1],A=d[5],B=d[9],C=d[13],D=d[2],E=d[6],F=d[10],G=d[14],H=d[3],I=d[7],J=d[11],K=d[15];return e[0]=f*v+g*z+h*D+i*H,e[4]=f*w+g*A+h*E+i*I,e[8]=f*x+g*B+h*F+i*J,e[12]=f*y+g*C+h*G+i*K,e[1]=j*v+k*z+l*D+m*H,e[5]=j*w+k*A+l*E+m*I,e[9]=j*x+k*B+l*F+m*J,e[13]=j*y+k*C+l*G+m*K,e[2]=n*v+o*z+p*D+q*H,e[6]=n*w+o*A+p*E+q*I,e[10]=n*x+o*B+p*F+q*J,e[14]=n*y+o*C+p*G+q*K,e[3]=r*v+s*z+t*D+u*H,e[7]=r*w+s*A+t*E+u*I,e[11]=r*x+s*B+t*F+u*J,e[15]=r*y+s*C+t*G+u*K,this},multiplyToArray:function(a,b,c){var d=this.elements;return this.multiplyMatrices(a,b),c[0]=d[0],c[1]=d[1],c[2]=d[2],c[3]=d[3],c[4]=d[4],c[5]=d[5],c[6]=d[6],c[7]=d[7],c[8]=d[8],c[9]=d[9],c[10]=d[10],c[11]=d[11],c[12]=d[12],c[13]=d[13],c[14]=d[14],c[15]=d[15],this},multiplyScalar:function(a){var b=this.elements;return b[0]*=a,b[4]*=a,b[8]*=a,b[12]*=a,b[1]*=a,b[5]*=a,b[9]*=a,b[13]*=a,b[2]*=a,b[6]*=a,b[10]*=a,b[14]*=a,b[3]*=a,b[7]*=a,b[11]*=a,b[15]*=a,this},multiplyVector3:function(a){return a.applyProjection(this)},multiplyVector4:function(a){return a.applyMatrix4(this)},multiplyVector3Array:function(a){for(var b=ac.__v1,c=0,d=a.length;d>c;c+=3)b.x=a[c],b.y=a[c+1],b.z=a[c+2],b.applyProjection(this),a[c]=b.x,a[c+1]=b.y,a[c+2]=b.z;return a},rotateAxis:function(a){var b=this.elements,c=a.x,d=a.y,e=a.z;return a.x=c*b[0]+d*b[4]+e*b[8],a.y=c*b[1]+d*b[5]+e*b[9],a.z=c*b[2]+d*b[6]+e*b[10],a.normalize(),a},crossVector:function(a){var b=this.elements,c=new Yb.Vector4;return c.x=b[0]*a.x+b[4]*a.y+b[8]*a.z+b[12]*a.w,c.y=b[1]*a.x+b[5]*a.y+b[9]*a.z+b[13]*a.w,c.z=b[2]*a.x+b[6]*a.y+b[10]*a.z+b[14]*a.w,c.w=a.w?b[3]*a.x+b[7]*a.y+b[11]*a.z+b[15]*a.w:1,c},determinant:function(){var a=this.elements,b=a[0],c=a[4],d=a[8],e=a[12],f=a[1],g=a[5],h=a[9],i=a[13],j=a[2],k=a[6],l=a[10],m=a[14],n=a[3],o=a[7],p=a[11],q=a[15];return n*(+e*h*k-d*i*k-e*g*l+c*i*l+d*g*m-c*h*m)+o*(+b*h*m-b*i*l+e*f*l-d*f*m+d*i*j-e*h*j)+p*(+b*i*k-b*g*m-e*f*k+c*f*m+e*g*j-c*i*j)+q*(-d*g*j-b*h*k+b*g*l+d*f*k-c*f*l+c*h*j)},transpose:function(){var a,b=this.elements;return a=b[1],b[1]=b[4],b[4]=a,a=b[2],b[2]=b[8],b[8]=a,a=b[6],b[6]=b[9],b[9]=a,a=b[3],b[3]=b[12],b[12]=a,a=b[7],b[7]=b[13],b[13]=a,a=b[11],b[11]=b[14],b[14]=a,this},flattenToArray:function(a){var b=this.elements;return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15],a},flattenToArrayOffset:function(a,b){var c=this.elements;return a[b]=c[0],a[b+1]=c[1],a[b+2]=c[2],a[b+3]=c[3],a[b+4]=c[4],a[b+5]=c[5],a[b+6]=c[6],a[b+7]=c[7],a[b+8]=c[8],a[b+9]=c[9],a[b+10]=c[10],a[b+11]=c[11],a[b+12]=c[12],a[b+13]=c[13],a[b+14]=c[14],a[b+15]=c[15],a},getPosition:function(){var a=this.elements;return(new $b).set(a[12],a[13],a[14])},setPosition:function(a){var b=this.elements;return b[12]=a.x,b[13]=a.y,b[14]=a.z,this},getColumnX:function(){var a=this.elements;return ac.__v1.set(a[0],a[1],a[2])},getColumnY:function(){var a=this.elements;return ac.__v1.set(a[4],a[5],a[6])},getColumnZ:function(){var a=this.elements;return ac.__v1.set(a[8],a[9],a[10])},getInverse:function(a,b){var c=this.elements,d=a.elements,e=d[0],f=d[4],g=d[8],h=d[12],i=d[1],j=d[5],k=d[9],l=d[13],m=d[2],n=d[6],o=d[10],p=d[14],q=d[3],r=d[7],s=d[11],t=d[15];c[0]=k*p*r-l*o*r+l*n*s-j*p*s-k*n*t+j*o*t,c[4]=h*o*r-g*p*r-h*n*s+f*p*s+g*n*t-f*o*t,c[8]=g*l*r-h*k*r+h*j*s-f*l*s-g*j*t+f*k*t,c[12]=h*k*n-g*l*n-h*j*o+f*l*o+g*j*p-f*k*p,
c[1]=l*o*q-k*p*q-l*m*s+i*p*s+k*m*t-i*o*t,c[5]=g*p*q-h*o*q+h*m*s-e*p*s-g*m*t+e*o*t,c[9]=h*k*q-g*l*q-h*i*s+e*l*s+g*i*t-e*k*t,c[13]=g*l*m-h*k*m+h*i*o-e*l*o-g*i*p+e*k*p,c[2]=j*p*q-l*n*q+l*m*r-i*p*r-j*m*t+i*n*t,c[6]=h*n*q-f*p*q-h*m*r+e*p*r+f*m*t-e*n*t,c[10]=f*l*q-h*j*q+h*i*r-e*l*r-f*i*t+e*j*t,c[14]=h*j*m-f*l*m-h*i*n+e*l*n+f*i*p-e*j*p,c[3]=k*n*q-j*o*q-k*m*r+i*o*r+j*m*s-i*n*s,c[7]=f*o*q-g*n*q+g*m*r-e*o*r-f*m*s+e*n*s,c[11]=g*j*q-f*k*q-g*i*r+e*k*r+f*i*s-e*j*s,c[15]=f*k*m-g*j*m+g*i*n-e*k*n-f*i*o+e*j*o;var u=d[0]*c[0]+d[1]*c[4]+d[2]*c[8]+d[3]*c[12];if(0==u){var v="Mat4.getInverse(): can't invert matrix, determinant is 0";if(b)throw new Error(v);return console.warn(v),this.identity(),this}return this.multiplyScalar(1/u),this},compose:function(a,b,c){var d=this.elements,e=ac.__m1,f=ac.__m2;return e.identity(),e.setRotationFromQuaternion(b),f.makeScale(c.x,c.y,c.z),this.multiplyMatrices(e,f),d[12]=a.x,d[13]=a.y,d[14]=a.z,this},decompose:function(a,b,c){var d=this.elements,e=ac.__v1,f=ac.__v2,g=ac.__v3;e.set(d[0],d[1],d[2]),f.set(d[4],d[5],d[6]),g.set(d[8],d[9],d[10]),a=a instanceof $b?a:new $b,b=b instanceof Yb.Quat?b:new Yb.Quat,c=c instanceof $b?c:new $b,c.x=e.length(),c.y=f.length(),c.z=g.length(),a.x=d[12],a.y=d[13],a.z=d[14];var h=ac.__m1;return h.copy(this),h.elements[0]/=c.x,h.elements[1]/=c.x,h.elements[2]/=c.x,h.elements[4]/=c.y,h.elements[5]/=c.y,h.elements[6]/=c.y,h.elements[8]/=c.z,h.elements[9]/=c.z,h.elements[10]/=c.z,b.setFromRotationMatrix(h),[a,b,c]},extractPosition:function(a){var b=this.elements,c=a.elements;return b[12]=c[12],b[13]=c[13],b[14]=c[14],this},extractRotation:function(a){var b=this.elements,c=a.elements,d=ac.__v1,e=1/d.set(c[0],c[1],c[2]).length(),f=1/d.set(c[4],c[5],c[6]).length(),g=1/d.set(c[8],c[9],c[10]).length();return b[0]=c[0]*e,b[1]=c[1]*e,b[2]=c[2]*e,b[4]=c[4]*f,b[5]=c[5]*f,b[6]=c[6]*f,b[8]=c[8]*g,b[9]=c[9]*g,b[10]=c[10]*g,this},translate:function(a){var b=this.elements,c=a.x,d=a.y,e=a.z;return b[12]=b[0]*c+b[4]*d+b[8]*e+b[12],b[13]=b[1]*c+b[5]*d+b[9]*e+b[13],b[14]=b[2]*c+b[6]*d+b[10]*e+b[14],b[15]=b[3]*c+b[7]*d+b[11]*e+b[15],this},rotateX:function(a){var b=this.elements,c=b[4],d=b[5],e=b[6],f=b[7],g=b[8],h=b[9],i=b[10],j=b[11],k=Math.cos(a),l=Math.sin(a);return b[4]=k*c+l*g,b[5]=k*d+l*h,b[6]=k*e+l*i,b[7]=k*f+l*j,b[8]=k*g-l*c,b[9]=k*h-l*d,b[10]=k*i-l*e,b[11]=k*j-l*f,this},rotateY:function(a){var b=this.elements,c=b[0],d=b[1],e=b[2],f=b[3],g=b[8],h=b[9],i=b[10],j=b[11],k=Math.cos(a),l=Math.sin(a);return b[0]=k*c-l*g,b[1]=k*d-l*h,b[2]=k*e-l*i,b[3]=k*f-l*j,b[8]=k*g+l*c,b[9]=k*h+l*d,b[10]=k*i+l*e,b[11]=k*j+l*f,this},rotateZ:function(a){var b=this.elements,c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],i=b[6],j=b[7],k=Math.cos(a),l=Math.sin(a);return b[0]=k*c+l*g,b[1]=k*d+l*h,b[2]=k*e+l*i,b[3]=k*f+l*j,b[4]=k*g-l*c,b[5]=k*h-l*d,b[6]=k*i-l*e,b[7]=k*j-l*f,this},rotateByAxis:function(a,b){var c=this.elements;if(1===a.x&&0===a.y&&0===a.z)return this.rotateX(b);if(0===a.x&&1===a.y&&0===a.z)return this.rotateY(b);if(0===a.x&&0===a.y&&1===a.z)return this.rotateZ(b);var d=a.x,e=a.y,f=a.z,g=Math.sqrt(d*d+e*e+f*f);d/=g,e/=g,f/=g;var h=d*d,i=e*e,j=f*f,k=Math.cos(b),l=Math.sin(b),m=1-k,n=d*e*m,o=d*f*m,p=e*f*m,q=d*l,r=e*l,s=f*l,t=h+(1-h)*k,u=n+s,v=o-r,w=n-s,x=i+(1-i)*k,y=p+q,z=o+r,A=p-q,B=j+(1-j)*k,C=c[0],D=c[1],E=c[2],F=c[3],G=c[4],H=c[5],I=c[6],J=c[7],K=c[8],L=c[9],M=c[10],N=c[11];c[12],c[13],c[14],c[15];return c[0]=t*C+u*G+v*K,c[1]=t*D+u*H+v*L,c[2]=t*E+u*I+v*M,c[3]=t*F+u*J+v*N,c[4]=w*C+x*G+y*K,c[5]=w*D+x*H+y*L,c[6]=w*E+x*I+y*M,c[7]=w*F+x*J+y*N,c[8]=z*C+A*G+B*K,c[9]=z*D+A*H+B*L,c[10]=z*E+A*I+B*M,c[11]=z*F+A*J+B*N,this},scale:function(a){var b=this.elements,c=a.x,d=a.y,e=a.z;return b[0]*=c,b[4]*=d,b[8]*=e,b[1]*=c,b[5]*=d,b[9]*=e,b[2]*=c,b[6]*=d,b[10]*=e,b[3]*=c,b[7]*=d,b[11]*=e,this},getMaxScaleOnAxis:function(){var a=this.elements,b=a[0]*a[0]+a[1]*a[1]+a[2]*a[2],c=a[4]*a[4]+a[5]*a[5]+a[6]*a[6],d=a[8]*a[8]+a[9]*a[9]+a[10]*a[10];return Math.sqrt(Math.max(b,Math.max(c,d)))},makeTranslation:function(a,b,c){return this.set(1,0,0,a,0,1,0,b,0,0,1,c,0,0,0,1),this},makeRotationX:function(a){var b=Math.cos(a),c=Math.sin(a);return this.set(1,0,0,0,0,b,-c,0,0,c,b,0,0,0,0,1),this},makeRotationY:function(a){var b=Math.cos(a),c=Math.sin(a);return this.set(b,0,c,0,0,1,0,0,-c,0,b,0,0,0,0,1),this},makeRotationZ:function(a){var b=Math.cos(a),c=Math.sin(a);return this.set(b,-c,0,0,c,b,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(a,b){var c=Math.cos(b),d=Math.sin(b),e=1-c,f=a.x,g=a.y,h=a.z,i=e*f,j=e*g;return this.set(i*f+c,i*g-d*h,i*h+d*g,0,i*g+d*h,j*g+c,j*h-d*f,0,i*h-d*g,j*h+d*f,e*h*h+c,0,0,0,0,1),this},makeScale:function(a,b,c){return this.set(a,0,0,0,0,b,0,0,0,0,c,0,0,0,0,1),this},makeFrustum:function(a,b,c,d,e,f){var g=this.elements,h=2*e/(b-a),i=2*e/(d-c),j=(b+a)/(b-a),k=(d+c)/(d-c),l=-(f+e)/(f-e),m=-2*f*e/(f-e);return g[0]=h,g[4]=0,g[8]=j,g[12]=0,g[1]=0,g[5]=i,g[9]=k,g[13]=0,g[2]=0,g[6]=0,g[10]=l,g[14]=m,g[3]=0,g[7]=0,g[11]=-1,g[15]=0,this},makePerspective:function(a,b,c,d){var e=c*Math.tan(Yb.Math.degToRad(.5*a)),f=-e,g=f*b,h=e*b;return this.makeFrustum(g,h,f,e,c,d)},makeOrthographic:function(a,b,c,d,e,f){var g=this.elements,h=b-a,i=c-d,j=f-e,k=(b+a)/h,l=(c+d)/i,m=(f+e)/j;return g[0]=2/h,g[4]=0,g[8]=0,g[12]=-k,g[1]=0,g[5]=2/i,g[9]=0,g[13]=-l,g[2]=0,g[6]=0,g[10]=-2/j,g[14]=-m,g[3]=0,g[7]=0,g[11]=0,g[15]=1,this},clone:function(){var a=this.elements;return new ac(a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15])},makeRotationFromQuaternion:function(a){var b=this.elements,c=a.x,d=a.y,e=a.z,f=a.w,g=c+c,h=d+d,i=e+e,j=c*g,k=c*h,l=c*i,m=d*h,n=d*i,o=e*i,p=f*g,q=f*h,r=f*i;return b[0]=1-(m+o),b[4]=k-r,b[8]=l+q,b[1]=k+r,b[5]=1-(j+o),b[9]=n-p,b[2]=l-q,b[6]=n+p,b[10]=1-(j+m),b[3]=0,b[7]=0,b[11]=0,b[12]=0,b[13]=0,b[14]=0,b[15]=1,this},getEulerAngles:function(){var a=(new ac).extractRotation(this).elements,b=a[0],c=a[1],d=a[2],e=a[5],f=a[6],g=a[10],h=Math.atan2(f,g),i=Math.atan2(-d,Math.sqrt(b*b+c*c)),j=Math.sin(h),k=Math.cos(h),l=Math.atan2(j*a[8]-k*a[4],k*e-j*a[9]);return new $b(h,i,l)},makeRotationAxisAndCenter:function(a,b,c){var d=Math.cos(b),e=Math.sin(b),f=1-d,g=a.x,h=a.y,i=a.z,j=f*g,k=f*h,l=c.x,m=c.y,n=c.z,o=this,p=new Float32Array(16);return p[0]=j*g+d,p[4]=j*h-e*i,p[8]=j*i+e*h,p[12]=l-l*(j*g+d)-m*(j*h-e*i)-n*(j*i+e*h),p[1]=j*h+e*i,p[5]=k*h+d,p[9]=k*i-e*g,p[13]=m-l*(j*h+e*i)-m*(k*h+d)-n*(k*i-e*g),p[2]=j*i-e*h,p[6]=k*i+e*g,p[10]=f*i*i+d,p[14]=n-l*(j*i-e*h)-m*(k*i+e*g)-n*(f*i*i+d),p[3]=0,p[7]=0,p[11]=0,p[15]=1,o.elements=p,o},rotationTowards:function(a,b){var c=Math.acos(b.dot(a)/b.length()/a.length()),d=(new Yb.Vec3).crossVectors(b,a).normalize();return this.makeRotationAxis(d,-c),this},equals:function(a){if(a instanceof ac){for(var b=0;b<this.elements.length;b++)if(Math.abs(this.elements[b]-a.elements[b])>1e-4)return!1;return!0}}},ac.__v1=new $b,ac.__v2=new $b,ac.__v3=new $b,ac.__m1=new ac,ac.__m2=new ac,Yb.Mat4=ac,Yb.Euler=function(a,b,c,d){this._x=a||0,this._y=b||0,this._z=c||0,this._order=d||Yb.Euler.DefaultOrder},Yb.Euler.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],Yb.Euler.DefaultOrder="XYZ",Yb.Euler.prototype={constructor:Yb.Euler,_x:0,_y:0,_z:0,_order:Yb.Euler.DefaultOrder,_quaternion:e,_updateQuaternion:function(){this._quaternion!==e&&this._quaternion.setFromEuler(this,!1)},get x(){return this._x},set x(a){this._x=a,this._updateQuaternion()},get y(){return this._y},set y(a){this._y=a,this._updateQuaternion()},get z(){return this._z},set z(a){this._z=a,this._updateQuaternion()},get order(){return this._order},set order(a){this._order=a,this._updateQuaternion()},set:function(a,b,c,d){return this._x=a,this._y=b,this._z=c,this._order=d||this._order,this._updateQuaternion(),this},copy:function(a){return this._x=a._x,this._y=a._y,this._z=a._z,this._order=a._order,this._updateQuaternion(),this},setFromRotationMatrix:function(a,b){function c(a){return Math.min(Math.max(a,-1),1)}var d=a.elements,e=d[0],f=d[4],g=d[8],h=d[1],i=d[5],j=d[9],k=d[2],l=d[6],m=d[10];return b=b||this._order,"XYZ"===b?(this._y=Math.asin(c(g)),Math.abs(g)<.99999?(this._x=Math.atan2(-j,m),this._z=Math.atan2(-f,e)):(this._x=Math.atan2(l,i),this._z=0)):"YXZ"===b?(this._x=Math.asin(-c(j)),Math.abs(j)<.99999?(this._y=Math.atan2(g,m),this._z=Math.atan2(h,i)):(this._y=Math.atan2(-k,e),this._z=0)):"ZXY"===b?(this._x=Math.asin(c(l)),Math.abs(l)<.99999?(this._y=Math.atan2(-k,m),this._z=Math.atan2(-f,i)):(this._y=0,this._z=Math.atan2(h,e))):"ZYX"===b?(this._y=Math.asin(-c(k)),Math.abs(k)<.99999?(this._x=Math.atan2(l,m),this._z=Math.atan2(h,e)):(this._x=0,this._z=Math.atan2(-f,i))):"YZX"===b?(this._z=Math.asin(c(h)),Math.abs(h)<.99999?(this._x=Math.atan2(-j,i),this._y=Math.atan2(-k,e)):(this._x=0,this._y=Math.atan2(g,m))):"XZY"===b?(this._z=Math.asin(-c(f)),Math.abs(f)<.99999?(this._x=Math.atan2(l,i),this._y=Math.atan2(g,e)):(this._x=Math.atan2(-j,m),this._y=0)):console.warn("WARNING: Euler.setFromRotationMatrix() given unsupported order: "+b),this._order=b,this._updateQuaternion(),this},setFromQuaternion:function(a,b,c){function d(a){return Math.min(Math.max(a,-1),1)}var e=a.x*a.x,f=a.y*a.y,g=a.z*a.z,h=a.w*a.w;return b=b||this._order,"XYZ"===b?(this._x=Math.atan2(2*(a.x*a.w-a.y*a.z),h-e-f+g),this._y=Math.asin(d(2*(a.x*a.z+a.y*a.w))),this._z=Math.atan2(2*(a.z*a.w-a.x*a.y),h+e-f-g)):"YXZ"===b?(this._x=Math.asin(d(2*(a.x*a.w-a.y*a.z))),this._y=Math.atan2(2*(a.x*a.z+a.y*a.w),h-e-f+g),this._z=Math.atan2(2*(a.x*a.y+a.z*a.w),h-e+f-g)):"ZXY"===b?(this._x=Math.asin(d(2*(a.x*a.w+a.y*a.z))),this._y=Math.atan2(2*(a.y*a.w-a.z*a.x),h-e-f+g),this._z=Math.atan2(2*(a.z*a.w-a.x*a.y),h-e+f-g)):"ZYX"===b?(this._x=Math.atan2(2*(a.x*a.w+a.z*a.y),h-e-f+g),this._y=Math.asin(d(2*(a.y*a.w-a.x*a.z))),this._z=Math.atan2(2*(a.x*a.y+a.z*a.w),h+e-f-g)):"YZX"===b?(this._x=Math.atan2(2*(a.x*a.w-a.z*a.y),h-e+f-g),this._y=Math.atan2(2*(a.y*a.w-a.x*a.z),h+e-f-g),this._z=Math.asin(d(2*(a.x*a.y+a.z*a.w)))):"XZY"===b?(this._x=Math.atan2(2*(a.x*a.w+a.y*a.z),h-e+f-g),this._y=Math.atan2(2*(a.x*a.z+a.y*a.w),h+e-f-g),this._z=Math.asin(d(2*(a.z*a.w-a.x*a.y)))):console.warn("WARNING: Euler.setFromQuaternion() given unsupported order: "+b),this._order=b,c!==!1&&this._updateQuaternion(),this},reorder:function(){var a=new Yb.Quat;return function(b){a.setFromEuler(this),this.setFromQuaternion(a,b)}}(),fromArray:function(a){return this._x=a[0],this._y=a[1],this._z=a[2],a[3]!==e&&(this._order=a[3]),this._updateQuaternion(),this},toArray:function(){return[this._x,this._y,this._z,this._order]},equals:function(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._order===this._order},clone:function(){return new Yb.Euler(this._x,this._y,this._z,this._order)}},Yb.math={},Yb.math.Plane=function(a,b){this.normal=a!==e?a:new $b(1,0,0),this.constant=b!==e?b:0},Yb.math.Plane.prototype={constructor:Yb.math.Plane,set:function(a,b){return this.normal.copy(a),this.constant=b,this},setComponents:function(a,b,c,d){return this.normal.set(a,b,c),this.constant=d,this},setFromNormalAndCoplanarPoint:function(a,b){return this.normal.copy(a),this.constant=-b.dot(this.normal),this},setFromCoplanarPoints:function(a,b,c){var d=Yb.math.Plane.__v1.subVectors(c,b).cross(Yb.math.Plane.__v2.subVectors(a,b)).normalize();return this.setFromNormalAndCoplanarPoint(d,a),this},copy:function(a){return this.normal.copy(a.normal),this.constant=a.constant,this},normalize:function(){var a=1/this.normal.length();return this.normal.multiplyScalar(a),this.constant*=a,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(a){return this.normal.dot(a)+this.constant},distanceToSphere:function(a){return this.distanceToPoint(a.center)-a.radius},projectPoint:function(a,b){return this.orthoPoint(a,b).sub(a).negate()},orthoPoint:function(a,b){var c=this.distanceToPoint(a),d=b||new $b;return d.copy(this.normal).multiplyScalar(c)},isIntersectionLine:function(a,b){var c=this.distanceToPoint(a),d=this.distanceToPoint(b);return 0>c&&d>0||0>d&&c>0},isIntersectionFace:function(a,b){var c=[];c.push(b[a.a]),c.push(b[a.b]),c.push(b[a.c]),null!=a.d&&c.push(b[a.d]);var d,e,f,g=[];for(d=0;d<c.length;d++)g.push(this.distanceToPoint(c[d]));for(d=0;d<g.length;d++)if(0==d)e=f=g[d];else{if(f=g[d],0>e&&f>0||0>f&&e>0)return"intersect";e=f}return f>0?"in":"out"},intersectLine:function(a,b,c){var d=c||new $b,f=Yb.math.Plane.__v1.subVectors(b,a),g=this.normal.dot(f);if(0==g)return 0==this.distanceToPoint(a)?d.copy(a):e;var h=-(a.dot(this.normal)+this.constant)/g;return 0>h||h>1?e:d.copy(f).multiplyScalar(h).add(a)},coplanarPoint:function(a){var b=a||new $b;return b.copy(this.normal).multiplyScalar(-this.constant)},transform:function(a,b){b=b||(new Yb.Mat3).getInverse(a).transpose();var c=Yb.math.Plane.__v1.copy(this.normal).applyMatrix3(b),d=this.coplanarPoint(Yb.math.Plane.__v2);return d.applyMatrix4(a),this.setFromNormalAndCoplanarPoint(c,d),this},translate:function(a){return this.constant=this.constant-a.dot(this.normal),this},equals:function(a){return a.normal.equals(this.normal)&&a.constant==this.constant},clone:function(){return(new Yb.math.Plane).copy(this)}},Yb.math.Plane.__vZero=new $b(0,0,0),Yb.math.Plane.__v1=new $b,Yb.math.Plane.__v2=new $b,Yb.Frustum=function(a,b,c,d,f,g){this.planes=[a!==e?a:new Yb.math.Plane,b!==e?b:new Yb.math.Plane,c!==e?c:new Yb.math.Plane,d!==e?d:new Yb.math.Plane,f!==e?f:new Yb.math.Plane,g!==e?g:new Yb.math.Plane]},Yb.Frustum.prototype={set:function(a,b,c,d,e,f){var g=this.planes;return g[0].copy(a),g[1].copy(b),g[2].copy(c),g[3].copy(d),g[4].copy(e),g[5].copy(f),this},setPoints:function(a){this.points=a},copy:function(a){for(var b=this.planes,c=0;6>c;c++)b[c].copy(a.planes[c]);return this},setFromMatrix:function(a){var b=this.planes,c=a.elements,d=c[0],e=c[1],f=c[2],g=c[3],h=c[4],i=c[5],j=c[6],k=c[7],l=c[8],m=c[9],n=c[10],o=c[11],p=c[12],q=c[13],r=c[14],s=c[15];return b[0].setComponents(g-d,k-h,o-l,s-p).normalize(),b[1].setComponents(g+d,k+h,o+l,s+p).normalize(),b[2].setComponents(g+e,k+i,o+m,s+q).normalize(),b[3].setComponents(g-e,k-i,o-m,s-q).normalize(),b[4].setComponents(g-f,k-j,o-n,s-r).normalize(),b[5].setComponents(g+f,k+j,o+n,s+r).normalize(),this},intersectsObjectAccurate:function(a,b){if(0==b)return this.intersectsObject(a);var c,d,e=a.worldMatrix,f=(this.planes,a.vertices),g=[],h=f.length;for(d=0;h>d;d++)if(c=f[d].clone(),c.applyMatrix4(e),g.push(c),this.containsPoint(c))return!0;if(2==b)if(a instanceof Yb.Line)for(d=0,h=g.length;h-1>d;d++){var i=g[d],j=g[d+1];if(this.containsLine(i,j))return!0}else{var k,l=a.faces;for(d=0,h=l.length;h>d;d++){if(k=l[d],this.containsLine(g[k.a],g[k.b]))return!0;if(this.containsLine(g[k.b],g[k.c]))return!0;if(null!=k.d){if(this.containsLine(g[k.c],g[k.d]))return!0;if(this.containsLine(g[k.d],g[k.a]))return!0}else if(this.containsLine(g[k.a],g[k.c]))return!0}}return!1},intersectsObject:function(a){var b=a.worldMatrix,c=this.planes,d=b.getPosition();if(!a.computeBoundingSphere)return!1;a.boundingSphere||a.computeBoundingSphere();for(var e=-a.boundingSphere.radius*b.getMaxScaleOnAxis(),f=0;6>f;f++){var g=c[f].distanceToPoint(d);if(e>g)return!1}return!0},intersectsSphere:function(a){for(var b=this.planes,c=a.center,d=-a.radius,e=0;6>e;e++){var f=b[e].distanceToPoint(c);if(d>f)return!1}return!0},intersectsBox:function(a){for(var b=new $b,c=new $b,d=this.planes,e=0;6>e;e++){var f=d[e];b.x=f.normal.x>0?a.min.x:a.max.x,c.x=f.normal.x>0?a.max.x:a.min.x,b.y=f.normal.y>0?a.min.y:a.max.y,c.y=f.normal.y>0?a.max.y:a.min.y,b.z=f.normal.z>0?a.min.z:a.max.z,c.z=f.normal.z>0?a.max.z:a.min.z;var g=f.distanceToPoint(b),h=f.distanceToPoint(c);if(0>g&&0>h)return!1}return!0},containsLine:function(a,b){for(var c=this.planes,d=new $b,e=0;6>e;e++)if(d=c[e].intersectLine(a,b,d),d&&this.containsPoint(d))return!0;return!1},containsPoint:function(a){for(var b=this.planes,c=0;6>c;c++)if(b[c].distanceToPoint(a)<0)return!1;return!0},clone:function(){return(new Yb.Frustum).copy(this)}},Yb.Ray=function(a,b){this.origin=a!==e?a:new $b,this.direction=b!==e?b:new $b},Yb.Ray.prototype={constructor:Yb.Ray,set:function(a,b){return this.origin.copy(a),this.direction.copy(b),this},copy:function(a){return this.origin.copy(a.origin),this.direction.copy(a.direction),this},at:function(a,b){var c=b||new $b;return c.copy(this.direction).multiplyScalar(a).add(this.origin)},recast:function(a){return this.origin.copy(this.at(a,Yb.Ray.__v1)),this},closestPointToPoint:function(a,b){var c=b||new $b;c.subVectors(a,this.origin);var d=c.dot(this.direction);return c.copy(this.direction).multiplyScalar(d).add(this.origin)},distanceToPoint:function(a){var b=Yb.Ray.__v1.subVectors(a,this.origin).dot(this.direction);return Yb.Ray.__v1.copy(this.direction).multiplyScalar(b).add(this.origin),Yb.Ray.__v1.distanceTo(a)},isIntersectionSphere:function(a){return this.distanceToPoint(a.center)<=a.radius},isIntersectionPlane:function(a){var b=a.normal.dot(this.direction);return 0!=b?!0:0==a.distanceToPoint(this.origin)?!0:!1},distanceToPlane:function(a){var b=a.normal.dot(this.direction);if(0==b)return 0==a.distanceToPoint(this.origin)?0:e;var c=-(this.origin.dot(a.normal)+a.constant)/b;return c},intersectPlane:function(a,b){var c=this.distanceToPlane(a);return c===e?e:this.at(c,b)},transform:function(a){return this.direction.add(this.origin).applyMatrix4(a),this.origin.applyMatrix4(a),this.direction.sub(this.origin),this},distanceSqToSegment:function(a,b,c,d){var e,f,g,h,i=a.clone().add(b).multiplyScalar(.5),j=b.clone().sub(a).normalize(),k=.5*a.distanceTo(b),l=this.origin.clone().sub(i),m=-this.direction.dot(j),n=l.dot(this.direction),o=-l.dot(j),p=l.lengthSq(),q=Math.abs(1-m*m);if(q>=0)if(e=m*o-n,f=m*n-o,h=k*q,e>=0)if(f>=-h)if(h>=f){var r=1/q;e*=r,f*=r,g=e*(e+m*f+2*n)+f*(m*e+f+2*o)+p}else f=k,e=Math.max(0,-(m*f+n)),g=-e*e+f*(f+2*o)+p;else f=-k,e=Math.max(0,-(m*f+n)),g=-e*e+f*(f+2*o)+p;else-h>=f?(e=Math.max(0,-(-m*k+n)),f=e>0?-k:Math.min(Math.max(-k,-o),k),g=-e*e+f*(f+2*o)+p):h>=f?(e=0,f=Math.min(Math.max(-k,-o),k),g=f*(f+2*o)+p):(e=Math.max(0,-(m*k+n)),f=e>0?k:Math.min(Math.max(-k,-o),k),g=-e*e+f*(f+2*o)+p);else f=m>0?-k:k,e=Math.max(0,-(m*f+n)),g=-e*e+f*(f+2*o)+p;return c&&c.copy(this.direction.clone().multiplyScalar(e).add(this.origin)),d&&d.copy(j.clone().multiplyScalar(f).add(i)),g},equals:function(a){return a.origin.equals(this.origin)&&a.direction.equals(this.direction)},clone:function(){return(new Yb.Ray).copy(this)}},Yb.Ray.__v1=new $b,Yb.Ray.__v2=new $b,Yb.Triangle=function(a,b,c){this.a=a!==e?a:new $b,this.b=b!==e?b:new $b,this.c=c!==e?c:new $b},Yb.Triangle.normal=function(a,b,c,d){var e=d||new $b;e.subVectors(c,b),Yb.Triangle.__v0.subVectors(a,b),e.cross(Yb.Triangle.__v0);var f=e.lengthSq();return f>0?e.multiplyScalar(1/Math.sqrt(f)):e.set(0,0,0)},Yb.Triangle.barycoordFromPoint=function(a,b,c,d,e){Yb.Triangle.__v0.subVectors(d,b),Yb.Triangle.__v1.subVectors(c,b),Yb.Triangle.__v2.subVectors(a,b);var f=Yb.Triangle.__v0.dot(Yb.Triangle.__v0),g=Yb.Triangle.__v0.dot(Yb.Triangle.__v1),h=Yb.Triangle.__v0.dot(Yb.Triangle.__v2),i=Yb.Triangle.__v1.dot(Yb.Triangle.__v1),j=Yb.Triangle.__v1.dot(Yb.Triangle.__v2),k=f*i-g*g,l=e||new $b;if(0==k)return l.set(-2,-1,-1);var m=1/k,n=(i*h-g*j)*m,o=(f*j-g*h)*m;return l.set(1-n-o,o,n)},Yb.Triangle.containsPoint=function(a,b,c,d){var e=Yb.Triangle.barycoordFromPoint(a,b,c,d,Yb.Triangle.__v3);return e.x>=0&&e.y>=0&&e.x+e.y<=1},Yb.Triangle.prototype={constructor:Yb.Triangle,set:function(a,b,c){return this.a.copy(a),this.b.copy(b),this.c.copy(c),this},setFromPointsAndIndices:function(a,b,c,d){return this.a.copy(a[b]),this.b.copy(a[c]),this.c.copy(a[d]),this},copy:function(a){return this.a.copy(a.a),this.b.copy(a.b),this.c.copy(a.c),this},area:function(){return Yb.Triangle.__v0.subVectors(this.c,this.b),Yb.Triangle.__v1.subVectors(this.a,this.b),.5*Yb.Triangle.__v0.cross(Yb.Triangle.__v1).length()},midpoint:function(a){var b=a||new $b;return b.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(a){return Yb.Triangle.normal(this.a,this.b,this.c,a)},plane:function(a){var b=a||new Yb.math.Plane;return b.setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(a,b){return Yb.Triangle.barycoordFromPoint(a,this.a,this.b,this.c,b)},containsPoint:function(a){return Yb.Triangle.containsPoint(a,this.a,this.b,this.c)},equals:function(a){return a.a.equals(this.a)&&a.b.equals(this.b)&&a.c.equals(this.c)},clone:function(){return(new Yb.Triangle).copy(this)},intersectLine:function(a,b){var c=this.plane(),d=c.intersectLine(a,b);return null!=d&&this.containsPoint(d)}},Yb.Triangle.__v0=new $b,Yb.Triangle.__v1=new $b,Yb.Triangle.__v2=new $b,Yb.Triangle.__v3=new $b;var bc={getLogicalPoint:function(a,b){var c,d=a.getBoundingClientRect();if(cc.isTouchable&&b.changedTouches&&b.changedTouches.length>0){var e=b.changedTouches[0],f=cc.isAndroid?0:$touch.scrollLeft(),g=cc.isAndroid?0:$touch.scrollTop();c={x:e.clientX+a.scrollLeft-d.left-f,y:e.clientY+a.scrollTop-d.top-g}}else{if(!bc.isValidEvent(a,b))return null;c={x:b.clientX-d.left+a.scrollLeft,y:b.clientY-d.top+a.scrollTop}}return c},isValidEvent:function(a,b){if(!b)return!1;if(b.target===a)if(cc.isFirefox){if(a.clientHeight<a.scrollHeight&&b.layerX<25)return!1;if(a.clientWidth<a.scrollWidth&&b.layerY<25)return!1}else if(b.offsetX>a.clientWidth||b.offsetY>a.clientHeight)return!1;return!0},isImage:function(a){return a&&a.nodeName&&"img"===a.nodeName.toLowerCase()},isCanvas:function(a){return a&&a.nodeName&&"canvas"===a.nodeName.toLowerCase()},createView:function(a,b){var c=document.createElement("div");return c.style.position=rc.VIEW_POSITION,c.style.fontSize=rc.VIEW_FONT_SIZE,c.style.fontFamily=rc.VIEW_FONT_FAMILY,c.style.cursor="default",c.style.outline="none",c.style.textAlign="left",c.style.msTouchAction="none",c.tabIndex=0,b||(c.onmousedown=bc.preventDefault),c.style.setProperty&&(c.style.setProperty("-khtml-user-select","none",null),c.style.setProperty("-webkit-user-select","none",null),c.style.setProperty("-moz-user-select","none",null),c.style.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",null)),a&&(c.style.overflow=a),c},preventDefault:function(a){rc.KEEP_DEFAULT_FUNCTION(a)||(a.preventDefault?a.preventDefault():a.preventManipulation?a.preventManipulation():a.returnValue=!1)},createCanvas:function(a){var b=document.createElement("canvas"),c=a.getView();return b.width=c.width,b.height=c.height,b.style.msTouchAction="none",b.style.position="absolute",b},isCtrlDown:function(a){return a.ctrlKey||a.metaKey},getScrollTop:function(a){if(!a)return 0;var b=a.scrollTop,c=a.parentElement;return b+this.getScrollTop(c)},getScrollLeft:function(a){if(!a)return 0;var b=a.scrollLeft,c=a.parentElement;return b+this.getScrollLeft(c)},debug:function(a,b){try{a.call(b)}catch(c){alert(c)}},setFocus:function(a){if(document.activeElement!==a){var b,c,d,e=document.documentElement;document.body;e&&(cc.isIE||cc.isOpera||e.scrollLeft||e.scrollTop)&&(b=e.scrollLeft,c=e.scrollTop,d=e),a.focus(),d&&(d.scrollLeft=b,d.scrollTop=c)}},isRightClick:function(a){var b;if(!a)var a=d.event;return a.which?b=3==a.which:a.button&&(b=2==a.button),b}};Yb.html=bc;var cc=function(){var a={},b=navigator.userAgent.toLowerCase();return a.isOpera=/opera/.test(b),a.isIE=/msie/.test(b)||/trident/.test(b),a.isFirefox=/firefox/i.test(b),a.isChrome=/chrome/i.test(b),a.isSafari=!a.isChrome&&/safari/i.test(b),a.isIPhone=/iphone/.test(b),a.isIPod=/ipod/.test(b),a.isIPad=/ipad/.test(b),a.isAndroid=/android/i.test(b),a.isWebOS=/webos/i.test(b),a.isMSToucheable=navigator.msMaxTouchPoints&&navigator.msMaxTouchPoints>1,a.isTouchable="ontouchend"in document||a.isMSToucheable,a.isIOS=a.isIPhone||a.isIPod||a.isIPad,a}();Yb.ua=cc,function(){function a(a){var b,d,e,f,g,h;for(e=a.length,d=0,b="";e>d;){if(f=255&a.charCodeAt(d++),d==e){b+=c.charAt(f>>2),b+=c.charAt((3&f)<<4),b+="==";break}if(g=a.charCodeAt(d++),d==e){b+=c.charAt(f>>2),b+=c.charAt((3&f)<<4|(240&g)>>4),b+=c.charAt((15&g)<<2),b+="=";break}h=a.charCodeAt(d++),b+=c.charAt(f>>2),b+=c.charAt((3&f)<<4|(240&g)>>4),b+=c.charAt((15&g)<<2|(192&h)>>6),b+=c.charAt(63&h)}return b}function b(a){var b,c,d,f,g,h,i;for(h=a.length,g=0,i="";h>g;){do b=e[255&a.charCodeAt(g++)];while(h>g&&-1==b);if(-1==b)break;do c=e[255&a.charCodeAt(g++)];while(h>g&&-1==c);if(-1==c)break;i+=String.fromCharCode(b<<2|(48&c)>>4);do{if(d=255&a.charCodeAt(g++),61==d)return i;d=e[d]}while(h>g&&-1==d);if(-1==d)break;i+=String.fromCharCode((15&c)<<4|(60&d)>>2);do{if(f=255&a.charCodeAt(g++),61==f)return i;f=e[f]}while(h>g&&-1==f);if(-1==f)break;i+=String.fromCharCode((3&d)<<6|f)}return i}var c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=new Array(-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1);d.btoa||(d.btoa=a),d.atob||(d.atob=b)}();var dc=function(){var a=!1,b=document.createElement("canvas");if(b.getContext("2d")&&(a=!0),!a)return{saveAsBMP:function(){},saveAsPNG:function(){},saveAsJPEG:function(){}};var c=!!b.getContext("2d").getImageData,e=!!b.toDataURL,f=!!d.btoa,g=function(a){var b=parseInt(a.width),c=parseInt(a.height);return a.getContext("2d").getImageData(0,0,b,c)},h=function(a){var b="";if("string"==typeof a)b=a;else for(var c=a,d=0;d<c.length;d++)b+=String.fromCharCode(c[d]);return btoa(b)},i=function(a){var b=[],c=a.width,d=a.height;b.push(66),b.push(77);var e=c*d*3+54;b.push(e%256),e=Math.floor(e/256),b.push(e%256),e=Math.floor(e/256),b.push(e%256),e=Math.floor(e/256),b.push(e%256),b.push(0),b.push(0),b.push(0),b.push(0),b.push(54),b.push(0),b.push(0),b.push(0);var f=[];f.push(40),f.push(0),f.push(0),f.push(0);var g=c;f.push(g%256),g=Math.floor(g/256),f.push(g%256),g=Math.floor(g/256),f.push(g%256),g=Math.floor(g/256),f.push(g%256);var i=d;f.push(i%256),i=Math.floor(i/256),f.push(i%256),i=Math.floor(i/256),f.push(i%256),i=Math.floor(i/256),f.push(i%256),f.push(1),f.push(0),f.push(24),f.push(0),f.push(0),f.push(0),f.push(0),f.push(0);var j=c*d*3;f.push(j%256),j=Math.floor(j/256),f.push(j%256),j=Math.floor(j/256),f.push(j%256),j=Math.floor(j/256),f.push(j%256);for(var k=0;16>k;k++)f.push(0);var l=(4-3*c%4)%4,m=a.data,n="",o=d;do{for(var p=c*(o-1)*4,q="",r=0;c>r;r++){var s=4*r;q+=String.fromCharCode(m[p+s+2]),q+=String.fromCharCode(m[p+s+1]),q+=String.fromCharCode(m[p+s])}for(var t=0;l>t;t++)q+=String.fromCharCode(0);n+=q}while(--o);var u=h(b.concat(f))+h(n);return u},j=function(a,b){return"data:"+b+";base64,"+a},k=function(a){var b=document.createElement("img");return b.src=a,b},l=function(a,b,c,d,e){c=c||(b?b.w:a.width),d=d||(b?b.h:a.height);var f=document.createElement("canvas");f.width=c,f.height=d,f.style.width=c+"px",f.style.height=d+"px";var g=f.getContext("2d"),g=f.getContext("2d"),h=a.style.backgroundColor;return h||(h="PNG"===e?"rgba(255,255,255,0.0)":"BMP"===e?"rgba(255,255,255,0.01)":"#FFFFFF"),g.fillStyle=h,g.fillRect(0,0,c,d),b=b?b:{x:0,y:0,w:a.width,h:a.height},g.drawImage(a,b.x,b.y,b.w,b.h,0,0,c,d),f};return{saveAsPNG:function(a,b,c,d,f){if(!e)return!1;var g=l(a,b,d,f,"PNG"),h=g.toDataURL("image/png");return c?k(h):h},saveAsJPEG:function(a,b,c,d,f){if(!e)return!1;var g=l(a,b,d,f,"JPEG"),h="image/jpeg",i=g.toDataURL(h);return 5!=i.indexOf(h)?!1:c?k(i):i},saveAsBMP:function(a,b,d,e,h){if(!c||!f)return!1;var m=l(a,b,e,h,"BMP"),n=g(m),o=i(n);return d?k(j(o,"image/bmp")):j(o,"image/bmp")}}}(),ec={},fc={cache:{},g:document.createElement("canvas").getContext("2d"),getTextSize:function(a,b){fc.g.font=a?a:rc.FONT;var c=fc.cache[fc.g.font];return c||(c=2*fc.g.measureText("e").width+4,fc.cache[fc.g.font]=c),{width:fc.g.measureText(b).width+4,height:c}}};ec.g=fc,Yb.g=fc;var gc={};setTimeout;gc.bcld=function(a,b,c,d,e,f,g,h,i){var j,k,l=a/2,m=[],n=[],o={vertices:[],faces:[],uvs:[],uv2s:[]};for(k=0;b>=k;k++){var p=[],q=[],r=k/b,s=r*(c-d)+d;for(j=0;e>=j;j++){var t=j/e,u=new $b;u.x=s*Math.sin(t*h+i),u.y=-r*a+l,u.z=s*Math.cos(t*h+i),o.vertices.push(u),p.push(o.vertices.length-1),q.push(new Zb(t,1-r))}m.push(p),n.push(q)}var v,w,x=(c-d)/a;for(j=0;e>j;j++)for(0!==d?(v=o.vertices[m[0][j]].clone(),w=o.vertices[m[0][j+1]].clone()):(v=o.vertices[m[1][j]].clone(),w=o.vertices[m[1][j+1]].clone()),v.setY(Math.sqrt(v.x*v.x+v.z*v.z)*x).normalize(),w.setY(Math.sqrt(w.x*w.x+w.z*w.z)*x).normalize(),k=0;b>k;k++){var y=m[k][j],z=m[k+1][j],A=m[k+1][j+1],B=m[k][j+1],C=v.clone(),D=v.clone(),E=w.clone(),F=w.clone(),G=n[k][j].clone(),H=n[k+1][j].clone(),I=n[k+1][j+1].clone(),J=n[k][j+1].clone();o.faces.push(new oc(y,z,B,[C,D,F],null,0)),o.uvs.push([G,H,J]),o.uv2s.push([G.clone(),H.clone(),J.clone()]),o.faces.push(new oc(z,A,B,[D,E,F],null,0)),o.uvs.push([H,I,J]),o.uv2s.push([H.clone(),I.clone(),J.clone()])}var K=!1;if(f===!1&&d>0)for(o.vertices.push(new $b(0,l,0)),K=!0,j=0;e>j;j++){var y=m[0][j],z=m[0][j+1],A=o.vertices.length-1,C=new $b(0,1,0),D=new $b(0,1,0),E=new $b(0,1,0),L=o.vertices[y],M=o.vertices[z],G=new Zb((L.x/d+1)/2,1-(L.z/d+1)/2),H=new Zb((M.x/d+1)/2,1-(M.z/d+1)/2),I=new Zb(.5,.5);o.faces.push(new oc(y,z,A,[C,D,E],null,1)),o.uvs.push([G,H,I]),o.uv2s.push([G.clone(),H.clone(),I.clone()])}var N=!1;if(g===!1&&c>0)for(o.vertices.push(new $b(0,-l,0)),N=!0,j=0;e>j;j++){var y=m[k][j+1],z=m[k][j],A=o.vertices.length-1,C=new $b(0,-1,0),D=new $b(0,-1,0),E=new $b(0,-1,0),L=o.vertices[y],M=o.vertices[z],G=new Zb((L.x/c+1)/2,(L.z/c+1)/2),H=new Zb((M.x/c+1)/2,(M.z/c+1)/2),I=new Zb(.5,.5);o.faces.push(new oc(y,z,A,[C,D,E],null,2)),o.uvs.push([G,H,I]),o.uv2s.push([G.clone(),H.clone(),I.clone()])}if(h!==2*Math.PI){!K&&o.vertices.push(new $b(0,l,0)),!N&&o.vertices.push(new $b(0,-l,0));var y=m[0][0],z=m[b][0],A=o.vertices.length-1,B=o.vertices.length-2,G=new Zb(0,0),H=new Zb(0,1),I=new Zb(1,1),J=new Zb(1,0);o.faces.push(new oc(y,A,z)),o.uvs.push([G,I,H]),o.uv2s.push([G.clone(),I.clone(),H.clone()]),o.faces.push(new oc(B,A,y)),o.uvs.push([J,I,G]),o.uv2s.push([J.clone(),I.clone(),G.clone()]),y=m[0][e],z=m[b][e];var G=new Zb(0,0),H=new Zb(0,1),I=new Zb(1,1),J=new Zb(1,0);o.faces.push(new oc(y,z,B)),o.uvs.push([G,H,J]),o.uv2s.push([G.clone(),H.clone(),J.clone()]),o.faces.push(new oc(z,A,B)),o.uvs.push([H,I,J]),o.uv2s.push([H.clone(),I.clone(),J.clone()])}return o},gc.buildCubeData=function(a,b,c,d,e,f,g,h){function i(i){var o,p,q,r,s,t,u,v,w,x;j=k.length;var y,z="six-each"==g||"front-other"==g||"back-other"==g||"left-other"==g||"right-other"==g||"top-other"==g||"bottom-other"==g,A=new Zb(0,0),B=z?new Zb(1/3,.5):new Zb(1,1),C=g.split("-")[0];"six"==C?C=null:B=new Zb(.5,1),"right"==i?(o="z",p="y",q="x",r=-1,s=-1,t=a/2,u=c,v=b,w=f,x=e,y=0,A=new Zb(2/3,0)):"left"==i?(o="z",p="y",q="x",r=1,s=-1,t=-a/2,u=c,v=b,w=f,x=e,y=1):"top"==i?(o="x",p="z",q="y",r=1,s=1,t=b/2,u=a,v=c,w=d,x=f,y=2,A=new Zb(1/3,.5)):"bottom"==i?(o="x",p="z",q="y",r=1,s=-1,t=-b/2,u=a,v=c,w=d,x=f,y=3,A=new Zb(0,.5)):"front"==i?(o="x",p="y",q="z",r=1,s=-1,t=c/2,u=a,v=b,w=d,x=e,y=4,A=new Zb(1/3,0)):"back"==i&&(o="x",p="y",q="z",r=-1,s=-1,t=-c/2,u=a,v=b,w=d,x=e,y=5,A=new Zb(2/3,.5)),C&&(A=C==i?new Zb(0,0):new Zb(.5,0));var D,E,F=w+1,G=x+1;for(E=0;G>E;E++)for(D=0;F>D;D++){var H=new $b;H[o]=(D/w*u-u/2)*r+h[o],H[p]=(E/x*v-v/2)*s+h[p],H[q]=t+h[q],k.push(H)}z&&(y=0);var I=new $b;for(I[q]=t>0?1:-1,E=0;x>E;E++)for(D=0;w>D;D++){var J=D+F*E,K=D+F*(E+1),L=D+1+F*(E+1),M=D+1+F*E,N=[new Zb(D/w,1-E/x),new Zb(D/w,1-(E+1)/x),new Zb((D+1)/w,1-(E+1)/x),new Zb((D+1)/w,1-E/x)];if(z)for(var O=0;O<N.length;O++)N[O].multiply(B).add(A);var P=new pc(J+j,K+j,L+j,M+j);P.normal.copy(I),P.vertexNormals.push(I.clone(),I.clone(),I.clone(),I.clone()),P.materialIndex=y,l.push(P),m.push([N[0],N[1],N[2],N[3]]),n.push([N[0].clone(),N[1].clone(),N[2].clone(),N[3].clone()])}}var j,k=[],l=[],m=[],n=[];i("right"),i("left"),i("top"),i("bottom"),i("front"),i("back");var o={vertices:k,faces:l,uvs:m,uv2s:n};return o},gc.bsd=function(a,b,c,d,e,f,g){var h,i,j=[],k=[],l=[],m=[],n=[],o=[];for(i=0;c>=i;i++){var p=[],q=[];for(h=0;b>=h;h++){
var r=h/b,s=i/c,t=new $b;t.x=-a*Math.cos(d+r*e)*Math.sin(f+s*g),t.y=a*Math.cos(f+s*g),t.z=a*Math.sin(d+r*e)*Math.sin(f+s*g),j.push(t),p.push(j.length-1),q.push(new Zb(r,1-s))}n.push(p),o.push(q)}for(i=0;c>i;i++)for(h=0;b>h;h++){var u=n[i][h+1],v=n[i][h],w=n[i+1][h],x=n[i+1][h+1],y=j[u].clone().normalize(),z=j[v].clone().normalize(),A=j[w].clone().normalize(),B=j[x].clone().normalize(),C=o[i][h+1].clone(),D=o[i][h].clone(),E=o[i+1][h].clone(),F=o[i+1][h+1].clone();Math.abs(j[u].y)===a?(l.push(new oc(u,w,x,[y,A,B])),k.push([C,E,F]),m.push([C.clone(),E.clone(),F.clone()])):Math.abs(j[w].y)===a?(l.push(new oc(u,v,w,[y,z,A])),k.push([C,D,E]),m.push([C.clone(),D.clone(),E.clone()])):(l.push(new oc(u,v,x,[y,z,B])),k.push([C,D,F]),m.push([C.clone(),D.clone(),F.clone()]),l.push(new oc(v,w,x,[z.clone(),A,B.clone()])),k.push([D.clone(),E,F.clone()]),m.push([D.clone(),E.clone(),F.clone()]))}return{vertices:j,faces:l,uvs:k,uv2s:m}};var hc=function(a){var b,c,d,f,g,h,i,j={},k=a.primitive;if(k.groups)return a.groups=k.groups,void(a.groupList=k.groupList);k.groups={};var l=a.material,m=a.getMaterialMapping();for(b=0,c=k.faces.length;c>b;b++)d=k.faces[b],f=l instanceof Yb.ArrayMaterial?d.materialIndex:0,f=m[f],h=f!==e?f:-1,j[h]===e&&(j[h]={hash:h,counter:0}),i=j[h].hash+"_"+j[h].counter,k.groups[i]===e&&(k.groups[i]={faces3:[],faces4:[],materialIndex:f,vertices:0}),g=d instanceof oc?3:4,k.groups[i].vertices+g>65535&&(j[h].counter+=1,i=j[h].hash+"_"+j[h].counter,k.groups[i]===e&&(k.groups[i]={faces3:[],faces4:[],materialIndex:f,vertices:0})),d instanceof oc?k.groups[i].faces3.push(b):k.groups[i].faces4.push(b),k.groups[i].vertices+=g;k.groupsList=[];for(var n in a.groups)k.groupsList.push(a.groups[n]);a.groups=k.groups,a.groupList=k.groupsList},ic=function(a,b,c,d){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=a,u=t,v=u.vertices,w=v.length,x=u.colors,y=x.length,z=u.sizes,A=z.length,B=d.__vertexArray,C=d.__colorArray,D=d.__normalArray,E=d.__sortArray,F=u.verticesNeedUpdate,G=(u.elementsNeedUpdate,u.normalsNeedUpdate),H=u.colorsNeedUpdate,I=u.__webglCustomAttributesList;if(w>A&&(A=w),t.sortParticles){for(_projScreenMatrixPS.copy(_projScreenMatrix),_projScreenMatrixPS.multiply(t.matrixWorld),f=0;w>f;f++)i=v[f],_vector3.copy(i),_vector3.applyProjection(_projScreenMatrixPS),E[f]=[_vector3.z,f];for(E.sort(numericalSort),f=0;w>f;f++)i=v[E[f][1]],j=3*f,B[j]=i.x,B[j+1]=i.y,B[j+2]=i.z;for(g=0;y>g;g++)j=3*g,l=x[E[g][1]],C[j]=l.r,C[j+1]=l.g,C[j+2]=l.b;for(h=0;A>h;h++)j=3*h,m=z[E[h][1]],m=null==m?1:m,D[j]=null==m.x?m||1:m.x,D[j+1]=0,D[j+2]=0;if(I)for(n=0,o=I.length;o>n;n++)if(s=I[n],s.boundTo===e||"vertices"===s.boundTo)if(j=0,q=s.value.length,1===s.size)for(p=0;q>p;p++)k=E[p][1],s.array[p]=s.value[k];else if(2===s.size)for(p=0;q>p;p++)k=E[p][1],r=s.value[k],s.array[j]=r.x,s.array[j+1]=r.y,j+=2;else if(3===s.size)if("c"===s.type)for(p=0;q>p;p++)k=E[p][1],r=s.value[k],s.array[j]=r.r,s.array[j+1]=r.g,s.array[j+2]=r.b,j+=3;else for(p=0;q>p;p++)k=E[p][1],r=s.value[k],s.array[j]=r.x,s.array[j+1]=r.y,s.array[j+2]=r.z,j+=3;else if(4===s.size)for(p=0;q>p;p++)k=E[p][1],r=s.value[k],s.array[j]=r.x,s.array[j+1]=r.y,s.array[j+2]=r.z,s.array[j+3]=r.w,j+=4}else{if(F)for(f=0;w>f;f++)i=v[f],j=3*f,B[j]=i.x,B[j+1]=i.y,B[j+2]=i.z;if(H)for(g=0;y>g;g++)l=x[g],j=3*g,C[j]=l.r,C[j+1]=l.g,C[j+2]=l.b;if(G)for(h=0;A>h;h++)m=null==z[h]?1:z[h],j=3*h,D[j]=null==m.x?m||1:m.x,D[j+1]=0,D[j+2]=0;if(I)for(n=0,o=I.length;o>n;n++)if(s=I[n],s.needsUpdate&&(s.boundTo===e||"vertices"===s.boundTo))if(q=s.value.length,j=0,1===s.size)for(p=0;q>p;p++)s.array[p]=s.value[p];else if(2===s.size)for(p=0;q>p;p++)r=s.value[p],s.array[j]=r.x,s.array[j+1]=r.y,j+=2;else if(3===s.size)if("c"===s.type)for(p=0;q>p;p++)r=s.value[p],s.array[j]=r.r,s.array[j+1]=r.g,s.array[j+2]=r.b,j+=3;else for(p=0;q>p;p++)r=s.value[p],s.array[j]=r.x,s.array[j+1]=r.y,s.array[j+2]=r.z,j+=3;else if(4===s.size)for(p=0;q>p;p++)r=s.value[p],s.array[j]=r.x,s.array[j+1]=r.y,s.array[j+2]=r.z,s.array[j+3]=r.w,j+=4}if((F||t.sortParticles)&&(c.bindBuffer(c.ARRAY_BUFFER,d.__webglVertexBuffer),c.bufferData(c.ARRAY_BUFFER,B,b)),(H||t.sortParticles)&&(c.bindBuffer(c.ARRAY_BUFFER,d.__webglColorBuffer),c.bufferData(c.ARRAY_BUFFER,C,b)),(G||t.sortParticles)&&(c.bindBuffer(c.ARRAY_BUFFER,d.__webglNormalBuffer),c.bufferData(c.ARRAY_BUFFER,D,b)),I)for(n=0,o=I.length;o>n;n++)s=I[n],(s.needsUpdate||t.sortParticles)&&(c.bindBuffer(c.ARRAY_BUFFER,s.buffer),c.bufferData(c.ARRAY_BUFFER,s.array,b))};gc.buildGroupBufferData=function(a,b,c,d,f,g,h,i){var j="basic"==f._type?!1:!0,k=f.isVertexColor(),l=f.needUV();j=!0;var m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L=i.needSmoothNormal(b,f),M=0,N=0,O=0,P=0,Q=0,R=0,S=0,T=0,U=0,V=0,W=h.__vertexArray,X=h.__uvArray,Y=h.__uv2Array,Z=h.__normalArray,$=h.__colorArray,_=h.__webglCustomAttributesList,aa=h.__faceArray,ba=h.__lineArray,ca=b,da=ca.verticesNeedUpdate,ea=ca.elementsNeedUpdate,fa=ca.uvsNeedUpdate,ga=ca.normalsNeedUpdate,ha=ca.colorsNeedUpdate,ia=ca.vertices,ja=a.faces3,ka=a.faces4,la=ca.faces,ma=ca.uvs,na=ca.uv2s;ca.colors;if(da){for(m=0,n=ja.length;n>m;m++)p=la[ja[m]],w=ia[p.a],x=ia[p.b],y=ia[p.c],W[N]=w.x,W[N+1]=w.y,W[N+2]=w.z,W[N+3]=x.x,W[N+4]=x.y,W[N+5]=x.z,W[N+6]=y.x,W[N+7]=y.y,W[N+8]=y.z,N+=9;for(m=0,n=ka.length;n>m;m++)p=la[ka[m]],w=ia[p.a],x=ia[p.b],y=ia[p.c],z=ia[p.d],W[N]=w.x,W[N+1]=w.y,W[N+2]=w.z,W[N+3]=x.x,W[N+4]=x.y,W[N+5]=x.z,W[N+6]=y.x,W[N+7]=y.y,W[N+8]=y.z,W[N+9]=z.x,W[N+10]=z.y,W[N+11]=z.z,N+=12;g.bindBuffer(g.ARRAY_BUFFER,h.__webglVertexBuffer),g.bufferData(g.ARRAY_BUFFER,W,c),h.__vertexArray=W}if(ha&&k){for(m=0,n=ja.length;n>m;m++)p=la[ja[m]],s=p.vertexColors,t=p.color,3===s.length&&k===Yb.VertexColors?(A=s[0],B=s[1],C=s[2]):(A=t,B=t,C=t),$[T]=A.r,$[T+1]=A.g,$[T+2]=A.b,$[T+3]=B.r,$[T+4]=B.g,$[T+5]=B.b,$[T+6]=C.r,$[T+7]=C.g,$[T+8]=C.b,T+=9;for(m=0,n=ka.length;n>m;m++)p=la[ka[m]],s=p.vertexColors,t=p.color,4===s.length&&k===Yb.VertexColors?(A=s[0],B=s[1],C=s[2],D=s[3]):(A=t,B=t,C=t,D=t),$[T]=A.r,$[T+1]=A.g,$[T+2]=A.b,$[T+3]=B.r,$[T+4]=B.g,$[T+5]=B.b,$[T+6]=C.r,$[T+7]=C.g,$[T+8]=C.b,$[T+9]=D.r,$[T+10]=D.g,$[T+11]=D.b,T+=12;T>0&&(g.bindBuffer(g.ARRAY_BUFFER,h.__webglColorBuffer),g.bufferData(g.ARRAY_BUFFER,$,c))}if(ga&&j){for(m=0,n=ja.length;n>m;m++)if(p=la[ja[m]],q=p.vertexNormals,r=p.normal,3===q.length&&L)for(E=0;3>E;E++)G=q[E],Z[R]=G.x,Z[R+1]=G.y,Z[R+2]=G.z,R+=3;else for(E=0;3>E;E++)Z[R]=r.x,Z[R+1]=r.y,Z[R+2]=r.z,R+=3;for(m=0,n=ka.length;n>m;m++)if(p=la[ka[m]],q=p.vertexNormals,r=p.normal,4===q.length&&L)for(E=0;4>E;E++)G=q[E],null==Z&&console.log("normal array is null"),Z[R]=G.x,Z[R+1]=G.y,Z[R+2]=G.z,R+=3;else for(E=0;4>E;E++)Z[R]=r.x,Z[R+1]=r.y,Z[R+2]=r.z,R+=3;g.bindBuffer(g.ARRAY_BUFFER,h.__webglNormalBuffer),g.bufferData(g.ARRAY_BUFFER,Z,c),h.__normalArray=Z}if(fa&&ma&&l){for(m=0,n=ja.length;n>m;m++)if(o=ja[m],u=ma[o],u!==e)for(E=0;3>E;E++)H=u[E],X[O]=H.x,X[O+1]=H.y,O+=2;for(m=0,n=ka.length;n>m;m++)if(o=ka[m],u=ma[o],u!==e)for(E=0;4>E;E++)H=u[E],X[O]=H.x,X[O+1]=H.y,O+=2;O>0&&(g.bindBuffer(g.ARRAY_BUFFER,h.__webglUVBuffer),g.bufferData(g.ARRAY_BUFFER,X,c),h.uvArray=X)}if(fa&&na&&l){for(m=0,n=ja.length;n>m;m++)if(o=ja[m],v=na[o],v!==e)for(E=0;3>E;E++)I=v[E],Y[P]=I.x,Y[P+1]=I.y,P+=2;for(m=0,n=ka.length;n>m;m++)if(o=ka[m],v=na[o],v!==e)for(E=0;4>E;E++)I=v[E],Y[P]=I.x,Y[P+1]=I.y,P+=2;P>0&&(g.bindBuffer(g.ARRAY_BUFFER,h.__webglUV2Buffer),g.bufferData(g.ARRAY_BUFFER,Y,c))}if(ea){for(m=0,n=ja.length;n>m;m++)aa[Q]=M,aa[Q+1]=M+1,aa[Q+2]=M+2,Q+=3,ba[S]=M,ba[S+1]=M+1,ba[S+2]=M,ba[S+3]=M+2,ba[S+4]=M+1,ba[S+5]=M+2,S+=6,M+=3;for(m=0,n=ka.length;n>m;m++)aa[Q]=M,aa[Q+1]=M+1,aa[Q+2]=M+3,aa[Q+3]=M+1,aa[Q+4]=M+2,aa[Q+5]=M+3,Q+=6,ba[S]=M,ba[S+1]=M+1,ba[S+2]=M,ba[S+3]=M+3,ba[S+4]=M+1,ba[S+5]=M+2,ba[S+6]=M+2,ba[S+7]=M+3,S+=8,M+=4;g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,h.__webglFaceBuffer),g.bufferData(g.ELEMENT_ARRAY_BUFFER,aa,c),g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,h.__webglLineBuffer),g.bufferData(g.ELEMENT_ARRAY_BUFFER,ba,c),h.__lineArray=ba}if(_)for(E=0,F=_.length;F>E;E++)if(K=_[E],K.__original.needsUpdate){if(U=0,V=0,1===K.size){if(K.boundTo===e||"vertices"===K.boundTo){for(m=0,n=ja.length;n>m;m++)p=la[ja[m]],K.array[U]=K.value[p.a],K.array[U+1]=K.value[p.b],K.array[U+2]=K.value[p.c],U+=3;for(m=0,n=ka.length;n>m;m++)p=la[ka[m]],K.array[U]=K.value[p.a],K.array[U+1]=K.value[p.b],K.array[U+2]=K.value[p.c],K.array[U+3]=K.value[p.d],U+=4}else if("faces"===K.boundTo){for(m=0,n=ja.length;n>m;m++)J=K.value[ja[m]],K.array[U]=J,K.array[U+1]=J,K.array[U+2]=J,U+=3;for(m=0,n=ka.length;n>m;m++)J=K.value[ka[m]],K.array[U]=J,K.array[U+1]=J,K.array[U+2]=J,K.array[U+3]=J,U+=4}}else if(2===K.size){if(K.boundTo===e||"vertices"===K.boundTo){for(m=0,n=ja.length;n>m;m++)p=la[ja[m]],w=K.value[p.a],x=K.value[p.b],y=K.value[p.c],K.array[U]=w.x,K.array[U+1]=w.y,K.array[U+2]=x.x,K.array[U+3]=x.y,K.array[U+4]=y.x,K.array[U+5]=y.y,U+=6;for(m=0,n=ka.length;n>m;m++)p=la[ka[m]],w=K.value[p.a],x=K.value[p.b],y=K.value[p.c],z=K.value[p.d],K.array[U]=w.x,K.array[U+1]=w.y,K.array[U+2]=x.x,K.array[U+3]=x.y,K.array[U+4]=y.x,K.array[U+5]=y.y,K.array[U+6]=z.x,K.array[U+7]=z.y,U+=8}else if("faces"===K.boundTo){for(m=0,n=ja.length;n>m;m++)J=K.value[ja[m]],w=J,x=J,y=J,K.array[U]=w.x,K.array[U+1]=w.y,K.array[U+2]=x.x,K.array[U+3]=x.y,K.array[U+4]=y.x,K.array[U+5]=y.y,U+=6;for(m=0,n=ka.length;n>m;m++)J=K.value[ka[m]],w=J,x=J,y=J,z=J,K.array[U]=w.x,K.array[U+1]=w.y,K.array[U+2]=x.x,K.array[U+3]=x.y,K.array[U+4]=y.x,K.array[U+5]=y.y,K.array[U+6]=z.x,K.array[U+7]=z.y,U+=8}}else if(3===K.size){var oa;if(oa="c"===K.type?["r","g","b"]:["x","y","z"],K.boundTo===e||"vertices"===K.boundTo){for(m=0,n=ja.length;n>m;m++)p=la[ja[m]],w=K.value[p.a],x=K.value[p.b],y=K.value[p.c],K.array[U]=w[oa[0]],K.array[U+1]=w[oa[1]],K.array[U+2]=w[oa[2]],K.array[U+3]=x[oa[0]],K.array[U+4]=x[oa[1]],K.array[U+5]=x[oa[2]],K.array[U+6]=y[oa[0]],K.array[U+7]=y[oa[1]],K.array[U+8]=y[oa[2]],U+=9;for(m=0,n=ka.length;n>m;m++)p=la[ka[m]],w=K.value[p.a],x=K.value[p.b],y=K.value[p.c],z=K.value[p.d],K.array[U]=w[oa[0]],K.array[U+1]=w[oa[1]],K.array[U+2]=w[oa[2]],K.array[U+3]=x[oa[0]],K.array[U+4]=x[oa[1]],K.array[U+5]=x[oa[2]],K.array[U+6]=y[oa[0]],K.array[U+7]=y[oa[1]],K.array[U+8]=y[oa[2]],K.array[U+9]=z[oa[0]],K.array[U+10]=z[oa[1]],K.array[U+11]=z[oa[2]],U+=12}else if("faces"===K.boundTo){for(m=0,n=ja.length;n>m;m++)J=K.value[ja[m]],w=J,x=J,y=J,K.array[U]=w[oa[0]],K.array[U+1]=w[oa[1]],K.array[U+2]=w[oa[2]],K.array[U+3]=x[oa[0]],K.array[U+4]=x[oa[1]],K.array[U+5]=x[oa[2]],K.array[U+6]=y[oa[0]],K.array[U+7]=y[oa[1]],K.array[U+8]=y[oa[2]],U+=9;for(m=0,n=ka.length;n>m;m++)J=K.value[ka[m]],w=J,x=J,y=J,z=J,K.array[U]=w[oa[0]],K.array[U+1]=w[oa[1]],K.array[U+2]=w[oa[2]],K.array[U+3]=x[oa[0]],K.array[U+4]=x[oa[1]],K.array[U+5]=x[oa[2]],K.array[U+6]=y[oa[0]],K.array[U+7]=y[oa[1]],K.array[U+8]=y[oa[2]],K.array[U+9]=z[oa[0]],K.array[U+10]=z[oa[1]],K.array[U+11]=z[oa[2]],U+=12}else if("faceVertices"===K.boundTo){for(m=0,n=ja.length;n>m;m++)J=K.value[ja[m]],w=J[0],x=J[1],y=J[2],K.array[U]=w[oa[0]],K.array[U+1]=w[oa[1]],K.array[U+2]=w[oa[2]],K.array[U+3]=x[oa[0]],K.array[U+4]=x[oa[1]],K.array[U+5]=x[oa[2]],K.array[U+6]=y[oa[0]],K.array[U+7]=y[oa[1]],K.array[U+8]=y[oa[2]],U+=9;for(m=0,n=ka.length;n>m;m++)J=K.value[ka[m]],w=J[0],x=J[1],y=J[2],z=J[3],K.array[U]=w[oa[0]],K.array[U+1]=w[oa[1]],K.array[U+2]=w[oa[2]],K.array[U+3]=x[oa[0]],K.array[U+4]=x[oa[1]],K.array[U+5]=x[oa[2]],K.array[U+6]=y[oa[0]],K.array[U+7]=y[oa[1]],K.array[U+8]=y[oa[2]],K.array[U+9]=z[oa[0]],K.array[U+10]=z[oa[1]],K.array[U+11]=z[oa[2]],U+=12}}else if(4===K.size)if(K.boundTo===e||"vertices"===K.boundTo){for(m=0,n=ja.length;n>m;m++)p=la[ja[m]],w=K.value[p.a],x=K.value[p.b],y=K.value[p.c],K.array[U]=w.x,K.array[U+1]=w.y,K.array[U+2]=w.z,K.array[U+3]=w.w,K.array[U+4]=x.x,K.array[U+5]=x.y,K.array[U+6]=x.z,K.array[U+7]=x.w,K.array[U+8]=y.x,K.array[U+9]=y.y,K.array[U+10]=y.z,K.array[U+11]=y.w,U+=12;for(m=0,n=ka.length;n>m;m++)p=la[ka[m]],w=K.value[p.a],x=K.value[p.b],y=K.value[p.c],z=K.value[p.d],K.array[U]=w.x,K.array[U+1]=w.y,K.array[U+2]=w.z,K.array[U+3]=w.w,K.array[U+4]=x.x,K.array[U+5]=x.y,K.array[U+6]=x.z,K.array[U+7]=x.w,K.array[U+8]=y.x,K.array[U+9]=y.y,K.array[U+10]=y.z,K.array[U+11]=y.w,K.array[U+12]=z.x,K.array[U+13]=z.y,K.array[U+14]=z.z,K.array[U+15]=z.w,U+=16}else if("faces"===K.boundTo){for(m=0,n=ja.length;n>m;m++)J=K.value[ja[m]],w=J,x=J,y=J,K.array[U]=w.x,K.array[U+1]=w.y,K.array[U+2]=w.z,K.array[U+3]=w.w,K.array[U+4]=x.x,K.array[U+5]=x.y,K.array[U+6]=x.z,K.array[U+7]=x.w,K.array[U+8]=y.x,K.array[U+9]=y.y,K.array[U+10]=y.z,K.array[U+11]=y.w,U+=12;for(m=0,n=ka.length;n>m;m++)J=K.value[ka[m]],w=J,x=J,y=J,z=J,K.array[U]=w.x,K.array[U+1]=w.y,K.array[U+2]=w.z,K.array[U+3]=w.w,K.array[U+4]=x.x,K.array[U+5]=x.y,K.array[U+6]=x.z,K.array[U+7]=x.w,K.array[U+8]=y.x,K.array[U+9]=y.y,K.array[U+10]=y.z,K.array[U+11]=y.w,K.array[U+12]=z.x,K.array[U+13]=z.y,K.array[U+14]=z.z,K.array[U+15]=z.w,U+=16}else if("faceVertices"===K.boundTo){for(m=0,n=ja.length;n>m;m++)J=K.value[ja[m]],w=J[0],x=J[1],y=J[2],K.array[U]=w.x,K.array[U+1]=w.y,K.array[U+2]=w.z,K.array[U+3]=w.w,K.array[U+4]=x.x,K.array[U+5]=x.y,K.array[U+6]=x.z,K.array[U+7]=x.w,K.array[U+8]=y.x,K.array[U+9]=y.y,K.array[U+10]=y.z,K.array[U+11]=y.w,U+=12;for(m=0,n=ka.length;n>m;m++)J=K.value[ka[m]],w=J[0],x=J[1],y=J[2],z=J[3],K.array[U]=w.x,K.array[U+1]=w.y,K.array[U+2]=w.z,K.array[U+3]=w.w,K.array[U+4]=x.x,K.array[U+5]=x.y,K.array[U+6]=x.z,K.array[U+7]=x.w,K.array[U+8]=y.x,K.array[U+9]=y.y,K.array[U+10]=y.z,K.array[U+11]=y.w,K.array[U+12]=z.x,K.array[U+13]=z.y,K.array[U+14]=z.z,K.array[U+15]=z.w,U+=16}g.bindBuffer(g.ARRAY_BUFFER,K.buffer),g.bufferData(g.ARRAY_BUFFER,K.array,c)}d&&gc.deleteGroupBufferData(a)},gc.buildLineBufferData=function(a,b,c,d){var f,g,h,i,j,k,l,m,n,o,p,q,r=a,s=r.vertices,t=r.colors,u=r.lineDistances,v=s.length,w=t.length,x=u.length,y=d.__vertexArray,z=d.__colorArray,A=d.__lineDistanceArray,B=r.verticesNeedUpdate,C=r.colorsNeedUpdate,D=r.lineDistancesNeedUpdate,E=r.__webglCustomAttributesList;if(B){for(f=0;v>f;f++)i=s[f],j=3*f,y[j]=i.x,y[j+1]=i.y,y[j+2]=i.z;c.bindBuffer(c.ARRAY_BUFFER,d.__webglVertexBuffer),c.bufferData(c.ARRAY_BUFFER,y,b)}if(C){for(g=0;w>g;g++)k=t[g],j=3*g,z[j]=k.r,z[j+1]=k.g,z[j+2]=k.b;c.bindBuffer(c.ARRAY_BUFFER,d.__webglColorBuffer),c.bufferData(c.ARRAY_BUFFER,z,b)}if(D){for(h=0;x>h;h++)A[h]=u[h];c.bindBuffer(c.ARRAY_BUFFER,d.__webglLineDistanceBuffer),c.bufferData(c.ARRAY_BUFFER,A,b)}if(E)for(l=0,m=E.length;m>l;l++)if(q=E[l],q.needsUpdate&&(q.boundTo===e||"vertices"===q.boundTo)){if(j=0,o=q.value.length,1===q.size)for(n=0;o>n;n++)q.array[n]=q.value[n];else if(2===q.size)for(n=0;o>n;n++)p=q.value[n],q.array[j]=p.x,q.array[j+1]=p.y,j+=2;else if(3===q.size)if("c"===q.type)for(n=0;o>n;n++)p=q.value[n],q.array[j]=p.r,q.array[j+1]=p.g,q.array[j+2]=p.b,j+=3;else for(n=0;o>n;n++)p=q.value[n],q.array[j]=p.x,q.array[j+1]=p.y,q.array[j+2]=p.z,j+=3;else if(4===q.size)for(n=0;o>n;n++)p=q.value[n],q.array[j]=p.x,q.array[j+1]=p.y,q.array[j+2]=p.z,q.array[j+3]=p.w,j+=4;c.bindBuffer(c.ARRAY_BUFFER,q.buffer),c.bufferData(c.ARRAY_BUFFER,q.array,b)}},gc.buildLineBufferData=function(a,b,c,d){var f,g,h,i,j,k,l,m,n,o,p,q,r=a,s=r.vertices,t=r.colors,u=r.lineDistances,v=s.length,w=t.length,x=u.length,y=d.__vertexArray,z=d.__colorArray,A=d.__lineDistanceArray,B=r.verticesNeedUpdate,C=r.colorsNeedUpdate,D=r.lineDistancesNeedUpdate,E=r.__webglCustomAttributesList;if(B){for(f=0;v>f;f++)i=s[f],j=3*f,y[j]=i.x,y[j+1]=i.y,y[j+2]=i.z;c.bindBuffer(c.ARRAY_BUFFER,d.__webglVertexBuffer),c.bufferData(c.ARRAY_BUFFER,y,b)}if(C){for(g=0;w>g;g++)k=t[g],j=3*g,z[j]=k.r,z[j+1]=k.g,z[j+2]=k.b;c.bindBuffer(c.ARRAY_BUFFER,d.__webglColorBuffer),c.bufferData(c.ARRAY_BUFFER,z,b)}if(D){for(h=0;x>h;h++)A[h]=u[h];c.bindBuffer(c.ARRAY_BUFFER,d.__webglLineDistanceBuffer),c.bufferData(c.ARRAY_BUFFER,A,b)}if(E)for(l=0,m=E.length;m>l;l++)if(q=E[l],q.needsUpdate&&(q.boundTo===e||"vertices"===q.boundTo)){if(j=0,o=q.value.length,1===q.size)for(n=0;o>n;n++)q.array[n]=q.value[n];else if(2===q.size)for(n=0;o>n;n++)p=q.value[n],q.array[j]=p.x,q.array[j+1]=p.y,j+=2;else if(3===q.size)if("c"===q.type)for(n=0;o>n;n++)p=q.value[n],q.array[j]=p.r,q.array[j+1]=p.g,q.array[j+2]=p.b,j+=3;else for(n=0;o>n;n++)p=q.value[n],q.array[j]=p.x,q.array[j+1]=p.y,q.array[j+2]=p.z,j+=3;else if(4===q.size)for(n=0;o>n;n++)p=q.value[n],q.array[j]=p.x,q.array[j+1]=p.y,q.array[j+2]=p.z,q.array[j+3]=p.w,j+=4;c.bindBuffer(c.ARRAY_BUFFER,q.buffer),c.bufferData(c.ARRAY_BUFFER,q.array,b)}},gc.deleteGroupBufferData=function(a){delete a.__inittedArrays,delete a.__colorArray,delete a.__normalArray,delete a.__uvArray,delete a.__uv2Array,delete a.__faceArray,delete a.__vertexArray,delete a.__lineArray},gc.getMaterial=function(a,b){var c=a.material;return c instanceof Yb.ArrayMaterial?(b>c.materials.length-1&&(b=c.materials.length-1),c.materials[b]):c},Yb.FontUtils={faces:{},face:"helvetiker",weight:"normal",style:"normal",size:150,divisions:10,getFace:function(){return this.faces[this.face][this.weight][this.style]},loadFace:function(a){var b=a.familyName.toLowerCase(),c=this;c.faces[b]=c.faces[b]||{},c.faces[b][a.cssFontWeight]=c.faces[b][a.cssFontWeight]||{},c.faces[b][a.cssFontWeight][a.cssFontStyle]=a;c.faces[b][a.cssFontWeight][a.cssFontStyle]=a;return a},drawText:function(a){var b,c=this.getFace(),d=this.size/c.resolution,e=0,f=String(a).split(""),g=f.length,h=[];for(b=0;g>b;b++){var i=new Yb.Path,j=this.extractGlyphPoints(f[b],c,d,e,i);e+=j.offset,h.push(j.path)}var k,l,m,n=e/2;for(b=0;g>b;b++){var i=h[b];for(m=0;m<i.actions.length;m++){var k=i.actions[m].args;for(l=0;l<k.length;l++)l%3===0&&(k[l]-=n)}}return{paths:h,offset:n}},extractGlyphPoints:function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z=[],A=b.glyphs[a]||b.glyphs["?"],B=0;if(A){if(A.o)for(j=A._cachedOutline||(A._cachedOutline=A.o.split(" ")),l=j.length,m=c,n=c,g=0;l>g;)switch(k=j[g++]){case"m":o=j[g++]*m+d,p=j[g++]*n-B,e.moveTo(o,p,0);break;case"l":o=j[g++]*m+d,p=j[g++]*n-B,e.lineTo(o,p,0);break;case"q":if(q=j[g++]*m+d,r=j[g++]*n-B,u=j[g++]*m+d,v=j[g++]*n-B,e.quadraticCurveTo(u,v,0,q,r,0),y=z[z.length-1])for(s=y.x,t=y.y,h=1,i=this.divisions;i>=h;h++){var C=h/i;Yb.Shape.Utils.b2(C,s,u,q),Yb.Shape.Utils.b2(C,t,v,r)}break;case"b":if(q=j[g++]*m+d,r=j[g++]*n-B,u=j[g++]*m+d,v=j[g++]*-n-B,w=j[g++]*m+d,x=j[g++]*-n-B,e.bezierCurveTo(q,r,0,u,v,0,w,x,0),y=z[z.length-1])for(s=y.x,t=y.y,h=1,i=this.divisions;i>=h;h++){var C=h/i;Yb.Shape.Utils.b3(C,s,u,w,q),Yb.Shape.Utils.b3(C,t,v,x,r)}}return{offset:A.ha*c,path:e}}}},Yb.FontUtils.generateShapes=function(a,b){b=b||{};var c=b.size!==e?b.size:100,d=b.curveSegments!==e?b.curveSegments:4,f=b.font!==e?b.font:"helvetiker",g=b.weight!==e?b.weight:"normal",h=b.style!==e?b.style:"normal";Yb.FontUtils.size=c,Yb.FontUtils.divisions=d,Yb.FontUtils.face=f,Yb.FontUtils.weight=g,Yb.FontUtils.style=h;for(var i=Yb.FontUtils.drawText(a),j=i.paths,k=[],l=0,m=j.length;m>l;l++)Array.prototype.push.apply(k,j[l].toShapes());return k},function(a){var b=1e-10,c=function(a,b){var c=a.length;if(3>c)return null;var f,g,h,i=[],j=[],k=[];if(d(a)>0)for(g=0;c>g;g++)j[g]=g;else for(g=0;c>g;g++)j[g]=c-1-g;var l=c,m=2*l;for(g=l-1;l>2;){if(m--<=0)return console.log("Warning, unable to triangulate polygon!"),b?k:i;if(f=g,f>=l&&(f=0),g=f+1,g>=l&&(g=0),h=g+1,h>=l&&(h=0),e(a,f,g,h,l,j)){var n,o,p,q,r;for(n=j[f],o=j[g],p=j[h],i.push([a[n],a[o],a[p]]),k.push([j[f],j[g],j[h]]),q=g,r=g+1;l>r;q++,r++)j[q]=j[r];l--,m=2*l}}return b?k:i},d=function(a){for(var b=a.length,c=0,d=b-1,e=0;b>e;d=e++)c+=a[d].x*a[e].y-a[e].x*a[d].y;return.5*c},e=function(a,c,d,e,f,g){var h,i,j,k,l,m,n,o,p;if(i=a[g[c]].x,j=a[g[c]].y,k=a[g[d]].x,l=a[g[d]].y,m=a[g[e]].x,n=a[g[e]].y,b>(k-i)*(n-j)-(l-j)*(m-i))return!1;var q,r,s,t,u,v,w,x,y,z,A,B,C,D,E;for(q=m-k,r=n-l,s=i-m,t=j-n,u=k-i,v=l-j,h=0;f>h;h++)if(h!==c&&h!==d&&h!==e&&(o=a[g[h]].x,p=a[g[h]].y,w=o-i,x=p-j,y=o-k,z=p-l,A=o-m,B=p-n,E=q*z-r*y,C=u*x-v*w,D=s*B-t*A,E>=-b&&D>=-b&&C>=-b))return!1;return!0};return a.Triangulate=c,a.Triangulate.area=d,a}(Yb.FontUtils),self._typeface_js={faces:Yb.FontUtils.faces,loadFace:Yb.FontUtils.loadFace},Yb.typeface_js=self._typeface_js;var jc={easeNone:function(a,b,c,d){return c*a/d+b},easeIn:function(a,b,c,d){return c*(a/=d)*a+b},easeOut:function(a,b,c,d){return-c*(a/=d)*(a-2)+b},easeBoth:function(a,b,c,d){return(a/=d/2)<1?c/2*a*a+b:-c/2*(--a*(a-2)-1)+b},easeInStrong:function(a,b,c,d){return c*(a/=d)*a*a*a+b},easeOutStrong:function(a,b,c,d){return-c*((a=a/d-1)*a*a*a-1)+b},easeBothStrong:function(a,b,c,d){return(a/=d/2)<1?c/2*a*a*a*a+b:-c/2*((a-=2)*a*a*a-2)+b},elasticIn:function(a,b,c,d,e,f){var g;return 0===a?b:1===(a/=d)?b+c:(f||(f=.3*d),!e||e<Math.abs(c)?(e=c,g=f/4):g=f/(2*Math.PI)*Math.asin(c/e),-(e*Math.pow(2,10*(a-=1))*Math.sin(2*(a*d-g)*Math.PI/f))+b)},elasticOut:function(a,b,c,d,e,f){var g;return 0===a?b:1===(a/=d)?b+c:(f||(f=.3*d),!e||e<Math.abs(c)?(e=c,g=f/4):g=f/(2*Math.PI)*Math.asin(c/e),e*Math.pow(2,-10*a)*Math.sin(2*(a*d-g)*Math.PI/f)+c+b)},elasticBoth:function(a,b,c,d,e,f){var g;return 0===a?b:2===(a/=d/2)?b+c:(f||(f=.3*d*1.5),!e||e<Math.abs(c)?(e=c,g=f/4):g=f/(2*Math.PI)*Math.asin(c/e),1>a?-.5*e*Math.pow(2,10*(a-=1))*Math.sin(2*(a*d-g)*Math.PI/f)+b:e*Math.pow(2,-10*(a-=1))*Math.sin(2*(a*d-g)*Math.PI/f)*.5+c+b)},backIn:function(a,b,c,d,f){return f===e&&(f=1.70158),a===d&&(a-=.001),c*(a/=d)*a*((f+1)*a-f)+b},backOut:function(a,b,c,d,e){return"undefined"==typeof e&&(e=1.70158),c*((a=a/d-1)*a*((e+1)*a+e)+1)+b},backBoth:function(a,b,c,d,e){return"undefined"==typeof e&&(e=5.70158),(a/=d/2)<1?c/2*a*a*(((e*=1.525)+1)*a-e)+b:c/2*((a-=2)*a*(((e*=1.525)+1)*a+e)+2)+b},bounceIn:function(a,b,c,d){return c-jc.bounceOut(d-a,0,c,d)+b},bounceOut:function(a,b,c,d){return(a/=d)<1/2.75?7.5625*c*a*a+b:2/2.75>a?c*(7.5625*(a-=1.5/2.75)*a+.75)+b:2.5/2.75>a?c*(7.5625*(a-=2.25/2.75)*a+.9375)+b:c*(7.5625*(a-=2.625/2.75)*a+.984375)+b},bounceBoth:function(a,b,c,d){return d/2>a?.5*jc.bounceIn(2*a,0,c,d)+b:.5*jc.bounceOut(2*a-d,0,c,d)+.5*c+b}},kc=function(){if(this._as=[],1===arguments.length){var a=arguments[0];if(a instanceof kc&&(a=a._as),a instanceof Array)for(var b=a.length,c=0;b>c;c++)this._as.push(a[c]);else null!=a&&this._as.push(a)}else if(arguments.length>1)for(b=arguments.length,c=0;b>c;c++)this._as.push(arguments[c])};Yb.List=kc,Yb.extend(Yb.List,Object,{size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(a,b){return b===e?this._as.push(a):this._as.splice(b,0,a)},addAll:function(a){if(a instanceof kc&&(a=a._as),a instanceof Array)for(var b=a.length,c=0;b>c;c++)this._as.push(a[c]);else this._as.push(a)},get:function(a){return this._as[a]},remove:function(a){var b=this._as.indexOf(a);return b>=0&&b<this._as.length&&this.removeAt(b),b},removeAt:function(a){return this._as.splice(a,1)[0]},set:function(a,b){return this._as[a]=b},clear:function(){return this._as.splice(0,this._as.length)},contains:function(a){return this.indexOf(a)>=0},indexOf:function(a){return this._as.indexOf(a)},forEach:function(a,b){for(var c=this._as.length,d=0;c>d;d++){var e=this._as[d];b?a.call(b,e):a(e)}},forEachReverse:function(a,b){for(var c=this._as.length,d=c-1;d>=0;d--){var e=this._as[d];b?a.call(b,e):a(e)}},toArray:function(a,b){if(a){for(var c=[],d=this._as.length,e=0;d>e;e++){var f=this._as[e];b?a.call(b,f)&&c.push(f):a(f)&&c.push(f)}return c}return this._as.concat()},toList:function(a,b){if(a){for(var c=new kc,d=this._as.length,e=0;d>e;e++){var f=this._as[e];b?a.call(b,f)&&c.add(f):a(f)&&c.add(f)}return c}return new kc(this)},sort:function(a){return a?this._as.sort(a):this._as.sort(),this},toString:function(){return this._as.toString()}}),Yb.ImageCache=function(){};var lc=Yb.ImageCache;lc.AlarmBillboardImage=new Image,lc.AlarmBillboardImage.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE0AAABrCAYAAAAy/A+bAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAABoKSURBVHja3F17jFxXff7O4z7n6fXa3uw6TuI81KiYFhRIpKA2iVBBaUNRvQlxSloQpNSiKaUgolR1wBRKCrRNWilIkIQKFSIcLw0EQitEmgImJXJL3ZgQk7h1nX16Z3fnPfd9+8fec3PmzJ31PmY3gSNdzezOzH189/f4fo9zLonjGFljYmICWzhyAC4GcAkAC8A2ACYAB4ALoA1gHsAUgDMA/M0+of379/f9jGPrRw7ArwG4lhDyRsbYaxljuwghIIQAAOI47novXpMtiKLohSiKfhzH8b8D+FcAJ7fyArYKtBKAmwkhN2uadh1jTBegyMD0AalrI4RwSumVjLEroyi6LfnuZBiGXwdwBMD3ft5Bu4YQ8j5N025hjNmU0hQQSmkqTYQQRFGEKIq6fkwI6ZI68XcYhoiiCGEYin3tZoy9H8D7oyh6Po7jhwE8BGDx5wm06wkhh0zTvF6AE8cxGGMpaEEQdF14lrTJ4KnvCSHQdR2UUvi+jyAIEAQBOOe/RCn9dBzHh4IgeIAx9jcAzr2aQXsNIeTvDcO4jnOeXhylFHEcpxcXRVGXyp1v9ANRSCYhBJxz6LqOMAzhui4AFDjndwG4MwzDexljnwXQeTWBVgDwSV3XD+q6zgGk6hcEAVzXTSVKVUEB4GqHAEzcCPE/oeKEENi2jTAM0el0AMDmnH88iqJ3x3H8x4yxb74aQLuGMfaPhmFcyhhLL0BIlbA/MmDiYsMwhOd56XdkAMV3BfhCYiml0DQNmqZ1qaqwl7IdzOVyCMMQzWYTjLFLOOePB0HwBUrpBymlrVcCNALgz3Rd/5iu61zYLN/34XleFwiyOnqeB9/34fs+wjBEu92G4zjodDpwXTcFOgxDiJvAGIOmaTBNE5ZlIZfLwTAMUErBOYdhGOCcd0mhDF6xWITrunAcB5zzOwgh14dh+DuMsWe3EjSLEPJF0zTfwRhL77LjOPB9vwcsoaK+78N1XSwtLaFWq6FaraYqtZYRxzEsy0KhUMD27dtRKBRS6TNNMwVLgEcpha7r0DQN9XodYRhepmnaD+M4fifn/OtbAdp2Qsi3Lct6gzDAQrqCIOgBSwBZq9UwNzeHpaWlLvskHIaQkH5DtYVCcs6dOwfTNDE0NISRkRG4rgvDMGAYRuqxwzBMASyXy2g0Guh0Onld178WRdGHOOf3rXTsjYK2kzH2HcMwXitUw3XdVB0FhwrDEI7jwPM8LC4uYnp6Gq1Wq8f+yHYoCzj5uzJosucVdnFmZgazs7MYHh7G2NgYLMuCYRgwTbPH9uXzeTiOg1arRXVd/9s4ji1N0z61WuDWAtoOxthTpmleCQCMsVSKZGPvui5c10Wr1cKZM2dQq9Ugvi+DJNsfSmn6uaxWqtqqNEXcIHmbn59HpVLB6OgoRkdHEYYhTNMEYwyMsdQcmKYJSilqtRp0Xf/LKIqoruufFFxyEKDZhJDHDcO4EgA45+h0OinnEiTVcRy4rovJyUlMTU11gSVAEJsw7uJi5O/JxlzlairHE8cWDkRI/fT0NBYWFnDppZeiVCrBNE3oup4eGwB0XUe5XMbS0hJ0Xf8LAGd0Xf/y+YDjq/SSj5imebU4oAyYuMOdTgftdhunT59GrVbrAUtIFOc8BYxznv5fBanfkFVIlbg4jmEYRuqdfd/Hc889h4suuggjIyOIogimaaY2TtCXUqmExcVFYhjGw4SQGULIkxsF7S7Lst4mAHMcpwsw3/fhOA7q9TpOnToFz/NSwGTQdF1PWbsArh9QWWqZ9ZmQNrE/8Z5zDk3TUm89NTWFVquFvXv3IooiWJbVdRMMw0CxWES9XtcBHKGUvg7AS32l6Dz5tGt1XX+KL4+UNqiALS0t4YUXXkAURV1gCbXTNA26rkPX9S7bNoihZkWECotz9DwPnufBdV3k83ns3bsXtm3DsqwuDSCEoFarodVqwTTNH9i2fd2tt94aZkr7SqERY+zLjDEuB8WyDXFdF7VaDadOneoCTBh2TdNgWVZ6kpqm9TiDQW1ZN0vXdZimCdu2Ydt2aj4EmVaJd6lUAmMMruu+qdPp/HlfE7ECaPdqmnaRYNYi3BGe0nVdNBoNnDp1qsvgC8AMw4BlWbAsK81GqJ5zEEPen0poBQ8UpNe2bbiuizNnzsDzPDiO0+ORh4eHhYTe/aUvfemKVYM2MTFxlaZp7xN3TQ6LAMDzPHQ6HTz//POIoqgLMPkEZekaNFj9wOsneSLcsiwLnU4H09PTKSmX01OMMZTLZXieZ3Q6nc995StfIatyBISQT1NKGaW0Z6eCzJ4+fRpBEKSAiRPTdR22bXep4lYPOXUkczP55lWrVeTzeQwNDUGmGIL8tlot+L5/g+M4NwH4xoqOYGJi4npd15+UvaVKLaampnD27NkULBUwwYfOFxpt5pAzKmoEIRKWnufhiiuugGVZKQEW5+z7PqampmAYxolCofC622+/Pe6rnoSQjwsbJTylOAHf99Fut3sAE0ZXACar6ys1ZPuqkmpBSzjnmJ6eRhRFaWQjhqZpsG0bvu//SqfT2d/Xpk1MTLyBc/4mORcv7pYgi2fOnOmxF8JLCcBebUMGTgZU0zR0Oh00m82uJKnQvm3btiGKInie96GVHMFBWTzlnFgQBKhWq2g0Gl0H5Zz3ALYR6lAqlbBnzx5ceOGF2L17N3bs2NGToV3rJgOXxSFnZ2cBIM3SiONJ0nbN5z//+Tf2OIKJiYltjLFb5dBELoKEYYjp6en0wEIFTdOEYRjQdT2Tza9lvP71r8cNN9zQ8//Z2Vk8+OCDXdRlvRIn1xVkLarX6yiVSl0ZZkopisUims0mHMd5L4BnVEm7iRBiUUoRBEHXwUTKuNlspictuJhhGGnqeaOUQgCvjpGREdRqNfi+v2E6ooZ3wsYtLCyAEJKqqQDUNE1omoYgCMYfeughXQXt7XLSTq0vzs3NZTLuraIWjuN0Ger1gieDJoMnQsKsEC2fzyOKom2O41yXgjYxMWFRSt+qxnBCz4MgwNLSUpdqilhSzrxu5lhtuW+14Mk2TrwXuT+VsuRyOXHjbpRt2huTvH9PyjqKIlSr1bQqLrPrQdix9ajYIGmJuC5KKer1Oi644II0jpbpB6UUURT9egpaFEXXCjslOwDxWqvV0rsjFyk240KyRlK/HMix5DYHkU4SAIokhG3bXRGFKAfW6/V9DzzwQIkmP3iduhPhAKIoQrPZ7EkkipLZVkiZINODOJYa4MsOgnOOdrsNtYNJVL/iOGau6+4T6vnLWXYjiqK0QCLXIIXr34yMRb//iyzvII4npE2oplxGbLfbmclPTdOEIL2GT0xMaAAul7mZbAQdx+kymrLHlKtFmwVaHMeIJHs6qOMJ4i6He+J6ZUlMCW2iWVEUXUkBjArbltW5kzSTdEUBagluUKNer2cABkQD8por9YXI/SBqjVWk0ZPPL+EAdvcryIpUkMxx1DhukOrZaDRetqdRjBgxwihCpPSoDcpzCrVU9+15XpczEF5W13UEQbCbh2E4KnQ2K9/u+35XzkwlhpvBx5alaxmsKIoRhvGmSVlWaVEVHllF4zge5QCKAvGsL8uxmuBoqrQN8kIiLAMWRomURTGiONqUVLmQNpmzqbREjV3jOLY5AFvOImSxbtklZ2UQBogaoihCECagxUmrQ3IRm+GtVTWV+9yEd1VAK/A4jnP9xFG1IZvOyeIYYRQjSKQrSqRtcWFxyzihKtFZNVcex7HfL6ZTg1o1QzBwzJKTDKNw2REkUlZdWtwUG6p2VQqpW4kVxHEccACLsi5nGT/VLW+m5C3bsmUJEyBCCuG2oqKVlYSQ8mxVDmBGTm2rOxFMuB/NGOhFEJI4AQkwAHSFTqKNeOl+Q9hu9TtJsXyBEkLOytGA6oblvgfZMG6Gii4tLCzTDInyUEJAN0G6Vjp30ZraowVhCELIS1wGTS2KiOysfAAR+W+GpAVBAIKXpZkRAkYp2IBvVD+GIAhsFtEX0VEcx/9Hb7nlliaAKVnSZAoimHG/A8kh1kY3xhhAlqWLUwqNM+icgTM6sGOoM2XU+Nm27S7PKYPn+z4IIado8uNn5bqAfEc557Btu6tRRAVskIOCQGMMutg4AyUDPoYUoKvA5HK5noq7ACwhvc+KszkRBEEPAKJmUCqVBp5y7us9Qx8aY9D48sYpxdLS1vE0y7JSCiJfq+hnoZT+F0+k5piwKUKEhboyxlAsFjE3N5emwlcKNTY6Jo4cwa5du8AZBxDjxRdfxOTkJMrl8qbm7kQXpWEYmUyi0+kgiqL/PXTo0CxPgPkhpTT2fZ8YhtGz43w+D8MweoxjVnf2RofrODj1/PPp1CBCCIaGhmBZVtcEi0EVaWRpKpVK4Jx3CYcY7XYbQRAcWzYhAA4cOLBAKT3heV6PXQvDEJxzbN++fTkuTBr7sjzMIJrzbNvG5Zdfjje/+c24+uqrsXfv3vSmZTU8r7XSroIhA1gqlVIvqqb9XdcFpfRJuRoFAP/suu6vFgqFTCB27tyJSqWSdt2o9m8QEpDP57F///6eovFTTz2FkydPdnUjbTRrqzq0crks8mU9oCU115hS+i+ppCUq+oTwEqpXDIIAmqZh586d8DyvR7RVr7rebd++fZlV9muuuQaNRiNV1/VIWD/wRGF8+/btXekheSQNMicOHTo03QUa5/wYY2xWlMtU0iekTQCrTjnsV+VZyzY0NJR5caZpCpuyLsD61R7Eq5hnIGiFanZarRbCMDz6Mi1KxoEDByJK6dfk0rxM/nzfh67rGB0dTZuW1QNs1KOuRGdkW7rRcEkuHBFCsGvXrq76gHweSUckGGOP9oCWSNsjoiKT5R2jKMLw8DA0TeuaoykXIzbC4+QawSDT52onpDyHa2RkBJqmpWZHvTGNRgNBEPzHPffc87N+oB1jjJ2SVVQWcVFkufjii9MmP9V9q0Z0LaokOsXV8cwzz/SdLrRaT6m2vwNAoVDA0NBQpoQJr5mo5he7oxZp3HbbbTHn/B8ER1LzaAI40zQxNjbWI21ZgK1lzM3N4ciRI3j66adx+vRpnDx5Eo899hieeOKJlKdtRO3lsIkxhrGxMRBCuqRMlrRmswnP8zqMsUe6hEs9gK7rDzqO87FOp2Pk8/keiRFzCMrlMlzXRb1eT4mvHNOtJ+fGOcfS0hImJyfT6USCu6kN0Ku1jTJQYiOE4MILL0wnxsmeVN7/0tISfN8/cvjw4cW+kgYAt99+e4Vz/lXZvqiiLybEjo6Oolgspmoqt873Y93nm3Wi6zpKpRK2b9+OHTt2YMeOHdi2bRts2+5pOs6iFVlSpS5lsWfPHti2nU6+kCVM3Ph2uy3M0d/1JhWyk3D3iR/KO5JVVXiVsbGxdIK9fHKquq7WQYhSoZgoIToRV5NNUac3qk4qiiLs2bMHuVwubfWXz1mVsiAIvn/48OH/XBVo73rXu37MGPvOStJGCEGj0YDv+9izZw8KhUIKnDx5X7V3a11SYlXFZWX//baLL74YhUIhXWBABkwWDjHJNwzDT2enr/oMXdf/SsxB7ydtwHL/heu62L17N3bu3Nklaf1WTMhS4fVSiCyw5MmzwuhfdtllyOfz6HQ6qTmRuZ8sZYuLi/B9/yTn/FuZtneFPPl3Hcf5Qa1We5Npmn1L+XEcixUIMDw8jHw+j7Nnz2YmLbNWRlALGCux95UyFbIEy9PDi8Uidu/enXpDWSVlwIRQeJ4nQrZPHD58OF4TaLquwzCMj7bb7e86jpPO+RazcuUeL5k5Dw0N4YorrsDs7Gy6MoL4br95Bv0AXIk6ZPFCGSxKKXbv3i0mh6HdbnfNiRCACecixsLCAnzfPylHAKsGLTHGTzqO82S1Wr1hZGRkRWkTd6lSqaBQKGBsbAzDw8OYmppKvZR8V+OMVoOVwrCVkgQqOR0eHsYFF1yQMno5ppQlTJ4LJWxZImWHDh8+HK0ZNFHKMk3zrlar9Uyr1SK5XK5L2rIuRnSCdzodbNu2DZdffjlarRZmZ2dTbywvNqKmaFYLWtYiTzt27MDw8HDKv4SHlCeSyUZflfRKpQLf948xxh5bkU+u9CFjDKZpHncc56u1Wu1W0RouGprlBhKVUDqOg7m5OViWhXK5jMsuuwy+72NhYUGQxq5UjwpYv/U4VLUUoZBIIDqOg0aj0QWWLGFyw7V8nFarhWazGYdh+BG51rtm0IRtsyzrrnq9/rZqtWqXy+W+FEQFTsRurutC0zQUCgWMjIxgbGwsnchVr9fTpSlk0PpNtBDTuwuFAgqFQnoDm81mV8pKBUtufZd70cSYn5+H7/uPcM5/KMqW6wYtsW1nNU37bL1evyefz6dNw+JEVKcgv5fnVonlczRNQy6Xw9DQEIaHh1NplVe4EqCJY4m1hGSD32q1ulafkT8TPDGLZ6pEOTEn7SiK7hYh24ZAE9KWy+Xurdfrty8sLFyya9euTKcgN8mpwKmTVD3PS+cnyLNgxMw+UeARFy9LkqquMjeUDf1KgAkp830flUoFnud9Qtf1syIK2TBoibR1NE27s9PpfLPdbsO27R6nIDfDrURM5eBYrnyLwk5WIbqfbZPVL6uYLXvsfsbf87yfMsb+2jRN5HK5vhPb1gSaUJN8Pv+tIAgerVQqN4+NjXVxnCzbtloAs/bRrzaZRTlW4nb9EgOC7Nbr9TgMw4OGYXi5XK5rWnb/LoBVDhFEm6b5R3EcVwRxzZrRpq5MtdrQSF7zo98mx7T9wrB+M1LkcwvDEOfOnYPrul/gnP+bWMxuNTOj19QkQSmFbdvndF3/k2azmeaiZPc9yOa/9cSoq1XLc+fOwXGcaQAfMU0ThUIBhmFsDmi6riOfz3+ZUvr4wsJCl+FXJW6remT7AdZPyoRa+r7/Xl3Xa2INkdVmhtfcjpMQXti2/YdBECwtLi72MOysVaq2EkDVwcjaEASBUMuHOOfftiwL+Xw+pTObApoALpfLTRuG8b5Go5Guwpdl37YKuJVqrrLKzc3NwXGc/wHwQdM005aHtazysC7QhJrmcrlHKaUPz8/Pp/PeVfu2FRLXz46px65Wq2g2m6Hv++/Udb2Zy+XSNPqarn+9J8oYQyLaHwDws3Pnzp23DrCVdkz15K7rYn5+Ho7jfFTTtKdt20Y+n1/XCgwbajFkjMG27aZpmr/ruq6n2rfNlrbzSZhML6anp+F53pOMsXuFt1wNJxs4aJI3Pc4Yu6tarXYVYzbK3zYiYTIYCb2YDcPwnbquh/l8HrZtr7uOuuFmVuFNi8XifYSQR0XH5GbytyzG30+ql5aWUK/XQ8/z3qFp2kw+n4dIOqxbWAahJpxzscLxewA8Pzc315NOHqSqrlYt2+22sGN3c86/J1JKa/WWmwIakK7L0zBNc7/ruq1KpdIljYOiImqisp/h930fs7Oz8Dzvnxhjn7UsC8Vicd12bFNAE6t4FgqF5zjnv99sNuNqtdpXjdYDXJYdW8nwdzqdn0RR9G5d1+NisZguhrfhax2k+xc0pFQqTRBCPr64uJjpGNYD3PlUUjX87XZ7MQzDt+u6XisUCgMDbOCgycAVi8XDhJCJubm5NE+metTVzqpbC2CVSkUY/ps55y/KdmxQE0U2ZWWlJPcW27b9e3Ec//f09HRP65bczKJSkX7Sl2UXVca/uLgIx3Hu5Jw/ads2SqUSLMsa6GJ4mwKamLpdKBTalmX9ZhiGkzMzMz2dOVn2aCXwZA6m/q7VaglPeT9j7HOJmVhXmPSKgCYnLQuFwqRpmm9xXXd+bm4u06Oeb2GUfk5EfnjE7OwsXNf9BoAPiWWlB2nHtgQ02b4lHvWmZrPZXg1wWYvE9eNivu9jZmYGjuP8KIqiA4ZhhMViEblcblMA23TQpPgU5XL5R5qmHWg2m2E/DrcSQFkqGYYhpqam0Ol0XgzD8CZd19vFYhGFQmHDSyG+oqAJx5AY5W9QSu+s1WpYWFjoAk5dAlb9W62Mh2GIyclJtNvtSd/3b9A0bb5QKKBYLG6Y8b8qQBMRQy6XQ7FY/Bwh5N5qtYpqtdqlhur63/IyPbK3jaIIMzMzaLfbC77v36hp2kvJvgfC+M8rBFuZw0+oCOI4vrter+cWFxfvpJR2TUtU29nV/4unWjQajZrneW/VNO3ZXC6Hcrm8KZ7yFQdNtBckPbofaDab9vz8/HuA5YV4zxcVCBvWaDRanufdqGna8cRebhlgWwba+Pg4wfJjR1hiEigAcu211/7pjTfemJ+fn39HHMcYGhrKJLaiH2Rqagr1er1dr9dv+cxnPnMCgA0sL08ktqNHj0Y/t6CNj4/zZP9MASsF7dixY+Sll1768B133JGbm5v7Ld/30/4yWR07nY6wYU6lUvmD+++//8dYfv5enIAlXqPx8fEQQAggABAePXo0HPS1kUE/fnd8fJwB0AFoCVg8AalLyqRXPjw8nDt48OCnDMN4S0KIoet6Clij0YDnec7Zs2c//PDDDz+F5acnxlmgJYBFCWgBAO/o0aPeWq9jpcfvDhS08fFxCsBIANMUSWMKYHkAwwCKAHKGYVgHDx787XK5/BuUUiZLmuM4lRMnTjz0xBNP/AzLzzFuAahi+bmdvgRcKAEXJp/56wFuK59ZLIPSo47KZ6VkKwDIua5r3Hfffd+/6qqrfrJv377XmKa5PY5jv1KpnH388cd/6i5PHylKEhwlEieSdpFEoWLpbwqAjo+Pk6NHj8avRpumqkokgUWkzwCglgAQJ2pkAtCOHz/eOn78+HTyfUiSE+Dlp2U3k9/XpeOox40VBxFvuk1ba+pZjpxWadNkqbOx/ChxI/ktVUALAHh4+fHizlpsWrL1jPVeOxnElJs+4J3Xe2Zs6S7V68t4lQFTQQsl0KJBgTVQ0FYJYj9pywKt34gl4LIAizYDpC0B7Rd9/P8A12VCYmM3Gg8AAAAASUVORK5CYII=",
lc.Logo=new Image,lc.Logo.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABAAAAAIACAYAAAAczR65AAAACXBIWXMAAAsTAAALEwEAmpwYAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAF+CSURBVHja7N13nCT3ed/5pzpMT+40s5M6zGycXSxyIhY5ESQCqURR1FnW2Zb0kixLtuTzvex72eezzz6dJcq0jmfLd7Ysn2wSFCiSEgkQAEEiExkL7GLDbN6ZDhM6T0/q6VD3B0SQABbY2d3f02k+77+ADc+v6vlV9XZ9p6p+1tv7H7UFAGDErIMeAIApVRmlCQBgEF9VAQAAAAAgAAAAAAAAAAQAAAAAAACAAAAAAAAAABAAAAAAAAAAAgAAAAAAAEAAAAAAAAAACAAAAAAAAAABAAAAAAAABAAAAAAAAIAAAAAAAAAAEAAAAAAAAAACAAAAAAAAQAAAAAAAAAAIAAAAAAAAAAEAAAAAAAAgAAAAAAAAgAAAAAAAAAAQAAAAAAAAAAIAAAAAAABAAAAAAAAAAAgAAAAAAAAAAQAAAAAAACAAAAAAAAAABAAAAAAAABAA0AIAAAAAAAgAAAAAAAAAAQAAAAAAACAAAAAAAAAABAAAAAAAAIAAAAAAAAAAEAAAAAAAAAACAAAAAAAAQAAAAAAAAAABAAAAAAAAIAAAAAAAAAAEAAAAAAAAgAAAAAAAAAAQAAAAAAAAAAIAAAAAAABAAAAAAAAAAAgAAAAAAAAgAAAAAAAAAAQAAAAAAACgVbloQfPyxo/J+KP/kEa0sdi9/0qy266iEWg5ll2Tu//074hrLaU2xul9vyPHr7qbZl/w3Nhy15/9XXEvx4zXfvkLfyIF/xBN3oBb/+J/k56FN1Rq19y98oO//d+l6uRrHKDlypf+m4Te/pJa/VP7/qVMXfUgjUbdcQcAAOCC2ZZDsuO3q44RjL1Noy+CNzuncvEvIjKQOE6DN8CztqJ28S8ikovcwcU/oMhZLcvw1J+rjjF25Jti2TbNBgEAAKA1pKJXqdbvTzwv7nKJRl+gwfiUWu2BmQM0eCN9mjutWj8duZImA4pGZw6Iay2pOkZn/m0ZmD9Fs0EAAABoDQtjO1TrW7WqBOfO0ugLvficflOttjf+rDirZZp8HoHElGr91NhOmgwoCk19ry7jhI89TbNBAAAAaA2lzh4pjtysezGbOEqjL0BHaVX6E8/rfWmorElwfoZGny8AiOnd/r/mm5Sl/iBNBpR0L+ckcPYbdRlr6PjD4i6v0XQQAAAAWkN6/HrdC6np12jyBRicPSWWXVMdY0D5p9utf/FQkK7sIbX6mfF9NBlQFD75kkidns13lAsyduZNmg4CAABAa1gI79a9mMoclO7lAo3e6MX5zDvqYwSm+bL6cYLKz/+nwpfRZECJZdsydvibdR0zdPS7NB4EAACA1pAPjkq5e1T3ojbJS5I2+sV14Mzz6uP0LrwmnatLNPyjAoC43mMrtsMl6eFxmgxo/Xszf0q68m/VdUxv4nHpL8zTfBAAAACan21Zktl6p+4XsvghGr2RL5GKy/99aE5mCWU+SmDmFbXahdCdUnF7aDKgpFEv5Qsff4HmgwAAANAaUpHLVev7p19kreQN0Fz+70MBQPwIDT+H3sWMdBT1HgFIR6+myYASd3lNho4/3JCxR49+XRy1KpMAAgAAQAsEACPbxLb0/jlxryTFm+P2yPNelNfx2fzAGX5adc45SJ7UPddY/g9QM3bmTXGUG/POmY6lEzKUZNUbEAAAAFrAuqdLFkN36F5YJY7T6I/78qi8/N+Hxluekf7cAo3/gIDispXrPREpBIZpMqCk0S/jC039gEkAAQAAoDWko9eo1g/GDtDkj1GP5f8+aCB5gsb/BMu2JTDzolr9zMStNBlQ0l+YF2/i8cZ+jp/8qnjWeMEqCAAAAC1AezlAb+xZcVbLNPqjLsbrsPzfh8cklHnfBURuXlyrc2r10+G9NBlQ0gwv4bNqZQmffo3JAAEAAKD5FfxDUurbpvePVbUkwfkZGn2uL411Wv7vg3yxZ8VZrTABf21gVvH5f8uS1Oh2mgxo/PtSq8ro0a83xbaMHfkrJgQEAACA1pDZqnuL8kBiiiafQz2X/3vfF4jKigQWCGV+JKC4XGVxeJ+se7poMqBgKHlUOpaa45Gm3oUXxJ+JMSkgAAAANL9U+DLdC6w6vuW+ldRz+b8PGkgcYwJExFGriS+mdwtxevw6mgwoCU19v6m2J3z8OSYFBAAAgBYIAEa2ie10q9XvXXhNPGvLNPqDF+ENDEaC028wASLiyyTEua63fFgqNEmTAQWetSUZPPlwU23TyNGv8XgVCAAAAM2v4u6QfPgu1TEGlddZbzX1Xv7vg3rnXxXP2sqmn4eg4nFZ6RyU3MAYBzugIHzqVbFqzfWCWddaUkZiB5kcEAAAAJpfavxa3Qut+FGa/BMasfzfBw3Mntr08xCI631Zz0ZvF9vi6xqgYezot5tyu0JHn2RyoMZFC5rX4ugOOfS3v9HS+9BVmJdt3/i7KrWP/tJXpOrubOn+1FycgmizAGBsl+zUDACmXxKRX6DRP7r4bsDyfx/ahthhSUxcvmnnwFktizeudxdGOnIFBzqgwJ+JSe/CC025bcGzfyHdy78hKz0+JgoEAJuJ7XBItcPT0vtQdeltf9Xd2fL9AdpN0RuUNd9u6czr/KS+o3ha+vMpWfQNbvpeN2r5vw99Ud3koUwgFRdHtaRWn+X/AB2RY8828UWALeGTL8mxK+9nomAc95QBAIxKb71Ftf5A8gRNlsYt//dBPwplNqug4koIy4PXympPPwc7YJizWpHhqT83Vm9uz69JZqvZIHTsyDdFxGayQAAAAGhuC8rLAQYV11tvJY1c/u+DNnMoE4gdUKudid7AgQ4oGJk5IK61pLF6iwNbpbBll9Ft7Mrtl8F53rECAgAAQJPLDI9LzdWtVt83/Yw4atVN3+dGLv/3QcFN+sZqd7kkfbM/VKufCu/mAwVQEJ4y+5K9oj8kiwPjxrcz1MyPKYAAAAAAEZGq0yW58XvU6jvLRQmk4pu6x41e/u+D/DPPbspQJjh3Vm0Vhpq7V7JbInygAIZ1L+ckcNbsS7YXfaOSD4SMb+vwsa+Iu1xi0kAAAABobqnIlboXXorPXbeCZlj+731fJspLEliIbbp5CMweV6udi9whVSfvagZMC598WcQ292z9es82WenxyXJvQCqeYcOfrQUZPbufSQMBAACguS2EdqnWD868tan72wzL/31omxJTm24egjN6j2GklUM0YHOyZeyw4Z/+j9z41/9lSXHoRuNbHD76XaYNBAAAgOa20uuTlYGr1er3zf5QOtbXNmVvm2X5vw9dDE9vrp9SedZWpGfhDbX6qbGdfJAAhg3OnZKuvNkAOT/043d1FAfNh9/e+GPSt7jA5IEAAADQ3NITn1C8CK5JcO70puxrsyz/90F98y+Lp7SyaeZhQPH4W/NNylJ/kA8RwLDw8WeM18wO//iiP79lu852n3iRyQMBAACguWkvBzgQO7op+2pq+b817y5J7fwZcxtm2zKQ3DxLVgUUH3nIjO/jAwQwzF0uydCxrxqtWXP1SPYn3v6f2bJNZdvHDn+9qd77AgIAAAA+JLslLNUOv94F2Myrm7Kvppb/W+8dlvVun9FtCyY2TygTiCne/q8cngGb0djZN8VRLhitmQ996n0v61zp8cua7yrj296xdEyGklNMIggAAADNq+ZwSnbiLrX6Xbkj0rOU21Q9Nbn8X6l3QMqdvWYDgLMvb4p56F4uSFf2kEpt2+GS9PA4HyCAYaEjjxmvOb/1lg/9Wjp6h8r2h6e+zySCAAAA0Ny0lwMcSJzcVP00ufxfqdsnZU+30e3zLJ6QvkK67edB8/0ThdCdUnF7+PAADOorLIg38bjZopYlyeiHX3Y7P36dzuf/yYfFU1pmMkEAAABoXgsh3TeZD8QPbap+mlz+r9Tjl1JXn/ltTJ5o/wAgrveoQzp6tQAwK3LiBeM1c+HPylpX/4f/3RvZKZXOMePjWdWShE6/xmSCAAAA0LzWunplaUhvNQD/9Ati2fam6KXp5f9W+gdkrdtrPgCIvdP2cxGYeUWtNsv/AaY/O2syeuQR43WTu+4556/XHC6Zm/ycyr6EDn+bCQUBAACguaUmblCr7VpbEF8muSn6aHr5vyXvoKz0mX9Jo2/6GXHUqm07D72LGeko6jwCsN4TkUJgmA8NwKDhxBHpWDJ7Z1LN2SWJ6DUf+fvxHbfpfP4sPCe+bJxJBQEAAKCJA4DwbtX6A4njm6KPppb/+5HlPr+sdveJ7XAaressFyWQat8vqANJvfdOZCZu5QMDMCw09QPjNdPbf0HKHZ0ffS4PRmXVf43K/oSPP8+kggAAANC8cgMhKXeNqNUPxg5sij6aWv5PRKTUv10qrg6xLYeU+neYn5PEsbadh4DiUofp8F4+MACDPGtLMnjyq8brJnbecZ4/YUly90+p7NPokYfFUaswuSAAAAA0J9uyJDtxu1p9b+I5cVXW27qHJpf/ExFZGph8779XAtvMBwAz+9tyHizblsDMi0rFLUmNbucDAzAofPo1sWplozXLXWGZGzv/nW3xbTrvv3GtJWR05iCTCwIAAEDzSkWu0Lsoq5YlOHe2rftncvk/EZHFoR9faBYHxo1vb//sD6WjtNp289CfmxfX6pxK7eLwPln3dPFhARg0duSvjNec3/WzUnO4zvvnlvoGpBC6X2W/QlNPMbkgAAAANK+FsR0ilqVWf6CNbzkXMbv8n4hIYTDy4zAgGDK/wbYtA3On228eZvWe/08rrR0ObFb+TEx6F8wv/xffsfF3dSR23aeyb8Ezj0jXSoFJBgEAAKA5rXu6ZHH0NrX6gZnX27Z3ppf/ExHJDfx4jeqiX+et8wOxI203F4H4IbXaqdAkHxSAQeHjzxmvueq7WjKD4xsPAMavFdvpMb9zti3hky8xySAAAAA0r5TiTzh7Uvulc7XYln0zvfzfmm9SSp09Pw4AvEGpuXvNXyxPv9xeX5hqNfHFXlCpXekcfF8oA+DSOKsVGTn6NeN1Zyc/IyIbv5tt3dMtqW2fV9nH0JFviYjNZIMAAADQpAGA8nKAg4rLszWS6eX/spEb3vf/tuWQfOgW49vdWTguvYuZtpkHXyYhznWdW25z0dvEtvhKBpgyMnNAXGtJ43Xj22+64L+T2Hmnyj52Zd+QgYUzTDYIAAAAzSkfGJb13qha/WD8SFv2zeTyfyIimXO8vTo/ohPOtFMoE1TcF82XZAKbUXjqSeM1F0c/KcX+LRf89+ZCl0mlU+cOn/CxZ5hsEAAAAJpXZkLvPQDBsy+2Xb9ML/8nIpIe2fqhX8uO6Cw/F4y90zZzEYjrLbuVGt3BhwNgSPdyTgJnv2G8bvIiX+hXc7hkbvJzKvs6NPVVcZVLTDoIAAAAzWkherlabfdyTPpzC23VL9PL/y1tueF9z///SG5gTGquTuPb759+Thy1WsvPg7NaFm/8eZXay4PXyGpPPx8OgCHhky+L2Gafjbcth8Qnrr/ovx/foRN+O8s5GZvez6SDAAAA0JzSw9vE3sD6yRd9wZw83lb9Mr38XyZ67hcxVp0uKYTuMP/ldD0n/nS85echkIqLo6rzU7ZM9EY+GABzl+oydtj8T/8zW39eSp0X/7LUzGBUVv3XqOxx6OgTTDsIAAAAzanc4ZF8+E61+sGZg23TK43l/1LhPR/5e+noVSr7MZA41vJzEVTchzTL/wHGDM6dkq78W8brJnfedamf6JLc/VMq++yLfUd6i2kmHwQAAIDmlI5eo1bbF3tWnNVKW/TJ9PJ/VXefZLeEPzocGNupc/HcBrenBmIHVOrWXN2SGYryoQAYEjr+rPGa1Y6gzIYv/UWd8W2fUNvvyPEXmXwQAAAAmlNK8SeejsqK+FOxtuiT6eX/cuN3S83h/MjfX/RtkfW+rcb3o2/2h+JeX2vZeXCXS9I3+0OV2rnoXVJ1uvhQAAydq8PHvmK87vzOz0vF1XHJdZb6BqQQul9l30ePfN3o+2JAAAAAgDGLvkFZ8+5Uq2/6wrlRTC//l97AUnOZ8VuM74dl12RgrnXXqg7OnVX7Yp2OXMkHAmDI2Nk3xVEuGK+b2HGruVoXuZLA+XiKR2VL8hgHAQgAAADNKb31VrXagZm3Wr4/Gsv/beQW/1T4MpX9GYgdadm5CMzqvVhS67ELYDMKHf2u8ZrrvbskNWxumc7E+LViOz0q+x8+9gMOAhAAAACaNABQutAUEembf1k8pZWW7o/p5f9WA5fLcq/v/PMyslVsy/xXg+D0Ky07F8GZN1XqrvkmZak/yIcBYOJzf3FBvHHzAcDs5M8Y/Uxc93RLatvndf7dOPGweErLHAwgAAAANJ/UyITKuvMiImLbMjB7uqX7Y3r5v/TETRv8ctolxVHzjwF05o9KTzHbcvPgWVuRnoU3VGpnxvfxQQAYEjn+gkrd+A7z52lyp85KOI7qqoydfp2DAQQAAIDmU3W6JR+5W61+MN66t5yrLP8X2rPxC9OIzioNg8mTLTcXA3N6QVI6vIcPAsDIZ2ZNRo88Yrzu8uDNkvePGa87G7pMKp2jKr0IHfkOBwQIAAAAzSmltO68iEighW85N738X83VKZnhjS81p7VKQzB2qOXmIpDQeaGk7XBJaniCDwHAgKHEUelYOmG8bnLyQZXtrTlcMrfr51Vq980/I75cgoMCBAAAgOazoLgcYGfhuPQuZlqyL6ZXMciH75Kq073hP58bGJNK5xbj++Wffr7llqkKxHRu/y+E7pCK28OHAGCAysvvLEviW29Q2+b4jlv0+qH0OAQIAAAAuCTLfX5ZCV6hVr8VbzkXUVj+7wLvtLAtS7LjtxnfL1cpLf506/xkqnu5IF1ZnbsW0tGr+QAADPCUlmXwxFeM182FPysrPX617c5smZBVn87nwMiRr4mjVuHgAAEAAKD5bPTldBcjGHun5frRqOX/PjQvEZ1gZiBxvGXmIqj4/H9qbBcnP2BA+NSrYtXKxusmd92jvOWWzO7+rEpl9+qMjLTgI1cgAAAAbAIpxeUA/TOtd8u56eX/1rw7pegduPB5Gd2uc1E981brBADxoyp1yz1hKQSGOfkBA8aOfNt4zZqzSxLRa9S3PbZdbyWQ0NT3ODhAAAAAaD6ZoahU3X0qtZ2lrARS8Zbqh+nl/zLjN1/U31vt7pflwWuN719/4nlxr5daYi4CMzovkkxP3MaJDxjgz8Sld+F543VTO74g5Y5O9e1f6huQwtinVGoHTz8iXauLHCQgAAAANJeawynZcb1bLYPJEy3TC43l/y5lqblM9AaFfaypLq1nSu9iRjqKOtuZCV3GiQ8YED7+nErdxI7b67YPiUmdAMCyaxI++RIHCQgAAADNJx29Ui8AaKFbzk0v/2c7XJIa2XrRfz8V3q0zJ0pL65k0oPUCScuS1Nh2TnrgEjmrFRk5+rDxuuWusMyP7a7bfiTHrxXb4VapPXb4WyJic7CAAAAA0FwWQjvVavcnXxB3uTVuOTe9/N+lLjWX3RKRmqvbfABw9pWmn4tAQuf5/+LwPil5ujnpgUs0EjsorrWk8brzu35Oag5X3faj5OmR9LYvqNTuzr4uwdRZDhYQAAAAmstqd78sbdFZb9mqVWVg7kxL9MH88n+X9hKrqtMluchdxvezK3dYepbyTTsPlm1LYOZFldrp8es44QEDQkefVKkb33Fr3fclsfMOtdrhY89ysIAAAADQfNITN6jVboVbzptl+b8Phwg6j2cMNPG7Gfpz8+JandM5zln+D7hk3ct5CZ79C+N1V31XS2YwWvf9mQ3vlUrnqErt4amviauyzkEDAgAAQHNJXcLL6s4bAJx9ten33/Tyf+u9USNLzaVHdR7PGGjiNaoHZnWe/690Dkp2MMTJDlyi8MmXRGzzz7bP7v6siFh135+awyVzu35epbZzPSWj029x0IAAAADQXLKDIal0DqrU7sq+I93Lhabef/PL/91ipE7RG5Q1r/kQwD/9vFh2c76cKhDXCSdy0dvEtvjaBVwaW8aOfFOlcnzbTQ3bq/iOW9Rqh44+wWEDAgAAQJN9pbMckpm4S62+2lvdDVBZ/i9yucEwYZ/xfXatpcSXSTbdXDhqNfHFXlCpnYpcwYkOXKLB+VPSldtvvO7i6Cel2D/YsP3KbJmQVd/VKrX9M38lvcU0Bw8IAAAAzcXkReuHAoD44abdb9PL/4llSWpkm7l5CeusWz+QON50c+HLJMS5rnO3SGp0Byc5cIlCSi+1S+76VIP3zPrrRxB0hE/8kIMHBAAAgOayMLZDxNJ5/tJ/9oWmveXc9PJ/i6O3yrqny1wAMLxVbIfT+H4HZ95uurkIKt0psjx4jaz29HOSA5fAXS7J8LGvGK9rO1wSn2j8Ch2x7fvUao8d+Yum/TcQBAAAgE2q1NkjxWGdL0Du1Vnx5uabcr/NL/93rdF65Q6PLI7dbny/vYlnxVUuNdVcBOIHVepmojdyggOXehF79k1xlM3foZOZ+DkpdfY2fP+W+gakMKZzJ4Jn8bBsmT3GQQQCAABAc0kpLgc4kGi+Lz8qy/+FJo1vZzpi/tlUq1aVgbmzTTMXzmpZvPHnVWqnFeYE2GxCR7+rUjex8+6m2cfEpN6jCKFjT3MQgQAAANBkAUBot1rtYOxg0+2v6eX/Kl3Dkg+OKsyLzgXsQOJo08xFIBUXR9X8HQk1V7dkhqKc3MAl6FtcEG/cfABQ7QjKXPjyptnP5Pi1YjvcKrW3HP+KdKyvcDCBAAAA0DzywREp94RVantjz4qzWm6q/TW//N/tYiu8R6EQGJZyt/lgIXj21aaZi6DSHSK56F1Sdbo4uYFLEDmuszrH/M7PS8XV0TT7WfL0SHrbF3Qu+qqrEjr9BgcTCAAAAM3DtixJT9ym9OWnJMH5mabZV8u2ZeD0c0ZrpiN71eYlO25+Xrqy70j3cqEp5iMQO6BSNx25khMbuKTPypqMHnlEpXZix61Nt7+JnXeo1Q4d+Q4HFAgAAADNRXc5wKmm2U9fZlbcK3GjNTWXmkuHdcKFAaU3718Id7kkfbM6y2SlxnZyUgOXYCg5JR1LJ4zXXe/dJanh5luecy60VyqeYZXafXM/EG9uloOKAAAAgOaxMLpdbEvnn6fAzJtNs5+DcbPPvy8NfULWuvTeZJ0a3a4TAMQONXwugnNnjb6L4UfWfJOy1B/kpAYuQXjq+yp1Zyd/Ru3fmktRdbpkbvLzavUjx5/joCIAAACgeZQ7OqUQulOldu/Ca+JZW26K/TS+/N+47jrWa129sjRkfjm7wPQLDV+fOjB7XKVuZnwfJzRwCTylZRk8+bBK7fiO5j0/E9tvUas9cvQRcdSqHFwEAAAANI/0+LVqtQeb4JbzjtKq9CfNvtQqrbiCwo/n5XrjNV2rc+LLNvaW1KDSnSHp8B5OZuAShE69KpbC6hzLg7dI3j/WvP8GDm2VNd9VKrXdK2dlOH6Ig4sAAACA5pEK7dK72Isfafj+bUmcEDH4U+9qh1+ygyH9L6VjSssBxo81bC48ayvSs2D+zdi2wyWp4QlOZuBSAgCll9YlJx9o8j23JDn5WbXqWo9VgAAAAICLUvAPSalf55nz4PTLDd8/08+9Z8fvlJrDqb7d2S1hqbr7zM+J0hv4NzQXc6d1juHQHVJxeziZgYvkz8Sld0HheXXLkvjWG5t+/+Pb9R5RCJ56WDpXixxkBAAAADSP9ITOM5AdxdPSn081bL8s25bgmWfN9ip8eV22veZwSm78LuN1vYnnxFVZb8h8BBI6K0Oko1dzEgOXIHxC52V1uchPyUqPr+n3v9g/KIuj9yn9O1ST8MmXOcgIAAAAaB4pzeUAkycatl/vLv+XNNurUP2WmkuHrzD/ZbRaluDc2cYEALE3dI7fsV2cxMBFclYrMnLkayq1kzvvbpk+JCY/pVY7dOQvOdAIAAAAaB7p4QmpOXVuoQ7G3mnYfple/m9l4CpZ6fHWbfu11rUfUPpJ/MfpXi5IV9b8y7DKPWEpBIY5iYGLNBI7KK61hPG6NWeXJMavaZ0AYOI6sR1unc+/zCsSTJ3lYCMAAACgOVTcHZKP6CwH6Jt5tmHLIJlf/q++z7Iu9/ll1W/+7fbB6dfqPhfBuTMqddMTt3ECA5cgdPR7KnVTO74gZXdny/Sh5OmR9LbPq9UPH3+Wg40AAACA5pGO6vykxlkuSiAVr/v+6Cz/V/+l5jIT5l9O1Z1+W7qWF+sbACitCJEJXcbJC1zsZ8FyXoJnv65SO7Hj9pbrR2LnXWq1h48+3LD3r4AAAACAD1nQXA4wUf+l50wv/1dzdUtmKFr3/dAKHQZnT9Z1P/wzr5ovalmSGtvOyQtcpPDJl4x+Tv5IuSss82N7Wq4fc6G9UvHoPFLkXE/J6MwBDjoCAAAAmsNSf1DldnMRkeDM/rrvj+nl/3KRu6TqdNU/ABgaF9tp/rnUYOxw3fahdzEjnuIp43WLw/uk5Onm5AUuii1jR76lcyE9+bm6LJdqWtXpkrlJvccAQkef4LAjAAAAoHmkt+osB9g3+5J0rK/VbT9Ulv+LXtmQOam4OyQfusN43cD0C2Ip/OTvXAZmT+kcr+PXcdICF3tezp+WrtybKrUT229p2b5obrt/+lvSs5Th4CMAAACgOaTCOncAWHZNgnOn67YfKsv/je1s2LxkIubXuXevJMWbm6/L9gcSOs//p1n+D7ho4WPPqNRd9V8jmcFoy/YlPbRV1nxXqdWPnPghBx8BAAAAzSEzNC41d69K7YHY0brth+nl/9Z8k7LUH2zYvKSU3s8wUId3M1i2LYHpF43XrXQOSnYwxEkLXAR3uSRDxx5WqT07+RkRsVq4O5YkJz+rVn30yDfqdvcVCAAAAPhYVadLstG7VWoHp1+p234YX/5v4uaGzkvBPyTrPRHzc1KHF1L15xfEtTpnvG4uepvYFl+tgIu6CD27X5zlnErt+LabWr4/8e371Gp3Ft6RwbnjHIQEAAAANAetZ90780elZymnvv3tsvzfB2UmbjVe0xd/RpyVsup2DyRPqNRNRa7gZAUuUvjod1XqLo7eJ8X+wZbvT7F/UBZH79Pr/9TTHIQEAAAANAfN5QAHEvpLz5le/s92uiU9PNHweUmH9xqvaVXLMjB/VnW7A3Gd1QZSozs4WYGL0Le4IN74Yyq1k7vua5s+JSY/pffv1ImviruOL8YFAQAAAB9ppccry4PX6gQA8UPq2296+b986A6puDsaHwCMbhOxzD9XG1R8D4Bl18QXe9543eXBa2S1p5+TFbgI4RMvqtS1HS6JT7TPyhyJievEdrhVajsqyxI68zoHIwEAAADNIT1+o0pd//Tzqi8/0ln+75qmmJOSp1uKw+afrQ1O630J9acT4lwvGK+bid7ISQpc1GdkTcYOf12ldmbic1Lq7G2bXpU8PZLe9nm1+qEjj3JAEgAAANAcUhGdZ95daynxZZJq262x/F+6gcv/fWhbxq83XrMn9aZ0rhZVtjeY1HnkIx2a5CQFLsJQcko6lnTu+knsvKvt+pXYcada7f7Zp6Q/P8dBSQAAAEDjZQcjUvUEVGoPJPTefmx6+b/1vq1S8A81TwCgtO79oNKFeiB+0HjNmqtbMkNRTlLgIoSnvq9St9oRlNk2fDHnXHivVDzDavUjx1/goCQAAACg8WoOh2TGdX6aE4zpLT1nevm/zPgtTTUv2cGQSjATjB0xXtNZLYs3Yf7LbS56l1SdLk5S4AJ5SssyePJhldrzOz8vVae77XpWdbplftfn1OqPHvmaOGpVDk4CAAAAGi+ltBygN/6suCrrxutqLP+XCl/WVHNiWw7Jjpu/JTV49gXj72YIpOLiqJh/y3U6ciUnJ3ARQqdeFataUqmd2HFr2/YtvuM2tdrulTMyrLRSCggAAAC4sIvfMZ1l1qxaRYJzZ43XNb78n+V49837TSYdvlzhS2hc+vMLZkMFpUc9Uk30TgagpQKAI99RqVvqm5TUcPsuy5nZslXWvHqPN4SOfZ+DkwAAAIDGW+vqleLwPpXaAwpLz5le/m9x7DZZ7+hsunnRCmZMv5shEDf/qMeab1KW+oOcnMAF8mfi0rvwnErt2cmfFttq38sc27Ikufun1OoPnPqadK4VOUjbFA+sAQBaSnrieumbe8l43cDM6yI3PmSsnsbyf5kmWf7vg1Z6vLISvFK6M2YvsAdmDsipvWZu43WXS9KXNL/WeGZ8HyclcBHCJ55Tqz3++u/J+Ou/R5Mv9t+vWkVCp16Vk5fdQzPaEHcAAABaykJYZznAntR+6Vox9xMPjeX/UmPNu9RcZvwTxmt648+Ks1o2Uis4Py2WXTO+jWml4xFoZ85qRUaOfI1GNLHQ4b+kCQQAAAA0Xj44KuWuEZXaA7Pmlp4zvfxfuXtU8sGRpp2XVGi3+S8plTUJzs8YqRVImn/Ew3a4JDU8wUkJXKCR2EFxrSVoRBPrSb8kgfQ0jSAAAACgsWzLkszWO1Rqm1x6zvTyf9nx28S2rKadl8xwVGou8+8nGIhPmZnbmf3Gt60QukMqbg8nJXCBQlNP0YQWED72HE0gAAAAoPE03jovIhKcNvOMuMryf5HLm3pOqk635MN3mJ+TmTcuuYantCI9C6+bPw6jV3MyAheoa6UgwTOP0IgWMDL1VWOPYYEAAACAi7YwtkPlDc/u5Zh4c/OXXMf08n8iIqnR7U0/L+mI+QvinoXXpXN16ZJqDMyeVtnf1NguTkbgAoVPvmT88xE6nKUFGZ1+m0YQAAAA0Fjrni5ZHLtNpfZA8sSl1zC8/F9xeJ+UOnuaPwAY26kzJ7OnLunvBxSWeCz3hKUQGOZkBC6ILaHD36QNLSQ09SRNIAAAAKAJLjbHr1OpG5y5tKXsdJb/u7Yl5mTRNyilfvN3KgzEL+3dDIGYwu3/E7dxEgIXei7Pn5au3Js0ooUEpr8lPUtZGkEAAABAYy2EdJbE88WeE2e1cvF/X2P5v/DulpmXzPg+819Az1z8+xS6lwvSlT1kfj9Dl3ESAhcofOwZmtBqbPvdxzZAAAAAQCMVAsOy3mt+CTZHZUUCqdhF/33Ty/9VPQHJDoZaZl7SYfMXxh3LM9KfW7iovxucO2N+Jy1LUmPbOQmBC+Aql2To2MM0ogWNHfmmWLy3gQAAAICGX2xuvVWl7qUsPWd++b87VV54qDYnI9tUtncwefziAoD4EePbUhzeJyVPNycgcCEXkWf3i7OcoxEtqDP/tgzOn6ARBAAAADSW1tJ4gYtcM15j+b90ky//90HrHZ0qL2i82Hcz+GdeNb4tWu+fANpZaOpxmtDK88fjGwQAAAA0PAAY2Sq2w2W8bt/8K+IprVzw39NY/m9hdGfLzUtGYTnAi3k3Q+9iRjzFU8a3Jc3yf8CFfaYupsQXe5RGtLChY18V9/oajSAAAACgcSpuj+TDd5ovbNsXtXa86eX/lgevkdWe/pabl5TCCxodlRUJLMxc2HzMmr/4r3QOttQ7GYBmED7xIk1o9YvGSlFCZ9+gEQQAAAA0VnpcZ4m8C312XGf5vxtbck7ywVGpdG4xXncgceyC/nwgYf75/1z0tpZ6JwPQaJZdk7HDj9CINhA68hhNIAAAAKCxtJYDDJ59+YL+/GZf/u8n2ZYl2Yk7zM/J9MZ/+mTZtgSmzf/UMRW5gpMOuABDySnpWDpGI9pAf/JJ6S/M0wgCAAAAGqfoHZA1n/kQwLN4QnoXMxv+86aX/6u5eyW7JdKy85IKm395Ye/8q+JZW97YF9X8grhW58zv1+gOTjrgAoSnfkAT2mk+j79AEwgAAABorPTEzSp1B5MnN/xnTS//l4veJVWnq3XnZHR7Q+dkIGl+yapWfScD0Cie0rIMnvwqjWgjo0ceEUetSiMIAAAAaJxUZK9K3WDsnQ39OZXl/8Ktfav5anefLG8xv1xecIN3WgTih42P3arvZAAaJXT6NbGqJRrRRjqWT8pQ4iiNIAAAAKBx0sPjUnN1Gq/rn35OLLt23j+nsvxfaGfLz0smer35AGD6pfP+GcuuiS/2vPnjTOl9E0DbBgCHv00T2lB46vs0oYW5aAEAoNVVnW7JRe+R4Cmz60w713MSSMUlc55n8U0v/7fq3yPLfYGWn5dUaLdEXjdbs6N4WvrzKVn0DX7kn/GnE+JcLxgdt+bqlsxQlJMN2CBfNi69C8+p1X/lc9+URe8wjT6HocRhufLxX1WrP3DqYfHc+itS6uyl2QQAAAA0RjpylfEAQEQkmDzxsQGAyvJ/E/vaYk6yWyJSc/eKo7xk9stn8sTHBgDBC3h3w0a1+jsZgHoLH39erfby4M2SGRynyR8hGb1K9nSPi3vlrEp9q1aW8KlX5ORl99DsFsQjAACAtrAQVloOcOatj/19jeX/0qE9bTEnVadLcpE7Febk4Mf+fiB+0PiY6ciVnGTARi8wahUZPfKw3gXu5AM0+WPUHE5J7vm86hihIzzeQQAAAEADLff6ZCVo/iKtP/G8uMsf/RIr48v/OT2SGp5om3lJR8y/zNAfe1ac1co5f89ZLYs3YX6ZqtTYTk4yYINGZw6Kay2hVj++lRdynk9sx22q9XtSL4o/E6PRBAAAADTwYnPiJuM1LbsmwbmzH/n7A9P7jY5XCN8hVZe7beZE48LZUV4Sf+rcXzwDqbg4KmtGx1vz7pKl/iAnGLBBoamn1Grnww/JSo+fJp/v3xL/iBSH71YdI3LsWRpNAAAAQAMvNiOXqdT1z50656+710vSZ3r5v+jVbTUnS/1BWfOZfzwjOHvu5/yDyRPGx8pM3MzJBWxQ10pBgmceUauf3HUvTd6g+G7dRyWGp/5cnNUyjSYAAACgMTJbIlLtMP+TIX/y3G/5H5g/s6FlAi9EO95qnhk3/1JDf+LIOX89EDtgfKx0aDcnF7BB4ZMvGV8W9Udsp0cS49fQ5I0GAFtvkJqzS62+ay0pozMHaDQBAAAAjVFzOCU7bv6lc32zPxRn5cM/5QgmpoyOU+rfLou+LW03LxoX0P3JFz70HgBXuSR9sy+aveBwOCU1spWTC9jYGSOhw9/U+yzZ+nlZ7+imzRu07umW1I4vqI4RmvoejSYAAACgcVJR8y8CtGpV8afjH/r1wPRrRsfR+El5UwQAI1vFdjjNfoGprIk3O/u+XwsuzIhVqxodpxC6UypuDycWsAED86elK/emWv3Ezjto8gWK7dJ9D0Dg7DekezlHowkAAABoUACgdAu99wMBQNdKUbozZpebS0X2tuWclN0eKYTM35nR/4EAwD932vgYmchVnFTABoWPPaNWu+IZlrnQZTT5Ai2M7pJS36TeALb97mMfIAAAAKARVrv7ZGnI/BJRfemZ9/1/YGHa7HcoyyHp4W1tOy8aF9L9qbPv+3/vvPkXAC6EJjmpgA1wlUsydOxhvQvZnT8nVaebRl/Evy3JPZ9THWPs8DdFxKbZBAAAADRGevwG8wFA6vj7/v+jVga4WIuhO6Tc0b63mqfGdpkPAOaPvffflm1Lf/JVo/XLPWFZ9A9xQgEbuQic3i/Ost6t4PEdt9LkixTbcYtq/a78WzJo+N9EEAAAALDxi82w+ZfOdWfeft9L57zJw0brpyNXt/WcFALDUu4eNVqzJ73/vVUYehcz4lw3e/GRmbhNbMvihAI2IHT0CbXapb7dkh7aTpMvUrF/UAoh3SUBw8efodEEAAAANEZ2MCyVTrNv07dqVekpZkVExFVZl975V4zWT7X5rea2ZUlm4nazc1ItS/dSXkREvJmE8W1O87wxsCG9xbT4Yt9Rqz+7+2cI4y5RbPf9qvWHjn1V3OUSjSYAAACgUReb5l8611189yfMvszsez95NqHcHZJCYLjt5yUdNv+Sw75C+t0LkNys2cKWJalRfuIIbETk+Auq9ePbbqLJlyg5fo3U3F69i8pyQcbOvkmjCQAAAGiMVPQKhQAg8+5FZzZptO5mudVc44K6Jz//bgCQjRutWxy+SUqdrDcOnI9l12T0yNfV6i8P3iIF/yiNvkRlt0fmd/2i6hihI4/RaAIAAAAadbG5Q8TwRXVX8d2fNvdlzF5spsOb41bzUmePFIfN/iSvp/BuANCTPm52Tsav5yQCNmAoOSWe4pRa/eTkAzTZkNjOO1XrexOPS19hgUYTAAAA0IiLzW5ZHDX71uiuxXcvNvtSJ80Vtax3w4pNIhO91mi9zsU5cdSq0pU/ajYAUFi1AGhHoWNPq9aPb72BJpv6XBvaJqs+3RfORk68QKMJAAAAaNCXHcMXmx0reRER6Um9ZaxmcXjfprrVPG34ZYddhbh0ri6J2ObWoK54BiQ7GOIEAs7DU1qWLSe+olY/F/msrPT4abQhtmVJcs9Pq44xeuQRo+/IAQEAAAAbthDeY7SeezUrnrVlcVRWzF0Qj1+3qeYkOxiWaoe5L/SdhWPStVwwe9ExfrvYFl+RgPMJnX5drKrem9+TO++hyYbN7LjZ+ONxP6lj6YQMJY7SaAIAAADqrxAYlnJP2FwAsDIv3UtmLzbbffm/D6o5nJKLmlsO0KqWxZuKGd3GdORyTh5gIwHAkW/rfVY4uyQ5fjVNNmylxy/ZqO5dAOFjP6DRBAAAANSfbVmS3nqHsXqutYX3VgIwodI5KLmBsU03L+mI2RUadj73e0brLYzu5OQBzsOXTUjv/LN6nxPbPifrHazEoSE++SnV+oMnviKe0jKNJgAAAKD+UobXnr/88X9irFZ2k95qnhpr3pcergxcLas9/Zw4wHmEjz+nWj+54w6arNXb6JVS9WxRq2/VyhI+9SqNJgAAAKABF5uj28V2OJty29LhKzblnCz3+mU1sLc552T8Rk4a4HwXELWKjBz9c7X6Fc+wzIX20mglVadbZie/oDrGmOLjISAAAADgI5U7PFII3dmU29bMPwnXlhm/qTkDgNBuThrgPEZm3hH3akyt/vyuz0nV6aLRiuI7b1et37vwvPgzcRpNAAAAQAMu6qLXNN02LW+5Xla7+zbvnDThhXbN1S2ZoSgnDHAe4amnVOsntt9Kk5VlBsdleUA3iNV+TAQEAAAAnNNCuPnetJ+OXr+p5yQ9PC62091U25SL3MVPHYHz6FopSPCM3u3/pb7dkh7aRqPrILH7s6r1R45+TZzVCo0mAAAAoL4WfVuk1N9ct9unwpv7VvOKq0Py4buaapvS0Ss5WYDzCJ98ScS21erP7v4ZsRXXqcePxbbfpPoiWtdaQkZiB2k0AQAAAA24uNvaPLeUVt19kt0SYU4iVzXX9rD8H3AetoSOfEt1hPi2m2hznax19Ulm2y+ojhE6+j0aTQAAAED9pcKXNc225MbvklqTrkxQ1wvusea54F7z7pKiN8iJAnyMgYUz0pV9Q63+8uAtUvCP0ug6ik/eq1o/ePbr0r2cp9EEAAAA1DkAGNkqNaenOS58N+nyfx9U8A/Jeu9EU2xLZuJmJgQ4j/CxZ1TrJycfoMl1Nhu6TMrd43oD2Pa7j42AAAAAgHqqutySjzTHM+epELeav3fhPd4cF94s/wd8PFe5JENTX1UdI771BhpdZzWHS2Z3/7zqGGNHviUiNs0mAAAAoM4X3uONXw5wNbBXlnv9TMaPLryb4NEM2+GU1MhWJgP4uIu46f3iLOfU6ucin5WVHj4bGyG2Q/cdOV25N2Vg/jSNJgAAAKDOAUBoV+MveCf2MRE/OSej20Ua/MbvQuhOqbg9TAbwMUJHn1Ctn9x5D01ukHxgTIpDd6qOof34CAgAAAD4kKW+gKwG9jY2AOBW8/dZ93TJ4khjHwPINNlqBECz6S2mxRf7jlr9mrNLkk1wh9ZmltjzkGr9oWMPi6tcotEEAAAA1PkCvIE/ga+5OiU9PM4kfPACPHptQ8dfCE0yCcDHiBx/QfdzedvPy3pHF41uoPjW68VWfFGus5yTsbP7aTQBAAAA9dXI5QDz4Tuk6nQzCR/88j/WuEczyj1hWfQPMQnAR7Dsmowe+brqGMmdd9DoBit5eiS1/RdVxwhNPU6jCQAAAKivzFBUau7exlzoRrnF9VyygyGpdA425niYuE3sBr+DAGhmQ8kp8RSn1OpXPMMyG7qMRjeB2OTdqvV9sUelbzFFowkAAACon6rTJdnxxrxsKj26gwk4B9tySC56W2PmhAsP4GOFjj2tWn9+8uel5nDR6CYwPzop6726d2SFT7xIowkAAACor1TkyrqPuebdKYu+QZr/URfikcvrP6hlvbsKAYBz8pSWZfDEw6pjJLbfQqObhG05JLnn51THGDv8iFh2jWYTAAAAUMcAILSz7mNmxln+72PnpAF3RxSHb5JSZzfNBz7qYu306+KorqrVL/VfJukt22h0E5nZeatq/Y6lYzKUnKLRBAAAANTPSo9XlrdcV9cx02FuNT/fnKwMXF3fORm/nsYDHyN05Duq9Wcnf4p3cDSZYv8WKYx9WnWM8NQPaDQBAAAA9ZUev7FuY9kOp6RHttL0887JDfUdr4GrDwDNzpdNSN/8M6pjxLdxZ1Qziu++X7X+4Mmviqe0TKMJAAAAqJ9UeE/dxiqE7pSy20PTz3dBHtpdt7EqngHJDoZoOvARwsefV62/tOVWKfhHaHQTSkxcKzVXn1p9q1qS0OnXaTQBAAAA9ZMdDNdt6blM5CoavpE+DY1LzdVZl7Fy47eLbfE1CDjnBUKtIiNH/1x1jOSuB2h0kyq7O2V+1/+gOkboyLdpNAEAAAD1U3M4JDt+e13GWghN0vANqDpdkg/fVZexGrLqANAiRmKHxL06ozeAZUli6w00uonFd92hWr93/lnxZRM0ugGst/c/atMGADBjllgVAIypyihNAACD+KoKAAAAAAABAAAAAAAAIAAAAAAAAAAEAAAAAAAAgAAAAAAAAAAQAAAAAAAAAAIAAAAAAABAAAAAAAAAAAgAAAAAAAAgAAAAAAAAAAQAAAAAAACAAAAAAAAAABAAAAAAAAAAAgAAAAAAAEAAAAAAAAAACAAAAAAAAAABAAAAAAAABAAAAAAAAIAAAAAAAAAAEAAAAAAAAAACAAAAAAAAQAAAAAAAAAAIAAAAAAAAAAEAAAAAAAAgAAAAAAAAgACAFgAAAAAAQAAAAAAAAAAIAAAAAAAAAAEAAAAAAAAgAAAAAAAAAAQAAAAAAACAAAAAAAAAABAAAAAAAAAAAgAAAAAAAAgAAAAAAAAAAQAAAAAAACAAAAAAAAAABAAAAAAAAIAAAAAAAAAAGOeSFE0AAFP6yiGaAACG9MoyTQAAg7gDAAAAAAAAAgAAAAAAAEAAAAAAAAAACAAAAAAAAAABAAAAAAAAIAAAAAAAAAAEAAAAAAAAgAAAAAAAAAAQAAAAAAAAQAAAAAAAAAAIAAAAAAAAAAEAAAAAAAAgAAAAAAAAAAQAAAAAAACAAAAAAAAAABAAAAAAAAAAAgAAAAAAAAgAAAAAAAAAAQAAAAAAACAAAAAAAAAABAAAAAAAAIAAAAAAAAAAEAAAAAAAAAACAAAAAAAAQAAAAAAAAAABAC0AAAAAAIAAAAAAAAAAEAAAAAAAAAACAAAAAAAAQAAAAAAAAAAIAAAAAAAAAAEAAAAAAAAgAAAAAAAAAAQAAAAAAAAQAAAAAAAAAAIAAAAAAABAAAAAAAAAAAgAAAAAAAAAAQAAAAAAACAAAAAAAAAABAAAAAAAAIAAAAAAAAAAAgAAAAAAAEAAAAAAAAAAWpWLFjSfPU/+T+JemlKrXwx9Vk7f+Ks0ukk4qhW57LG/JY5yTme+Rx+U0zf9Oo0G6uATj98vznKSRih5895nZK3LTyOAFrP38Z8VZ3muLffNdnRKzRWUmjsgVXe/VDyDUvX4pOwJSLkrKOtdQVnvDspa96DUnG4OBhAA4MNy0U/KlsN6AUBv8glxlX9JKu5Omt0EvAvH1C7+3z2ebqbJAAAACqzamjjXE+JcT8j5Lu/LPXtl1btXVv07ZcU7Lsu+qFRdfB8HAQABQOha2XJY84OqJN65I5IJX0Ozm4Av9qpa7Zo7IIWh3TQZAACgwdzLh8S9fEj6f3SjmOWQNd8tsjR4gyxuuUKWfONiO5w0CgQAm81ab1BWgzdLV+aHihedLxMANAFnpSR9icfU6hciD0rNyWkOAADQdOyadOael87c8zJwXKTmHpLF0YckP/oJWRzYKbZFGADzeAlgk8pF71Ct3zv3pLjWV2h0g/lmD4tVK6nVz0ZupMkAAACtcGFWnhff9H+W8Zd/RfY89bdk9NhfiWc1R2NAALAZ5EevELEUp8euiT/5Do1udAAQe0mtdrl3UpYCUZoMAADQYlxrp2Tw2O/L5FMPycT+P5aeQoymgACgnZU9PVIcuV91DK/ixSfOz11akt7ZJ9Xq58bvo8kAAAAtzZb++H+X7c/9gmx9/d9K92KcloAAoF3lIrpvb+9ZeFo61hZpdIP4EwdFxFarnw1dS5MBAADaRN/sN2THs5+X6MH/Ku4S3+FBANB2CsO7pObyKo5gi4/HABrGN/OcWu2VwTuk1BOgyQAAAO32HfLsf5LJp/+mDMReErFtGgICgHZRc3bIYvgB5YvQ52l0A3iWs6qrPOSit9FkAACAdr2IK6dk7K1/JNtf+T3pWCvQEBAAtIuc8lvcuzI/FM8KbxetN3/iLbXatsPz7kskAQAA0NZ6Uo/Jzmd/VbwLh2kGCADaQTG4VSpdum9y9yfeptF15pt+Wu+YCT0kFXcnTQYAANgEnOsJGX/l12Tk5OM0AwQArc62LMlHP606hjfGYwD11F2YFc/iAbX62chNNBkAAGCT2XLkX8n4W/+vWLUqzQABQCvLha5Trd+Ze126iikaXSf+xH612lXPqCxu2UGTAQAANiFv7P+TrW98SRzVMs0AAUCrWvEOS8l7teoYvuTbNLoebFt800+qlc+PPyC2xWkNAACwWfXOfUu2vvFvCQFAANDKcuP36AYA09+nyXXQl50W18pptfrZ8PU0GQAAYJPrmf+2TLz5ZbFsHgcAAUBrBgBjV6nW7ygelu7CLI1W5ou/oVa75L1aVryjNBkAAADSO/cNCR16mEaAAKAVrXd5ZXlI9y4AzWfTIWLVquKd+a5afe27RAAAANBaAmf+WAaneeE3CABaUj5yi2p978wPRGybRivpT50U5/qCUnVLcqGraTIAAADeZ+TgP5Oe/DSNAAFAq8mN7BXb4VGr714+Lr25GI1W4o+9plZ7aeQ+We/sp8kAAAB4H8uuSOTN/1Mc1XWaAXHRgtZRdXdKMfSg9M98Q20MX2K/LAUiNNswZ2Vd+uPfUaufU747BEBjHbr1m7LcN8K/g85ODgYA7zl161dktW+4fhfStao4qmVx2BVxlYriLi2Kq1SQjtW0eIpnpbMwJe6Vw03Zq47lgzI29Q2JXfYFDhwCALSSXOQm1QDAO/OkJPZ+VmzLotkm+zp/VKzqikrtmqtP8iN7aDLQzhe+rk6puLpoBAC877PRI1VXg4LB7oFz/rKzUpKe/LT0ZqekJ/WWdGeeEpHmeMQ2cOrfSzZ0iyx7wxw8mxiPALSYwuAOqXZsUavvWotJb+YMjTbMN/OyWu3F8Gek5uygyQAAAA1WdXlkcWCnJHd+Rk7c/M/lyH2Py+yV/4esBpvhZc22jL3zn5gkAgC0EtvhlEL0QdUx/PE3abRBrvUV6Z19XK1+LnIjTQYAAGhCZU+fLERvl+M3/ws5cccjUgj/sog07k7bruwPxD93gIkhAEAryYWuU63fH3tcrFqVRhvimz0klq3Tz3L3NlkMTtBkAACAJrfSPyZnr/41mbrnr6QQ+qWGbcfQsT9j5S8CALSSpUBEyr2TavWd6wvSnz5Fow3xK669mh//tAjvawAAAGgZpe6gnL3m1+XMzX8q5Z7L6z6+p/CKeFNHmAgCALSSXPSTqvV9sddpsgEdqwXpTj2rVj8bvo4mAwAAtKDF4E45dvu/a8jdAIOn/ooJIABASwUAoWtV6/fHvyuOaoVGXyJ/Qu8Zq9XgPlnrHaDJAAAALarq6pSz1/y6zO/5p3Udtyf1mHQup5gAAgC0irXeoKwGb9Y7MCoF8S4co9GXyDf9tFrtXPROGgwAANAG5rZ/WhJX/0FdxwzEX6LxBABoJbnoHboXr3EeA7gUXcWUdObfUKltO1ySG7uSJgMAALSJdHifJK/8vbqN54s9RtMJANBK8qNXiFh6U9iXeFSclRKNvkiayykujT4glY5umgwAANBGUtHbJLP979dlLPfKYeleTNB0AgC0irKnR4oj96vVt6pr4p2fotEXyTfzlFrtbORmGgwAANCGEpM/K6vBe+syVv/COzScAACtJKd8IeiLvUyTL0JPLibuJZ13KFQ7BqUwtIsmAwAAtCHb4ZTpq39LbGev+li9qf00nAAAraQwvEtqLq/eh8LsE+Iqr9HoC+SPv6E359GHxHY4aTIAAECbKnUHZWHX76iP0515Shy1Mg0nAECrqDk7ZDH8gFp9q1YRX5Jbgy6oZ3ZNvDPfU6ufDd9AkwEAANrcwsRdUvVEdL+31talqzhHswkA0EpykRtV63sTr9LkC9CXPi2utZhK7fW+vbLsD9FkAACANldzdkhqx99RH6e7ME2zCQDQSorBrVLpiqrV7519UtylJRq9Qf6Y3vKJufFP0mAAAIBNIh25RWrOftUxOhdnaDQBAFqJbVmSj35acwTxzR6i0Rs5oaoV6Y89qlY/G76GJgMAAGwSVVenFMd+RnUMzxJ3ABAAoOXkQtep1vfNvECTN8A7PyWOSkGl9vKWu2W9y0eTAQAANtP3/DHdVb88xeM0mQAArWbFOywl79Vq9btTz0nHaoFGn4cv9oreh3/0NhoMAACwyRSDO8V2dKrVd62dFMuu0WgCALSa3Pg9qvX9iQM0+eM+PMtr0pd8XKW27eyW/OhemgwAALDJ1BwuWQ3coTeAXRPXOu/7IgBA6wUAY1ep1vfGXqTJH8M3e0isWkml9mLoIam6PDQZAABgE1oeuFK1vmt9mSYTAKDVrHd5ZXlI7y6AruxL0rmcodEfFQDEXlKrnY3eRIMBAAA2qdW+sGp9Z2WVJhMAoBXlI7foXuTyGMA5udeK0jP3lErtSldUigNbaTIAAMAmtd4d1A0AygQABABoSbnRy8V26N0q7pt5miafgz95UERsldr56KfFtjhVAQAANm0A0BWgCSAAwIdVXR4phh5Sq+8pvC1dxQUa/QG+mefUamfD19NgAACATazc0ata31kt0WQCALSqXOQTqvX98f00+Sd0LmekK6Pz/P+a/wZZ7R+iyQAAAJtczeVTq83dpgQAaGGFwR1S9Qyr1ffO/IAm/wR//C212rnoXTQYAAAAYjv17gKoOdw0mAAALfvh4HBKIXK/Wv2OpaPSk0/Q6L/m0wpELIfkQlfRYAAAAIht6b3ny3Z20GACALSynPJz474EjwGIiHQXktKx+I5K7eLI/VL29NJkAAAAiFVdVqtdczhpMAEAWtmSPyzrvbv1AoCZp0Rse9P3WfN9CLnozRzIAAAAEBERZ3lOLwBwemgwAQBaXT56r1pt18pp6c3NbOr+WrYtvpnv6XwIuwNSGJrkIAYAAIA4ahXV+mVPP00mAECry4WvVa3vj7+5qfvbmz0rrpXTKrULkQel5uRlLAAAABDpWMur1bYtp1Q6emgyAQBa3VpPUFYHblGr7515Qiy7tmn764+9oVY7G7mRAxgAAADvBgArGbXalc7tLANIAIB2kYvcrlbbWUpKX/rMpuyrVauKd+Yxldrl3klZ8kc4eAEAACAiIp6VlFrtck+UBhMAoF3kx64QUUz0fPHXN2VfvakT4iinVWrnxu8TsSwOXgAAAIiISGfhrFrttb5tNJgAAO2i3NEjxdH79S6EY0+IVatuur76Yq+q1c6GruXABQAAwHt6Mnrv3lrzjtNgAgC0k1xYbzk5Rzkt3oXjm6qfzkpJ+uM6t/+vDN4upZ4ABy0AAABERMS1viyexdfU6q/2hWgyAQDaSWF4Umour1p9X+KNTdVP79xRsaorKrVz0ds5YAEAAPCe/vSUYnVLVvtGaDIBANpJzemWxfCDavX74o+Jo7q+afrpj72sUtd2eCQ/egUHLAAAAN7jS7ygVns1cJdUXR6aTACAdpOL3KB3EFWWxDu/OR4DcK2vSO/s4yq1i6EHpeLu5GAFAADAu989yyvSO/cttfrFoRtoMgEA2lExuFUqXRNq9bV+Kt5s/Ml3ROyaSu1sZB8HKgAAAN4TSLwmll3Ru0YYuIwmEwCgHdmWJfnofWr1e5NPiLNSavs++maeV6lb9YzK4pYdHKgAAAAQERGrVpWBUw+r1a+6h2XZG6HRBABoV7nwdYofUCXxzR5u6/55VvLSnXpOpXY++oDYFqcjAAAA3hVMvCbu5UNq9QuRnxPb4aTRBABoVyv9w1LyXaNW3xt/ra3750u+rVY7G7meAxQAAAAiIuKslmRo6v9RHSM7djONJgBAu8tF71ar3Tf7XXGtr7Rt7/zTz6jULXmvlhXvKAcnAAAARERk+Pij4lo9oVZ/ve86WfZx+z8BANo/ABi7Sq+4XWvbxwC6igviyb+pMyfj93BgAgAAQEREenNnZeDEl1THyEz8NI0mAMBmsN7lleWhe9Xq+2ZebMu++eP7lSpbkgtdzYEJAAAAcZVXJPLmvxYRW22MqntYMuGbaDYBADaLfETveZ+ehafFvVZsu575pr+nUndp5D5Z7+znoAQAANjkrFpVxt/8srhXjqiOk97xK1J1emg4AQA2i9zo5WI7tE56W/zJg23Vr97sjLiXj+vMReQWDkgAAABI5J0/k56Fb6uOUfVEJTV+J80mAMBmUnV5pBh6SK2+L9ZejwH442+o1K25+iQ/socDEgAAYJMLH/6a+Kb/s/o4c7t/U6quThpOAIDNJhf5hFrtrvQL4lnJtUWfLLsm3pknVGovhh+SmrODgxEAAGCTsmpViR74LxI49WX1sVYDd/LsPwgANqvC4A6peobV6vva5DGAvtQpcZaSKrU1QxgAAAA0N9f6smx77Yvim/4T9bFsyyXxK35DbIvLPwIAbEq2wymFyP16AcDMs23RJ3/8NZW65e5tshic4EAEAADYhHry07Lz+d9Rf+b/Rxb2/C+y0j9G4yEuWrB55cLXS+DEf1Gp3Zl7XTqX0rLWO9Cy/XFUy9If+65K7fz4p0Qsi4MQwIZc+cz9m26fj33iv0l6y+VMPoC24qiVZfjEd2Xw+BdF7Fpdxlze8hmZ33ovzce7xyAt2LyW/GFZ792tVt+feKul++OdPyaOSkGldjZ8PQcgAADAZmHbEki+KZPP/D0ZPPb7dbv4L3fvkelrfpNb/0EAgHflo3ppoG/m6ZbujT/2skrd1eC+lr4zAgAAABtj2VXxzR+UXS/8Ywm/8dviXj5Ut7FrrqCcufFfSrmjl4nAe3gEYJPLha+VLYd1ancsviPdhTlZ8Q633olRXpPe5GM6PY+y9ioAAEA761jNSSDxigTPPCKu1eN1H992dMjZG/9QVvtGmAwQAODH1nqCsjpwi3SlX1Sp70u8JSveT7dcX3zJd8SqVRQ+jF2SG7uSAw8AAKCNOKpl6S4mpC91WPpnX5DO/AsN2xbb0SHTN/57KQZ3MDEgAMCH5SK36wUAM09Jck8LBgCxl1TqLo0+IJWObg46AACAFuGslMSyq+KorIujVhbX+pJ0rGbFvZYVz/KcdOUOiafwslh2teHbaju7ZfqGP5LC4B4mDgQAOLf82BUy+pZD5WUk7uXj0puLyZI/3DL96FhblJ7576vUzkX2ccABAAAYsPOZn6MJP6HaMSpnb/wDWfKP0wx8JF4CCCl39EhxVG+JKV9if0v1w5c4KCK2wofyoOSHJjngAAAAYFSp/wY5eet/4OIfBADYmFz4ZrXa3pknxbLtlumFf+Y5lbqF6ENiO5wcbAAAADBmMfQ35MQtvydrPYM0A+fFIwB49+J0eFJqLq/Kuveu1RnpzZ6VYnCi6fvQuZyRzqzO8n/Z8PUcaAAAADCi5uyX2cv/qaQjN9MMbBh3AOCvP0Dcshh+UK2+L/5mS/TBH9d5XGG9b68st9B7EAAAANC8VgY/Lcfv/O9c/IMAABcvF7lBrbY39oRYCi8ZNM03rfTyv/FPcoABAADgklQ9EUlc84dy4qZ/KqXuIA3BBeMRALynGNwqla4Jca2eMV7bWZqT/tRJKWzZ2bT735NPSkfxsE4AELqGAwwAAAAXxXb2Smrnb8nCxD1SdXXSEFw07gDAjz9YLEvy0fvU6jf7YwBa27e85W4pdfs4wAAAAHBh388dHZKb+HU5es/XZXbHg1z845JxBwDeJxe+TgamdGr3xx4Vx5Wfk5qz+Q47y7bFN/OETk+jt3FgAQAAYMNq7kHJTvyyLEzcLWVPPw0BAQB0rPQPS8l3jXjy5l+G56gUpD91XPLDe5puv3szZ8S1Om28ru3slPzoXg4sAAAAnNd633WSmfgpyYRu4qf9IABAfeSid8twXudt+P7Ya00ZAPjjb6jUXQx9VqouDwcVAAAAzqnmCkoh/DnJhm+VJd84DQEBAOocAIxdJcMHdGr3Jb4rzqt/UaqujqbZX6tWFe/Md1VqZ6M3cUABAADg/Rf97iFZHHlAFoevl8LgpNScHTQFBABojPUurywP3Ss980+Zv9iuroh3/qhkx65smv31LhwXRzltvG6lKyLFga0cUAAAABARkaXhn5bUts9KMbBVbMtJQ1B3rAKAc8pHblar7Yu/1lT76o+9qtPD6P1iW5xiAAAAeFdH8ZR4lufFqlVpBhqCOwBwTrnRy2XU4RGrVjJeuzf5mLjKvyQVd+NfbOKslKQv8ahK7Wz4eg4kAEYcuvWbstw3sqn2ucrtsADaMQBYPiijbx+ULVPbZGHXr0g6vE9sB5dkIABAo794uTxSDD0k/TN/Yby2VauId/awZCLXNnw/fXNHxKquGa+75r9eVvuHOJAAGPpM7pSKq4tGAEC7XIStnZLRA/9EBk5dI4krflMWByZpCuqC+5PxkXKRT+hdeMdfbop99M28pNO76N0cQAAAAPhYHUv7ZeKlvyPRA38irvIqDQEBABqnMLhDqp5hldq9c98Td2m5ofvnLi1L79yT5gtbDsmFruIAAgAAwIb4pv+L7Hzut6U3f5ZmgAAAjWE7nFKI3K9UvCa+2UON/aBNHhSxa8brLo18WsqeXg4gAAAAbJh75YhsfeGXZSD2Es0AAQAaI6f4IjvfzAuNDQBiL6rUzUZv4cABAADABbPsioy99Y9k9Nhf0gyo4CWA+FhL/rCs9+6WjqWjxmt3p56VjrVfk/XO/rrvl2clJ92p54zXrbkDUhjiJS4AAADaTt36FVntu7THVS3bFmdlTVzrS+Jey0vn0qx0Lp6V7ux+cS+/07B9Gzz2B+KsrEnssl9gokEAgPrKR++VLYePqtT2JQ7IwrZb675P/sTbKnULkQel5nRz0AAAACirujxSdV36stIVd5eUuvwi3rDI0OXv/bpnJSP96aPiiz8t3ekn675/gVNfFltE4oQAMIhHAHBeubDecn2+WGMeA/BNP61SNxu5kQMGAACgDZS6g5KK3CIn9v2vcuyev5LM9t+WmrO+d64GT31Zhk8+wWSAAAD1s9YTlNUBnefauzIvSedypq770704L57CW8brlnsnZckf4YABAABot+/D3QMS3/N5mbrnEclu/U2xLWfdxh468r+Lf/YtJgEEAKifXOR2tdq+5MG67osvsV+nR9FPilgWBwsAAECbKnv6JLb3F+Xk7Q/Lmndf3cYN7//H0r0YZwJAAID6yI9dIWLpHC5at+Ofk22Lb/p7KqWz4es4UAAAADaBlf4xOX7r70lm+2/XZTyruiTR1/+1OMurNB8EANBX7uiR4uj9KrU9hbekq5iqy3705mbEvXzC/D8Cg7dLqSfAgQIAALBJ2A6XxPd8XuLXfklsR4f6eB3LByVy8E9pPAgAUB+58M1qtf1Kt+V/aJz4mzq9id7OAQIAALAJZcZukLOf+I91eUFgf+IrMjj9PE0HAQD0FYYnpebyqtT2zug/BmDZNfHOfNd4Xdvhkfzo5RwgAAAAm9TiwC45e9P/XZcQYOSdfy7dBd4HAAIAKKs53bIYflCldkfxsPTkE6rb3586Kc7SnPG6xdCDUnF3cYAAAABsYsXANpn+xB+pPw5g1dYluv/3xVEt03QQAEBXLnKDWm1f8m3VbffFXlOpm43s48AAAACALAZ3Suy6P1Ifp6P4powe+xYNBwEAdBWDW6XSNaFzgT79pIht6xzo1XXpjz9mvG7VMyqLg9s5MAAAACAiIrnhK2Ru779QHyd48o+kL3uKhoMAAHpsy5J89D6V2q6V09Kbi6nU9s4fE0elaLxuPvqA2A4nBwYAAADeM7/1HslHf0V9nPD+fyPOSomGgwAAenKK693742/o1J15WaVuNnI9BwQAAAA+JHb535A1362qY7hXDsvY0UdoNggAoGelf1hKvmtUavfHnhLLrhmt6SqvSu+s+bf/l7xXyYp3lAMCAAAAH1JzuOXs9f+zVDt0vy/6z/xH6c8cp+EgAICeXPRulbqutZj0pc8YrelLHhKrVjHfg/F7ORAAAADwkUpdAYlf/c/Uxxl7+0usCgACACgGAGNXqdX2Jd40W2/mRYWttCQXupoDAQAAAB8rP3SFZCd+Q3WMjuWDMnLiUZoNAgDoWO/yyvKQzk/AvTPfFatWNfNhuLYoPQs/ML6Ny8OflPXOfg4EAAAAnFdiz8/Let+1qmMET3xJuotJmg0CAOjIR27WOSjLaelPnTRSy584oLKN2eitHAAAAADYkJqzQ2JX/a6IWGpjWHZVQgf+g/H3aYEAABARkdzo5WI7PCq1/fHXjNTxTT9r/gPc1Sf5kT0cAAAAANiwJf+4pHf8juoYXdlnZHD6eZoNAgCYV3V5pBh6SKV2X/yJS36RSedSWjpzrxrftsXwQ1JzdnAAAAAA4ILM7vyM+qMAQ4f/jXSs5mk2CABgXi7yCZ0Ds1IQ7/yxS6rhj+9vqX0GAABAe6s53RK/8h/oXuBVFyV06E9pNggAYF5hcIdUPcMqtX2X+BiAb8b8y//K3dtkMTjBxAMAAOCiFANbJTf+a6pj9M3+hfjn3qbZIACAWbbDKYXI/TofXInHxFkpXdTf7cknpKN42Pg25cc/JWJZTDwAAAAuWnL356TqiaiOMXrwD8VZXqXZIACAWbnw9Sp1rVpJvHNHL+rv+uNvqGxTVmlfAQAAsHlU3N0yu1f3hYCutdMyOvUNmg0CAJi15A/Leu9uldq+2CsX/Hcs2xbvzJPGt2U1uE/WegeYcAAAAFyyzNgNsjJwn+oYgTN/LL25MzQbBAAwKx+9V6Vu79wT4lpfuaC/05c5La7VGePbkoveyUQDAADAmPjlvya25VQdI3Tgy2LVKjQbBAAweHEc1lnOxKpVxDd7Yc/y+2KvG98O2+GS3NiVTDQAAACMWe0bluz231Idw7P4qgydfopmgwAA5qz1BGV14BaV2r7YSxs/oKsV8caeML4NS6MPSKWjm4kGAACAUbM7PiOVrh2qY2yZ+qJ0LqdoNggAYE4ucrtK3Z7574u7tLShP9u/cFwc5bTCvu1jggEAAGBc1eWR5N6/rzqGVVuT0Dv/mWaDAADm5MeuELE0Dilb/MmDG/qT/vir5j+UOwYlPzTJBAMAAEBFbuRqWR76jOoYPQuPSlDhuzIIALBJlTt6pDh6v0ptb+yH5/0zzkpJ+uKPGh+7EHlQbIeTCQYAAICa+N6/JbblUh1j5NAXxb2+RLMJAAAzcuGbVep2p54Tz0ruY/+Mb/awWLWS8bGzkRuYWAAAAKha69ki6Z2/qzqGcz0pY0ceptkEAIAZheFJqbm8KrV9yXc+/vcv4GWBG7Xet1eW/WEmFgAAAOrmtn9ayt17VMfwzvxX6U8fo9kEAMClqzndshh+UOfDKvHyR/6ee31Zeue+Z3zM3Pi9TCoAAADq9F26Q5KX/5b6OKEDXxJHtUzDCQAAAxfNSrfMd6VfEPda8Zy/50seErFr5vcldC0TCgAAgLrJD10hxZGfVR3DvfyOjJx4lGYTAACXrhjcKpWuCZXa3vmj5w4ANvCSwAu1vOVuKXX7mFAAAADUVeKyXxbb0ak6RvDEl6S7mKTZBADApbEtS/LR+1Rq988d+NCvudeK0r3wtPGx8tFbmUwAAADUXak7KKld/1B1DMuuSujAH4ulcBctCACwyeTC16nU7Zn/oVi2/f5QIHXS+Di2s1Nyo5czkQAAAGiI+W33ynrPFapjdGWfloGZF2k2AQBwaVb6h6Xku8b8AVtOS9fi3Pt+rW/+oPFxFkOflarLw0QCAACgIWoOtySv+G31cYYP/4F0rBVoOAEAcGly0btV6vZmTr3335ZtS+/sc8bHyEY+wQQCAACgoQqDu2Vx9Bd0LwgrWQkd+jOaTQAAXGIAMHaVSt3u7I8DgO7CrDjXF4zWr3RFpDi4jQkEAABAwyUu+yWpOftVx+hLfk18CnfVggAAm8h6l1eWh+41Xrcre/jHAUA+Zrx+Pnq/2BanBgAAAJrhO7VPFnb/rvo4Ywf/rTgrazScAAC4hIvpyM3Ga3YUj4iz/O6HU3fG/AsAc+HrmTgAAAA0jYXxO2W97zrVMVyrJ2T02LdoNgEAcAkX06OXi+0w/zK97r9+EWB35h2jddf818tK/xATBwAAgKZhO1wSv+LvqY8TOPXvpSc/TcMJAICLU3V5pBh6yHjdzuK8OCsl6SgeMlpX68WFAAAAwKUoBndIIfw3lUexJXzgy2LVqjScAAC4yItqhTfqdywtiGc5a7ao5ZBc6ComDAAAAE0psecLUnMFVcfwFF6WoTPfp9kEAMDFKQzukKpn2OwHUzEhnUspozWXRj4tZU8vEwYAAICmVPb0y/zu31EfZ8vUF8WzkqbhBADAhbMdTilE7jcbACyeEs+y2QAgG72FyQIAAEBTS43fJmvefapjWNUVCb/zJzSbAAC4OKbfrN+xdFS2vPMlY/Vqbr8UhiaZKAAAADQ123JK4oq/qz5Oz/y3JZh4nYYTAAAXbskflvXe3U27fYXIQ1JzupkoAAAAtMB36wnJR39FfZyRQ18U1/oyDW8jLlqAeslH75Uth4825bZlIzcyQQCa1pXP3E8TzuGHn3mbJgDYtJK7Pyf9ye+IozyvNoazFJexo38u01f+bRreJrgDAHWTC1/blNtV7t0lS/4IEwQAAICWUe7olbnLfld9HN/0n0hf5gQNJwAALsxaT1BWB5rvRXu56H0ilsUEAQAAoKWkw/tkzX+7+jihA/9OHNUyDScAAC7wYjtye9NtUzZ8HRMDAACAlmNbDolf8esiovvDrI6lt2X41OM0nAAAuDD5sStErOY57FYHbpNST4CJAQAAQEta9kYku/U31McZOPZF6Vqao+EEAMDGlTt6pDjaPC+zyo7fwaQAAACgpc3u+mmpdoypjmHZVQkf+GMR26bhBADAxuXCNzfFdtgOj+RHL2dCAAAA0NIq7m6Z3fsP1cfpynxfBmM/pOEEAMDGFYYnpebyNnw7imMPSMXdxYQAAACg5WXGbpDV4L3q4wwf/qK4S4s0nAAA2Jia0y2L4Qcbvh3Z6M1MBgAAANqDZUn8il9Tf9+Wo5yS0KH/Rr8JAICNy0VuaOj4Vc+oLA5uZyIAAADQNlb6RiWz7e+pj9Of+Kr4Fg7RcAIAYGOKwa1S6Zpo2Pj56P1iO5xMBAAAANrK7I7PSKVzq/o4owe/JM5KiYYTAADnZ1uW5KP3NWz8bIPvQAAAAAA0VN1dMrv3H6iP416ZkpHjf0XDCQCAjcmFr2vIuCXvVbLiHWUCAAAA0Jayo9fKyuCn1ccJnvy/pKcQo+EEAMD5rfQPS8l3Td3HzY3fS/MBAADQ1uKX/6rYlvYjr7aEDnxZLLtKwwkAgA1cjEfvrvOIluRCV9N4AAAAtLXV3iHJ7PgH6uN05n8oW848S8MJAIANBABjV9V1vOXhT8p6Zz+NBwAAQNub2/GAlLt2qY8zdPT3xbOapeEEAMDHW+/yyvJQ/W7Jz0ZvpekAAADYFKpOj8xe/tvq41jVJQkd/BMaTgAAnF8+cnNdxqm5+qQwvIeGAwAAYNPIDV8lS0M/pT5O7/xfSiD5Jg0nAADO86E0ernYDo/6OIvhh6Tq6qDhAAAA2FQSe/9HsR3634NH3/lDcZVXaDgBAPDRqi6PFEMPqY+Ti3yCZgMAAGDTWesZlNTO31Ufx1maltGjX6fhTcx6+8lHbdoAAGYslUM0AQAM6ZVlmgAABnEHAAAAAAAABAAAAAAAAIAAAAAAAAAAEAAAAAAAAAACAAAAAAAAQAAAAAAAAAAIAAAAAAAAAAEAAAAAAAAgAAAAAAAAgAAAAAAAAAAQAAAAAAAAAAIAAAAAAABAAAAAAAAAAAgAAAAAAAAAAQAAAAAAACAAAAAAAAAABAAAAAAAABAAAAAAAAAAAgAAAAAAAEAAAAAAAAAACAAAAAAAAAABAAAAAAAAIAAAAAAAAAAEAAAAAAAAgAAAAAAAAAACAFoAAAAAAAABAAAAAAAAIAAAAAAAAAAEAAAAAAAAgAAAAAAAAAAQAAAAAAAAAAIAAAAAAABAAAAAAAAAAAgAAAAAAAAgAAAAAAAAAAQAAAAAAACAAAAAAAAAABAAAAAAAAAAAgAAAAAAAGDc/z8AZKi2E5CoEaAAAAAASUVORK5CYII=",
Yb.ImageUtils={},Yb.ImageUtils.registerDefaultImage=function(a){null!=a.src?lc.Logo.src=a.src:lc.Logo.src=a},Yb.ImageUtils.registerAlarmImage=function(a){null!=a.src?lc.AlarmBillboardImage.src=a.src:lc.AlarmBillboardImage.src=a},lc.ssaoNormalImage=new Image,lc.ssaoNormalImage.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAIAAAAlC+aJAAAhB0lEQVR42h2a53IjSZalXbuHhKDMUiNs9nnXbN9vpnu6qzKTJGQo1+570L/KLIsEIsLvPef7ANL/93/rxy2PO+5V6j+KPUr+lfJQl0XtVNIy26BTzUaThcVh0uRAlliahmyMmtvW7tsphNbnu2l2U3FHkSNpTCBX5bscl9ARkyQVLPBaryQNQs6Rval4v8nmkNbImRNKl5yYEXlKlfXS0BDPtb4o/ZnXLqtJ2ybteSFZXUp+E+UuMrsZ8paHzMUaiZLX250rW05Hqq7E6qpSrqYJPG9rVY1bbZZJWOM7M39c6Y5zv7IQKRuqO11oVjMr1dtbm/r/FtddyV9K8itZm9wFWrfFEpfL3ojjQn+ITLowfcbcNrf/DcVo3kbl65nwXRaS48aI87w9ZPtJnSAsZjdoWvOEB9auKdBrpiU51i3rB1PjTty3MvIY7qKqyG4600xVqSvlXRBTvvRiXMvAY66cRbYGelD4n/lJ8ESXy9T9h65/KcuKefH0RGvd4z1DKnUU9cZK8srFwnrbZ1mneBvkPtg848ok9TkPXOssNJlmujd03WJtk75LIeJ6k7J63gk+4TmUbgunRr7MPHPPiE6Z2UCMoLgKoSUrW2sOLjAz8/q+0dvKW87zhduh7EJKtIRWMsWHuZy7uqdVOrWSTHQ78PJFWJ8F0/zCaLOpeV/7leM2Vh2lk6I43/Nyb2W/cdV46wPnpYsvDAPZSBrSIqLLWol1wU+3dY27Q/pSXORKvUy3XKTu73TpdZNr4oF2wnO238TfRO1lDkmLvfBnsrVrs+qyj2zZkXaWtuT4ksz2OHpNyuzY+yVfWvrs6xaUSdU1tlbcuqK5SlrWjzAe6GlX9xNNLQ1rbCZaWrdG+pSt0yoGRXzVRkcdqNWe5pCzSYx3bomt8avsJM2WkThtxngaSeVDLdlY4vMzlyuRJXpCyVpUrLeGvaVyX9QfDRFr0ZKbaR/fVnajrIvpPNanQMk1hlFQJkiu4yy2LvEos8mMlXmoo+2iTWlI1MogC+sSNkxdo9tz7SjtoihkKbrTrmaRlGg3b3ckp4bcS6OEpcpgiSR+ve/YZhtO7yV38pmKz6fcOxIDl5nd29pVrq9l2dHKECiJztx1qXPKNxG3/DVW4b3HcPc3fiJEDs57sj/n1JZ8YOpUiuG44nWsbcisQaoQ19fnW72X2u2ZO9fR2Pmu8jNpZNGcFMqLnZkweALGhVlUlgRzMRmhU9zCnfZ0S6yrDpePEccq0MzCmtUgyhYmpbtrvQmkYp7n1HjBFXF70iCUTI20lEFol3JXw62aIfQzVmjU/mJXVg8i+ZNJpGhDPyhGWSAXsBnDv9bbRtlEYfeltTFVkk2zfs/q9xxOjB+Lniqe5pmKjgd+NNEpHn1si/aiSi6GOl3ZSJhmpm6FNOzqybEh2ZIl16GheAyJBaIUn9Ld1F9KOX/Xe11PQhIehNNpF7C9BnHpWVeEX3R8iuNWMgK6rKs1pV+Zpzo3RQhipW8XESwzMUrh3GzKaDGRPBc6h4A46qrZrHim80doj5ReGtx1UEE2VeRELnwZFgyAiSLQFFKoZ/pHX/5Jpcyeclasf9I4WDKxIJDIKmPoqcvBpNip/UbuzPB9Xgttuy1fZLSZ6iobv91lt98cCsGTZs0Rx90hQLA+S2zG8vOavu3pxSnmOK2UfsvYtXuRpsvywqlkiyJDqy4RA12lZvfsVaeZzamn0ti6oakoSf32Mu9uLenTmsqgCylNtul7oMNSt1bsmciZTraivAyGztD4PWE9mhYdgMxg+zHdL2FQlXETTpUqEn8hT5le0ShHok9q6wg3JVGWqH4NQuQSBafnH+z5EOc0DOHmexMpJR/MjyhInJ5YR3qq27do7reweyaE4Ce54DE6c9Rp4TVuRFTSLtG3XP2U5SXGWyGtdGgemfaa3CMJHS5AfPg4vFW1SnIt9C2RT8XekPvV8dxm2nH6/R/85Rc/1XGYzvnYqijMqcydTCE8Z4Jb2YIfkPvO5j2ZlBSyshoz/V2mSfR2u7dtXmtDUzmEuDWNirj6fGFH3Zykefk3ejvj8UeSCgtKGbJQJQPj1sg+rAMeawrHSq6aHnF7RTE6Vnaq6DWyZjaJ+tKq7btzbfztWP9cRPtGYsShiG5KVnPpsvovVS+0CX5tO3KnlHk/1t4rbfIJrX1TR8MTfvBI5aXK1otAKmuZ+PLR1NJgMmsr46TQN7TlsQYaQ6yjkjff6LRdMXFCBVGTrEMqjoEZJOhAh1k2MiXULgbaHZzauHWkU/lnEzoqxVITBjsFlwlrCyvdT+WRbORGZVbi2TmbqOdhx/h3V3rGeEGOHZpoBSsZUe59og3W4kjryS1tGiemOp4dE1qQr3MZR5Zzlniyia5K77c8c+a7olD6mW6XzPfGLRzXpi6EGUmec/8lAVRxJoVFwMZuqrOgQ2Xz4OhiMk3diwRijUt1W26PqO56zeIoq0XxktJeJPDFaEaaKf+j5z3nfVl/SPrGiKd4SY0pJ7q6WCWJR6XuhLRk+6zyxQxX6mQql9K+tkIw1rcedx8LpikrmpwvYWB5YeqzxpHQmF5b9rd7fR4BVlTu3VcVB2dW4xklfCiR6MMd8xMCYynl6GWfY1VoMoQ3S46w32hKZFgpjuge8WxjL+IXTy9F20zKR6+/MTGFa2THd2fvBBMCdMqhEuznSMO98rWkHXVzejfiH5f8uqdkpuzg77wI56mImpjKXeWV+51QpNabGwcZKcl3RnqBFTyYbZmHrg120QMgpHpqKGKe8Kgnd8Vv3dHoADR57OO9FQikLkVJWKZgtYKzJa0LzaNN5djltDWg3FDQ092h3LfYdThIxSYCtom3CEzWB14KrTern4AhpFhWdxjdLDmZ7qptCvCkJiqahO2ldOH8gMIQ86fnIzUHYlNNZ77v07QCjZI66Ja6ZePj3nnLWDCc1Nig9KV84tlnHOOpELpzt4n3HQlmCxcEqNdKSZZ1BQQQlEshhs/LxpDUlWpC1oBarJGZ3lx9ypTmqdDntF/YXz/D846EPdiRppnVpnYL+QK17CVaLzrUUWh1KzZA4ZwoxnrRCIfxIG4htje8ARGvOW6SN+ugm8+tNKWiisJNDTqcOypsamdxquUbKMnEbdNG1M0JoaARjp9M2OW21eCM/aLzIZeToV1gMbGh8bkMK6YreE2ajQx7Ot9c07UA4xR1czM3k/YHZj2AUnKV1xfWO+aF3Rn1ZWnralWZbxwjIpSM0WQflSphPtP9b7n/YRzq81DlwmdwpWCLTSN6tAHgh6lP/IO1r1s1yGap1XrZ6mDrXaS24c1MQ+PSyMQuDxu/N5v5Z0P7BNRH1GB8HrsR4hPJJyWOlTWFb0jqST+1dMPNEdooevP+6S7iW2UTtzgnRbqFkc1FVqdAZcE8qy8Sqi7Son+uEpyrmHINf2Ph6595HOtVwHgQoan7VemFWTzTVEDjhpXemeU/wmHiCV6kmIyMHBSxHNHNbBJje8ri1w+xdg+qef9L358TkCXbKm+ZiEIbKmj9snIYsIil7pJy0vaJwO82jEMdoxY43jXfPsPQNUwUP5VRl/Nr8y2lS4QrSqAkCtgwc3tnwpnSIl2qB49P8IgdnJbqrSJhFLLwWj1LZtb00frAJVHQMre8xpqZ3sWcRFkuybSUzxIxtkLfsGjPUALMBl4Ng8eBfwoB9UYbV26pNETrYcV1T4eqz6yTs0jQyZVxvWPkQ9lDLBedevWvt16x53XxfMfjpRK+ymKkJJg9EWc2TFmMxZ8c7oo/3dza9AQtM7NYCdl7ZLS6c5qJbSuTPnNNcqBPiVwl6WinRLLb2ulxZjcSecfQa3jtAiByGTVagthgPYnJsSBWko3UqydN5lq1K1uR7Z1vwjVDr+Dysa1ivS8Mctd5iINeZW2wJ7xMPR5IovceUUNa03BvJZzKtmNsgxERw60V3nLpekLL/hp/dPKdxemTqZZwaeeWdKR+nMTvfIMRBjjNnhOEvrdBtPTPnHZVWoREhkvqDBSsAxEpIFJZq8B4Xn5pALzFlDdI00furU6N3bZS3Ut2yqGPKqagubZdaVf6s1E7POzZXTv9VHN74Unm3G2cCyXq14W/4sF5oncpmArj4NQT0nEC/aZy5vI5MafEcBTXJRyTllitRPbjCkNb2mkgHbQmY5d4QE6z/5PZatDgxKod0LOk7178ZtgHzF42DjpZTR7YNkbxExQIwwNRU/rE3aa4qXmriglQAAfGU8YXUkaEDPWFJKOfnbr3Xu8pRSrODXpndeW98650pFszwplJsdEqmkpRGUe2D+HvW2xRlgTiUZ+asqaEx2uKXFcxN+5FdrfzmoeGAxBSYo0Y/ynPQ2k3w5t8g/7sxX8Wfq4h4mEpqAc6qEgXw4nHdyHXEGHwOpYNJ+Zva9M95fZngguXh/SJ3KMLiN5XnfIN3czjfq6XqvY7cHEk3O8Tv0EgmrgXZtuchoFwSTWAbdH8FL7E8Fzsuq8mpGZVN0gcQ3q09q2UhT9d80V43nUgeranPIGx5KS23lfbc3Oh0MXdrc4EoYaGIooWkG4FAqBxn7kA7HdBeFl8pozoRuM2wv9w+l4fLPAly4AKSHaW+Z5LbQxj1mCjwnERd2AcxMJp+8riVv64lh8Uqt4OpIibi+/Y9JiV0UItPyh/skxYfhkzr9RUsqT0eimBs6+jHyYIVSI83YGlnPUsPx49smjN4oWnTtYpaV8DfEMxLDwfS1gpaSkcmSu6LXgTWw1XiXxfyDgG1vDPWp9ZZR2BqqYbZZlwIWi3nKN+rWW5qnwoQJJ9YaeUDlMiRP2JgYxkSDnBuP8g+Tvtnsd0zuSwgax1sp59G/TsOX5Yu9ry1XPFcRHjuYnHlK2TzZHQlViRVJalq7LWsFT9yfNOWZoUafSYvSSwftPjNIDMPE9ZdmypHE8BMrY31Z8rM6ZLa70p2+CtA9qxM3kmIFS9k3K9BfVbS4FGqVg8g5FuKxaav6ThhDXJ1fKH4Gnkh9XCWKxmbVWen/LhZC8tMomUpAmmqPI5p0OTapvLxtRWHcpl5GUNdxrbla0Llc+F6A2BPfR08zFXyr8wKCLcMx+iISL7OivEFmiMLug0SsihFuuaBAnm39p4usMbgLGyiTiMUhhvfivutEI0NKH3JFWhI6k/awiGCu1dlDoxsUh6AB7NyJHc9gTzmU4ksyis5CLhv6HSIJJuuFvI/v6gYzZyReh2LZzLAY17Y/1rXm8CboxomRbfMzrdw04CLVBGIPPmhi34zddbvImmB9nxQGxk0QhMjmSNqp8/VHcMWciyEobdeRbG1c9z/QYk9ewm486LhZObrr2Um0/syjjj6omJXtDzLZhYdadWy/KQhqCs3pBqVDBfcw9chDpfLOJqIWa/91vAFnPWRGP45zntWhnOtN+xJSS0Gc/1nNPY8JU5ODhpCO7rjXf/xEY05GXNM4MnyiYz/Nguyc6U71N8f0PZNcLbOVM8n3apfw75aZNLs44blZgUBJPlBip0R9PQzCXvUohJ+EiY0oHHoST81O1UB0nu89D0KVqCJVMmLU6YA/xFNMQFdERIipOTNe2c+kFrwedv2V6IkpRXcoLzPOo2jlbFHrRs3pT+4GH8S6IZv1T9JaUPZFufjx7uBYDNo2nv1GE8OVWdigET4NXuA7+ay/3odkEsxRu926cH8+7SxMRIbAi0z6BGZz8c+b2tP0V9krkNBel76MTmhRjCZmtXxcC3i1VH4q2tTHmCTLyk9oncM6ZwKksTChcxDsR8EHdoKVziGHAcail89PlHpq8rnZ7Kzxz+zcqTJL8T9/evmjp+I+QXyZYSuglBiJhuv9VwHmqDl7O5MYVq6xJpDwnC6jAzYiaxqdFW/CPg+9ciTs/NYVodVoEKyfxW5cDoDb9MabiavXa4k6TUsVJHK3pKbnW9gHkUhawwQei4qdLeotqJuYZnpudzpapa2eG0eigOZ5LQ7538NScP9BsgkebThF90PUuxW+t3y15Qdz3aNI85+NCYewFaIqZhBxmqGISdWWOwkPzKmy6UPXq5o/vAyRVT4fJspVdxlGGFw+IIZmh0NSK5nXITRd4iMT3FtLEIIzSUrLCmoZYWvL1LKfYEmw3Ae/LU0tK85LqWbeODMqwJV527ewScLC0Ha+BOO5aWq5yE4zaxth44p5pZTK3pXaqOuvce5qVNk6mvZM2q5Vtfy0xXIOojOP2ydebgA1gzzkJs6NMywL5njHZuzmXpAeR0CcTIQBpZfZAC1CFcD54vcsq56ZgGwIC++4kZeU+5Z4fZ2UbUO1GmnoXSu2Bk+ZH401e+Gt0PWdCySPP4ZgH9nPII8aKBWjHzKG/ixTQfpQxY+I7ax0e2Od+Qy1TsJPAD7TZr8u7omZKG9fmp6Cgf29trsbZZrdFemBK8RuKfEoYUj5lONXHW7nDgoNAau/x6LydX+hY1XTcbW4uwsr1gxFCHhUcspNjsql1NBzYJ+baJB6L2tYc9ZZk2NqRwfykNcJpBDJSgQLhEIFYlWDwlFaiu6cQxAG0pn0/p9avZaJIXElAgXbYd9KZanRo8MliL4gHxNFr5ycSgozV6jvn4N1meOV6WPgEIS/CCTRQyac7JjSA7ZhvOVq6kB/7SMoBVAJllZpspv0f2SZgeLN243AlWmI9JZ/xYIZyFt4RyHiKdHH/qAhxkqqBTOUB2pRAycieBKbrB9pvTFIf/0dsLZUHUt6yC34rGkmlB3ezVgdSJu4Ht8ZuPD1TuKe1YnOPAi/q1g0pXUxgDbjZsiCsnA64RuhKbYcxiLj6lRMyB++/Z7cYyXQob607QuyM9ZGYhCVgEm5miGDMoMD/pEMjhziLDMdR2DOezQHP3vrS9+TjHF8jkS0ZbX6N7H+l8jqoFjOsUkWT1s/oxtXLwjy8fUNSSmNzMfdRrRr6ItFF+aOO58L5wn+8hDqJ6QHvcabO4S6ubaNdEd49v+2aL58nogIXAuJlBuNsXGRq8caWr8cU91kVVxliZiuglWQI/sHCqY1fPG33eRTze6Hw3VOSUY5TO9oAne3D0R0u7wHdt+GL6ENJCg8wVw7nVp7VfYeiXfTQbs5EcBKJAAr8qIzsi2N7l7whP1qS80A6VjK1u2mVdEEl8YPEUeDfWCp5tE+6WHGi/+rXKNZVeNFfE0IrYxoJusNGesBMprS0g0EHGHy1vL6Td4ZqVeYXHJSiiigUQAmAVJUaiiuJ84vSbpyH0P+qGqFhzJ01E+IGo+oUuba1Kkw1SWwfaIqk6zBvNO2q2AsnQTNmqyVokR0nBUjJbbv1xhzZg2P+RyRQ2mvOVqaGl4UddhoahvhugMmltxn2IimElogt3aEBlpUVCJvZZ+7GmXzO90TxQg8UmnKYgcAtQQEauz8Dj5koSfuo+iSfSPSaPUKKlJcA51jCezh1/kfQey+PohSg2uBKkPDbs8knoqxE3XpAONQqatkeXk7qYeHBw4SRFwi5Mce6AwbG+m/xRFDtmsz0+cAVk8Z66jBetIm8gT4X4L9XL2lsy0kqOJm5RXWr0ghf4qqAKLSaiysctf2dy96mAXazFe1Gj/6V4Q2EW74gGpF6QRdNfZg4g5T2B/UA8afdwx1dRPopUBwBQElzQaFmBzyAsnKivjHyy8OLIVkswy0ifmf28Atvy6SoHs7lG5IenEe0NxNoAUxINpSk92RI7SPrnjcL0kIglRGUEi9U+pTaL6GHPTD0XMNkH5L0l7CxmRY+34loSnICUrlvtaKOCRSyFlosTId9cmGncOD3CuZfLZdQqLqsQ3BdAdWEC6wIvTsqiKfcm+p8YCck/oCaYu+Rzxf1jDxdS4a9LoHlOus1Nya4IrbevOe1EbGgjS5lCdVt62fENzqAiUCDUJExqSTPb0GBcxxKv6LHSEKUv25WrDjKgQ0/UnSJZCHBiE74eSGOjPyP2pP0uGAK9Eh28jShCXyAyfUbQwy2bpyD2Q/3BgBkG/G0rett0JYd9wboPqoSLOeziVahXES8rLxqbDXyHDMS6r9nm/c74UAedLncxdijsMiPWDImI0Ao2kXxVlSasjMIpWDGxDG3gYpmZbg1xiC/Gc0hmFG0qf/f1D8FPaBUSnWiHHNhTPnv6ruuPi/5tDF+aPyt6nqXUvsVEgq/RELGygdWC5bLM97B1UqFEvCEL2b0Et8AyYngggDsE5SikhJinx/QzEjtSgwzWFrmjeSm5U9gO9KtM+v7Aa08e3zPJoXoY2WRsk9RS03OlNHL+r69WycJ5iDAcNGNHyjWRHiuFEdyRmpl14SDMdcqvjyuRsKN6q9gOedWhxQHjqvdi95MivEAptmdqzrlQdaRxovEo9JSZpDlSBgOoGdEQBH/8YxJM0aKaLQcd24y72zLdk/4rfPAyEp2lhfCsmRmVJwKpqrso3m7yS1FKkn08uuotqfCvJvIGqQUYBtnyWxMXL8c++1sMlPM9qxMGgOZzJQ0smDr16F7EGrgs+SLOl3rQUdyRUqUi5mtKe6FOFDKg1wrtHmwyxxg/jXihYYV6pw1DjSGc5kX1vwCwJBS3O8p0dVUaRA1SIR8DucB6AU4b4jA3nsKv51YaTEXDiheBpbo95htBt5J0KHxdUYbJrFKRuM5M8MhHqj/Ztg9izlPlu5WqvRdnHY91CXngQMoqRvO4oqb3m5HOinat9CtzpfjM8GQHg2Os5W7Ur7L9pJcBt4rh0mgd+p99/zNddNWxEQ29T3oQZT6w/h7IYB5wFLnfMrye4PUq3AvVmoJmqLOjYEs24rdAPyS2O0dp28irVpmNOv0cGF8F20r5GV2n2/nxARHrkTl5W018l92F3Q2sOrmDFDDHk9ia1WBGO9Bbz3QAqsN7sj5nn0vTlVny/s88dfW4wXPRfSSMhVwCB1tBTsGJc963/AvzuJSi6OzcvhLfOlzuE1k321sjWlAfdg+De22Q8njlbuVURBfFjroliIY7AolyZsS1ARRwUEp77lnL2bWOK55z1fXxBfas8j7CucX+RsRUZRvaqY37xGxbgdS3vnldCz0Vv+OPz9OvdSAsvAd+V0SkyGJ5rm1SaY0BpQ1hspQJXJ3AKDlYHaEteXwml+0Dgb3W6ZAGn9c3Rp2Jf8EP0fptL7DWqaiul9FaKh3qQT8xcW4Sz5Qw4Fv5gtWuHJG0DTUpg/0klJZnr2fIzgrgu3RRCO23lWJUrhlVGTBW+y9vn1hWRC+PT28Fq3Oi3f3xWUi2NPGKvcITY0+cXoowJcwiHIH+xYDwofXLFpQChEgXpqEe0Af36o+qvYcl3eWOPYgvOQBD5LTJTjHugX870m3+QmQrCKh2bMmMIJw8fWPZEr4B/h/fQgep9L1W4awVOuZWEuGpVsM2TWy3g4Q0cYq7Xn2fYkelGtI2STrgdJk/Sa34NpQdLemrhp1mf8X6DUAT2Vsdf5CyY+ulyjFqJgFssBM4kFnF4wOYX+J8qTtaG9oi4zi8WmQcbbOySdD9VKDaJCbXmzbErzv54xjPttmnfOm0uwQltex8PSv+muEp4wXV8vj7lX0R+SaglHa2da8FEjtN2bRsCls/8sdnKhZcuuIZEYczBgoKafMs6OEFJ5zNQLYJ8UPheWmvtC14Ayg/TXVSy8GKBy4XXFd0ofx7Zf+7k3rdKDWFzuOGpVR3vrVc+iEoUL2r3COx5KsCucGZ8mqkBh8PIq6JbZwfbZ64qd7pwlnF262CDggo2WuQ9OOzzX+I9/d6ARxpVb4kbSuRYCRdZW0tpE4/TH4gYQLopl7wGeiK7IaxUDaSWDTJniH8bGOP0SBwsDKvtNyPTb/lPzkbLtntuxF2eTfbsYo5GWl4pKmUDaeheUWxNeKIAvhvOfyRYGAUuHUWpaVPOl7co3nGTU6GkYx+YXFrBBPCw0ZDcisZX/0i++G+rJ1kvySMaxEJJz4Uub7UeV1faDv/iM0zxhypDI9EX4te0WmsFjxeeIv+B5Lf0TI1OYIYfXwIZ8uD/XAWgh3W+lFS8171JggMWj7+jC1Q1gc6i0epjzf6sbDxv5z1ff85TU9qfC5zoKg7kvIgKXnP4bYOvI8np1/JjDt4/AXbpa7wIkqbzU2qoY4za5td8B9NM9ibkvyvDotxW8X+d7KCZlpLJ8Q7hFbc5iQGIkuDNTk3cueCHUmJVL2UxT6WTHoGxsUAxi5Ogb8qtZ3srPNvhpyKcJlSxRZIXgFOw9ITf2vElg3gvmvogmR1KD+Bi+jjRejuH92wg5HJ8gdglvHXIILl5ZU1qw2PPyRjCmDEVkeRYfTQ5SmyZovzvo7Jyp1xuFyU3EksPaKAYDfqq9Y/ocZ4GQ2n23rWftHZeLw6zqip9QZHeUhSmrx6495BHNqqvPpUWaVEaYWqtEN8fIdviX8V4gsV9zh8BFUvfQIBTqJpC6Ko+yj51WobTjvyfEfMcf7BRBl9uBSlhITubbhfcIbpU1oGsbYJY5CY7OeUdVszsYpqV8qzfHyrZ/kdD/iEi64isn2gt8TaG9u+beLSZp17QqesO0BuxpUS2tCvJF9Ri1kqnIkjUxWqlapc858D+EkcQ/1S8SCbpeI5Bhjtoh8MOdKsifKs/CHLKcdeHzJyggwu5m9H0S3axoumfCqYlYj3W5rkGl63yM88dAVr0mv6T5ch0+hgJfyXl7tRurMlUUhRNqV2Ls40OMnGMeRH4IYCzcHPtjliSMDzXd19VKofhq0z7Cl8T+RXgZEpaxjNjjfeXS9yJ7yaSWCqgJXAbZrqjrkp1Z807wvC/5sWf3fljTKyldxHP2exqTKGzjZFAsWCvvdEUyqTVfsu7jw9M6/FPZEdNN92YyqLNuMWEXX+HeAkfRuHyZ6Vgh22Jqw/TP8S1iiLlmOOBQkrhZWgEpKOjysyCXnWeuqOhCG4w8Z3Y73HVXSwaqq5XsGCIRPfiA7qzxEvct/Rp1g+Re1ZBfWTuCSwPorGEOSgDtTXwu88NZtskMdM6igFXWZogdBPhX2VgF6F8QxhGR+PKh8IUtp8EZhnXiQfHp8hdYO7WNq82S2BeMD7LmTMQ8UYo3aQNx7qpx3QSdlti6LuMmdEPGUoHmEcGBsqFhkrQYTxcIF/OLrvAquMLiU8/t64tqfySR9/eBiGFCvnNUnTCL7Dy3TmjlfrIi/PPV0vRSPSjARvtREUZHvR3JEMc6yaw1b3W7xAwl/j8dRdVBxXCfLMXj3Tik7QhTx+NUAPEdzcjfW48HrIyFl1j0BK+aRorTuU4TkuMh0EM3sRzvHYGvVimxuUcDjv6jue9imzI28CO2tmaAUFja06T7WDDzbwFCEo//9wY9hCWlkh5gAAAABJRU5ErkJggg==",lc.ssaoNormalImage.loaded=!0,Yb.EventDispatcher=function(){this.listeners={}},Yb.extend(Yb.EventDispatcher,null,{constructor:Yb.EventDispatcher,addEventListener:function(a,b){this.listeners[a]===e&&(this.listeners[a]=[]),-1===this.listeners[a].indexOf(b)&&this.listeners[a].push(b)},removeEventListener:function(a,b){var c=this.listeners[a].indexOf(b);-1!==c&&this.listeners[a].splice(c,1)},dispatchEvent:function(a){var b=this.listenters[a.type];if(b!=e){a.target=this;for(var c=0;c<b.length;c++){var d=b[c];d.call(this,a)}}},contains:function(a,b){if(this._ls)for(var c,d=0,e=this._ls.size();e>d;d++)if(c=this._ls.get(d),a===c.l&&b===c.s)return!0;return!1},add:function(a,b,c){if(null==a)return void console.error("TGL.EventDispatcher#add:listener is null");var d={l:a,s:b,a:c};this._ls||(this._ls=new kc),this._f?(this._addPendings||(this._addPendings=new kc),this._addPendings.add(d)):d.a?this._ls.add(d,0):this._ls.add(d)},remove:function(a,b){this._ls&&(this._f?(this._removePendings||(this._removePendings=new kc),this._removePendings.add({l:a,s:b})):this._remove(a,b))},_remove:function(a,b){for(var c,d=0,e=this._ls.size();e>d;d++)if(c=this._ls.get(d),c.l===a&&c.s===b)return void this._ls.removeAt(d)},fire:function(a){if(this._ls){var b,c,d=this._ls.size();for(this._f=!0,b=0;d>b;b++)c=this._ls.get(b),c.s?c.l.call(c.s,a):c.l(a);if(this._f=!1,this._removePendings){for(d=this._removePendings.size(),b=0;d>b;b++)c=this._removePendings.get(b),this._remove(c.l,c.s);delete this._removePendings}if(this._addPendings){for(d=this._addPendings.size(),b=0;d>b;b++)c=this._addPendings.get(b),c.a?this._ls.add(c,0):this._ls.add(c);delete this._addPendings}}}}),Yb.PropertyChangeDispatcher=function(){this._dispatcher=new Yb.EventDispatcher},Yb.extend(Yb.PropertyChangeDispatcher,Object,{addPropertyChangeListener:function(a,b,c){this._dispatcher.add(a,b,c)},removePropertyChangeListener:function(a,b){this._dispatcher.remove(a,b)},firePropertyChange:function(a,b,c){if(b==c)return!1;var d={property:a,oldValue:b,newValue:c,source:this};return this._dispatcher.fire(d),this.onPropertyChanged(d),!0},onPropertyChanged:function(a){}}),Yb.Texture=function(a,b,c,d,f,g,h,i,j){Yb.PropertyChangeDispatcher.call(this),this.id=Yb.TextureIdCount++,this.name="",null!=a&&this.setImage(a),this.mipmaps=[],this.mapping=b!==e?b:new Yb.UVMapping,this.wrapS=c!==e?c:Yb.RepeatWrapping,this.wrapT=d!==e?d:Yb.RepeatWrapping,this.magFilter=f!==e?f:Yb.LinearFilter,this.minFilter=g!==e?g:Yb.LinearMipMapLinearFilter,this.anisotropy=j!==e?j:1,this.format=h!==e?h:Yb.RGBAFormat,this.type=i!==e?i:Yb.UnsignedByteType,this.repeatX=1,this.repeatY=1,this.offsetX=0,this.offsetY=0,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!1,this.flipX=!1,this.unpackAlignment=4,this.needsUpdate=!1,this.onUpdate=null},Yb.extend(Yb.Texture,Yb.PropertyChangeDispatcher,{getUniqueCode:function(){if(bc.isImage(this._image)||"string"==typeof this._image||sc.isArray(this._image))return this._imageSrc+" "+this.format+" "+this.type+"  "+this.wrapS+" "+this.wrapT+" "+this.magFilter+" "+this.minFilter+" "+this.flipY+" "+this.flipX+this.anisotropy;if(bc.isCanvas(this._image)){var a=this._image;return a.__uniqueCode||(a.__uniqueCode=Yb.id("texture")),a.__uniqueCode+" "+this.format+" "+this.type+" "+this.wrapS+" "+this.wrapT+" "+this.magFilter+" "+this.minFilter+" "+this.flipY+" "+this.flipX+this.anisotropy}},resetValue:function(){this.name="",this._image=null,this.mipmaps=[],this.mapping=new Yb.UVMapping,this.wrapS=Yb.RepeatWrapping,this.wrapT=Yb.RepeatWrapping,this.magFilter=Yb.LinearFilter,this.minFilter=Yb.LinearMipMapLinearFilter,this.anisotropy=1,this.format=Yb.RGBAFormat,this.type=Yb.UnsignedByteType,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!1,this.flipX=!1,this.unpackAlignment=4,this.needsUpdate=!1,this.onUpdate=null},clone:function(a,b){return a===e&&(a=new Yb.Texture),null==b||b?a.setImage(this._image):a._image=this._image,a._imageSrc=this._imageSrc,a.mipmaps=this.mipmaps.slice(0),a.mapping=this.mapping,a.wrapS=this.wrapS,a.wrapT=this.wrapT,a.magFilter=this.magFilter,a.minFilter=this.minFilter,a.anisotropy=this.anisotropy,a.format=this.format,a.type=this.type,a.generateMipmaps=this.generateMipmaps,a.premultiplyAlpha=this.premultiplyAlpha,a.flipY=this.flipY,a.flipX=this.flipX,a.unpackAlignment=this.unpackAlignment,a},onloadTexture:function(){},setImageSrc:function(a){if("string"==typeof a)this._imageSrc=a;else if(sc.isArray(a)){for(var b="",c=0;c<a.length;c++)b+="string"==typeof a[c]?a:a[c].src;this._imageSrc=b}else this._imageSrc=a.src},loadAllImages:function(a,b){function c(c){c.onload=function(){c.loaded=!0,c.onload=null,e++,e==d&&(f.onloadTexture(),f.firePropertyChange("image",b,f._image),a.loaded=!0)}}for(var d=a.length,e=0,f=this,g=0;d>g;g++)c(a[g])},setImage:function(a){var b=this._image;if(sc.isArray(a)){for(var c,d="",e=[],f=0;f<a.length;f++)"string"==typeof a[f]?(d+=a,c=new Image,a[f].startsWith("data:image")||(c.crossOrigin="use-credentials"),c.src=a[f],e.push(c)):(d+=a[f].src,e.push(a[f]));this._imageSrc=d,this.loadAllImages(e,b),this._image=e}else if("string"==typeof a){if(this._image&&this._image.src===a)return;this._imageSrc=a;var g=new Image;a.startsWith("data:image")||(g.crossOrigin="use-credentials"),g.src=a;var h=this;h._image=g,g.onload=function(a){g.loaded=!0,g.onload=null,h.onloadTexture(),h.firePropertyChange("image",b,g)}}else{if(this._image===a)return;this._imageSrc=a.src;var b=this._image;if(bc.isCanvas(a)&&(a.loaded=!0),a&&!a.loaded){var h=this;h._image=a;var i=a.onload;a.onload=function(c){i&&i.call(null,c),a.loaded=!0,a.onload=null,h.onloadTexture(),h.firePropertyChange("image",b,a)}}else this._image=a,this.firePropertyChange("image",b,a)}},getImage:function(){return this._image},dispose:function(){this.firePropertyChange("disposed",!1,!0)}}),Yb.TextureIdCount=0,Yb.PixelsTexture=function(a,b,c,d,e,f,g,h,i,j,k){Yb.Texture.call(this,null,f,g,h,i,j,d,e,k),this.image={data:a,width:b,height:c}},Yb.PixelsTexture.prototype=Object.create(Yb.Texture.prototype),Yb.PixelsTexture.prototype.clone=function(){var a=new Yb.PixelsTexture;return Yb.Texture.prototype.clone.call(this,a),a},Yb.CompressedTexture=function(a,b,c,d,e,f,g,h,i,j,k){Yb.Texture.call(this,null,f,g,h,i,j,d,e,k),this.image={width:b,height:c},this.mipmaps=a,this.generateMipmaps=!1},Yb.CompressedTexture.prototype=Object.create(Yb.Texture.prototype),Yb.CompressedTexture.prototype.clone=function(){var a=new Yb.CompressedTexture;return Yb.Texture.prototype.clone.call(this,a),a};var mc={pools:{},useTimes:{},size:0,setTexture:function(a,b){mc.size++,mc.pools[a]=b},getTexture:function(a){return mc.pools[a]},useTexture:function(a){if(a){var b=a.id,c=mc.useTimes[b]||0;c++,mc.useTimes[b]=c}},unUseTexture:function(a){if(a){var b=a.id,c=mc.useTimes[b]||0;if(c--,mc.useTimes[b]=c,0>=c){var d=a.getUniqueCode();delete mc.pools[d],mc.size--,a.dispose()}}}};Yb.TexturePool=mc,Yb.TexturePool.TestTexture=new Yb.Texture,Yb.SerializationSettings=function(){var a=Yb.SerializationSettings;this.isDataBoxSerializable=a.isDataBoxSerializable,this.isStyleSerializable=a.isStyleSerializable,this.isClientSerializable=a.isClientSerializable,this.encodeURI=a.encodeURI,this._pm=Yb.clone(a._pm),this._sm=Yb.clone(a._sm),this._cm=Yb.clone(a._cm)},function(){var a=Yb.SerializationSettings;a.isDataBoxSerializable=!0,a.isStyleSerializable=!0,a.isClientSerializable=!0,a.encodeURI=!0,a._pm={},a._sm={},a._cm={},a.setPropertyType=function(b,c){a._pm[b]=c},a.getPropertyType=function(b){return a._pm[b]},a.setStyleType=function(b,c){a._sm[b]=c},a.getStyleType=function(b){return a._sm[b]},a.setClientType=function(b,c){a._cm[b]=c},a.getClientType=function(b){return a._cm[b]}}(),Yb.extend(Yb.SerializationSettings,Object,{setPropertyType:function(a,b){this._pm[a]=b},getPropertyType:function(a){return this._pm[a]},setStyleType:function(a,b){this._sm[a]=b},getStyleType:function(a){return this._sm[a]},setClientType:function(a,b){this._cm[a]=b},getClientType:function(a){return this._cm[a]}}),Yb.Styles={_m:{},setStyle:function(a,b){return null==b?delete Yb.Styles._m[a]:Yb.Styles._m[a]=b,Yb.Styles},getStyle:function(a){return Yb.Styles._m[a]}},Yb.Styles.MaterailType="S:m.type",Yb.Styles.NormalType="S:m.normalType",Yb.Styles.PREFIX_STYLE="S:",function(){var a=function(a,b){Yb.SerializationSettings.setPropertyType(a,b)};a("combos","data.list"),a("name","cdata"),a("toolTip","cdata"),a("parent","data"),a("fromNode","data"),a("toNode","data"),a("alarmState","alarmstate"),a("vertices","list.vec3"),a("faces","serializeabe.list"),a("uvs","list.vec2"),a("position","vec3"),a("rotation","vec3"),a("scale","vec3"),a("location","point"),a("materialSize","number"),a("color","color"),a("ambient","color"),a("diffuse","color"),a("specular","color"),a("intensity","number"),a("distance","number"),a("type","number"),a("startClosed","boolean"),a("endClosed","boolean"),a("curveSegments","number"),a("amount","number"),a("vertical","boolean"),a("repeat","number"),a("centralized","boolean"),a("visible","boolean"),a=function(a,b,c){null==c&&(c=null!=b?b instanceof Yb.Vec2?"vec2":b instanceof Yb.Vec3?"vec3":typeof b:"string"),Yb.Styles.setStyle(a,b),Yb.SerializationSettings.setStyleType(a,c)},a("select.style","border"),a("select.width",1),a("select.color",65280),a("select.offset",0),a("outer.width",1),a("outer.offset",0),a("outer.color",null,"color"),a("m.type","basic"),a("m.color",16777215,"color"),a("m.side","front"),a("m.alphaTest",0),a("m.polygonOffset",!1),a("m.polygonOffsetFactor",0),a("m.polygonOffsetUnits",0),a("m.wireframe",!1),a("m.wireframeLinewidth",1),a("m.gradient",{}),a("m.gradientType",1),a("m.transparent",!1),a("m.opacity",1),a("m.visible",!0),a("m.depthTest",!0),a("m.depthMask",!0),a("m.alignment",new Yb.Vec2(0,0)),a("m.linewidth",1),a("m.texture.image",null),a("m.texture.offset",new Yb.Vec2(0,0)),a("m.texture.repeat",new Yb.Vec2(1,1)),a("m.texture.wrapS",Yb.RepeatWrapping),a("m.texture.wrapT",Yb.RepeatWrapping),a("m.texture.flipX",!1),a("m.texture.flipY",!1),a("m.normalmap.image",null),a("m.envmap.image",null),a("m.specularmap.image",null),a("right.m.type","basic"),a("left.m.type","basic"),a("top.m.type","basic"),a("bottom.m.type","basic"),a("front.m.type","basic"),a("back.m.type","basic"),a("side.m.type","basic"),a("alarm.billboard.scale",null),a("alarm.billboard.position","top"),a("alarm.billboard.vertical",!1),a("annotation.class","tgl_annotation")}(),Yb.extend(Yb.Styles,Object,{}),Yb.BoundingBox=function(a,b){this.min=a!==e?a:new $b(1/0,1/0,1/0),this.max=b!==e?b:new $b(-(1/0),-(1/0),-(1/0))},Yb.BoundingBox.prototype={constructor:Yb.BoundingBox,set:function(a,b){return this.min.copy(a),this.max.copy(b),this},setFromPoints:function(a){if(a.length>0){var b=a[0];this.min.copy(b),this.max.copy(b);for(var c=1,d=a.length;d>c;c++)b=a[c],b.x<this.min.x?this.min.x=b.x:b.x>this.max.x&&(this.max.x=b.x),b.y<this.min.y?this.min.y=b.y:b.y>this.max.y&&(this.max.y=b.y),b.z<this.min.z?this.min.z=b.z:b.z>this.max.z&&(this.max.z=b.z)}else this.makeEmpty();return this},setFromCenterAndSize:function(a,b){var c=Yb.BoundingBox.__v1.copy(b).multiplyScalar(.5);return this.min.copy(a).sub(c),this.max.copy(a).add(c),this},copy:function(a){return this.min.copy(a.min),this.max.copy(a.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-(1/0),this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(a){var b=a||new $b;return b.addVectors(this.min,this.max).multiplyScalar(.5)},size:function(a){var b=a||new $b;return b.subVectors(this.max,this.min)},expandByPoint:function(a){return this.min.min(a),this.max.max(a),this},expandByVector:function(a){return this.min.sub(a),this.max.add(a),this},expandByScalar:function(a){return this.min.addScalar(-a),this.max.addScalar(a),this},containsPoint:function(a){return a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y||a.z<this.min.z||a.z>this.max.z?!1:!0},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y&&this.min.z<=a.min.z&&a.max.z<=this.max.z?!0:!1},getParameter:function(a){return new $b((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y),(a.z-this.min.z)/(this.max.z-this.min.z))},isIntersectionBox:function(a){return a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y||a.max.z<this.min.z||a.min.z>this.max.z?!1:!0},clampPoint:function(a,b){b||new $b;return(new $b).copy(a).clamp(this.min,this.max)},distanceToPoint:function(a){var b=Yb.BoundingBox.__v1.copy(a).clamp(this.min,this.max);return b.sub(a).length()},getBoundingSphere:function(a){var b=a||new Yb.Sphere;return b.center=this.center(),b.radius=.5*this.size(Yb.BoundingBox.__v0).length(),b},intersect:function(a){return this.min.max(a.min),this.max.min(a.max),this},union:function(a){return this.min.min(a.min),this.max.max(a.max),this},transform:function(a){var b=[Yb.BoundingBox.__v0.set(this.min.x,this.min.y,this.min.z).applyMatrix4(a),Yb.BoundingBox.__v0.set(this.min.x,this.min.y,this.min.z).applyMatrix4(a),Yb.BoundingBox.__v1.set(this.min.x,this.min.y,this.max.z).applyMatrix4(a),Yb.BoundingBox.__v2.set(this.min.x,this.max.y,this.min.z).applyMatrix4(a),Yb.BoundingBox.__v3.set(this.min.x,this.max.y,this.max.z).applyMatrix4(a),Yb.BoundingBox.__v4.set(this.max.x,this.min.y,this.min.z).applyMatrix4(a),Yb.BoundingBox.__v5.set(this.max.x,this.min.y,this.max.z).applyMatrix4(a),Yb.BoundingBox.__v6.set(this.max.x,this.max.y,this.min.z).applyMatrix4(a),Yb.BoundingBox.__v7.set(this.max.x,this.max.y,this.max.z).applyMatrix4(a)];return this.makeEmpty(),this.setFromPoints(b),this},translate:function(a){return this.min.add(a),this.max.add(a),this},equals:function(a){return a.min.equals(this.min)&&a.max.equals(this.max)},clone:function(){return(new Yb.BoundingBox).copy(this)}},Yb.BoundingBox.__v0=new $b,Yb.BoundingBox.__v1=new $b,Yb.BoundingBox.__v2=new $b,Yb.BoundingBox.__v3=new $b,Yb.BoundingBox.__v4=new $b,Yb.BoundingBox.__v5=new $b,Yb.BoundingBox.__v6=new $b,Yb.BoundingBox.__v7=new $b,Yb.BoundingSphere=function(a,b){this.center=a!==e?a:new $b,this.radius=b!==e?b:0},Yb.BoundingSphere.prototype={constructor:Yb.BoundingSphere,set:function(a,b){return this.center.copy(a),this.radius=b,this},setFromCenterAndPoints:function(a,b){for(var c=0,d=0,e=b.length;e>d;d++){var f=a.distanceToSquared(b[d]);c=Math.max(c,f)}return this.center=a,this.radius=Math.sqrt(c),this},copy:function(a){return this.center.copy(a.center),this.radius=a.radius,this},empty:function(){return this.radius<=0},containsPoint:function(a){return a.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(a){return a.distanceTo(this.center)-this.radius},intersectsBoundingSphere:function(a){var b=this.radius+a.radius;return a.center.distanceToSquared(this.center)<=b*b},clampPoint:function(a,b){var c=this.center.distanceToSquared(a),d=b||new $b;return d.copy(a),c>this.radius*this.radius&&(d.sub(this.center).normalize(),d.multiplyScalar(this.radius).add(this.center)),d},getBoundingBox:function(a){var b=a||new Yb.Box3;return b.set(this.center,this.center),b.expandByScalar(this.radius),b},transform:function(a){return this.center.applyMatrix4(a),this.radius=this.radius*a.getMaxScaleOnAxis(),this},applyMatrix4:function(a){return this.center.applyMatrix4(a),this.radius=this.radius*a.getMaxScaleOnAxis(),this},translate:function(a){return this.center.add(a),this},equals:function(a){return a.center.equals(this.center)&&a.radius===this.radius},clone:function(){return(new Yb.BoundingSphere).copy(this)}},Yb.Primitive=function(a,b){a=a||{},this.data=a,this.vertices=a.vertices,this.faces=a.faces,this.uvs=a.uvs,this.uv2s=a.uv2s,this.uniqueCode=b},Yb.extend(Yb.Primitive,Object,{clone:function(a){if(a){var b,c={};for(c.vertices=[],b=0;b<this.vertices.length;b++)c.vertices.push(this.vertices[b].clone());for(c.faces=[],b=0;b<this.faces.length;b++)c.faces.push(this.faces[b].clone());for(c.uvs=[],b=0;b<this.uvs.length;b++){for(var d=this.uvs[b],e=[],f=0;f<d.length;f++)e.push(d[f].clone);c.uvs.push(e)}for(c.uv2s=[],b=0;b<this.uv2s.length;b++)c.uv2s.push(this.uv2s[b].clone());return new Yb.Primitive(c)}return new Yb.Primitvie(this.data)}}),Yb.PrimitiveCache={_cache:{},_useCount:{},getPrimitive:function(a){return a?Yb.PrimitiveCache._cache[a]:null},setPrimitive:function(a,b){a&&(Yb.PrimitiveCache._cache[a]=b)},usePrimitive:function(a){var b=Yb.PrimitiveCache._useCount[a]||0;b++,Yb.PrimitiveCache._useCount[a]=b},unUsePrimitive:function(a){var b=Yb.PrimitiveCache._useCount[a]||0;b--,0>=b&&delete Yb.PrimitiveCache._useCount[a]}},Yb.PrimitiveGroupCache={},Yb.Color=function(a){return a!==e&&this.set(a),this},Yb.extend(Yb.Color,Object,{r:1,g:1,b:1,getUniqueCode:function(){return""+this.r+this.g+this.b},set:function(a){switch(typeof a){case"number":this.setHex(a);break;case"string":this.setStyle(a)}},setHex:function(a){return a=Math.floor(a),this.r=(a>>16&255)/255,this.g=(a>>8&255)/255,this.b=(255&a)/255,this},setRGB:function(a,b,c){return this.r=a,this.g=b,this.b=c,this},setHSV:function(a,b,c){var d,e,f,g,h;return 0===c?this.r=this.g=this.b=0:(d=Math.floor(6*a),e=6*a-d,f=c*(1-b),g=c*(1-b*e),h=c*(1-b*(1-e)),0===d?(this.r=c,this.g=h,this.b=f):1===d?(this.r=g,this.g=c,this.b=f):2===d?(this.r=f,this.g=c,this.b=h):3===d?(this.r=f,this.g=g,this.b=c):4===d?(this.r=h,this.g=f,this.b=c):5===d&&(this.r=c,this.g=f,this.b=g)),this},setStyle:function(a){if(/^rgb\((\d+),(\d+),(\d+)\)$/i.test(a)){var b=/^rgb\((\d+),(\d+),(\d+)\)$/i.exec(a);return this.r=Math.min(255,parseInt(b[1],10))/255,this.g=Math.min(255,parseInt(b[2],10))/255,this.b=Math.min(255,parseInt(b[3],10))/255,this}if(/^rgb\((\d+)\%,(\d+)\%,(\d+)\%\)$/i.test(a)){var b=/^rgb\((\d+)\%,(\d+)\%,(\d+)\%\)$/i.exec(a);return this.r=Math.min(100,parseInt(b[1],10))/100,this.g=Math.min(100,parseInt(b[2],10))/100,this.b=Math.min(100,parseInt(b[3],10))/100,this}if(/^\#([0-9a-f]{6})$/i.test(a)){var b=/^\#([0-9a-f]{6})$/i.exec(a);return this.setHex(parseInt(b[1],16)),this}if(/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(a)){var b=/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(a);return this.setHex(parseInt(b[1]+b[1]+b[2]+b[2]+b[3]+b[3],16)),this}return/^(\w+)$/i.test(a)?(this.setHex(Yb.ColorKeywords[a]),this):void 0},copy:function(a){return this.r=a.r,this.g=a.g,this.b=a.b,this},copyGammaToLinear:function(a){return this.r=a.r*a.r,this.g=a.g*a.g,this.b=a.b*a.b,this},copyLinearToGamma:function(a){return this.r=Math.sqrt(a.r),this.g=Math.sqrt(a.g),this.b=Math.sqrt(a.b),this},convertGammaToLinear:function(){var a=this.r,b=this.g,c=this.b;return this.r=a*a,this.g=b*b,this.b=c*c,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},getHSV:function(a){var b,c,d=this.r,f=this.g,g=this.b,h=Math.max(Math.max(d,f),g),i=Math.min(Math.min(d,f),g),j=h;if(i===h)b=0,c=0;else{var k=h-i;c=k/h,b=d===h?(f-g)/k:f===h?2+(g-d)/k:4+(d-f)/k,b/=6,0>b&&(b+=1),b>1&&(b-=1)}return a===e&&(a={h:0,s:0,v:0}),a.h=b,a.s=c,a.v=j,a},add:function(a){return this.r+=a.r,this.g+=a.g,this.b+=a.b,this},addColors:function(a,b){return this.r=a.r+b.r,this.g=a.g+b.g,this.b=a.b+b.b,this},addScalar:function(a){return this.r+=a,this.g+=a,this.b+=a,this},multiply:function(a){return this.r*=a.r,this.g*=a.g,this.b*=a.b,this},multiplyScalar:function(a){return this.r*=a,this.g*=a,this.b*=a,this},lerp:function(a,b){return this.r+=(a.r-this.r)*b,this.g+=(a.g-this.g)*b,this.b+=(a.b-this.b)*b,this},clone:function(){return(new Yb.Color).setRGB(this.r,this.g,this.b)}}),Yb.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,
darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Yb.Data=function(a){Yb.PropertyChangeDispatcher.call(this),this._childList=new kc,this._childMap={},this._clientMap={},this._id=a},Yb.extend(Yb.Data,Yb.PropertyChangeDispatcher,{___accessor:["name"],constructor:Yb.Data,getId:function(){return this._id},onAlarmChange:function(){},onPropertyChange:function(a,b,c){},setGroupId:function(a){if(this._groupId!==a){var b=this._groupId;this._groupId=a,this.firePropertyChange("groupId",b,a)}},getGroupId:function(){return this._groupId},hasChildren:function(){return this._childList.size()>0},getChildren:function(){return this._childList},isDescendantOf:function(a){if(!a)return!1;if(!a.hasChildren())return!1;for(var b=this._parent;b;){if(a===b)return!0;b=b.getParent()}return!1},getParent:function(){return this._parent},getRoot:function(){var a=this._parent;return a&&null==a._parent?a:a&&null!=a._parent?a.getRoot(a):arguments[0]},setParent:function(a){if(!(this._isUpdatingParent||this._parent===a||this===a||a&&a.isDescendantOf(this))){var b=this._parent;this._parent=a,this._isUpdatingParent=!0,b&&b.removeChild(this),a&&a.addChild(this),delete this._isUpdatingParent,this.firePropertyChange("parent",b,a),this.onParentChanged(b,a)}},onParentChanged:function(a,b){},addChild:function(a,b){return b===e&&(b=this._childList.size()),a&&a!==this?this._childMap[a.getId()]?!1:this.isDescendantOf(a)?!1:(a.getParent()&&a.getParent().removeChild(a),(0>b||b>this._childList.size())&&(b=this._childList.size()),this._childList.add(a,b),this._childMap[a._id]=a,a.setParent(this),this.firePropertyChange("children",null,a),this.onChildAdded(a,b),!0):!1},onChildAdded:function(a,b){},clearChildren:function(){if(null!=this._childList&&this._childList.size()>0){var a=this._childList.toList(),b=this;a.forEach(function(a){b.removeChild(a)})}},removeChild:function(a){if(!a)return!1;if(!this._childMap[a._id])return!1;var b=this._childList.remove(a);return delete this._childMap[a._id],this.firePropertyChange("children",a,null),a.setParent(null),this.onChildRemoved(a,b),!0},onChildRemoved:function(a,b){},c:function(a){if(a)for(var b in a)this.setClient(b,a[b])},setClient:function(a,b){if(null==a)return this;null==this._clientMap&&(this._clientMap=new Object);var c=this._clientMap[a];return c===b?this:(null==b?delete this._clientMap[a]:this._clientMap[a]=b,this._clientMap[a]=b,this.firePropertyChange("C:"+a,c,b),this.onClientChanged(a,c,b),this)},getClient:function(a){return this._clientMap[a]},onClientChanged:function(a,b,c){},setPropertyValue:function(a,b){if(this[a]===b)return!1;var c=this[a];return c instanceof Yb.Color&&null!=b?(c=c.clone(),b instanceof Yb.Color?this[a].copy(b):this[a].set(b)):this[a]=b,!0}}),Yb.Element=function(a){Yb.Data.call(this,a),this._id=a||Yb.id("E"),this.styleMap={},this._visible=!0,this._selected=!1,this._selectable=!0,this._editable=!0,this.editing=!1,this.up=new $b(0,1,0),this._position=new $b(0,0,0),this._rotation=new $b(0,0,0),this._scale=new $b(1,1,1),this.eulerOrder=Yb.defaultEulerOrder,this.rotationAutoUpdate=!0,this.matrix=new ac,this.worldMatrix=new ac,this.rotationWorldMatrix=new ac,this.matrixAutoUpdate=!1,this.worldMatrixNeedsUpdate=!0,this.quaternion=new Yb.Quat,this.useQuaternion=!1,this._sizeFixed=!1,this._fixedSize=108,this.castShadow=!0,this.receiveShadow=!0,this.frustumCulled=!0,this._vector=new $b,this.renderDepth=null,this._attachId="",this._groupId=null,this.editTransformToParent=!1,this._alarmState=new Yb.AlarmState(this),this.colors=[]},Yb.Element.__m1=new ac,Yb.ElementIdCount=0,Yb.extend(Yb.Element,Yb.Data,{IStyle:!0,___accessor:["visible","selected","selectable","editable","sizeFixed"],constructor:Yb.Element,getAlarmState:function(){return this._alarmState},onAlarmChange:function(a,b){var c=this._alarmState.getHighestNativeAlarmSeverity();c?this.setStyle("m.alarmColor",new Yb.Color(c.color)):this.setStyle("m.alarmColor",null)},getDefaultInstance:function(){return this.constructor.defaultInstance===e&&(this.constructor.defaultInstance=new this.constructor),this.constructor.defaultInstance},onParentChanged:function(a,b){this.updateWorldMatrix(!0,!1)},onChildAdded:function(a,b){a.updateWorldMatrix(!0,!1)},onChildRemoved:function(a,b){a.updateWorldMatrix(!0,!1)},generatePrimitiveKey:function(){return null},serializeProperty:function(){},clear:function(a){},getSelectStyle:function(){return this.getStyle("select.style")},isSpaceChangedProperty:function(a){return"scale"===a||"position"===a||"rotation"===a},isStyleEquals:function(a,b,c){return null==b&&null==c?!0:b===c},setStyle:function(a,b){if(null==a)return this;null==this.styleMap&&(this.styleMap={});var c=this.styleMap[a];return this.isStyleEquals(a,c,b)?this:(null==b?delete this.styleMap[a]:this.styleMap[a]=b,this.onStyleChanged(a,c,b),this.firePropertyChange(Yb.Styles.PREFIX_STYLE+a,c,b),this)},c:function(a){if(a)for(var b in a)this.setClient(b,a[b])},s:function(a){if(null==a)return this;null==this.styleMap&&(this.styleMap={});var b,c,d,e={},f={};for(b in a)c=a[b],d=this.styleMap[b],this.isStyleEquals(b,d,c)||(null==c?delete this.styleMap[b]:this.styleMap[b]=c,f[b]=d,this.isMaterialStyle(b)&&(e[b]=[c,d]));this.onMaterialStylesChanged(e);for(b in a)this.firePropertyChange(Yb.Styles.PREFIX_STYLE+b,f[b],this.styleMap[b]);return this},getStyle:function(a,b,c){null==c&&(c=!0);var d;return null!=this.styleMap&&(d=this.styleMap[a]),b&&(d=this.getCloneObject(d)),null==d&&c&&(d=this.getDefaultStyle(a,b)),d},getCloneObject:function(a){if(null==a)return null;if(Yb.Utils.isArray(a)){for(var b=[],c=0;c<a.length;c++)b.push(this.getCloneObject(a[c]));return b}return a.clone?a.clone():a},getSideIndexMapping:function(){},setMaterialStyle:function(a,b){},setMaterialStyles:function(a){var b,c,d,e;for(var f in a){if(f.startsWith("m."))b=f.substr(f.indexOf(".")+1);else if(this.getSideIndexMapping()&&this.isSideStyle(d)){var g=d.substr(0,d.indexOf(".")),h=this.getSideMaterialIndex(g);if(h!=i)continue;d=d.substr(d.indexOf(".")+1),b=d.substr(f.indexOf(".")+1)}else f.startsWith("alarm.billboard.")&&(e=!0);var j=a[f];c=j[0],null==c?c=Yb.Styles.getStyle(f):sc.isArray(c)&&(c=c[i]),this._A97(this.material,b,c)}e&&this._alarmBillboard&&this._setAlarmBillboardPositionAndSize(this._alarmBillboard)},onMaterialStylesChanged:function(a){this.setMaterialStyles(a)},isMaterialStyle:function(a){return a.startsWith("m.")?!0:this.getSideIndexMapping()&&this.isSideStyle(a)?!0:!1},onStyleChanged:function(a,b,c){if(a.startsWith("m."))this.setMaterialStyle(a,c);else if(this.getSideIndexMapping()&&this.isSideStyle(a)){var d=a.substr(0,a.indexOf("."));a=a.substr(a.indexOf(".")+1);var e=this.getSideMaterialIndex(d);this.setMaterialStyle(a,c,e)}else a.startsWith("alarm.billboard.")&&this._alarmBillboard&&this._setAlarmBillboardPositionAndSize(this._alarmBillboard)},textureMapping:{texture:"map",texture1:"map1",texture2:"map2",textureb:"blendMap",texturebp:"bumpMap",lightMap:"lightMap",lightmap:"lightMap",normalmap:"normalMap",envmap:"envMap",specularmap:"specularMap"},_A97:function(a,b,c){if(b.startsWith("texture.")||b.startsWith("texture1.")||b.startsWith("texture2.")||b.startsWith("textureb.")||b.startsWith("texturen.")||b.startsWith("texturebp.")||b.startsWith("lightmap")||b.startsWith("envmap")||b.startsWith("normalmap")||b.startsWith("specularmap")){var d=b.substr(0,b.indexOf(".")),e=b.substr(b.indexOf(".")+1);if("offset"===e||"repeat"===e)return void a.setPropertyValue(e,this.getCloneObject(c));var f=this.textureMapping[d],g=a[f],h=Yb.TexturePool.TestTexture;if("image"===e){var i=c;if(b.startsWith("envmap")&&sc.isArray(i))for(var j=0;j<i.length;j++)if(null==i[j]){i=null;break}if(null==g&&null!=i){h.resetValue(),h._image=i,h.setImageSrc(i);var k=h.getUniqueCode(),l=Yb.TexturePool.getTexture(k);null==l&&(l=new Yb.Texture(i),Yb.TexturePool.setTexture(k,l)),a.setMap(l,f)}else if(null==i)a.setMap(null,f);else{g.clone(h,!1),h._image=i,h.setImageSrc(i);var k=h.getUniqueCode(),l=Yb.TexturePool.getTexture(k);l===g||(null==l&&(l=new Yb.Texture,g.clone(l,!1),l.setImage(i),Yb.TexturePool.setTexture(k,l)),a.setMap(l,f))}}else if(null!=g){g.clone(h,!1),h[e]=this.getCloneObject(c);var k=h.getUniqueCode(),l=Yb.TexturePool.getTexture(k);l!=g&&(null==l&&(l=new Yb.Texture,g.clone(l),l[e]=c),a.setMap(l,f))}}else"type"===b&&a.setType?a.setType(c):a.setPropertyValue(b,this.getCloneObject(c))},getDefaultStyle:function(a,b){if(null==a)return null;if(a.startsWith("m.")){var c=[],d=a.substr(a.indexOf(".")+1);if(this.material.materials){var e=this.material.materials;e=e||[this.material];for(var f=0;f<e.length;f++){var g=e[f];if(d.startsWith("texture.")||d.startsWith("texture1.")||d.startsWith("texture2.")||d.startsWith("textureb.")||d.startsWith("texturen.")||d.startsWith("texturebp.")||d.startsWith("lightmap")||d.startsWith("envmap")||d.startsWith("normalmap")||d.startsWith("specularmap")){var h=d.substr(0,d.indexOf(".")),i=d.substr(d.indexOf(".")+1),j=(d.substr(d.indexOf(".")+1),this.textureMapping[h]),k=g[j];if(k)if("image"===i)if(sc.isArray(k._image)){var l=[];c.push(l);for(var m=0;m<k._image.length;m++)l.push(k._image[m].src)}else c.push(k._image.src);else"offset"===i||"repeat"===i?c.push(g[i]):c.push(g.map[i]);else c.push(Yb.Styles.getStyle(a))}else c.push(g[d])}}b&&(c=this.getCloneObject(c));for(var n=!0,f=0;f<c.length;f++)if(0!=c.indexOf(c[f])){n=!1;break}return n?c[0]:c}if(this.isSideStyle(a)){var o=a.substr(0,a.indexOf("."));a=a.substr(a.indexOf(".")+1);var d=a.substr(a.indexOf(".")+1),p=this.getSideMaterialIndex(o);if(null!=p){var q,g=this.material.materials[p];return d.startsWith("texture.")?g.map&&(q="texture.image"===d?g.map._image.src:g.map[d]):q=g[d],b&&(q=this.getCloneObject(q)),q}}return Yb.Styles.getStyle(a)},isSideStyle:function(a){if(-1===a.indexOf("."))return!1;var b=this.getSideIndexMapping();if(!b)return!1;var c=a.substr(0,a.indexOf("."));return b[c]!==e?!0:!1},setUp:function(a,b,c){var d;if(3===arguments.length){if(this.up.x===a&&this.up.y===b&&this.up.z===c)return;d=new $b(a,b,c)}else{if(this.up.x===a.x&&this.up.y===a.y&&this.up.z===a.z)return;d=a}var e=this.up;this.up=d,this.onUpChanged(e,newValue),this.firePropertyChange("up",e,d)},getUp:function(){return this.up},onUpChanged:function(a,b){},checkNumber:function(a,b,c,d){sc.isNaN(a)&&console.error(d+",x is not a number"),sc.isNaN(b)&&console.error(d+",y is not a number"),sc.isNaN(c)&&console.error(d+",z is not a number")},invalidateTexture:function(a){var b,c,d,e=this.material;if(null!=a&&e instanceof Yb.ArrayMaterial){if("string"==typeof a){var f=this.getSideIndexMapping();if(null!=f&&(a=f[a]),null==a)return}if("number"!=typeof a)return;d=e instanceof Yb.ArrayMaterial?e.materials[a]:materail,this._dirtyMaterialTexture(d)}else if(e instanceof Yb.ArrayMaterial)for(c=e.materials,b=0;b<c.length;b++)d=c[b],this._dirtyMaterialTexture(d);else this._dirtyMaterialTexture(e)},_dirtyMaterialTexture:function(a){null!=a&&a.map&&a.map instanceof Yb.Texture&&this._dirtyTexture(a.map)},_dirtyTexture:function(a){var b=a._image;a.firePropertyChange("image",null,b)},p:function(a,b,c){return 0===arguments.length?this.getPosition():void(3===arguments.length?this.setPosition(a,b,c):this.setPosition(a))},checkPosition:function(a){return!0},setPosition:function(a,b,c){var d;if(3===arguments.length){if(this._position.x===a&&this._position.y===b&&this._position.z===c)return;this.checkNumber(a,b,c,"setPosition"),d=new $b(a,b,c)}else{if(this._position.x===a.x&&this._position.y===a.y&&this._position.z===a.z)return;if(!(a instanceof $b))throw"Element.setPosition : position is not instanceof TGL.Vec3";d=a}if(this.checkPosition(d)){var e=this._position;this._position=d,this.updateWorldMatrix(!0,!1),this.firePropertyChange("position",e,d)}},getPosition:function(a){return a==e&&(a=!0),a?this._position.clone():this._position},setPositionX:function(a){if(this._position.x!==a){this.checkNumber(a,0,0,"setPositionX");var b=this._position.x,c=this._position.clone();if(c.x=a,!this.checkPosition(c))return!1;this._position.x=a,this.updateWorldMatrix(!0,!1),this.firePropertyChange("positionX",b,a)}},setX:function(a){this.setPositionX(a)},getPositionX:function(){return this._position.x},getX:function(){return this.getPositionX()},setPositionY:function(a){if(this._position.y!==a){this.checkNumber(0,a,0,"setPositionY");var b=this._position.y,c=this._position.clone();if(c.y=a,!this.checkPosition(c))return!1;this._position.y=a,this.updateWorldMatrix(!0,!1),this.firePropertyChange("positionY",b,a)}},setY:function(a){this.setPositionY(a)},getPositionY:function(){return this._position.y},getY:function(){return this.getPositionY()},setPositionZ:function(a){if(this._position.z!==a){this.checkNumber(0,0,a,"setPositionZ");var b=this._position.z,c=this._position.clone();if(c.z=a,!this.checkPosition(c))return!1;this._position.z=a,this.updateWorldMatrix(!0,!1),this.firePropertyChange("positionZ",b,a)}},setZ:function(a){this.setPositionZ(a)},getPositionZ:function(){return this._position.z},getZ:function(){return this.getPositionZ()},setScale:function(a,b,c){var d;if(3===arguments.length){if(this._scale.x===a&&this._scale.y===b&&this._scale.z===c)return;this.checkNumber(a,b,c,"setScale"),d=new $b(a,b,c)}else{if(this._scale.x===a.x&&this._scale.y===a.y&&this._scale.z===a.z)return;if(!(a instanceof $b))throw"Element.setScale : scale is not instanceof TGL.Vec3";d=a}var e=this._scale;d.x=d.x||1,d.y=d.y||1,d.z=d.z||1,this._scale=d,this.updateWorldMatrix(!0,!1),this.firePropertyChange("scale",e,d)},getScale:function(a){return a==e&&(a=!0),a?this._scale.clone():this._scale},setScaleX:function(a){if(this._scale.x!==a){this.checkNumber(a,0,0,"setScalX");var b=this._scale.x;this._scale.x=a,this.updateWorldMatrix(!0,!1),this.firePropertyChange("scaleX",b,a)}},getScaleX:function(){return this._scale.x},setScaleY:function(a){if(this._scale.y!==a){this.checkNumber(0,a,0,"setScaleY");var b=this._scale.y;this._scale.y=a,this.updateWorldMatrix(!0,!1),this.firePropertyChange("scaleY",b,a)}},getScaleY:function(){return this._scale.y},setScaleZ:function(a){if(this._scale.z!==a){this.checkNumber(0,0,a,"setScaleZ");var b=this._scale.z;this._scale.z=a,this.updateWorldMatrix(!0,!1),this.firePropertyChange("scaleZ",b,a)}},getScaleZ:function(){return this._scale.z},setRotation:function(a,b,c){var d;if(3===arguments.length){if(this._rotation.x===a&&this._rotation.y===b&&this._rotation.z===c)return;this.checkNumber(a,b,c,"setRotation"),d=new $b(a,b,c)}else{if(this._rotation.x===a.x&&this._rotation.y===a.y&&this._rotation.z===a.z)return;if(!(a instanceof $b))throw"Element.setRotation : rotation is not instanceof TGL.Vec3";d=a}var e=this._rotation;this._rotation=d,this.updateWorldMatrix(!0,!1),this.firePropertyChange("rotation",e,d)},getRotation:function(a){return a==e&&(a=!0),a?this._rotation.clone():this._rotation},setRotationX:function(a){if(this._rotation.x!==a){this.checkNumber(a,0,0,"setRotationX");var b=this._rotation.x;this._rotation.x=a,this.updateWorldMatrix(!0,!1),this.firePropertyChange("rotationX",b,a)}},getRotationX:function(){return this._rotation.x},setRotationY:function(a){if(this._rotation.y!==a){this.checkNumber(0,a,0,"setRotationY");var b=this._rotation.y;this._rotation.y=a,this.updateWorldMatrix(!0,!1),this.firePropertyChange("rotationY",b,a)}},getRotationY:function(){return this._rotation.y},setRotationZ:function(a){if(this._rotation.z!==a){this.checkNumber(0,0,a,"setRotationZ");var b=this._rotation.z;this._rotation.z=a,this.updateWorldMatrix(!0,!1),this.firePropertyChange("rotationZ",b,a)}},getRotationZ:function(){return this._rotation.z},applyMatrix:function(a){var b=this.matrix.clone();this.matrix.multiplyMatrices(a,this.matrix),this._scale.getScaleFromMatrix(this.matrix);var c=(new ac).extractRotation(this.matrix);this._rotation.setEulerFromRotationMatrix(c,this.eulerOrder),this._position.getPositionFromMatrix(this.matrix),this.updateWorldMatrix(!0,!1),this.firePropertyChange("matrix",b,this.matrix)},translate:function(a,b){this.matrix.rotateAxis(b),this.setPosition(this._position.clone().add(b.multiplyScalar(a)))},translateX:function(a){this.translate(a,this._vector.set(1,0,0))},translateY:function(a){this.translate(a,this._vector.set(0,1,0))},translateZ:function(a){this.translate(a,this._vector.set(0,0,1))},rotateFromAxis:function(a,b,c){b=b.clone().applyMatrix4(this.matrix),a=a.clone().normalize().applyMatrix4((new ac).extractRotation(this.matrix));var d=(new ac).makeRotationAxisAndCenter(a,c,b);this.applyMatrix(d)},rotateFromWorldAxis:function(a,b){var c=new ac;c.makeRotationAxis(a.normalize(),b),c.multiply(this.matrix),this.matrix=c;var d=(new ac).extractRotation(this.matrix),e=new $b;e.setEulerFromRotationMatrix(d,this.eulerOrder),this.setRotation(e)},getEulerAngles:function(){return this.matrix.getEulerAngles()},rotateFromWorldXAxis:function(a){this.rotateFromWorldAxis(new $b(1,0,0),a)},rotateFromWorldYAxis:function(a){this.rotateFromWorldAxis(new $b(0,1,0),a)},rotateFromWorldZAxis:function(a){this.rotateFromWorldAxis(new $b(0,0,1),a)},getRelativeTransform:function(a){if(a instanceof Yb.Element){var b=(new ac).getInverse(a.matrix.clone()),c=(new ac).multiplyMatrices(b,this.matrix.clone()),d=(new $b).getPositionFromMatrix(c),e=(new $b).setEulerFromRotationMatrix(c),f=(new $b).getScaleFromMatrix(c),g={position:d,rotation:e,scale:f,matrix:c};return g}return null},localToWorld:function(a){return null==this._parent?a:a.clone().applyMatrix4(this._parent.worldMatrix)},localToWorld2:function(a){return a.clone().applyMatrix4(this.worldMatrix)},getWorldPosition:function(){return this.worldMatrix.getPosition()},direction:function(a){var b=a.applyMatrix4((new ac).extractRotation(this.worldMatrix));return b.normalize(),b},frontDirection:function(){var a=new $b(0,0,1);return a=a.applyMatrix4((new ac).extractRotation(this.worldMatrix)),a.normalize(),a},worldPosition:function(a,b){b=b>0?b:a.length();var c=this.worldMatrix.getPosition();return c.add(this.direction(a).multiplyScalar(b))},frontWorldPosition:function(a){a=a>0?a:1;var b=this.worldMatrix.getPosition();return b.add(this.frontDirection().multiplyScalar(a))},worldToLocal:function(a){return a.clone().applyMatrix4(Yb.Element.__m1.getInverse(this.worldMatrix))},lookAt:function(a,b){this.matrix.lookAt(a,this._position,b?b:this.up),this.rotationAutoUpdate&&(this.useQuaternion===!1?this._rotation.setEulerFromRotationMatrix(this.matrix,this.eulerOrder):this.quaternion.copy(this.matrix.decompose()[1])),this.worldMatrixNeedsUpdate=!0},iterator:function(a){a(this),this._childList&&this._childList.forEach(function(b){b.iterator(a)})},getChildByName:function(a,b){for(var c=0,d=this.children.length;d>c;c++){var f=this.children[c];if(f.name===a)return f;if(b===!0&&(f=f.getChildByName(a,b),f!==e))return f}return e},getDescendants:function(a){a===e&&(a=[]);var b=this.getChildren().toArray();Array.prototype.push.apply(a,b);for(var c=0,d=b.length;d>c;c++)b[c].getDescendants(a);return a},fixSize:function(a){if(this._sizeFixed){this.updateWorldMatrix();var b=new $b,c=new $b;b.getPositionFromMatrix(this.worldMatrix),a.updateWorldMatrix(),c.getPositionFromMatrix(a.worldMatrix),scale=b.distanceTo(c)/this._fixedSize,0===scale&&(scale=1e-5),this.setScale(scale,scale,scale)}},updateMatrix:function(){this.matrix.setPosition(this._position),this.useQuaternion===!1?this.matrix.setRotationFromEuler(this._rotation,this.eulerOrder):this.matrix.setRotationFromQuaternion(this.quaternion),(1!==this._scale.x||1!==this._scale.y||1!==this._scale.z)&&this.matrix.scale(this._scale),this.worldMatrixNeedsUpdate=!0},updateWorldMatrix:function(a,b){if(b=b==e?!0:b,this.matrixAutoUpdate===!0&&this.updateMatrix(),this.worldMatrixNeedsUpdate===!0||a===!0){this.matrixAutoUpdate===!1&&this.updateMatrix();var c=this.worldMatrix.clone();this._parent==e?this.worldMatrix.copy(this.matrix):this.worldMatrix.multiplyMatrices(this._parent.worldMatrix,this.matrix),this.worldMatrixNeedsUpdate=!1,a=!0,c.equals(this.worldMatrix)||(b&&this.firePropertyChange("worldMatrix",c,this.worldMatrix),this.updateCameraMatrix&&this.updateCameraMatrix(!1))}this._childList.forEach(function(b){b.updateWorldMatrix(a)})},cloneCallback:function(a){},clonePrefab:function(a){var b=new mono.Entity;a===e&&(a=!0),b.name=this.name,null==b.up&&(b.up=new $b(0,1,0)),b.up.copy(this.up),b._position.copy(this._position),b._rotation.copy(this._rotation),b.eulerOrder=this.eulerOrder,b._scale.copy(this._scale),b.renderDepth=this.renderDepth,b.rotationAutoUpdate=this.rotationAutoUpdate,b.matrix.copy(this.matrix),b.worldMatrix.copy(this.worldMatrix),b.rotationWorldMatrix.copy(this.rotationWorldMatrix),b.matrixAutoUpdate=this.matrixAutoUpdate,b.worldMatrixNeedsUpdate=this.worldMatrixNeedsUpdate,b.quaternion.copy(this.quaternion),b.useQuaternion=this.useQuaternion,b._visible=this._visible,b.castShadow=this.castShadow,b.receiveShadow=this.receiveShadow,b.frustumCulled=this.frustumCulled,b.styleMap=b.styleMap||{},a&&this._childList&&this._childList.forEach(function(c){b.addChild(c.clonePrefab(a))}),b.vertices=this.vertices,b.faces=this.faces,b.uvs=this.uvs,b.uv2s=this.uv2s,this.primitive&&(b.primitive=this.primitive,b.data=this.primitive.data,b.computed=!0);for(var c in this.styleMap)b.styleMap[c]=this.getCloneObject(this.styleMap[c]);if(null!=this._clientMap)for(var d in this._clientMap)b.setClient(d,this._clientMap[d]);if(b.material=this.material,this.material instanceof Yb.ArrayMaterial){b.material=new Yb.ArrayMaterial,b.material.materials=[];for(var f=0;f<this.material.materials.length;f++)b.material.materials.push(this.material.materials[f])}return b.materialSize=this.getMaterialSize?this.getMaterialSize():1,b},createCloneObject:function(){return this.constructor?object=new this.constructor:object=new Yb.Element,object},clone:function(a,b,c){if("boolean"==typeof a&&(c=b,b=a,a=e),a==e&&(a=this.createCloneObject()),c===e&&(c=!0),a.name=this.name,null==a.up&&(a.up=new $b(0,1,0)),a.up.copy(this.up),a._position.copy(this._position),a._rotation.copy(this._rotation),a.eulerOrder=this.eulerOrder,a._scale.copy(this._scale),a.renderDepth=this.renderDepth,a.rotationAutoUpdate=this.rotationAutoUpdate,a.matrix.copy(this.matrix),a.worldMatrix.copy(this.worldMatrix),a.rotationWorldMatrix.copy(this.rotationWorldMatrix),a.matrixAutoUpdate=this.matrixAutoUpdate,a.worldMatrixNeedsUpdate=this.worldMatrixNeedsUpdate,a.quaternion.copy(this.quaternion),a.useQuaternion=this.useQuaternion,a._visible=this._visible,a.castShadow=this.castShadow,a.receiveShadow=this.receiveShadow,a.frustumCulled=this.frustumCulled,a.styleMap=a.styleMap||{},c&&this._childList&&this._childList.forEach(function(d){a.addChild(d.clone(b,c))}),this.constructor){var d=this.constructor.prototype.__accessor,f=this.constructor.prototype.__bool;if(d&&d.length>0)for(var g=0;g<d.length;g++){var h=d[g],i=Yb.getter(h,f),j=Yb.setter(h);"vertices"===h?a.vertices=this.vertices:"faces"===h?a.faces=this.faces:a[j]&&a[j](this[i]())}}if(b&&this.vertices){var k=a,l=this.vertices;k.vertices=[],k.faces=[],k.uvs=[];for(var g=0,m=l.length;m>g;g++)k.vertices.push(l[g].clone());for(var n=this.faces,g=0,m=n.length;m>g;g++)k.faces.push(n[g].clone());for(var o=this.uvs,g=0,m=o.length;m>g;g++){for(var p=o[g],q=[],r=0,s=p.length;s>r;r++)q.push(new Yb.Vec2(p[r].x,p[r].y));k.uvs.push(q)}}for(var t in this.styleMap)a.setStyle(t,this.getCloneObject(this.styleMap[t]));if(null!=this._clientMap)for(var u in this._clientMap)a.setClient(u,this._clientMap[u]);return a.cloneCallback(b),a}}),Yb.Annotation=function(a,b,c){Yb.Element.call(this,c),this._label=a,this._text=b,this._cameraPosition=null},Yb.extend(Yb.Annotation,Yb.Element,{___accessor:["label","text","cameraPosition"]}),Yb.Node=function(a){Yb.Element.call(this,a),this.name="",this.computed=!1,this.selectionData=null,this.stylesMap=new Object,this.renderGroup=[],this.primitive=null,this.vertices=[],this.faces=[],this.uvs=[],this.uv2s=[],this.colors=[],this.normals=[],this.faces=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.dynamic=!0,this.verticesNeedUpdate=!1,this.elementsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.buffersNeedUpdate=!1,this.computeNodeData(),this._alarmBillboard=null},Yb.extend(Yb.Node,Yb.Element,{__accessor:["vertices","faces","uvs","linkAgent"],__SizePropeties:[],setUpdateFlags:function(a){this.verticesNeedUpdate=a,this.elementsNeedUpdate=a,this.uvsNeedUpdate=a,this.normalsNeedUpdate=a,this.colorsNeedUpdate=a},getLinks:function(){return this._links},getFromLinks:function(){return this._fromLinks},getToLinks:function(){return this._toLinks},_addFromLink:function(a){this._allLinks||(this._allLinks=new kc),this._fromLinks||(this._fromLinks=new kc),this._allLinks.add(a),this._fromLinks.add(a),this._resetLinkSet()},_addToLink:function(a){this._allLinks||(this._allLinks=new kc),this._toLinks||(this._toLinks=new kc),this._allLinks.add(a),this._toLinks.add(a),this._resetLinkSet()},_removeFromLink:function(a){this._allLinks.remove(a),this._fromLinks.remove(a),0===this._allLinks.size()&&delete this._allLinks,0===this._fromLinks.size()&&delete this._fromLinks,this._resetLinkSet()},_removeToLink:function(a){this._allLinks.remove(a),this._toLinks.remove(a),0===this._allLinks.size()&&delete this._allLinks,0===this._toLinks.size()&&delete this._toLinks,this._resetLinkSet()},_resetLinkSet:function(){if(delete this._loopedLinks,!this._allLinks||0===this._allLinks.size())return void delete this._links;var a;this._allLinks.forEach(function(b){b.isLooped()&&(a||(a={}),a[b._id]||(this._loopedLinks||(this._loopedLinks=new kc),this._loopedLinks.add(b),a[b._id]=b))},this),a?(this._links=new kc,this._allLinks.forEach(function(b){a[b._id]?a[b._id]!==!1&&(a[b._id]=!1,this._links.add(b)):this._links.add(b)},this)):this._links=this._allLinks},onAlarmChange:function(a,b){Yb.Element.prototype.onAlarmChange.call(this,a,b);var c=this;setTimeout(function(){var a=c._alarmState.getPropagateSeverity();a||(a=c._alarmState.getHighestNativeAlarmSeverity());var b=c._parent,d=!1;if(null!=b&&b._alarmState){var e=b._alarmState.getPropagateSeverity();e||(d=!0)}else d=!0;a&&d?(null==c._alarmBillboard&&c.setAlarmBillboard(new Yb.Billboard),c._alarmBillboard.setStyle("m.texture.image",Yb.ImageCache.AlarmBillboardImage),c._alarmBillboard.setStyle("m.color",a.color),c._alarmBillboard.setStyle("m.alignment",Yb.BillboardAlignment.bottomCenter)):c.setAlarmBillboard(null)},10)},_setAlarmBillboardPositionAndSize:function(a){var b=this.getStyle("alarm.billboard.position"),c=this.getBoundingBox(),d=c.min,e=c.max,f=c.center(),g=c.size();"topLeft"===b?a._position.set(d.x,e.y,f.z+1):"topRight"===b?a._position.set(e.x,e.y,f.z+1):"topBack"===b?a._position.set(f.x,e.y,d.z-1):"topFront"===b?a._position.set(f.x,e.y,e.z+1):a._position.set(f.x,e.y,f.z+1);var h=this.getStyle("alarm.billboard.scale");h instanceof $b?a._scale.copy(h):a._scale.set(g.x/2,g.x/2,1);var i=this.getStyle("alarm.billboard.vertical");a.setStyle("m.vertical",i)},getLinkOffset:function(a){return new mono.Vec3(0,0,0)},getLinkExtend:function(a){return new mono.Vec3(0,0,0)},clearLinkOrthogonal:function(a,b){return!1},clearLinkExtend:function(a,b){return!1},setAlarmBillboard:function(a){if(this._alarmBillboard!=a){var b=this._alarmBillboard;a?(this._alarmBillboard=a,a.setParent(this),a.setClient("alarmBillboard",!0),this._setAlarmBillboardPositionAndSize(a)):(this._alarmBillboard.setParent(null),delete this._alarmBillboard),this.firePropertyChange("alarmBillboard",b,a)}},needUpdate:function(){return this.verticesNeedUpdate||this.elementsNeedUpdate||this.uvsNeedUpdate||this.normalsNeedUpdate||this.colorsNeedUpdate},getVerticesWithChildren:function(a,b){function c(c){c.applyMatrix4(a),b.push(c)}null==b&&(b=[]),null==a&&(a=new ac);var d;if(this instanceof Yb.Node){if(null!=this.vertices&&0!=this.vertices.length){var e=this.getBoundingBox(),f=e.min,g=e.max;c(f.clone()),c(g.clone()),c(new $b(f.x,f.y,g.z)),c(new $b(f.x,g.y,f.z)),c(new $b(g.x,f.y,f.z)),c(new $b(g.x,g.y,f.z)),c(new $b(g.x,f.y,g.z)),c(new $b(f.x,g.y,g.z))}for(var d=0;d<(this._childList?this._childList.size():0);d++){var h=this._childList.get(d),i=new ac;i.multiplyMatrices(a,h.matrix.clone()),h.getVerticesWithChildren&&h.getVerticesWithChildren(i,b)}}return b},getBoundingBoxWithChildren:function(a){var b=this.getVerticesWithChildren();if(a)for(var c=0;c<a.length;c++){var d=a[c];if(d.getParent()===this.getParent()&&d!==this){var e=(new ac).getInverse(this.matrix.clone()),f=(new ac).multiplyMatrices(e,d.matrix.clone());b=b.concat(d.getVerticesWithChildren(f))}}var g=new Yb.BoundingBox;return g.setFromPoints(b),g},getWorldBoundingBox:function(){for(var a=[],b=0;b<this.vertices.length;b++){var c=this.vertices[b].clone();c.applyMatrix4(this.worldMatrix),a.push(c)}var d=new Yb.BoundingBox;return d.setFromPoints(a),d},getBoundingBox:function(){return null==this.boundingBox&&this.computeBoundingBox(),this.boundingBox},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Yb.BoundingBox),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Yb.BoundingSphere),this.boundingSphere.setFromCenterAndPoints(this.boundingSphere.center,this.vertices)},createPropagateAlarmCube:function(a){if(null==this.boundingBox&&this.computeBoundingBox(),a._attachId=this._id,null==this.propagateAlarmData){var b=this.getStyle("outer.offset"),c=this.boundingBox.min,d=this.boundingBox.max;a.width=d.x-c.x+b,a.height=d.y-c.y+b,a.depth=d.z-c.z+b,a.computed=!1,a.computeNodeData(),this.propagateAlarmData=a.data,hc(a,!0),this.propagateAlarmData.primitive=a.primitive,this.propagateAlarmData.groups=a.groups;for(var e=(new $b).center(c,d),f=0;f<a.vertices.length;f++){var g=a.vertices[f];g.add(e)}this.propagateAlarmData.vertices=a.vertices}else{var h=this.propagateAlarmData;a.primitive=h.primitive,a.data=h,a.vertices=h.vertices,a.uvs=h.uvs,a.faces=h.faces,
a.groups=h.groups}this.updateMatrix(!0),a._position.copy(this._position),a._scale.copy(this._scale),a._rotation.copy(this._rotation),a.useQuaternion=this.useQuaternion,a.quaternion=this.quaternion,a.worldMatrix=this.worldMatrix,a._parent=this.getParent(),a.updateMatrix(!0);var i=a.material;i.wireframeLinewidth=this.getStyle("outer.width");var j=this.getAlarmState().getPropagateSeverity();return i.color.set(j.color),a},createCanvasSelectionCube:function(){return null==this._csc&&(this._csc=new qc,this._csc.material=new Yb.EntityMaterial,this._csc.material.wireframe=!0),this.createSelectionCube(this._csc),this._csc},createSelectionCube:function(a){if(null==this.boundingBox&&this.computeBoundingBox(),a._attachId=this._id+"_selection",null==this.selectionData){var b=this.getStyle("select.offset"),c=this.boundingBox.min,d=this.boundingBox.max,e=(new $b).center(c,d);a.width=d.x-c.x+b,a.height=d.y-c.y+b,a.depth=d.z-c.z+b,a.offset=e,a.computed=!1;a.computeNodeData();this.selectionData=a.data,hc(a,!0),this.selectionData.primitive=a.primitive,this.selectionData.groups=a.groups,this.selectionData.vertices=a.vertices}else{var f=this.selectionData;a.primitive=f.primitive,a.data=f,a.vertices=f.vertices,a.uvs=f.uvs,a.faces=f.faces,a.groups=f.groups}this.updateMatrix(!0),a._position.copy(this._position),a._scale.copy(this._scale),a._rotation.copy(this._rotation),a.useQuaternion=this.useQuaternion,a.quaternion=this.quaternion,a.worldMatrix=this.worldMatrix,a._parent=this.getParent(),a.updateMatrix(!0);var g=a.material;return g.wireframeLinewidth=this.getStyle("select.width"),g.color.set(this.getStyle("select.color")),a},mergeVertices:function(){var a,b,c,d,f,g,h,i={},j=[],k=[],l=4,m=Math.pow(10,l);for(this.__tmpVertices=e,null==this.vertices&&console.log("vertices is null"),c=0,d=this.vertices.length;d>c;c++)a=this.vertices[c],b=[Math.round(a.x*m),Math.round(a.y*m),Math.round(a.z*m)].join("_"),i[b]===e?(i[b]=c,j.push(this.vertices[c]),k[c]=j.length-1):k[c]=k[i[b]];var n=[];for(c=0,d=this.faces.length;d>c;c++)if(f=this.faces[c],f instanceof oc){f.a=k[f.a],f.b=k[f.b],f.c=k[f.c],g=[f.a,f.b,f.c];for(var o=-1,p=0;3>p;p++)if(g[p]==g[(p+1)%3]){o=p,n.push(c);break}}else if(f instanceof pc){f.a=k[f.a],f.b=k[f.b],f.c=k[f.c],f.d=k[f.d],g=[f.a,f.b,f.c,f.d];for(var o=-1,p=0;4>p;p++)g[p]==g[(p+1)%4]&&(o>=0&&n.push(c),o=p);if(o>=0){g.splice(o,1);var q=new oc(g[0],g[1],g[2],f.normal,f.color,f.materialIndex);h=this.uvs[c],h&&h.splice(o,1),f.vertexNormals&&f.vertexNormals.length>0&&(q.vertexNormals=f.vertexNormals,q.vertexNormals.splice(o,1)),f.vertexColors&&f.vertexColors.length>0&&(q.vertexColors=f.vertexColors,q.vertexColors.splice(o,1)),this.faces[c]=q}}for(c=n.length-1;c>=0;c--);var r=this.vertices.length-j.length;return this.vertices=j,r},computeVertexNormals:function(a){var b,c,d,f,g,h;if(this.__tmpVertices===e){for(this.__tmpVertices=new Array(this.vertices.length),h=this.__tmpVertices,b=0,c=this.vertices.length;c>b;b++)h[b]=new Yb.Vec3;for(d=0,f=this.faces.length;f>d;d++)g=this.faces[d],g.vertexNormals=[new Yb.Vec3,new Yb.Vec3,new Yb.Vec3]}else for(h=this.__tmpVertices,b=0,c=this.vertices.length;c>b;b++)h[b].set(0,0,0);if(a){var i,j,k,l=new Yb.Vec3,m=new Yb.Vec3;new Yb.Vec3,new Yb.Vec3,new Yb.Vec3;for(d=0,f=this.faces.length;f>d;d++)g=this.faces[d],i=this.vertices[g.a],j=this.vertices[g.b],k=this.vertices[g.c],l.subVectors(k,j),m.subVectors(i,j),l.cross(m),h[g.a].add(l),h[g.b].add(l),h[g.c].add(l),g.d!=e&&h[g.d].add(l)}else for(d=0,f=this.faces.length;f>d;d++)g=this.faces[d],h[g.a].add(g.normal),h[g.b].add(g.normal),h[g.c].add(g.normal);for(b=0,c=this.vertices.length;c>b;b++)h[b].normalize();for(d=0,f=this.faces.length;f>d;d++)g=this.faces[d],g.vertexNormals[0].copy(h[g.a]),g.vertexNormals[1].copy(h[g.b]),g.vertexNormals[2].copy(h[g.c]),g.d!=e&&(g.vertexNormals[3]=h[g.d].clone())},computeCentroids:function(){var a,b,c;for(a=0,b=this.faces.length;b>a;a++)c=this.faces[a],c.centroid=c.centroid||new $b,null==c.centroid&&console.log("fdasfdsa"),c.centroid.set||(c.centroid=new $b),c.centroid.set(0,0,0),c instanceof oc?(c.centroid.add(this.vertices[c.a]),c.centroid.add(this.vertices[c.b]),c.centroid.add(this.vertices[c.c]),c.centroid.divideScalar(3)):c instanceof pc&&(c.centroid.add(this.vertices[c.a]),c.centroid.add(this.vertices[c.b]),c.centroid.add(this.vertices[c.c]),c.centroid.add(this.vertices[c.d]),c.centroid.divideScalar(4))},computeFaceNormals:function(){var a,b,c,d,e,f,g=new $b,h=new $b;for(a=0,b=this.faces.length;b>a;a++)c=this.faces[a],d=this.vertices[c.a],e=this.vertices[c.b],f=this.vertices[c.c],g.subVectors(f,e),h.subVectors(d,e),g.cross(h),g.normalize(),c.normal.copy||(c.normal=new $b),c.normal.copy(g)},computeVertex:function(){},computePrimitive:function(){},generalteGroup:function(){},getMatetial:function(){return this.material},computeNodeMaterial:function(a){},cacheNodeMaterial:function(a){},needComputeVertexNormal:function(){return!0},computeNodeData:function(a){if(this.computed===!1){var b=this.generatePrimitiveKey();this._attachId&&(b+="_"+this._attachId);var c=Yb.PrimitiveCache.getPrimitive(b),d=!1;if(c)this.primitive&&Yb.PrimitiveCache.unUsePrimitive(c),this.computeNodeMaterial(c);else{var e=this.computeData();if(this.needComputeVertexNormal()&&(Yb.Node.prototype.mergeVertices.call(e),Yb.Node.prototype.computeFaceNormals.call(e),Yb.Node.prototype.computeVertexNormals.call(e,!0)),(null==e.uv2s||0==e.uv2s.length)&&(e.uv2s=[],null!=e.uvs&&e.uvs.length>0))for(var f=0;f<e.uvs.length;f++){for(var g=[],h=e.uvs[f],i=0;i<h.length;i++)g.push(h[i].clone());e.uv2s.push(g)}c=new Yb.Primitive(e,b),Yb.PrimitiveCache.setPrimitive(b,c),this.cacheNodeMaterial(c),d=!0}return Yb.PrimitiveCache.usePrimitive(c),this.primitive=c,this.data=c.data,this.vertices=c.vertices,this.faces=c.faces,this.uvs=c.uvs,this.uv2s=c.uv2s,this.computed=!0,d}},computeData:function(){var a={vertices:[],faces:[],uv2s:[],uvs:[]};return this.vertices=a.vertices,this.uvs=a.uvs,this.faces=a.faces,this.data=a,a},setMaterial:function(a,b,c){var d=b.getUniqueCode?b.getUniqueCode():null,e=Zc.getMaterial(d);e?(this.material.materials[a]=e,Zc.useMaterial(e)):(this.material.materials[a]=b,Zc.setMaterial(d,b),Zc.useMaterial(b)),Zc.unUseMaterial(c)},onMaterialMapping:function(){this.groups=e},getMaterialSize:function(){return this.materialSize||1},startBatch:function(){this.batch=!0},endBatch:function(){this.materialMappingChanges!==e&&(this.onSizeChanged(),this.onMaterialMapping(),this.firePropertyChange("materialMapping",this.materialMappingChanges[0],this.materialMappingChanges[1]),this.materialMappingChanges=e),this.batch=!1},compareAndSetMaterial:function(a,b,c){this.setMaterial(c,b,a)},cloneStyle:function(a){if(this.getClassName()!=a.getClassName())return void console.warn("ApplyStyle fail, the source with not the same class");for(var b=this.getMaterialMapping(),c=0;c<this.getMaterialSize();c++){var d=this.material.materials[c],e=a.material.materials[c];this.compareAndSetMaterial(d,e,c)}var f=this.getMaterialMapping();Yb.Utils.isSame(b,f)||(this.batch?this.materialMappingChanges=[b,f]:(this.onSizeChanged(),this.onMaterialMapping(),this.firePropertyChange("materialMapping",b,f)))},_considerArray:function(a,b){if(a.startsWith("envmap.image")){var c=!1;if(sc.isArray(b))for(var d=0;d<b.length;d++)if(sc.isArray(b[d])){c=!0;break}return c}return sc.isArray(b)},setMaterialStyles:function(a){var b,c,d,e,f,g,h=this.getMaterialMapping(),h=this.getMaterialMapping();for(var i in a)var j=a[i];for(var k=0;k<this.getMaterialSize();k++){c=this.material.materials[k],d=c.clone();var l=!1;for(var i in a){var m=!1;if(i.startsWith("m."))e=i.substr(i.indexOf(".")+1);else if(this.getSideIndexMapping()&&this.isSideStyle(i)){var n=i.substr(0,i.indexOf(".")),f=this.getSideMaterialIndex(n);if(f!=k)continue;m=!0,g=i.substr(i.indexOf(".")+1),e=g.substr(g.indexOf(".")+1)}var j=a[i];b=j[0],null==b?b=Yb.Styles.getStyle(i):this._considerArray(e,b)&&(b=b[k]),this._A97(d,e,b),l=!0}l&&this.compareAndSetMaterial(c,d,k)}this.changeMapping(h)},setMaterialStyle:function(a,b,c){var b,d,e,f,g,h=a;if(a.startsWith("m.")&&(h=a.substr(a.indexOf(".")+1)),null==c&&!Yb.Utils.isArray(b)){var i=[];for(k=0;k<this.getMaterialSize();k++)i.push(b);this.styleMap[a]=i,b=i}var j=!1;if(h.startsWith("envmap.image")&&b&&sc.isArray(b))for(var k=0;k<b.length;k++){if(sc.isArray(b[k])){j=!1;break}j=!0}var l=this.getMaterialMapping();if(null!=c||Yb.Utils.isArray(b)&&!j){if(Yb.Utils.isArray(b)){d=b;for(var k=0;k<this.getMaterialSize();k++)e=d[k],f=this.material.materials[k],g=f.clone(),null==e&&(e=Yb.Styles.getStyle(a)),this._A97(g,h,e),this.compareAndSetMaterial(f,g,k)}else if(null!=c){var l=this.getMaterialMapping();f=this.material.materials[c],g=f.clone(),this._A97(g,h,b),this.compareAndSetMaterial(f,g,c),this.synchronizeIndexStyle(a,c,b)}}else for(var m=[],k=0;k<this.getMaterialSize();k++)m[k]!==!0&&(e=b,f=this.material.materials[k],g=f.clone(),null==e&&(e=Yb.Styles.getStyle(a)),this._A97(g,h,e),this.compareAndSetMaterial(f,g,k));this.changeMapping(l)},changeMapping:function(a){var b=this.getMaterialMapping();Yb.Utils.isSame(a,b)||(this.batch?this.materialMappingChanges=[a,b]:(this.onSizeChanged(),this.onMaterialMapping(),this.firePropertyChange("materialMapping",a,b)))},synchronizeSideStyle:function(a,b,c){var d=this.getMaterialIndexSide(b);d&&null!=this.styleMap[d+"."+a]&&(this.styleMap[d+"."+a]=c)},synchronizeIndexStyle:function(a,b,c){var d=this.styleMap[a];if(null==d&&(d=this.getStyle(a),this.styleMap[a]=d),Yb.Utils.isArray(d))d[b]=c;else{var e=[];for(i=0;i<this.getMaterialSize();i++)e.push(d);e[b]=c,this.styleMap[a]=e}},getDefaultMaterial:function(a,b){return a?a instanceof Yb.ArrayMaterial?0===a.materials.length?Zc.DefaultMaterial:(b>=a.materials.length&&(b=a.materials.length-1),a.materials[b]):a:Zc.DefaultMaterial},createMaterial:function(a){var b=new Yb.ArrayMaterial;this.material=b;for(var c=this.getMaterialSize(),d=0;c>d;d++)this.setMaterial(d,this.getDefaultMaterial(a,d))},onPropertyChange:function(a,b,c){this.changeProperty=a,this.oldGroups=this.groups;var d=this.isSizeChangedProperty(a);d&&this.onSizeChanged(),d&&this.onMaterialMapping(),d&&this.firePropertyChange("materialMapping",0,1)},onSizeChanged:function(){this.computed=!1,this.computeNodeData(),this.computeCentroids(),this.computeFaceNormals(),this.computeBoundingBox(),this.selectionData=null,this.boundingSphere=null,this.changeProperty=null},isSizeChangedProperty:function(a){return-1!==this.__SizePropeties.indexOf(a)||"vertices"==a||"faces"==a||"uvs"==a},isGroupChangedProperty:function(a){},getMaterialMapping:function(){var a={},b=this.material.materials;for(var c in b)a[c]=b.indexOf(b[c]);return a},getSideMaterialIndex:function(a){var b=this.getSideIndexMapping();return b?b[a]:void 0},getMaterialIndexSide:function(a){var b=this.getIndexSideMapping();return b?b[a]:void 0},getIndexSideMapping:function(){var a=this.getSideIndexMapping();if(a&&!this.IndexSideMapping){this.IndexSideMapping={};var b,c;for(b in a)c=a[b],this.IndexSideMapping[c]=b}return this.IndexSideMapping},getSideIndexMapping:function(){},disposeMaterial:function(){},getMaterial:function(){return this.material}});var nc=function(a,b,c){this.normal=a instanceof Yb.Vec3?a:new Yb.Vec3,this.vertexNormals=a instanceof Array?a:[],this.color=b instanceof Yb.Color?b:new Yb.Color,this.vertexColors=b instanceof Array?b:[],this.materialIndex=c?c:0,this.centroid=new Yb.Vec3,this.needVertexNormal=!1};Yb.Face=nc,nc.prototype={constructor:Yb.Face,subClone:function(){},clone:function(){var a=this.subClone();a.normal.copy(this.normal),a.color.copy(this.color),a.centroid.copy(this.centroid),a.materialIndex=this.materialIndex;var b,c;for(b=0,c=this.vertexNormals.length;c>b;b++)a.vertexNormals.push(this.vertexNormals[b]);for(b=0,c=this.vertexColors.length;c>b;b++)a.vertexColors.push(this.vertexColors[b]);return a}};var oc=function(a,b,c,d,e,f){Yb.Face.call(this,d,e,f),this.a=a,this.b=b,this.c=c};Yb.Face3=oc,oc.prototype=Object.create(Yb.Face.prototype),oc.prototype.constructor=Yb.Face3,oc.prototype.subClone=function(){var a=new oc(this.a,this.b,this.c);return a},oc.prototype.vertexCount=3,oc.prototype.serializeJsonValue=function(){return{a:this.a,b:this.b,c:this.c}};var pc=function(a,b,c,d,e,f,g){Yb.Face.call(this,e,f,g),this.a=a,this.b=b,this.c=c,this.d=d};Yb.Face4=pc,pc.prototype=Object.create(Yb.Face.prototype),pc.prototype.constructor=Yb.Face4,pc.prototype.subClone=function(){var a=new pc(this.a,this.b,this.c,this.d);return a},pc.prototype.splitToFace3s=function(){var a=new oc(this.a,this.b,this.d,this.normal,this.color,this.materialIndex),b=new oc(this.d,this.b,this.c,this.normal,this.color,this.materialIndex);return[a,b]},pc.prototype.vertexCount=4,pc.prototype.serializeJsonValue=function(){return{a:this.a,b:this.b,c:this.c,d:this.d}},Yb.Entity=function(a,b){a instanceof Yb.ArrayMaterial?(this.material=a,this.materialSize=this.material.materials.length||1):a instanceof Yb.Material?(this.material=a,this.materialSize=1):a&&(this.materialSize=a),this.materialSize=this.materialSize||1,this.createMaterial(this.material),b!=e&&null==this._id&&(this._id=b),Yb.Node.call(this,this._id),this.groups=null},Yb.extend(Yb.Entity,Yb.Node,{constructor:Yb.Entity,className:"TGL.Entity",__accessor:["computeVertexNormal"],__SizePropeties:["computeVertexNormal"],setUpdateFlags:function(a){this.verticesNeedUpdate=a,this.elementsNeedUpdate=a,this.uvsNeedUpdate=a,this.normalsNeedUpdate=a,this.colorsNeedUpdate=a,this.buffersNeedUpdate=a},cloneCallback:function(a){a&&"TGL.Entity"===this.className&&(this.computed=!1,this.computeNodeData())},needComputeVertexNormal:function(){return this.computeVertexNormal},computeData:function(){var a={vertices:this.vertices,faces:this.faces,uvs:this.uvs,uv2s:this.uv2s};return a},createCloneObject:function(){return this.constructor===Yb.Entity?new Yb.Entity(this.materialSize):Yb.Element.prototype.createCloneObject.call(this)},getMaterialSize:function(){return this.materialSize},setMaterialSize:function(a){"number"==typeof a&&(this.materialSize=a,this.createMaterial(this.material))}});var qc=function(){var a,b,c,d,e,f,g,h;1===arguments.length&&arguments[0]instanceof Object&&!Array.isArray(arguments[0])?(g=arguments[0],a=g.width,b=g.height,c=g.depth,d=g.segmentsW,e=g.segmentsH,f=g.segmentsD,h=g.wrapMode,this._id=g.id):arguments[0]instanceof Yb.Material?(this.material=arguments[0],a=arguments[1],b=arguments[2],c=arguments[3],d=arguments[4],e=arguments[5],f=arguments[6],h=arguments[7]):(a=arguments[0],b=arguments[1],c=arguments[2],d=arguments[3],e=arguments[4],f=arguments[5],h=arguments[6]),this.width=a||1,this.height=b||1,this.depth=c||1,this.segmentsW=d||1,this.segmentsH=e||1,this.segmentsD=f||1,this.wrapMode=(h||"").toLowerCase(),this.materialSize=null==this.wrapMode||""==this.wrapMode?6:1,this.offset=new $b(0,0,0),Yb.Entity.call(this)};Yb.Cube=qc,Yb.extend(Yb.Cube,Yb.Entity,{__accessor:["width","height","depth","wrapMode"],__SizePropeties:["width","height","depth","wrapMode"],className:"TGL.Cube",getUVs:function(){return this.uvs},setPropertyValue:function(a,b){var c=this[a];if(c===b)return!1;if(this[a]=b,"wrapMode"===a){var d=this.wrapMode,e="six-each"==d||"front-other"==d||"back-other"==d||"left-other"==d||"right-other"==d||"top-other"==d||"bottom-other"==d;this.materialSize=null==this.wrapMode||""==this.wrapMode?6:1,e||(this[a]="")}return!0},getLinkOffset:function(a){a.length();a.normalize();var b=a.x/this.getWidth(),c=a.y/this.getHeight(),d=a.z/this.getDepth(),e=Math.max(Math.abs(b),Math.abs(c),Math.abs(d));return e==Math.abs(b)?new $b(this.getWidth()/2*(0>b?-1:1),0,0):e==Math.abs(c)?new $b(0,this.getHeight()/2*(0>c?-1:1),0):new $b(0,0,this.getDepth()/2*(0>d?-1:1))},getLinkExtend:function(a){var b=this.worldMatrix.clone();return b=(new mono.Mat4).extractRotation(b),this.getLinkOffset(a.applyMatrix4((new ac).getInverse(b)))},computeData:function(){var a=gc.buildCubeData(this.width,this.height,this.depth,this.segmentsW,this.segmentsH,this.segmentsD,this.wrapMode,this.offset||new $b(0,0,0));return this.vertices=a.vertices,this.uvs=a.uvs,this.faces=a.faces,this.data=a,a},getSideIndexMapping:function(){return this.wrapMap?null:Yb.Cube.SideIndexMapping},generatePrimitiveKey:function(){return"cube_"+this.width+"_"+this.height+"_"+this.depth+"_"+this.segmentsW+"_"+this.segmentsH+"_"+this.segmentsD+"_"+(this.material instanceof Yb.ArrayMaterial?1:0)+"_"+this.wrapMode+"_"+this.offset.x+"_"+this.offset.y+"_ "+this.offset.z+"_"+Yb.Utils.toString(this.getMaterialMapping())},serialize:function(a){var b=a;1!==this.width&&b.serializeSimple("p","width",this.width,"number"),1!==this.height&&b.serializeSimple("p","height",this.height,"number"),1!==this.depth&&b.serializeSimple("p","depth",this.depth,"number"),1!==this.widthSegemtns&&b.serializeSimple("p","widthSegemtns",this.widthSegemtns,"number"),1!==this.heightSegments&&b.serializeSimple("p","heightSegments",this.heightSegments,"number"),1!==this.depthSegments&&b.serializeSimple("p","depthSegments",this.depthSegments,"number"),Yb.Element.serialize.call(this,b)}}),qc.SideIndexMapping={right:0,left:1,top:2,bottom:3,front:4,back:5},Yb.Sphere=function(){var a,b,c,d,f,g,h;if(1===arguments.length&&arguments[0]instanceof Object&&!Array.isArray(arguments[0])){var i=arguments[0];a=i.radius,b=i.segmentsW,c=i.segmentsH,d=i.longitudeStart,f=i.longitudeLength,g=i.latitudeStart,this._id=i.id}else arguments[0]instanceof Yb.Material?(this.material=arguments[0],a=arguments[1],b=arguments[2],c=arguments[3],d=arguments[4],f=arguments[5],g=arguments[6],h=arguments[7]):(a=arguments[0],b=arguments[1],c=arguments[2],d=arguments[3],f=arguments[4],g=arguments[5],h=arguments[6]);this.radius=a||50,this.segmentsW=Math.max(3,Math.floor(b)||22),this.segmentsH=Math.max(2,Math.floor(c)||15),this.longitudeStart=d!==e?d:0,this.longitudeLength=f!==e?f:2*Math.PI,this.latitudeStart=g!==e?g:0,this.latitudeLength=h!==e?h:Math.PI,this.materialSize=1,Yb.Entity.call(this),this.computeCentroids(),this.computeFaceNormals()},Yb.extend(Yb.Sphere,Yb.Entity,{constructor:Yb.Sphere,__accessor:["radius","segmentsW","segmentsH","latitudeStart","latitudeLength","longitudeStart","longitudeLength"],__SizePropeties:["radius","segmentsW","segmentsH","latitudeStart","latitudeLength","longitudeStart","longitudeLength"],className:"TGL.Sphere",computeData:function(){var a=gc.bsd(this.radius,this.segmentsW,this.segmentsH,this.longitudeStart,this.longitudeLength,this.latitudeStart,this.latitudeLength);return this.vertices=a.vertices,this.uvs=a.uvs,this.faces=a.faces,this.data=a,a},generatePrimitiveKey:function(){return"sphere_"+this.radius+"_"+this.segmentsW+"_"+this.segmentsH+"_"+this.longitudeStart+"_"+this.longitudeLength+"_"+this.latitudeStart+"_"+this.latitudeLength},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Yb.BoundingSphere(new Yb.Vec3,this.radius))},getLinkOffset:function(a){a.length();return a.normalize(),a.multiplyScalar(this.radius)},serialize:function(a){var b=a;50!==this.radius&&b.serializeSimple(Vc,"radius",this.radius,"number"),24!==this.widthSegments&&b.serializeSimple(Vc,"widthSegments",this.widthSegments,"number"),18!==this.heightSegments&&b.serializeSimple(Vc,"heightSegments",this.heightSegments,"number"),0!==this.phiStart&&b.serializeSimple(Vc,"phiStart",this.phiStart,"number"),this.phiLength!==2*Math.PI&&b.serializeSimple(Vc,"phiLength",this.phiLength,"number"),0!==this.thetaStart&&b.serializeSimple(Vc,"thetaStart",this.thetaStart,"number"),this.thetaLength!==Math.PI&&b.serializeSimple(Vc,"thetaLength",this.thetaLength,"number")}}),Yb.Plane=function(){var a,b,c,d;arguments[0]instanceof Yb.Material?(this.material=arguments[0],a=arguments[1],b=arguments[2],c=arguments[3],d=arguments[4]):(a=arguments[0],b=arguments[1],c=arguments[2],d=arguments[3]),this.width=a||5,this.height=b||5,this.segmentsW=c||1,this.segmentsH=d||1,this.vertices=[],this.faces=[],this.uvs=[],this.uv2s=[],this.materialSize=1,this.computeData=function(){var a,b,c=this.width/2,d=this.height/2,e=this.segmentsW,f=this.segmentsH,g=e+1,h=f+1,i=this.width/e,j=this.height/f,k=new Yb.Vec3(0,0,1),l={vertices:[],faces:[],uvs:[]};for(b=0;h>b;b++)for(a=0;g>a;a++){var m=a*i-c,n=b*j-d;l.vertices.push(new Yb.Vec3(m,-n,0))}for(b=0;f>b;b++)for(a=0;e>a;a++){var o=a+g*b,p=a+g*(b+1),q=a+1+g*(b+1),r=a+1+g*b,s=new Yb.Vec2(a/e,1-b/f),t=new Yb.Vec2(a/e,1-(b+1)/f),u=new Yb.Vec2((a+1)/e,1-(b+1)/f),v=new Yb.Vec2((a+1)/e,1-b/f),w=new Yb.Face4(o,p,q,r);w.normal.copy(k),w.vertexNormals.push(k.clone(),k.clone(),k.clone(),k.clone()),l.faces.push(w),l.uvs.push([s,t,u,v])}return l},Yb.Entity.call(this),this.computeCentroids()},Yb.extend(Yb.Plane,Yb.Entity,{constructor:Yb.Plane,className:"TGL.Plane",__accessor:["width","height","segmentsW","segmentsH"],__SizePropeties:["width","height","segmentsW","segmentsH"],clone:function(){var a=new Yb.Plane(this.material,this.width,this.height,this.segmentsW,this.segmentsH);return this.superClass.clone.call(this,a),a},getSelectStyle:function(){var a=this.getStyle("select.style");return("outline.normal"==a||"outline"==a)&&(a="outline.wireframe"),a}}),Yb.Cylinder=function(){var a,b,c,d,f,g,h,i,j;1===arguments.length&&arguments[0]instanceof Object&&!Array.isArray(arguments[0])?(options=arguments[0],a=options.radiusTop,b=options.radiusBottom,c=options.height,d=options.segmentsR,f=options.segmentsH,g=options.openTop,h=options.openBottom,i=options.arcLength,j=options.arcStart,this._id=options.id):arguments[0]instanceof Yb.Material?(this.material=arguments[0],a=arguments[1],b=arguments[2],c=arguments[3],d=arguments[4],f=arguments[5],g=arguments[6],h=arguments[7],i=arguments[8],j=arguments[9]):(a=arguments[0],b=arguments[1],c=arguments[2],d=arguments[3],f=arguments[4],g=arguments[5],h=arguments[6],i=arguments[7],j=arguments[8]),this.radiusTop=a=a!==e?a:20,this.radiusBottom=b=b!==e?b:20,this.height=c=c!==e?c:100,this.segmentsR=d=d||20,this.segmentsH=f=f||1,this.openTop=g!==e?g:!1,this.openBottom=h!=e?h:!1,this.arcLength=i!==e?i:2*Math.PI,this.arcStart=j!==e?j:0,this.materialSize=3,Yb.Entity.call(this),this.computeNodeData(),this.computeCentroids(),this.computeFaceNormals()},Yb.extend(Yb.Cylinder,Yb.Entity,{constructor:Yb.Cylinder,__accessor:["radiusTop","radiusBottom","height","segmentsR","segmentsH","openTop","openBottom","arcLength","arcStart"],__bool:["openTop","openBottom"],__SizePropeties:["radiusTop","radiusBottom","height","segmentsR","segmentsH","openTop","openBottom","arcLength","arcStart"],className:"TGL.Cylinder",computeData:function(){return gc.bcld(this.height,this.segmentsH,this.radiusBottom,this.radiusTop,this.segmentsR,this.openTop,this.openBottom,this.arcLength,this.arcStart)},getLinkOffset:function(a){var b=a.length();a.normalize();var c=a.x,d=a.y,e=a.z,f=Math.sqrt(c*c+e*e),g=d>0?this.radiusTop:this.radiusBottom;if(Math.abs(d/f)>this.height/2/g&&b>0){var h=new $b(0,this.height/2*(d>0?1:-1),0);return h}return new $b(c,0,e).normalize().multiplyScalar((this.radiusTop+this.radiusBottom)/2)},getLinkExtend:function(a){var b=this.worldMatrix.clone();return b=(new mono.Mat4).extractRotation(b),this.getLinkOffset(a.applyMatrix4((new ac).getInverse(b)))},clearLinkOrthogonal:function(a,b,c,d){d=d||0;var e=this.getHeight()/2+d,f=(this.radiusTop+this.radiusBottom)/2+d;return"orthogonal.x"==c||"orthogonal.x.n"==c?!(Math.abs(a.y-b.y)>e||Math.abs(a.z-b.z)>f):"orthogonal.y"==c||"orthogonal.y.n"==c?!(Math.abs(a.x-b.x)>f||Math.abs(a.z-b.z)>f):"orthogonal.z"==c||"orthogonal.z.n"==c?!(Math.abs(a.y-b.y)>e||Math.abs(a.z-b.z)>f):!1},clearLinkExtend:function(a,b){if("extend.x"===b);else if("extend.y"===b&&a>this.getHeight()/2)return!0;return!1},getSideIndexMapping:function(){return Yb.Cylinder.SideIndexMapping},generatePrimitiveKey:function(){return"cylinder_"+this.height+"_"+this.segmentsH+"_"+this.radiusTop+"_"+this.radiusBottom+"_"+this.segmentsR+"_"+this.openTop+"_"+this.openBottom+"_"+this.arcLength+"_"+this.arcStart+Yb.Utils.toString(this.getMaterialMapping())},needComputeVertexNormal:function(){return!1}}),Yb.Cylinder.SideIndexMapping={side:0,top:1,bottom:2},Yb.Circle=function(){var a,b,c,d;4===arguments.length?(a=arguments[0],b=arguments[1],c=arguments[2],d=arguments[3]):(this.material=arguments[0],a=arguments[1],b=arguments[2],c=arguments[3],d=arguments[4]),this.radius=a=a||50,this.segments=b=b!==e?Math.max(3,b):8,this.thetaStart=c=c!==e?c:0,this.thetaLength=d=d!==e?d:2*Math.PI,this.materialSize=1,Yb.Entity.call(this),this.computeCentroids(),this.computeFaceNormals(),this.boundingSphere=new Yb.BoundingSphere(new Yb.Vec3,a)},Yb.extend(Yb.Circle,Yb.Entity,{clone:function(){var a=new Yb.Circle(this.material,this.radius,this.segments,this.thetaStart,this.thetaLength);return this.constructor.superClass.clone.call(this,a),a},computeData:function(){var a,b=this.segments,c=[],d=new Yb.Vec3,e=new Yb.Vec2(.5,.5),f={vertices:[],faces:[],uvs:[],uv2s:[]};for(f.vertices.push(d),c.push(e),a=0;b>=a;a++){var g=new Yb.Vec3,h=this.thetaStart+a/b*this.thetaLength;g.x=this.radius*Math.cos(h),g.y=this.radius*Math.sin(h),f.vertices.push(g),c.push(new Yb.Vec2((g.x/this.radius+1)/2,(g.y/this.radius+1)/2))}var i=new Yb.Vec3(0,0,1);for(a=1;b>=a;a++){var j=a,k=a+1,l=0;f.faces.push(new Yb.Face3(j,k,l,[i,i,i])),f.uvs.push([c[a],c[a+1],e])}return f}}),Yb.Torus=function(){var a,b,c,d,e;1===arguments.length&&arguments[0]instanceof Object&&!Array.isArray(arguments[0])?(options=arguments[0],a=options.radius,b=options.tube,c=options.segmentsR,d=options.segmentsT,e=options.arc,this._id=options.id):arguments[0]instanceof Yb.Material?(this.material=arguments[0],a=arguments[1],b=arguments[2],c=arguments[3],d=arguments[4],e=arguments[5]):(a=arguments[0],b=arguments[1],c=arguments[2],d=arguments[3],e=arguments[4]),this.materialSize=1,this.radius=a||100,this.tube=b||40,this.segmentsR=c||8,this.segmentsT=d||6,this.arc=e||2*Math.PI,Yb.Entity.call(this),this.computeNodeData(),this.computeCentroids()},Yb.extend(Yb.Torus,Yb.Entity,{__accessor:["radius","tube","segmentsR","segmentsT","arc"],__SizePropeties:["radius","tube","segmentsR","segmentsT","arc"],className:"TGL.Torus",generatePrimitiveKey:function(){return"torus_"+this.radius+"_"+this.tube+"_"+this.segmentsR+"_"+this.segmentsT+"_"+this.arc},computeData:function(){for(var a=new Yb.Vec3,b=[],c=[],d={vertices:[],faces:[],uvs:[],uv2s:[]},e=0;e<=this.segmentsR;e++)for(var f=0;f<=this.segmentsT;f++){var g=f/this.segmentsT*this.arc,h=e/this.segmentsR*Math.PI*2;a.x=this.radius*Math.cos(g),a.y=this.radius*Math.sin(g);var i=new Yb.Vec3;i.x=(this.radius+this.tube*Math.cos(h))*Math.cos(g),i.y=(this.radius+this.tube*Math.cos(h))*Math.sin(g),i.z=this.tube*Math.sin(h),d.vertices.push(i),b.push(new Yb.Vec2(f/this.segmentsT,e/this.segmentsR)),c.push(i.clone().sub(a).normalize())}for(var e=1;e<=this.segmentsR;e++)for(var f=1;f<=this.segmentsT;f++){var j=(this.segmentsT+1)*e+f-1,k=(this.segmentsT+1)*(e-1)+f-1,l=(this.segmentsT+1)*(e-1)+f,m=(this.segmentsT+1)*e+f,n=new Yb.Face3(j,k,m,[c[j],c[k],c[m]]);n.normal.add(c[j]),n.normal.add(c[k]),n.normal.add(c[m]),n.normal.normalize(),d.faces.push(n),d.uvs.push([b[j].clone(),b[k].clone(),b[m].clone()]),n=new Yb.Face3(k,l,m,[c[k],c[l],c[m]]),n.normal.add(c[k]),n.normal.add(c[l]),n.normal.add(c[m]),n.normal.normalize(),d.faces.push(n),d.uvs.push([b[k].clone(),b[l].clone(),b[m].clone()])}return d}}),Yb.Arrow=function(){var a,b,c,d,e;arguments[0]instanceof Yb.Material?(this.material=arguments[0],a=arguments[1],b=arguments[2],c=arguments[3],d=arguments[4],e=arguments[5]):(a=arguments[0],b=arguments[1],c=arguments[2],d=arguments[3],e=arguments[4]),this.materialSize=1,this.tailHeight=a||100,this.tailRadius=b||20,this.headHeight=c||20,this.headRadius=d||30,this.radiusSegments=e||30,Yb.Entity.call(this),this.computeCentroids(),this.computeFaceNormals()},Yb.extend(Yb.Arrow,Yb.Entity,{constructor:Yb.Arrow,className:"TGL.Arrow",computeData:function(){var a=2,b=this.tailHeight,c=this.tailRadius,d=this.headHeight,e=this.headRadius,f=this.radiusSegments;this.headRadius<this.tailRadius&&(this.headRadius=this.tailRadius);var g,h,i=b+d,j=i/2,k=[],l=[],m=[],n=[];for(h=0;a>=h;h++){var o=[],p=[],q=h/a,r=q*e;for(g=0;f>=g;g++){var s=g/f,t=new Yb.Vec3;t.x=r*Math.sin(s*Math.PI*2),t.y=-q*d+j,t.z=r*Math.cos(s*Math.PI*2),this.vertices.push(t),o.push(this.vertices.length-1),p.push(new Yb.Vec2(s,1-q))}k.push(o),m.push(p)}for(this.vertices.push(new Yb.Vec3(0,j-d,0)),h=0;a>=h;h++){var o=[],p=[],q=h/a,r=c;for(g=0;f>=g;g++){var s=g/f,t=new Yb.Vec3;t.x=r*Math.sin(s*Math.PI*2),t.y=-q*b+j-d,t.z=r*Math.cos(s*Math.PI*2),this.vertices.push(t),o.push(this.vertices.length-1),p.push(new Yb.Vec2(s,1-q))}l.push(o),n.push(p)}this.vertices.push(new Yb.Vec3(0,-j,0));var u,v,w=this.headRadius/i;for(g=0;f>g;g++)for(u=this.vertices[k[0][g]].clone(),v=this.vertices[k[0][g+1]].clone(),u.setY(Math.sqrt(u.x*u.x+u.z*u.z)*w).normalize(),v.setY(Math.sqrt(v.x*v.x+v.z*v.z)*w).normalize(),h=0;a>h;h++){var x=k[h][g],y=k[h+1][g],z=k[h+1][g+1],A=k[h][g+1],B=u.clone(),C=u.clone(),D=v.clone(),E=v.clone(),F=m[h][g].clone(),G=m[h+1][g].clone(),H=m[h+1][g+1].clone(),I=m[h][g+1].clone();this.faces.push(new Yb.Face3(x,y,A,[B,C,E])),this.uvs.push([F,G,I]),this.faces.push(new Yb.Face3(y,z,A,[C,D,E])),this.uvs.push([G,H,I])}for(g=0;f>g;g++){var x=k[h][g+1],y=k[h][g],z=k.length-1,B=new Yb.Vec3(0,-1,0),C=new Yb.Vec3(0,-1,0),D=new Yb.Vec3(0,-1,0),F=m[h][g+1].clone(),G=m[h][g].clone(),H=new Yb.Vec2(G.u,1);this.faces.push(new Yb.Face3(x,y,z,[B,C,D])),this.uvs.push([F,G,H])}var u,v,w=0;for(g=0;f>g;g++)for(u=this.vertices[l[1][g]].clone(),v=this.vertices[l[1][g+1]].clone(),u.setY(Math.sqrt(u.x*u.x+u.z*u.z)*w).normalize(),v.setY(Math.sqrt(v.x*v.x+v.z*v.z)*w).normalize(),h=0;a>h;h++){var x=l[h][g],y=l[h+1][g],z=l[h+1][g+1],A=l[h][g+1],B=u.clone(),C=u.clone(),D=v.clone(),E=v.clone(),F=m[h][g].clone(),G=m[h+1][g].clone(),H=m[h+1][g+1].clone(),I=m[h][g+1].clone();this.faces.push(new Yb.Face3(x,y,A,[B,C,E])),this.uvs.push([F,G,I]),this.faces.push(new Yb.Face3(y,z,A,[C,D,E])),this.uvs.push([G,H,I])}for(g=0;f>g;g++){var x=l[h][g+1],y=l[h][g],z=l.length-1,B=new Yb.Vec3(0,-1,0),C=new Yb.Vec3(0,-1,0),D=new Yb.Vec3(0,-1,0),F=n[h][g+1].clone(),G=n[h][g].clone(),H=new Yb.Vec2(G.u,1);this.faces.push(new Yb.Face3(x,y,z,[B,C,D])),this.uvs.push([F,G,H])}return this}}),Yb.BufferNode=function(){this.uuid=Yb.Math.generateUUID(),this.name="",this.attributes={},this.dynamic=!0,this.offsets=[],this.boundingBox=null,this.boundingSphere=null,this.materialSize=1,this.createMaterial(),Yb.Node.call(this)},Yb.extend(Yb.BufferNode,Yb.Node,{constructor:Yb.BufferNode,compuateBufferData:function(){if(!this.computed){var a=this.attributes.position;a&&a.array&&(a.itemSize=3,a.numItems=a.array.length,this.verticesNeedUpdate=!0);var b=this.attributes.uv;b&&b.array&&(b.itemSize=2,b.numItems=b.array.length,this.uvsNeedUpdate=!0);var c=this.attributes.index;c&&c.array&&(this.offsets=[{index:0,start:0,count:c.array.length}]),this.computed=!0}},applyMatrix:function(a){var b,c;if(this.attributes.position&&(b=this.attributes.position.array),this.attributes.normal&&(c=this.attributes.normal.array),b!==e&&(a.multiplyVec3Array(b),this.verticesNeedUpdate=!0),c!==e){var d=(new Yb.Matrix3).getNormalMatrix(a);d.multiplyVec3Array(c),this.normalizeNormals(),this.normalsNeedUpdate=!0}},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Yb.BoundingBox);var a=this.attributes.position.array;if(a){var b,c,d,f=this.boundingBox;a.length>=3&&(f.min.x=f.max.x=a[0],f.min.y=f.max.y=a[1],f.min.z=f.max.z=a[2]);for(var g=3,h=a.length;h>g;g+=3)b=a[g],c=a[g+1],d=a[g+2],b<f.min.x?f.min.x=b:b>f.max.x&&(f.max.x=b),c<f.min.y?f.min.y=c:c>f.max.y&&(f.max.y=c),d<f.min.z?f.min.z=d:d>f.max.z&&(f.max.z=d)}(a===e||0===a.length)&&(this.boundingBox.min.set(0,0,0),this.boundingBox.max.set(0,0,0))},computeBoundingSphere:function(){var a=new Yb.BoundingBox,b=new Yb.Vec3;return function(){null===this.boundingSphere&&(this.boundingSphere=new Yb.BoundingSphere);var c=this.attributes.position.array;if(c){for(var d=this.boundingSphere.center,e=[],f=0,g=c.length;g>f;f+=3)b.set(c[f],c[f+1],c[f+2]),
e.push(b);a.setFromPoints(e),a.center(d);for(var h=0,f=0,g=c.length;g>f;f+=3)b.set(c[f],c[f+1],c[f+2]),h=Math.max(h,d.distanceToSquared(b));this.boundingSphere.radius=Math.sqrt(h)}}}(),computeVertexNormals:function(){if(this.attributes.position){var a,b,c,d,f=this.attributes.position.array.length;if(this.attributes.normal===e)this.attributes.normal={itemSize:3,array:new Float32Array(f)};else for(a=0,b=this.attributes.normal.array.length;b>a;a++)this.attributes.normal.array[a]=0;var g,h,i,j,k,l,m=this.attributes.position.array,n=this.attributes.normal.array,o=new Yb.Vec3,p=new Yb.Vec3,q=new Yb.Vec3,r=new Yb.Vec3,s=new Yb.Vec3;if(this.attributes.index){var t=this.attributes.index.array,u=this.offsets;for(c=0,d=u.length;d>c;++c){var v=u[c].start,w=u[c].count,x=u[c].index;for(a=v,b=v+w;b>a;a+=3)g=x+t[a],h=x+t[a+1],i=x+t[a+2],j=m[3*g],k=m[3*g+1],l=m[3*g+2],o.set(j,k,l),j=m[3*h],k=m[3*h+1],l=m[3*h+2],p.set(j,k,l),j=m[3*i],k=m[3*i+1],l=m[3*i+2],q.set(j,k,l),r.subVectors(q,p),s.subVectors(o,p),r.cross(s),n[3*g]+=r.x,n[3*g+1]+=r.y,n[3*g+2]+=r.z,n[3*h]+=r.x,n[3*h+1]+=r.y,n[3*h+2]+=r.z,n[3*i]+=r.x,n[3*i+1]+=r.y,n[3*i+2]+=r.z}}else for(a=0,b=m.length;b>a;a+=9)j=m[a],k=m[a+1],l=m[a+2],o.set(j,k,l),j=m[a+3],k=m[a+4],l=m[a+5],p.set(j,k,l),j=m[a+6],k=m[a+7],l=m[a+8],q.set(j,k,l),r.subVectors(q,p),s.subVectors(o,p),r.cross(s),n[a]=r.x,n[a+1]=r.y,n[a+2]=r.z,n[a+3]=r.x,n[a+4]=r.y,n[a+5]=r.z,n[a+6]=r.x,n[a+7]=r.y,n[a+8]=r.z;this.normalizeNormals(),this.normalsNeedUpdate=!0}},normalizeNormals:function(){for(var a,b,c,d,e=this.attributes.normal.array,f=0,g=e.length;g>f;f+=3)a=e[f],b=e[f+1],c=e[f+2],d=1/Math.sqrt(a*a+b*b+c*c),e[f]*=d,e[f+1]*=d,e[f+2]*=d},clone:function(){var a=new Yb.BufferNode,b=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];for(var c in this.attributes){for(var d=this.attributes[c],e=d.array,f={itemSize:d.itemSize,numItems:d.numItems,array:null},g=0,h=b.length;h>g;g++){var i=b[g];if(e instanceof i){f.array=new i(e);break}}a.attributes[c]=f}for(var g=0,h=this.offsets.length;h>g;g++){var j=this.offsets[g];a.offsets.push({start:j.start,index:j.index,count:j.count})}return a},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Yb.Particle=function(a,b,c){var d;1===arguments.length&&arguments[0]instanceof Object&&!Array.isArray(arguments[0])&&(d=arguments[0],this._id=d.id),Yb.Node.call(this,this._id),this.material=new Yb.ParticleMaterial({color:16777215*Math.random()}),this.sortParticles=!1,this.frustumCulled=!1,this.vertices=(d?d.vertices:a)||[],this.colors=(d?d.colors:b)||[],this.sizes=(d?d.sizes:c)||[],this.setUpdateFlags(!0)},Yb.extend(Yb.Particle,Yb.Node,{clone:function(a){return a===e&&(a=new Yb.Particle(this.material)),a.sortParticles=this.sortParticles,a.frustumCulled=this.frustumCulled,Yb.Element.prototype.clone.call(this,a),a},needUpdate:function(){return!1},setUpdateFlags:function(a){this.verticesNeedUpdate=a,this.dirtyColors=a,this.normalsNeedUpdate=a},setMaterialStyle:function(a,b){a=a.substr(a.indexOf(".")+1),this._A97(this.material,a,b)}}),Yb.Line=function(){var a,b,c;if(1===arguments.length&&arguments[0]instanceof Object&&!Array.isArray(arguments[0])){var d=arguments[0];a=d.vertices,b=d.colors,c=d.type,this._id=d.id||this._id}else a=arguments[0],b=arguments[1],c=arguments[2];Yb.Node.call(this,this._id),this.material=new Yb.LineMaterial({color:16777215}),this.type=c!==e?c:Yb.LineStrip,this.vertices=a||[],this.colors=b||[]},Yb.LineStrip=0,Yb.LinePieces=1,Yb.extend(Yb.Line,Yb.Node,{className:"TGL.Line",__accessor:["vertices","type"],__SizePropeties:["vertices","type"],clone:function(a){return a===e&&(a=new Yb.Line(this.material,this.type)),Yb.Element.prototype.clone.call(this,a,!0),a},onPropertyChange:function(){},setMaterialStyle:function(a,b){a=a.substr(a.indexOf(".")+1),this._A97(this.material,a,b)},setMaterialStyles:function(a){Yb.Element.prototype.setMaterialStyles.call(this,a)}}),Yb.Line.createEllipse=function(a,b,c,d,e,f,g){"number"==typeof a?(g=f,f=e,e=d,d=c,c=b,b=a,a=new Yb.Line):null==a&&(a=new Yb.Line);for(var h=new Yb.EllipseCurve(0,0,b,c,e,f,g),i=[],j=d||50,k=0;j>=k;k++){var l=h.getPoint(k/j);i.push(l)}return a.setVertices(i),a},Yb.Line.createHelix=function(a,b,c,d,e,f){"number"==typeof a?(f=e,e=d,d=c,c=b,b=a,a=new Yb.Line):null==a&&(a=new Yb.Line);var g=[],h=f||50;e=e||1;for(var i,j,k,l,m=0;h>=m;m++)i=(c*m+b*(h-m))/h,k=e*Math.PI*2*m/h,j=d*(.5-m/h),l=new $b(i*Math.sin(k),j,i*Math.cos(k)),g.push(l);return a.setVertices(g),a},Yb.Line.createRectangle=function(a,b,c,d){"number"==typeof a?(d=c,c=b,b=a,a=new Yb.Line):null==a&&(a=new Yb.Line);var e=d||50,f=2*(b+c)/e,g=[];if(f>Math.min(b,c))g.push(new $b(-b/2,-c/2,0)),g.push(new $b(-b/2,c/2,0)),g.push(new $b(b/2,c/2,0)),g.push(new $b(b/2,-c/2,0)),g.push(new $b(-b/2,-c/2,0));else for(var h,i=-b/2,j=-c/2,k=0;e>=k;k++)i==-b/2&&c/2>j?c/2>=j+f?j+=f:(g.push(new $b(-b/2,c/2,0)),g.push(new $b(-b/2,c/2,0)),i+=j+f-c/2,j=c/2):j==c/2&&b/2>=i?b/2>=i+f?i+=f:(g.push(new $b(b/2,c/2,0)),g.push(new $b(b/2,c/2,0)),j-=i+f-b/2,i=b/2):i==b/2&&j>-c/2?j-f>=-c/2?j-=f:(g.push(new $b(b/2,-c/2,0)),g.push(new $b(b/2,-c/2,0)),i-=-c/2-j+f,j=-c/2):j==-c/2&&i>=-b/2&&(i-f>=-b/2?i-=f:(j+=-b/2-i+f,i=-b/2)),h=new $b(i,j,0),g.push(h);return a.setVertices(g),a},Yb.PathLine=function(){var a,b,c;if(1===arguments.length&&arguments[0]instanceof Object&&!(arguments[0]instanceof Yb.Path)){var d=arguments[0];a=d.path,b=d.segments,c=d.type,this._id=d.id||this._id}else a=arguments[0],b=arguments[1],c=arguments[2],this._id=arguments[3];Yb.Line.call(this,{vertices:[],colors:[],type:c,id:this._id}),this.segments=b||20,this.setPath(a)},Yb.extend(Yb.PathLine,Yb.Line,{constructor:Yb.PathLine,className:"TGL.PathLine",__accessor:["path","segments"],__SizePropeties:["path","segments"],onPropertyChange:function(){this.computeNodeData()},computeNodeData:function(){this.computeData()},adjustPath:function(a){return a},computeData:function(){var a=this.path;if(a){a=this.adjustPath(a);var b,c,d,e,f=a.curves.length,g=a.curves,h=[],i=a.getLength(),j=0,k=this.segments;for(p=0;f>p;p++){if(c=g[p],d=c.getLength(),c instanceof Yb.LineCurve3){var l=j/i,m=(d+j)/i;h.push(l),h.push(m)}else for(e=p>0?1:0;k>=e;e++){var n=(d*e/k+j)/i;h.push(n)}j+=d}for(var o=[],p=0;p<h.length;p++)b=h[p],pos=a.getPointAt(b),o.push(pos);return this.vertices=o,[]}}}),Yb.Polyhedron=function(){function a(a){var b=a.normalize().clone();b.index=k.vertices.push(b)-1;var c=d(a)/2/Math.PI+.5,f=e(a)/Math.PI+.5;return b.uv=new Yb.Vec3(c,1-f),b}function b(a,b,c){var e=new Yb.Face3(a.index,b.index,c.index,[a.clone(),b.clone(),c.clone()]);e.centroid.add(a).add(b).add(c).divideScalar(3),k.faces.push(e);var g=d(e.centroid);k.uvs.push([f(a.uv,a,g),f(b.uv,b,g),f(c.uv,c,g)])}function c(c,d){for(var e=Math.pow(2,d),f=(Math.pow(4,d),a(k.vertices[c.a])),g=a(k.vertices[c.b]),h=a(k.vertices[c.c]),i=[],j=0;e>=j;j++){i[j]=[];for(var l=a(f.clone().lerp(h,j/e)),m=a(g.clone().lerp(h,j/e)),n=e-j,o=0;n>=o;o++)0==o&&j==e?i[j][o]=l:i[j][o]=a(l.clone().lerp(m,o/n))}for(var j=0;e>j;j++)for(var o=0;2*(e-j)-1>o;o++){var p=Math.floor(o/2);o%2==0?b(i[j][p+1],i[j+1][p],i[j][p]):b(i[j][p+1],i[j+1][p+1],i[j+1][p])}}function d(a){return Math.atan2(a.z,-a.x)}function e(a){return Math.atan2(-a.y,Math.sqrt(a.x*a.x+a.z*a.z))}function f(a,b,c){return 0>c&&1===a.x&&(a=new Yb.Vec3(a.x-1,a.y)),0===b.x&&0===b.z&&(a=new Yb.Vec3(c/2/Math.PI+.5,a.y)),a.clone()}var g,h,i,j;arguments[0]instanceof Yb.Material?(this.material=arguments[0],g=arguments[1],h=arguments[2],i=arguments[3],j=arguments[4]):(g=arguments[0],h=arguments[1],i=arguments[2],j=arguments[3]),this.materialSize=1,Yb.Entity.call(this),i=i||1,j=j||0;for(var k=this,l=0,m=g.length;m>l;l++)a(new Yb.Vec3(g[l][0],g[l][1],g[l][2]));for(var n=this.vertices,o=[],l=0,m=h.length;m>l;l++){var p=n[h[l][0]],q=n[h[l][1]],r=n[h[l][2]];o[l]=new Yb.Face3(p.index,q.index,r.index,[p.clone(),q.clone(),r.clone()])}for(var l=0,m=o.length;m>l;l++)c(o[l],j);for(var l=0,m=this.uvs.length;m>l;l++){var s=this.uvs[l],t=s[0].x,u=s[1].x,v=s[2].x,w=Math.max(t,Math.max(u,v)),x=Math.min(t,Math.min(u,v));w>.9&&.1>x&&(.2>t&&(s[0].x+=1),.2>u&&(s[1].x+=1),.2>v&&(s[2].x+=1))}for(var l=0,m=this.vertices.length;m>l;l++)this.vertices[l].multiplyScalar(i);this.mergeVertices(),this.computeCentroids(),this.computeFaceNormals(),this.boundingSphere=new Yb.BoundingSphere(new Yb.Vec3,i)},Yb.extend(Yb.Polyhedron,Yb.Entity,{}),Yb.Octahedron=function(a,b,c){var d=[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],e=[[0,2,4],[0,4,3],[0,3,5],[0,5,2],[1,2,5],[1,5,3],[1,3,4],[1,4,2]];Yb.Polyhedron.call(this,a,d,e,b,c)},Yb.extend(Yb.Octahedron,Yb.Polyhedron,{clone:function(){return new Yb.Octahedron(this.material,this.radius,this.detail)}}),Yb.Axis=function(a){a=a||1;var b=[],c=[];b.push(new Yb.Vec3,new Yb.Vec3(a,0,0),new Yb.Vec3,new Yb.Vec3(0,a,0),new Yb.Vec3,new Yb.Vec3(0,0,a)),c.push(new Yb.Color(16711680),new Yb.Color(16711680),new Yb.Color(65280),new Yb.Color(65280),new Yb.Color(255),new Yb.Color(255));var d=new Yb.LineMaterial({vertexColors:Yb.VertexColors,depthTest:!1,depthMask:!1});Yb.Line.call(this,b,c,Yb.LinePieces),this.material=d,this.xAxisText=this.makeAxisText("X",16711680),this.yAxisText=this.makeAxisText("Y",65280),this.zAxisText=this.makeAxisText("Z",255),this.xAxisText.setParent(this),this.yAxisText.setParent(this),this.zAxisText.setParent(this),this.setSize(a),this._sizeFixed=!0},Yb.extend(Yb.Axis,Yb.Line,{showAxisText:function(a){this.xAxisText._visible=a,this.yAxisText._visible=a,this.zAxisText._visible=a},setSize:function(a){this.vertices[1].x=a,this.vertices[3].y=a,this.vertices[5].z=a,this.xAxisText.setPosition(a,0,0),this.yAxisText.setPosition(0,a,0),this.zAxisText.setPosition(0,0,a)},fixSize:function(a){Yb.Element.prototype.fixSize.call(this,a);this._scale.x,this._scale.y,this._scale.z;this.xAxisText.setScale(3,3,1),this.yAxisText.setScale(3,3,1),this.zAxisText.setScale(3,3,1)},makeAxisText:function(a,b){var c="Arial",d=36,e=Yb.BillboardAlignment.topLeft,f=document.createElement("canvas"),g=f.getContext("2d");g.font="Bold "+d+"px "+c,b instanceof Yb.Color||(b=new Yb.Color(b));var h=g.measureText(a),i=h.width;f.width=sc.nextPowerOfTwo(i),f.height=sc.nextPowerOfTwo(2*g.measureText("e").width+4),g.fillStyle="rgba("+255*b.r+", "+255*b.g+", "+255*b.b+", 1.0)",g.fillText(a,0,10);var j=new Yb.Texture(f),k=new Yb.BillboardMaterial({map:j,useScreenCoordinates:!1,alignment:e,depthTest:!1,depthMask:!1}),l=new Yb.Billboard;return l.material=k,l}}),Yb.Curve=function(){},Yb.Curve.prototype.getPoint=function(a){return console.log("Warning, getPoint() not implemented!"),null},Yb.Curve.prototype.getPointAt=function(a){var b=this.getUtoTmapping(a);return this.getPoint(b)},Yb.Curve.prototype.getPoints=function(a){a||(a=5);var b,c=[];for(b=0;a>=b;b++)c.push(this.getPoint(b/a));return c},Yb.Curve.prototype.getSpacedPoints=function(a){a||(a=5);var b,c=[];for(b=0;a>=b;b++)c.push(this.getPointAt(b/a));return c},Yb.Curve.prototype.getLength=function(){var a=this.getLengths();return a[a.length-1]},Yb.Curve.prototype.getLengths=function(a){if(a||(a=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==a+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var b,c,d=[],e=this.getPoint(0),f=0;for(d.push(0),c=1;a>=c;c++)b=this.getPoint(c/a),f+=b.distanceTo(e),d.push(f),e=b;return this.cacheArcLengths=d,d},Yb.Curve.prototype.updateArcLengths=function(){this.needsUpdate=!0,this.getLengths()},Yb.Curve.prototype.getUtoTmapping=function(a,b){var c,d=this.getLengths(),e=0,f=d.length;c=b?b:a*d[f-1];for(var g,h=0,i=f-1;i>=h;)if(e=Math.floor(h+(i-h)/2),g=d[e]-c,0>g)h=e+1;else{if(!(g>0)){i=e;break}i=e-1}if(e=i,d[e]==c){var j=e/(f-1);return j}var k=d[e],l=d[e+1],m=l-k,n=(c-k)/m,j=(e+n)/(f-1);return j},Yb.Curve.prototype.getTangent=function(a){var b=1e-4,c=a-b,d=a+b;0>c&&(c=0),d>1&&(d=1);var e=this.getPoint(c),f=this.getPoint(d),g=f.clone().sub(e);return g.normalize()},Yb.Curve.prototype.getTangentAt=function(a){var b=this.getUtoTmapping(a);return this.getTangent(b)},Yb.Curve.Utils={tangentQuadraticBezier:function(a,b,c,d){return 2*(1-a)*(c-b)+2*a*(d-c)},tangentCubicBezier:function(a,b,c,d,e){return-3*b*(1-a)*(1-a)+3*c*(1-a)*(1-a)-6*a*c*(1-a)+6*a*d*(1-a)-3*a*a*d+3*a*a*e},tangentSpline:function(a,b,c,d,e){var f=6*a*a-6*a,g=3*a*a-4*a+1,h=-6*a*a+6*a,i=3*a*a-2*a;return f+g+h+i},interpolate:function(a,b,c,d,e){var f=.5*(c-a),g=.5*(d-b),h=e*e,i=e*h;return(2*b-2*c+f+g)*i+(-3*b+3*c-2*f-g)*h+f*e+b}},Yb.Curve.create=function(a,b){return a.prototype=Object.create(Yb.Curve.prototype),a.prototype.getPoint=b,a},Yb.LineCurve=function(a,b){this.v1=a,this.v2=b},Yb.LineCurve.prototype=Object.create(Yb.Curve.prototype),Yb.LineCurve.prototype.getPoint=function(a){var b=this.v2.clone().sub(this.v1);return b.multiplyScalar(a).add(this.v1),b},Yb.LineCurve.prototype.getPointAt=function(a){return this.getPoint(a)},Yb.LineCurve.prototype.getTangent=function(a){var b=this.v2.clone().sub(this.v1);return b.normalize()},Yb.LineCurve3=function(a,b){this.v1=a,this.v2=b,this.getPoint=function(a){var b=new Yb.Vec3;return b.subVectors(this.v2,this.v1),b.multiplyScalar(a),b.add(this.v1),b}},Yb.extend(Yb.LineCurve3,Yb.Curve,{}),Yb.CurvePath=function(){this.curves=[],this.bends=[],this.autoClose=!1},Yb.CurvePath.prototype=Object.create(Yb.Curve.prototype),Yb.CurvePath.prototype.add=function(a){this.curves.push(a)},Yb.CurvePath.prototype.checkConnection=function(){},Yb.CurvePath.prototype.closePath=function(){var a=this.curves[0].getPoint(0),b=this.curves[this.curves.length-1].getPoint(1);a.equals(b)||this.curves.push(new Yb.LineCurve3(b,a))},Yb.CurvePath.prototype.getPoint=function(a){for(var b,c,d=a*this.getLength(),e=this.getCurveLengths(),f=0;f<e.length;){if(e[f]>=d){b=e[f]-d,c=this.curves[f];var g=1-b/c.getLength();return c.getPointAt(g)}f++}return null},Yb.CurvePath.prototype.getLength=function(){var a=this.getCurveLengths();return a[a.length-1]},Yb.CurvePath.prototype.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var a,b=[],c=0,d=this.curves.length;for(a=0;d>a;a++)c+=this.curves[a].getLength(),b.push(c);return this.cacheLengths=b,b},Yb.CurvePath.prototype.getBoundingBox=function(){var a,b,c,d,e,f,g=this.getPoints();a=b=Number.NEGATIVE_INFINITY,d=e=Number.POSITIVE_INFINITY;var h,i,j,k,l=g[0]instanceof Yb.Vec3;for(k=l?new Yb.Vec3:new Yb.Vec2,i=0,j=g.length;j>i;i++)h=g[i],h.x>a?a=h.x:h.x<d&&(d=h.x),h.y>b?b=h.y:h.y<e&&(e=h.y),l&&(h.z>c?c=h.z:h.z<f&&(f=h.z)),k.add(h);var m={minX:d,minY:e,maxX:a,maxY:b,centroid:k.divideScalar(j)};return l&&(m.maxZ=c,m.minZ=f),m},Yb.CurvePath.prototype.createPointsGeometry=function(a){var b=this.getPoints(a,!0);return this.createGeometry(b)},Yb.CurvePath.prototype.createSpacedPointsGeometry=function(a){var b=this.getSpacedPoints(a,!0);return this.createGeometry(b)},Yb.CurvePath.prototype.createGeometry=function(a){for(var b=new Yb.Entity,c=0;c<a.length;c++)b.vertices.push(new Yb.Vec3(a[c].x,a[c].y,a[c].z||0));return b},Yb.CurvePath.prototype.addWrapPath=function(a){this.bends.push(a)},Yb.CurvePath.prototype.getTransformedPoints=function(a,b){var c,d,e=this.getPoints(a);for(b||(b=this.bends),c=0,d=b.length;d>c;c++)e=this.getWrapPoints(e,b[c]);return e},Yb.CurvePath.prototype.getTransformedSpacedPoints=function(a,b){var c,d,e=this.getSpacedPoints(a);for(b||(b=this.bends),c=0,d=b.length;d>c;c++)e=this.getWrapPoints(e,b[c]);return e},Yb.CurvePath.prototype.getWrapPoints=function(a,b){var c,d,e,f,g,h,i=this.getBoundingBox();for(c=0,d=a.length;d>c;c++){e=a[c],f=e.x,g=e.y,h=f/i.maxX,h=b.getUtoTmapping(h,f);var j=b.getPoint(h),k=b.getTangent(h);k.set(-k.y,k.x).multiplyScalar(g),e.x=j.x+k.x,e.y=j.y+k.y}return a},Yb.EllipseCurve=function(a,b,c,d,e,f,g){this.aX=a,this.aY=b,this.xRadius=c,this.yRadius=d,this.aStartAngle=e||0,this.aEndAngle=f||2*Math.PI,this.aClockwise=g},Yb.EllipseCurve.prototype=Object.create(Yb.Curve.prototype),Yb.EllipseCurve.prototype.getPoint=function(a){var b,c=this.aEndAngle-this.aStartAngle;0>c&&(c+=2*Math.PI),c>2*Math.PI&&(c-=2*Math.PI),b=this.aClockwise===!0?this.aEndAngle+(1-a)*(2*Math.PI-c):this.aStartAngle+a*c;var d=this.aX+this.xRadius*Math.cos(b),e=this.aY+this.yRadius*Math.sin(b);return new Yb.Vec3(d,e,0)},Yb.ArcCurve=function(a,b,c,d,e,f){Yb.EllipseCurve.call(this,a,b,c,c,d,e,f)},Yb.ArcCurve.prototype=Object.create(Yb.EllipseCurve.prototype),Yb.Path=function(a){Yb.CurvePath.call(this),this.actions=[],this.points=[],a&&this.fromPoints(a)},Yb.extend(Yb.Path,Yb.CurvePath,{constructor:Yb.Path,className:"TGL.Path",serializeJsonValue:function(){return{actions:this.actions,"class":"TGL.Path"}},deserializeJsonValue:function(a){var b,c,d,e;for(e=0;e<a.actions.length;e++)c=a.actions[e],b=c.action,d=c.args,this[b].apply(this,d)}}),Yb.PathActions={MOVE_TO:"moveTo",LINE_TO:"lineTo",QUADRATIC_CURVE_TO:"curveTo",BEZIER_CURVE_TO:"bCurveTo",CSPLINE_THRU:"splineThru",ARC:"arc",ELLIPSE:"ellipse"},Yb.Path.prototype.fromPoints=function(a){this.moveTo(a[0].x,a[0].y,a[0].z);for(var b=1,c=a.length;c>b;b++)this.lineTo(a[b].x,a[b].y,a[b].z)},Yb.Path.prototype.closePath=function(){var a=this.curves[0].getPoint(0),b=this.curves[this.curves.length-1].getPoint(1);a.equals(b)||this.lineTo(a.x,a.y,a.z)},Yb.Path.prototype.reverse=function(){var a,b,c,d,e,f=new Yb.Path,g=this.actions.length;for(a=g-1;a>=0;a--){if(b=this.actions[a].args,c=b.length,a===g-1&&f.moveTo(b[c-3],b[c-2],b[c-1]),null!=d)switch(e){case Yb.PathActions.MOVE_TO:f.moveTo(b[c-3],b[c-2],b[c-1]);break;case Yb.PathActions.LINE_TO:f.lineTo(b[c-3],b[c-2],b[c-1]);break;case Yb.PathActions.QUADRATIC_CURVE_TO:f.quadraticCurveTo(d[0],d[1],d[2],b[c-3],b[c-2],b[c-1]);break;case Yb.PathActions.BEZIER_CURVE_TO:f.bezierCurveTo(d[3],d[4],d[5],d[0],d[1],d[2],b[c-3],b[c-2],b[c-1])}d=b,e=this.actions[a].action}return f},Yb.Path.prototype.moveTo=function(a,b,c){a=a||0,b=b||0,c=c||0;var d=Array.prototype.slice.call(arguments);this.actions.push({action:Yb.PathActions.MOVE_TO,args:d}),this.points.push(new $b(a,b,c))},Yb.Path.prototype.lineTo=function(a,b,c){if(a=a||0,b=b||0,c=c||0,this.actions&&1===this.actions.length){var d=this.actions[0].args;d[0]===a&&d[1]===b&&d[2]===c&&(console.log("TGL.Path:lineTo the same point of moveTo"),a+=.01)}var d=Array.prototype.slice.call(arguments),e=this.actions[this.actions.length-1].args,f=e[e.length-3],g=e[e.length-2],h=e[e.length-1],i=new Yb.LineCurve3(new Yb.Vec3(f,g,h),new Yb.Vec3(a,b,c));this.curves.push(i),this.actions.push({action:Yb.PathActions.LINE_TO,args:d}),this.points.push(new $b(a,b,c))},Yb.Path.prototype.quadraticCurveTo=function(a,b,c,d,e,f){if(a=a||0,b=b||0,c=c||0,d=d||0,e=e||0,f=f||0,this.actions&&1===this.actions.length){var g=this.actions[0].args;g[0]===d&&g[1]===e&&g[2]===f&&(console.log("TGL.Path:quadraticCurveTo the same point of moveTo"),d=.01)}var g=Array.prototype.slice.call(arguments),h=this.actions[this.actions.length-1].args,i=h[h.length-3],j=h[h.length-2],k=h[h.length-1],l=new Yb.QuadraticBezierCurve3(new Yb.Vec3(i,j,k),new Yb.Vec3(a,b,c),new Yb.Vec3(d,e,f));this.curves.push(l),this.actions.push({action:Yb.PathActions.QUADRATIC_CURVE_TO,args:g}),this.points.push(new $b(d,e,f))},Yb.Path.prototype.curveTo=Yb.Path.prototype.quadraticCurveTo,Yb.Path.prototype.bezierCurveTo=function(a,b,c,d,e,f,g,h,i){var j=Array.prototype.slice.call(arguments),k=this.actions[this.actions.length-1].args,l=k[k.length-3],m=k[k.length-2],n=k[k.length-1],o=new Yb.CubicBezierCurve3(new Yb.Vec3(l,m,n),new Yb.Vec3(a,b,c),new Yb.Vec3(d,e,f),new Yb.Vec3(g,h,i));this.curves.push(o),this.actions.push({action:Yb.PathActions.BEZIER_CURVE_TO,args:j}),this.points.push(new $b(g,h,i))},Yb.Path.prototype.isClockwise=function(){if(this.points.length<2)return e;if(this.points.length<3){var a=this.points[0],b=this.points[1];return b.x>a.x}return Yb.Math.isClockwise(this.points)},Yb.Path.prototype.bCurveTo=Yb.Path.prototype.bezierCurveTo,Yb.Path.prototype.splineThru=function(a){var b=Array.prototype.slice.call(arguments),c=this.actions[this.actions.length-1].args,d=c[c.length-2],e=c[c.length-1],f=[new Yb.Vec2(d,e)];Array.prototype.push.apply(f,a);var g=new Yb.SplineCurve(f);this.curves.push(g),this.actions.push({action:Yb.PathActions.CSPLINE_THRU,args:b})},Yb.Path.prototype.arc=function(a,b,c,d,e,f){var g=this.actions[this.actions.length-1].args,h=g[g.length-2],i=g[g.length-1];this.absarc(a+h,b+i,c,d,e,f)},Yb.Path.prototype.absarc=function(a,b,c,d,e,f){this.absellipse(a,b,c,c,d,e,f)},Yb.Path.prototype.ellipse=function(a,b,c,d,e,f,g){var h=this.actions[this.actions.length-1].args,i=h[h.length-2],j=h[h.length-1];this.absellipse(a+i,b+j,c,d,e,f,g)},Yb.Path.prototype.absellipse=function(a,b,c,d,e,f,g){var h=Array.prototype.slice.call(arguments),i=new Yb.EllipseCurve(a,b,c,d,e,f,g);this.curves.push(i);var j=i.getPoint(1);h.push(j.x),h.push(j.y),this.actions.push({action:Yb.PathActions.ELLIPSE,args:h})},Yb.Path.prototype.toArray=function(){var a,b=this.actions.length,c=[];for(a=0;b>a;a++){var d=this.actions[a];"moveTo"===d.action?(c.push("m"),c.push(d.args[0]),c.push(d.args[1]),c.push(d.args[2])):"lineTo"===d.action?(c.push("l"),c.push(d.args[0]),c.push(d.args[1]),c.push(d.args[2])):"curveTo"===d.action&&(c.push("c"),c.push(d.args[0]),c.push(d.args[1]),c.push(d.args[2]),c.push(d.args[3]),c.push(d.args[4]),c.push(d.args[5]))}return c},Yb.Path.prototype.getSpacedPoints=function(a,b){a||(a=40);for(var c=[],d=0;a>d;d++)c.push(this.getPoint(d/a));return c},Yb.Path.prototype.getPoints=function(a,b){if(this.useSpacedPoints)return console.log("tata"),this.getSpacedPoints(a,b);a=a||12;var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y=[];for(c=0,d=this.actions.length;d>c;c++)switch(e=this.actions[c],f=e.action,g=e.args,f){case Yb.PathActions.MOVE_TO:y.push(new Yb.Vec3(g[0],g[1],g[2]));break;case Yb.PathActions.LINE_TO:y.push(new Yb.Vec3(g[0],g[1],g[2]));break;case Yb.PathActions.QUADRATIC_CURVE_TO:for(h=g[3],i=g[4],j=g[5],n=g[0],o=g[1],p=g[2],y.length>0?(t=y[y.length-1],q=t.x,r=t.y,s=t.z):(t=this.actions[c-1].args,q=t[t.length-3],r=t[t.length-2],s=t[t.length-1]),u=1;a>=u;u++)v=u/a,w=Yb.Shape.Utils.b2(v,q,n,h),x=Yb.Shape.Utils.b2(v,r,o,i),tz=Yb.Shape.Utils.b2(v,s,p,j),y.push(new Yb.Vec3(w,x,tz));break;case Yb.PathActions.BEZIER_CURVE_TO:for(h=g[6],i=g[7],j=g[8],n=g[0],o=g[1],p=g[2],k=g[3],l=g[4],m=g[5],y.length>0?(t=y[y.length-1],q=t.x,r=t.y,s=t.z):(t=this.actions[c-1].args,q=t[t.length-3],r=t[t.length-2],s=t[t.length-1]),u=1;a>=u;u++)v=u/a,w=Yb.Shape.Utils.b3(v,q,n,k,h),x=Yb.Shape.Utils.b3(v,r,o,l,i),tz=Yb.Shape.Utils.b3(v,s,p,m,j),y.push(new Yb.Vec3(w,x,tz));break;case Yb.PathActions.CSPLINE_THRU:t=this.actions[c-1].args;var z=new Yb.Vec2(t[t.length-2],t[t.length-1]),A=[z],B=a*g[0].length;A=A.concat(g[0]);var C=new Yb.SplineCurve(A);for(u=1;B>=u;u++)y.push(C.getPointAt(u/B));break;case Yb.PathActions.ARC:var D,E=g[0],F=g[1],G=g[2],H=g[3],I=g[4],J=!!g[5],K=I-H,L=2*a;for(u=1;L>=u;u++)v=u/L,J||(v=1-v),D=H+v*K,w=E+G*Math.cos(D),x=F+G*Math.sin(D),y.push(new Yb.Vec3(w,x));break;case Yb.PathActions.ELLIPSE:var D,E=g[0],F=g[1],M=g[2],N=g[3],H=g[4],I=g[5],J=!!g[6],K=I-H,L=2*a;for(u=1;L>=u;u++)v=u/L,J||(v=1-v),D=H+v*K,w=E+M*Math.cos(D),x=F+N*Math.sin(D),y.push(new Yb.Vec3(w,x))}var O=y[y.length-1],P=1e-10;return Math.abs(O.x-y[0].x)<P&&Math.abs(O.y-y[0].y)<P&&y.splice(y.length-1,1),b&&y.push(y[0]),y},Yb.Path.prototype.toShapes=function(a){var b,c,d,f,g,h=[],i=new Yb.Path;for(b=0,c=this.actions.length;c>b;b++)d=this.actions[b],g=d.args,f=d.action,f==Yb.PathActions.MOVE_TO&&0!=i.actions.length&&(h.push(i),i=new Yb.Path),i[f].apply(i,g);if(0!=i.actions.length&&h.push(i),0==h.length)return[];var j,k,l,m=[];if(1==h.length)return k=h[0],l=new Yb.Shape,l.actions=k.actions,l.curves=k.curves,m.push(l),m;var n=!Yb.Shape.Utils.isClockWise(h[0].getPoints());if(n=a?!n:n)for(l=new Yb.Shape,b=0,c=h.length;c>b;b++)k=h[b],j=Yb.Shape.Utils.isClockWise(k.getPoints()),j=a?!j:j,j?(l.actions=k.actions,l.curves=k.curves,m.push(l),l=new Yb.Shape):l.holes.push(k);else{for(l=e,b=0,c=h.length;c>b;b++)k=h[b],j=Yb.Shape.Utils.isClockWise(k.getPoints()),j=a?!j:j,j?(l&&m.push(l),l=new Yb.Shape,l.actions=k.actions,l.curves=k.curves):l.holes.push(k);m.push(l)}return m},Yb.Shape=function(){Yb.Path.apply(this,arguments),this.holes=[]},Yb.Shape.prototype=Object.create(Yb.Path.prototype),Yb.Shape.prototype.extrude=function(a){var b=new Yb.ShapeNode(this,a);return b},Yb.Shape.prototype.makeGeometry=function(a){var b=new Yb.ShapeGeometry(this,a);return b},Yb.Shape.prototype.getPointsHoles=function(a){var b,c=this.holes.length,d=[];for(b=0;c>b;b++)d[b]=this.holes[b].getTransformedPoints(a,this.bends);return d},Yb.Shape.prototype.getSpacedPointsHoles=function(a){var b,c=this.holes.length,d=[];for(b=0;c>b;b++)d[b]=this.holes[b].getTransformedSpacedPoints(a,this.bends);return d},Yb.Shape.prototype.extractAllPoints=function(a){return{shape:this.getTransformedPoints(a),holes:this.getPointsHoles(a)}},Yb.Shape.prototype.extractPoints=function(a){return this.useSpacedPoints?this.extractAllSpacedPoints(a):this.extractAllPoints(a)},Yb.Shape.prototype.extractAllSpacedPoints=function(a){return{shape:this.getTransformedSpacedPoints(a),holes:this.getSpacedPointsHoles(a)}},Yb.Shape.Utils={removeHoles:function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s=a.concat(),t=s.concat(),u=[];for(g=0;g<b.length;g++){for(i=b[g],Array.prototype.push.apply(t,i),j=Number.POSITIVE_INFINITY,h=0;h<i.length;h++){m=i[h];var v=[];for(l=0;l<s.length;l++)n=s[l],k=m.distanceToSquared(n),v.push(k),j>k&&(j=k,e=h,f=l)}c=f-1>=0?f-1:s.length-1,d=e-1>=0?e-1:i.length-1;var w=[i[e],s[f],s[c]],x=Yb.FontUtils.Triangulate.area(w),y=[i[e],i[d],s[f]],z=Yb.FontUtils.Triangulate.area(y),A=1,B=-1,C=f,D=e;f+=A,e+=B,0>f&&(f+=s.length),f%=s.length,0>e&&(e+=i.length),e%=i.length,c=f-1>=0?f-1:s.length-1,d=e-1>=0?e-1:i.length-1,w=[i[e],s[f],s[c]];var E=Yb.FontUtils.Triangulate.area(w);y=[i[e],i[d],s[f]];var F=Yb.FontUtils.Triangulate.area(y);x+z>E+F&&(f=C,e=D,0>f&&(f+=s.length),f%=s.length,0>e&&(e+=i.length),e%=i.length,c=f-1>=0?f-1:s.length-1,d=e-1>=0?e-1:i.length-1),o=s.slice(0,f),p=s.slice(f),q=i.slice(e),r=i.slice(0,e);var G=[i[e],s[f],s[c]],H=[i[e],i[d],s[f]];u.push(G),u.push(H),s=o.concat(q).concat(r).concat(p)}return{shape:s,isolatedPts:u,allpoints:t}},triangulateShape:function(a,b){var c,d,f,g,h,i,j=Yb.Shape.Utils.removeHoles(a,b),k=j.shape,l=j.allpoints,m=j.isolatedPts,n=Yb.FontUtils.Triangulate(k,!1),o={};for(c=0,d=l.length;d>c;c++)h=l[c].x+":"+l[c].y,o[h]!==e&&console.log("Duplicate point",h),o[h]=c;for(c=0,d=n.length;d>c;c++)for(g=n[c],f=0;3>f;f++)h=g[f].x+":"+g[f].y,i=o[h],i!==e&&(g[f]=i);for(c=0,d=m.length;d>c;c++)for(g=m[c],f=0;3>f;f++)h=g[f].x+":"+g[f].y,i=o[h],i!==e&&(g[f]=i);return n.concat(m)},isClockWise:function(a){return Yb.FontUtils.Triangulate.area(a)<0},b2p0:function(a,b){var c=1-a;return c*c*b},b2p1:function(a,b){return 2*(1-a)*a*b},b2p2:function(a,b){return a*a*b},b2:function(a,b,c,d){return this.b2p0(a,b)+this.b2p1(a,c)+this.b2p2(a,d)},b3p0:function(a,b){var c=1-a;return c*c*c*b},b3p1:function(a,b){var c=1-a;return 3*c*c*a*b},b3p2:function(a,b){var c=1-a;return 3*c*a*a*b},b3p3:function(a,b){return a*a*a*b},b3:function(a,b,c,d,e){return this.b3p0(a,b)+this.b3p1(a,c)+this.b3p2(a,d)+this.b3p3(a,e)}},Yb.CubicBezierCurve3=Yb.Curve.create(function(a,b,c,d){this.v0=a,this.v1=b,this.v2=c,this.v3=d},function(a){var b,c,d;return b=Yb.Shape.Utils.b3(a,this.v0.x,this.v1.x,this.v2.x,this.v3.x),c=Yb.Shape.Utils.b3(a,this.v0.y,this.v1.y,this.v2.y,this.v3.y),d=Yb.Shape.Utils.b3(a,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new Yb.Vec3(b,c,d)}),Yb.QuadraticBezierCurve3=Yb.Curve.create(function(a,b,c){this.v0=a,this.v1=b,this.v2=c},function(a){var b,c,d;return b=Yb.Shape.Utils.b2(a,this.v0.x,this.v1.x,this.v2.x),c=Yb.Shape.Utils.b2(a,this.v0.y,this.v1.y,this.v2.y),d=Yb.Shape.Utils.b2(a,this.v0.z,this.v1.z,this.v2.z),new Yb.Vec3(b,c,d)}),Yb.PathNode=function(a,b,c,d,f,g,h,i,j,k){this.materialSize=1,this.closed=!1;var l;1===arguments.length&&arguments[0]instanceof Object&&!(arguments[0]instanceof Yb.Path)?(l=arguments[0],this.path=l.path,this.segments=l.segments||20,this.radius=l.radius||1,this.segmentsR=l.segmentsR||8,this.shape=l.shape,this.startCap=l.startCap||"plain",this.endCap=l.endCap||"plain",this.arc=l.arc!=e?l.arc:2*Math.PI,this.arcStart=l.arcStart!=e?l.arcStart:0,this.cutSurface=l.cutSurface||"none",this.startCapR=l.startCapR,this.endCapR=l.endCapR,this.startCapSize=l.startCapSize,this.endCapSize=l.endCapSize,this.binormal=l.binormal,this.startCapExtend=l.startCapExtend===e?1:l.startCapExtend,this.endCapExtend=l.endCapExtend===e?1:l.endCapExtend,this._id=l.id):(this.path=a,this.segments=b||20,this.radius=c||1,this.segmentsR=d||8,this.shape=h,this.startCap=f||"plain",this.endCap=g||"plain",this.arc=i!=e?i:2*Math.PI,this.arcStart=j!=e?j:0,this.cutSurface=k||"none"),this.shape instanceof Array&&(this.segmentsR=this.shape.length),this.startCapSize=this.startCapSize||1,this.endCapSize=this.endCapSize||1,this.segmentsCap=20,this.arc===2*Math.PI&&(this.cutSurface="none"),Yb.Entity.call(this),this.computeCentroids(),this.computeFaceNormals()},Yb.extend(Yb.PathNode,Yb.Entity,{constructor:Yb.PathNode,className:"TGL.PathNode",__accessor:["path","segments","radius","segmentsR","startCap","endCap","shape","startCapSize","endCapSize","segmentsCap","arc","arcStart","cutSurface","startCapR","endCapR","startCapExtend","endCapExtend","binormal"],__SizePropeties:["path","segments","radius","segmentsR","startCap","endCap","shape","startCapSize","endCapSize","segmentsCap","arc","arcStart","cutSurface","startCapR","endCapR","startCapExtend","endCapExtend","binormal"],getCrossSectionPoint:function(){},needComputeVertexNormal:function(){return!0},adjustPath:function(a,b,c){b=b||this.radius,c=c||this._adjustTimes||2;var d,e,f,g,h,i,j,k,l,m,n,o,p=new Yb.Path,q=new $b,r=new $b,s=new $b,t=new $b,u=a.actions.length;for(o=0;u>o;o++)if(f=a.actions[o],h=o+1===u?null:a.actions[o+1],g=f.args,"moveTo"===f.action)p.moveTo(g[0],g[1],g[2]);else if("lineTo"===f.action)if(h&&"lineTo"===h.action){if(d=a.actions[o-1],e=d.args,i=h.args,j=new $b(e[0],e[1],e[2]),k=new $b(g[0],g[1],g[2]),l=new $b(i[0],i[1],i[2]),q.subVectors(k,j),r.subVectors(k,l),0==r.length()){a.actions.splice(o,1),o-=1,u-=1;continue}m=q.angleTo(r),n=Math.min(q.length()/2,r.length()/2),n=Math.min(b*c,n),s.addVectors(k,q.normalize().multiplyScalar(-n)),t.addVectors(k,r.normalize().multiplyScalar(-n)),p.lineTo(s.x,s.y,s.z),p.curveTo(k.x,k.y,k.z,t.x,t.y,t.z)}else p.lineTo(g[0],g[1],g[2]);else"quadraticCurveTo"===f.action&&p.curveTo(g[0],g[1],g[2],g[3],g[4],g[5]);return p},_resetPath:function(){return this.path},getPointAt:function(a){return this._realPath?this._realPath.getPoint(a):null},getTangentAt:function(a){if(this._realPath){var b=this._realPath.getPoint(a),c=this._realPath.getPoint(a-.001);return b.sub(c).normalize()}return null},computeData:function(){function a(a,b,c,d){return d.vertices.push(new Yb.Vec3(a,b,c))-1}this.grid=[],this.startGrid=[],this.endGrid=[];var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v=this.segmentsCap,w=new Yb.Vec3,x={};if(x.faces=[],x.uvs=[],x.vertices=[],null==this.path)return x;var y=this._resetPath(),z=this.startCap,A=this.endCap,B=this.cutSurface;this._realPath=y,1==this._autoAjust&&(y=this.adjustPath(y));var p,C,k,D=y.curves.length,E=y.curves,F=[],G=y.getLength(),H=0,I=this.segments;for(j=0;D>j;j++){if(p=E[j],C=p.getLength(),p instanceof Yb.LineCurve3){var J=(.001*C+H)/G,K=(.999*C+H)/G;F.push(J),F.push(K)}else{var L=.998*C;for(k=0;I>=k;k++){var M=(.001*C+L*k/I+H)/G;F.push(M)}}H+=C}var N=this.frenetFrames(y,F,this.closed,this.binormal),O=N.tangents,P=N.normals,Q=N.binormals;this.tangents=O,this.normals=P,this.binormals=Q;var R,S=0,T=F.length-1,U=T+1,V=0,W=0;for(j=0;U>j;j++){if(this.grid[j]=[],e=F[j],i=y.getPointAt(e),b=O[j],c=P[j],d=Q[j],"none"!==z&&0===j)if("round"===z||"arrow"===z){var X,Y;V+=this.radius*this.startCapSize;for(var Z=i.clone().add(b.clone().multiplyScalar(-this.radius*this.startCapSize)),$=0;v>=$;$++){this.startGrid[$]=[];var _=$/v*Math.PI/2;X="round"===z?Z.clone().add(b.clone().multiplyScalar(this.radius*this.startCapSize*(1-Math.cos(_)))):Z.clone().add(b.clone().multiplyScalar(this.radius*this.startCapSize*$/v));
for(var k=0;k<this.segmentsR;k++)f=k/this.segmentsR*this.arc+this.arcStart,"round"===z?(g=-this.radius*Math.cos(f)*Math.sin(_),h=this.radius*Math.sin(f)*Math.sin(_)):(g=-this.radius*Math.cos(f)*$/v,h=this.radius*Math.sin(f)*$/v,g*=this.startCapR||1.3,h*=this.startCapR||1.3),Y=X.clone(),Y.x+=g*c.x+h*d.x,Y.y+=g*c.y+h*d.y,Y.z+=g*c.z+h*d.z,this.startGrid[$][k]=x.vertices.push(Y)-1;"center"===B&&(this.startGrid[$][this.segmentsR]=x.vertices.push(X.clone())-1)}}else S=x.vertices.push(i);for(k=0;k<this.segmentsR;k++){if(R=k/(this.segmentsR-1),this.shape instanceof Array)g=-this.shape[k].x,h=this.shape[k].y;else if(this.shape instanceof Yb.Path){var aa=this.shape.getPointAt(R);g=-aa.x,h=-aa.y}else f=k/this.segmentsR*this.arc+this.arcStart,g=-this.radius*Math.cos(f),h=this.radius*Math.sin(f);w.copy(i),w.x+=g*c.x+h*d.x,w.y+=g*c.y+h*d.y,w.z+=g*c.z+h*d.z,this.grid[j][k]=a(w.x,w.y,w.z,x)}if("center"===B&&(this.grid[j][this.segmentsR]=x.vertices.push(i.clone())-1),"none"!==A&&j===U-1)if("round"===A||"arrow"===A){W+=this.radius*this.endCapSize;for(var X,Y,Z=i.clone().add(b.clone().multiplyScalar(this.radius*this.endCapSize)),$=0;v>=$;$++){this.endGrid[$]=[];var _=(1-$/v)*Math.PI/2;X="round"===A?Z.clone().add(b.clone().multiplyScalar(-this.radius*this.endCapSize*(1-Math.cos(_)))):Z.clone().add(b.clone().multiplyScalar(-this.radius*this.endCapSize*(1-$/v)));for(var k=0;k<this.segmentsR;k++)f=k/this.segmentsR*this.arc+this.arcStart,"round"===A?(g=-this.radius*Math.cos(f)*Math.sin(_),h=this.radius*Math.sin(f)*Math.sin(_)):(g=-this.radius*Math.cos(f)*(1-$/v),h=this.radius*Math.sin(f)*(1-$/v),g*=this.endCapR||1.3,h*=this.endCapR||1.3),Y=X.clone(),Y.x+=g*c.x+h*d.x,Y.y+=g*c.y+h*d.y,Y.z+=g*c.z+h*d.z,this.endGrid[$][k]=x.vertices.push(Y)-1;"center"===B&&(this.endGrid[$][this.segmentsR]=x.vertices.push(X)-1)}}else x.vertices.push(i)}var ba=this.segmentsR,ca=this.segmentsR;this.arc!==2*Math.PI&&("center"===B?(ba++,ca++):"none"===B&&ba--);var da=this.arc/Math.PI/2,ea=y.getLength(),fa=ea+V+W,ga=0,ha=V/fa,ia=ha,ja=ea/fa,ka=ha+ja,la=W/fa;if("none"!==z)if("plain"===z)for(n=0,k=0;k<this.segmentsR;k++){m=(k+1)%this.segmentsR,o=this.grid[0][k],p=this.grid[0][m],x.faces.push(new Yb.Face3(n,o,p)),f=k/this.segmentsR*2*Math.PI,g=-this.radius*Math.cos(f),h=this.radius*Math.sin(f);var r=new Zb(.5,.5);f=k/this.segmentsR*2*Math.PI,g=-this.radius*Math.cos(f),h=this.radius*Math.sin(f);var s=new Zb((g/this.radius+1)/2,(h/this.radius+1)/2);f=m/this.segmentsR*2*Math.PI,g=-this.radius*Math.cos(f),h=this.radius*Math.sin(f);var t=new Zb((g/this.radius+1)/2,(h/this.radius+1)/2);x.uvs.push([r,s,t])}else for(j=0;v>=j;j++)for(k=0;ba>k;k++){if(l=j+1,m=(k+1)%ca,n=this.startGrid[j][k],l===v+1?(o=this.grid[0][k],p=this.grid[0][m]):(o=this.startGrid[l][k],p=this.startGrid[l][m]),q=this.startGrid[j][m],k>=this.segmentsR-1){var $=this.segmentsR-1,e=$/this.segmentsR*da;ba===this.segmentsR?(r=new Yb.Vec2(j/v*ha+ga,e),s=new Yb.Vec2((j+1)/v*ha+ga,e),t=new Yb.Vec2((j+1)/v*ha+ga,1),u=new Yb.Vec2(j/v*ha+ga,1)):k>this.segmentsR-1?(r=new Yb.Vec2(j/v*ha+ga,(1+e)/2),s=new Yb.Vec2((j+1)/v*ha+ga,(1+e)/2),t=new Yb.Vec2((j+1)/v*ha+ga,1),u=new Yb.Vec2(j/v*ha+ga,1)):(r=new Yb.Vec2(j/v*ha+ga,e),s=new Yb.Vec2((j+1)/v*ha+ga,e),t=new Yb.Vec2((j+1)/v*ha+ga,(1+e)/2),u=new Yb.Vec2(j/v*ha+ga,(1+e)/2))}else r=new Yb.Vec2(j/v*ha+ga,k/this.segmentsR*da),s=new Yb.Vec2((j+1)/v*ha+ga,k/this.segmentsR*da),t=new Yb.Vec2((j+1)/v*ha+ga,(k+1)/this.segmentsR*da),u=new Yb.Vec2(j/v*ha+ga,(k+1)/this.segmentsR*da);0!==j&&(x.faces.push(new Yb.Face3(n,o,q,S-1)),x.uvs.push([r,s,u])),x.faces.push(new Yb.Face3(o,p,q,S-1)),x.uvs.push([s.clone(),t,u.clone()])}for(j=0;T>j;j++)for(k=0;ba>k;k++){if(l=this.closed?(j+1)%T:j+1,m=(k+1)%ca,n=this.grid[j][k],o=this.grid[l][k],p=this.grid[l][m],q=this.grid[j][m],k>=this.segmentsR-1){var $=this.segmentsR-1,e=$/this.segmentsR*da;ba===this.segmentsR?(r=new Yb.Vec2(F[j]*ja+ia,e),s=new Yb.Vec2(F[j+1]*ja+ia,e),t=new Yb.Vec2(F[j+1]*ja+ia,1),u=new Yb.Vec2(F[j]*ja+ia,1)):k>this.segmentsR-1?(r=new Yb.Vec2(F[j]*ja+ia,(e+1)/2),s=new Yb.Vec2(F[j+1]*ja+ia,(e+1)/2),t=new Yb.Vec2(F[j+1]*ja+ia,1),u=new Yb.Vec2(F[j]*ja+ia,1)):(r=new Yb.Vec2(F[j]*ja+ia,e),s=new Yb.Vec2(F[j+1]*ja+ia,e),t=new Yb.Vec2(F[j+1]*ja+ia,(e+1)/2),u=new Yb.Vec2(F[j]*ja+ia,(e+1)/2))}else r=new Yb.Vec2(F[j]*ja+ia,k/this.segmentsR*da),s=new Yb.Vec2(F[j+1]*ja+ia,k/this.segmentsR*da),t=new Yb.Vec2(F[j+1]*ja+ia,(k+1)/this.segmentsR*da),u=new Yb.Vec2(F[j]*ja+ia,(k+1)/this.segmentsR*da);x.faces.push(new Yb.Face3(n,o,q)),x.uvs.push([r,s,u]),x.faces.push(new Yb.Face3(o,p,q)),x.uvs.push([s.clone(),t,u.clone()])}if("none"!==A){n=x.vertices.length-1;var D=this.grid.length;if("plain"===A)for(k=0;k<this.segmentsR;k++){m=(k+1)%this.segmentsR,o=this.grid[D-1][k],p=this.grid[D-1][m],x.faces.push(new Yb.Face3(n,p,o)),f=k/this.segmentsR*2*Math.PI,g=-this.radius*Math.cos(f),h=this.radius*Math.sin(f);var r=new Zb(.5,.5);f=k/this.segmentsR*2*Math.PI,g=-this.radius*Math.cos(f),h=this.radius*Math.sin(f);var s=new Zb((g/this.radius+1)/2,(h/this.radius+1)/2);f=m/this.segmentsR*2*Math.PI,g=-this.radius*Math.cos(f),h=this.radius*Math.sin(f);var t=new Zb((g/this.radius+1)/2,(h/this.radius+1)/2);x.uvs.push([r,t,s])}else for(j=-1;v>j;j++)for(k=0;ba>k;k++){if(l=j+1,m=(k+1)%ca,-1===j?(n=this.grid[D-1][k],q=this.grid[D-1][m]):(n=this.endGrid[j][k],q=this.endGrid[j][m]),o=this.endGrid[l][k],p=this.endGrid[l][m],k>=this.segmentsR-1){var $=this.segmentsR-1,e=$/this.segmentsR*da;ba===this.segmentsR?(r=new Yb.Vec2(j/v*la+ka,e),s=new Yb.Vec2((j+1)/v*la+ka,e),t=new Yb.Vec2((j+1)/v*la+ka,1),u=new Yb.Vec2(j/v*la+ka,1)):k>this.segmentsR-1?(r=new Yb.Vec2(j/v*la+ka,(1+e)/2),s=new Yb.Vec2((j+1)/v*la+ka,(1+e)/2),t=new Yb.Vec2((j+1)/v*la+ka,1),u=new Yb.Vec2(j/v*la+ka,1)):(r=new Yb.Vec2(j/v*la+ka,e),s=new Yb.Vec2((j+1)/v*la+ka,e),t=new Yb.Vec2((j+1)/v*la+ka,(1+e)/2),u=new Yb.Vec2(j/v*la+ka,(1+e)/2))}else r=new Yb.Vec2(j/v*la+ka,k/this.segmentsR*da),s=new Yb.Vec2((j+1)/v*la+ka,k/this.segmentsR*da),t=new Yb.Vec2((j+1)/v*la+ka,(k+1)/this.segmentsR*da),u=new Yb.Vec2(j/v*la+ka,(k+1)/this.segmentsR*da);x.faces.push(new Yb.Face3(n,o,q)),x.uvs.push([r,s,u]),x.faces.push(new Yb.Face3(o,p,q)),x.uvs.push([s.clone(),t,u.clone()])}}return x},frenetFrames:function(a,b,c,d){function e(){p[0]=new Yb.Vec3,q[0]=new Yb.Vec3,g=Number.MAX_VALUE,h=Math.abs(o[0].x),i=Math.abs(o[0].y),j=Math.abs(o[0].z),g>=i&&(g=i,n.set(0,1,0)),g>=h&&(g=h,n.set(1,0,0)),g>=j&&n.set(0,0,1),d&&(n=d.clone()),r.crossVectors(o[0],n).normalize(),p[0].crossVectors(o[0],r),q[0].crossVectors(o[0],p[0])}var f,g,h,i,j,k,l,m,n=(new Yb.Vec3,new Yb.Vec3),o=(new Yb.Vec3,[]),p=[],q=[],r=new Yb.Vec3,s=new Yb.Mat4,t=b.length-1,u=t+1,v=1e-4,w=[];for(w.tangents=o,w.normals=p,w.binormals=q,k=0;u>k;k++){l=b[k];var m=a.getTangentAt(l);o[k]=new Yb.Vec3(m.x,m.y,m.z?m.z:0),o[k].normalize()}for(e(),k=1;u>k;k++)p[k]=p[k-1].clone(),q[k]=q[k-1].clone(),r.crossVectors(o[k-1],o[k]),r.length()>v&&(r.normalize(),f=Math.acos(Yb.Math.clamp(o[k-1].dot(o[k]),-1,1)),p[k].applyMatrix4(s.makeRotationAxis(r,f))),q[k].crossVectors(o[k],p[k]);if(c)for(f=Math.acos(Yb.Math.clamp(p[0].dot(p[u-1]),-1,1)),f/=u-1,o[0].dot(r.crossVectors(p[0],p[u-1]))>0&&(f=-f),k=1;u>k;k++)p[k].applyMatrix4(s.makeRotationAxis(o[k],f*k)),q[k].crossVectors(o[k],p[k]);return w}}),Yb.PathCube=function(a,b,c,d,e){var f;1===arguments.length&&arguments[0]instanceof Object&&!(arguments[0]instanceof Yb.Path)?(f=arguments[0],this.path=f.path,this.width=f.width||50,this.height=f.height||100,this.curveSegements=f.curveSegements||32,this.repeat=f.repeat||20,this._id=f.id):(this.path=a,this.width=b||50,this.height=c||100,this.curveSegements=d||32,this.repeat=e||20),this.materialSize=6,Yb.Entity.call(this),this.computeCentroids(),this.computeFaceNormals()},Yb.PathCube.SideIndexMapping={bottom:0,outside:1,inside:2,top:3,aside:4,zside:5},Yb.extend(Yb.PathCube,Yb.Entity,{__accessor:["path","width","height","curveSegements","repeat"],__SizePropeties:["path","width","height","curveSegements","repeat"],constructor:Yb.PathCube,className:"TGL.PathCube",getSideIndexMapping:function(){return Yb.PathCube.SideIndexMapping},computeData:function(){var a={};if(a.vertices=[],a.faces=[],a.uvs=[],a.uv2s=[],null==this.path)return a;var b,c=this.computePoints(this.path,this.width,this.curveSegements),d=c[0],e=c[1],f=d.length,g=c[2],h=this.height,i=this.repeat,j=[],k=[],l=[],m=[],n=this.path.isClockwise();for(this.innerPoints=this.clonePoints(d),this.outerPoints=this.clonePoints(e),b=0;f>b;b++)this.exchangeYZ(d[b]),this.exchangeYZ(e[b]),j[b]=a.vertices.push(d[b])-1,k[b]=a.vertices.push(e[b])-1,l[b]=a.vertices.push(d[b].clone().setY(h))-1,m[b]=a.vertices.push(e[b].clone().setY(h))-1;var o=g?f:f-1;for(b=0;o>b;b++)this.generateTop(a,b,f,l,m,!0,i),this.generateBottom(a,b,f,j,k,i),this.generateSideWall(a,b,f,m,k,!0,i,n),this.generateSideWall(a,b,f,l,j,!1,i,n);return g||(this.generateEnd(a,l,j,k,m,i,!0),this.generateEnd(a,l,j,k,m,i,!1)),this.clockwise=n,a},clonePoints:function(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c].clone());return b},getInsidePoints:function(){var a=[];return a=this.clockwise?this.innerPoints:this.outerPoints},generateEnd:function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,t,w,x,y,z,A=g?0:c.length-1;h=b[A],i=c[A],j=d[A],k=e[A],w=a.vertices[h],x=a.vertices[i],y=a.vertices[j],z=a.vertices[k],l=w.x,m=w.y,n=w.z,o=x.x,p=x.y,q=x.z,r=y.x,s=y.y,t=y.z,u=z.x,v=z.y,dz=z.z;var B=Math.abs(n-t),C=Math.abs(l-r);g?(a.faces.push(new Yb.Face3(h,i,k,null,null,4)),C>B?a.uvs.push([new Yb.Vec2(l/f,m/f),new Yb.Vec2(o/f,p/f),new Yb.Vec2(u/f,v/f)]):a.uvs.push([new Yb.Vec2(n/f,m/f),new Yb.Vec2(q/f,p/f),new Yb.Vec2(dz/f,v/f)]),a.uv2s.push([new Zb(0,1),new Zb(0,0),new Zb(1,1)]),a.faces.push(new Yb.Face3(i,j,k,null,null,4)),C>B?a.uvs.push([new Yb.Vec2(o/f,p/f),new Yb.Vec2(r/f,s/f),new Yb.Vec2(u/f,v/f)]):a.uvs.push([new Yb.Vec2(q/f,p/f),new Yb.Vec2(t/f,s/f),new Yb.Vec2(dz/f,v/f)]),a.uv2s.push([new Zb(0,0),new Zb(1,0),new Zb(1,1)])):(a.faces.push(new Yb.Face3(i,h,k,null,null,5)),C>B?a.uvs.push([new Yb.Vec2(o/f,p/f),new Yb.Vec2(l/f,m/f),new Yb.Vec2(u/f,v/f)]):a.uvs.push([new Yb.Vec2(q/f,p/f),new Yb.Vec2(n/f,m/f),new Yb.Vec2(dz/f,v/f)]),a.uv2s.push([new Zb(0,0),new Zb(0,1),new Zb(1,1)]),a.faces.push(new Yb.Face3(j,i,k,null,null,5)),C>B?a.uvs.push([new Yb.Vec2(r/f,s/f),new Yb.Vec2(o/f,p/f),new Yb.Vec2(u/f,v/f)]):a.uvs.push([new Yb.Vec2(t/f,s/f),new Yb.Vec2(q/f,p/f),new Yb.Vec2(dz/f,v/f)]),a.uv2s.push([new Zb(1,0),new Zb(0,0),new Zb(1,1)]))},generateSideWall:function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,u,x,y,z,A,B;x=(b+1)%c,i=d[b],j=e[b],k=e[x],l=d[x],y=a.vertices[i],z=a.vertices[j],A=a.vertices[k],B=a.vertices[l],m=y.x,n=y.y,o=y.z,p=z.x,q=z.y,r=z.z,s=A.x,t=A.y,u=A.z,v=B.x,w=B.y,dz=B.z;var C,D=Math.abs(o-u),E=Math.abs(m-s);f?(C=h?1:2,a.faces.push(new Yb.Face3(i,j,l,null,null,C)),E>D?a.uvs.push([new Yb.Vec2(m/g,n/g),new Yb.Vec2(p/g,q/g),new Yb.Vec2(v/g,w/g)]):a.uvs.push([new Yb.Vec2(o/g,n/g),new Yb.Vec2(r/g,q/g),new Yb.Vec2(dz/g,w/g)]),a.uv2s.push([new Zb(0,1),new Zb(0,0),new Zb(1,1)]),a.faces.push(new Yb.Face3(j,k,l,null,null,C)),E>D?a.uvs.push([new Yb.Vec2(p/g,q/g),new Yb.Vec2(s/g,t/g),new Yb.Vec2(v/g,w/g)]):a.uvs.push([new Yb.Vec2(r/g,q/g),new Yb.Vec2(u/g,t/g),new Yb.Vec2(dz/g,w/g)]),a.uv2s.push([new Zb(0,0),new Zb(1,0),new Zb(1,1)])):(C=h?2:1,a.faces.push(new Yb.Face3(j,i,l,null,null,C)),E>D?a.uvs.push([new Yb.Vec2(p/g,q/g),new Yb.Vec2(m/g,n/g),new Yb.Vec2(v/g,w/g)]):a.uvs.push([new Yb.Vec2(r/g,q/g),new Yb.Vec2(o/g,n/g),new Yb.Vec2(dz/g,w/g)]),a.uv2s.push([new Zb(0,0),new Zb(0,1),new Zb(1,1)]),a.faces.push(new Yb.Face3(k,j,l,null,null,C)),E>D?a.uvs.push([new Yb.Vec2(s/g,t/g),new Yb.Vec2(p/g,q/g),new Yb.Vec2(v/g,w/g)]):a.uvs.push([new Yb.Vec2(u/g,t/g),new Yb.Vec2(r/g,q/g),new Yb.Vec2(dz/g,w/g)]),a.uv2s.push([new Zb(1,0),new Zb(0,0),new Zb(1,1)]))},generateBottom:function(a,b,c,d,e,f){this.generateTop(a,b,c,d,e,!1,f)},generateTop:function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,t,w,x,y,z,A;w=(b+1)%c,h=d[b],i=e[b],j=e[w],k=d[w],x=a.vertices[h],y=a.vertices[i],z=a.vertices[j],A=a.vertices[k],l=x.x,m=x.y,n=x.z,o=y.x,p=y.y,q=y.z,r=z.x,s=z.y,t=z.z,u=A.x,v=A.y,dz=A.z,f?(a.faces.push(new Yb.Face3(h,i,k,null,null,3)),a.uvs.push([new Yb.Vec2(l/g,n/g),new Yb.Vec2(o/g,q/g),new Yb.Vec2(u/g,dz/g)]),a.uv2s.push([new Zb(0,1),new Zb(0,0),new Zb(1,1)]),a.faces.push(new Yb.Face3(i,j,k,null,null,3)),a.uvs.push([new Yb.Vec2(o/g,q/g),new Yb.Vec2(r/g,t/g),new Yb.Vec2(u/g,dz/g)]),a.uv2s.push([new Zb(0,0),new Zb(1,0),new Zb(1,1)])):(a.faces.push(new Yb.Face3(i,h,k,null,null,0)),a.uvs.push([new Yb.Vec2(o/g,q/g),new Yb.Vec2(l/g,n/g),new Yb.Vec2(u/g,dz/g)]),a.uv2s.push([new Zb(0,0),new Zb(0,1),new Zb(1,1)]),a.faces.push(new Yb.Face3(j,i,k,null,null,0)),a.uvs.push([new Yb.Vec2(r/g,t/g),new Yb.Vec2(o/g,q/g),new Yb.Vec2(u/g,dz/g)]),a.uv2s.push([new Zb(1,0),new Zb(0,0),new Zb(1,1)]))},exchangeYZ:function(a){var b=a.y;a.y=a.z,a.z=-b},addPoints:function(a,b,c,d,e){b.multiplyScalar(.5),c.push((new Yb.Vec3).subVectors(a,b)),d.push((new Yb.Vec3).addVectors(a,b))},computeCurvePoint:function(a,b,c,d,e,f,g,h,i){var k,l,m,n,o=d?0:1,p=new Yb.Vec3,q=h;if(a){l=a.getTangentAt(1),m=b.getTangentAt(0),concave=Yb.Math.isConcave(l,m,!1),m.multiplyScalar(-1),angle=l.angleTo(m),n=Math.sin(angle/2),k=b.getPoint(0),n=0==n?.1:n;var r=concave?c/n:-c/n;1==n?p.crossVectors(m,new $b(0,0,1)).normalize().multiplyScalar(r):p.addVectors(l,m).normalize().multiplyScalar(r),this.addPoints(k,p,f,g,i)}else m=b.getTangentAt(o),k=b.getPoint(o),p.crossVectors(m,new Yb.Vec3(0,0,1)).normalize().multiplyScalar(c),this.addPoints(k,p,f,g,i);if(!(b instanceof Yb.LineCurve3)&&e){var s=q+1;for(j=0;j<s-2;j++)u=j/(s-1),m=b.getTangentAt(u),k=b.getPointAt(u),p.crossVectors(m,new Yb.Vec3(0,0,1)).normalize().multiplyScalar(c),j*b.getLength()/q>c/Math.abs(n)&&this.addPoints(k,p,f,g,i)}},computePoints:function(a,b,c){var d,e,f,g=(new Yb.Vec3,a.isClockwise()),h=a.curves[0].getPoint(0),i=a.curves[a.curves.length-1].getPoint(1);f=h.equals(i),e=a.curves.length;var j=[],k=[];new Yb.Path,a.getLength();for(d=0;e>d;d++){var l=d-1;f&&-1===l&&(l=e-1);var m=a.curves[l],n=a.curves[d];this.computeCurvePoint(m,n,b,!0,!0,j,k,c,g),d!==e-1||f||this.computeCurvePoint(null,n,b,!1,!1,j,k,c,g)}return[j,k,f]}}),Yb.ShapeNode=function(a,b,c,d,e){if(null==a)return a=[],this.materialSize=3,void Yb.Entity.call(this);var f;if(!(1===arguments.length&&arguments[0]instanceof Object)||arguments[0]instanceof Yb.Shape||arguments[0]instanceof Yb.Path&&!Array.isArray(arguments[0]))this.options={curveSegments:b,amount:c,vertical:d,zMinusHalfAmount:this.zMinusHalfAmount,repeat:e||20};else{if(f=arguments[0],a=f.path,null==a)return a=[],this.materialSize=3,void Yb.Entity.call(this);b=f.curveSegments,c=f.amount,d=f.vertical,e=f.repeat,this.options={curveSegments:f.curveSegments,amount:f.amount,vertical:f.vertical,zMinusHalfAmount:this.zMinusHalfAmount,repeat:f.repeat||20},this._id=f.id}var g=[];a instanceof Yb.Path?(g=a.toShapes(),this.path=a):g=a,this.curveSegments=b,this.amount=c,this.vertical=d,this.repeat=e||20,g=g instanceof Array?g:[g],this.shapes=g,this.shapebb=g[g.length-1].getBoundingBox(),this.materialSize=3,Yb.Entity.call(this),this.computeCentroids(),this.computeFaceNormals()},Yb.ShapeNode.SideIndexMapping={bottom:0,side:1,top:2},Yb.extend(Yb.ShapeNode,Yb.Entity,{constructor:Yb.ShapeNode,className:"TGL.ShapeNode",__accessor:["path","curveSegments","amount","vertical","repeat"],__bool:["vertical"],__SizePropeties:["path","curveSegments","amount","vertical","repeat"],computeData:function(){return this.options={curveSegments:this.curveSegments,amount:this.amount,vertical:this.vertical,zMinusHalfAmount:this.zMinusHalfAmount,repeat:this.repeat||20},this.addShapes(this.path,this.options)},getSideIndexMapping:function(){return Yb.ShapeNode.SideIndexMapping},addShapes:function(a,b){var c=[];c=a instanceof Yb.Path?a.toShapes():a;var d={};if(d.vertices=[],d.uvs=[],d.faces=[],!c)return d;for(var e=c.length,f=0;e>f;f++){var g=c[f];this.addShape(g,b,d)}var h=new Yb.BoundingBox;h.setFromPoints(d.vertices);var i=(h.max.y-h.min.y)/2;if(b.zMinusHalfAmount)for(var j=0;j<d.vertices.length;j++)d.vertices[j].y-=i;if(b.vertical)for(var j=0;j<d.vertices.length;j++){var k=d.vertices[j].y;d.vertices[j].y=d.vertices[j].z,d.vertices[j].z=-k}return d}}),Yb.ShapeNode.prototype.addShape=function(a,b,c){function d(a,b,c){return b||console.log("die"),b.clone().multiplyScalar(c).add(a)}function f(a,b,c){return h(a,b,c)}function g(a,b,c){var d=Math.atan2(b.y-a.y,b.x-a.x),e=Math.atan2(c.y-a.y,c.x-a.x);d>e&&(e+=2*Math.PI);var f=(d+e)/2,g=-Math.cos(f),h=-Math.sin(f),i=new Yb.Vec2(g,h);return i}function h(a,b,c){var d,e,f,h,i,j,k=Yb.ShapeNode.__v1,l=Yb.ShapeNode.__v2,m=Yb.ShapeNode.__v3,n=Yb.ShapeNode.__v4,o=Yb.ShapeNode.__v5,p=Yb.ShapeNode.__v6;return k.set(a.x-b.x,a.y-b.y),l.set(a.x-c.x,a.y-c.y),d=k.normalize(),e=l.normalize(),m.set(-d.y,d.x),n.set(e.y,-e.x),o.copy(a).add(m),p.copy(a).add(n),o.equals(p)?n.clone():(o.copy(b).add(m),p.copy(c).add(n),f=d.dot(n),h=p.sub(o).dot(n),0===f&&(console.log("Either infinite or no solutions!"),0===h?console.log("Its finite solutions."):console.log("Too bad, no solutions.")),i=h/f,0>i?g(a,b,c):(j=d.multiplyScalar(i).add(o),j.sub(a).clone()))}function i(){if(u){var a=0,b=V*a;for(Y=0;W>Y;Y++)U=N[Y],m(U[2]+b,U[1]+b,U[0]+b,!0);for(a=w+2*t,b=V*a,Y=0;W>Y;Y++)U=N[Y],m(U[0]+b,U[1]+b,U[2]+b,!1)}else{for(Y=0;W>Y;Y++)U=N[Y],m(U[2],U[1],U[0],!0);for(Y=0;W>Y;Y++)U=N[Y],m(U[0]+V*w,U[1]+V*w,U[2]+V*w,!1)}}function j(){var a=0;for(k(O,a),a+=O.length,G=0,H=L.length;H>G;G++)F=L[G],k(F,a),a+=F.length}function k(a,b){var c,d;for(Y=a.length;--Y>=0;){c=Y,d=Y-1,0>d&&(d=a.length-1);var e=0,f=w+2*t;for(e=0;f>e;e++){var g=V*e,h=V*(e+1),i=b+c+g,j=b+d+g,k=b+d+h,l=b+c+h;n(i,j,k,l,a,e,f,c,d)}}}function l(a,b,d){c.vertices.push(new Yb.Vec3(a,b,d-(q?p/2:0)))}function m(d,e,f,g){d+=I,e+=I,f+=I;var h=g?0:2;if(Yb.Math.isClockwise([c.vertices[d],c.vertices[e],c.vertices[f]]),"z"){c.faces.push(new Yb.Face3(d,e,f,null,null,h));var i=g?A.generateBottomUV(c,a,b,d,e,f):A.generateTopUV(c,a,b,d,e,f);c.uvs.push(i)}else{c.faces.push(new Yb.Face3(d,f,e,null,null,h));var i=g?A.generateBottomUV(c,a,b,d,f,e):A.generateTopUV(c,a,b,d,f,e);c.uvs.push(i)}}function n(d,e,f,g,h,i,j,k,l){if(d+=I,e+=I,f+=I,g+=I,Yb.Math.isClockwise([c.vertices[d],c.vertices[e],c.vertices[g]]),"z"){c.faces.push(new Yb.Face3(d,e,g,null,null,z)),c.faces.push(new Yb.Face3(e,f,g,null,null,z));var m=A.generateSideWallUV(c,a,h,b,d,e,f,g,i,j,k,l);c.uvs.push([m[0],m[1],m[3]]),c.uvs.push([m[1],m[2],m[3]])}else{c.faces.push(new Yb.Face3(d,g,e,null,null,z)),c.faces.push(new Yb.Face3(e,g,f,null,null,z));var m=A.generateSideWallUV(c,a,h,b,d,e,f,g,i,j,k,l);c.uvs.push([m[0],m[3],m[1]]),c.uvs.push([m[1],m[3],m[2]])}}var o,p=b.amount!==e?b.amount:100,q=b.zMinusHalfAmount!==e?b.zMinusHalfAmount:!1,r=b.bevelThickness!==e?b.bevelThickness:6,s=b.bevelSize!==e?b.bevelSize:r-2,t=b.bevelSegments!==e?b.bevelSegments:3,u=b.bevelEnabled!==e?b.bevelEnabled:!1,v=b.curveSegments!==e?b.curveSegments:12,w=b.steps!==e?b.steps:1,x=b.extrudePath,y=!1,z=(b.material||0,b.extrudeMaterial||1),A=b.UVGenerator!==e?b.UVGenerator:Yb.ShapeNode.WorldUVGenerator;A.repeat=b.repeat;var B,C,D,E;this.shapebb;x&&(o=x.getSpacedPoints(w),y=!0,u=!1,B=b.frames!==e?b.frames:Yb.PathNode.prototype.frenetFrames(x,w,!1),C=new Yb.Vec3,D=new Yb.Vec3,E=new Yb.Vec3),u||(t=0,r=0,s=0);var F,G,H,I=c.vertices.length,J=a.extractPoints(v),K=J.shape,L=J.holes,M=!Yb.Shape.Utils.isClockWise(K);if(M){for(K=K.reverse(),G=0,H=L.length;H>G;G++)F=L[G],Yb.Shape.Utils.isClockWise(F)&&(L[G]=F.reverse());M=!1}var N=Yb.Shape.Utils.triangulateShape(K,L),O=K;for(G=0,H=L.length;H>G;G++)F=L[G],K=K.concat(F);for(var P,Q,R,S,T,U,V=K.length,W=N.length,X=(O.length,180/Math.PI,[]),Y=0,Z=O.length,$=Z-1,_=Y+1;Z>Y;Y++,$++,_++){$===Z&&($=0),_===Z&&(_=0);O[Y],O[$],O[_];X[Y]=f(O[Y],O[$],O[_])}var aa,ba=[],ca=X.concat();for(G=0,H=L.length;H>G;G++){for(F=L[G],aa=[],Y=0,Z=F.length,$=Z-1,_=Y+1;Z>Y;Y++,$++,_++)$===Z&&($=0),_===Z&&(_=0),aa[Y]=f(F[Y],F[$],F[_]);ba.push(aa),ca=ca.concat(aa)}for(P=0;t>P;P++){for(R=P/t,S=r*(1-R),Q=s*Math.sin(R*Math.PI/2),Y=0,Z=O.length;Z>Y;Y++)T=d(O[Y],X[Y],Q),l(T.x,T.y,-S);for(G=0,H=L.length;H>G;G++)for(F=L[G],aa=ba[G],Y=0,Z=F.length;Z>Y;Y++)T=d(F[Y],aa[Y],Q),l(T.x,T.y,-S)}for(Q=s,Y=0;V>Y;Y++)T=u?d(K[Y],ca[Y],Q):K[Y],y?(D.copy(B.normals[0]).multiplyScalar(T.x),C.copy(B.binormals[0]).multiplyScalar(T.y),E.copy(o[0]).add(D).add(C),l(E.x,E.y,E.z)):l(T.x,T.y,0);var da;for(da=1;w>=da;da++)for(Y=0;V>Y;Y++)T=u?d(K[Y],ca[Y],Q):K[Y],y?(D.copy(B.normals[da]).multiplyScalar(T.x),C.copy(B.binormals[da]).multiplyScalar(T.y),E.copy(o[da]).add(D).add(C),l(E.x,E.y,E.z)):l(T.x,T.y,p/w*da);for(P=t-1;P>=0;P--){for(R=P/t,S=r*(1-R),Q=s*Math.sin(R*Math.PI/2),Y=0,Z=O.length;Z>Y;Y++)T=d(O[Y],X[Y],Q),l(T.x,T.y,p+S);for(G=0,H=L.length;H>G;G++)for(F=L[G],aa=ba[G],Y=0,Z=F.length;Z>Y;Y++)T=d(F[Y],aa[Y],Q),y?l(T.x,T.y+o[w-1].y,o[w-1].x+S):l(T.x,T.y,p+S)}i(),j()},Yb.ShapeNode.WorldUVGenerator={generateTopUV:function(a,b,c,d,e,f){var g=a.vertices[d].x,h=a.vertices[d].y,i=a.vertices[e].x,j=a.vertices[e].y,k=a.vertices[f].x,l=a.vertices[f].y;return[new Yb.Vec2(g/this.repeat,h/this.repeat),new Yb.Vec2(i/this.repeat,j/this.repeat),new Yb.Vec2(k/this.repeat,l/this.repeat)]},generateBottomUV:function(a,b,c,d,e,f){return this.generateTopUV(a,b,c,d,e,f)},uv:function(a,b,c){return new Zb(Math.sqrt(a*a+b*b)/this.repeat,(1-c)/this.repeat)},generateSideWallUV:function(a,b,c,d,e,f,g,h,i,j,k,l){var m=a.vertices[e].x,n=a.vertices[e].y,o=a.vertices[e].z,p=a.vertices[f].x,q=a.vertices[f].y,r=a.vertices[f].z,s=a.vertices[g].x,t=a.vertices[g].y,u=a.vertices[g].z,v=a.vertices[h].x,w=a.vertices[h].y,x=a.vertices[h].z,y=Math.abs(n-q),z=Math.abs(m-p);return z>y?[new Yb.Vec2(m/this.repeat,(1-o)/this.repeat),new Yb.Vec2(p/this.repeat,(1-r)/this.repeat),new Yb.Vec2(s/this.repeat,(1-u)/this.repeat),new Yb.Vec2(v/this.repeat,(1-x)/this.repeat)]:[new Yb.Vec2(n/this.repeat,(1-o)/this.repeat),new Yb.Vec2(q/this.repeat,(1-r)/this.repeat),new Yb.Vec2(t/this.repeat,(1-u)/this.repeat),new Yb.Vec2(w/this.repeat,(1-x)/this.repeat)]}},Yb.ShapeNode.__v1=new Yb.Vec2,Yb.ShapeNode.__v2=new Yb.Vec2,Yb.ShapeNode.__v3=new Yb.Vec2,Yb.ShapeNode.__v4=new Yb.Vec2,Yb.ShapeNode.__v5=new Yb.Vec2,Yb.ShapeNode.__v6=new Yb.Vec2,Yb.TextNode=function(a,b,c,d,f,g,h){var i;1===arguments.length&&arguments[0]instanceof Object&&!Array.isArray(arguments[0])?(i=arguments[0],a=i.text,this.font=i.font||"helvetiker",this.size=i.size||150,this.weight=i.weight||"normal",this.fontStyle=i.fontStyle||"normal",this.height=i.height||50,this._id=i.id,this.curveSegments=i.curveSegments):(this.font=d||"helvetiker",this.size=b||150,this.weight=f||"normal",this.fontStyle=g||"normal",this.height=c||50,this.curveSegments=h);var j={size:this.size,height:this.height,font:this.font,weight:this.weight,style:this.fontStyle,curveSegments:this.curveSegments||30,bevelEnabled:!1,zMinusHalfAmount:!0};this.text=a;var k=Yb.FontUtils.generateShapes(a,j);j.amount=j.height!==e?j.height:50,j.bevelThickness===e&&(j.bevelThickness=10),j.bevelSize===e&&(j.bevelSize=8),j.bevelEnabled===e&&(j.bevelEnabled=!1),Yb.ShapeNode.call(this,k,j.curveSegments,this.height,!1,50,!0)},Yb.extend(Yb.TextNode,Yb.ShapeNode,{constructor:Yb.TextNode,className:"TGL.TextNode",__accessor:["text","size","height","font","weight","fontStyle"],__SizePropeties:["text","size","height","font","weight","fontStyle"],computeData:function(){var a={size:this.size,height:this.height,font:this.font,weight:this.weight,style:this.fontStyle,curveSegments:this.curveSegments||30,bevelEnabled:!1,zMinusHalfAmount:!0},b={curveSegments:this.curveSegments,amount:this.height,vertical:!1,zMinusHalfAmount:!0,repeat:20},c=Yb.FontUtils.generateShapes(this.text,a);return Yb.ShapeNode.prototype.addShapes.call(this,c,b)}}),Yb.LatheNode=function(a,b,c,d,f,g){this.materialSize=3;var h;1===arguments.length&&arguments[0]instanceof Object&&!(arguments[0]instanceof Yb.Path)?(h=arguments[0],this.path=h.path,this.segmentsH=h.segmentsH||64,this.segmentsR=h.segmentsR||20,this.arc=h.arc!=e?h.arc:2*Math.PI,this.startClosed=h.startClosed,this.endClosed=h.endClosed,this._id=h.id):(this.path=a,this.segmentsH=b||64,this.segmentsR=c||20,this.arc=d!=e?d:2*Math.PI,this.startClosed=f,this.endClosed=g),Yb.Entity.call(this),this.computeCentroids(),this.computeFaceNormals()},Yb.extend(Yb.LatheNode,Yb.Entity,{constructor:Yb.LatheNode,className:"TGL.LatheNode",__accessor:["path","segmentsH","segmentsR","arc","startClosed","endClosed"],__SizePropeties:["path","segmentsH","segmentsR","arc","startClosed","endClosed"],computeData:function(){function d(a){var b=a.x,c=a.z,d=((0===c?b/Math.abs(b):b/Math.abs(c))+1)/2;d=Yb.Math.clamp(d,0,1);var e=((0===b?c/Math.abs(c):c/Math.abs(b))+1)/2;return e=Yb.Math.clamp(e,0,1),new Yb.Vec2(d,e)}var e={},e={};if(e.faces=[],e.uvs=[],e.vertices=[],null==this.path)return e;var f,g,h,i,j,k,l,m=[],n=this.path,o=this.segmentsH,p=this.segmentsR;for(Yb.Shape.Utils.isClockWise(n.getPoints())||(n=n.reverse()),g=0;o>=g;g++){for(f=n.getPoint(g/o),m[g]=[],i=Math.abs(f.x),j=f.y,this.startClosed&&0===g&&e.vertices.push(new Yb.Vec3(0,j,0)),h=0;p>h;h++)l=h/p*this.arc,k=new Yb.Vec3(i*Math.cos(l),j,i*Math.sin(l)),m[g][h]=e.vertices.push(k)-1;this.endClosed&&g===o&&e.vertices.push(new Yb.Vec3(0,j,0))}var q=this.arc==2*Math.PI;if(this.startClosed)for(a=0,h=0;(q?p:p-1)>h;h++)jp=(h+1)%p,b=m[0][h],c=m[0][jp],uva=new Yb.Vec2(.5,.5),uvb=d(e.vertices[b]),uvc=d(e.vertices[c]),e.faces.push(new Yb.Face3(a,b,c)),e.uvs.push([uva,uvb,uvc]);for(g=0;o>g;g++)for(h=0;(q?p:p-1)>h;h++)ip=g+1,jp=(h+1)%p,a=m[g][h],b=m[ip][h],c=m[ip][jp],Uc=m[g][jp],uva=new Yb.Vec2(g/o,h/p),uvb=new Yb.Vec2((g+1)/o,h/p),uvc=new Yb.Vec2((g+1)/o,(h+1)/p),uvd=new Yb.Vec2(g/o,(h+1)/p),e.faces.push(new Yb.Face3(a,b,Uc)),e.uvs.push([uva,uvb,uvd]),e.faces.push(new Yb.Face3(b,c,Uc)),e.uvs.push([uvb.clone(),uvc,uvd.clone()]);if(this.endClosed)for(a=e.vertices.length-1,h=0;(q?p:p-1)>h;h++)jp=(h+1)%p,b=m[m.length-1][h],c=m[m.length-1][jp],uva=new Yb.Vec2(0,0),uvb=new Yb.Vec2(1,h/p),uvc=new Yb.Vec2(1,(h+1)/p),e.faces.push(new Yb.Face3(a,b,c)),e.uvs.push([uva,uvb,uvc]);return e}}),Yb.CurvePlane=function(a,b,c,d){this.pathH=a,this.pathV=b,this.segmentsH=c||20,this.segmentsV=d||20,Yb.Entity.call(this)},Yb.extend(Yb.CurvePlane,Yb.Entity,{constructor:Yb.CurvePlane,className:"TGL.CurvePlane",computeData:function(){var a={};if(a.faces=[],a.uvs=[],a.vertices=[],null==this.pathV||null==this.pathH)return a;var b,c,d,e,f,g,h,i,j,k=this.pathV,l=this.pathH,m=this.segmentsV,n=this.segmentsH,o=m+1,p=n+1;for(this.grid=[],b=0;p>b;b++){this.grid[b]=[];var q=l.getPointAt(b/p);for(c=0;o>c;c++){var r=k.getPointAt(c/o);this.grid[b][c]=a.vertices.push(new $b(q.x,r.y,q.z+r.z))-1}}for(b=0;n>b;b++)for(c=0;m>c;c++)d=this.grid[b][c],e=this.grid[b][c+1],f=this.grid[b+1][c+1],g=this.grid[b+1][c],h=new Zb(b/p,c/o),i=new Zb(b/p,(c+1)/o),uvc=new Zb((b+1)/p,(c+1)/o),j=new Zb((b+1)/p,c/o),a.faces.push(new oc(d,f,e)),a.uvs.push([h,uvc,i]),a.faces.push(new oc(d,g,f)),a.uvs.push([h.clone(),j.clone(),uvc]);return a}}),Yb.ComboNode=function(a,b,c,d,e){if(1===arguments.length&&arguments[0]instanceof Object&&!Array.isArray(arguments[0])){var f=a;this.combos=f.combos||[],this.operators=f.operators,this.centralized=c,this.names=e,this._id=f.id}else this.combos=a||[],this.operators=b,this.centralized=c,this._id=d,this.names=e;this.csgs=[],Yb.Entity.call(this)},Yb.extend(Yb.ComboNode,Yb.Entity,{constructor:Yb.ComboNode,className:"TGL.ComboNode",__accessor:["combos","operators","centralized","names"],__SizePropeties:["combos","operators","centralized"],getOffsetPosition:function(){return this._offsetPosition},getSideIndexMapping:function(){var a,b,c,d,e=this.combos,f=this.names||[],g={},h=0;if(e&&e.length)for(c=0;c<e.length;c++){a=e[c],b=f[c],b||(d=a.getClassName(),d&&d.indexOf(".")>0&&(d=d.substr(d.lastIndexOf(".")+1)),b=d+""+c,b=b.toLowerCase());var i=a.getSideIndexMapping();if(i)for(var j in i)g[b+"-"+j]=h++;else g[b]=h++}return g},computeData:function(){this.csgs=[];var a={vertices:[],faces:[],uvs:[],uv2s:[]};if(!this.combos)return a;if(null==this.operators||0==this.operators.length){var b=sc.mergeElements(this.combos);if(this.materialSize=b.material.materials.length,this.material=b.material,this.orgMaterial=b.material,a={vertices:b.vertices,faces:b.faces,uvs:b.uvs,uv2s:b.uv2s||[]},this.centralized&&a.vertices){var c=new Yb.BoundingBox;c.setFromPoints(a.vertices);var d=c.center();for(g=0;g<a.vertices.length;g++){var f=a.vertices[g];f.sub(d)}this._offsetPosition=d}return a}this.operators=this.operators||[];var g,h,i,j,k=this.combos.length;for(g=0;k>g;g++)this.csgs.push(new Yb.CSG(this.combos[g]));for(g=0;k>g;g++)null==h?h=this.csgs[g]:(i=this.operators[g-1],"+"===i||i==e?h=h.union(this.csgs[g]):"-"===i?h=h.substract(this.csgs[g]):"^"===i&&(h=h.intersect(this.csgs[g])));if(!h)return a;if(j=h.toMesh(),("centralized"!=this.changeProperty||null==this.material)&&(this.materialSize=j.material.materials.length,this.material=j.material,this.orgMaterial=j.material),a={vertices:j.vertices,faces:j.faces,uvs:j.uvs,uv2s:j.uv2s},this.centralized&&a.vertices){var c=new Yb.BoundingBox;c.setFromPoints(a.vertices);var d=c.center();for(g=0;g<a.vertices.length;g++){var f=a.vertices[g];f.sub(d)}this._offsetPosition=d}return j=e,a},computeNodeMaterial:function(a){this.material=a.material,this.materialSize=a.materialSize},cacheNodeMaterial:function(a){a.material=this.material,a.materialSize=this.materialSize},needComputeVertexNormal:function(){return!0},generatePrimitiveKey:function(){return null},changeMapping:function(a){var b=this.getMaterialMapping();Yb.Utils.isSame(a,b)||(this.batch?this.materialMappingChanges=[a,b]:(this.onMaterialMapping(),this.firePropertyChange("materialMapping",a,b)))},isStyleEquals:function(a,b,c){return!1},getSelectStyle:function(){var a=this.getStyle("select.style");return("outline.normal"==a||"outline"==a)&&(a="outline.wireframe"),a},onMaterialMapping:function(){this.groups=e,this.primitive.groups=e}}),Yb.Terrain=function(a){if(a=a||{},this._id=a.id,this.width=a.width,this.depth=a.depth,this.segmentsW=a.segmentsW||30,this.segmentsD=a.segmentsD||30,this.heightMap=a.heightMap,this.heightUnit=a.heightUnit||1,this.maxHeight=a.maxHeight||255,this.minHeight=a.minHeight||0,this.baseLayerHeight=a.baseLayerHeight||0,"string"==typeof this.heightMap?(this.image=new Image,this.image.src=this.heightMap):bc.isCanvas(this.heightMap)?this.canvas=this.heightMap:bc.isImage(this.heightMap)&&(this.image=this.heightMap),this.image){var b=this;this.image.onload=function(a){var c=document.createElement("canvas");c.width=b.image.width,c.height=b.image.height;var d=c.getContext("2d");d.drawImage(b.image,0,0),b.canvas=c,b.computed=!1,b.computeNodeData(),b.firePropertyChange("width",0,1)}}this.materialSize=2,Yb.Entity.call(this),this.computeCentroids(),this.computeFaceNormals()},Yb.extend(Yb.Terrain,Yb.Entity,{constructor:Yb.Terrain,className:"TGL.Terrain",__accessor:["width","depth","segmentsW","segmentsD","heightMap","heightUnit","maxHeight","minHeight","baseLayerHeight","smooth"],__SizePropeties:["width","depth","segmentsW","segmentsD","heightMap","heightUnit","maxHeight","minHeight","baseLayerHeight","smooth"],__bool:["smooth"],computeLayerData:function(a,b,c){var d,e,f=this.width/2,g=this.depth/2,h=c?this.segmentsW:1,i=c?this.segmentsD:1,j=h+1,k=i+1,l=this.width/h,m=this.depth/i,n=new Yb.Vec3(0,0,1),o=a.vertices.length;for(e=0;k>e;e++)for(d=0;j>d;d++){var p=d*l-f,q=e*m-g,r=0;r=c?c.call(this,d/j,e/k):this.baseLayerHeight*this.heightUnit,a.vertices.push(new Yb.Vec3(p,r,q))}for(e=0;i>e;e++)for(d=0;h>d;d++){var s=d+j*e+o,t=d+j*(e+1)+o,u=d+1+j*(e+1)+o,v=d+1+j*e+o,w=new Yb.Vec2(d/h,1-e/i),x=new Yb.Vec2(d/h,1-(e+1)/i),y=new Yb.Vec2((d+1)/h,1-(e+1)/i),z=new Yb.Vec2((d+1)/h,1-e/i);if(c){var A=new Yb.Face3(s,t,v);A.materialIndex=b,a.faces.push(A),a.uvs.push([w,x,z]),A=new Yb.Face3(t,u,v),A.materialIndex=b,a.faces.push(A),a.uvs.push([x.clone(),y,z.clone()])}else{var A=new Yb.Face4(s,t,u,v);A.normal.copy(n),A.vertexNormals.push(n.clone(),n.clone(),n.clone(),n.clone()),
A.materialIndex=b,a.faces.push(A),a.uvs.push([w,x,y,z])}}},computeData:function(){var a={};return a.vertices=[],a.faces=[],a.uvs=[],this.computeLayerData(a,0),this.computeLayerData(a,1,this.getHeight),a},getFaceNormal:function(a,b){this.computeFaceNormals();var c=this.segmentsW*a,d=this.segmentsD*b,e=Math.floor(c),f=Math.floor(d),g=f*this.segmentsW+e;g=2*g+1,e!=Math.round(c)&&f!=Math.round(d)&&g++;var h=this.faces[g];this.vertices[h.a],this.vertices[h.b],this.vertices[h.c];return h.normal.clone()},setHeightMap:function(a){if(this.heightMap=a,"string"==typeof this.heightMap?(this.image=new Image,this.image.src=this.heightMap):bc.isCanvas(this.heightMap)?this.canvas=this.heightMap:bc.isImage(this.heightMap)&&(this.image=this.heightMap),this.image){var b=this;if(this.image.width){var c=document.createElement("canvas");c.width=b.image.width,c.height=b.image.height;var d=c.getContext("2d");d.drawImage(b.image,0,0),b.canvas=c,b.computed=!1,b.computeNodeData(),b.firePropertyChange("width",0,1)}else this.image.onload=function(a){var c=document.createElement("canvas");c.width=b.image.width,c.height=b.image.height;var d=c.getContext("2d");d.drawImage(b.image,0,0),b.canvas=c,b.computed=!1,b.computeNodeData(),b.firePropertyChange("width",0,1)}}},getHeight:function(a,b){if(null==this.canvas)return 0;var c=this.canvas;if(null==this.heightData){for(var d=c.width*c.height,e=new Float32Array(d),f=0;d>f;f++)e[f]=0;for(var g=c.getContext("2d"),h=g.getImageData(0,0,c.width,c.height),i=h.data,j=0,f=0,k=i.length;k>f;f+=4){var l=i[f]+i[f+1]+i[f+2];e[j++]=l/3}this.heightData=e}var m=a*c.width,n=b*c.height,o=Math.floor(m),p=Math.floor(n),q=[],r=[];q.push(o),m!=o&&q.push(o+1),r.push(p),n!=p&&r.push(p+1);var f,j,s,t=q.length*r.length,u=0;for(f=0;f<q.length;f++)for(j=0;j<r.length;j++)s=r[j]*c.width+q[f],u+=this.heightData[s];return u/=t,u=Yb.Math.clamp(u,this.minHeight,this.maxHeight),u*=this.heightUnit},getSideIndexMapping:function(){return Yb.Terrain.SideIndexMapping},refreshUniforms:function(a){a.heightUnit&&(a.heightUnit.value=this.heightUnit)}}),Yb.Terrain.SideIndexMapping={layer0:0,layer1:1},Yb.Link=function(a,b,c){if(1===arguments.length&&arguments[0]instanceof Object&&!Array.isArray(arguments[0])){var d=arguments[0];a=d.fromNode,b=d.toNode,this._id=d.id}else this._id=c;Yb.Line.call(this),this.setFromNode(a),this.setToNode(b),this._editable=!1},Yb.extend(Yb.Link,Yb.Line,{className:"TGL.Link",___accessor:["linkType","extend","controls"],__SizePropeties:["fromNode","toNode","linkType","extend","controls"],setFromNode:function(a){if(this._fromNode!=a){var b=this._fromNode;this._fromNode=a,this.onPropertyChange(),this.firePropertyChange("fromNode",b,a),this._fromNode=a,b&&(b._removeFromLink(this),b.removePropertyChangeListener(this.handleNodePropertyChange)),this._fromNode&&(this._fromNode._addFromLink(this),this._fromNode.addPropertyChangeListener(this.handleNodePropertyChange,this))}},getFromNode:function(){return this._fromNode},setToNode:function(a){if(this._toNode!=a){var b=this._toNode;this._toNode=a,this.onPropertyChange(),this.firePropertyChange("toNode",b,a),b&&(b.removePropertyChangeListener(this.handleNodePropertyChange),b._removeToLink(this)),this._toNode&&(this._toNode._addToLink(this),this._toNode.addPropertyChangeListener(this.handleNodePropertyChange,this))}},getToNode:function(){return this._toNode},isLooped:function(){return this._fromNode===this._toNode&&null!=this._fromNode&&null!=this._toNode},handleNodePropertyChange:function(a){if(a.property.startsWith("position")||"worldMatrix"==a.property){var b=this.vertices;this.onPropertyChange(),this.firePropertyChange("vertices",b,this.vertices)}},computeNodeData:function(){this.computeData()},updateMatrix:function(){},updateWorldMatrix:function(){},computeData:function(){if(null!=this._fromNode&&null!=this._toNode){null==this._extend&&(this._extend=0);var a=this._fromNode.worldMatrix.getPosition(),b=this._toNode.worldMatrix.getPosition(),c=[];if(c.push(a.clone()),"orthogonal.x"==this._linkType){var d=Math.max(a.x,b.x),e=new $b(d+this._extend,a.y,a.z);c.push(e),e=new $b(d+this._extend,b.y,b.z),c.push(e)}else if("orthogonal.x.n"==this._linkType){var f=Math.min(a.x,b.x),e=new $b(f-this._extend,a.y,a.z);c.push(e),e=new $b(f-this._extend,b.y,b.z),c.push(e)}else if("orthogonal.y"==this._linkType){var g=Math.max(a.y,b.y),e=new $b(a.x,g+this._extend,a.z);c.push(e),e=new $b(b.x,g+this._extend,b.z),c.push(e)}else if("orthogonal.y.n"==this._linkType){var h=Math.min(a.y,b.y),e=new $b(a.x,h-this._extend,a.z);c.push(e),e=new $b(b.x,h-this._extend,b.z),c.push(e)}else if("orthogonal.z"==this._linkType){var i=Math.max(a.z,b.z),e=new $b(a.x,a.y,i+this._extend);c.push(e),e=new $b(b.x,b.y,i+this._extend),c.push(e)}else if("orthogonal.z.n"==this._linkType){var j=Math.min(a.z,b.z),e=new $b(a.x,a.y,j-this._extend);c.push(e),e=new $b(b.x,b.y,j-this._extend),c.push(e)}else if("control"==this._linkType){var k=this._controls;if(k&&k.length>0)for(var l=0;l<k.length;l++)k[l]instanceof $b&&c.push(k[l].clone())}c.push(b.clone()),this.vertices=c}},onPropertyChange:function(){this.vertices=this.vertices||[],this.computeData(),this.computeBoundingBox(),this.selectionData=null,this.boundingSphere=null}}),Yb.PathLink=function(a,b,c){if(1===arguments.length&&arguments[0]instanceof Object&&!Array.isArray(arguments[0])){var d=arguments[0];a=d.fromNode,b=d.toNode,this._id=d.id}else this._id=c;Yb.PathNode.call(this),this._autoAjust=!0,this.setFromNode(a),this.setToNode(b)},Yb.PathLink.allLinkTypes=["extend.x","extend.y","extend.z","extend.x.n","extend.y.n","extend.z.n","orthogonal.x","orthogonal.y","orthogonal.z","orthogonal.x.n","orthogonal.y.n","orthogonal.z.n","flex.x","flex.y","flex.z","flex.yz","flex.xz","flex.xy"],Yb.extend(Yb.PathLink,Yb.PathNode,{className:"TGL.PathLink",___accessor:["linkType","extend","controls","fromOffset","toOffset"],__SizePropeties:["fromOffset","toOffset","path","segments","radius","segmentsR","startCap","endCap","shape","startCapSize","endCapSize","segmentsCap","arc","arcStart","cutSurface","startCapR","endCapR","startCapExtend","endCapExtend","fromNode","toNode","linkType","extend","controls"],setFromNode:function(a){if(this._fromNode!=a){var b=this._fromNode;this._fromNode=a,this._dirtyPath=!0,this.onPropertyChange("fromNode",b,a),this.firePropertyChange("fromNode",b,a),this._fromNode=a,b&&(b._removeFromLink(this),b.removePropertyChangeListener(this.handleNodePropertyChange)),this._fromNode&&(this._fromNode._addFromLink(this),this._fromNode.addPropertyChangeListener(this.handleNodePropertyChange,this))}},getFromNode:function(){return this._fromNode},setToNode:function(a){if(this._toNode!=a){var b=this._toNode;this._toNode=a,this.onPropertyChange("toNode",b,a),this.firePropertyChange("toNode",b,a),b&&(b.removePropertyChangeListener(this.handleNodePropertyChange),b._removeToLink(this)),this._toNode&&(this._toNode._addToLink(this),this._toNode.addPropertyChangeListener(this.handleNodePropertyChange,this))}},getToNode:function(){return this._toNode},isLooped:function(){return this._fromNode===this._toNode&&null!=this._fromNode&&null!=this._toNode},handleNodePropertyChange:function(a){var b=a.source,c=a.property;if(c.startsWith("position")||c.startsWith("rotation")||c.startsWith("scale")||"worldMatrix"==c||"linkAgent"===c||b.isSizeChangedProperty(c)||"parent"===c){this.vertices;this._dirtyPath=!0;var d=this;rc.PATH_LINK_COMPUTE_DELAY?setTimeout(function(){d._computePath()},10):d._computePath()}},_resetPath:function(){if(this.path){var a=!1;if("arrow"!==this.endCap)return this.path;if(this.endCapExtend*this.endCapR>1)return this.path;a=!0;var b,c,d,e=this.path,f=new Yb.Path,g=e.actions.length,h=null;for(c=0;g-1>c;c++)b=e.actions[c],d=b.args,h=new Yb.Vec3(d[0],d[1],d[2]),"moveTo"===b.action?f.moveTo(d[0],d[1],d[2]):"lineTo"===b.action?f.lineTo(d[0],d[1],d[2]):"quadraticCurveTo"===b.action&&(f.curveTo(d[0],d[1],d[2],d[3],d[4],d[5]),h=new Yb.Vec3(d[3],d[4],d[5]));if(c=g-1,b=e.actions[c],d=b.args,"lineTo"===b.action){var i=new Yb.Vec3(d[0],d[1],d[2]),j=(new $b).subVectors(i,h).normalize(),g=this.radius*this.endCapSize,k=null;k=(new $b).subVectors(i,h).length()<g?h.add(j.multiplyScalar(.1)):i.clone().sub(j.multiplyScalar(g)),f.lineTo(k.x,k.y,k.z)}return f}},_getNodeOffset:function(a,b,c){b=a.worldToLocal(b.clone()),c=a.worldToLocal(c.clone());var d=(new $b).subVectors(c,b),e=d.length(),f=a.getLinkOffset(d);return f&&f.length()>e&&f.normalize().multiplyScalar(e-.1),f||new $b(0,0,0)},updateMatrix:function(){},updateWorldMatrix:function(a,b){},onPropertyChange:function(a,b,c){("fromNode"===a||"toNode"===a||"linkType"===a||"extend"===a||"controls"===a||"fromOffset"===a||"toOffset"===a)&&(this._dirtyPath=!0),Yb.Node.prototype.onPropertyChange.call(this,a,b,c)},computeData:function(){return this._computePath(),Yb.PathNode.prototype.computeData.call(this)},_clearFromNodeExtend:function(a,b,c){},_flex:function(a,b,c,d,e){a=a.substr(a.indexOf(".")+1);for(var f,g=["x","y","z"],h=new $b,i=new $b,j=0;3>j;j++)f=g[j],h[f]=f===a?d[f]:b[f],i[f]=f===a?d[f]:c[f];e.push(h,i)},_flex2:function(a,b,c,d){a=a.substr(a.indexOf(".")+1);var e=["x","y","z"],f=a[0],g=a[1];if(b[f]!=c[f]){for(var h=new mono.Vec3,i=0;i<e.length;i++)h[e[i]]=e[i]==f?c[e[i]]:b[e[i]];d.push(h)}if(b[g]!=c[g]){for(var j=new mono.Vec3,i=0;i<e.length;i++)j[e[i]]=e[i]==f||e[i]==g?c[e[i]]:b[e[i]];d.push(j)}},_orthogonal:function(a,b,c,d){a=a.substr(a.indexOf(".")+1);var e,f=!1,g=["x","y","z"],h=new $b,i=0;a.endsWith(".n")&&(f=!0,a=a[0]);for(var j=f?b[a]:c[a],k=0;k<g.length;k++)e=g[k],e!==a&&b[e]==c[e]&&i++;if(2!==i){for(var k=0;k<g.length;k++)e=g[k],e!==a?h[e]=j:h[e]=f?c[e]:b[e];d.push(h)}},_removeSamePoint:function(a){},_computePath:function(){if(this._dirtyPath&&(this._dirtyPath=!1,null!=this._fromNode&&null!=this._toNode)){null==this._extend&&(this._extend=0);var a=this._fromNode.getLinkAgent()||this._fromNode,b=this._toNode.getLinkAgent()||this._toNode,c=a.localToWorld2(new $b(0,0,0)),d=b.localToWorld2(new $b(0,0,0));if(a==b){var e=new mono.Path;return e.moveTo(c.x,c.y,c.z),e.lineTo(c.x,c.y+200,c.z),e.lineTo(c.x+200,c.y+200,c.z),e.lineTo(c.x+200,c.y,c.z),e.lineTo(c.x,c.y,c.z),this.setPath(e),e}if(c.equals(d))return void this.setPath(null);var e,f,g=[],h=this.radius*this.endCapSize;if(this._linkType&&this._linkType.startsWith("extend")){var c,d,i,j,k,l,m;if("extend.x"===this._linkType){i=new $b(1,0,0);var c=a.localToWorld2(a.getLinkExtend(i.clone())),d=b.localToWorld2(b.getLinkExtend(i));m=Math.max(c.x,d.x),l=m+this._extend+h+.1,j=new $b(l,c.y,c.z),k=new $b(l,d.y,d.z)}else if("extend.y"===this._linkType){i=new $b(0,1,0);var c=a.localToWorld2(a.getLinkExtend(i.clone())),d=b.localToWorld2(b.getLinkExtend(i));m=Math.max(c.y,d.y),l=m+this._extend+h+.1,j=new $b(c.x,l,c.z),k=new $b(d.x,l,d.z)}else if("extend.z"===this._linkType){i=new $b(0,0,1);var c=a.localToWorld2(a.getLinkExtend(i.clone())),d=b.localToWorld2(b.getLinkExtend(i));m=Math.max(c.z,d.z),l=m+this._extend+h+.1,j=new $b(c.x,c.y,l),k=new $b(d.x,d.y,l)}else if("extend.x.n"===this._linkType){i=new $b(-1,0,0);var c=a.localToWorld2(a.getLinkExtend(i.clone())),d=b.localToWorld2(b.getLinkExtend(i));m=Math.min(c.x,d.x),l=m-this._extend-h-.1,j=new $b(l,c.y,c.z),k=new $b(l,d.y,d.z)}else if("extend.y.n"===this._linkType){i=new $b(0,-1,0);var c=a.localToWorld2(a.getLinkExtend(i.clone())),d=b.localToWorld2(b.getLinkExtend(i));m=Math.min(c.y,d.y),l=m-this._extend-h-.1,j=new $b(c.x,l,c.z),k=new $b(d.x,l,d.z)}else if("extend.z.n"===this._linkType){i=new $b(0,0,-1);var c=a.localToWorld2(a.getLinkExtend(i.clone())),d=b.localToWorld2(b.getLinkExtend(i));m=Math.min(c.z,d.z),l=m-this._extend-h-.1,j=new $b(c.x,c.y,l),k=new $b(d.x,d.y,l)}j?g.push(c,j,k,d):g.push(c,d)}else{if(g.push(c),"orthogonal.x"===this._linkType)if(c.y==d.y&&c.z==d.z);else{var n=d.x,o=new $b(n,c.y,c.z);g.push(o)}else if("orthogonal.x.n"===this._linkType){var n=c.x,o=new $b(n,d.y,d.z);g.push(o)}else if("orthogonal.y"===this._linkType){var p=d.y,o=new $b(c.x,p,c.z);g.push(o)}else if("orthogonal.y.n"===this._linkType){var p=c.y,o=new $b(d.x,p,d.z);g.push(o)}else if("orthogonal.z"===this._linkType){var o=new $b(c.x,c.y,d.z);g.push(o)}else if("orthogonal.z.n"===this._linkType){var o=new $b(d.x,d.y,c.z);g.push(o)}var q=new $b(c.x+d.x,c.y+d.y,c.z+d.z).multiplyScalar(.5);if(("flex.x"===this._linkType||"flex.y"===this._linkType||"flex.z"===this._linkType)&&this._flex(this._linkType,c,d,q,g),("flex.yz"===this._linkType||"flex.zy"===this._linkType||"flex.xy"===this._linkType||"flex.yx"===this._linkType||"flex.xz"===this._linkType||"flex.zx"===this._linkType)&&this._flex2(this._linkType,c,d,g),"control"===this._linkType){var r=this.getControls();sc.isArray(r)&&(g=g.concat(r))}g.push(d),f=g.length;var s=this._getNodeOffset(a,g[0].clone(),g[1].clone()),t=this._getNodeOffset(b,g[f-1].clone(),g[f-2].clone());c=a.localToWorld2(s),d=b.localToWorld2(t),g[0]=c,g[f-1]=d}var f=g.length,u=this.getFromOffset(),v=this.getToOffset();u&&g[0].add(u),v&&g[f-1].add(v);for(var w,e=new Yb.Path,x=0;f>x;x++)w=g[x],0===x?e.moveTo(w.x,w.y,w.z):e.lineTo(w.x,w.y,w.z);return this.setPath(e),e}}}),mono.LoadingManager=function(a,b,c){var d=this,f=0,g=0;this.onLoad=a,this.onProgress=b,this.onError=c,this.itemStart=function(a){g++},this.itemEnd=function(a){f++,d.onProgress!==e&&d.onProgress(a,f,g),f===g&&d.onLoad!==e&&d.onLoad()}},mono.DefaultLoadingManager=new mono.LoadingManager,mono.ImageLoader=function(a){this.manager=a!==e?a:mono.DefaultLoadingManager},mono.ImageLoader.prototype={constructor:mono.ImageLoader,load:function(a,b,c,d){var f=this,g=document.createElement("img");return b!==e&&g.addEventListener("load",function(c){f.manager.itemEnd(a),b(this)},!1),c!==e&&g.addEventListener("progress",function(a){c(a)},!1),d!==e&&g.addEventListener("error",function(a){d(a)},!1),this.crossOrigin!==e&&(g.crossOrigin=this.crossOrigin),g.src=a,f.manager.itemStart(a),g},loadFile:function(a,b,c,d){var f=this,g=new FileReader;b!==e&&(g.onload=function(){b(g.result),f.manager.itemEnd(a.name)}),c!==e&&g.addEventListener("progress",function(a){c(a)},!1),d!==e&&g.addEventListener("error",function(a){d(a)},!1),g.readAsDataURL(a),f.manager.itemStart(a.name)},setCrossOrigin:function(a){this.crossOrigin=a}},mono.XHRLoader=function(a){this.manager=a!==e?a:mono.DefaultLoadingManager},mono.XHRLoader.prototype={constructor:mono.XHRLoader,load:function(a,b,c,d){var f=this,g=new XMLHttpRequest;b!==e&&g.addEventListener("load",function(c){b(c.target.responseText),f.manager.itemEnd(a)},!1),c!==e&&g.addEventListener("progress",function(a){c(a)},!1),d!==e&&g.addEventListener("error",function(a){d(a)},!1),this.crossOrigin!==e&&(g.crossOrigin=this.crossOrigin),g.open("GET",a,!0),g.send(null),f.manager.itemStart(a)},loadFile:function(a,b,c,d){if(a){var f=this,g=new FileReader;b!==e&&(g.onload=function(){b(g.result),f.manager.itemEnd(a.name)}),c!==e&&g.addEventListener("progress",function(a){c(a)},!1),d!==e&&g.addEventListener("error",function(a){d(a)},!1),g.readAsText(a),f.manager.itemStart(a.name)}},setCrossOrigin:function(a){this.crossOrigin=a}},mono.MTLLoader=function(a,b,c){this.baseUrl=a,this.options=b,this.crossOrigin=c},mono.extend(mono.MTLLoader,null,{constructor:mono.MTLLoader,load:function(a,b,c,d){var e=this,f=new mono.XHRLoader;f.setCrossOrigin(this.crossOrigin),f.load(a,function(a){b(e.parse(a))})},loadFile:function(a,b,c,d){var e=this,f=new mono.XHRLoader;f.loadFile(a,function(a){b(e.parse(a))})},loadText:function(a,b){b(this.parse(a))},parse:function(a){var b=a.split("\n"),c={},d=/\s+/,e={};this.baseUrl||(this.baseUrl={});for(var f=0;f<b.length;f++){var g=b[f];if(g=g.trim(),0!==g.length&&"#"!==g.charAt(0)){var h=g.indexOf(" "),i=h>=0?g.substring(0,h):g;i=i.toLowerCase();var j=h>=0?g.substring(h+1):"";if(j=j.trim(),"newmtl"===i)c={name:j},e[j]=c;else if(c)if("ka"===i||"kd"===i||"ks"===i){var k=j.split(d,3);c[i]=[parseFloat(k[0]),parseFloat(k[1]),parseFloat(k[2])]}else if("map_kd"===i||"map_ka"===i){var l=j;if(j.indexOf(".")>0){j=j.substring(0,j.lastIndexOf(".")).toLowerCase();var m={};if(/\-s/.test(j)){var n=/\-s( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)/;m=n.exec(j);var o=j.split(m[0]);j=o[o.length-1].trim();var p=l.split(m[0]);l=p[p.length-1].trim()}if(/\-t/.test(j)){var n=/\-t( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)/;m=n.exec(j);var o=j.split(m[0]);j=o[o.length-1].trim();var p=l.split(m[0]);l=p[p.length-1].trim()}}this.baseUrl[j]||(this.baseUrl[j]=l),c[i]=l}else c[i]=j}}var q=new mono.MTLLoader.MaterialCreator(this.baseUrl,this.options);return q.setMaterials(e),q}}),mono.MTLLoader.MaterialCreator=function(a,b){this.baseUrl=a,this.options=b,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.side=this.options&&this.options.side?this.options.side:mono.FrontSide,this.wrap=this.options&&this.options.wrap?this.options.wrap:mono.RepeatWrapping},mono.extend(mono.MTLLoader.MaterialCreator,mono.EventDispatcher,{constructor:mono.MTLLoader.MaterialCreator,setMaterials:function(a){this.materialsInfo=this.convert(a),this.materials={},this.materialsArray=[],this.nameLookup={}},convert:function(a){if(!this.options)return a;var b={};for(var c in a){var d=a[c],e={};b[c]=e;for(var f in d){var g=!0,h=d[f],i=f.toLowerCase();switch(i){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(h=[h[0]/255,h[1]/255,h[2]/255]),this.options&&this.options.ignoreZeroRGBs&&0===h[0]&&0===h[1]&&0===h[1]&&(g=!1);break;case"d":this.options&&this.options.invertTransparency&&(h=1-h)}g&&(e[i]=h)}}return b},preload:function(){for(var a in this.materialsInfo)this.create(a)},getIndex:function(a){return this.nameLookup[a]},getAsArray:function(){var a=0;for(var b in this.materialsInfo)this.materialsArray[a]=this.create(b),this.nameLookup[b]=a,a++;return this.materialsArray},create:function(a){return this.materials[a]===e&&this.createMaterial_(a),this.materials[a]},createMaterial_:function(a){var b=this,c=this.materialsInfo[a],d={name:a,side:this.side};for(var e in c){var f=c[e];switch(e.toLowerCase()){case"kd":d.diffuse=(new mono.Color).setRGB(f[0],f[1],f[2]);break;case"ka":d.ambient=(new mono.Color).setRGB(f[0],f[1],f[2]);break;case"ks":d.specular=(new mono.Color).setRGB(f[0],f[1],f[2]);break;case"map_kd":if("string"==typeof this.baseUrl)d.map={},d.map.img=this.baseUrl+f,d.map.wrapS=this.wrap,d.map.wrapT=this.wrap;else if("object"==typeof this.baseUrl&&f.indexOf(".")>0){f=f.substring(0,f.lastIndexOf(".")).toLowerCase();var g={};if(/\-s/.test(f)){var h=/\-s( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)/;g=h.exec(f);var i=f.split(g[0]);f=i[i.length-1].trim(),g.repeatR=parseInt(g[1]),g.repeatC=parseInt(g[2])}if(/\-t/.test(f)){var h=/\-t( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)/;g=h.exec(f);var i=f.split(g[0]);f=i[i.length-1].trim(),g.repeatR=parseInt(g[1]),g.repeatC=parseInt(g[2])}this.baseUrl[f]&&(d.map={},d.map.img=this.baseUrl[f],d.map.wrapS=b.wrap,d.map.wrapT=b.wrap,d.map.repeatR=g.repeatR||1,d.map.repeatC=g.repeatC||1)}break;case"ns":d.shininess=f;break;case"d":1>f&&(d.transparent=!0,d.opacity=f)}}return d.diffuse&&(d.ambient||(d.ambient=d.diffuse),d.color=d.diffuse),this.materials[a]=d,this.materials[a]},loadTexture:function(a,b,c,d){var e=/\.dds$/i.test(a);if(e)var f=mono.ImageUtils.loadCompressedTexture(a,b,c,d);else{var g=new Image,f=new mono.Texture(g,b),h=new mono.ImageLoader;h.crossOrigin=this.crossOrigin,h.load(a,function(a){f.image=mono.MTLLoader.ensurePowerOfTwo_(a),f.needsUpdate=!0,c&&c(f)})}return f}}),mono.MTLLoader.ensurePowerOfTwo_=function(a){if(!mono.MTLLoader.isPowerOfTwo_(a.width)||!mono.MTLLoader.isPowerOfTwo_(a.height)){var b=document.createElement("canvas");b.width=mono.MTLLoader.nextHighestPowerOfTwo_(a.width),b.height=mono.MTLLoader.nextHighestPowerOfTwo_(a.height);var c=b.getContext("2d");return c.drawImage(a,0,0,a.width,a.height,0,0,b.width,b.height),b}return a},mono.MTLLoader.isPowerOfTwo_=function(a){return 0===(a&a-1)},mono.MTLLoader.nextHighestPowerOfTwo_=function(a){--a;for(var b=1;32>b;b<<=1)a|=a>>b;return a+1},mono.OBJLoader=function(a){this.manager=a!==e?a:mono.DefaultLoadingManager},mono.extend(mono.OBJLoader,Object,{constructor:mono.ObJLoader,load:function(a,b,c,d){var e=this,f=new mono.XHRLoader(e.manager);f.setCrossOrigin(this.crossOrigin),f.load(a,function(a){b(e.parse(a))})},parse:function(a){function b(a,b,c){return new mono.Vec3(a,b,c)}function c(a,b){return new mono.Vec2(a,b)}function d(a,b,c,d){return new mono.Face3(a,b,c,d)}function f(a,b,c,f){f===e?i.faces.push(d(parseInt(a)-(l+1),parseInt(b)-(l+1),parseInt(c)-(l+1))):i.faces.push(d(parseInt(a)-(l+1),parseInt(b)-(l+1),parseInt(c)-(l+1),[n[parseInt(f[0])-1].clone(),n[parseInt(f[1])-1].clone(),n[parseInt(f[2])-1].clone()]))}function g(a,b,c){i.uvs.push([o[parseInt(a)-1].clone(),o[parseInt(b)-1].clone(),o[parseInt(c)-1].clone()])}function h(a,b,c){a[3]===e?(f(a[0],a[1],a[2],c),b!==e&&b.length>0&&g(b[0],b[1],b[2])):(c!==e&&c.length>0?(f(a[0],a[1],a[3],[c[0],c[1],c[3]]),f(a[1],a[2],a[3],[c[1],c[2],c[3]])):(f(a[0],a[1],a[3]),f(a[1],a[2],a[3])),b!==e&&b.length>0&&(g(b[0],b[1],b[3]),g(b[1],b[2],b[3])))}var i,j,k=new mono.Element,l=0;/^o /gm.test(a)===!1&&(i=new mono.Entity,j=new mono.BasicMaterial,i.setStyle("m.type","phong"),k.addChild(i));for(var m=0,n=[],o=[],p=/v( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)/,q=/vn( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)/,r=/vt( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)/,s=/f( +\d+)( +\d+)( +\d+)( +\d+)?/,t=/f( +(\d+)\/(\d+))( +(\d+)\/(\d+))( +(\d+)\/(\d+))( +(\d+)\/(\d+))?/,u=/f( +(\d+)\/(\d+)\/(\d+))( +(\d+)\/(\d+)\/(\d+))( +(\d+)\/(\d+)\/(\d+))( +(\d+)\/(\d+)\/(\d+))?/,v=/f( +(\d+)\/\/(\d+))( +(\d+)\/\/(\d+))( +(\d+)\/\/(\d+))( +(\d+)\/\/(\d+))?/,w=a.split("\n"),x=0;x<w.length;x++){var y=w[x];y=y.trim();var z;if(0!==y.length&&"#"!==y.charAt(0))if(null!==(z=p.exec(y)))i.vertices.push(b(parseFloat(z[1]),parseFloat(z[2]),parseFloat(z[3])));else if(null!==(z=q.exec(y)))n.push(b(parseFloat(z[1]),parseFloat(z[2]),parseFloat(z[3])));else if(null!==(z=r.exec(y)))o.push(c(parseFloat(z[1]),parseFloat(z[2])));else if(null!==(z=s.exec(y)))h([z[1],z[2],z[3],z[4]]);else if(null!==(z=t.exec(y)))h([z[2],z[5],z[8],z[11]],[z[3],z[6],z[9],z[12]]);else if(null!==(z=u.exec(y)))h([z[2],z[6],z[10],z[14]],[z[3],z[7],z[11],z[15]],[z[4],z[8],z[12],z[16]]);else if(null!==(z=v.exec(y)))h([z[2],z[5],z[8],z[11]],[],[z[3],z[6],z[9],z[12]]);else if(/^o /.test(y))i!==e&&(l+=i.vertices.length),i=new mono.Entity,j=new mono.BasicMaterial,i.setStyle("m.type","phong"),i._name=y.substring(2).trim(),k.addChild(i),m=0;else if(/^g /.test(y));else if(/^usemtl /.test(y)){y.substring(7).trim()}else/^mtllib /.test(y)||/^s /.test(y)}for(var x=0,A=k._childList._as.length;A>x;x++){var i=k._childList._as[x];i.computed=!1,i.computeNodeData(),i.computeCentroids(),i.computeFaceNormals(),i.computeBoundingSphere()}return k}}),mono.OBJMTLLoader=function(){},mono.extend(mono.OBJMTLLoader,mono.MTLLoader,{constructor:mono.OBJMTLLoader,load:function(a,b,c,d,e,f){var g=this,h=new mono.MTLLoader(c);h.load(b,function(b){var e=b;e.preload();var f=new mono.XHRLoader(g.manager);f.setCrossOrigin(this.crossOrigin),f.load(a,function(b){var f=g.parse(b),h="";!c&&a.lastIndexOf("/")>0&&(h=a.substring(0,a.lastIndexOf("/")+1));for(var i=0;i<f._childList._as.length;i++){var j=f._childList._as[i];if(j.mname){var k=e.create(j.mname);g.setGeometryStyle(j,k,h)}for(var l=0;l<j._childList._as.length;l++){var m=j._childList._as[l];if(m.mname){var n=e.create(m.mname);g.setGeometryStyle(m,n,h)}}}d(f)})})},setGeometryStyle:function(a,b,c){if(b.map){c?this.loadTexture(a,c+b.map.img):this.loadTexture(a,b.map.img);var d=b.map.repeatR,e=b.map.repeatC;d&&e&&a.setStyle("m.texture.repeat",new mono.Vec2(d,e))}a.setStyle("m.ambient",b.ambient),a.setStyle("m.specular",b.specular),a.setStyle("m.color",b.color),b.transparent&&(a.setStyle("m.transparent",!0),a.setStyle("m.opacity",b.opacity))},loadBase64:function(a,b,c,d,e,f){var g=this,h=mono.base64decode(b),i=mono.base64decode(a),j=new mono.MTLLoader(c);j.loadText(h,function(a){var b=a;b.preload();var e=g.parse(i),f="";!c&&url.lastIndexOf("/")>0&&(f=url.substring(0,url.lastIndexOf("/")+1));for(var h=0;h<e._childList._as.length;h++){var j=e._childList._as[h];if(j.mname){var k=b.create(j.mname);g.setGeometryStyle(j,k,f)}for(var l=0;l<j._childList._as.length;l++){var m=j._childList._as[l];if(m.mname){var n=b.create(m.mname);g.setGeometryStyle(m,n,f)}}}d(e)})},loadFiles:function(a,b,c,d,e,f){var g=this,h=new mono.MTLLoader(c);h.loadFile(b,function(b){var c=b;c.preload();var e=new mono.XHRLoader(g.manager);e.loadFile(a,function(a){for(var b=g.parse(a),e=0;e<b._childList._as.length;e++){var f=b._childList._as[e];if(f.mname){var h=c.create(f.mname);g.setGeometryStyle(f,h)}for(var i=0;i<f._childList._as.length;i++){var j=f._childList._as[i];if(j.mname){var k=c.create(j.mname);g.setGeometryStyle(j,k)}}}d(b)})})},loadTexture:function(a,b){if("string"==typeof b)a.setStyle("m.texture.image",b);else if(a&&b){var c=new mono.ImageLoader;c.loadFile(b,function(b){a.setStyle("m.texture.image",b)})}},parse:function(a,b){function c(a,b,c){return new mono.Vec3(a,b,c)}function d(a,b){return new mono.Vec2(a,b)}function f(a,b,c,d,e){return new mono.Face3(a,b,c,d,null,e)}function g(a,b){if(o.length>0&&(n.vertices=o,s.length>0&&(n.setMaterialSize(s.length),n.setStyle("m.normalType",Yb.NormalTypeSmooth)),n.computed=!1,n.computeCentroids(),n.computeFaceNormals(),n.computeBoundingSphere(),n.faces.length>0)){var c=n._name;m.addChild(n),n=new mono.Entity,n._name=c,n.setStyle("m.type","phong"),p=0}a!==e&&(n._name=a),b!==e&&(n.mname=b)}function h(a,b,c,d,g){d===e?n.faces.push(f(parseInt(a)-(k+1),parseInt(b)-(k+1),parseInt(c)-(k+1))):n.faces.push(f(parseInt(a)-(k+1),parseInt(b)-(k+1),parseInt(c)-(k+1),[q[parseInt(d[0])-1].clone(),q[parseInt(d[1])-1].clone(),q[parseInt(d[2])-1].clone()],g))}function i(a,b,c){n.uvs.push([r[parseInt(a)-1].clone(),r[parseInt(b)-1].clone(),r[parseInt(c)-1].clone()])}function j(a,b,c){var d=s.length>0?s.indexOf(t):0;a[3]===e?(h(a[0],a[1],a[2],c,d),b!==e&&b.length>0&&i(b[0],b[1],b[2])):(c!==e&&c.length>0?(h(a[0],a[1],a[3],[c[0],c[1],c[3]],d),h(a[1],a[2],a[3],[c[1],c[2],c[3]],d)):(h(a[0],a[1],a[3]),h(a[1],a[2],a[3])),b!==e&&b.length>0&&(i(b[0],b[1],b[3]),i(b[1],b[2],b[3])))}var k=0,l=new mono.Entity,m=l,n=new mono.Entity;n.setStyle("m.type","phong");for(var o=[],p=0,q=[],r=[],s=[],t=0,u=/v( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)/,v=/vn( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)/,w=/vt( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)/,x=/f( +\d+)( +\d+)( +\d+)( +\d+)?/,y=/f( +(\d+)\/(\d+))( +(\d+)\/(\d+))( +(\d+)\/(\d+))( +(\d+)\/(\d+))?/,z=/f( +(\d+)\/(\d+)\/(\d+))( +(\d+)\/(\d+)\/(\d+))( +(\d+)\/(\d+)\/(\d+))( +(\d+)\/(\d+)\/(\d+))?/,A=/f( +(\d+)\/\/(\d+))( +(\d+)\/\/(\d+))( +(\d+)\/\/(\d+))( +(\d+)\/\/(\d+))?/,B=/s( +(\d))?/,C=a.split("\n"),D=0;D<C.length;D++){var E=C[D];E=E.trim();var F;if(0!==E.length&&("#"!==E.charAt(0)||"o"==E.charAt(2)))if(null!==(F=u.exec(E)))o.push(c(parseFloat(F[1]),parseFloat(F[2]),parseFloat(F[3])));else if(null!==(F=v.exec(E)))q.push(c(parseFloat(F[1]),parseFloat(F[2]),parseFloat(F[3])));else if(null!==(F=w.exec(E)))r.push(d(parseFloat(F[1]),parseFloat(F[2])));else if(null!==(F=x.exec(E)))j([F[1],F[2],F[3],F[4]]);else if(null!==(F=y.exec(E)))j([F[2],F[5],F[8],F[11]],[F[3],F[6],F[9],F[12]]);else if(null!==(F=z.exec(E)))j([F[2],F[6],F[10],F[14]],[F[3],F[7],F[11],F[15]],[F[4],F[8],F[12],F[16]]);else if(null!==(F=A.exec(E)))j([F[2],F[5],F[8],F[11]],[],[F[3],F[6],F[9],F[12]]);else if("#"===E.charAt(0)&&"o"===E.charAt(2))g(),k+=o.length,o=[],m=new mono.Entity,m._name=E.substring(2).trim(),l.addChild(m);else if(/^g /.test(E))g(E.substring(2).trim(),e);else if(/^usemtl /.test(E))g(e,E.substring(7).trim());else if(/^mtllib /.test(E)){if(b){var G=E.substring(7);G=G.trim(),b(G)}}else/^s /.test(E)&&(F=B.exec(E),s.indexOf(F[2])<0&&s.push(F[2]),t=F[2])}return g(e,e),l}}),DaeAdapter=mono.DaeAdapter=function(){function a(a,c,d){var f=0;if(a!==e){var g=a.split("/");g.pop(),Y=(g.length<1?".":g.join("/"))+"/"}var h=new XMLHttpRequest;h.onreadystatechange=function(){if(4==h.readyState){if(0==h.status||200==h.status)if(h.responseXML)b(h.responseXML,c,a);else if(h.responseText){var e=new DOMParser,g=e.parseFromString(h.responseText,"application/xml");b(g,c,a)}else console.error("ColladaLoader: Empty or non-existing file ("+a+")")}else 3==h.readyState&&d&&(0==f&&(f=h.getResponseHeader("Content-Length")),d({total:f,loaded:h.responseText.length}))},h.open("GET",a,!0),h.send(null)}function b(a,b,e){Q=a,C(),V=m(),T=new h,T.parse();var f=O();if(X=E(),W=G(),$=d(),T)for(var g=0;g<T.nodes.length;g++)c(T.nodes[g]);var i={lights:f,visualScenes:T,images:X,materials:$,geometries:V,entityies:Z};b&&b(i)}function c(a,b){if(a){for(var d={},e=0;e<a.geometries.length;e++){var f,g=a.geometries[e],h=g.instance_material,i=V[g.url],j={},k=[],l=0;if(i){if(!i.mesh||!i.mesh.primitives)continue;if(h)for(var m=0;m<h.length;m++){var n=h[m],o=$[n.target],p=o.instance_effect.url,q=W[p].shader,r=q.material;if(i.doubleSided){if(!(n.symbol in d)){var s=r.clone();s.side=mono.DoubleSide,d[n.symbol]=s}r=d[n.symbol]}r.opacity=r.opacity?r.opacity:1,j[n.symbol]=l,k.push(r),f=r,f.name=null==o.name||""===o.name?o.id:o.name,l++}var t=f||new mono.LambertMaterial({color:14540253,shading:mono.FlatShading,side:i.doubleSided?mono.DoubleSide:mono.FrontSide}),u=i.mesh.node3D;if(l>1)for(t=new mono.ArrayMaterial(k),m=0;m<u.faces.length;m++){var v=u.faces[m];v.materialIndex=j[v.daeMaterial]}t instanceof mono.ArrayMaterial&&u.setMaterialSize(t.materials.length),u.createMaterial(t),u.matrix=a.matrix,u.matrix.decompose(u._position,u.quaternion,u.scale);var w=u.quaternion;if(w){var x=w.x*w.x,y=w.y*w.y,z=w.z*w.z,A=w.w*w.w;u._rotation.x=Math.atan2(2*(w.x*w.w-w.y*w.z),A-x-y+z),u._rotation.y=Math.asin(mono.Math.clamp(2*(w.x*w.z+w.y*w.w),-1,1)),u._rotation.z=Math.atan2(2*(w.z*w.w-w.x*w.y),A+x-y-z)}Z.push(u)}}for(var m=0;m<a.nodes.length;m++)c(a.nodes[m],a)}}function d(){var a=Q.querySelectorAll("library_materials material"),b={};if(a&&a.length>0)for(var c=0;c<a.length;c++){var d=a[c];if(d){var e=(new f).parse(d);e&&(b[e.id]=e)}}return b}function f(){this.id="",this.name="",this.instance_effect=null}function g(){this.url=""}function h(){this.nodes=[],this.id="",this.name=""}function i(){this.nodes=[],this.id="",this.name="",this.sid="",this.type="",this.controllers=[],this.geometries=[],this.type="",this.layer="",this.matrix=new mono.Mat4,this.transforms=[]}function j(){this.sid="",this.type="",this.data=[]}function k(){this.url="",this.instance_material=[]}function l(){this.symbol="",this.target=""}function m(){var a={};a.entity=[];var b=Q.querySelectorAll("library_geometries geometry");if(b&&b.length>0)for(var c=0;c<b.length;c++){var d=(new n).parse(b[c]);d&&(a[d.id]=d,a.entity.push(d))}return a}function n(){this.id="",this.mesh=null}function o(){this.sources={},this.primitives=[],this.vertices=null,this.node3D=null}function p(a,b){var c=[a[b],a[b+1],a[b+2]];return q(c,-1),new mono.Vec3(c[0],c[1],c[2])}function q(a,b){if(_.convertUpAxis===!0&&R!==_.upAxis)switch(S){case"XtoY":var c=a[0];a[0]=b*a[1],a[1]=c;break;case"XtoZ":var c=a[2];a[2]=a[1],a[1]=a[0],a[0]=c;break;case"YtoX":var c=a[0];a[0]=a[1],a[1]=b*c;break;case"YtoZ":var c=a[1];a[1]=b*a[2],a[2]=c;break;case"ZtoX":var c=a[0];a[0]=a[1],a[1]=a[2],a[2]=c;break;case"ZtoY":var c=a[1];a[1]=a[2],a[2]=b*c}}function r(){this.id="",this.input={}}function s(){this.semantic="",this.offset=0,this.source="",this.set=0}function t(){this.inputs=[],this.count=0,this.p=[],this.material=""}function u(){t.call(this),this.vcount=3}function v(){this.id,this.dataType,this.technique_common={},this.accessor=null,this.data=[]}function w(){this.source="",this.count=0,this.stride=0,this.params=[]}function x(a){return a?parseInt(a,10):0}function y(a){return a.replace(/^\s+/,"").replace(/\s+$/,"")}function z(a){var b=[];if(!a)return a;if(a=y(a),a.length>0)for(var c=a.split(/\s+/),d=0;d<c.length;d++){
var f=c[d];f!=e&&null!=f&&null!=parseFloat(f)&&b.push(parseFloat(f))}return b}function A(a){var b=[];if(!a)return[];if(a=y(a),a.length>0)for(var c=a.split(/\s+/),d=0;d<c.length;d++){var f=c[d];f!=e&&null!=f&&null!=parseInt(f)&&b.push(parseInt(f))}return b}function B(a){var b=[];if(!a)return[];if(a=y(a),a.length>0)for(var c=a.split(/\s+/),d=0;d<c.length;d++)b.push("true"==c[d]||"1"==c[d]?!0:!1);return b}function C(){if(_.convertUpAxis!==!0||R===_.upAxis)S=null;else switch(R){case"X":S="Y"===_.upAxis?"XtoY":"XtoZ";break;case"Y":S="X"===_.upAxis?"YtoX":"YtoZ";break;case"Z":S="X"===_.upAxis?"ZtoX":"ZtoY"}}function D(a){if(_.convertUpAxis){var b=[a[0],a[4],a[8]];q(b,-1),a[0]=b[0],a[4]=b[1],a[8]=b[2],b=[a[1],a[5],a[9]],q(b,-1),a[1]=b[0],a[5]=b[1],a[9]=b[2],b=[a[2],a[6],a[10]],q(b,-1),a[2]=b[0],a[6]=b[1],a[10]=b[2],b=[a[0],a[1],a[2]],q(b,-1),a[0]=b[0],a[1]=b[1],a[2]=b[2],b=[a[4],a[5],a[6]],q(b,-1),a[4]=b[0],a[5]=b[1],a[6]=b[2],b=[a[8],a[9],a[10]],q(b,-1),a[8]=b[0],a[9]=b[1],a[10]=b[2],b=[a[3],a[7],a[11]],q(b,-1),a[3]=b[0],a[7]=b[1],a[11]=b[2]}return new mono.Mat4(a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15])}function E(){var a=Q.querySelectorAll("library_images image"),b={};if(a&&a.length>0)for(var c=0;c<a.length;c++){var d=a[c];if(d){var e=(new F).parse(d);b[e.id]=e}}return b}function F(){this.id="",this.init_from=""}function G(){var a=Q.querySelectorAll("library_effects effect"),b={};if(a&&a.length>0)for(var c=0;c<a.length;c++){var d=a[c];if(d){var e=(new H).parse(d);b[e.id]=e}}return b}function H(){this.id="",this.name="",this.shader=null,this.surface={},this.sampler={}}function I(a,b){this.type=a,this.effect=b,this.material=null}function J(){this.color=new mono.Color,this.color.setRGB(Math.random(),Math.random(),Math.random()),this.color.a=1,this.texture=null,this.texcoord=null,this.texOpts=null}function K(a){this.effect=a,this.init_from=null,this.format=null}function L(a){this.effect=a,this.source=null,this.wrap_s=null,this.wrap_t=null,this.minfilter=null,this.magfilter=null,this.mipfilter=null}function M(a){for(var b=Q.querySelectorAll("library_nodes node"),c=0;c<b.length;c++){var d=b[c].attributes.getNamedItem("id");if(d&&d.value===a)return b[c]}return e}function N(a,b){a.doubleSided=!1;var c=b.querySelectorAll("extra double_sided")[0];c&&c&&1===parseInt(c.textContent,10)&&(a.doubleSided=!0)}function O(){var a=[],b=Q.querySelectorAll("library_lights light");if(b&&b.length>0)for(var c=0;c<b.length;c++){var d=(b[c],(new P).parse(b));a.push(d)}return a}function P(){this.id="",this.name="",this.technique=""}this.id="",this.name="",this.type="";var Q=null,R="Y",S=null,T=null,U={},V={},W={},X={},Y="",Z=[],$={},_={};return f.prototype.parse=function(a){this.id=a.getAttribute("id"),this.name=a.getAttribute("name");for(var b=0;b<a.childNodes.length;b++)if("instance_effect"==a.childNodes[b].nodeName){this.instance_effect=(new g).parse(a.childNodes[b]);break}return this},g.prototype.parse=function(a){return this.url=a.getAttribute("url").replace(/^#/,""),this},h.prototype.parse=function(){var a=Q.querySelectorAll("library_visual_scenes visual_scene");if(!a||a.length<0)return this;this.id="",this.name="";for(var b=0;b<a.length;b++){var c=a[b];if(c&&c.childNodes&&c.childNodes.length>0)for(var d=0;d<c.childNodes.length;d++){var e=c.childNodes[d];if(e&&e.nodeName)switch(e.nodeName){case"node":this.nodes.push((new i).parse(e))}}}return this},i.prototype.parse=function(a){if(!a)return this;if(this.id=a.getAttribute("id"),this.sid=a.getAttribute("sid"),this.name=a.getAttribute("name"),this.type=a.getAttribute("type"),this.layer=a.getAttribute("layer"),this.type="JOINT"==this.type?this.type:"NODE",a.childNodes.length>0)for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(c&&c.nodeName)switch(c.nodeName){case"node":this.nodes.push((new i).parse(c));break;case"instance_camera":break;case"instance_controller":break;case"instance_geometry":this.geometries.push((new k).parse(c));break;case"instance_light":break;case"instance_node":var d=c.getAttribute("url").replace(/^#/,""),e=M(d);e&&this.nodes.push((new i).parse(e));break;case"rotate":case"translate":case"scale":case"matrix":case"lookat":case"skew":this.transforms.push((new j).parse(c));break;case"extra":break;default:console.log(c.nodeName)}}return this.updateMatrix(),this},i.prototype.updateMatrix=function(){this.matrix.identity();for(var a=0;a<this.transforms.length;a++)this.transforms[a].apply(this.matrix)},j.prototype.parse=function(a){return this.sid=a.getAttribute("sid"),this.type=a.nodeName,this.data=z(a.textContent),this.convert(),this},j.prototype.convert=function(){switch(this.type){case"matrix":this.obj=D(this.data);break;case"rotate":this.angle=mono.Math.degToRad(this.data[3]);case"translate":q(this.data,-1),this.obj=new mono.Vec3(this.data[0],this.data[1],this.data[2]);break;case"scale":q(this.data,1),this.obj=new mono.Vec3(this.data[0],this.data[1],this.data[2]);break;default:console.log("Can not convert Transform of type "+this.type)}},j.prototype.apply=function(){var a=new mono.Mat4;return function(b){switch(this.type){case"matrix":b.multiply(this.obj);break;case"translate":b.multiply(a.makeTranslation(this.obj.x,this.obj.y,this.obj.z));break;case"rotate":b.multiply(a.makeRotationAxis(this.obj,this.angle));break;case"scale":b.scale(this.obj)}}}(),j.prototype.update=function(a,b){var c=["X","Y","Z","ANGLE"];switch(this.type){case"matrix":if(b)if(1===b.length)switch(b[0]){case 0:this.obj.n11=a[0],this.obj.n21=a[1],this.obj.n31=a[2],this.obj.n41=a[3];break;case 1:this.obj.n12=a[0],this.obj.n22=a[1],this.obj.n32=a[2],this.obj.n42=a[3];break;case 2:this.obj.n13=a[0],this.obj.n23=a[1],this.obj.n33=a[2],this.obj.n43=a[3];break;case 3:this.obj.n14=a[0],this.obj.n24=a[1],this.obj.n34=a[2],this.obj.n44=a[3]}else if(2===b.length){var d="n"+(b[0]+1)+(b[1]+1);this.obj[d]=a}else console.log("Incorrect addressing of matrix in transform.");else this.obj.copy(a);break;case"translate":case"scale":switch("[object Array]"===Object.prototype.toString.call(b)&&(b=c[b[0]]),b){case"X":this.obj.x=a;break;case"Y":this.obj.y=a;break;case"Z":this.obj.z=a;break;default:this.obj.x=a[0],this.obj.y=a[1],this.obj.z=a[2]}break;case"rotate":switch("[object Array]"===Object.prototype.toString.call(b)&&(b=c[b[0]]),b){case"X":this.obj.x=a;break;case"Y":this.obj.y=a;break;case"Z":this.obj.z=a;break;case"ANGLE":this.angle=mono.Math.degToRad(a);break;default:this.obj.x=a[0],this.obj.y=a[1],this.obj.z=a[2],this.angle=mono.Math.degToRad(a[3])}}},k.prototype.parse=function(a){this.url=a.getAttribute("url").replace(/^#/,""),this.instance_material=[];for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(1==c.nodeType&&"bind_material"==c.nodeName){for(var d=c.querySelectorAll("instance_material"),e=0;e<d.length;e++){var f=d[e];this.instance_material.push((new l).parse(f))}break}}return this},l.prototype.parse=function(a){return this.symbol=a.getAttribute("symbol"),this.target=a.getAttribute("target").replace(/^#/,""),this},n.prototype.parse=function(a){this.id=a.getAttribute("id");for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(c&&"mesh"==c.nodeName){var d=new o,e=d.parse(c);e&&(this.mesh=e)}}return this},o.prototype.parse=function(a){if(a&&a.childNodes&&a.childNodes.length>0)for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];switch(c.nodeName){case"source":var d=c.getAttribute("id");this.sources[d]=(new v).parse(c);break;case"vertices":var e=new r;this.vertices=e.parse(c);break;case"polygons":var f=(new t).parse(c);f&&this.primitives.push(f);break;case"triangles":var g=(new u).parse(c);g&&this.primitives.push(g);break;case"polylist":var h=null;this.primitives.push(h)}}this.node3D=new mono.Entity;var i=null;for(this.vertices&&this.vertices.input&&this.vertices.input.POSITION&&(i=this.sources[this.vertices.input.POSITION.source].data),b=0;b<this.primitives.length;b++){var j=this.primitives[b];j.setVertices(this.vertices),this.handlePrimitive(j,this.node3D)}for(b=0;b<i.length;b+=3)this.node3D.vertices.push(p(i,b).clone());return this.node3D.computeFaceNormals(),this},o.prototype.handlePrimitive=function(a,b){var c,d,f,g,h,i,j,k=a.p,l=a.inputs,m=0,n=3,o=0,q=[];for(c=0;c<l.length;c++){f=l[c];var r=f.offset+1;switch(o=r>o?r:o,f.semantic){case"TEXCOORD":q.push(f.set)}}for(var s=0;s<k.length;++s)for(var t=k[s],u=0;u<t.length;){var v=[],w=[],x=null,y=[];for(n=a.vcount?a.vcount.length?a.vcount[m++]:a.vcount:t.length/o,c=0;n>c;c++)for(d=0;d<l.length;d++)switch(f=l[d],i=this.sources[f.source],g=t[u+c*o+f.offset],j=i.accessor.params.length,h=g*j,f.semantic){case"VERTEX":v.push(g);break;case"NORMAL":w.push(p(i.data,h));break;case"TEXCOORD":x=x||{},x[f.set]===e&&(x[f.set]=[]),x[f.set].push(new mono.Vec2(i.data[h],i.data[h+1]));break;case"COLOR":y.push((new mono.Color).setRGB(i.data[h],i.data[h+1],i.data[h+2]))}if(0==w.length)if(f=this.vertices.input.NORMAL){i=i[f.source],j=i.accessor.params.length;for(var z=0,A=v.length;A>z;z++)w.push(p(i.data,v[z]*j))}else b.calcNormals=!0;if(!x&&(x={},f=this.vertices.input.TEXCOORD)){q.push(f.set),i=sources[f.source],j=i.accessor.params.length;for(var z=0,A=v.length;A>z;z++)h=v[z]*j,x[f.set]===e&&(x[f.set]=[]),x[f.set].push(new mono.Vec2(i.data[h],1-i.data[h+1]))}if(0==y.length&&(f=this.vertices.input.COLOR)){i=sources[f.source],j=i.accessor.params.length;for(var z=0,A=v.length;A>z;z++)h=v[z]*j,y.push((new mono.Color).setRGB(i.data[h],i.data[h+1],i.data[h+2]))}var B,C,D=null,E=[];if(3===n)E.push(new mono.Face3(v[0],v[1],v[2],w,y.length?y:new mono.Color(16711680)));else if(4===n)E.push(new mono.Face3(v[0],v[1],v[3],[w[0],w[1],w[3]],y.length?[y[0],y[1],y[3]]:new mono.Color(16711680))),E.push(new mono.Face3(v[1],v[2],v[3],[w[1],w[2],w[3]],y.length?[y[1],y[2],y[3]]:new mono.Color(16711680)));else if(n>4&&_.subdivideFaces){var F=y.length?y:new mono.Color;for(d=1;n-1>d;)E.push(new mono.Face3(v[0],v[d],v[d+1],[w[0],w[d++],w[d]],F))}if(E.length)for(var z=0,A=E.length;A>z;z++)for(D=E[z],D.daeMaterial=a.material,b.faces.push(D),d=0;d<q.length;d++)B=x[q[d]],C=n>4?[B[0],B[z+1],B[z+2]]:4===n?0===z?[B[0],B[1],B[3]]:[B[1].clone(),B[2],B[3].clone()]:[B[0],B[1],B[2]],b.uvs===e&&(b.uvs=[]),b.uvs.push(C);else console.log("dropped face with vcount "+n+" for geometry with id: "+b.id);u+=o*n}},r.prototype.parse=function(a){if(a&&(this.id=a.getAttribute("id"),a.childNodes.length>0))for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(c&&c.nodeName)switch(c.nodeName){case"input":var d=(new s).parse(c);this.input[d.semantic]=d}}return this},s.prototype.parse=function(a){return a&&(this.semantic=a.getAttribute("semantic"),this.offset=x(a.getAttribute("offset")),this.set=x(a.getAttribute("set")),this.source=a.getAttribute("source").replace(/^#/,""),"TEXCOORD"==this.semantic&&this.set<0&&(this.set=0)),this},t.prototype.parse=function(a){if(a&&(this.count=a.getAttribute("count"),this.material=a.getAttribute("material"),a.childNodes.length>0))for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(c&&c.nodeName)switch(c.nodeName){case"input":var d=(new s).parse(c);d&&this.inputs.push(d);break;case"p":this.p.push(A(c.textContent))}}return this},t.prototype.setVertices=function(a){for(var b=0;b<this.inputs.length;b++)this.inputs[b].source==a.id&&(this.inputs[b].source=a.input.POSITION.source)},u.prototype=Object.create(t.prototype),v.prototype.parse=function(a){if(!a)return this;if(this.id=a.getAttribute("id"),a.childNodes.length>0)for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(c&&c.nodeName)switch(c.nodeName){case"float_array":this.dataType=c.nodeName,this.data=z(c.textContent);break;case"bool_array":this.dataType=c.nodeName,this.data=B(c.textContent);break;case"int_array":this.data=A(c.textContent),this.dataType=c.nodeName;break;case"technique_common":if(c.childNodes&&c.childNodes.length>0)for(var d=0;d<c.childNodes.length;d++){var e=c.childNodes[d];if(e&&e.nodeName)switch(e.nodeName){case"accessor":var f=(new w).parse(e);f.source&&(this.technique_common[f.source]=f,this.accessor=f)}}}}return this},v.prototype.read=function(){var a=[],b=this.accessor.params[0];switch(b.type){case"IDREF":case"Name":case"name":case"float":return this.data;case"float4x4":for(var c=0;c<this.data.length;c+=16){var d=this.data.slice(c,c+16),e=D(d);a.push(e)}break;default:console.log("ColladaLoader: Source: Read dont know how to read "+b.type+".")}return a},w.prototype.parse=function(a){if(!a)return this;if(this.source=a.getAttribute("source"),this.count=x(a.getAttribute("count")),this.stride=x(a.getAttribute("stride")),a.childNodes.length>0)for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(c&&c.nodeName)switch(c.nodeName){case"param":var d={};d.name=c.getAttribute("name"),d.type=c.getAttribute("type"),this.params.push(d)}}return this},F.prototype.parse=function(a){this.id=a.getAttribute("id");for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];"init_from"==c.nodeName&&(this.init_from=c.textContent)}return this},H.prototype.create=function(){return null==this.shader?null:void 0},H.prototype.parse=function(a){this.id=a.getAttribute("id"),this.name=a.getAttribute("name"),N(this,a),this.shader=null;for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(1==c.nodeType)switch(c.nodeName){case"profile_COMMON":this.parseTechnique(this.parseProfileCOMMON(c))}}return this},H.prototype.parseNewparam=function(a){for(var b=a.getAttribute("sid"),c=0;c<a.childNodes.length;c++){var d=a.childNodes[c];if(1==d.nodeType)switch(d.nodeName){case"surface":this.surface[b]=new K(this).parse(d);break;case"sampler2D":this.sampler[b]=new L(this).parse(d);break;case"extra":break;default:console.log(d.nodeName)}}},H.prototype.parseProfileCOMMON=function(a){for(var b,c=0;c<a.childNodes.length;c++){var d=a.childNodes[c];if(1==d.nodeType)switch(d.nodeName){case"profile_COMMON":this.parseProfileCOMMON(d);break;case"technique":b=d;break;case"newparam":this.parseNewparam(d);break;case"image":var e=(new F).parse(d);X[e.id]=e;break;case"extra":break;default:console.log(d.nodeName)}}return b},H.prototype.parseTechnique=function(a){for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(1==c.nodeType)switch(c.nodeName){case"constant":case"lambert":case"blinn":case"phong":this.shader=new I(c.nodeName,this).parse(c);break;case"extra":this.parseExtra(c)}}},H.prototype.parseExtra=function(a){for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(1==c.nodeType)switch(c.nodeName){case"technique":this.parseExtraTechnique(c)}}},H.prototype.parseExtraTechnique=function(a){for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(1==c.nodeType)switch(c.nodeName){case"bump":this.shader.parse(c)}}},I.prototype.parse=function(a){for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(1==c.nodeType)switch(c.nodeName){case"ambient":case"emission":case"diffuse":case"specular":case"transparent":this[c.nodeName]=(new J).parse(c);break;case"bump":var d=c.getAttribute("bumptype");d?"heightfield"===d.toLowerCase()?this.bump=(new J).parse(c):"normalmap"===d.toLowerCase()?this.normal=(new J).parse(c):(console.error("Shader.prototype.parse: Invalid value for attribute 'bumptype' ("+d+") - valid bumptypes are 'HEIGHTFIELD' and 'NORMALMAP' - defaulting to 'HEIGHTFIELD'"),this.bump=(new J).parse(c)):(console.warn("Shader.prototype.parse: Attribute 'bumptype' missing from bump node - defaulting to 'HEIGHTFIELD'"),this.bump=(new J).parse(c));break;case"shininess":case"reflectivity":case"index_of_refraction":case"transparency":var e=c.querySelectorAll("float");e.length>0&&(this[c.nodeName]=parseFloat(e[0].textContent))}}return this.create(),this},I.prototype.create=function(){var a={},b=!1;if(this.transparency!==e&&this.transparent!==e){var c=(this.transparent,(this.transparent.color.r+this.transparent.color.g+this.transparent.color.b)/3*this.transparency);c>0&&(b=!0,a.transparent=!0,a.opacity=1-c)}var d={diffuse:"map",ambient:"lightMap",specular:"specularMap",emission:"emissionMap",bump:"bumpMap",normal:"normalMap"};for(var f in this)switch(f){case"ambient":case"emission":case"diffuse":case"specular":case"bump":case"normal":var g=this[f];if(g instanceof J)if(g.isTexture()){var h=g.texture,i=this.effect.sampler[h],j=null;if(i!==e&&i.source!==e){var k=this.effect.surface[i.source];j=X[k.init_from]}else j=X[h];if(j){var l=Y+j.init_from,m=new Image;m.loaded=!1;var n=new mono.Texture;n._imageSrc=l,n._image=m,n.setImage(l),n.wrapS=g.texOpts.wrapU?mono.RepeatWrapping:mono.ClampToEdgeWrapping,n.wrapT=g.texOpts.wrapV?mono.RepeatWrapping:mono.ClampToEdgeWrapping,n.offsetX=g.texOpts.offsetU,n.offsetY=g.texOpts.offsetV,n.repeatX=g.texOpts.repeatU,n.repeatY=g.texOpts.repeatV,a[d[f]]=n,"emission"===f&&(a.emissive=16777215)}}else"diffuse"!==f&&b||("emission"===f?a.emissive=g.color.getHex():a[f]=g.color.getHex());break;case"shininess":a[f]=this[f];break;case"reflectivity":a[f]=this[f],a[f]>0&&(a.envMap=_.defaultEnvMap),a.combine=mono.MixOperation;break;case"index_of_refraction":a.refractionRatio=this[f],1!==this[f]&&(a.envMap=_.defaultEnvMap);break;case"transparency":}switch(a.shading=mono.SmoothShading,a.side=this.effect.doubleSided?mono.DoubleSide:mono.FrontSide,this.type){case"constant":a.emissive!=e&&(a.color=a.emissive),this.material=new mono.EntityMaterial(a);break;case"phong":case"blinn":a.diffuse!=e&&(a.color=a.diffuse),this.material=new mono.EntityMaterial(a);break;case"lambert":default:a.diffuse!=e&&(a.color=a.diffuse),this.material=new mono.LambertMaterial(a)}return this.material},J.prototype.isColor=function(){return null==this.texture},J.prototype.isTexture=function(){return null!=this.texture},J.prototype.parse=function(a){"transparent"==a.nodeName&&(this.opaque=a.getAttribute("opaque"));for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(1==c.nodeType)switch(c.nodeName){case"color":var d=z(c.textContent);this.color=new mono.Color,this.color.setRGB(d[0],d[1],d[2]),this.color.a=d[3];break;case"texture":this.texture=c.getAttribute("texture"),this.texcoord=c.getAttribute("texcoord"),this.texOpts={offsetU:0,offsetV:0,repeatU:1,repeatV:1,wrapU:1,wrapV:1},this.parseTexture(c)}}return this},J.prototype.parseTexture=function(a){if(!a.childNodes)return this;a.childNodes[1]&&"extra"===a.childNodes[1].nodeName&&(a=a.childNodes[1],a.childNodes[1]&&"technique"===a.childNodes[1].nodeName&&(a=a.childNodes[1]));for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];switch(c.nodeName){case"offsetU":case"offsetV":case"repeatU":case"repeatV":this.texOpts[c.nodeName]=parseFloat(c.textContent);break;case"wrapU":case"wrapV":"TRUE"===c.textContent.toUpperCase()?this.texOpts[c.nodeName]=1:this.texOpts[c.nodeName]=parseInt(c.textContent);break;default:this.texOpts[c.nodeName]=c.textContent}}return this},K.prototype.parse=function(a){for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(1==c.nodeType)switch(c.nodeName){case"init_from":this.init_from=c.textContent;break;case"format":this.format=c.textContent;break;default:console.log("unhandled Surface prop: "+c.nodeName)}}return this},L.prototype.parse=function(a){for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(1==c.nodeType)switch(c.nodeName){case"source":this.source=c.textContent;break;case"minfilter":this.minfilter=c.textContent;break;case"magfilter":this.magfilter=c.textContent;break;case"mipfilter":this.mipfilter=c.textContent;break;case"wrap_s":this.wrap_s=c.textContent;break;case"wrap_t":this.wrap_t=c.textContent;break;default:console.log("unhandled Sampler2D prop: "+c.nodeName)}}return this},P.prototype.parse=function(a){this.id=a.getAttribute("id"),this.name=a.getAttribute("name");for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if(1==c.nodeType)switch(c.nodeName){case"technique_common":this.parseCommon(c);break;case"technique":this.parseTechnique(c)}}return this},P.prototype.parseCommon=function(a){for(var b=0;b<a.childNodes.length;b++)switch(a.childNodes[b].nodeName){case"directional":case"point":case"spot":case"ambient":this.technique=a.childNodes[b].nodeName;for(var c=a.childNodes[b],d=0;d<c.childNodes.length;d++){var e=c.childNodes[d];switch(e.nodeName){case"color":var f=z(e.textContent);this.color=new mono.Color(0),this.color.setRGB(f[0],f[1],f[2]),this.color.a=f[3];break;case"falloff_angle":this.falloff_angle=parseFloat(e.textContent);break;case"quadratic_attenuation":var g=parseFloat(e.textContent);this.distance=g?Math.sqrt(1/g):0}}}return this},P.prototype.parseTechnique=function(a){this.profile=a.getAttribute("profile");for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];switch(c.nodeName){case"intensity":this.intensity=parseFloat(c.textContent)}}return this},{load:a,parse:b,geometries:U,options:_}},Yb.DataBox=function(a){Yb.DataBox.superClass.constructor.apply(this,arguments),1===arguments.length&&(this._name=a),this._dataList=new kc,this._dataMap={},this._rootList=new kc,this._rootMap={},this._clientMap={},this._lightList=new kc,this._billboardList=new kc,this._nodeList=new kc,this._annotationList=new kc,this._particleList=new kc,this.nodes=[],this.particles=[],this.billboards=[],this._dataBoxChangeDispatcher=new Yb.EventDispatcher,this._dataPropertyChangeDispatcher=new Yb.EventDispatcher,this._groupLists={},this.selection=new kc,this instanceof Yb.AlarmBox||(this._selectionModel=new Yb.SelectionModel(this),this._alarmBox=new Yb.AlarmBox(this),this._alarmStatePropagator=new Yb.AlarmStatePropagator(this),this._alarmStatePropagator.setEnable(!0)),this.batch=!1,this._clientMap={}},Yb.extend(Yb.DataBox,Yb.PropertyChangeDispatcher,{constructor:Yb.DataBox,className:"TGL.DataBox",___accessor:["name"],add:function(a,b){if(a){1===arguments.length&&(b=-1);var c=a.getId();if(this._dataMap.hasOwnProperty(c)){if(this._dataMap[c]!==a)throw"Data with ID '"+c+"' already exists"}else this._dataMap[c]=a,this._dataList.add(a),a.getParent()||(this._rootMap[c]=a,b>=0?this._rootList.add(a,b):this._rootList.add(a)),a instanceof Yb.Billboard?this._billboardList.add(a):a instanceof Yb.Node?this._nodeList.add(a):a instanceof Yb.Particle?this._particleList.add(a):a instanceof Yb.Annotation?this._annotationList.add(a):a instanceof Yb.Light&&this._lightList.add(a),this._dataBoxChangeDispatcher.fire({kind:"add",data:a,source:this}),a.getGroupId()&&this.groupElements(a,null,a.getGroupId()),a.addPropertyChangeListener(this.handleDataPropertyChange,this),a._selected=!1}},onPropertyChange:function(){},firePropertyChange:function(){},addByDescendant:function(a,b){b&&0==b(a)||a&&(this.add(a),a.getChildren().size()>0&&a.getChildren().forEach(function(a){this.addByDescendant(a,b)},this))},getAlarmBox:function(){return this._alarmBox},removeById:function(a,b){var c=this.getDataById(a);this.remove(c,b)},remove:function(a,b){if(a&&this._dataMap.hasOwnProperty(a.getId())){a instanceof Yb.Link&&(a.setFromNode(null),a.setToNode(null)),a instanceof Yb.Node&&a.getLinks()&&a.getLinks().toList().forEach(function(a){this.remove(a)},this),b&&(a.getChildren().forEach(function(b){a.removeChild(b)},this),a.getParent()&&a.getParent().removeChild(a)),this._dataList.remove(a);var c=a._id;delete this._dataMap[c],this._rootMap[c]&&(delete this._rootMap[c],this._rootList.remove(a)),a instanceof Yb.Billboard?this._billboardList.remove(a):a instanceof Yb.Node?this._nodeList.remove(a):a instanceof Yb.Particle?this._particleList.remove(a):a instanceof Yb.Annotation?this._annotationList.remove(a):a instanceof Yb.Light&&this._lightList.remove(a),a.getGroupId()&&this.groupElements(a,a.getGroupId(),null),a.removePropertyChangeListener(this.handleDataPropertyChange,this),this._dataBoxChangeDispatcher.fire({kind:"remove",data:a,source:this}),this._selectionModel&&this._selectionModel.removeSelection(a)}},removeByDescendant:function(a,b,c){if(a){var d=this;a.hasChildren()&&a.getChildren().forEachReverse(function(a){d.removeByDescendant(a,b,c)}),c&&0==c(a)||this.remove(a,b)}},containsById:function(a){return this._dataMap.hasOwnProperty(a)},contains:function(a){return a?this._dataMap[a._id]===a:!1},lightsSize:function(){return this._lightList.size()},getLights:function(){return this._lightList},getLightsArray:function(){return this._lightList.toArray()},getAnnotations:function(){return this._annotationList},clear:function(a){if(this._dataList.size()>0){var b=this._dataList.toList(function(b){return!this._lightList.contains(b)||a},this);if(b.forEach(function(a){a.removePropertyChangeListener(this.handleDataPropertyChange,this)},this),this._dataList.clear(),this._dataMap={},this._rootList.clear(),this._rootMap={},this._nodeList.clear(),this._billboardList.clear(),a)this._lightList.clear();else{var c=this;this._lightList.forEach(function(a){c._dataList.add(a);var b=a.getId();c._dataMap[b]=a,null==a.getParent()&&(c._rootList.add(a),c._rootMap[b]=a)})}this._dataBoxChangeDispatcher.fire({kind:"clear",datas:b}),this.clearSelection()}},startBatch:function(){this.batch=!0},endBatch:function(){this.batch=!1,this._dataBoxChangeDispatcher.fire({kind:"batchEnd"})},removeSelection:function(){var a=this._selectionModel.toSelection();a.forEach(function(a){this.remove(a)},this)},clearSelection:function(){this._selectionModel&&this._selectionModel.clearSelection()},clearEditing:function(){this._nodeList.forEach(function(a){a.editing=!1}),this._billboardList.forEach(function(a){a.editing=!1})},getDataById:function(a){return this._dataMap[a]},groupElements:function(a,b,c){var d;b&&(d=this._groupLists[b],d&&(d.remove(a),d.isEmpty()&&delete this._groupLists[b])),c&&(d=this._groupLists[c],null==d&&(d=new kc,this._groupLists[c]=d),d.contains(a)||d.add(a))},synchronizeGroup:function(a,b,c,d){if(!this.isAdjustingGroup){this.isAdjustingGroup=!0;var e=a.getGroupId(),f=new Yb.Vec3;if(e){var g=this._groupLists[e];g&&g.size()>1&&g.forEach(function(e){e===a||e.isDescendantOf(a)||a.isDescendantOf(e)||(f.subVectors(c,b),e[Yb.setter(d)](e[Yb.getter(d)]().clone().add(f)))})}this.isAdjustingGroup=!1}},handleDataPropertyChange:function(a){var b=a.source;if("parent"===a.property){var c=b.getId();b.getParent()?this._rootMap[c]&&(delete this._rootMap[c],this._rootList.remove(b)):this._rootMap[c]||(this._rootMap[c]=b,this._rootList.add(b))}else if("groupId"===a.property){var d=a.oldValue,e=a.newValue;this.groupElements(b,d,e)}else"position"===a.property||"scale"===a.property||"rotation"===a.property?this.synchronizeGroup(b,a.oldValue,a.newValue,a.property):"selected"===a.property&&(b._selected?this._selectionModel.appendSelection(b):this._selectionModel.removeSelection(b));this.onDataPropertyChanged(b,a),this._dataPropertyChangeDispatcher.fire(a)},onDataPropertyChanged:function(a,b){},addDataBoxChangeListener:function(a,b,c){this._dataBoxChangeDispatcher.add(a,b,c)},removeDataBoxChangeListener:function(a,b){this._dataBoxChangeDispatcher.remove(a,b)},addDataPropertyChangeListener:function(a,b,c){this._dataPropertyChangeDispatcher.add(a,b,c)},removeDataPropertyChangeListener:function(a,b){this._dataPropertyChangeDispatcher.remove(a,b)},allocateLights:function(){var a,b,c,d,e,f,g,c;d=e=f=g=0;var h=this._lightList;for(a=0,b=h.size();b>a;a++)c=h.get(a),c.onlyShadow||(c instanceof Yb.DirectionalLight&&d++,c instanceof Yb.PointLight&&e++,c instanceof Yb.SpotLight&&f++);return{directional:d,point:e,spot:f,hemi:g}},allocateShadows:function(){var a,b,c,d=0,e=this._lightList;for(a=0,b=e.size();b>a;a++)c=e.get(a),c.castShadow&&(c instanceof Yb.SpotLight&&d++,c instanceof Yb.DirectionalLight&&!c.shadowCascade&&d++);return d},allocatePointShadows:function(){var a,b,c,d=0,e=this._lightList;for(a=0,b=e.size();b>a;a++)c=e.get(a),c.castShadow&&c instanceof Yb.PointLight&&d++;return d},getSelectionModel:function(){return this._selectionModel},size:function(){return this._dataList.size()},isEmpty:function(){return this._dataList.isEmpty()},getLimit:function(){return this._limit},setLimit:function(a){var b=this._limit;this._limit=a,this.firePropertyChange("limit",b,a),this._checkLimit()},_checkLimit:function(){this._limit>=0&&this.size()>this._limit&&this.removeFirst(this.size()-this._limit)},removeFirst:function(a){for(0===arguments.length&&(a=1);a>0&&this._dataList.size()>0;){var b=this._dataList.get(0);this.remove(b),a--}},getSiblings:function(a){if(!this.contains(a))throw a+" dosen't belong to this dataBox";var b=a.getParent();return b?b.getChildren():this._rootList},getRoots:function(){return this._rootList},getSiblingIndex:function(a){return a.getParent()?a.getParent().getChildren().indexOf(a):this._rootList.indexOf(a)},getNodes:function(){return this._nodeList},getBillboards:function(){return this._billboardList},getDatas:function(){return this._dataList},getDataAt:function(a){return this._dataList.get(a)},toDatas:function(a,b){return this._dataList.toList(a,b)},forEach:function(a,b){this._dataList.forEach(a,b)},forEachReverse:function(a,b){this._dataList.forEachReverse(a,b)},forEachByDepthFirst:function(a,b,c){if(b)this._depthFirst(a,b,c);else for(var d=this._rootList.size(),e=0;d>e;e++){var f=this._rootList.get(e);if(this._depthFirst(a,f,c)===!1)return}},_depthFirst:function(a,b,c){for(var d=b.getChildrenSize(),e=0;d>e;e++){var f=b.getChildAt(e);if(this._depthFirst(a,f,c)===!1)return!1}if(c){if(a.call(c,b)===!1)return!1}else if(a(b)===!1)return!1},forEachByBreadthFirst:function(a,b,c){var d=new kc;for(b?d.add(b):this._rootList.forEach(d.add,d);d.size()>0;)if(b=d.removeAt(0),b.getChildren().forEach(d.add,d),c){if(a.call(c,b)===!1)return}else if(a(b)===!1)return},getAlarmStatePropagator:function(){return this._alarmStatePropagator},setAlarmStatePropagator:function(a){this._alarmStatePropagator!=a&&(this._alarmStatePropagator&&this._alarmStatePropagator.setEnable(!1),this._alarmStatePropagator=a,this._alarmStatePropagator.setEnable(!0))},setClient:function(a,b){if(null==a)return this;null==this._clientMap&&(this._clientMap=new Object);var c=this._clientMap[a];if(c!==b)return null==b?delete this._clientMap[a]:this._clientMap[a]=b,this._clientMap[a]=b,this.firePropertyChange("C:"+a,c,b),this},getClient:function(a){return this._clientMap[a]}}),Yb.QuickFinder=function(a,b,c,d,e){if(this._map={},!a)throw"dataBox can not be null";if(!b)throw"propertyName can not be null";this._dataBox=a,this._propertyName=b,this._propertyType=c||"accessor","accessor"===this._propertyType&&(this._getter=Yb.getter(b)),this._valueFunction=d||this.getValue,this._filterFunction=e||this.isInterested,this._dataBox.forEach(this._addData,this),this._dataBox.addDataBoxChangeListener(this.handleDataBoxChange,this,!0),this._dataBox.addDataPropertyChangeListener(this.handleDataPropertyChange,this,!0)},Yb.extend(Yb.QuickFinder,Object,{_NULL_:"mono-null-key",getValueFunction:function(){return this._valueFunction},getFilterFunction:function(){return this._filterFunction},handleDataBoxChange:function(a){"add"===a.kind?this._addData(a.data):"remove"===a.kind?this._removeData(a.data):"clear"===a.kind&&(this._map={})},handleDataPropertyChange:function(a){if(this._filterFunction.call(this,a.source)){if("accessor"===this._propertyType&&this._propertyName===a.property);else if("style"===this._propertyType&&a.source.IStyle&&"S:"+this._propertyName===a.property);else if("client"!==this._propertyType||"C:"+this._propertyName!==a.property)return;var b=this._getMap(a.oldValue);b&&b.remove(a.source),this._addData(a.source)}},_getMap:function(a){return a=null==a?this._NULL_:a,this._map[a]},find:function(a){var b=this._getMap(a);return b?b.toList():new kc},findFirst:function(a){var b=this._getMap(a);return!b||b.isEmpty()?null:b.get(0)},_addData:function(a){if(this._filterFunction.call(this,a)){var b=this._valueFunction.call(this,a),c=this._getMap(b);c||(c=new kc,b=null==b?this._NULL_:b,this._map[b]=c),c.add(a)}},_removeData:function(a){if(this._filterFunction.call(this,a)){var b=this._valueFunction.call(this,a),c=this._getMap(b);c&&(c.remove(a),c.isEmpty()&&(b=null==b?this._NULL_:b,delete this._map[b]))}},dispose:function(){this._dataBox.removeDataBoxChangeListener(this.handleDataBoxChange,this),this._dataBox.removeDataPropertyChangeListener(this.handleDataPropertyChange,this),
delete this._dataBox},getDataBox:function(){return this._dataBox},getPropertyType:function(){return this._propertyType},getPropertyName:function(){return this._propertyName},isInterested:function(a){return("style"!==this._propertyType||a.IStyle)&&("accessor"!==this._propertyType||this._valueFunction!==this.getValue||a[this._getter])?!0:!1},getValue:function(a){return"accessor"===this._propertyType?a[this._getter]():"style"===this._propertyType&&a.getStyle?a.getStyle(this._propertyName):"client"===this._propertyType&&a.getClient?a.getClient(this._propertyName):null}}),Yb.SelectionModel=function(a){Yb.SelectionModel.superClass.constructor.apply(this,arguments),this._selectionMode="multipleSelection",this._selectionList=new kc,this._selectionChangeDispatcher=new Yb.EventDispatcher,this._selectionMap={},this._setDataBox(a)},Yb.extend(Yb.SelectionModel,Yb.PropertyChangeDispatcher,{getSelectionMode:function(){return this._selectionMode},setSelectionMode:function(a){if(this._selectionMode!==a&&("noneSelection"===a||"singleSelection"===a||"multipleSelection"===a)){this.clearSelection();var b=this._selectionMode;this._selectionMode=a,this.firePropertyChange("selectionMode",b,this._selectionMode)}},getDataBox:function(){return this._dataBox},_setDataBox:function(a){if(!a)throw"dataBox can not be null";if(this._dataBox!==a){this._dataBox&&(this.clearSelection(),this._dataBox.removeDataBoxChangeListener(this.handleDataBoxChange,this));var b=this._dataBox;this._dataBox=a,this._dataBox.addDataBoxChangeListener(this.handleDataBoxChange,this,!0),this.firePropertyChange("dataBox",b,this._dataBox)}},dispose:function(){this.clearSelection(),this._dataBox.removeDataBoxChangeListener(this.handleDataBoxChange,this)},handleDataBoxChange:function(a){if("remove"===a.kind){var b=a.data;this.contains(b)&&(this._selectionList.remove(b),delete this._selectionMap[b.getId()],this.fireSelectionChange("remove",new kc(b))),b._selected=!1}else"clear"===a.kind&&this.clearSelection()},getFilterFunction:function(){return this._filterFunction},setFilterFunction:function(a){if(this._filterFunction!==a){this.clearSelection();var b=this._filterFunction;this._filterFunction=a,this.firePropertyChange("filterFunction",b,this._filterFunction)}},fireSelectionChange:function(a,b,c){c&&(this._selectionList.forEach(function(a){c.contains(a)?c.remove(a):c.add(a)}),b=c.toList()),this._selectionChangeDispatcher.fire({kind:a,datas:new kc(b)})},addSelectionChangeListener:function(a,b,c){this._selectionChangeDispatcher.add(a,b,c)},removeSelectionChangeListener:function(a,b){this._selectionChangeDispatcher.remove(a,b)},_filterList:function(a,b){for(var c=new kc(a),d=0;d<c.size();d++){var e=c.get(d);(this._filterFunction&&!this._filterFunction(e)||b&&this.contains(e)||!b&&!this.contains(e)||!this._dataBox.contains(e))&&(c.removeAt(d),d--)}return c},appendSelection:function(a){if("noneSelection"!==this._selectionMode){var b=this._filterList(a,!0);if(!b.isEmpty()){var c=null;"singleSelection"===this._selectionMode&&(c=new kc(this._selectionList),this._selectionList.forEach(function(a){a._selected=!1}),this._selectionList.clear(),this._selectionMap={},b=new kc(b.get(b.size()-1)));for(var d=0;d<b.size();d++){var e=b.get(d);e._selected=!0,this._selectionList.add(e),this._selectionMap[e._id]=e}this.fireSelectionChange("append",b,c)}}},removeSelection:function(a){var b=this._filterList(a);if(0!==b.size()){for(var c=0;c<b.size();c++){var d=b.get(c);d._selected=!1,this._selectionList.remove(d),delete this._selectionMap[d.getId()]}this.fireSelectionChange("remove",b)}},toSelection:function(a,b){return this._selectionList.toList(a,b)},getSelection:function(){return this._selectionList},setSelection:function(a){if("noneSelection"!==this._selectionMode&&(0!==this._selectionList.size()||null!=a)){var b=new kc(this._selectionList);this._selectionList.clear(),this._selectionMap={};var c=this._filterList(a,!0);"singleSelection"===this._selectionMode&&c.size()>1&&(c=new kc(c.get(c.size()-1)));for(var d=0;d<c.size();d++){var e=c.get(d);e._selected=!0,this._selectionList.add(e),this._selectionMap[e.getId()]=e}this.fireSelectionChange("set",null,b)}},clearSelection:function(){if(this._selectionList.size()>0){var a=this._selectionList.toList();this._selectionList.forEach(function(a){a._selected=!1}),this._selectionList.clear(),this._selectionMap={},this.fireSelectionChange("clear",a)}},selectAll:function(){if("noneSelection"!==this._selectionMode){var a=this._dataBox.toDatas(),b=0,c=null;if(this._filterFunction)for(b=0;b<a.size();b++)c=a.get(b),this._filterFunction(c)||(a.removeAt(b),b--);var d=new kc(this._selectionList);for(this._selectionList.clear(),this._selectionMap={},"singleSelection"===this._selectionMode&&a.size()>1&&(a=new kc(a.get(a.size()-1))),b=0;b<a.size();b++)c=a.get(b),this._selectionList.add(c),this._selectionMap[c.getId()]=c;this.fireSelectionChange("all",null,d)}},size:function(){return this._selectionList.size()},contains:function(a){return a?null!=this._selectionMap[a._id]:!1},getLastData:function(){return this._selectionList.size()>0?this._selectionList.get(this._selectionList.size()-1):null},getFirstData:function(){return this._selectionList.size()>0?this._selectionList.get(0):null},isSelectable:function(a){return a?"noneSelection"===this._selectionMode?!1:this._filterFunction&&!this._filterFunction(a)?!1:!0:!1}}),Yb.AlarmSeverity=function(a,b,c,d,e){this.value=a,this.name=b,this.nickName=c,this.color=d,this.displayName=e},Yb.extend(Yb.AlarmSeverity,Object,{toString:function(){return this.displayName?this.displayName:this.name}}),function(){var a=Yb.AlarmSeverity;a.severities=new kc,a._vm={},a._nm={},a._cp=function(a,b){if(a&&b){var c=a.value-b.value;return c>0?1:0>c?-1:0}return a&&!b?1:!a&&b?-1:0},a.forEach=function(b,c){a.severities.forEach(b,c)},a.getSortFunction=function(){return a._cp},a.setSortFunction=function(b){a._cp=b,a.severities.sort(b)},a.add=function(b,c,d,e,f){var g=new a(b,c,d,e,f);return a._vm[b]=g,a._nm[c]=g,a.severities.add(g),a.severities.sort(a._cp),g},a.remove=function(b){var c=a._nm[b];return c&&(delete a._nm[b],delete a._vm[c.value],a.severities.remove(c)),c},a.CRITICAL=a.add(500,"Critical","C","#FF0000"),a.MAJOR=a.add(400,"Major","M","#FFA000"),a.MINOR=a.add(300,"Minor","m","#FFFF00"),a.WARNING=a.add(200,"Warning","W","#00FFFF"),a.INDETERMINATE=a.add(100,"Indeterminate","N","#C800FF"),a.CLEARED=a.add(0,"Cleared","R","#00FF00"),a.isClearedAlarmSeverity=function(a){return a?0===a.value:!1},a.getByName=function(b){return a._nm[b]},a.getByValue=function(b){return a._vm[b]},a.clear=function(){a.severities.clear(),a._vm={},a._nm={}},a.compare=function(b,c){return a._cp(b,c)}}(),Yb.AlarmState=function(a){this._e=a,this._nm={},this._am={},this._ps=null,this._haa=null,this._hna=null,this._hoa=null,this._hta=null,this._hls=!1,this._aac=0,this._nac=0},Yb.extend(Yb.AlarmState,Object,{_ep:!0,_f:function(){this._c1(),this._c2(),this._c3(),this._c4(),this._c5(),this._c6(),this._c7(),this._e.firePropertyChange("alarmState",null,this)},getHighestAcknowledgedAlarmSeverity:function(){return this._haa},getHighestNewAlarmSeverity:function(){return this._hna},getHighestOverallAlarmSeverity:function(){return this._hoa},getHighestNativeAlarmSeverity:function(){return this._hta},hasLessSevereNewAlarms:function(){return this._hls},_c1:function(){var a=null;for(var b in this._am)b=Yb.AlarmSeverity.getByName(b),Yb.AlarmSeverity.isClearedAlarmSeverity(b)||0!==this.getAcknowledgedAlarmCount(b)&&(a=a&&Yb.AlarmSeverity.compare(a,b)>0?a:b);this._haa=a},_c2:function(){var a=null;for(var b in this._nm)b=Yb.AlarmSeverity.getByName(b),Yb.AlarmSeverity.isClearedAlarmSeverity(b)||0!==this.getNewAlarmCount(b)&&(a=a&&Yb.AlarmSeverity.compare(a,b)>0?a:b);this._hna=a},_c3:function(){if(!this._hna)return void(this._hls=!1);for(var a in this._nm)if(a=Yb.AlarmSeverity.getByName(a),!Yb.AlarmSeverity.isClearedAlarmSeverity(a)&&0!==this.getNewAlarmCount(a)&&Yb.AlarmSeverity.compare(this._hna,a)>0)return void(this._hls=!0);this._hls=!1},_c4:function(){var a=this._haa,b=this._hna,c=this._ps;this._hoa=a,Yb.AlarmSeverity.compare(b,this._hoa)>0&&(this._hoa=b),Yb.AlarmSeverity.compare(c,this._hoa)>0&&(this._hoa=c)},_c5:function(){var a=this._haa,b=this._hna;this._hta=a,Yb.AlarmSeverity.compare(b,this._hta)>0&&(this._hta=b)},increaseAcknowledgedAlarm:function(a,b){if(null==b&&(b=1),0!==b){var c=this._am[a.name];null==c&&(c=0),c+=b,this._am[a.name]=c,this._f(),this._e.onAlarmChange()}},increaseNewAlarm:function(a,b){if(null==b&&(b=1),0!==b){var c=this._nm[a.name];null==c&&(c=0),c+=b,this._nm[a.name]=c,this._f(),this._e.onAlarmChange()}},decreaseAcknowledgedAlarm:function(a,b){if(null==b&&(b=1),0!==b){var c=this._am[a.name];if(null==c&&(c=0),c-=b,0>c)throw"Alarm count can not be negative";this._am[a.name]=c,this._f(),this._e.onAlarmChange()}},decreaseNewAlarm:function(a,b){if(null==b&&(b=1),0!==b){var c=this._nm[a.name];if(null==c&&(c=0),c-=b,0>c)throw"Alarm count can not be negative";this._nm[a.name]=c,this._f(),this._e.onAlarmChange()}},acknowledgeAlarm:function(a){this.decreaseNewAlarm(a,1),this.increaseAcknowledgedAlarm(a,1)},acknowledgeAllAlarms:function(a){if(a){var b=this.getNewAlarmCount(a);this.decreaseNewAlarm(a,b),this.increaseAcknowledgedAlarm(a,b)}else for(var c in this._nm)this.acknowledgeAllAlarms(Yb.AlarmSeverity.getByName(c))},_c6:function(){this._aac=0;for(var a in this._am)a=Yb.AlarmSeverity.getByName(a),this._aac+=this.getAcknowledgedAlarmCount(a)},getAcknowledgedAlarmCount:function(a){if(a){var b=this._am[a.name];return null==b?0:b}return this._aac},getAlarmCount:function(a){return this.getAcknowledgedAlarmCount(a)+this.getNewAlarmCount(a)},_c7:function(){this._nac=0;for(var a in this._nm)a=Yb.AlarmSeverity.getByName(a),this._nac+=this.getNewAlarmCount(a)},getNewAlarmCount:function(a){if(a){var b=this._nm[a.name];return null==b?0:b}return this._nac},setNewAlarmCount:function(a,b){this._nm[a.name]=b,this._f()},removeAllNewAlarms:function(a){a?delete this._nm[a]:this._nm={},this._f()},setAcknowledgedAlarmCount:function(a,b){this._am[a.name]=b,this._f()},removeAllAcknowledgedAlarms:function(a){a?delete this._am[a.name]:this._am={},this._f()},isEmpty:function(){return null==this._hoa},clear:function(){this._am={},this._nm={},this._f()},getPropagateSeverity:function(){return this._ps},setPropagateSeverity:function(a){if(this._ep||(a=null),this._ps!==a){var b=this._ps;this._ps=a,this._f(),this._e.onAlarmChange(),this._e.firePropertyChange("propagateSeverity",b,a)}},isEnablePropagation:function(){return this._ep},setEnablePropagation:function(a){var b=this._ep;this._ep=a,this._e.firePropertyChange("enablePropagation",b,a)&&(a||this.setPropagateSeverity(null))}}),Yb.Alarm=function(a,b,c,d,e){Yb.Data.call(this,a),this._id=null!=a?a:Yb.id("A"),this._elementId=b,this._alarmSeverity=c,this._acked=d||!1,this._cleared=e||!1},Yb.extend(Yb.Alarm,Yb.Data,{IAlarm:!0,getElementId:function(){return this._elementId},___accessor:["acked","cleared","alarmSeverity"]}),Yb.AlarmBox=function(a){if(!a)throw"elementBox can not be null.";Yb.AlarmBox.superClass.constructor.call(this),this._elementBox=a,this._alarmElementMapping=new Yb.AlarmElementMapping(this,a),this._elementBox.addDataBoxChangeListener(this.handleElementBoxChange,this,!0),this.addDataBoxChangeListener(this.handleAlarmBoxChange,this,!0),this.addDataPropertyChangeListener(this.handleAlarmPropertyChange,this,!0)},Yb.extend(Yb.AlarmBox,Yb.DataBox,{__accessor:["removeAlarmWhenElementIsRemoved"],_name:"AlarmBox",_removeAlarmWhenAlarmIsCleared:!1,_removeAlarmWhenElementIsRemoved:!0,getElementBox:function(){return this._elementBox},isRemoveAlarmWhenAlarmIsCleared:function(){return this._removeAlarmWhenAlarmIsCleared},setRemoveAlarmWhenAlarmIsCleared:function(a){var b=this._removeAlarmWhenAlarmIsCleared;if(this._removeAlarmWhenAlarmIsCleared=a,this.firePropertyChange("removeAlarmWhenAlarmIsCleared",b,a),a)for(var c in this.datas){var d=this.datas[c];d.isCleard()&&this.remove(d)}},getAlarmElementMapping:function(){return this._alarmElementMapping},setAlarmElementMapping:function(a){if(!a)throw"alarmElementMapping can not be null";if(this._alarmElementMapping!==a){var b=this._alarmElementMapping;this.getDatas().forEach(this._decreaseAlarmState,this),this._alarmElementMapping=a,this.getDatas().forEach(this._increaseAlarmState,this),this.firePropertyChange("alarmElementMapping",b,a)}},handleElementBoxChange:function(a){"add"===a.kind?this.handleElementAdded(a.data):"remove"===a.kind?(this.handleElementRemoved(a.data),this._removeAlarmWhenElementIsRemoved&&this.removeAlarmsByElement(a.data)):"clear"===a.kind&&(a.datas.forEach(this.handleElementRemoved,this),this._removeAlarmWhenElementIsRemoved&&this.clear())},handleAlarmBoxChange:function(a){"add"===a.kind?this._increaseAlarmState(a.data):"remove"===a.kind?this._decreaseAlarmState(a.data):"clear"===a.kind&&a.datas.forEach(this._decreaseAlarmState,this)},handleAlarmPropertyChange:function(a){var b=a.source;b.isCleared()||("alarmSeverity"===a.property?this.handleAlarmSeverityChange(b,a):"acked"===a.property&&this.handleAckedChange(b,a)),"cleared"===a.property&&(b.isCleared()?(this._decreaseAlarmState(b,!0),this._removeAlarmWhenAlarmIsCleared&&this.remove(b)):this._increaseAlarmState(b,!0))},handleAckedChange:function(a,b){if(a.getAlarmSeverity()){var c=this.getCorrespondingElements(a);if(c)for(var d=0;d<c.size();d++){var e=c.get(d);b.oldValue?e.getAlarmState().decreaseAcknowledgedAlarm(a.getAlarmSeverity()):e.getAlarmState().decreaseNewAlarm(a.getAlarmSeverity()),b.newValue?e.getAlarmState().increaseAcknowledgedAlarm(a.getAlarmSeverity()):e.getAlarmState().increaseNewAlarm(a.getAlarmSeverity())}}},handleAlarmSeverityChange:function(a,b){var c=b.oldValue,d=b.newValue,e=this.getCorrespondingElements(a);if(e)for(var f=0;f<e.size();f++){var g=e.get(f);c&&(a.isAcked()?g.getAlarmState().decreaseAcknowledgedAlarm(c):g.getAlarmState().decreaseNewAlarm(c)),d&&(a.isAcked()?g.getAlarmState().increaseAcknowledgedAlarm(d):g.getAlarmState().increaseNewAlarm(d))}},getCorrespondingAlarms:function(a){return this._alarmElementMapping.getCorrespondingAlarms(a)},getCorrespondingElements:function(a){return this._alarmElementMapping.getCorrespondingElements(a)},handleElementAdded:function(a){var b=this.getCorrespondingAlarms(a);if(b)for(var c=0;c<b.size();c++){var d=b.get(c);if(!d.isCleared()){var e=d.getAlarmSeverity();e&&(d.isAcked()?a.getAlarmState().increaseAcknowledgedAlarm(e):a.getAlarmState().increaseNewAlarm(e))}}},_increaseAlarmState:function(a,b){if(!a.isCleared()||b){var c=a.getAlarmSeverity();if(c){var d=this.getCorrespondingElements(a);if(d)for(var e=0;e<d.size();e++){var f=d.get(e);a.isAcked()?f.getAlarmState().increaseAcknowledgedAlarm(c):f.getAlarmState().increaseNewAlarm(c)}}}},_decreaseAlarmState:function(a,b){if(a.isCleared||console.log(),!a.isCleared()||b){var c=a.getAlarmSeverity();if(c){var d=this.getCorrespondingElements(a);if(d)for(var e=0;e<d.size();e++){var f=d.get(e);a.isAcked()?f.getAlarmState().decreaseAcknowledgedAlarm(c):f.getAlarmState().decreaseNewAlarm(c)}}}},handleElementRemoved:function(a){var b=this.getCorrespondingAlarms(a);b&&b.forEach(function(b){!b.isCleared()&&b.getAlarmSeverity()&&(b.isAcked()?a.getAlarmState().decreaseAcknowledgedAlarm(b.getAlarmSeverity()):a.getAlarmState().decreaseNewAlarm(b.getAlarmSeverity()))})},removeAlarmsByElement:function(a){var b=this.getCorrespondingAlarms(a);b&&b.forEach(this.remove,this)},add:function(a,b){if(!a.IAlarm)throw"Only IAlarm can be added into AlarmBox";this._removeAlarmWhenAlarmIsCleared&&a.isCleared()||Yb.AlarmBox.superClass.add.apply(this,arguments)}}),Yb.AlarmElementMapping=function(a,b){if(!b)throw"ElementBox can not be null";if(!a)throw"AlarmBox can not be null";this._elementBox=b,this._alarmBox=a,this._alarmsFinder=new Yb.QuickFinder(a,"elementId")},Yb.extend(Yb.AlarmElementMapping,Object,{getCorrespondingAlarms:function(a){return this._alarmsFinder.find(a.getId())},getCorrespondingElements:function(a){var b=this._elementBox.getDataById(a.getElementId());return new kc(b)},dispose:function(){delete this._elementBox,delete this._alarmBox,delete this._alarmsFinder}}),Yb.PropertyPropagator=function(a,b,c){if(!a)throw"dataBox can not be null";if(!b)throw"propertyName can not be null";this._dataBox=a,this._propertyName=b,this._propertyType=c||"accessor","accessor"===this._propertyType&&(this._getter=Yb.getter(b),this._setter=Yb.setter(b)),this._enable=!1,this._isPropagating=!1},Yb.extend(Yb.PropertyPropagator,Object,{getDataBox:function(){return this._dataBox},getPropertyType:function(){return this._propertyType},getPropertyName:function(){return this._propertyName},isEnable:function(){return this._enable},setEnable:function(a){if(this._enable!==a)if(this._enable=a,this._enable){this._dataBox.addDataBoxChangeListener(this.handleDataBoxChange,this),this._dataBox.addDataPropertyChangeListener(this.handleDataPropertyChange,this);for(var b in this._dataBox.datas)this.propagate(this._dataBox.datas[b])}else this._dataBox.removeDataBoxChangeListener(this.handleDataBoxChange,this),this._dataBox.removeDataPropertyChangeListener(this.handleDataPropertyChange,this)},handleDataBoxChange:function(a){a.data&&this.propagate(a.data)},handleDataPropertyChange:function(a){if(this.isInterestedProperty(a))this.propagate(a.source);else if("parent"===a.property){var b=a.oldValue;b&&this.propagate(b),this.propagate(a.source)}},isInterestedProperty:function(a){return"accessor"===this._propertyType&&this._propertyName===a.property?!0:"style"===this._propertyType&&a.IElement&&"S:"+this._propertyName===a.property?!0:"client"===this._propertyType&&"C:"+this._propertyName===a.property?!0:!1},propagate:function(a){a&&!this._isPropagating&&(this._isPropagating=!0,this.propagateToTop(a),this._isPropagating=!1)},propagateToTop:function(a){for(this.propagateToParent(null,a);a&&a.getParent();)this.propagateToParent(a,a.getParent()),a=a.getParent()},propagateToParent:function(a,b){}}),Yb.AlarmStatePropagator=function(a){Yb.AlarmStatePropagator.superClass.constructor.call(this,a,"alarmState")},Yb.extend(Yb.AlarmStatePropagator,Yb.PropertyPropagator,{handleDataPropertyChange:function(a){"enablePropagation"===a.property?this.propagate(a.source):Yb.AlarmStatePropagator.superClass.handleDataPropertyChange.call(this,a)},propagateToParent:function(a,b){var c=null;b.getChildren().forEach(function(a){var b=a.getAlarmState().getHighestOverallAlarmSeverity();Yb.AlarmSeverity.compare(b,c)>0&&(c=b)}),b.getAlarmState&&b.getAlarmState().setPropagateSeverity(c)}});var rc={KEEP_DEFAULT_FUNCTION:function(a){return a.target.keepDefault||a.target.getAttribute("keepDefault")?!0:a.target.parentNode&&(a.target.parentNode.keepDefault||a.target.parentNode.getAttribute("keepDefault"))?!0:a.shiftKey?!0:!1}};rc.paintSortFunction=function(a,b){return a.z!==b.z?a.z-b.z:0},rc.doubleClickToLookAtFunction=function(a){return!0},rc.needSmoothNormalFunction=function(a){var b=a instanceof qc||a instanceof Yb.TextNode||a instanceof Yb.PathCube||a instanceof Yb.ShapeNode||a instanceof Yb.ComboNode||"TGL.Entity"==a.getClassName();return!b},rc.PATH_LINK_COMPUTE_DELAY=!1,Yb.Defaults=rc,Yb.ShaderChunk={gradient_parts_fragment:["#ifdef MAX_GRADIENT","uniform vec3 gradientColor[MAX_GRADIENT];","uniform float gradientStop[MAX_GRADIENT];","uniform int gradientType;","#endif"].join("\n"),gradient_basic_fragment:["#ifdef MAX_GRADIENT","float gradientUV = 1.0;","float PI = 3.14;","if(gradientType == 1){","gradientUV = oUv.x;","} else if(gradientType == 2){","gradientUV = oUv.y;","} else if(gradientType == 3){","gradientUV = (oUv.x + oUv.y)/2.0;","} else if(gradientType == 4){","gradientUV = (oUv.x + 1.0 - oUv.y)/2.0;","} else if(gradientType == 5){","gradientUV = 1.414 * sqrt((oUv.x - 0.5) * (oUv.x - 0.5) + (oUv.y - 0.5) * (oUv.y - 0.5));","} else if(gradientType == 6){","gradientUV = (atan(oUv.y - 0.5,oUv.x - 0.5)) / (2.0 * PI);","if(gradientUV < 0.0){","gradientUV = 1.0 + gradientUV;","}","}","for( int i = 1; i < MAX_GRADIENT; i ++ ){","if(gradientStop[i - 1] <= gradientUV){","if((gradientStop[i] >= gradientUV)){","vec3 color1 = gradientColor[i-1];","vec3 color2 = gradientColor[i];","float stop1 = gradientStop[i-1];","float stop2 =gradientStop[i]; ","gl_FragColor = vec4( (color1 * (stop2 - gradientUV )  + color2 * (gradientUV - stop1))/(stop2 - stop1),opacity);","break;","}","}","}","#endif"].join("\n"),gradient_phong_fragment:["#ifdef MAX_GRADIENT","float gradientUV = 1.0;","float PI = 3.14;","if(gradientType == 1){","gradientUV = oUv.x;","} else if(gradientType == 2){","gradientUV = oUv.y;","} else if(gradientType == 3){","gradientUV = (oUv.x + oUv.y)/2.0;","} else if(gradientType == 4){","gradientUV = (oUv.x + 1.0 - oUv.y)/2.0;","} else if(gradientType == 5){","gradientUV = 1.414 * sqrt((oUv.x - 0.5) * (oUv.x - 0.5) + (oUv.y - 0.5) * (oUv.y - 0.5));","} else if(gradientType == 6){","gradientUV = (atan(oUv.y - 0.5,oUv.x - 0.5)) / (2.0 * PI);","if(gradientUV < 0.0){","gradientUV = 1.0 + gradientUV;","}","}","for( int i = 1; i < MAX_GRADIENT; i ++ ){","if(gradientStop[i - 1] < gradientUV){","if((gradientStop[i] > gradientUV)){","vec3 color1 = gradientColor[i-1];","vec3 color2 = gradientColor[i];","float stop1 = gradientStop[i-1];","float stop2 = gradientStop[i]; ","tempDiffuse = (color1 * (stop2 - gradientUV )  + color2 * (gradientUV - stop1))/(stop2 - stop1);","break;","}","}","}","#endif"].join("\n"),fog_pars_fragment:["#ifdef USE_FOG","uniform vec3 fogColor;","#ifdef FOG_EXP2","uniform float fogDensity;","#else","uniform float fogNear;","uniform float fogFar;","#endif","#endif"].join("\n"),fog_fragment:["#ifdef USE_FOG","float depth = gl_FragCoord.z / gl_FragCoord.w;","#ifdef FOG_EXP2","const float LOG2 = 1.442695;","float fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );","fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","#else","float fogFactor = smoothstep( fogNear, fogFar, depth );","#endif","gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","#endif"].join("\n"),envmap_pars_fragment:["#ifdef USE_ENVMAP","uniform float reflectivity;","uniform samplerCube envMap;","uniform float flipEnvMap;","uniform int combine;","#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )","uniform bool useRefract;","uniform float refractionRatio;","#else","varying vec3 vReflect;","#endif","#endif"].join("\n"),envmap_fragment:["#ifdef USE_ENVMAP","vec3 reflectVec;","#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )","vec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );","if ( useRefract ) {","reflectVec = refract( cameraToVertex, normal, refractionRatio );","} else { ","reflectVec = reflect( cameraToVertex, normal );","}","#else","reflectVec = vReflect;","#endif","#ifdef DOUBLE_SIDED","float flipNormal = ( -1.0 + 2.0 * float( gl_FrontFacing ) );","vec4 cubeColor = textureCube( envMap, flipNormal * vec3( reflectVec.x*flipEnvMap,  reflectVec.y,reflectVec.z) );","#else","vec4 cubeColor = textureCube( envMap, vec3(reflectVec.x*flipEnvMap,  reflectVec.y,reflectVec.z) );","#endif","#ifdef GAMMA_INPUT","cubeColor.xyz *= cubeColor.xyz;","#endif","#ifdef PHONG","#else","float specularStrength = 1.0;","#endif","if ( combine == 1 ) {","gl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularStrength * reflectivity );","} else if ( combine == 2 ) {","gl_FragColor.xyz += cubeColor.xyz * specularStrength * reflectivity;","} else {","gl_FragColor.xyz = mix( gl_FragColor.xyz, gl_FragColor.xyz * cubeColor.xyz, specularStrength * reflectivity );","}","#endif"].join("\n"),envmap_pars_vertex:["#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )","varying vec3 vReflect;","uniform float refractionRatio;","uniform bool useRefract;","#endif"].join("\n"),worldpos_vertex:["#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP ) ","#ifdef USE_SKINNING","vec4 worldPosition = modelMatrix * skinned;","#endif","#if defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )","vec4 worldPosition = modelMatrix * vec4( morphed, 1.0 );","#endif","#if ! defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )","vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","#endif","#endif"].join("\n"),envmap_vertex:["#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )","vec3 worldNormal = mat3( modelMatrix[ 0 ].xyz, modelMatrix[ 1 ].xyz, modelMatrix[ 2 ].xyz ) * objectNormal;","worldNormal = normalize( worldNormal );","vec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );","if ( useRefract ) {","vReflect = refract( cameraToVertex, worldNormal, refractionRatio );","} else {","vReflect = reflect( cameraToVertex, worldNormal );","}","#endif"].join("\n"),map_particle_pars_fragment:["#ifdef USE_MAP","uniform sampler2D map;","#endif"].join("\n"),map_particle_fragment:["#ifdef USE_MAP","gl_FragColor = gl_FragColor * texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) );","#endif"].join("\n"),map_pars_vertex:["#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined(MAX_GRADIENT)","varying vec2 vUv;","varying vec2 oUv;","uniform vec4 offsetRepeat;","uniform bool flipX; ","#endif"].join("\n"),map_pars_fragment:["#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined(MAX_GRADIENT)","varying vec2 vUv;","varying vec2 oUv;","#endif","#ifdef USE_MAP","uniform bool mapLoaded;","uniform sampler2D map;","#endif"].join("\n"),map_vertex:["#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined(MAX_GRADIENT)","if(flipX){","vUv.x = uv.x * offsetRepeat.z * (-1.0) + offsetRepeat.x + offsetRepeat.z;","vUv.y = uv.y * offsetRepeat.w  + offsetRepeat.y;","}else{","vUv = uv * offsetRepeat.zw  + offsetRepeat.xy;","}","oUv = uv;","#endif"].join("\n"),map_fragment:["#ifdef USE_MAP","if(mapLoaded){","vec4 texelColor = texture2D( map, vUv );","#ifdef GAMMA_INPUT","texelColor.xyz *= texelColor.xyz;","#endif","gl_FragColor = texelColor * gl_FragColor;","}","#endif"].join("\n"),lightmap_pars_fragment:["#ifdef USE_LIGHTMAP","varying vec2 vUv2;","uniform sampler2D lightMap;","#endif"].join("\n"),lightmap_pars_vertex:["#ifdef USE_LIGHTMAP","varying vec2 vUv2;","#endif"].join("\n"),lightmap_fragment:["#ifdef USE_LIGHTMAP","gl_FragColor = gl_FragColor * texture2D( lightMap, vUv2 );","#endif"].join("\n"),lightmap_vertex:["#ifdef USE_LIGHTMAP","vUv2 = uv2;","#endif"].join("\n"),bumpmap_pars_fragment:["#ifdef USE_BUMPMAP","uniform sampler2D bumpMap;","uniform float bumpScale;","vec2 dHdxy_fwd() {","vec2 dSTdx = dFdx( vUv );","vec2 dSTdy = dFdy( vUv );","float Hll = bumpScale * texture2D( bumpMap, vUv ).x;","float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;","float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;","return vec2( dBx, dBy );","}","vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {","vec3 vSigmaX = dFdx( surf_pos );","vec3 vSigmaY = dFdy( surf_pos );","vec3 vN = surf_norm;","vec3 R1 = cross( vSigmaY, vN );","vec3 R2 = cross( vN, vSigmaX );","float fDet = dot( vSigmaX, R1 );","vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );","return normalize( abs( fDet ) * surf_norm - vGrad );","}","#endif"].join("\n"),normalmap_pars_fragment:["#ifdef USE_NORMALMAP","uniform sampler2D normalMap;","uniform vec2 normalScale;","vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {","vec3 q0 = dFdx( eye_pos.xyz );","vec3 q1 = dFdy( eye_pos.xyz );","vec2 st0 = dFdx( vUv.st );","vec2 st1 = dFdy( vUv.st );","vec3 S = normalize(  q0 * st1.t - q1 * st0.t );","vec3 T = normalize( -q0 * st1.s + q1 * st0.s );","vec3 N = normalize( surf_norm );","vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;","mapN.xy = normalScale * mapN.xy;","mat3 tsn = mat3( S, T, N );","return normalize( tsn * mapN );","}","#endif"].join("\n"),specularmap_pars_fragment:["#ifdef USE_SPECULARMAP","uniform sampler2D specularMap;","#endif"].join("\n"),specularmap_fragment:["float specularStrength;","#ifdef USE_SPECULARMAP","vec4 texelSpecular = texture2D( specularMap, vUv );","specularStrength = texelSpecular.r;","#else","specularStrength = uspecularStrength;","#endif"].join("\n"),lights_lambert_pars_vertex:["uniform vec3 ambient;","uniform vec3 diffuse;","uniform vec3 emissive;","uniform vec3 ambientLightColor;","#if MAX_DIR_LIGHTS > 0","uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];","uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];","#endif","#if MAX_HEMI_LIGHTS > 0","uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];","uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];","uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];","#endif","#if MAX_POINT_LIGHTS > 0","uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];","uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];","uniform float pointLightDistance[ MAX_POINT_LIGHTS ];","#endif","#if MAX_SPOT_LIGHTS > 0","uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];","uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];","uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];","uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];","uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];","uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];","#endif","#ifdef WRAP_AROUND","uniform vec3 wrapRGB;","#endif"].join("\n"),lights_lambert_vertex:["vLightFront = vec3( 0.0 );","#ifdef DOUBLE_SIDED","vLightBack = vec3( 0.0 );","#endif","transformedNormal = normalize( transformedNormal );","#if MAX_DIR_LIGHTS > 0","for( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {","vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );","vec3 dirVector = normalize( lDirection.xyz );","float dotProduct = dot( transformedNormal, dirVector );","vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );","#ifdef DOUBLE_SIDED","vec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );","#ifdef WRAP_AROUND","vec3 directionalLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );","#endif","#endif","#ifdef WRAP_AROUND","vec3 directionalLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );","directionalLightWeighting = mix( directionalLightWeighting, directionalLightWeightingHalf, wrapRGB );","#ifdef DOUBLE_SIDED","directionalLightWeightingBack = mix( directionalLightWeightingBack, directionalLightWeightingHalfBack, wrapRGB );","#endif","#endif","vLightFront += directionalLightColor[ i ] * directionalLightWeighting;","#ifdef DOUBLE_SIDED","vLightBack += directionalLightColor[ i ] * directionalLightWeightingBack;","#endif","}","#endif","#if MAX_POINT_LIGHTS > 0 ","for( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {","vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );","vec3 lVector = lPosition.xyz - mvPosition.xyz;","float lDistance = 1.0;","if ( pointLightDistance[ i ] > 0.0 )","lDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );","lVector = normalize( lVector );","float dotProduct = dot( transformedNormal, lVector );","vec3 pointLightWeighting = vec3( max( dotProduct, 0.0 ) );","#ifdef DOUBLE_SIDED","vec3 pointLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );","#ifdef WRAP_AROUND","vec3 pointLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );","#endif","#endif","#ifdef WRAP_AROUND","vec3 pointLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );","pointLightWeighting = mix( pointLightWeighting, pointLightWeightingHalf, wrapRGB );","#ifdef DOUBLE_SIDED","pointLightWeightingBack = mix( pointLightWeightingBack, pointLightWeightingHalfBack, wrapRGB );","#endif","#endif","vLightFront += pointLightColor[ i ] * pointLightWeighting * lDistance;","#ifdef DOUBLE_SIDED","vLightBack += pointLightColor[ i ] * pointLightWeightingBack * lDistance;","#endif","}","#endif","#if MAX_SPOT_LIGHTS > 0","for( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {","vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );","vec3 lVector = lPosition.xyz - mvPosition.xyz;","float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - worldPosition.xyz ) );","if ( spotEffect > spotLightAngleCos[ i ] ) {","spotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );","float lDistance = 1.0;","if ( spotLightDistance[ i ] > 0.0 )","lDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );","lVector = normalize( lVector );","float dotProduct = dot( transformedNormal, lVector );","vec3 spotLightWeighting = vec3( max( dotProduct, 0.0 ) );","#ifdef DOUBLE_SIDED","vec3 spotLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );","#ifdef WRAP_AROUND","vec3 spotLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );","#endif","#endif","#ifdef WRAP_AROUND","vec3 spotLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );","spotLightWeighting = mix( spotLightWeighting, spotLightWeightingHalf, wrapRGB );","#ifdef DOUBLE_SIDED","spotLightWeightingBack = mix( spotLightWeightingBack, spotLightWeightingHalfBack, wrapRGB );","#endif","#endif","vLightFront += spotLightColor[ i ] * spotLightWeighting * lDistance * spotEffect;","#ifdef DOUBLE_SIDED","vLightBack += spotLightColor[ i ] * spotLightWeightingBack * lDistance * spotEffect;","#endif","}","}","#endif","#if MAX_HEMI_LIGHTS > 0","for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {","vec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );","vec3 lVector = normalize( lDirection.xyz );","float dotProduct = dot( transformedNormal, lVector );","float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;","float hemiDiffuseWeightBack = -0.5 * dotProduct + 0.5;","vLightFront += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );","#ifdef DOUBLE_SIDED","vLightBack += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeightBack );","#endif","}","#endif","vLightFront = vLightFront * diffuse + ambient * ambientLightColor + emissive;","#ifdef DOUBLE_SIDED","vLightBack = vLightBack * diffuse + ambient * ambientLightColor + emissive;","#endif"].join("\n"),
lights_phong_pars_vertex:["#ifndef PHONG_PER_PIXEL","#if MAX_POINT_LIGHTS > 0","uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];","uniform float pointLightDistance[ MAX_POINT_LIGHTS ];","varying vec4 vPointLight[ MAX_POINT_LIGHTS ];","#endif","#if MAX_SPOT_LIGHTS > 0","uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];","uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];","varying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];","#endif","#endif","#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )","varying vec3 vWorldPosition;","#endif"].join("\n"),lights_phong_vertex:["#ifndef PHONG_PER_PIXEL","#if MAX_POINT_LIGHTS > 0","for( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {","vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );","vec3 lVector = lPosition.xyz - mvPosition.xyz;","float lDistance = 1.0;","if ( pointLightDistance[ i ] > 0.0 )","lDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );","vPointLight[ i ] = vec4( lVector, lDistance );","}","#endif","#if MAX_SPOT_LIGHTS > 0","for( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {","vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );","vec3 lVector = lPosition.xyz - mvPosition.xyz;","float lDistance = 1.0;","if ( spotLightDistance[ i ] > 0.0 )","lDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );","vSpotLight[ i ] = vec4( lVector, lDistance );","}","#endif","#endif","#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ","vWorldPosition = worldPosition.xyz;","#endif"].join("\n"),lights_phong_pars_fragment:["uniform vec3 ambientLightColor;","#if MAX_DIR_LIGHTS > 0","uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];","uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];","#endif","#if MAX_HEMI_LIGHTS > 0","uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];","uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];","uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];","#endif","#if MAX_POINT_LIGHTS > 0","uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];","#ifdef PHONG_PER_PIXEL","uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];","uniform float pointLightDistance[ MAX_POINT_LIGHTS ];","#else","varying vec4 vPointLight[ MAX_POINT_LIGHTS ];","#endif","#endif","#if MAX_SPOT_LIGHTS > 0","uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];","uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];","uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];","uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];","uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];","#ifdef PHONG_PER_PIXEL","uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];","#else","varying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];","#endif","#endif","#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )","varying vec3 vWorldPosition;","#endif","#ifdef WRAP_AROUND","uniform vec3 wrapRGB;","#endif","varying vec3 vViewPosition;","varying vec3 vNormal;"].join("\n"),lights_phong_fragment:["vec3 normal = normalize( vNormal );","vec3 viewPosition = normalize( vViewPosition );","#ifdef DOUBLE_SIDED","normal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );","#endif","#ifdef USE_NORMALMAP","normal = perturbNormal2Arb( -viewPosition, normal );","#elif defined( USE_BUMPMAP )","normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );","#endif","#if MAX_POINT_LIGHTS > 0","vec3 pointDiffuse  = vec3( 0.0 );","vec3 pointSpecular = vec3( 0.0 );","for ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {","#ifdef PHONG_PER_PIXEL","vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );","vec3 lVector = lPosition.xyz + vViewPosition.xyz;","float lDistance = 1.0;","if ( pointLightDistance[ i ] > 0.0 )","lDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );","lVector = normalize( lVector );","#else","vec3 lVector = normalize( vPointLight[ i ].xyz );","float lDistance = vPointLight[ i ].w;","#endif","float dotProduct = dot( normal, lVector );","#ifdef WRAP_AROUND","float pointDiffuseWeightFull = max( dotProduct, 0.0 );","float pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );","vec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );","#else","float pointDiffuseWeight = max( dotProduct, 0.0 );","#endif","pointDiffuse  += tempDiffuse * pointLightColor[ i ] * pointDiffuseWeight * lDistance;","vec3 pointHalfVector = normalize( lVector + viewPosition );","float pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );","float pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float specularNormalization = ( shininess + 2.0001 ) / 8.0;","vec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, pointHalfVector ), 5.0 );","pointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance * specularNormalization;","#else","pointSpecular += specular * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance;","#endif","}","#endif","#if MAX_SPOT_LIGHTS > 0","vec3 spotDiffuse  = vec3( 0.0 );","vec3 spotSpecular = vec3( 0.0 );","for ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {","#ifdef PHONG_PER_PIXEL","vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );","vec3 lVector = lPosition.xyz + vViewPosition.xyz;","float lDistance = 1.0;","if ( spotLightDistance[ i ] > 0.0 )","lDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );","lVector = normalize( lVector );","#else","vec3 lVector = normalize( vSpotLight[ i ].xyz );","float lDistance = vSpotLight[ i ].w;","#endif","float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );","if ( spotEffect > spotLightAngleCos[ i ]) {","spotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );","float dotProduct = dot( normal, lVector );","#ifdef WRAP_AROUND","float spotDiffuseWeightFull = max( dotProduct, 0.0 );","float spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );","vec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );","#else","float spotDiffuseWeight = max( dotProduct, 0.0 );","#endif","spotDiffuse += tempDiffuse * spotLightColor[ i ] * spotDiffuseWeight * lDistance * spotEffect;","vec3 spotHalfVector = normalize( lVector + viewPosition );","float spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );","float spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float specularNormalization = ( shininess + 2.0001 ) / 8.0;","vec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, spotHalfVector ), 5.0 );","spotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * specularNormalization * spotEffect;","#else","spotSpecular += specular * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * spotEffect;","#endif","}","}","#endif","#if MAX_DIR_LIGHTS > 0","vec3 dirDiffuse  = vec3( 0.0 );","vec3 dirSpecular = vec3( 0.0 );","for( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {","vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );","vec3 dirVector = normalize( lDirection.xyz );","float dotProduct = dot( normal, dirVector );","#ifdef WRAP_AROUND","float dirDiffuseWeightFull = max( dotProduct, 0.0 );","float dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );","vec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );","#else","float dirDiffuseWeight = max( dotProduct, 0.0 );","#endif","dirDiffuse  += tempDiffuse * directionalLightColor[ i ] * dirDiffuseWeight;","vec3 dirHalfVector = normalize( dirVector + viewPosition );","float dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );","float dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float specularNormalization = ( shininess + 2.0001 ) / 8.0;","vec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );","dirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;","#else","dirSpecular += specular * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight;","#endif","}","#endif","#if MAX_HEMI_LIGHTS > 0","vec3 hemiDiffuse  = vec3( 0.0 );","vec3 hemiSpecular = vec3( 0.0 );","for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {","vec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );","vec3 lVector = normalize( lDirection.xyz );","float dotProduct = dot( normal, lVector );","float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;","vec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );","hemiDiffuse += tempDiffuse * hemiColor;","vec3 hemiHalfVectorSky = normalize( lVector + viewPosition );","float hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;","float hemiSpecularWeightSky = specularStrength * max( pow( hemiDotNormalHalfSky, shininess ), 0.0 );","vec3 lVectorGround = -lVector;","vec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );","float hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;","float hemiSpecularWeightGround = specularStrength * max( pow( hemiDotNormalHalfGround, shininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float dotProductGround = dot( normal, lVectorGround );","float specularNormalization = ( shininess + 2.0001 ) / 8.0;","vec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, hemiHalfVectorSky ), 5.0 );","vec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 5.0 );","hemiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );","#else","hemiSpecular += specular * hemiColor * ( hemiSpecularWeightSky + hemiSpecularWeightGround ) * hemiDiffuseWeight;","#endif","}","#endif","vec3 totalDiffuse = vec3( 0.0 );","vec3 totalSpecular = vec3( 0.0 );","#if MAX_DIR_LIGHTS > 0","totalDiffuse += dirDiffuse;","totalSpecular += dirSpecular;","#endif","#if MAX_HEMI_LIGHTS > 0","totalDiffuse += hemiDiffuse;","totalSpecular += hemiSpecular;","#endif","#if MAX_POINT_LIGHTS > 0","totalDiffuse += pointDiffuse;","totalSpecular += pointSpecular;","#endif","#if MAX_SPOT_LIGHTS > 0","totalDiffuse += spotDiffuse;","totalSpecular += spotSpecular;","#endif","float ssao = 1.0;","#ifdef USE_SSAO","ssao = clamp(1.0 - texture2D(mapSSAO, (finalPosition.xy / finalPosition.w / 2.0 + vec2(0.5,0.5))).x,0.0,1.0);","#endif","#ifdef METAL","gl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + (ambientLightColor * ambient * ssao) + totalSpecular );","#else","gl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + (ambientLightColor * ambient) * ssao ) + totalSpecular;","#endif"].join("\n"),color_pars_fragment:["#ifdef USE_COLOR","varying vec3 vColor;","#endif"].join("\n"),color_fragment:["#ifdef USE_COLOR","gl_FragColor = gl_FragColor * vec4( vColor, opacity );","#endif"].join("\n"),color_pars_vertex:["#ifdef USE_COLOR","varying vec3 vColor;","#endif"].join("\n"),color_vertex:["#ifdef USE_COLOR","#ifdef GAMMA_INPUT","vColor = color * color;","#else","vColor = color;","#endif","#endif"].join("\n"),skinning_pars_vertex:["#ifdef USE_SKINNING","#ifdef BONE_TEXTURE","uniform sampler2D boneTexture;","mat4 getBoneMatrix( const in float i ) {","float j = i * 4.0;","float x = mod( j, N_BONE_PIXEL_X );","float y = floor( j / N_BONE_PIXEL_X );","const float dx = 1.0 / N_BONE_PIXEL_X;","const float dy = 1.0 / N_BONE_PIXEL_Y;","y = dy * ( y + 0.5 );","vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );","vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );","vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );","vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );","mat4 bone = mat4( v1, v2, v3, v4 );","return bone;","}","#else","uniform mat4 boneGlobalMatrices[ MAX_BONES ];","mat4 getBoneMatrix( const in float i ) {","mat4 bone = boneGlobalMatrices[ int(i) ];","return bone;","}","#endif","#endif"].join("\n"),skinbase_vertex:["#ifdef USE_SKINNING","mat4 boneMatX = getBoneMatrix( skinIndex.x );","mat4 boneMatY = getBoneMatrix( skinIndex.y );","#endif"].join("\n"),skinning_vertex:["#ifdef USE_SKINNING","#ifdef USE_MORPHTARGETS","vec4 skinVertex = vec4( morphed, 1.0 );","#else","vec4 skinVertex = vec4( position, 1.0 );","#endif","vec4 skinned  = boneMatX * skinVertex * skinWeight.x;","skinned 	  += boneMatY * skinVertex * skinWeight.y;","#endif"].join("\n"),morphtarget_pars_vertex:["#ifdef USE_MORPHTARGETS","#ifndef USE_MORPHNORMALS","uniform float morphTargetInfluences[ 8 ];","#else","uniform float morphTargetInfluences[ 4 ];","#endif","#endif"].join("\n"),morphtarget_vertex:["#ifdef USE_MORPHTARGETS","vec3 morphed = vec3( 0.0 );","morphed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];","morphed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];","morphed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];","morphed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];","#ifndef USE_MORPHNORMALS","morphed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];","morphed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];","morphed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];","morphed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];","#endif","morphed += position;","#endif"].join("\n"),default_vertex:["vec4 mvPosition;","#ifdef USE_SKINNING","mvPosition = modelViewMatrix * skinned;","#endif","#if !defined( USE_SKINNING ) && defined( USE_MORPHTARGETS )","mvPosition = modelViewMatrix * vec4( morphed, 1.0 );","#endif","#if !defined( USE_SKINNING ) && ! defined( USE_MORPHTARGETS )","mvPosition = modelViewMatrix * vec4( position, 1.0 );","#endif","gl_Position = projectionMatrix * mvPosition;"].join("\n"),morphnormal_vertex:["#ifdef USE_MORPHNORMALS","vec3 morphedNormal = vec3( 0.0 );","morphedNormal +=  ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];","morphedNormal +=  ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];","morphedNormal +=  ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];","morphedNormal +=  ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];","morphedNormal += normal;","#endif"].join("\n"),skinnormal_vertex:["#ifdef USE_SKINNING","mat4 skinMatrix = skinWeight.x * boneMatX;","skinMatrix 	+= skinWeight.y * boneMatY;","#ifdef USE_MORPHNORMALS","vec4 skinnedNormal = skinMatrix * vec4( morphedNormal, 0.0 );","#else","vec4 skinnedNormal = skinMatrix * vec4( normal, 0.0 );","#endif","#endif"].join("\n"),defaultnormal_vertex:["vec3 objectNormal;","#ifdef USE_SKINNING","objectNormal = skinnedNormal.xyz;","#endif","#if !defined( USE_SKINNING ) && defined( USE_MORPHNORMALS )","objectNormal = morphedNormal;","#endif","#if !defined( USE_SKINNING ) && ! defined( USE_MORPHNORMALS )","objectNormal = normal;","#endif","#ifdef FLIP_SIDED","objectNormal = -objectNormal;","#endif","vec3 transformedNormal = normalMatrix * objectNormal;"].join("\n"),shadowmap_pars_fragment:["#ifdef USE_SHADOWMAP","uniform sampler2D shadowMap[ MAX_SHADOWS ];","uniform vec2 shadowMapSize[ MAX_SHADOWS ];","uniform float shadowDarkness[ MAX_SHADOWS ];","uniform float shadowBias[ MAX_SHADOWS ];","varying vec4 vShadowCoord[ MAX_SHADOWS ];","#endif","#ifdef USE_POINT_SHADOWMAP","uniform samplerCube pShadowMap[MAX_POINT_SHADOWS];","uniform float pShadowDarkness[MAX_POINT_SHADOWS];","uniform vec3 pPosition[MAX_POINT_SHADOWS];","varying vec4 pWorldPosition;","#endif","#if defined(USE_SHADOWMAP) || defined(USE_POINT_SHADOWMAP)","float unpackDepth( const in vec4 rgba_depth ) {","const vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );","float depth = dot( rgba_depth, bit_shift );","return depth;","}","float unpack (vec4 colour){","const vec4 bitShifts = vec4(1.0,1.0 / 255.0,1.0 / (255.0 * 255.0),1.0 / (255.0 * 255.0 * 255.0));","return dot(colour, bitShifts) * 100000.0;","}","#endif"].join("\n"),shadowmap_fragment:["#ifdef USE_SHADOWMAP","#ifdef SHADOWMAP_DEBUG","vec3 frustumColors[3];","frustumColors[0] = vec3( 1.0, 0.5, 0.0 );","frustumColors[1] = vec3( 0.0, 1.0, 0.8 );","frustumColors[2] = vec3( 0.0, 0.5, 1.0 );","#endif","#ifdef SHADOWMAP_CASCADE","int inFrustumCount = 0;","#endif","float fDepth;","vec3 shadowColor = vec3( 1.0 );","for( int i = 0; i < MAX_SHADOWS; i ++ ) {","vec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;","bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );","bool inFrustum = all( inFrustumVec );","#ifdef SHADOWMAP_CASCADE","inFrustumCount += int( inFrustum );","bvec3 frustumTestVec = bvec3(inFrustum, inFrustumCount == 1, shadowCoord.z <= 1.0 );","#else","bvec2 frustumTestVec = bvec2(inFrustum, shadowCoord.z <= 1.0 );","#endif","bool frustumTest = all( frustumTestVec );","if ( frustumTest) {","shadowCoord.z += shadowBias[ i ];","#if defined( SHADOWMAP_TYPE_PCF )","float shadow = 0.0;","const float shadowDelta = 1.0 / 9.0;","float xPixelOffset = 1.0 / shadowMapSize[ i ].x;","float yPixelOffset = 1.0 / shadowMapSize[ i ].y;","float dx0 = -1.25 * xPixelOffset;","float dy0 = -1.25 * yPixelOffset;","float dx1 = 1.25 * xPixelOffset;","float dy1 = 1.25 * yPixelOffset;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","shadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );","#elif defined( SHADOWMAP_TYPE_PCF_SOFT )","float shadow = 0.0;","float xPixelOffset = 1.0 / shadowMapSize[ i ].x;","float yPixelOffset = 1.0 / shadowMapSize[ i ].y;","float dx0 = -1.0 * xPixelOffset;","float dy0 = -1.0 * yPixelOffset;","float dx1 = 1.0 * xPixelOffset;","float dy1 = 1.0 * yPixelOffset;","mat3 shadowKernel;","mat3 depthKernel;","depthKernel[0][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );","if ( depthKernel[0][0] < shadowCoord.z ) shadowKernel[0][0] = 0.25;","else shadowKernel[0][0] = 0.0;","depthKernel[0][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );","if ( depthKernel[0][1] < shadowCoord.z ) shadowKernel[0][1] = 0.25;","else shadowKernel[0][1] = 0.0;","depthKernel[0][2] = unpackDepth( texture2D( shadowMap[ i], shadowCoord.xy + vec2( dx0, dy1 ) ) );","if ( depthKernel[0][2] < shadowCoord.z ) shadowKernel[0][2] = 0.25;","else shadowKernel[0][2] = 0.0;","depthKernel[1][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );","if ( depthKernel[1][0] < shadowCoord.z ) shadowKernel[1][0] = 0.25;","else shadowKernel[1][0] = 0.0;","depthKernel[1][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );","if ( depthKernel[1][1] < shadowCoord.z ) shadowKernel[1][1] = 0.25;","else shadowKernel[1][1] = 0.0;","depthKernel[1][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );","if ( depthKernel[1][2] < shadowCoord.z ) shadowKernel[1][2] = 0.25;","else shadowKernel[1][2] = 0.0;","depthKernel[2][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );","if ( depthKernel[2][0] < shadowCoord.z ) shadowKernel[2][0] = 0.25;","else shadowKernel[2][0] = 0.0;","depthKernel[2][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );","if ( depthKernel[2][1] < shadowCoord.z ) shadowKernel[2][1] = 0.25;","else shadowKernel[2][1] = 0.0;","depthKernel[2][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );","if ( depthKernel[2][2] < shadowCoord.z ) shadowKernel[2][2] = 0.25;","else shadowKernel[2][2] = 0.0;","vec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[i].xy );","shadowKernel[0] = mix( shadowKernel[1], shadowKernel[0], fractionalCoord.x );","shadowKernel[1] = mix( shadowKernel[2], shadowKernel[1], fractionalCoord.x );","vec4 shadowValues;","shadowValues.x = mix( shadowKernel[0][1], shadowKernel[0][0], fractionalCoord.y );","shadowValues.y = mix( shadowKernel[0][2], shadowKernel[0][1], fractionalCoord.y );","shadowValues.z = mix( shadowKernel[1][1], shadowKernel[1][0], fractionalCoord.y );","shadowValues.w = mix( shadowKernel[1][2], shadowKernel[1][1], fractionalCoord.y );","shadow = dot( shadowValues, vec4( 1.0 ) );","shadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );","#else","vec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );","float fDepth = unpackDepth( rgbaDepth );","if ( fDepth < shadowCoord.z )","shadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );","#endif","}","#ifdef SHADOWMAP_DEBUG","#ifdef SHADOWMAP_CASCADE","if ( inFrustum && inFrustumCount == 1 ) gl_FragColor.xyz *= frustumColors[ i ];","#else","if ( inFrustum ) gl_FragColor.xyz *= frustumColors[ i ];","#endif","#endif","}","#ifdef GAMMA_OUTPUT","shadowColor *= shadowColor;","#endif","gl_FragColor.xyz = gl_FragColor.xyz * shadowColor;","#endif","#ifdef USE_POINT_SHADOWMAP","for( int i = 0; i < MAX_POINT_SHADOWS; i ++ ) {","vec3 lightVec = normalize(pWorldPosition.xyz - pPosition[i]);","float depth = length(pWorldPosition.xyz - pPosition[i]);","float shadowDepth = unpack (textureCube(pShadowMap[i], lightVec));","depth = depth * 0.95;","if ( depth > shadowDepth){","gl_FragColor.xyz *= 0.8;","}","}","#endif"].join("\n"),shadowmap_pars_vertex:["#ifdef USE_SHADOWMAP","varying vec4 vShadowCoord[ MAX_SHADOWS ];","uniform mat4 shadowMatrix[ MAX_SHADOWS ];","#endif","#ifdef USE_POINT_SHADOWMAP","varying vec4 pWorldPosition;","#endif"].join("\n"),shadowmap_vertex:["#ifdef USE_SHADOWMAP","for( int i = 0; i < MAX_SHADOWS; i ++ ) {","vShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;","}","#endif","#ifdef USE_POINT_SHADOWMAP","pWorldPosition = modelMatrix * vec4(position,1.0);","#endif"].join("\n"),alphatest_fragment:["#ifdef ALPHATEST","if ( gl_FragColor.a < ALPHATEST ) discard;","#endif"].join("\n"),linear_to_gamma_fragment:["#ifdef GAMMA_OUTPUT","gl_FragColor.xyz = sqrt( gl_FragColor.xyz );","#endif"].join("\n")},Yb.UniformsUtils={merge:function(a){var b,c,d,e={};for(b=0;b<a.length;b++){d=this.clone(a[b]);for(c in d)e[c]=d[c]}return e},clone:function(a){var b,c,d,e={};for(b in a){e[b]={};for(c in a[b])d=a[b][c],d instanceof Yb.Color||d instanceof Yb.Vec2||d instanceof Yb.Vec3||d instanceof Yb.Vec4||d instanceof Yb.Mat4||d instanceof Yb.Texture?e[b][c]=d.clone():d instanceof Array?e[b][c]=d.slice():e[b][c]=d}return e}},Yb.UniformsLib={outline:{diffuse:{type:"c",value:new Yb.Color(15658734)},outline_offset:{type:"f",value:0}},glow:{map:{type:"t",value:null}},blur:{orientation:{type:"i",value:0},texelSize:{type:"v2",value:new Yb.Vec2(512,512)},blurAmount:{type:"i",value:10},blurScale:{type:"f",value:1},blurStrength:{type:"f",value:.2},map:{type:"t",value:null},useBlur:{type:"i",value:1},blurGlobalAlpha:{type:"f",value:1}},deferred:{linearDepth:{type:"f",value:9e3},isNormal:{type:"i",value:1}},ssao:{map0:{type:"t",value:null},map1:{type:"t",value:null},map2:{type:"t",value:null},occluderBias:{type:"f",value:.05},samplingRadius:{type:"f",value:20},attenuation:{type:"v2",value:new Zb(1,0)},texelSize:{type:"v2",value:new Zb(1/512,1/512)}},common:{diffuse:{type:"c",value:new Yb.Color(15658734)},opacity:{type:"f",value:1},map:{type:"t",value:null},mapLoaded:{type:"i",value:0},offsetRepeat:{type:"v4",value:new Yb.Vec4(0,0,1,1)},flipX:{type:"i",value:0},lightMap:{type:"t",value:null},specularMap:{type:"t",value:null},envMap:{type:"t",value:null},flipEnvMap:{type:"f",value:-1},useRefract:{type:"i",value:0},reflectivity:{type:"f",value:1},refractionRatio:{type:"f",value:.98},combine:{type:"i",value:0},morphTargetInfluences:{type:"f",value:0}},gradient:{gradientColor:{type:"v3v",value:[]},gradientStop:{type:"fv1",value:[]},gradientType:{type:"i",value:0}},bump:{bumpMap:{type:"t",value:null},bumpScale:{type:"f",value:1}},normalmap:{normalMap:{type:"t",value:null},normalScale:{type:"v2",value:new Yb.Vec2(1,1)}},fog:{fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new Yb.Color(16777215)}},lights:{ambientLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]},directionalLightColor:{type:"fv",value:[]},hemisphereLightDirection:{type:"fv",value:[]},hemisphereLightSkyColor:{type:"fv",value:[]},hemisphereLightGroundColor:{type:"fv",value:[]},pointLightColor:{type:"fv",value:[]},pointLightPosition:{type:"fv",value:[]},pointLightDistance:{type:"fv1",value:[]},spotLightColor:{type:"fv",value:[]},spotLightPosition:{type:"fv",value:[]},spotLightDirection:{type:"fv",value:[]},spotLightDistance:{type:"fv1",value:[]},spotLightAngleCos:{type:"fv1",value:[]},spotLightExponent:{type:"fv1",value:[]}},particle:{psColor:{type:"c",value:new Yb.Color(15658734)},opacity:{type:"f",value:1},size:{type:"f",value:1},scale:{type:"f",value:1},map:{type:"t",value:null},fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new Yb.Color(16777215)}},shadowmap:{shadowMap:{type:"tv",value:[]},shadowMapSize:{type:"v2v",value:[]},shadowBias:{type:"fv1",value:[]},shadowDarkness:{type:"fv1",value:[]},shadowMatrix:{type:"m4v",value:[]},pShadowMap:{type:"tv",value:[]},pShadowMapSize:{type:"v2v",value:[]},pShadowDarkness:{type:"fv1",value:[]},pPosition:{type:"v3v",value:[]}}},Yb.ShaderLib={outline:{uniforms:Yb.UniformsUtils.merge([Yb.UniformsLib.outline]),vertexShader:["uniform float outline_offset;","void main() {","vec4 mvPosition = modelViewMatrix * vec4( position + normalize(position)  * outline_offset, 1.0 );","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","void main() {","gl_FragColor = vec4(diffuse, 1.0 );","}"].join("\n")},blur:{uniforms:Yb.UniformsUtils.merge([Yb.UniformsLib.blur]),vertexShader:["varying vec2 vUv;","void main (){","gl_Position = vec4(position, 1.0);","vUv = uv;","}"].join("\n"),fragmentShader:["uniform vec2 texelSize;","uniform sampler2D map;","uniform int orientation;","uniform int blurAmount;","uniform float blurScale;","uniform float blurStrength;","uniform int useBlur;","uniform float blurGlobalAlpha;","uniform sampler2D depthMap;","varying vec2 vUv;","float Gaussian (float x, float deviation){","return (1.0 / sqrt(2.0 * 3.141592 * deviation)) * exp(-((x * x) / (2.0 * deviation)));","}","void main (){","float halfBlur = float(blurAmount) * 0.5;","vec4 colour = vec4(0.0);","if(useBlur == 0){","colour = texture2D(map,vUv);","}else {","vec4 texColour = vec4(0.0);","float deviation = halfBlur * 0.35;","deviation *= deviation;","float strength = 1.0 - blurStrength;","if ( orientation == 0 ){","for (int i = 0; i < 20; ++i){","if ( i >= blurAmount ){","break;","}","float offset = float(i) - halfBlur;","texColour = texture2D(map, vUv + vec2(offset / texelSize.x * blurScale, 0.0)) * Gaussian(offset * strength, deviation);","colour += texColour;","}","}else{","for (int i = 0; i < 20; ++i){","if ( i >= blurAmount )","break;","float offset = float(i) - halfBlur;","texColour = texture2D(map, vUv + vec2(0.0, offset / texelSize.y * blurScale)) * Gaussian(offset * strength, deviation);","colour += texColour;","}","}","}","gl_FragColor = clamp(colour, 0.0, 1.0);","if(useBlur == 0){","gl_FragColor.w *=  gl_FragColor.w * gl_FragColor.w * gl_FragColor.w * blurGlobalAlpha;","}","}"].join("\n")},deferred:{uniforms:Yb.UniformsUtils.merge([Yb.UniformsLib.deferred]),vertexShader:["varying vec4 vPosition;","varying vec3 vNormal;","void main (){","vNormal = mat3(modelViewMatrix) * normal;","vPosition = modelViewMatrix * vec4(position, 1.0);","gl_Position = projectionMatrix * vPosition;","}"].join("\n"),fragmentShader:["uniform float linearDepth;","uniform int isNormal;","varying vec4 vPosition;","varying vec3 vNormal;","void main (){","float linear_depth = length(vPosition) / linearDepth;","if(isNormal == 1){","vec3 normal = normalize(vNormal);","gl_FragColor = vec4(normal.x, normal.y, normal.z, 1.0);","}else{","gl_FragColor = vec4(vPosition.x, vPosition.y, vPosition.z, linear_depth);","}","}"].join("\n")},ssao:{uniforms:Yb.UniformsUtils.merge([Yb.UniformsLib.ssao]),vertexShader:["varying vec2 vUv;","void main (){","gl_Position = vec4(position, 1.0);","vUv = uv;","}"].join("\n"),fragmentShader:["uniform sampler2D map0;","uniform sampler2D map1;","uniform sampler2D map2;","uniform vec2 texelSize;","uniform float occluderBias;","uniform float samplingRadius;","uniform vec2 attenuation;","varying vec2 vUv;","float samplePixels (vec3 srcPosition, vec3 srcNormal, vec2 uv){","vec3 dstPosition = texture2D(map0, uv).xyz;","vec3 positionVec = dstPosition - srcPosition;","float intensity = max(dot(normalize(positionVec), srcNormal) - occluderBias, 0.0);","float dist = length(positionVec);","float attenuationValue = 1.0 / (attenuation.x + (attenuation.y * dist));","return intensity * attenuationValue;","}","void main (){","vec3 srcPosition = texture2D(map0, vUv).xyz;","vec3 srcNormal = texture2D(map1, vUv).xyz;","vec2 randVec = normalize(texture2D(map2, vUv).xy * 2.0 - 1.0);","float srcDepth = texture2D(map0, vUv).w;","float kernelRadius = samplingRadius * (1.0 - srcDepth);","vec2 kernel[4];","kernel[0] = vec2(0.0, 1.0);","kernel[1] = vec2(1.0, 0.0);","kernel[2] = vec2(0.0, -1.0);","kernel[3] = vec2(-1.0, 0.0);","const float sin45 = 0.707107;","float occlusion = 0.0;","for (int i = 0; i < 4; ++i){","vec2 k1 = reflect(kernel[i], randVec);","vec2 k2 = vec2(k1.x * sin45 - k1.y * sin45,k1.x * sin45 + k1.y * sin45);","k1 *= texelSize;","k2 *= texelSize;","occlusion += samplePixels(srcPosition, srcNormal, vUv + k1 * kernelRadius);","occlusion += samplePixels(srcPosition, srcNormal, vUv + k2 * kernelRadius * 0.75);","occlusion += samplePixels(srcPosition, srcNormal, vUv + k1 * kernelRadius * 0.5);","occlusion += samplePixels(srcPosition, srcNormal, vUv + k2 * kernelRadius * 0.25);","}","occlusion /= 16.0;","occlusion = clamp(occlusion, 0.0, 1.0);","gl_FragColor =  vec4(occlusion,0.0,0.0,1.0);","}"].join("\n")},basic:{uniforms:Yb.UniformsUtils.merge([Yb.UniformsLib.common,Yb.UniformsLib.gradient,Yb.UniformsLib.fog]),vertexShader:[Yb.ShaderChunk.map_pars_vertex,Yb.ShaderChunk.lightmap_pars_vertex,Yb.ShaderChunk.envmap_pars_vertex,Yb.ShaderChunk.color_pars_vertex,Yb.ShaderChunk.morphtarget_pars_vertex,Yb.ShaderChunk.skinning_pars_vertex,"void main() {",Yb.ShaderChunk.map_vertex,Yb.ShaderChunk.lightmap_vertex,Yb.ShaderChunk.color_vertex,Yb.ShaderChunk.skinbase_vertex,"#ifdef USE_ENVMAP",Yb.ShaderChunk.morphnormal_vertex,Yb.ShaderChunk.skinnormal_vertex,Yb.ShaderChunk.defaultnormal_vertex,"#endif",Yb.ShaderChunk.morphtarget_vertex,Yb.ShaderChunk.skinning_vertex,Yb.ShaderChunk.default_vertex,Yb.ShaderChunk.worldpos_vertex,Yb.ShaderChunk.envmap_vertex,"}"].join("\n"),
fragmentShader:["uniform vec3 diffuse;","uniform float opacity;",Yb.ShaderChunk.color_pars_fragment,Yb.ShaderChunk.map_pars_fragment,Yb.ShaderChunk.gradient_parts_fragment,Yb.ShaderChunk.lightmap_pars_fragment,Yb.ShaderChunk.envmap_pars_fragment,Yb.ShaderChunk.fog_pars_fragment,Yb.ShaderChunk.specularmap_pars_fragment,"void main() {","gl_FragColor = vec4( diffuse, opacity );",Yb.ShaderChunk.gradient_basic_fragment,Yb.ShaderChunk.map_fragment,Yb.ShaderChunk.alphatest_fragment,Yb.ShaderChunk.lightmap_fragment,Yb.ShaderChunk.color_fragment,Yb.ShaderChunk.envmap_fragment,Yb.ShaderChunk.linear_to_gamma_fragment,Yb.ShaderChunk.fog_fragment,"}"].join("\n")},lambert:{uniforms:Yb.UniformsUtils.merge([Yb.UniformsLib.common,Yb.UniformsLib.fog,Yb.UniformsLib.lights,Yb.UniformsLib.shadowmap,{ambient:{type:"c",value:new Yb.Color(16777215)},emissive:{type:"c",value:new Yb.Color(0)},wrapRGB:{type:"v3",value:new Yb.Vec3(1,1,1)}}]),vertexShader:["#define LAMBERT","varying vec3 vLightFront;","#ifdef DOUBLE_SIDED","varying vec3 vLightBack;","#endif",Yb.ShaderChunk.map_pars_vertex,Yb.ShaderChunk.lightmap_pars_vertex,Yb.ShaderChunk.envmap_pars_vertex,Yb.ShaderChunk.lights_lambert_pars_vertex,Yb.ShaderChunk.color_pars_vertex,Yb.ShaderChunk.morphtarget_pars_vertex,Yb.ShaderChunk.skinning_pars_vertex,Yb.ShaderChunk.shadowmap_pars_vertex,"void main() {",Yb.ShaderChunk.map_vertex,Yb.ShaderChunk.lightmap_vertex,Yb.ShaderChunk.color_vertex,Yb.ShaderChunk.morphnormal_vertex,Yb.ShaderChunk.skinbase_vertex,Yb.ShaderChunk.skinnormal_vertex,Yb.ShaderChunk.defaultnormal_vertex,Yb.ShaderChunk.morphtarget_vertex,Yb.ShaderChunk.skinning_vertex,Yb.ShaderChunk.default_vertex,Yb.ShaderChunk.worldpos_vertex,Yb.ShaderChunk.envmap_vertex,Yb.ShaderChunk.lights_lambert_vertex,Yb.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform float opacity;","varying vec3 vLightFront;","#ifdef DOUBLE_SIDED","varying vec3 vLightBack;","#endif",Yb.ShaderChunk.color_pars_fragment,Yb.ShaderChunk.map_pars_fragment,Yb.ShaderChunk.lightmap_pars_fragment,Yb.ShaderChunk.envmap_pars_fragment,Yb.ShaderChunk.fog_pars_fragment,Yb.ShaderChunk.shadowmap_pars_fragment,Yb.ShaderChunk.specularmap_pars_fragment,"void main() {","gl_FragColor = vec4( vec3 ( 1.0 ), opacity );",Yb.ShaderChunk.map_fragment,Yb.ShaderChunk.alphatest_fragment,Yb.ShaderChunk.specularmap_fragment,"#ifdef DOUBLE_SIDED","if ( gl_FrontFacing )","gl_FragColor.xyz *= vLightFront;","else","gl_FragColor.xyz *= vLightBack;","#else","gl_FragColor.xyz *= vLightFront;","#endif",Yb.ShaderChunk.lightmap_fragment,Yb.ShaderChunk.color_fragment,Yb.ShaderChunk.envmap_fragment,Yb.ShaderChunk.shadowmap_fragment,Yb.ShaderChunk.linear_to_gamma_fragment,Yb.ShaderChunk.fog_fragment,"}"].join("\n")},phong:{uniforms:Yb.UniformsUtils.merge([Yb.UniformsLib.common,Yb.UniformsLib.gradient,Yb.UniformsLib.bump,Yb.UniformsLib.normalmap,Yb.UniformsLib.fog,Yb.UniformsLib.lights,Yb.UniformsLib.shadowmap,{ambient:{type:"c",value:new Yb.Color(16777215)},emissive:{type:"c",value:new Yb.Color(0)},specular:{type:"c",value:new Yb.Color(1118481)},uspecularStrength:{type:"f",value:1},shininess:{type:"f",value:30},wrapRGB:{type:"v3",value:new Yb.Vec3(1,1,1)},mapSSAO:{type:"t",value:null}}]),vertexShader:["#define PHONG","varying vec3 vViewPosition;","varying vec3 vNormal;","varying vec4 finalPosition;",Yb.ShaderChunk.map_pars_vertex,Yb.ShaderChunk.lightmap_pars_vertex,Yb.ShaderChunk.envmap_pars_vertex,Yb.ShaderChunk.lights_phong_pars_vertex,Yb.ShaderChunk.color_pars_vertex,Yb.ShaderChunk.morphtarget_pars_vertex,Yb.ShaderChunk.skinning_pars_vertex,Yb.ShaderChunk.shadowmap_pars_vertex,"void main() {",Yb.ShaderChunk.map_vertex,Yb.ShaderChunk.lightmap_vertex,Yb.ShaderChunk.color_vertex,Yb.ShaderChunk.morphnormal_vertex,Yb.ShaderChunk.skinbase_vertex,Yb.ShaderChunk.skinnormal_vertex,Yb.ShaderChunk.defaultnormal_vertex,"vNormal = normalize( transformedNormal );",Yb.ShaderChunk.morphtarget_vertex,Yb.ShaderChunk.skinning_vertex,Yb.ShaderChunk.default_vertex,"vViewPosition = -mvPosition.xyz;",Yb.ShaderChunk.worldpos_vertex,Yb.ShaderChunk.envmap_vertex,Yb.ShaderChunk.lights_phong_vertex,Yb.ShaderChunk.shadowmap_vertex,"finalPosition = gl_Position;","}"].join("\n"),fragmentShader:["#define PHONG","uniform vec3 diffuse;","uniform float opacity;","uniform vec3 ambient;","uniform vec3 emissive;","uniform vec3 specular;","uniform float uspecularStrength;","uniform float shininess;","varying vec4 finalPosition;",Yb.ShaderChunk.color_pars_fragment,Yb.ShaderChunk.gradient_parts_fragment,Yb.ShaderChunk.map_pars_fragment,Yb.ShaderChunk.lightmap_pars_fragment,Yb.ShaderChunk.envmap_pars_fragment,Yb.ShaderChunk.fog_pars_fragment,Yb.ShaderChunk.lights_phong_pars_fragment,Yb.ShaderChunk.shadowmap_pars_fragment,Yb.ShaderChunk.bumpmap_pars_fragment,Yb.ShaderChunk.normalmap_pars_fragment,Yb.ShaderChunk.specularmap_pars_fragment,"#ifdef USE_SSAO","uniform sampler2D mapSSAO;","#endif","void main() {","gl_FragColor = vec4( vec3 ( 1.0 ), opacity );","vec3 tempDiffuse = diffuse;",Yb.ShaderChunk.gradient_phong_fragment,Yb.ShaderChunk.map_fragment,Yb.ShaderChunk.alphatest_fragment,Yb.ShaderChunk.specularmap_fragment,Yb.ShaderChunk.lights_phong_fragment,Yb.ShaderChunk.lightmap_fragment,Yb.ShaderChunk.color_fragment,Yb.ShaderChunk.envmap_fragment,Yb.ShaderChunk.shadowmap_fragment,Yb.ShaderChunk.linear_to_gamma_fragment,Yb.ShaderChunk.fog_fragment,"}"].join("\n")},particle_basic:{uniforms:Yb.UniformsUtils.merge([Yb.UniformsLib.particle,Yb.UniformsLib.shadowmap]),vertexShader:["uniform float size;","uniform float scale;",Yb.ShaderChunk.color_pars_vertex,Yb.ShaderChunk.shadowmap_pars_vertex,"void main() {",Yb.ShaderChunk.color_vertex,"vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","#ifdef USE_SIZEATTENUATION","gl_PointSize = size * ( scale / length( mvPosition.xyz ) );","#else","float s = normal.x;","if(s == 0.0){","   s = 1.0;","}","gl_PointSize = size * s;","#endif","gl_Position = projectionMatrix * mvPosition;",Yb.ShaderChunk.worldpos_vertex,Yb.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 psColor;","uniform float opacity;",Yb.ShaderChunk.color_pars_fragment,Yb.ShaderChunk.map_particle_pars_fragment,Yb.ShaderChunk.fog_pars_fragment,Yb.ShaderChunk.shadowmap_pars_fragment,"void main() {","gl_FragColor = vec4( psColor, opacity );",Yb.ShaderChunk.map_particle_fragment,Yb.ShaderChunk.alphatest_fragment,Yb.ShaderChunk.color_fragment,Yb.ShaderChunk.shadowmap_fragment,Yb.ShaderChunk.fog_fragment,"}"].join("\n")},billboard:{vertexShader:["uniform int useScreenCoordinates;","uniform int sizeAttenuation;","uniform vec3 screenPosition;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 scale;","uniform vec2 alignment;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uvOffset + uv * uvScale;","vec2 alignedPosition = position + alignment;","vec2 rotatedPosition;","rotatedPosition.x = ( cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y ) * scale.x;","rotatedPosition.y = ( sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y ) * scale.y;","vec4 finalPosition;","if( useScreenCoordinates != 0 ) {","finalPosition = vec4( screenPosition.xy + rotatedPosition, screenPosition.z, 1.0 );","} else {","finalPosition = projectionMatrix * modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","finalPosition.xy += rotatedPosition * ( sizeAttenuation == 1 ? 1.0 : finalPosition.z );","}","gl_Position = finalPosition;","}"].join("\n"),fragmentShader:["uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","void main() {","vec4 texture = texture2D( map, vUV );","if ( texture.a < alphaTest ) discard;","gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","if ( fogType > 0 ) {","float depth = gl_FragCoord.z / gl_FragCoord.w;","float fogFactor = 0.0;","if ( fogType == 1 ) {","fogFactor = smoothstep( fogNear, fogFar, depth );","} else {","const float LOG2 = 1.442695;","float fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );","fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","}","gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","}","}"].join("\n")},dashed:{uniforms:Yb.UniformsUtils.merge([Yb.UniformsLib.common,Yb.UniformsLib.fog,{scale:{type:"f",value:1},dashSize:{type:"f",value:1},totalSize:{type:"f",value:2}}]),vertexShader:["uniform float scale;","attribute float lineDistance;","varying float vLineDistance;",Yb.ShaderChunk.color_pars_vertex,"void main() {",Yb.ShaderChunk.color_vertex,"vLineDistance = scale * lineDistance;","vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform float opacity;","uniform float dashSize;","uniform float totalSize;","varying float vLineDistance;",Yb.ShaderChunk.color_pars_fragment,Yb.ShaderChunk.fog_pars_fragment,"void main() {","if ( mod( vLineDistance, totalSize ) > dashSize ) {","discard;","}","gl_FragColor = vec4( diffuse, opacity );",Yb.ShaderChunk.color_fragment,Yb.ShaderChunk.fog_fragment,"}"].join("\n")},depth:{uniforms:{mNear:{type:"f",value:1},mFar:{type:"f",value:2e3},opacity:{type:"f",value:1}},vertexShader:["void main() {","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float mNear;","uniform float mFar;","uniform float opacity;","void main() {","float depth = gl_FragCoord.z / gl_FragCoord.w;","float color = 1.0 - smoothstep( mNear, mFar, depth );","gl_FragColor = vec4( vec3( color ), opacity );","}"].join("\n")},normal:{uniforms:{opacity:{type:"f",value:1}},vertexShader:["varying vec3 vNormal;","void main() {","vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","vNormal = normalize( normalMatrix * normal );","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform float opacity;","varying vec3 vNormal;","void main() {","gl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );","}"].join("\n")},normalmap:{uniforms:Yb.UniformsUtils.merge([Yb.UniformsLib.fog,Yb.UniformsLib.lights,Yb.UniformsLib.shadowmap,{enableAO:{type:"i",value:0},enableDiffuse:{type:"i",value:0},enableSpecular:{type:"i",value:0},enableReflection:{type:"i",value:0},enableDisplacement:{type:"i",value:0},tDisplacement:{type:"t",value:null},tDiffuse:{type:"t",value:null},tCube:{type:"t",value:null},tNormal:{type:"t",value:null},tSpecular:{type:"t",value:null},tAO:{type:"t",value:null},uNormalScale:{type:"v2",value:new Yb.Vec2(1,1)},uDisplacementBias:{type:"f",value:0},uDisplacementScale:{type:"f",value:1},uDiffuseColor:{type:"c",value:new Yb.Color(16777215)},uSpecularColor:{type:"c",value:new Yb.Color(1118481)},uSpecualarStrength:{type:"f",value:1},uAmbientColor:{type:"c",value:new Yb.Color(16777215)},uShininess:{type:"f",value:30},uOpacity:{type:"f",value:1},useRefract:{type:"i",value:0},uRefractionRatio:{type:"f",value:.98},uReflectivity:{type:"f",value:.5},uOffset:{type:"v2",value:new Yb.Vec2(0,0)},uRepeat:{type:"v2",value:new Yb.Vec2(1,1)},wrapRGB:{type:"v3",value:new Yb.Vec3(1,1,1)}}]),fragmentShader:["uniform vec3 uAmbientColor;","uniform vec3 uDiffuseColor;","uniform vec3 uSpecularColor;","uniform vec3 uSpecularStrength;","uniform float uShininess;","uniform float uOpacity;","uniform bool enableDiffuse;","uniform bool enableSpecular;","uniform bool enableAO;","uniform bool enableReflection;","uniform sampler2D tDiffuse;","uniform sampler2D tNormal;","uniform sampler2D tSpecular;","uniform sampler2D tAO;","uniform samplerCube tCube;","uniform vec2 uNormalScale;","uniform bool useRefract;","uniform float uRefractionRatio;","uniform float uReflectivity;","varying vec3 vTangent;","varying vec3 vBinormal;","varying vec3 vNormal;","varying vec2 vUv;","uniform vec3 ambientLightColor;","#if MAX_DIR_LIGHTS > 0","uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];","uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];","#endif","#if MAX_HEMI_LIGHTS > 0","uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];","uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];","uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];","#endif","#if MAX_POINT_LIGHTS > 0","uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];","uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];","uniform float pointLightDistance[ MAX_POINT_LIGHTS ];","#endif","#if MAX_SPOT_LIGHTS > 0","uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];","uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];","uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];","uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];","uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];","uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];","#endif","#ifdef WRAP_AROUND","uniform vec3 wrapRGB;","#endif","varying vec3 vWorldPosition;","varying vec3 vViewPosition;",Yb.ShaderChunk.shadowmap_pars_fragment,Yb.ShaderChunk.fog_pars_fragment,"void main() {","gl_FragColor = vec4( vec3( 1.0 ), uOpacity );","vec3 specularTex = vec3( 1.0 );","vec3 normalTex = texture2D( tNormal, vUv ).xyz * 2.0 - 1.0;","normalTex.xy *= uNormalScale;","normalTex = normalize( normalTex );","if( enableDiffuse ) {","#ifdef GAMMA_INPUT","vec4 texelColor = texture2D( tDiffuse, vUv );","texelColor.xyz *= texelColor.xyz;","gl_FragColor = gl_FragColor * texelColor;","#else","gl_FragColor = gl_FragColor * texture2D( tDiffuse, vUv );","#endif","}","if( enableAO ) {","#ifdef GAMMA_INPUT","vec4 aoColor = texture2D( tAO, vUv );","aoColor.xyz *= aoColor.xyz;","gl_FragColor.xyz = gl_FragColor.xyz * aoColor.xyz;","#else","gl_FragColor.xyz = gl_FragColor.xyz * texture2D( tAO, vUv ).xyz;","#endif","}","if( enableSpecular )","specularTex = texture2D( tSpecular, vUv ).xyz;","mat3 tsb = mat3( normalize( vTangent ), normalize( vBinormal ), normalize( vNormal ) );","vec3 finalNormal = tsb * normalTex;","#ifdef FLIP_SIDED","finalNormal = -finalNormal;","#endif","vec3 normal = normalize( finalNormal );","vec3 viewPosition = normalize( vViewPosition );","#if MAX_POINT_LIGHTS > 0","vec3 pointDiffuse = vec3( 0.0 );","vec3 pointSpecular = vec3( 0.0 );","for ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {","vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );","vec3 pointVector = lPosition.xyz + vViewPosition.xyz;","float pointDistance = 1.0;","if ( pointLightDistance[ i ] > 0.0 )","pointDistance = 1.0 - min( ( length( pointVector ) / pointLightDistance[ i ] ), 1.0 );","pointVector = normalize( pointVector );","#ifdef WRAP_AROUND","float pointDiffuseWeightFull = max( dot( normal, pointVector ), 0.0 );","float pointDiffuseWeightHalf = max( 0.5 * dot( normal, pointVector ) + 0.5, 0.0 );","vec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );","#else","float pointDiffuseWeight = max( dot( normal, pointVector ), 0.0 );","#endif","pointDiffuse += pointDistance * pointLightColor[ i ] * uDiffuseColor * pointDiffuseWeight;","vec3 pointHalfVector = normalize( pointVector + viewPosition );","float pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );","float pointSpecularWeight = specularTex.r * max( pow( pointDotNormalHalf, uShininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float specularNormalization = ( uShininess + 2.0001 ) / 8.0;","vec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( pointVector, pointHalfVector ), 5.0 );","pointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * pointDistance * specularNormalization;","#else","pointSpecular += pointDistance * pointLightColor[ i ] * uSpecularColor * pointSpecularWeight * pointDiffuseWeight;","#endif","}","#endif","#if MAX_SPOT_LIGHTS > 0","vec3 spotDiffuse = vec3( 0.0 );","vec3 spotSpecular = vec3( 0.0 );","for ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {","vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );","vec3 spotVector = lPosition.xyz + vViewPosition.xyz;","float spotDistance = 1.0;","if ( spotLightDistance[ i ] > 0.0 )","spotDistance = 1.0 - min( ( length( spotVector ) / spotLightDistance[ i ] ), 1.0 );","spotVector = normalize( spotVector );","float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );","if ( spotEffect > spotLightAngleCos[ i ] ) {","spotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );","#ifdef WRAP_AROUND","float spotDiffuseWeightFull = max( dot( normal, spotVector ), 0.0 );","float spotDiffuseWeightHalf = max( 0.5 * dot( normal, spotVector ) + 0.5, 0.0 );","vec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );","#else","float spotDiffuseWeight = max( dot( normal, spotVector ), 0.0 );","#endif","spotDiffuse += spotDistance * spotLightColor[ i ] * uDiffuseColor * spotDiffuseWeight * spotEffect;","vec3 spotHalfVector = normalize( spotVector + viewPosition );","float spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );","float spotSpecularWeight = specularTex.r * max( pow( spotDotNormalHalf, uShininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float specularNormalization = ( uShininess + 2.0001 ) / 8.0;","vec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( spotVector, spotHalfVector ), 5.0 );","spotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * spotDistance * specularNormalization * spotEffect;","#else","spotSpecular += spotDistance * spotLightColor[ i ] * uSpecularColor * spotSpecularWeight * spotDiffuseWeight * spotEffect;","#endif","}","}","#endif","#if MAX_DIR_LIGHTS > 0","vec3 dirDiffuse = vec3( 0.0 );","vec3 dirSpecular = vec3( 0.0 );","for( int i = 0; i < MAX_DIR_LIGHTS; i++ ) {","vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );","vec3 dirVector = normalize( lDirection.xyz );","#ifdef WRAP_AROUND","float directionalLightWeightingFull = max( dot( normal, dirVector ), 0.0 );","float directionalLightWeightingHalf = max( 0.5 * dot( normal, dirVector ) + 0.5, 0.0 );","vec3 dirDiffuseWeight = mix( vec3( directionalLightWeightingFull ), vec3( directionalLightWeightingHalf ), wrapRGB );","#else","float dirDiffuseWeight = max( dot( normal, dirVector ), 0.0 );","#endif","dirDiffuse += directionalLightColor[ i ] * uDiffuseColor * dirDiffuseWeight;","vec3 dirHalfVector = normalize( dirVector + viewPosition );","float dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );","float dirSpecularWeight = specularTex.r * max( pow( dirDotNormalHalf, uShininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float specularNormalization = ( uShininess + 2.0001 ) / 8.0;","vec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );","dirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;","#else","dirSpecular += directionalLightColor[ i ] * uSpecularColor * dirSpecularWeight * dirDiffuseWeight;","#endif","}","#endif","#if MAX_HEMI_LIGHTS > 0","vec3 hemiDiffuse  = vec3( 0.0 );","vec3 hemiSpecular = vec3( 0.0 );","for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {","vec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );","vec3 lVector = normalize( lDirection.xyz );","float dotProduct = dot( normal, lVector );","float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;","vec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );","hemiDiffuse += uDiffuseColor * hemiColor;","vec3 hemiHalfVectorSky = normalize( lVector + viewPosition );","float hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;","float hemiSpecularWeightSky = specularTex.r * max( pow( hemiDotNormalHalfSky, uShininess ), 0.0 );","vec3 lVectorGround = -lVector;","vec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );","float hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;","float hemiSpecularWeightGround = specularTex.r * max( pow( hemiDotNormalHalfGround, uShininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float dotProductGround = dot( normal, lVectorGround );","float specularNormalization = ( uShininess + 2.0001 ) / 8.0;","vec3 schlickSky = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( lVector, hemiHalfVectorSky ), 5.0 );","vec3 schlickGround = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 5.0 );","hemiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );","#else","hemiSpecular += uSpecularColor * hemiColor * ( hemiSpecularWeightSky + hemiSpecularWeightGround ) * hemiDiffuseWeight;","#endif","}","#endif","vec3 totalDiffuse = vec3( 0.0 );","vec3 totalSpecular = vec3( 0.0 );","#if MAX_DIR_LIGHTS > 0","totalDiffuse += dirDiffuse;","totalSpecular += dirSpecular;","#endif","#if MAX_HEMI_LIGHTS > 0","totalDiffuse += hemiDiffuse;","totalSpecular += hemiSpecular;","#endif","#if MAX_POINT_LIGHTS > 0","totalDiffuse += pointDiffuse;","totalSpecular += pointSpecular;","#endif","#if MAX_SPOT_LIGHTS > 0","totalDiffuse += spotDiffuse;","totalSpecular += spotSpecular;","#endif","#ifdef METAL","gl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * uAmbientColor + totalSpecular );","#else","gl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * uAmbientColor ) + totalSpecular;","#endif","if ( enableReflection ) {","vec3 vReflect;","vec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );","if ( useRefract ) {","vReflect = refract( cameraToVertex, normal, uRefractionRatio );","} else {","vReflect = reflect( cameraToVertex, normal );","}","vec4 cubeColor = textureCube( tCube, vec3( -vReflect.x, vReflect.yz ) );","#ifdef GAMMA_INPUT","cubeColor.xyz *= cubeColor.xyz;","#endif","gl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularTex.r * uReflectivity );","}",Yb.ShaderChunk.shadowmap_fragment,Yb.ShaderChunk.linear_to_gamma_fragment,Yb.ShaderChunk.fog_fragment,"}"].join("\n"),vertexShader:["attribute vec4 tangent;","uniform vec2 uOffset;","uniform vec2 uRepeat;","uniform bool enableDisplacement;","#ifdef VERTEX_TEXTURES","uniform sampler2D tDisplacement;","uniform float uDisplacementScale;","uniform float uDisplacementBias;","#endif","varying vec3 vTangent;","varying vec3 vBinormal;","varying vec3 vNormal;","varying vec2 vUv;","varying vec3 vWorldPosition;","varying vec3 vViewPosition;",Yb.ShaderChunk.skinning_pars_vertex,Yb.ShaderChunk.shadowmap_pars_vertex,"void main() {",Yb.ShaderChunk.skinbase_vertex,Yb.ShaderChunk.skinnormal_vertex,"#ifdef USE_SKINNING","vNormal = normalize( normalMatrix * skinnedNormal.xyz );","vec4 skinnedTangent = skinMatrix * vec4( tangent.xyz, 0.0 );","vTangent = normalize( normalMatrix * skinnedTangent.xyz );","#else","vNormal = normalize( normalMatrix * normal );","vTangent = normalize( normalMatrix * tangent.xyz );","#endif","vBinormal = normalize( cross( vNormal, vTangent ) * tangent.w );","vUv = uv * uRepeat + uOffset;","vec3 displacedPosition;","#ifdef VERTEX_TEXTURES","if ( enableDisplacement ) {","vec3 dv = texture2D( tDisplacement, uv ).xyz;","float df = uDisplacementScale * dv.x + uDisplacementBias;","displacedPosition = position + normalize( normal ) * df;","} else {","#ifdef USE_SKINNING","vec4 skinVertex = vec4( position, 1.0 );","vec4 skinned  = boneMatX * skinVertex * skinWeight.x;","skinned 	  += boneMatY * skinVertex * skinWeight.y;","displacedPosition  = skinned.xyz;","#else","displacedPosition = position;","#endif","}","#else","#ifdef USE_SKINNING","vec4 skinVertex = vec4( position, 1.0 );","vec4 skinned  = boneMatX * skinVertex * skinWeight.x;","skinned 	  += boneMatY * skinVertex * skinWeight.y;","displacedPosition  = skinned.xyz;","#else","displacedPosition = position;","#endif","#endif","vec4 mvPosition = modelViewMatrix * vec4( displacedPosition, 1.0 );","vec4 worldPosition = modelMatrix * vec4( displacedPosition, 1.0 );","gl_Position = projectionMatrix * mvPosition;","vWorldPosition = worldPosition.xyz;","vViewPosition = -mvPosition.xyz;","#ifdef USE_SHADOWMAP","for( int i = 0; i < MAX_SHADOWS; i ++ ) {","vShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;","}","#endif","}"].join("\n")},cube:{uniforms:{tCube:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:["varying vec3 vWorldPosition;","void main() {","vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","vWorldPosition = worldPosition.xyz;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform samplerCube tCube;","uniform float tFlip;","varying vec3 vWorldPosition;","void main() {","gl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );","}"].join("\n")},depthRGBA:{uniforms:{isCube:{type:"i",value:0}},vertexShader:[Yb.ShaderChunk.morphtarget_pars_vertex,Yb.ShaderChunk.skinning_pars_vertex,"varying vec4 vPosition1;","void main() {",Yb.ShaderChunk.skinbase_vertex,Yb.ShaderChunk.morphtarget_vertex,Yb.ShaderChunk.skinning_vertex,Yb.ShaderChunk.default_vertex,"vPosition1 = modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform int isCube;","varying vec4 vPosition1;","varying vec3 vPosition2;","vec4 pack_depth( const in float depth ) {","const vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );","const vec4 bit_mask  = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );","vec4 res = fract( depth * bit_shift );","res -= res.xxyz * bit_mask;","return res;","}","vec4 pack (float depth){","const vec4 bias = vec4(1.0 / 255.0,1.0 / 255.0,1.0 / 255.0, 0.0);","float r = depth;","float g = fract(r * 255.0);","float b = fract(g * 255.0);","float a = fract(b * 255.0);","vec4 colour = vec4(r, g, b, a);","return colour - (colour.yzww * bias);","}","void main() {","if(isCube == 1){","gl_FragData[ 0 ] = pack(length(vPosition1) / 100000.0);","}else{","gl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );","}","}"].join("\n")}},Yb.ShaderTerrain={terrain:{uniforms:Yb.UniformsUtils.merge([Yb.UniformsLib.fog,Yb.UniformsLib.lights,Yb.UniformsLib.shadowmap,{enableDiffuse1:{type:"i",value:0},enableDiffuse2:{type:"i",value:0},enableDiffuse3:{type:"i",value:0},enableDisplacement:{type:"i",value:0},enableSpecular:{type:"i",value:0},enableReflection:{type:"i",value:0},tDiffuse1:{type:"t",value:null},tDiffuse2:{type:"t",value:null},tDiffuse3:{type:"t",value:null},tDetail:{type:"t",value:null},tNormal:{type:"t",value:null},tSpecular:{type:"t",value:null},tDisplacement:{type:"t",value:null},heightUnit:{type:"f",value:1},blendRange:{type:"fv1",value:null},uNormalScale:{type:"f",value:1},uDisplacementBias:{type:"f",value:0},uDisplacementScale:{type:"f",value:1},uDiffuseColor:{type:"c",value:new Yb.Color(15658734)},uSpecularColor:{type:"c",value:new Yb.Color(1118481)},uAmbientColor:{type:"c",value:new Yb.Color(328965)},uShininess:{type:"f",value:30},uOpacity:{type:"f",value:1},uRepeatBase:{type:"v2",value:new Yb.Vec2(1,1)},uRepeatOverlay:{type:"v2",value:new Yb.Vec2(1,1)},uOffset:{type:"v2",value:new Yb.Vec2(0,0)}}]),fragmentShader:["uniform vec3 uAmbientColor;","uniform vec3 uDiffuseColor;","uniform vec3 uSpecularColor;","uniform float uShininess;","uniform float uOpacity;","uniform bool enableDiffuse1;","uniform bool enableDiffuse2;","uniform bool enableDiffuse3;","uniform bool enableSpecular;","uniform bool enableDisplacement;","uniform float blendRange[2];","uniform float heightUnit;","uniform sampler2D tDiffuse1;","uniform sampler2D tDiffuse2;","uniform sampler2D tDiffuse3;","uniform sampler2D tDetail;","uniform sampler2D tNormal;","uniform sampler2D tSpecular;","uniform sampler2D tDisplacement;","uniform float uNormalScale;","uniform vec2 uRepeatOverlay;","uniform vec2 uRepeatBase;","uniform vec2 uOffset;","varying vec3 vTangent;","varying vec3 vBinormal;","varying vec3 vNormal;","varying vec2 vUv;","varying vec4 vPosition;","uniform vec3 ambientLightColor;","#if MAX_DIR_LIGHTS > 0","uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];","uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];","#endif","#if MAX_HEMI_LIGHTS > 0","uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];","uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];","uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];","#endif","#if MAX_POINT_LIGHTS > 0","uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];","uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];","uniform float pointLightDistance[ MAX_POINT_LIGHTS ];","#endif","varying vec3 vViewPosition;",Yb.ShaderChunk.shadowmap_pars_fragment,Yb.ShaderChunk.fog_pars_fragment,"void main() {","gl_FragColor = vec4( vec3( 1.0 ), uOpacity );","vec3 specularTex = vec3( 1.0 );","vec2 uvOverlay = uRepeatOverlay * vUv + uOffset;","vec2 uvBase = uRepeatBase * vUv;","vec3 normalTex = texture2D( tDetail, uvOverlay ).xyz * 2.0 - 1.0;","normalTex.xy *= uNormalScale;","normalTex = normalize( normalTex );","if( (enableDiffuse1 && enableDiffuse2)  || (enableDiffuse1 && enableDiffuse3) || (enableDiffuse2 && enableDiffuse3) ){","vec4 colDiffuse1 = texture2D( tDiffuse1, uvOverlay );","vec4 colDiffuse2 = texture2D( tDiffuse2, uvOverlay );","vec4 colDiffuse3 = texture2D( tDiffuse3, uvOverlay );","vec4 allDefiuuses[3];","allDefiuuses[0] = colDiffuse1;","allDefiuuses[1] = colDiffuse2;","allDefiuuses[2] = colDiffuse3;","#ifdef GAMMA_INPUT","colDiffuse1.xyz *= colDiffuse1.xyz;","colDiffuse2.xyz *= colDiffuse2.xyz;","colDiffuse3.xyz *= colDiffuse3.xyz;","#endif","vec4 mixColor;","if(enableDisplacement){","vec4 dis = texture2D( tDisplacement, uvBase );","if(enableDiffuse1 && enableDiffuse2 && enableDiffuse3){","float total = dis.r + dis.g + dis.b;","if(total == 0.0){","mixColor = colDiffuse1 * 1.0/3.0 + colDiffuse2 * 1.0/3.0 + colDiffuse3 * 1.0/3.0;","}else{","mixColor = colDiffuse1 * dis.r/total + colDiffuse2 * dis.g/total + colDiffuse3 * dis.b/total;","}","}","}else {","mixColor = colDiffuse2;","float y = vPosition.y;","float blend2Bottom = blendRange[1] * heightUnit * 255.0;","float percent = 0.0;","if(y < blendRange[0] * heightUnit * 255.0){","mixColor = colDiffuse1;","percent = y / (blendRange[0] * heightUnit * 255.0);","if(percent >=0.8){","mixColor = mix(colDiffuse1,colDiffuse2,(percent - 0.8) / 0.2);","}","} else if(y > blend2Bottom){","mixColor = colDiffuse3;","percent = (y - blend2Bottom) / (heightUnit * 255.0 - blend2Bottom);","if(percent <= 0.2){","mixColor = mix(colDiffuse2,colDiffuse3,percent/0.2);","}","}","}","gl_FragColor = gl_FragColor * mixColor;"," } else if( enableDiffuse1 ) {","gl_FragColor = gl_FragColor * texture2D( tDiffuse1, uvOverlay );","} else if( enableDiffuse2 ) {","gl_FragColor = gl_FragColor * texture2D( tDiffuse2, uvOverlay );","}","if( enableSpecular )","specularTex = texture2D( tSpecular, uvOverlay ).xyz;","mat3 tsb = mat3( vTangent, vBinormal, vNormal );","vec3 finalNormal = tsb * normalTex;","vec3 normal = normalize( finalNormal );","vec3 viewPosition = normalize( vViewPosition );","#if MAX_POINT_LIGHTS > 0","vec3 pointDiffuse = vec3( 0.0 );","vec3 pointSpecular = vec3( 0.0 );","for ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {","vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );","vec3 lVector = lPosition.xyz + vViewPosition.xyz;","float lDistance = 1.0;","if ( pointLightDistance[ i ] > 0.0 )","lDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );","lVector = normalize( lVector );","vec3 pointHalfVector = normalize( lVector + viewPosition );","float pointDistance = lDistance;","float pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );","float pointDiffuseWeight = max( dot( normal, lVector ), 0.0 );","float pointSpecularWeight = specularTex.r * max( pow( pointDotNormalHalf, uShininess ), 0.0 );","pointDiffuse += pointDistance * pointLightColor[ i ] * uDiffuseColor * pointDiffuseWeight;","pointSpecular += pointDistance * pointLightColor[ i ] * uSpecularColor * pointSpecularWeight * pointDiffuseWeight;","}","#endif","#if MAX_DIR_LIGHTS > 0","vec3 dirDiffuse = vec3( 0.0 );","vec3 dirSpecular = vec3( 0.0 );","for( int i = 0; i < MAX_DIR_LIGHTS; i++ ) {","vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );","vec3 dirVector = normalize( lDirection.xyz );","vec3 dirHalfVector = normalize( dirVector + viewPosition );","float dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );","float dirDiffuseWeight = max( dot( normal, dirVector ), 0.0 );","float dirSpecularWeight = specularTex.r * max( pow( dirDotNormalHalf, uShininess ), 0.0 );","dirDiffuse += directionalLightColor[ i ] * uDiffuseColor * dirDiffuseWeight;","dirSpecular += directionalLightColor[ i ] * uSpecularColor * dirSpecularWeight * dirDiffuseWeight;","}","#endif","#if MAX_HEMI_LIGHTS > 0","vec3 hemiDiffuse  = vec3( 0.0 );","vec3 hemiSpecular = vec3( 0.0 );","for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {","vec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );","vec3 lVector = normalize( lDirection.xyz );","float dotProduct = dot( normal, lVector );","float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;","hemiDiffuse += uDiffuseColor * mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );","float hemiSpecularWeight = 0.0;","vec3 hemiHalfVectorSky = normalize( lVector + viewPosition );","float hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;","hemiSpecularWeight += specularTex.r * max( pow( hemiDotNormalHalfSky, uShininess ), 0.0 );","vec3 lVectorGround = -lVector;","vec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );","float hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;","hemiSpecularWeight += specularTex.r * max( pow( hemiDotNormalHalfGround, uShininess ), 0.0 );","hemiSpecular += uSpecularColor * mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight ) * hemiSpecularWeight * hemiDiffuseWeight;","}","#endif","vec3 totalDiffuse = vec3( 0.0 );","vec3 totalSpecular = vec3( 0.0 );","#if MAX_DIR_LIGHTS > 0","totalDiffuse += dirDiffuse;","totalSpecular += dirSpecular;","#endif","#if MAX_HEMI_LIGHTS > 0","totalDiffuse += hemiDiffuse;","totalSpecular += hemiSpecular;","#endif","#if MAX_POINT_LIGHTS > 0","totalDiffuse += pointDiffuse;","totalSpecular += pointSpecular;","#endif",Yb.ShaderChunk.shadowmap_fragment,Yb.ShaderChunk.linear_to_gamma_fragment,Yb.ShaderChunk.fog_fragment,"}"].join("\n"),
vertexShader:["attribute vec4 tangent;","uniform vec2 uRepeatBase;","uniform sampler2D tNormal;","#ifdef VERTEX_TEXTURES","uniform sampler2D tDisplacement;","uniform float uDisplacementScale;","uniform float uDisplacementBias;","#endif","varying vec3 vTangent;","varying vec3 vBinormal;","varying vec3 vNormal;","varying vec2 vUv;","varying vec4 vPosition;","varying vec3 vViewPosition;",Yb.ShaderChunk.shadowmap_pars_vertex,"void main() {","vNormal = normalize( normalMatrix * normal );","vTangent = normalize( normalMatrix * tangent.xyz );","vBinormal = cross( vNormal, vTangent ) * tangent.w;","vBinormal = normalize( vBinormal );","vUv = uv;","vec2 uvBase = uv * uRepeatBase;","#ifdef VERTEX_TEXTURES","vec3 dv = texture2D( tDisplacement, uvBase ).xyz;","float df = uDisplacementScale * dv.x + uDisplacementBias;","vec3 displacedPosition = normal * df + position;","vec4 worldPosition = modelMatrix * vec4( displacedPosition, 1.0 );","vec4 mvPosition = modelViewMatrix * vec4( displacedPosition, 1.0 );","#else","vPosition = vec4(position,1.0);","vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","#endif","gl_Position = projectionMatrix * mvPosition;","vViewPosition = -mvPosition.xyz;","vec3 normalTex = texture2D( tNormal, uvBase ).xyz * 2.0 - 1.0;","vNormal = normalMatrix * normalTex;",Yb.ShaderChunk.shadowmap_vertex,"}"].join("\n")}},Yb.ShaderLib.terrain=Yb.ShaderTerrain.terrain,Yb.Fog=function(a,b,c){this.name="",this.color=new Yb.Color(a),this.near=b!==e?b:1,this.far=c!==e?c:1e3},Yb.Fog.prototype={constructor:Yb.Fog,clone:function(){return new Yb.Flog(this.color.getHex(),this.near,this.far)},refreshUniforms:function(a){a.fogNear.value=this.near,a.fogFar.value=this.far,a.fogColor.value=this.color}},Yb.FogExp2=function(a,b){this.name="",this.color=new Yb.Color(a),this.density=b!==e?b:1},Yb.FogExp2.prototype={DensityFactor:25e-5,constructor:Yb.FogExp2,clone:function(){return new Yb.FogExp2(this.color.getHex(),this.density)},refreshUniforms:function(a){a.fogDensity.value=this.density*this.DensityFactor,a.fogColor.value=this.color}};var sc={},tc=sc.RADIANS_TO_DEGREES=180/Math.PI,uc=sc.DEGREES_TO_RADIANS=Math.PI/180;sc.isPowerOfTwo=function(a){return 0===(a&a-1)},sc.clone=function(a,b){b==e&&(b=new a.prototype.constructor);for(var c in a)if("id"!==c){var d=a[c];if(d.copy&&"function"==typeof d.copy)b[c].copy(d);else if(d instanceof Array){var f=d,g=b[c];null==g&&(g=[]);for(var h=0;h<f.length;h++){var i=f[h];g.push(i.clone())}}else cloneObjet[c]=d}},sc.paramToGL=function(a,b){if(!b)return void console.error("No webgl context");switch(a){case Yb.RepeatWrapping:return b.REPEAT;case Yb.ClampToEdgeWrapping:return b.CLAMP_TO_EDGE;case Yb.MirroredRepeatWrapping:return b.MIRRORED_REPEAT;case Yb.NearestFilter:return b.NEAREST;case Yb.NearestMipMapNearestFilter:return b.NEAREST_MIPMAP_NEAREST;case Yb.NearestMipMapLinearFilter:return b.NEAREST_MIPMAP_LINEAR;case Yb.LinearFilter:return b.LINEAR;case Yb.LinearMipMapNearestFilter:return b.LINEAR_MIPMAP_NEAREST;case Yb.LinearMipMapLinearFilter:return b.LINEAR_MIPMAP_LINEAR;case Yb.ByteType:return b.BYTE;case Yb.UnsignedByteType:return b.UNSIGNED_BYTE;case Yb.ShortType:return b.SHORT;case Yb.UnsignedShortType:return b.UNSIGNED_SHORT;case Yb.IntType:return b.INT;case Yb.UnsignedIntType:return b.UNSIGNED_INT;case Yb.FloatType:return b.FLOAT;case Yb.AlphaFormat:return b.ALPHA;case Yb.RGBFormat:return b.RGB;case Yb.RGBAFormat:return b.RGBA;case Yb.LuminanceFormat:return b.LUMINANCE;case Yb.LuminanceAlphaFormat:return b.LUMINANCE_ALPHA;case Yb.AddEquation:return b.FUNC_ADD;case Yb.SubtractEquation:return b.FUNC_SUBTRACT;case Yb.ReverseSubtractEquation:return b.FUNC_REVERSE_SUBTRACT;case Yb.ZeroFactor:return b.ZERO;case Yb.OneFactor:return b.ONE;case Yb.SrcColorFactor:return b.SRC_COLOR;case Yb.OneMinusSrcColorFactor:return b.ONE_MINUS_SRC_COLOR;case Yb.SrcAlphaFactor:return b.SRC_ALPHA;case Yb.OneMinusSrcAlphaFactor:return b.ONE_MINUS_SRC_ALPHA;case Yb.DstAlphaFactor:return b.DST_ALPHA;case Yb.OneMinusDstAlphaFactor:return b.ONE_MINUS_DST_ALPHA;case Yb.DstColorFactor:return b.DST_COLOR;case Yb.OneMinusDstColorFactor:return b.ONE_MINUS_DST_COLOR;case Yb.SrcAlphaSaturateFactor:return b.SRC_ALPHA_SATURATE}return 0},sc.createElement=function(a,b,c,d){var f,g,h,i,j=a.vertices.length,k=(a.uvs.length,a.vertices),l=b.vertices,m=a.faces,n=b.faces,o=a.uvs,p=b.uvs,q=[],r=[],s=[];d===e&&(d=0),a instanceof Yb.Element&&(a.matrixAutoUpdate&&a.updateMatrix(),f=a.matrix,g=(new _b).getNormalMatrix(f)),b instanceof Yb.Element&&(b.matrixAutoUpdate&&b.updateMatrix(),h=b.matrix,i=(new _b).getNormalMatrix(h));for(var t=0,u=k.length;u>t;t++){var v=k[t],w=v.clone();f&&w.applyMatrix4(f),r.push(w)}for(var t=0,u=l.length;u>t;t++){var v=l[t],w=v.clone();h&&w.applyMatrix4(h),r.push(w)}for(t=0,u=m.length;u>t;t++){var x,y,z,A=m[t],B=A.vertexNormals,C=A.vertexColors;x=A instanceof oc?new oc(A.a,A.b,A.c):new pc(A.a,A.b,A.c,A.d),x.normal.copy(A.normal),g&&x.normal.applyMatrix3(g).normalize();for(var D=0,E=B.length;E>D;D++)y=B[D].clone(),g&&y.applyMatrix3(g).normalize(),x.vertexNormals.push(y);x.color.copy(A.color);for(var D=0,E=C.length;E>D;D++)z=C[D],x.vertexColors.push(z.clone());x.materialIndex=A.materialIndex,x.centroid.copy(A.centroid),f&&x.centroid.applyMatrix4(f),q.push(x)}for(t=0,u=n.length;u>t;t++){var x,y,z,A=n[t],B=A.vertexNormals,C=A.vertexColors;x=A instanceof oc?new oc(A.a+j,A.b+j,A.c+j):new pc(A.a+j,A.b+j,A.c+j,A.d+j),x.normal.copy(A.normal),i&&x.normal.applyMatrix3(i).normalize();for(var D=0,E=B.length;E>D;D++)y=B[D].clone(),i&&y.applyMatrix3(i).normalize(),x.vertexNormals.push(y);x.color.copy(A.color);for(var D=0,E=C.length;E>D;D++)z=C[D],x.vertexColors.push(z.clone());x.materialIndex=A.materialIndex+d,x.centroid.copy(A.centroid),h&&x.centroid.applyMatrix4(h),q.push(x)}for(t=0,u=o.length;u>t;t++){for(var F=o[t],G=[],D=0,E=F.length;E>D;D++)G.push(new Zb(F[D].x,F[D].y));s.push(G)}for(t=0,u=p.length;u>t;t++){for(var F=p[t],G=[],D=0,E=F.length;E>D;D++)G.push(new Zb(F[D].x,F[D].y));s.push(G)}var H=new Yb.Entity;return H.vertices=r,H.faces=q,H.uvs=s,H.material=c===e?a.material:c,H},sc.transformElement=function(a,b){var c,d,e=a.vertices,f=a.faces,g=a.uvs,h=[],i=[],j=[];a instanceof Yb.Element&&(a.matrixAutoUpdate&&a.updateMatrix(),c=a.matrix,d=(new _b).getNormalMatrix(c));for(var k=0,l=e.length;l>k;k++){var m=e[k],n=m.clone();c&&n.applyMatrix4(c),i.push(n)}for(k=0,l=f.length;l>k;k++){var o,p,q,r=f[k],s=r.vertexNormals,t=r.vertexColors;o=r instanceof oc?new oc(r.a,r.b,r.c):new pc(r.a,r.b,r.c,r.d),o.normal.copy(r.normal),d&&o.normal.applyMatrix3(d).normalize();for(var u=0,v=s.length;v>u;u++)p=s[u].clone(),d&&p.applyMatrix3(d).normalize(),o.vertexNormals.push(p);o.color.copy(r.color);for(var u=0,v=t.length;v>u;u++)q=t[u],o.vertexColors.push(q.clone());o.materialIndex=r.materialIndex,o.centroid.copy(r.centroid),c&&o.centroid.applyMatrix4(c),h.push(o)}for(k=0,l=g.length;l>k;k++){for(var w=g[k],x=[],u=0,v=w.length;v>u;u++)x.push(new Zb(w[u].x,w[u].y));j.push(x)}if(b){var y=new Yb.Entity(a.material);y.vertices=i,y.faces=h,y.uvs=j,y.setPosition(0,0,0),y.setRotation(0,0,0),y.setScale(1,1,1);var z={};return z.vertices=i,z.faces=h,z.uvs=j,y.primitive=new Yb.Primitive(z),y}a.vertices=i,a.faces=h,a.uvs=j,a.setPosition(0,0,0),a.setRotation(0,0,0),a.setScale(1,1,1);var z={};z.vertices=i,z.faces=h,z.uvs=j,a.primitive=new Yb.Primitive(z);for(var k in c.elements)a._attachId+=c.elements[k];return a},sc.mergeElements=function(a){var b,c,d,e,f,g,h=0,i=0,j=0;for(b=0;b<a.length;b++)d=a[b],h+=d.materialSize;var k=new Yb.Entity(h),l={},m={},n=(new $b(0,0,0),[]),o=[],p=[],q=[],r=new Yb.ArrayMaterial;for(b=0;b<a.length;b++){for(d=a[b],d.matrixAutoUpdate&&d.updateWorldMatrix(),e=d.worldMatrix.clone(),f=(new _b).getNormalMatrix(e),c=0;c<d.vertices.length;c++)g=d.vertices[c],n.push(g.clone().applyMatrix4(e));for(c=0;c<d.faces.length;c++){var s,t=d.faces[c];t.vertexNormals,t.vertexColors;s=t instanceof oc?new oc(t.a+i,t.b+i,t.c+i):new pc(t.a+i,t.b+i,t.c+i,t.d+i),s.normal.copy(t.normal),f&&s.normal.applyMatrix3(f).normalize(),s.materialIndex=t.materialIndex+j,s.centroid.copy(t.centroid),e&&s.centroid.applyMatrix4(e),o.push(s)}for(c=0,len=d.uvs.length;c<len;c++){for(var u=d.uvs[c],v=[],w=0,x=u.length;x>w;w++)v.push(new Zb(u[w].x,u[w].y));p.push(v)}if(d.uv2s&&d.uv2s.length>0)for(c=0,len=d.uv2s.length;c<len;c++){for(var y=d.uv2s[c],z=[],w=0,x=y.length;x>w;w++)z.push(new Zb(y[w].x,y[w].y));q.push(z)}r.materials=r.materials.concat(d.material.materials),i+=d.vertices.length,j+=d.materialSize;for(var A in d.styleMap){var B=l[A];null==B&&(B=[]);var C=d.styleMap[A],D=!0;if(sc.isArray(C))for(var w=0;w<C.length;w++)B.push(C[b]),w>0&&C[w]!=C[w-1]&&(D=!1);else for(var w=0;w<d.materialSize;w++)B.push(C);(1==m[A]||null==m[A])&&(m[A]=D),l[A]=B}}for(var A in m)1==m[A]&&(l[A]=l[A][0]);return k.styleMap=l,k.material=r,k.vertices=n,k.faces=o,k.setUvs(p),k.uv2s=q,k.setUpdateFlags(!0),k},sc.mergeElement=function(a,b,c){var d,f,g,h,i=a.vertices.length,j=(a.uvs.length,a.vertices),k=b.vertices,l=a.faces,m=b.faces,n=a.uvs,o=b.uvs,p=[],q=[],r=[];c===e&&(c=0),a instanceof Yb.Element&&(a.matrixAutoUpdate&&a.updateMatrix(),d=a.matrix,f=(new _b).getNormalMatrix(d)),b instanceof Yb.Element&&(b.matrixAutoUpdate&&b.updateMatrix(),g=b.matrix,h=(new _b).getNormalMatrix(g));for(var s=0,t=j.length;t>s;s++){var u=j[s],v=u.clone();d&&v.applyMatrix4(d),q.push(v)}for(var s=0,t=k.length;t>s;s++){var u=k[s],v=u.clone();g&&v.applyMatrix4(g),q.push(v)}for(s=0,t=l.length;t>s;s++){var w,x,y,z=l[s],A=z.vertexNormals,B=z.vertexColors;w=z instanceof oc?new oc(z.a,z.b,z.c):new pc(z.a,z.b,z.c,z.d),w.normal.copy(z.normal),f&&w.normal.applyMatrix3(f).normalize();for(var C=0,D=A.length;D>C;C++)x=A[C].clone(),f&&x.applyMatrix3(f).normalize(),w.vertexNormals.push(x);w.color.copy(z.color);for(var C=0,D=B.length;D>C;C++)y=B[C],w.vertexColors.push(y.clone());w.materialIndex=z.materialIndex,w.centroid.copy(z.centroid),d&&w.centroid.applyMatrix4(d),p.push(w)}for(s=0,t=m.length;t>s;s++){var w,x,y,z=m[s],A=z.vertexNormals,B=z.vertexColors;w=z instanceof oc?new oc(z.a+i,z.b+i,z.c+i):new pc(z.a+i,z.b+i,z.c+i,z.d+i),w.normal.copy(z.normal),h&&w.normal.applyMatrix3(h).normalize();for(var C=0,D=A.length;D>C;C++)x=A[C].clone(),h&&x.applyMatrix3(h).normalize(),w.vertexNormals.push(x);w.color.copy(z.color);for(var C=0,D=B.length;D>C;C++)y=B[C],w.vertexColors.push(y.clone());w.materialIndex=z.materialIndex+c,w.centroid.copy(z.centroid),g&&w.centroid.applyMatrix4(g),p.push(w)}for(s=0,t=n.length;t>s;s++){for(var E=n[s],F=[],C=0,D=E.length;D>C;C++)F.push(new Zb(E[C].x,E[C].y));r.push(F)}for(s=0,t=o.length;t>s;s++){for(var E=o[s],F=[],C=0,D=E.length;D>C;C++)F.push(new Zb(E[C].x,E[C].y));r.push(F)}return a.vertices=q,a.faces=p,a.uvs=r,a._position.set(0,0,0),a._rotation.set(0,0,0),a._scale.set(1,1,1),a},sc.autoAdjustNetworkBounds=function(a,b,c,e,f,g){f=f||0,g=g||0,a.adjustBounds(b[c]-f,b[e]-g),d.addEventListener?d.addEventListener("resize",function(){a.adjustBounds(b[c]-f,b[e]-g,g,f)},!0):d.attachEvent?d.attachEvent("onresize",function(){a.adjustBounds(b[c]-f,b[e]-g,g,f)}):d.onresize=function(){a.adjustBounds(b[c]-f,b[e]-g,g,f)}},sc.isEmptyObject=function(a){for(var b in a)return!1;return!0},sc.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)},sc.isSame=function(a,b){if(a===b)return!0;if(null==a&&null!=b)return!1;if(null!=a&&null==b)return!1;if(typeof a!=typeof b)return!1;for(var c in a)if(a[c]!=b[c])return!1;for(var c in b)if(a[c]!=b[c])return!1;return!0},sc.toString=function(a){if(a){var b="";for(var c in a)b+=c+":"+a[c];return b}},sc.validateLicense=function(a){Ac=a,Qc()},sc.getLicense=function(){return Ac},sc.getObjectCount=function(a){if(!a)return 0;var b=0;for(var c in a)b++;return b},sc.isNaN=function(a){return""===a||null===a||isNaN(a)},sc.getTransformVertices=function(a,b,c){null==c&&(c=[]);var d,e;if(a instanceof Yb.Node||a instanceof Yb.Billboard){for(d=0;d<a.vertices.length;d++)e=a.vertices[d].clone(),a instanceof Yb.Billboard?(e.x*=a.rotation3d.x,e.y*=a.rotation3d.y,e.add(a.getPosition())):e.applyMatrix4(a.worldMatrix),c.push(e);for(var d=0;d<(a._childList?a._childList.size():0);d++){var f=a._childList.get(d);sc.getTransformVertices(f,b,c)}}return c},sc.getBoundingBox=function(a,b){var c,d,e;if(null==a)return null;c=a instanceof kc?a._as:sc.isArray(a)?a:[a];var f=[];for(d=0;d<c.length;d++)e=c[d],sc.getTransformVertices(e,b,f);var g=new Yb.BoundingBox;return g.setFromPoints(f),g},sc.mergeWrapMap=function(a){if(a instanceof qc&&!a.getWrapMap()){for(var b,c=[],d=(a.getMaterialMapping(),a.material.materials),e=0;e<d.length;e++)b=d[e],b.map&&-1==c.indexOf(b.map._image)&&c.push(b.map._image);a.setWrapMap(!0)}},sc.setWrapMap=function(a,b,c,d){sc.loadImages(b,function(e){var f=mono.Utils.createWrapMapFromImages(e,c,d);f.__uniqueCode="";for(var g=0;g<b.length;g++)f.__uniqueCode+=b[g].src;for(var g in c)f.__uniqueCode+=g+":"+c[g];if(sc.isArray(a))for(var g=0;g<a.length;g++)a[g].setStyle("m.texture.image",f),a[g].setClient("_originalImage",b),a[g].setClient("_wrapMapping",c);else a.setStyle("m.texture.image",f),a.setClient("_wrapMapping",c)})},sc.loadImages=function(a,b){function c(a){a.onload=function(){a.loaded=!0,d(),a.onload=null}}function d(){for(var c=0;c<a.length;c++)if(!a[c].loaded)return;b(a)}if(null!=a&&0!=a.length&&null!=b)for(var e=0;e<a.length;e++){var f=a[e];"string"==typeof f&&(a[e]=new Image,a[e].crossOrigin="",a[e].src=f),f=a[e],c(f)}},sc.createWrapMapFromImages=function(a,b,c,d,e){if(null==a||0==a.length)return null;c=(c||"six-each").toLowerCase();var f="six-each"==c||"front-other"==c||"back-other"==c||"left-other"==c||"right-other"==c||"top-other"==c||"bottom-other"==c;if(f){null==b&&(b={0:"bottom",1:"top",2:"back",3:"left",4:"front",5:"right"});var g=document.createElement("canvas"),h=g.getContext("2d"),i=0,j=0;if("six-each"==c){var k={bottom:[0,0],top:[1/3,0],back:[2/3,0],left:[0,.5],front:[1/3,.5],right:[2/3,.5]};if(null==d||null==e)for(var l=0;l<a.length;l++)i=Math.max(a[l].width,i),j=Math.max(a[l].height,j);i*=3,j*=2,i>1024&&(i=1024),j>1024&&(j=1024);var m,n=["front","back","right","left","top","bottom"],o=[];for(var l in b){var p=b[l];"other"!==p?(o.push(p),n.splice(n.indexOf(p),1)):m=l}null!=m&&(b[m]=n),d=d||i,e=e||j,g.setAttribute("width",d),g.setAttribute("height",e);for(var l=(Math.min(a.length,6),0);6>l;l++){var q=b[l];if(q){var r=q;r=sc.isArray(q)?q:-1!=q.indexOf(",")?q.split(","):[q];for(var s=0;s<r.length;s++){var p=r[s],t=k[p][0],u=k[p][1];h.drawImage(a[l],t*d,u*e,d/3,e/2)}}}}else{var v=c.split("-")[0];if(null==d||null==e)for(var l=0;l<a.length;l++)i+=a[l].width,j=Math.max(a[l].height,j);d=d||i,e=e||j,g.setAttribute("width",d),g.setAttribute("height",e);for(var l=(b[v],Math.min(a.length,2),0);2>l;l++){var q=b[l];q&&(q==v?h.drawImage(a[l],0,0,d/2,e):h.drawImage(a[l],d/2,0,d/2,e))}}return g}},sc.getVectorAngles=function(a,b){var c=a;b&&(c=b.clone().sub(a)),c=c.normalize();var d=Math.asin(c.y)*tc,e=Math.atan2(c.x,c.z)*tc;return[e,d]},sc.getPixelFromImage=function(a,b,c){var d;bc.isCanvas(a)?d=a:(d=document.createElement("canvas"),d.width=a.width,d.height=a.height,d.getContext("2d").drawImage(a,0,0,a.width,a.height)),b-=Math.floor(b),c-=Math.floor(c),c=1-c;var e=d.getContext("2d").getImageData(a.width*b,a.height*c,1,1).data;return e},sc.nextPowerOfTwo=function(a){return a--,a|=a>>1,a|=a>>2,a|=a>>4,a|=a>>8,a|=a>>16,a++,a},sc.createTextBillboard=function(a,b){var c=new mono.Billboard;a=a||"",b=b||{};var d=sc.createTextImage(a,b);return c.setStyle("m.texture.image",d),c.setScale(d.width,d.height,1),c},sc.createTextImage=function(a,b){a=a||"";var c=b.font,d=b.color,f=b.background,g=b.powerOfTwo,h=b.canvas,i=b.drawFunction;h=h||document.createElement("canvas"),c=c||'20px "Dialog"',d=d||"white",f=f===e?"#0F90C4":f,g=g||!1;var j,k=b.textAlign||"center";j=sc.isArray(a)?a:a.split("\n");var l=mono.Utils.getMaxTextSize(j,c),m=b.ratio||l.width/l.height,n=h.realSize={width:l.width,height:l.height};g&&(l.width=mono.Utils.nextPowerOfTwo(l.width),l.height=mono.Utils.nextPowerOfTwo(l.height));var o=h.drawRect={width:n.width/n.height>m?n.width:n.height*m,height:n.width/n.height>m?n.width/m:n.height};Number.isNaN(o.width)&&console.log("debug -- b",n.width,n.height,m),o.width=Math.min(o.width,l.width),o.height=Math.min(o.height,l.height),h.width=l.width,h.height=l.height,Number.isNaN(o.width)&&console.log("debug -- a");var p=h.getContext("2d");if(f&&(p.fillStyle=f),i)i(p,h.width,h.height);else{f&&p.fillRect(0,0,h.width,h.height),p.font=c,p.fillStyle=d,p.strokeStyle="gray",p.textBaseline="middle",p.textAlign=k;for(var q,r=j.length,s=n.height/r,t=0;r>t;t++){sc.isArray(d)&&(q=d[t],q&&(p.fillStyle=q));var u=mono.Utils.getTextSize(c,j[t]),v=(u.width,u.height,h.height,(o.width-n.width)/2);"center"===k?v=o.width/2:"right"===k&&(v=o.width);var w=(o.height-n.height)/2+s/2+t*s+(h.height-o.height);p.strokeText(j[t],v,w),p.fillText(j[t],v,w)}}return h},sc.createTextImage2=function(a,b){a=a||"",a=String(a);var c=b.font,d=b.color,g=b.background,h=b.powerOfTwo,i=b.canvas,j=b.drawFunction;i=i||document.createElement("canvas"),c=c||'20px "Dialog"',d=d||"white",g=g===e?"#0F90C4":g,h=h||!1;var k=(b.align||"center",b.sizeScale||1),l=sc.getMaxTextSize(a.split("\n"),c);i.realSize={width:l.width,height:l.height},l.width*=k,l.height*=k,h&&(l.width=sc.nextPowerOfTwo(l.width),l.height=sc.nextPowerOfTwo(l.height)),i.width=l.width,i.height=l.height;var m=i.getContext("2d");return g&&(m.fillStyle=g),j?j(m,i.width,i.height):(g&&m.fillRect(0,0,i.width,i.height),f(m,a,c,d,i,"center")),i},sc.getMaxTextSize=function(a,b){if(a&&a.length>0){for(var c=a.length,d=fc.getTextSize(b,a[0]),e=d.width,f=d.height*c,g=0;c>g;g++){var h=fc.getTextSize(b,a[g]).width;h>e&&(e=h)}return{width:e,height:f}}return null},sc.getTextSize=function(a,b){return fc.getTextSize(a,b)},sc.playCameraAnimation=function(a,b,c,d,e){b=b||a.p(),c=c||a.getTarget(),d=d||2e3;var f=mono.Utils.getVectorAngles(a.getTarget(),a.p()),g=mono.Utils.getVectorAngles(c,b),h=a.getTarget(),i=c,j=a.getDistance(),k=(new mono.Vec3).subVectors(b,c).length();new mono.Animate({from:0,to:1,repeat:1,dur:d,onPlay:function(){},onUpdate:function(b){var c=f[0]+(g[0]-f[0])*b,d=f[1]+(g[1]-f[1])*b,e=(new mono.Vec3).lerpVectors(h,i,b),l=j+(k-j)*b,m=new mono.Vec3;m.x=e.x+l*Math.sin(c*uc)*Math.cos(d*uc),m.z=e.z+l*Math.cos(c*uc)*Math.cos(d*uc),m.y=e.y+l*Math.sin(d*uc),a.lookAt(e),a.p(m)},onDone:function(){e&&e()}}).play()},sc.stopAnimate=function(a,b){Tb(a,b)},sc.stopAllAnimates=function(a){Ub(a)},Yb.Utils=sc,Yb.GLParameters=function(a,b,c){this.material=a,this.network=b,this.precision=b._precision,this.map=!!a.map,this.mapLoaded=!0,this.envMap=!!a.envMap,this.lightMap=!!a.lightMap,this.bumpMap=!!a.bumpMap&&"phong"===a._type,this.normalMap=!!a.normalMap&&"phong"===a._type,this.specularMap=!!a.specularMap,this.vertexColors=a.vertexColors,this.fog=b._fog,this.useFog=a.fog,this.fogExp=this.fog instanceof Yb.FogExp2,this.sizeAttenuation=a.sizeAttenuation,this.skinning=a.skinning,this.maxBones=b.maxBones,this.useVertexTexture=b._supportsBoneTextures&&c&&c.useVertexTexture,this.boneTextureWidth=c&&c.boneTextureWidth,this.boneTextureHeight=c&&c.boneTextureHeight,this.morphTargets=a.morphTargets,this.morphNormals=a.morphNormals,this.maxMorphTargets=b.maxMorphTargets,this.maxMorphNormals=b.maxMorphNormals,this.maxDirLights=b.maxLightCount.directional,this.maxPointLights=b.maxLightCount.point,this.maxSpotLights=b.maxLightCount.spot,this.maxHemiLights=b.maxLightCount.hemi,this.maxShadows=b.maxShadows,this.maxPointShadows=b.maxPointShadows,this.shadowMapEnable=b._shadowMapEnable&&c.receiveShadow&&this.maxShadows>0,this.pointShadowMapEnable=b._shadowMapEnable&&c.receiveShadow&&this.maxPointShadows>0,this.shadowMapType=b.shadowMapType,this.shadowMapDebug=b.shadowMapDebug,this.shadowMapCascade=b.shadowMapCascade,this.alphaTest=a.alphaTest,this.metal=a.metal,this.perPixel=a.perPixel,this.wrapAround=a.wrapAround,this.doubleSided=a.side===Yb.DoubleSide&&!cc.isIE,this.flipSided=a.side===Yb.BackSide,this.useSSAO=b.isSSAOEnable()&&b.pm.isLightMaterial(a),this.gammaInput=b.gammaInput,this.gammaOutput=b.gammaOutput,this.physicallyBasedShading=b.physicallyBasedShading,this.supportsVertexTextures=!1,this.shadowMapTypeDefine="SHADOWMAP_TYPE_BASIC",this.shadowMapType===Yb.PCFShadowMap?this.shadowMapTypeDefine="SHADOWMAP_TYPE_PCF":this.shadowMapType===Yb.PCFSoftShadowMap&&(this.shadowMapTypeDefine="SHADOWMAP_TYPE_PCF_SOFT"),this.maxGrandient=sc.getObjectCount(a.gradient)},Yb.GLParameters.prototype.getShaders=function(a){a=a===e?"":a;var b=this,c=["precision "+b.precision+" float;",a,this.supportsVertexTextures?"#define VERTEX_TEXTURES":"",b.gammaInput?"#define GAMMA_INPUT":"",b.gammaOutput?"#define GAMMA_OUTPUT":"",b.physicallyBasedShading?"#define PHYSICALLY_BASED_SHADING":"","#define MAX_DIR_LIGHTS "+b.maxDirLights,"#define MAX_POINT_LIGHTS "+b.maxPointLights,"#define MAX_SPOT_LIGHTS "+b.maxSpotLights,"#define MAX_HEMI_LIGHTS "+b.maxHemiLights,"#define MAX_SHADOWS "+b.maxShadows,"#define MAX_POINT_SHADOWS "+b.maxPointShadows,"#define MAX_BONES "+b.maxBones,b.map?"#define USE_MAP":"",b.envMap?"#define USE_ENVMAP":"",b.lightMap?"#define USE_LIGHTMAP":"",b.bumpMap?"#define USE_BUMPMAP":"",b.normalMap?"#define USE_NORMALMAP":"",b.specularMap?"#define USE_SPECULARMAP":"",b.vertexColors?"#define USE_COLOR":"",b.maxGrandient>0?"#define MAX_GRADIENT "+b.maxGrandient:"",b.skinning?"#define USE_SKINNING":"",b.useVertexTexture?"#define BONE_TEXTURE":"",b.boneTextureWidth?"#define N_BONE_PIXEL_X "+b.boneTextureWidth.toFixed(1):"",b.boneTextureHeight?"#define N_BONE_PIXEL_Y "+b.boneTextureHeight.toFixed(1):"",b.morphTargets?"#define USE_MORPHTARGETS":"",b.morphNormals?"#define USE_MORPHNORMALS":"",b.perPixel?"#define PHONG_PER_PIXEL":"",b.wrapAround?"#define WRAP_AROUND":"",b.doubleSided?"#define DOUBLE_SIDED":"",b.flipSided?"#define FLIP_SIDED":"",b.shadowMapEnable?"#define USE_SHADOWMAP":"",b.shadowMapEnable?"#define "+b.shadowMapTypeDefine:"",b.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",b.shadowMapCascade?"#define SHADOWMAP_CASCADE":"",b.pointShadowMapEnable?"#define USE_POINT_SHADOWMAP":"",b.sizeAttenuation?"#define USE_SIZEATTENUATION":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","attribute vec2 uv2;","#ifdef USE_COLOR","attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","attribute vec3 morphTarget0;","attribute vec3 morphTarget1;","attribute vec3 morphTarget2;","attribute vec3 morphTarget3;","#ifdef USE_MORPHNORMALS","attribute vec3 morphNormal0;","attribute vec3 morphNormal1;","attribute vec3 morphNormal2;","attribute vec3 morphNormal3;","#else","attribute vec3 morphTarget4;","attribute vec3 morphTarget5;","attribute vec3 morphTarget6;","attribute vec3 morphTarget7;","#endif","#endif","#ifdef USE_SKINNING","attribute vec4 skinIndex;","attribute vec4 skinWeight;","#endif",""].join("\n"),d=["precision "+this.precision+" float;",b.bumpMap||b.normalMap?"#extension GL_OES_standard_derivatives : enable":"",a,"#define MAX_DIR_LIGHTS "+b.maxDirLights,"#define MAX_POINT_LIGHTS "+b.maxPointLights,"#define MAX_SPOT_LIGHTS "+b.maxSpotLights,"#define MAX_HEMI_LIGHTS "+b.maxHemiLights,"#define MAX_SHADOWS "+b.maxShadows,"#define MAX_POINT_SHADOWS "+b.maxPointShadows,b.useSSAO?"#define USE_SSAO":"",b.alphaTest?"#define ALPHATEST "+b.alphaTest:"",this.gammaInput?"#define GAMMA_INPUT":"",this.gammaOutput?"#define GAMMA_OUTPUT":"",this.physicallyBasedShading?"#define PHYSICALLY_BASED_SHADING":"",b.useFog&&b.fog?"#define USE_FOG":"",b.useFog&&b.fogExp?"#define FOG_EXP2":"",b.map?"#define USE_MAP":"",b.envMap?"#define USE_ENVMAP":"",b.lightMap?"#define USE_LIGHTMAP":"",b.bumpMap?"#define USE_BUMPMAP":"",b.normalMap?"#define USE_NORMALMAP":"",b.specularMap?"#define USE_SPECULARMAP":"",b.maxGrandient>0?"#define MAX_GRADIENT "+b.maxGrandient:"",b.vertexColors?"#define USE_COLOR":"",b.metal?"#define METAL":"",b.perPixel?"#define PHONG_PER_PIXEL":"",b.wrapAround?"#define WRAP_AROUND":"",b.doubleSided?"#define DOUBLE_SIDED":"",b.flipSided?"#define FLIP_SIDED":"",b.shadowMapEnable?"#define USE_SHADOWMAP":"",b.shadowMapEnable?"#define "+b.shadowMapTypeDefine:"",b.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",b.shadowMapCascade?"#define SHADOWMAP_CASCADE":"",b.pointShadowMapEnable?"#define USE_POINT_SHADOWMAP":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",""].join("\n");return[c,d]};var vc={};vc.setDepthTest=function(a,b){var c=b._gl;b._oldDepthTest!==a&&(a?c.enable(c.DEPTH_TEST):c.disable(c.DEPTH_TEST),b._oldDepthTest=a)},vc.setSmapleAlphaToCoverage=function(a,b){var c=b._gl;b._oldSmapleAlphaToCoverage!==a&&(a?c.enable(c.SAMPLE_ALPHA_TO_COVERAGE):c.disable(c.SAMPLE_ALPHA_TO_COVERAGE),b._oldSmapleAlphaToCoverage=a)},vc.setDepthWrite=function(a,b){var c=b._gl;b._oldDepthWrite!==a&&(c.depthMask(a),b._oldDepthWrite=a)},vc.clear=function(a,b,c,d){var f=d._gl,g=0;(a===e||a)&&(g|=f.COLOR_BUFFER_BIT),(b===e||b)&&(g|=f.DEPTH_BUFFER_BIT),(c===e||c)&&(g|=f.STENCIL_BUFFER_BIT),d._gl.clear(g)},vc.setPolygonOffset=function(a,b,c,d){var e=d._gl;d._oldPolygonOffset!==a&&(a?e.enable(e.POLYGON_OFFSET_FILL):e.disable(e.POLYGON_OFFSET_FILL),d._oldPolygonOffset=a),!a||d._oldPolygonOffsetFactor===b&&d._oldPolygonOffsetUnits===c||(e.polygonOffset(b,c),d._oldPolygonOffsetFactor=b,d._oldPolygonOffsetUnits=c)},vc.setBlending=function(a,b,c,d,e){var f=e._gl;a!==e._oldBlending&&(a===Yb.NoBlending?f.disable(f.BLEND):a===Yb.AdditiveBlending?(f.enable(f.BLEND),f.blendEquation(f.FUNC_ADD),f.blendFunc(f.SRC_ALPHA,f.ONE)):a===Yb.SubtractiveBlending?(f.enable(f.BLEND),f.blendEquation(f.FUNC_ADD),f.blendFunc(f.ZERO,f.ONE_MINUS_SRC_COLOR)):a===Yb.MultiplyBlending?(f.enable(f.BLEND),f.blendEquation(f.FUNC_ADD),f.blendFunc(f.ZERO,f.SRC_COLOR)):a===Yb.CustomBlending?f.enable(f.BLEND):(f.enable(f.BLEND),f.blendEquationSeparate(f.FUNC_ADD,f.FUNC_ADD),f.blendFuncSeparate(f.SRC_ALPHA,f.ONE_MINUS_SRC_ALPHA,f.ONE,f.ONE_MINUS_SRC_ALPHA)),e._oldBlending=a),a===Yb.CustomBlending?(b!==this._oldBlendEquation&&(f.blendEquation(sc.paramToGL(b)),e._oldBlendEquation=b),(c!==_oldBlendSrc||d!==_oldBlendDst)&&(f.blendFunc(sc.paramToGL(c),sc.paramToGL(d)),e._oldBlendSrc=c,e._oldBlendDst=d)):(e._oldBlendEquation=null,e._oldBlendSrc=null,e._oldBlendDst=null)},vc.enableStencil=function(a){a.enable(a.STENCIL_TEST),a.stencilFunc(a.ALWAYS,1,1),a.stencilOp(a.KEEP,a.KEEP,a.REPLACE),a.stencilMask(1),a.clearStencil(0),a.clear(a.STENCIL_BUFFER_BIT)},vc.stencilTest=function(a){a.enable(a.STENCIL_TEST),a.stencilFunc(a.EQUAL,0,1),a.stencilOp(a.KEEP,a.KEEP,a.KEEP),a.stencilMask(0)},vc.disableStencil=function(a){a.disable(a.STENCIL_TEST)},vc.r=function(a,b,c,d,e,f,g){a._AK47(b,c,d,e,f,g)},vc.g=function(a,b,c,d,e,f){a.renderGroup(b,c,d,e,f)},Yb.GLUtils=vc,Yb.GPU=function(a){var b=a._gl;this._glExtensionTextureFloat=b.getExtension("OES_texture_float"),this._glExtensionStandardDerivatives=b.getExtension("OES_standard_derivatives"),this._glExtensionTextureFilterAnisotropic=b.getExtension("EXT_texture_filter_anisotropic")||b.getExtension("MOZ_EXT_texture_filter_anisotropic")||b.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this._glExtensionCompressedTextureS3TC=b.getExtension("WEBGL_compressed_texture_s3tc")||b.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||b.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc"),this._glExtensionTextureFloat||console.log("Float textures not supported."),this._glExtensionStandardDerivatives||console.log("Standard derivatives not supported."),this._glExtensionTextureFilterAnisotropic||console.log("Anisotropic texture filtering not supported."),this._glExtensionCompressedTextureS3TC||console.log("S3TC compressed textures not supported."),this._maxTextures=b.getParameter(b.MAX_TEXTURE_IMAGE_UNITS),this._maxVertexTextures=b.getParameter(b.MAX_VERTEX_TEXTURE_IMAGE_UNITS),this._maxTextureSize=b.getParameter(b.MAX_TEXTURE_SIZE),this._maxCubemapSize=b.getParameter(b.MAX_CUBE_MAP_TEXTURE_SIZE),this._maxAnisotropy=this._glExtensionTextureFilterAnisotropic?b.getParameter(this._glExtensionTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,this._supportsVertexTextures=this._maxVertexTextures>0,this._supportsBoneTextures=this._supportsVertexTextures&&this._glExtensionTextureFloat,this._compressedTextureFormats=this._glExtensionCompressedTextureS3TC?b.getParameter(b.COMPRESSED_TEXTURE_FORMATS):[],this._vertexShaderPrecisionHighpFloat=b.getShaderPrecisionFormat(b.VERTEX_SHADER,b.HIGH_FLOAT),this._vertexShaderPrecisionMediumpFloat=b.getShaderPrecisionFormat(b.VERTEX_SHADER,b.MEDIUM_FLOAT),this._vertexShaderPrecisionLowpFloat=b.getShaderPrecisionFormat(b.VERTEX_SHADER,b.LOW_FLOAT),this._fragmentShaderPrecisionHighpFloat=b.getShaderPrecisionFormat(b.FRAGMENT_SHADER,b.HIGH_FLOAT),this._fragmentShaderPrecisionMediumpFloat=b.getShaderPrecisionFormat(b.FRAGMENT_SHADER,b.MEDIUM_FLOAT),this._fragmentShaderPrecisionLowpFloat=b.getShaderPrecisionFormat(b.FRAGMENT_SHADER,b.LOW_FLOAT),this._vertexShaderPrecisionHighpInt=b.getShaderPrecisionFormat(b.VERTEX_SHADER,b.HIGH_INT),this._vertexShaderPrecisionMediumpInt=b.getShaderPrecisionFormat(b.VERTEX_SHADER,b.MEDIUM_INT),this._vertexShaderPrecisionLowpInt=b.getShaderPrecisionFormat(b.VERTEX_SHADER,b.LOW_INT),this._fragmentShaderPrecisionHighpInt=b.getShaderPrecisionFormat(b.FRAGMENT_SHADER,b.HIGH_INT),this._fragmentShaderPrecisionMediumpInt=b.getShaderPrecisionFormat(b.FRAGMENT_SHADER,b.MEDIUM_INT),this._fragmentShaderPrecisionLowpInt=b.getShaderPrecisionFormat(b.FRAGMENT_SHADER,b.LOW_INT);var c=this._vertexShaderPrecisionHighpFloat.precision>0&&this._fragmentShaderPrecisionHighpFloat.precision>0,d=this._vertexShaderPrecisionMediumpFloat.precision>0&&this._fragmentShaderPrecisionMediumpFloat.precision>0,e=a._precision;"highp"!==e||c||(d?(e="mediump",console.log("highp not supported, using mediump")):(e="lowp",console.log("highp and mediump not supported, using lowp"))),"mediump"!==e||d||(e="lowp",console.log("mediump not supported, using lowp")),a._precision=e},Yb.Program=function(a,b,c,d){this.entity=a,this.group=b,this.material=c,this.network=d},Yb.Program.prototype.setEntity=function(){this.entity},Yb.Program.prototype.buildGLProgram=function(){},Yb.Uniform=function(a,b,c){this.id=a,this.type=b,this.value=c,this.location=e},Yb.Uniform.prototype={constructor:Yb.Uniform,setValue:function(a){this.value=a},getUniformLocation:function(a,b){return a.getUniformLocation(this.id)}},Yb.Uniform.loadUniform=function(a,b,c){if(type=b.type,value=b.value,"i"===type)c.uniform1i(a,value);else if("f"===type)c.uniform1f(a,value);else if("v2"===type)c.uniform2f(a,value.x,value.y);else if("v3"===type)c.uniform3f(a,value.x,value.y,value.z);else if("v4"===type)c.uniform4f(a,value.x,value.y,value.z,value.w);else if("c"===type)c.uniform3f(a,value.r,value.g,value.b);else if("iv1"===type)c.uniform1iv(a,value);else if("iv"===type)c.uniform3iv(a,value);else if("fv1"===type)c.uniform1fv(a,value);else if("fv"===type)c.uniform3fv(a,value);else if("v2v"===type){for(b._array===e&&(b._array=new Float32Array(2*value.length)),i=0,il=value.length;i<il;i++)offset=2*i,b._array[offset]=value[i].x,b._array[offset+1]=value[i].y;c.uniform2fv(a,b._array)}else if("v3v"===type){for(b._array===e&&(b._array=new Float32Array(3*value.length)),i=0,il=value.length;i<il;i++)offset=3*i,b._array[offset]=value[i].x,b._array[offset+1]=value[i].y,b._array[offset+2]=value[i].z;c.uniform3fv(a,b._array)}else if("v4v"===type){for(b._array===e&&(b._array=new Float32Array(4*value.length)),i=0,il=value.length;i<il;i++)offset=4*i,b._array[offset]=value[i].x,b._array[offset+1]=value[i].y,b._array[offset+2]=value[i].z,b._array[offset+3]=value[i].w;c.uniform4fv(a,b._array)}else if("m4"===type)b._array===e&&(b._array=new Float32Array(16)),value.flattenToArray(b._array),c.uniformMatrix4fv(a,!1,b._array);else if("m4v"===type){
for(b._array===e&&(b._array=new Float32Array(16*value.length)),i=0,il=value.length;i<il;i++)value[i].flattenToArrayOffset(b._array,16*i);c.uniformMatrix4fv(a,!1,b._array)}else if("t"===type)texture=value,textureUnit=getTextureUnit(),c.uniform1i(a,textureUnit),texture&&(texture.image instanceof Array&&6===texture.image.length?setCubeTexture(texture,textureUnit):texture instanceof $CubeRenderTargetCube?setCubeTextureDynamic(texture,textureUnit):_this.setTexture(texture,textureUnit));else if("tv"===type){for(b._array===e&&(b._array=[]),i=0,il=b.value.length;i<il;i++)b._array[i]=getTextureUnit();for(c.uniform1iv(a,b._array),i=0,il=b.value.length;i<il;i++)texture=b.value[i],textureUnit=b._array[i],texture&&_this.setTexture(texture,textureUnit)}},Yb.Uniform.loadGeneralUniforms=function(a,b,c){var d,e,f,g;for(f=0,g=b.length;g>f;f++)e=a.uniforms[b[f][1]],e&&(d=b[f][0],Yb.Uniform.loadUniform(d,c))},Yb.ProgramManager=function(a){this.id=Yb.ProgramManagerId++,Yb.ProgramManagerCache.count++,this.network=a,this.gl=this.network._gl,this.gpu=this.network.gpu,this.programs=[],this.currentProgram=null,this.currentEntity=null,this.currentGroup=null,this.currentMaterial=null,this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0},currentMaterialId:-1},this.textures=[],this.textureCount=0,this._lightNeedsUpdate=!0,this._lights={ambient:[0,0,0],directional:{length:0,colors:new Array,positions:new Array},point:{length:0,colors:new Array,positions:new Array,distances:new Array},spot:{length:0,colors:new Array,positions:new Array,distances:new Array,directions:new Array,anglesCos:new Array,exponents:new Array},hemi:{length:0,skyColors:new Array,groundColors:new Array,positions:new Array}},this.gammaInput=!1,this.textureCount=0,this.programMap={},this.textureMap={},this.textureUpdateFlags={},this.glTextureMap={},this.textureMaterialMap={},this.unLoadedImage={},this.materialMap={},this.materialUpdateFlags={},this.handleTextureChange=function(a){if("image"===a.property||"loaded"===a.property){var b=a.source;this.changeTextureUpdateFlags(b,!0),delete this.unLoadedImage[b._image]}else if("disposed"===a.property){var b=a.source;this.deallocateTexture(b),b.removePropertyChangeListener(this.handleTextureChange),delete this.textureUpdateFlags[b.id],delete this.textureMap[b.id]}sc.getObjectCount(this.unLoadedImage)<=0&&this.network.dirtyNetwork()},this.handleMaterialChange=function(a){if("map"==a.property||a.property.endsWith("Map")||"needsUpdate"===a.property){var b=a.source;this.materialUpdateFlags[b.id]=!0}else if("disposed"===a.property){var b=a.source;this.deallocateMaterial(b),b.removePropertyChangeListener(this.handleMaterialChange),delete this.materialUpdateFlags[b.id],delete this.materialMap[b.id],delete this.programMap[b.id]}sc.getObjectCount(this.unLoadedImage)<=0&&this.network.dirtyNetwork()}},Yb.ProgramManager.prototype.addMaterial=function(a){null==this.materialMap[a.id]&&(this.materialMap[a.id]=a,a.addPropertyChangeListener(this.handleMaterialChange,this))},Yb.ProgramManager.prototype.needsUpdateMaterial=function(a){return this.materialUpdateFlags[a.id]===e||this.materialUpdateFlags[a.id]===!0?!0:a.map instanceof wc||a.map instanceof xc?!0:!1},Yb.ProgramManager.prototype.changeMaterialUpdateFlags=function(a,b){this.materialUpdateFlags[a.id]=b},Yb.ProgramManager.prototype.isLightMaterial=function(a){return a instanceof Yb.LambertMaterial||a instanceof Yb.PhongMaterial||a.lights||"lambert"===a._type||"phong"===a._type||"terrain"===a._type},Yb.ProgramManager.prototype.changeAllMaterialUpdateFlags=function(a,b,c){for(var d in this.materialMap){var e=this.materialMap[d];(null==b||b.call(c,e))&&(this.materialUpdateFlags[e.id]=a)}},Yb.ProgramManager.prototype.changeAllLightMaterialUpdateFlags=function(a){this.changeAllMaterialUpdateFlags(a,this.isLightMaterial,this)},Yb.ProgramManager.prototype.addTexture=function(a){null!=a.id&&this.textureMap[a.id]===e&&(this.textureMap[a.id]=a,a.addPropertyChangeListener(this.handleTextureChange,this),a._image.loaded||(this.unLoadedImage[a._image]=1))},Yb.ProgramManager.prototype.needsUpdateTexture=function(a){return this.textureUpdateFlags[a.id]===e||this.textureUpdateFlags[a.id]===!0?!0:!1},Yb.ProgramManager.prototype.changeTextureUpdateFlags=function(a,b){this.textureUpdateFlags[a.id]=b;for(var c in this.materialMap){var d=this.materialMap[c];(d.map===a||d.lightMap===a||d.envMap===a||d.normalMap===a||d.specularMap===a)&&this.changeMaterialUpdateFlags(d,!0)}},Yb.ProgramManager.prototype.buildProgram=function(a,b,c){this.currentEntity=a,this.currentGroup=b,this.currentMaterial=c,c.shaderID||c.setupMaterialShader();var d,e,f,g,h=new Yb.GLParameters(this.currentMaterial,this.network,a),i=[];if(c.shaderID?i.push(c.shaderID):(i.push(c.vertexShader),i.push(c.fragmentShader)),c instanceof Yb.ShaderMaterial);else for(Vc in h)"material"!==Vc&&"network"!==Vc&&"node"!==Vc&&(i.push(Vc),i.push(h[Vc]));for(g=i.join(),d=0,e=this.programs.length;e>d;d++)if(this.programs[d].code===g){c.program=this.programs[d].program,c.uniformsList=[];for(o in c.uniforms)c.uniformsList.push([c.uniforms[o],o]);return this.programs[d].usedTimes++,this.programs[d].program}f=this.gl.createProgram();var j=h.getShaders(),k=j[1],m=j[0];this.gl.attachShader(f,l("fragment",k+c.fragmentShader,this.gl)),this.gl.attachShader(f,l("vertex",m+c.vertexShader,this.gl)),this.gl.linkProgram(f),this.gl.getProgramParameter(f,this.gl.LINK_STATUS)||console.log("Could not initialise shader\nVALIDATE_STATUS: "+this.gl.getProgramParameter(f,this.gl.VALIDATE_STATUS)+", gl error ["+this.gl.getError()+"]"),f.uniforms={},f.attributes={};var n,o,p,d;n=["viewMatrix","modelViewMatrix","projectionMatrix","normalMatrix","modelMatrix","cameraPosition","boneGlobalMatrices","morphTargetInfluences"];for(o in c.uniforms)n.push(o);for(this.attachGLLocations(f,n,"uniform"),n=["position","normal","uv","uv2","tangent","color","skinVertexA","skinVertexB","skinIndex","skinWeight"],d=0;d<h.maxMorphTargets;d++)n.push("morphTarget"+d);for(d=0;d<h.maxMorphNormals;d++)n.push("morphNormal"+d);for(p in c.attributes)n.push(p);this.attachGLLocations(f,n,"attribute"),f.id=this.programs.length,this.programs.push({program:f,code:g,usedTimes:1}),this.info.memory.programCount=this.programs.length,c.program=f,c.uniformsList=[];for(o in c.uniforms)c.uniformsList.push([c.uniforms[o],o]);return f},Yb.ProgramManager.prototype.enableAttribute=function(b,c){var d=c.program.attributes;if(d.position>=0&&_gl.enableVertexAttribArray(d.position),d.color>=0&&_gl.enableVertexAttribArray(d.color),d.normal>=0&&_gl.enableVertexAttribArray(d.normal),c.attributes)for(a in c.attributes)d[a]!==e&&d[a]>=0&&_gl.enableVertexAttribArray(d[a])},Yb.ProgramManager.prototype.attachGLLocations=function(a,b,c){var d,e,f,g=this.gl;if("uniform"===c)for(d=0,e=b.length;e>d;d++)f=b[d],a.uniforms[f]=g.getUniformLocation(a,f);else if("attribute"===c)for(d=0,e=b.length;e>d;d++)f=b[d],a.attributes[f]=g.getAttribLocation(a,f)},Yb.ProgramManager.prototype.getGLShaders=function(a,b){var c;return"fragment"===a?c=this.gl.createShader(this.gl.FRAGMENT_SHADER):"vertex"===tpye&&(c=this.gl.createShader(this.gl.VERTEX_SHADER)),this.gl.shaderSource(c,string),this.gl.compileShader(c),gl.getShaderParameter(c,gl.COMPILE_STATUS)?c:(console.log(gl.getShaderInfoLog(c)),console.log(string),null)},Yb.ProgramManager.prototype.setProgram=function(a,b,c,d,e,f){if(this.textureCount=0,this.addMaterial(d),this.needsUpdateMaterial(d)){d.setupMaterialShader(),this.programMap[d.id]&&this.deallocateMaterial(d);var i=this.buildProgram(f,e,d);this.programMap[d.id]=i,this.changeMaterialUpdateFlags(d,!1)}var j=!1,l=this.programMap[d.id],n=l.uniforms,o=d.uniforms;return l!=this.currentProgram&&(this.gl.useProgram(l),this.currentProgram=l,j=!0),d.id!==this.currentMaterialId&&(this.currentMaterialId=d.id,j=!0),(j||a!==this.network._currentCamera)&&(this.gl.uniformMatrix4fv(n.projectionMatrix,!1,a.projectionMatrix.elements),a!==this.network._currentCamera&&(this.network._currentCamera=a)),c&&d.fog&&c.refreshUniforms(o),(d.lights||"phong"===d._type||"lambert"===d._type||"terrain"===d._type)&&(this._lightNeedsUpdate&&(this.setupLights(l,b),this._lightNeedsUpdate=!1),m(o,this._lights)),j&&d.refreshUniforms(!1,{camera:this.network._camera}),f.receiveShadow&&!d._shadowPass&&this.network.isShadowable()&&(g(o,b),h(o,b)),j&&this.loadUniformsGeneric(l,d.uniformsList,d),d.loadCameraPosition(n,a,this.gl),(d.skinning||"phong"===d._type||"lambert"===d._type||"terrain"===d._type||d instanceof Yb.ShaderMaterial)&&null!==n.viewMatrix&&this.gl.uniformMatrix4fv(n.viewMatrix,!1,a.worldMatrixInverse.elements),k(n,f,this.gl),null!=n.modelMatrix&&this.gl.uniformMatrix4fv(n.modelMatrix,!1,f.worldMatrix.elements),this.network._baseRender&&this.loadSSAOUniforms(n,d,j),l},Yb.ProgramManager.prototype.loadSSAOUniforms=function(a,b,c){if(null!=a.mapSSAO&&this.network._sSAOEnable){var d=a.mapSSAO,e=c?this.getTextureUnit():b._ssaoSlot;this.gl.uniform1i(d,e),this.setTexture(this.network.finalSSAOTarget,e),b._ssaoSlot=e}},Yb.ProgramManager.prototype.onTextureDispose=function(a){var b=a.target;b.removeEventListener("dispose",onTextureDispose),deallocateTexture(b),this.info.memory.textures--},Yb.ProgramManager.prototype.deallocateTexture=function(a){var b=this.gl;if(a._image&&a._image.__webglTextureCube)b.deleteTexture(a._image.__webglTextureCube);else{if(!a.__webglInit)return;a.__webglInit=!1,b.deleteTexture(a.__webglTexture)}},Yb.ProgramManager.prototype.setTextureParameters=function(a,b,c,d){var e=this.gl,f=this.gpu,g=Yb.Utils.paramToGL;c&&!d?(e.texParameteri(a,e.TEXTURE_WRAP_S,g(b.wrapS,e)),e.texParameteri(a,e.TEXTURE_WRAP_T,g(b.wrapT,e)),e.texParameteri(a,e.TEXTURE_MAG_FILTER,g(b.magFilter,e)),e.texParameteri(a,e.TEXTURE_MIN_FILTER,g(b.minFilter,e))):(e.texParameteri(a,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(a,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(a,e.TEXTURE_MAG_FILTER,this.filterFallback(b.magFilter)),e.texParameteri(a,e.TEXTURE_MIN_FILTER,this.filterFallback(b.minFilter))),f._glExtensionTextureFilterAnisotropic&&b.type!==Yb.FloatType&&(b.anisotropy>1||b.__oldAnisotropy)&&(e.texParameterf(a,f._glExtensionTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(b.anisotropy,f._maxAnisotropy)),b.__oldAnisotropy=b.anisotropy)},Yb.ProgramManager.prototype.setCubeTexture=function(a,b){var c=this.gl;this.addTexture(a);var d=a.id;if(6===a._image.length){if(!a._image.loaded)return;var f=Yb.Utils.isPowerOfTwo,g=Yb.Utils.paramToGL;if(this.needsUpdateTexture(a)){this.glTextureMap[d]===e&&(this.glTextureMap[d]=c.createTexture(),this.info.memory.texture++),this.changeTextureUpdateFlags(a,!1),c.activeTexture(c.TEXTURE0+b),c.bindTexture(c.TEXTURE_CUBE_MAP,this.glTextureMap[d]),c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,a.flipY);for(var h=a instanceof Yb.CompressedTexture,i=[],j=0;6>j;j++)this.autoScaleCubemaps&&!h?i[j]=clampToMaxSize(a._image[j],_maxCubemapSize):i[j]=a._image[j];var k=i[0],l=f(k.width)&&f(k.height),m=g(a.format,c),n=g(a.type,c);this.setTextureParameters(c.TEXTURE_CUBE_MAP,a,l);for(var j=0;6>j;j++)if(h)for(var o,p=i[j].mipmaps,q=0,r=p.length;r>q;q++)o=p[q],c.compressedTexImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+j,q,m,o.width,o.height,0,o.data);else c.texImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+j,0,m,m,n,i[j]);a.generateMipmaps&&l&&c.generateMipmap(c.TEXTURE_CUBE_MAP),a.needsUpdate=!1,a.onUpdate&&a.onUpdate()}else c.activeTexture(c.TEXTURE0+b),c.bindTexture(c.TEXTURE_CUBE_MAP,this.glTextureMap[d])}},Yb.ProgramManager.prototype.setCubeTextureDynamic=function(a,b){var c=this.gl;c.activeTexture(c.TEXTURE0+b),c.bindTexture(c.TEXTURE_CUBE_MAP,a.__webglTexture)},Yb.ProgramManager.prototype.loadUniformsGeneric=function(a,b,c){var d,f,g,h,i,j,k,l,m,n,o,p=this.gl;for(m=0,n=b.length;n>m;m++)if(h=a.uniforms[b[m][1]])if(d=b[m][0],g=d.type,f=d.value,"i"===g)p.uniform1i(h,f);else if("f"===g)p.uniform1f(h,f);else if("v2"===g)p.uniform2f(h,f.x,f.y);else if("v3"===g)p.uniform3f(h,f.x,f.y,f.z);else if("v4"===g)p.uniform4f(h,f.x,f.y,f.z,f.w);else if("c"===g)p.uniform3f(h,f.r,f.g,f.b);else if("iv1"===g)p.uniform1iv(h,f);else if("iv"===g)p.uniform3iv(h,f);else if("fv1"===g)p.uniform1fv(h,f);else if("fv"===g)p.uniform3fv(h,f);else if("v2v"===g){for(d._array===e&&(d._array=new Float32Array(2*f.length)),k=0,l=f.length;l>k;k++)o=2*k,d._array[o]=f[k].x,d._array[o+1]=f[k].y;p.uniform2fv(h,d._array)}else if("v3v"===g){for(d._array===e&&(d._array=new Float32Array(3*f.length)),k=0,l=f.length;l>k;k++)o=3*k,f[k]instanceof Yb.Color?(d._array[o]=f[k].r,d._array[o+1]=f[k].g,d._array[o+2]=f[k].b):(d._array[o]=f[k].x,d._array[o+1]=f[k].y,d._array[o+2]=f[k].z);p.uniform3fv(h,d._array)}else if("v4v"===g){for(d._array===e&&(d._array=new Float32Array(4*f.length)),k=0,l=f.length;l>k;k++)o=4*k,d._array[o]=f[k].x,d._array[o+1]=f[k].y,d._array[o+2]=f[k].z,d._array[o+3]=f[k].w;p.uniform4fv(h,d._array)}else if("m4"===g)d._array===e&&(d._array=new Float32Array(16)),f.flattenToArray(d._array),p.uniformMatrix4fv(h,!1,d._array);else if("m4v"===g){for(d._array===e&&(d._array=new Float32Array(16*f.length)),k=0,l=f.length;l>k;k++)f[k].flattenToArrayOffset(d._array,16*k);p.uniformMatrix4fv(h,!1,d._array)}else if("t"===g){if(i=f,j=this.getTextureUnit(),p.uniform1i(h,j),!i)continue;if(i._image instanceof Array&&6===i._image.length)this.setCubeTexture(i,j);else{var q=i._image;this.setTexture(i,j,q?!q.loaded:!0)}}else if("tv"===g){for(d._array===e&&(d._array=[]),k=0,l=d.value.length;l>k;k++)d._array[k]=this.getTextureUnit();for(p.uniform1iv(h,d._array),k=0,l=d.value.length;l>k;k++)if(i=d.value[k],j=d._array[k],i){var q=i._image;i instanceof xc?this.setCubeTextureDynamic(i,j):this.setTexture(i,j,q?!q.loaded:!0)}}},Yb.ProgramManager.prototype.setTexture=function(a,b,c){var d=this.gl,f=Yb.Utils.isPowerOfTwo,g=a.id;if(this.addTexture(a),!this.needsUpdateTexture(a)||a instanceof wc)d.activeTexture(d.TEXTURE0+b),a instanceof wc?d.bindTexture(d.TEXTURE_2D,a.__webglTexture):d.bindTexture(d.TEXTURE_2D,this.glTextureMap[g]);else{if(!a._image)return;this.glTextureMap[g]===e&&(this.glTextureMap[g]=d.createTexture(),this.info.memory.textures++),this.changeTextureUpdateFlags(a,!1),d.activeTexture(d.TEXTURE0+b),d.bindTexture(d.TEXTURE_2D,this.glTextureMap[g]),d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,!a.flipY),d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultiplyAlpha),d.pixelStorei(d.UNPACK_ALIGNMENT,a.unpackAlignment);var h=Yb.Utils.paramToGL,i=c?Yb.ImageCache.Logo:a._image,j=f(i.width)&&f(i.height),k=h(a.format,d),l=h(a.type,d);this.setTextureParameters(d.TEXTURE_2D,a,j,c);var m,n=a.mipmaps;if(a instanceof Yb.PixelsTexture)if(n.length>0&&j){for(var o=0,p=n.length;p>o;o++)m=n[o],d.texImage2D(d.TEXTURE_2D,o,k,m.width,m.height,0,k,l,m.data);a.generateMipmaps=!1}else d.texImage2D(d.TEXTURE_2D,0,k,i.width,i.height,0,k,l,i.data);else if(a instanceof Yb.CompressedTexture)for(var o=0,p=n.length;p>o;o++)m=n[o],d.compressedTexImage2D(d.TEXTURE_2D,o,k,m.width,m.height,0,m.data);else if(n.length>0&&j){for(var o=0,p=n.length;p>o;o++)m=n[o],d.texImage2D(d.TEXTURE_2D,o,k,k,l,m);a.generateMipmaps=!1}else try{d.texImage2D(d.TEXTURE_2D,0,k,k,l,i)}catch(q){console.log(q)}a.generateMipmaps&&j&&d.generateMipmap(d.TEXTURE_2D),a.onUpdate&&a.onUpdate()}},Yb.ProgramManager.prototype.getTextureUnit=function(){var a=this.textureCount;return a>=this.gpu._maxTextures&&console.warn("Network3D: trying to use "+a+" texture units while this GPU supports only "+this.gpu._maxTextures),this.textureCount++,a},Yb.ProgramManager.prototype.deallocateMaterial=function(a){var b=a.program;if(b!==e){a.program=e;var c,d,f,g=!1;for(c=0,d=this.programs.length;d>c;c++)if(f=this.programs[c],f.program===b){f.usedTimes--,0===f.usedTimes&&(g=!0);break}if(g===!0){var h=[];for(c=0,d=this.programs.length;d>c;c++)f=this.programs[c],f.program!==b&&h.push(f);this.programs=h,this.gl.deleteProgram(b),this.info.memory.programs--}}},Yb.ProgramManager.prototype.filterFallback=function(a){return a===Yb.NearestFilter||a===Yb.NearestMipMapNearestFilter||a===Yb.NearestMipMapLinearFilter?this.gl.NEAREST:this.gl.LINEAR},Yb.ProgramManager.prototype.setupLights=function(a,b){var c,d,e,f,g,h,i,j,k,l,m=0,p=0,q=0,r=this._lights,s=r.directional.colors,t=r.directional.positions,u=r.point.colors,v=r.point.positions,w=r.point.distances,x=r.spot.colors,y=r.spot.positions,z=r.spot.distances,A=r.spot.directions,B=r.spot.anglesCos,C=r.spot.exponents,D=r.hemi.skyColors,E=r.hemi.groundColors,F=r.hemi.positions,G=0,H=0,I=0,J=0,K=0,L=0,M=0,N=0,O=0,P=0,Q=0,R=0,S=new Yb.Vec3;for(c=0,d=b.size();d>c;c++)if(e=b.get(c),!e.onlyShadow)if(f=e.color,i=e.intensity*this.network.lightIntensityRatio,l=e.distance,e.updateWorldMatrix(!0),e instanceof Yb.AmbientLight){if(!e._visible)continue;this.gammaInput?(m+=f.r*f.r,p+=f.g*f.g,q+=f.b*f.b):(m+=f.r,p+=f.g,q+=f.b)}else if(e instanceof Yb.DirectionalLight){if(K+=1,!e._visible)continue;if(e.direction?S.copy(e.direction):(S.copy(e.worldMatrix.getPosition()),S.sub(e.target.worldMatrix.getPosition())),S.normalize(),0===S.x&&0===S.y&&0===S.z)continue;O=3*G,t[O]=S.x,t[O+1]=S.y,t[O+2]=S.z,this.gammaInput?o(s,O,f,i*i):n(s,O,f,i),G+=1}else if(e instanceof Yb.PointLight){if(L+=1,!e._visible)continue;P=3*H,this.gammaInput?o(u,P,f,i*i):n(u,P,f,i),k=e.worldMatrix.getPosition(),v[P]=k.x,v[P+1]=k.y,v[P+2]=k.z,w[H]=l,H+=1}else if(e instanceof Yb.SpotLight){if(M+=1,!e._visible)continue;Q=3*I,this.gammaInput?o(x,Q,f,i*i):n(x,Q,f,i),k=e.worldMatrix.getPosition(),y[Q]=k.x,y[Q+1]=k.y,y[Q+2]=k.z,z[I]=l,S.copy(k),S.sub(e.target.worldMatrix.getPosition()),S.normalize(),A[Q]=S.x,A[Q+1]=S.y,A[Q+2]=S.z,B[I]=Math.cos(e.angle),C[I]=e.exponent,I+=1}else if(e instanceof Yb.HemisphereLight){if(N+=1,!e._visible)continue;if(S.copy(e.worldMatrix.getPosition()),S.normalize(),0===S.x&&0===S.y&&0===S.z)continue;R=3*J,F[R]=S.x,F[R+1]=S.y,F[R+2]=S.z,g=e.color,h=e.groundColor,this.gammaInput?(j=i*i,o(D,R,g,j),o(E,R,h,j)):(n(D,R,g,i),n(E,R,h,i)),J+=1}for(c=3*G,d=Math.max(s.length,3*K);d>c;c++)s[c]=0;for(c=3*H,d=Math.max(u.length,3*L);d>c;c++)u[c]=0;for(c=3*I,d=Math.max(x.length,3*M);d>c;c++)x[c]=0;for(c=3*J,d=Math.max(D.length,3*N);d>c;c++)D[c]=0;for(c=3*J,d=Math.max(E.length,3*N);d>c;c++)E[c]=0;r.directional.length=G,r.point.length=H,r.spot.length=I,r.hemi.length=J,r.ambient[0]=m,r.ambient[1]=p,r.ambient[2]=q},Yb.ProgramManagerId=0,Yb.ProgramManagerCache={count:0};var wc=function(a,b,c){this.width=a,this.height=b,c=c||{},this.wrapS=c.wrapS!==e?c.wrapS:Yb.ClampToEdgeWrapping,this.wrapT=c.wrapT!==e?c.wrapT:Yb.ClampToEdgeWrapping,this.magFilter=c.magFilter!==e?c.magFilter:Yb.LinearFilter,this.minFilter=c.minFilter!==e?c.minFilter:Yb.LinearMipMapLinearFilter,this.anisotropy=c.anisotropy!==e?c.anisotropy:1,this.offset=new Yb.Vec2(0,0),this.repeat=new Yb.Vec2(1,1),this.format=c.format!==e?c.format:Yb.RGBAFormat,this.type=c.type!==e?c.type:Yb.UnsignedByteType,this.depthBuffer=c.depthBuffer!==e?c.depthBuffer:!0,this.stencilBuffer=c.stencilBuffer!==e?c.stencilBuffer:!0,this.generateMipmaps=!0,this.shareDepthFrom=null};wc.prototype={constructor:wc,clone:function(){var a=new wc(this.width,this.height);return a.wrapS=this.wrapS,a.wrapT=this.wrapT,a.magFilter=this.magFilter,a.minFilter=this.minFilter,a.anisotropy=this.anisotropy,a.offset.copy(this.offset),a.repeat.copy(this.repeat),a.format=this.format,a.type=this.type,a.depthBuffer=this.depthBuffer,a.stencilBuffer=this.stencilBuffer,a.generateMipmaps=this.generateMipmaps,a.shareDepthFrom=this.shareDepthFrom,a},getUniqueCode:function(){return this._id},dispose:function(){this.dispatchEvent({type:"dispose"})}};var xc=function(a,b,c){wc.call(this,a,b,c),this.activeCubeFace=0};Yb.extend(xc,wc,{}),Yb.Network3D=function(a,b,c,f){Yb.Element.call(this),this.id=Yb.Network3DId++,this._interactionDispatcher=new Yb.EventDispatcher,f=f||{},this.helperBox=new Yb.DataBox,this.helperBox.addDataBoxChangeListener(this.handleDataBoxChange,this),this._rootView=bc.createView("hidden"),this._canvas=this.initCanvas(c),this._topCanvas=bc.createCanvas(this),this._bottomCanvas=bc.createCanvas(this);var g=this._canvas.parentNode;g&&(g.removeChild(this._canvas),g.appendChild(this._rootView),this.adjustRootViewBounds(0,0,this._canvas.width,this._canvas.height)),this._rootView.appendChild(this._bottomCanvas),this._rootView.appendChild(this._canvas),this._rootView.appendChild(this._topCanvas),this.setCanvasPropety(),this._camera=b||new Yb.PerspectiveCamera,this._camera.addPropertyChangeListener(this.dirtyNetwork,this),this._clearColor=f.clearColor!==e?f.clearColor:new Yb.Color(16777215),this._clearAlpha=f.clearAlpha!=e?f.clearAlpha:1,this._precision=f.precision!==e?f.precision:"mediump",this.__fog=new Yb.FogExp2,this.devicePixelRatio=f.devicePixelRatio!==e?f.devicePixelRatio:d.devicePixelRatio!==e?d.devicePixelRatio:1,this._premultipliedAlpha=null==f.premultipliedAlpha?!0:f.premultipliedAlpha,this.lightIntensityRatio=1,cc.isIOS||cc.isAndroid?(this._antialias=!1,this._preserveDrawingBuffer=!1,this.lightIntensityRatio=.1):(this._preserveDrawingBuffer=null==f.preserveDrawingBuffer?!0:f.preserveDrawingBuffer,this._antialias=f.antialias==e?!0:f.antialias),this._gl=this.initGL(),this._programs=[],this._currentProgram=null,this.overrideMaterial=null,this._maxLights=f.maxLights!==e?f.maxLights:4,this._projScreenMatrix=new ac,this._projScreenMatrixPS=new ac,this._frustum=new Yb.Frustum,this._vector3=new $b,this._oldDoubleSided=-1,this._oldFlipSided=-1,this._oldBlending=null,this._oldBlendEquation=null,this._oldBlendSrc=null,this._oldBlendDst=null,this._currentCamera=null,this._enabledAttributes={},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.gpu=new Yb.GPU(this),this.pm=new Yb.ProgramManager(this),this.setDefaultGLState(),this.paintSortFunction=Yb.Defaults.paintSortFunction,this.sortNodes=!0,this.sortOpaqueOrderByMaterial=!0,this.glNodeList=[],this.helperGLNodeList=[],this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0},currentMaterialId:-1},this.projector=new Yb.Projector,this.up=new Yb.Vec3(0,1,0),this.position=new Yb.Vec3(0,0,0),this.seletionMaterial=new Yb.BasicMaterial,this.seletionMaterial.wireframe=!0,this.seletionMaterial.wireframeLinewidth=1,this.seletionMaterial.color=new Yb.Color(65280),this.selectionCube=new qc,this.selectionCube.material=this.seletionMaterial,this.outlineMaterialMap={},this.selectionCube._modelViewMatrix=new ac,this.selectionCube._normalMatrix=new _b,this.selectionCube.name="select",this.alarmMaterial=new Yb.BasicMaterial,this.alarmMaterial.wireframe=!0,this.alarmMaterial.wireframeLinewidth=1,this.alarmMaterial.color=new Yb.Color(16711680),this.alarmCube=new qc,this.alarmCube.material=this.alarmMaterial,this.alarmCube._modelViewMatrix=new ac,this.alarmCube._normalMatrix=new _b,this.alarmCube.name="alarm";var h=512;this._glowSurface=new Yb.Plane(2,2),this._glowSurface2=new Yb.Plane(h,h),this._glowSurface.target=new wc(h,h,{type:Yb.UnsignedByteType}),this._glowSurface.target1=new wc(h,h,{type:Yb.UnsignedByteType}),this._glowSurface.target2=new wc(h,h,{type:Yb.UnsignedByteType}),this._glowSurfaceMaterial=new Yb.BlurMaterial,this._blurMaterialH=new Yb.BlurMaterial,this._blurMaterialH.orientation=1,this._blurMaterialV=new Yb.BlurMaterial,this.deferredPostionMaterial=new Yb.DeferredMaterial,this.deferredNormalMaterial=new Yb.DeferredMaterial({isNormal:1}),this.ssaoMaterial=new Yb.SSAOMaterial,this.ssaoMaterial.map2=new Yb.Texture(lc.ssaoNormalImage);var i=1024;this.deferredPostionTarget=new wc(i,i,{type:Yb.FloatType,magFilter:Yb.NearestFilter,minFilter:Yb.NearestFilter}),this.deferredNormalTarget=new wc(i,i,{type:Yb.FloatType,magFilter:Yb.NearestFilter,minFilter:Yb.NearestFilter,format:Yb.RGBFormat}),this.ssaoTarget=new wc(i,i,{type:Yb.FloatType,magFilter:Yb.NearestFilter,minFilter:Yb.NearestFilter}),this.ssaoTarget1=new wc(h,h,{type:Yb.UnsignedByteType}),this.ssaoTarget2=new wc(h,h,{type:Yb.UnsignedByteType}),this.finalSSAOTarget=null,this._interactions=null,this.billboardRenderer=null,this._groupCounter=0,this.groupMap={},this.groupCountMap={},this.bufferNodeMap={},this.lineMap={},this.particleMap={},this.normalNodeMap={},this.showAxis=!1,this.axisSize=20,this.axisPosition=new Yb.Vec3(0,0,0),this.axis=new Yb.Axis(this.axisSize),this.alarmBillboards=[],this.areaPickingRect={},this.setDataBox(a===e?new Yb.DataBox:a),this.renderCallback=null,this.beforeRenderFunction=null,this.dirtyNetwork(),this.prepareData(),this.autoUpdateCameraAspect=!0,this.shadowMapRenderer=null,this.shadowMapType=Yb.PCFSoftShadowMap,this.shadowMapCullFace=Yb.CullFaceFront,this.adjustBounds(this._canvas.width,this._canvas.height,0,0);var j=this;this.getRootView().addEventListener("mousedown",function(a){j.handleMouseDown(a)}),this.getRootView().addEventListener("mouseup",function(a){j.handleClick(a)}),this.setInteractions([new Yb.DefaultInteraction(this),new Yb.SelectionInteraction(this)]),this.doubleClickToLookAtFunction=rc.doubleClickToLookAtFunction,p(this),this.initSurfaceGroup(),this.materialRenderListMap={},this._selectTransparencyThreshold=0,this._dynamicBatchDraw=!1,this._dynamicBatchDrawCountLimit=1024,this.needSmoothNormalFunction=rc.needSmoothNormalFunction,this._annotationMap={},this._activeAnnotation=null},Yb.extend(Yb.Network3D,Yb.Data,{___accessor:["shadowMapEnable","editableFunction","keyboardRemoveEnabled","selectTransparencyThreshold","dynamicBatchDraw","showFps"],setUseFog:function(a){this._useFog=a,this._useFog?this._fog=this.__fog:this._fog=null},setOverloadMaterial:function(a){this._overloadMaterial=a},setFogColor:function(a){this.__fog.color=a},setFogDensity:function(a){this.__fog.density=a},setDataBox:function(a){if(!a)throw"DataBox can not be null";if(this.dataBox!==a){var b=this.dataBox;b&&(this._clearDataBox(b),b.removeDataBoxChangeListener(this.handleDataBoxChange,this),b.removeDataPropertyChangeListener(this.handleDataPropertyChange,this),b.getAlarmBox().removeDataBoxChangeListener(this.dirtyNetwork,this),b.getSelectionModel().removeSelectionChangeListener(this.dirtyNetwork,this)),this.dataBox=a,this.dataBox.addDataBoxChangeListener(this.handleDataBoxChange,this),this.dataBox.addDataPropertyChangeListener(this.handleDataPropertyChange,this),this.dataBox.getAlarmBox().addDataBoxChangeListener(this.dirtyNetwork,this),this.dataBox.getSelectionModel().addSelectionChangeListener(this.dirtyNetwork,this),this.firePropertyChange("dataBox",b,this._box),this.glNodeList=[],this.dirtyNetwork(),this._clearNodeCache()}},setRenderCallback:function(a){this.renderCallback=a},setBeforeRenderFunction:function(a){this.beforeRenderFunction=a},getDataBox:function(){return this.dataBox},getClearColor:function(){return this._clearColor},setClearColor:function(a){3==arguments.length?(this._clearColor=new Yb.Color,this._clearColor.setRGB(arguments[0],arguments[1],arguments[2])):(this._clearColor=a,this._clearColor instanceof Yb.Color||(this._clearColor=new Yb.Color(a))),this._gl.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearAlpha),this.dirtyNetwork()},setClearAlpha:function(a){this._clearAlpha=a,this._gl.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearAlpha),this.dirtyNetwork()},getClearAlpha:function(){return this._clearAlpha},getPrecision:function(){return this._precision},setPrecision:function(a){this._precesion=a},setSSAOBlur:function(a){this._ssaoBlur=a},setSSAOEnable:function(a){return a&&!this.isFloatTextureSupport()?!1:(this._sSAOEnable=a,this._dirty=!0,!0)},isSSAOEnable:function(){return this._sSAOEnable&&this._baseRender},setSSAOOccluderBias:function(a){this._occluderBias=a,this._dirty=!0},setSSAOSamplingRadius:function(a){this._samplingRadius=a,this._dirty=!0},setSSAOAttenuation:function(a){this._attenuation=a,this._dirty=!0},isFloatTextureSupport:function(){return null!=this._glExtensionTextureFloat},getCamera:function(){return this._camera},setCamera:function(a,b){if(this._camera!=a){var c=this._camera;if(c.removePropertyChangeListener(this.dirtyNetwork),this._camera=a,this._camera.addPropertyChangeListener(this.dirtyNetwork,this),this.autoUpdateCameraAspect){this._camera.setAspect(c.aspect);var d=this.getDefaultInteraction();d&&(d.object=this._camera)}b&&(this._camera.p(c.p()),this._camera.lookAt(c.getTarget())),this.dirtyNetwork()}},isVisible:function(a){if(a){if(a instanceof Yb.Link||a instanceof Yb.PathLink){if(!a.isVisible())return!1;if(!this.isVisible(a._fromNode))return!1;if(!this.isVisible(a._toNode))return!1}if(!a.isVisible())return!1;if(a._parent)return this.isVisible(a._parent);if(this.visibleFunction)return this.visibleFunction(a)}return!0},setCanvasPropety:function(){this._canvas&&(this._canvas.setAttribute("tabindex",this.id),this._canvas.style.outline="none",this._canvas.style.position="absolute")},initCanvas:function(a){return a===e?document.createElement("canvas"):("string"==typeof a&&(a=document.getElementById(a)),a)},initGL:function(){var a;try{a=this._canvas.getContext("webgl",{preserveDrawingBuffer:this._preserveDrawingBuffer,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,stencil:!0})||this._canvas.getContext("experimental-webgl",{preserveDrawingBuffer:this._preserveDrawingBuffer,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,stencil:!0})}catch(b){console.log(b)}return a||console.error("Can not init webgl context"),this._glExtensionTextureFloat=a.getExtension("OES_texture_float"),this._glExtensionStandardDerivatives=a.getExtension("OES_standard_derivatives"),this._glExtensionTextureFilterAnisotropic=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this._glExtensionCompressedTextureS3TC=a.getExtension("WEBGL_compressed_texture_s3tc")||a.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc"),this._glExtensionTextureFloat||console.log("TGL.Network3D: Float textures not supported."),this._glExtensionStandardDerivatives||console.log("TGL.Network3D: Standard derivatives not supported."),this._glExtensionTextureFilterAnisotropic||console.log("TGL.Network3D: Anisotropic texture filtering not supported."),this._glExtensionCompressedTextureS3TC||console.log("TGL.Network3D: S3TC compressed textures not supported."),a?a:void console.log("Error: Your browser does not support WebGL.")},resetRenderInfo:function(){this.info.render.calls=0,this.info.render.vertices=0,this.info.render.faces=0,this.info.render.points=0,this.info.currentMaterialId=-1},_clearDataBox:function(a){var b=null;b=a===this.helperBox?this.helperGLNodeList:this.glNodeList;for(var c=b.length-1;c>=0;c--){b[c];b.splice(c,1)}b=[],this.prepareData(),this.pm._lightNeedsUpdate=!0,this.pm.changeAllLightMaterialUpdateFlags(!0),this._clearNodeCache(),this.deleteCloneNode()},handleDataBoxChange:function(a){var b=a.kind,c=a.data,d=a.source,e=null;e=d===this.helperBox?this.helperGLNodeList:this.glNodeList,"add"===b?c instanceof Yb.Light?(this.pm._lightNeedsUpdate=!0,this.pm.changeAllLightMaterialUpdateFlags(!0),this.prepareData()):c instanceof Yb.Annotation?this._createAnnotationDiv(c):(this.addNodeMaterials(c),this.addNode(c,e),c._alarmBillboard&&this.alarmBillboards.push(c._alarmBillboard)):"remove"===b?c instanceof Yb.Light?(this.pm._lightNeedsUpdate=!0,this.pm.changeAllLightMaterialUpdateFlags(!0),this.prepareData()):c instanceof Yb.Annotation?this._removeAnnotationDiv(c):(this.removeNode(c,e),this.deleteCloneNode(c)):"clear"===b&&this._clearDataBox(),this.boundingBox=null,this.dirtyNetwork()},removeNode:function(a,b){for(var c=b.length-1;c>=0;c--){var d=b[c];d.node===a&&b.splice(c,1)}this._clearNodeCache(a)},_clearNodeCache:function(a){if(a){if(a.oldGroups=a.groups||a.oldGroups,null!=a.oldGroups)for(var b in a.oldGroups){var c=a.oldGroups[b],d=this.groupCountMap[c.id];null!=d&&(d--,0>=d?(delete this.groupCountMap[c.id],delete this.groupMap[c.id]):this.groupCountMap[c.id]=d)}for(var e=0;e<this.alarmBillboards.length;e++){var f=this.alarmBillboards[e];
f.getParent()===a&&(this.alarmBillboards.splice(e,1),e--)}a instanceof Yb.Annotation&&this._removeAnnotationDiv(a)}else{for(var g in this.groupMap){var h=this.groupMap[g],i=h._nodeId;this.helperBox.containsById(i)||delete this.groupMap[g]}this.alarmBillboards.splice(0),this.glNodeList=[]}for(var g in this._annotationMap)this._removeAnnotationDiv(g)},addNode:function(a,b){for(var c=this.addWebGLNode(b,a),d=0;d<c.length;d++){var e=c[d];this.updateWebGLNode(e)}},addNodeMaterials:function(a){var b,c=a.material;if(c instanceof Yb.Material)this.addMaterial(c);else if(c instanceof Yb.ArrayMaterial){var d=c.materials,e=d.length;for(b=0;e>b;b++)this.addMaterial(d[b])}},addMaterial:function(a){this.pm.addMaterial(a),a.map&&this.pm.addTexture(a.map)},handleDataPropertyChange:function(a){var b=a.source;if(b instanceof Yb.Node){var c=a.property;if(b.isSizeChangedProperty(c)||c===Yb.Styles.MaterailType||c===Yb.Styles.NormalType){if(b instanceof Yb.Line){b.verticesNeedUpdate=!0;var d=this.lineMap[b._id];this.initLineBuffers(b),gc.buildLineBufferData(b,this._gl.DYNAMIC_DRAW,this._gl,d)}else if(b.groups){b.verticesNeedUpdate=!0,(c===Yb.Styles.MaterailType||c===Yb.Styles.NormalType)&&(b.normalsNeedUpdate=!0);for(var e in b.groups){var f=b.groups[e],d=this.groupMap[f.id],g=gc.getMaterial(b,f.materialIndex);b.normalsNeedUpdate&&this.initGroupBuffer(b,f,d,!0),gc.buildGroupBufferData(f,b,this._gl.DYNAMIC_DRAW,!b.dynamic,g,this._gl,d,this)}}}else if("materialMapping"===c)this._currentGroupHash=null,this.removeNode(b,this.glNodeList),this.addNode(b,this.glNodeList);else if("alarmBillboard"===c){var h=a.oldValue,i=a.newValue;this._addNodeAlarmBillboard(b,h,i)}this.addNodeMaterials(b)}else b instanceof Yb.Light&&(this.pm._lightNeedsUpdate=!0);(b.isSizeChangedProperty&&b.isSizeChangedProperty(c)||"parent"==c||b.isSpaceChangedProperty(c))&&(this.deleteCloneNode(b),this.boundingBox=null),this.dirtyNetwork()},deleteCloneNode:function(a){if(a){var b=a.getId?a.getId():a,c=this.normalNodeMap[b];if(null!=c){c.setParent(null);for(var d in c.groups){var e=c.groups[d];delete this.groupMap[e.id]}}delete this.normalNodeMap[b]}else for(var b in this.normalNodeMap)this.deleteCloneNode(b)},setBlurAmount:function(a){this._blurAmount=a},setBlurScale:function(a){this._blurScale=a},setBlurStrength:function(a){this._blurStrength=a},setBlurGlobalAlpha:function(a){this._blurGlobalAlpha=a},dirtyNetwork:function(a){this.dataBox.batch||(this._dirty=!0)},_addNodeAlarmBillboard:function(a,b,c){if(c===e&&(c=a._alarmBillboard),null!=b&&-1!==this.alarmBillboards.indexOf(b)){var d=this.alarmBillboards.indexOf(b);this.alarmBillboards.splice(d,1),b.removePropertyChangeListener(this.dirtyNetwork,this)}c&&-1===this.alarmBillboards.indexOf(c)&&(this.alarmBillboards.push(c),c.addPropertyChangeListener(this.dirtyNetwork,this))},initWebGLNodes:function(a,b){var c,d,e=a.getNodes();for(c=0,d=e.size();d>c;c++){var f=e.get(c);f.renderSelected=!1,this.addWebGLNode(b,f)}for(c=0,d=b.length;d>c;c++)this.updateWebGLNode(b[c])},updateWebGLNode:function(a){var b,c,d=a.node;if(d instanceof Yb.Entity){for(var e in d.groups)if(b=d.groups[e],c=gc.getMaterial(d,b.materialIndex),d.buffersNeedUpdate){var f=this.groupMap[b.id];this.initGroupBuffer(d,b,f),gc.buildGroupBufferData(b,d,this._gl.DYNAMIC_DRAW,!d.dynamic,c,this._gl,f,this)}d.setUpdateFlags(!1),d.buffersNeedUpdate=!1}else if(d instanceof Yb.BufferNode)this.setBufferNodeData(d,this._gl.DYNAMIC_DRAW,!d.dynamic);else if(d instanceof Yb.Line){var f=this.lineMap[d._id];gc.buildLineBufferData(d,this._gl.DYNAMIC_DRAW,this._gl,f)}else if(d instanceof Yb.Particle){var f=this.particleMap[d._id];ic(d,this._gl.DYNAMIC_DRAW,this._gl,f)}},addWebGLNode:function(a,b){var c,d,f,g,h=[];if(this._addNodeAlarmBillboard(b),b._modelViewMatrix=new ac,b._normalMatrix=new _b,b instanceof Yb.Entity){b.groups==e&&hc(b);for(c in b.groups){d=b.groups[c],d.id=d.id===e?Yb.Network3D.GroupCache._groupCounter++:d.id;var i=this.groupCountMap[d.id]||0;i++,this.groupCountMap[d.id]=i,this.groupMap[d.id]===e&&(this.groupMap[d.id]={});var j=this.groupMap[d.id];j._nodeId=b.getId(),j.__webglVertexBuffer||(this.createGroupBuffer(d,j),this.initGroupBuffer(b,d,j),b.setUpdateFlags(!0))}}else if(b instanceof Yb.Line){null==this.lineMap[b._id]&&(this.lineMap[b._id]={});var j=this.lineMap[b._id];j._nodeId=b.getId(),j.__webglVertexBuffer||(this.createLineBuffers(b),this.initLineBuffers(b),b.verticesNeedUpdate=!0,b.colorsNeedUpdate=!0,b.lineDistancesNeedUpdate=!0)}else if(b instanceof Yb.Particle){null==this.lineMap[b._id]&&(this.lineMap[b._id]={});var j=this.lineMap[b._id];j._nodeId=b.getId(),j.__webglVertexBuffer||(this.createParticleBuffers(b),this.initParticleBuffers(b),b.verticesNeedUpdate=!0,b.colorsNeedUpdate=!0)}else b instanceof Yb.BufferNode?this.initBufferNode(b):b instanceof Yb.Annotation&&this._createAnnotationDiv(b);if(b instanceof Yb.Entity){for(c in b.groups)d=b.groups[c],f=gc.getMaterial(b,d.materialIndex),g={group:d,node:b,opaque:f.transparent?null:f,transparent:f.transparent?f:null},a.push(g),h.push(g);null===b.groups}else b instanceof Yb.Line?(f=b.material,g={group:b,node:b,opaque:f.transparent?null:f,transparent:f.transparent?f:null},a.push(g),h.push(g)):b instanceof Yb.Particle?(f=b.material,g={group:b,node:b,opaque:f.transparent?null:f,transparent:f.transparent?f:null},a.push(g),h.push(g)):b instanceof Yb.BufferNode&&(f=b.material instanceof Yb.ArrayMaterial?b.material.materials[0]:b.material,g={group:b,node:b,opaque:f.transparent?null:f,transparent:f.transparent?f:null},a.push(g),h.push(g));return b.glActive=!0,h},onElementDispose:function(a){var b=a.target;b.removeEventListener("dispose",this.onElementDispose),deallocateElement(b),this.info.memory.geometries--},deallocateElement:function(a){},_AK47:function(a,b,c,d,f,g){this._fog;a.parent===e&&a.updateWorldMatrix(!0,!1),a.worldMatrixInverse.getInverse(a.worldMatrix),this._projScreenMatrix.multiply(a.projectionMatrix,a.worldMatrixInverse),this._frustum.setFromMatrix(this._projScreenMatrix),0===c.length&&(this.initWebGLNodes(b,c),this.prepareData());var h,i,j,k;if(!g)for(h=0,i=c.length;i>h;h++)j=c[h],k=j.node,k.renderSelected=!1,j.render=!1,this.isVisible(k)&&(this.unrollBufferMaterial(j),this.setupMatrices(k,a),(k instanceof Yb.Entity||k instanceof Yb.Particle)&&k.frustumCulled&&!this._frustum.intersectsObject(k)||(j.render=!0,this.sortNodes&&(this._vector3.copy(k.worldMatrix.getPosition()),this._vector3.applyProjection(this._projScreenMatrix),null!=k.renderDepth?j.z=k.renderDepth+this._vector3.z:j.z=this._vector3.z)));var l=new kc;if(l.addAll(d),!f&&!g){for(var m=this.alarmBillboards.length-1;m>=0;m--){var n=this.alarmBillboards[m];null==n.getParent()&&this.alarmBillboards.splice(m,1)}l.addAll(this.alarmBillboards)}var o=this;!g&&l.forEach(function(a){a.renderDepth?a.z=a.renderDepth:(o._vector3.copy(a.worldMatrix.getPosition()),o._vector3.applyProjection(o._projScreenMatrix),a.z=o._vector3.z)}),l.size()>0&&!g&&null==this.billboardRenderer&&(this.billboardRenderer=new Yb.BillboardRenderer);var p=[].concat(c).concat(l._as),q=this.sortNodesFunc(p);this.setBlending(Yb.NoBlending),this.renderNodes(q,!1,"opaque",a,b.getLights(),!1,null,g,this.sortOpaqueOrderByMaterial),this.renderNodes(q,!0,"transparent",a,b.getLights(),!0,null,g),this.setDepthTest(!0),this.setDepthWrite(!0)},unrollBufferMaterial:function(a){var b,c,d,e=a.node,f=a.group;d=e.material,d instanceof Yb.ArrayMaterial?(c=f.materialIndex||0,b=d.materials[c],b.transparent?(a.transparent=b,a.opaque=null):(a.opaque=b,a.transparent=null)):(b=d,b&&(b.transparent?(a.transparent=b,a.opaque=null):(a.opaque=b,a.transparent=null)))},renderLicense:function(){},isShadowable:function(){return this.isShadowMapEnable()&&(this.maxShadows>0||this.maxPointShadows>0)},render:function(){if(this._dirty&&(this.resetRenderInfo(),this._dirty=!1,null!=this.beforeRenderFunction&&this.beforeRenderFunction.call(this),!this.isShadowable()||(this.shadowMapRender(),this.setRenderTarget(e),!this.debugPointLight))){if(Rc.twm(this),this.paintBottom(this._bottomCanvas),this.getShowFps()&&(this.__time=(new Date).getTime()),this.innerRender(this._camera,!0),this.renderAnnotations(this._camera),this.extendRender(this._camera),this.paintTopCanvas(),this.getShowFps()){this._tpf=(new Date).getTime()-this.__time;var a=this._topCanvas.getContext("2d"),b=(1e3/this._tpf).toFixed(0);b>500&&(b="> 500");var c="FPS:"+b+",TPF:"+this._tpf+" ms";a.font="20px Arial sans-serif",a.fontWeight="bold",a.lineWith=2,a.fillStyle="rgba(0, 0, 0, 1)",a.fillText(c,10,25)}if(this._xyz!=e){var d,f=this._xyz,g=f.markText,h=f.type,c=(f.expired,f.innerHTML),i=0,j=0,a=(this._topCanvas.getBoundingClientRect(),this._topCanvas.getContext("2d"));g!=e&&null!=g&&""!=g||"2"==h?(a.font="24px Arial sans-serif",d=fc.getTextSize(a.font,c),a.fillStyle="red",i=this._canvas.width-d.width-20,j=this._canvas.height-d.height-10):(a.font="15px Arial sans-serif",a.fillStyle="rgba(240, 120, 25, 0.6)",d=fc.getTextSize(a.font,c),i=this._canvas.width-d.width-20,j=this._canvas.height-d.height-10),a.fillText(c,i,j)}null!=this.renderCallback&&this.renderCallback.call(this)}},getTextSize:function(a,b){return fc.getTextSize(a,b)},shadowMapRender:function(){null==this.shadowMapRenderer&&(this.shadowMapRenderer=new _c,this.shadowMapRenderer.init(this)),0===this.glNodeList.length&&(this.initWebGLNodes(this.dataBox,this.glNodeList),this.prepareData()),this.shadowMapRenderer.render(this.dataBox,this._camera)},handleMouseDown:function(a){var b=a.target;this.lastX=a.clientX,this.lastY=a.clientY,"tgl_annotation"==b.getAttribute("class")&&"1"==b.style.opacity&&(a.stop=!0,a.stopPropagation())},handleClick:function(a){var b=a.clientX-this.lastX,c=a.clientY-this.lastY;if(Math.abs(b)<.1&&Math.abs(c)<.1){var d=a.target;if("tgl_annotation"!=d.getAttribute("clazz"))this._activeAnnotation&&(this._activeAnnotation=null,this.dirtyNetwork());else if("1"==d.style.opacity){var e=d.getAttribute("id"),f=this.getDataBox().getDataById(e),g=this._annotationMap[e];this.handleDefaultAnnotationClick(f,g),this.handleAnnotationClick(f,g),this.dirtyNetwork()}}},handleDefaultAnnotationClick:function(a,b){this._activeAnnotation==a||(this._activeAnnotation=a)},handleAnnotationClick:function(a,b){},renderAnnotations:function(a){var b=this.dataBox.getAnnotations(),c=this;if(b&&(b.forEach(function(b){c.renderAnnotation(a,b)}),this._createAnnotationStyle()),this._activeAnnotation){this._createAnnotationToolTipDiv();var d=this._annotationToolTipDiv;d.innerHTML=this._activeAnnotation.getText();var e=this._annotationMap[this._activeAnnotation.getId()];d.parentNode!=e&&e.appendChild(d),d.style.opacity=e.style.opacity}},getAnnotationDiv:function(a){return this._annotationMap[a.getId()]},renderAnnotation:function(a,b){var c=this._annotationMap[b.getId()];null==c&&(c=this._createAnnotationDiv(b)),c.innerHTML=b._label,b.updateWorldMatrix();var d=b.worldMatrix.getPosition(),e=b.getStyle("annotation.class");c.setAttribute("class",e);var f=this.getViewPosition(d);this._annotationToolTipDiv;c.style.left=f.x+"px",c.style.top=f.y+"px",c.style.opacity="1";var g=d.distanceTo(a.getPosition()),h=this.getElementByScreenPoint(f,!1);if(h&&h.length>0){var i=h[0];i.distance<g&&(c.style.opacity="0.03")}},_addCSSRule:function(a,b,c,d){d=d||(a.cssRules||a.rules).length,a.insertRule?a.insertRule(b+"{"+c+"}",d):a.addRule&&a.addRule(b,c,d)},_createAnnotationStyle:function(){if(!this._annotationStyle){var a=document.createElement("style");a.appendChild(document.createTextNode("")),document.head.appendChild(a);var b=a.sheet;this._addCSSRule(b,".tgl_annotation","position:absolute;width:16px;height:16px;border-radius:10px;text-align:center;border : 2px solid gray;"),this._addCSSRule(b,".tgl_annotation:hover","border : 2px solid black;"),this._annotationStyle=a}},_removeAnnotationDiv:function(a){var b=a.getId?a.getId():a,c=this._annotationMap[b];null!=c&&this.getRootView().removeChild(c)},_createAnnotationDiv:function(a){var b=document.createElement("div"),c=a.getStyle("annotation.class");return b.setAttribute("id",a.getId()),b.setAttribute("class",c),b.setAttribute("clazz","tgl_annotation"),this._annotationMap[a.getId()]=b,this.getRootView().appendChild(b),b},_createAnnotationToolTipDiv:function(){if(null==this._annotationToolTipDiv){var a=document.createElement("div");a.setAttribute("class","tgl_annotation_tooltip");var b=document.createElement("style");b.appendChild(document.createTextNode("")),document.head.appendChild(b);var c=b.sheet,d="position: absolute;border: 3px solid #333; background-color: #ccd; padding: 3px;text-align: left;width: 220px;height: 'auto';border-radius: 10px;bottom:35px;left:-13px;";this._addCSSRule(c,".tgl_annotation_tooltip",d),d="content: ' ';position: absolute;top: 100%; border: 1px solid;",this._addCSSRule(c,".tgl_annotation_tooltip:after, .tgl_annotation_tooltip:before",d),d="border-color: #333 transparent transparent transparent;border-width: 16px 17px 0 7px;left: 10px;",this._addCSSRule(c,".tgl_annotation_tooltip:before",d),d="border-color: #ccd transparent transparent transparent;border-width: 12px 11px 0 4px;left: 14px;",this._addCSSRule(c,".tgl_annotation_tooltip:after",d),this._annotationToolTipDiv=a}},extendRender:function(a){},innerRender:function(a,b){if(a===e&&(a=this._camera),null===a)return void console.log(" no camera");if(this.debug&&console.log("inner Render"),this.autoClear){var c=this._clearColor;this._gl.clearColor(c.r,c.g,c.b,this._clearAlpha),vc.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil,this)}if(b)for(var d=0;d<this._interactions.length;d++){var f=this._interactions[d];f.update&&f.update()}if(this.billboardRenderer&&this.billboardRenderer.disable(),this._gl.viewport(0,0,this._canvas.width,this._canvas.height),this._sSAOEnable){this.linearDepth=a.far-a.near,this.ssaoing=!0,this._renderDeferredTarget(a,this.deferredPostionMaterial,this.deferredPostionTarget),this._renderDeferredTarget(a,this.deferredNormalMaterial,this.deferredNormalTarget),this._setSSAOMaterial(),this._overloadMaterial=null,this._renderSurface(a,this.ssaoTarget,this.ssaoMaterial);var g=this._canvas.width/this._canvas.height;this._ssaoBlur?(this._renderBlurTarget(a,this._blurMaterialH,this.ssaoTarget,this.ssaoTarget1,g),this._renderBlurTarget(a,this._blurMaterialV,this.ssaoTarget1,this.ssaoTarget2,g),this.finalSSAOTarget=this.ssaoTarget2):this.finalSSAOTarget=this.ssaoTarget,this.setRenderTarget(e),this.ssaoing=!1}if(this.renderOutline=!1,this.renderOutlineGlow=!1,vc.enableStencil(this._gl),this._baseRender=!0,vc.r(this,a,this.dataBox,this.glNodeList,this.dataBox.getBillboards()),this._baseRender=!1,vc.stencilTest(this._gl),this.renderOutline&&vc.r(this,a,this.dataBox,this.glNodeList,this.dataBox.getBillboards(),!1,"stencil"),this.renderOutlineGlow){var h=this._glowSurface.target,i=this._glowSurface.target1,j=this._glowSurface.target2;vc.disableStencil(this._gl),this.setRenderTarget(h),h._id=h._id||(new Date).getTime()+"0",i._id=i._id||(new Date).getTime()+"1",j._id=j._id||(new Date).getTime()+"2",this._gl.viewport(0,0,h.width,h.height),this._gl.clearColor(0,0,0,0),this._gl.clear(this._gl.COLOR_BUFFER_BIT|this._gl.DEPTH_BUFFER_BIT),this._gl.colorMask(!1,!1,!1,!1),vc.r(this,a,this.dataBox,this.glNodeList,this.dataBox.getBillboards(),!1,"glow.unselect"),this._gl.colorMask(!0,!0,!0,!0),vc.r(this,a,this.dataBox,this.glNodeList,this.dataBox.getBillboards(),!1,"glow.select");var k,l;this.setRenderTarget(i),this._gl.viewport(0,0,i.width,i.height),this._gl.clearColor(0,0,0,0),this._gl.clear(this._gl.COLOR_BUFFER_BIT|this._gl.DEPTH_BUFFER_BIT),this._blurMaterialH.setMap(h);var g=this._canvas.width/this._canvas.height;this._blurMaterialH.texelSize=new Zb(h.width,h.height/g),this._blurMaterialH.blurAmount=this._blurAmount||5,this._blurMaterialH.blurScale=this._blurScale||1,this._blurMaterialH.blurStrength=this._blurStrength||1,this._blurMaterialH.orientation=1;for(k in this._glowSurface.groups)l=this._glowSurface.groups[k],this.renderGroup(a,[],this._blurMaterialH,l,this._glowSurface2);this.setRenderTarget(j),this._gl.clearColor(0,0,0,0),this._gl.clear(this._gl.COLOR_BUFFER_BIT|this._gl.DEPTH_BUFFER_BIT),this._blurMaterialV.setMap(i),this._blurMaterialV.texelSize=new Zb(i.width,i.height/g),this._blurMaterialV.blurAmount=this._blurAmount||5,this._blurMaterialV.blurScale=this._blurScale||1,this._blurMaterialV.blurStrength=this._blurStrength||1,this._blurMaterialV.orientation=0;for(k in this._glowSurface.groups)l=this._glowSurface.groups[k],this.renderGroup(a,[],this._blurMaterialV,l,this._glowSurface2);this.setRenderTarget(e),this._glowSurface._modelViewMatrix=new ac,this._glowSurface._normalMatrix=new _b,this.setupMatrices(this._glowSurface,a),this._glowSurfaceMaterial.setMap(j),this._glowSurfaceMaterial.useBlur=0,this._glowSurfaceMaterial.blurGlobalAlpha=this._blurGlobalAlpha||1,vc.setBlending(this._glowSurfaceMaterial.blendMode,this._glowSurfaceMaterial.blendEquation,this._glowSurfaceMaterial.blendSrc,this._glowSurfaceMaterial.blendDst,this),this._gl.enable(this._gl.STENCIL_TEST);for(k in this._glowSurface.groups)l=this._glowSurface.groups[k],this.renderGroup(a,[],this._glowSurfaceMaterial,l,this._glowSurface);this.setRenderTarget(i),this._gl.viewport(0,0,i.width,i.height),this._gl.clearColor(0,0,0,0),this._gl.clear(this._gl.COLOR_BUFFER_BIT|this._gl.DEPTH_BUFFER_BIT),this._blurMaterialH.setMap(h);var g=this._canvas.width/this._canvas.height;this._blurMaterialH.texelSize=new Zb(h.width,h.height/g),this._blurMaterialH.blurAmount=this._blurAmount||10,this._blurMaterialH.blurScale=this._blurScale||1,this._blurMaterialH.blurStrength=this._blurStrength||1,this._blurMaterialH.orientation=0;for(k in this._glowSurface.groups)l=this._glowSurface.groups[k],this.renderGroup(a,[],this._blurMaterialH,l,this._glowSurface2);this.setRenderTarget(j),this._gl.clearColor(0,0,0,0),this._gl.clear(this._gl.COLOR_BUFFER_BIT|this._gl.DEPTH_BUFFER_BIT),this._blurMaterialV.setMap(i),this._blurMaterialV.texelSize=new Zb(i.width,i.height/g),this._blurMaterialV.blurAmount=this._blurAmount||10,this._blurMaterialV.blurScale=this._blurScale||1,this._blurMaterialV.blurStrength=this._blurStrength||1,this._blurMaterialV.orientation=1;for(k in this._glowSurface.groups)l=this._glowSurface.groups[k],this.renderGroup(a,[],this._blurMaterialV,l,this._glowSurface2);this.setRenderTarget(e),this._glowSurface._modelViewMatrix=new ac,this._glowSurface._normalMatrix=new _b,this.setupMatrices(this._glowSurface,a),this._glowSurfaceMaterial.setMap(j),this._glowSurfaceMaterial.useBlur=0,this._glowSurfaceMaterial.blurGlobalAlpha=this._blurGlobalAlpha||1,vc.setBlending(this._glowSurfaceMaterial.blendMode,this._glowSurfaceMaterial.blendEquation,this._glowSurfaceMaterial.blendSrc,this._glowSurfaceMaterial.blendDst,this),this._gl.enable(this._gl.STENCIL_TEST);for(k in this._glowSurface.groups)l=this._glowSurface.groups[k],this.renderGroup(a,[],this._glowSurfaceMaterial,l,this._glowSurface);this._gl.clearColor(0,0,0,0)}vc.disableStencil(this._gl),this.renderHelper(a)},_renderDeferredTarget:function(a,b,c,d){d=d||new Yb.Vec4(0,0,0,0,0),b.linearDepth=this.linearDepth,this.setRenderTarget(c),this._overloadMaterial=b,this._gl.clearColor(d.x,d.y,d.z,d.w),this._gl.clear(this._gl.COLOR_BUFFER_BIT|this._gl.DEPTH_BUFFER_BIT),vc.r(this,a,this.dataBox,this.glNodeList,this.dataBox.getBillboards())},_renderBlurTarget:function(a,b,c,d,e){clearColor=clearColor||new Yb.Vec4(0,0,0,0,0),this.setRenderTarget(d),this._gl.viewport(0,0,d.width,d.height),this._gl.clearColor(clearColor.x,clearColor.y,clearColor.z,clearColor.w),this._gl.clear(this._gl.COLOR_BUFFER_BIT|this._gl.DEPTH_BUFFER_BIT),b.setMap(c),b.texelSize=new Zb(c.width,c.height/e),b.blurAmount=this._blurAmount||5,b.blurScale=this._blurScale||1,b.blurStrength=this._blurStrength||1;var f,g;for(f in this._glowSurface.groups)g=this._glowSurface.groups[f],this.renderGroup(a,[],b,g,this._glowSurface2)},_setSSAOMaterial:function(){this.ssaoMaterial.map=this.deferredPostionTarget,this.ssaoMaterial.map1=this.deferredNormalTarget,this.ssaoMaterial.attenuation=this._attenuation||new Zb(1,.02),this.ssaoMaterial.occluderBias=this._occluderBias||.5,this.ssaoMaterial.samplingRadius=this._samplingRadius||20,this.ssaoMaterial.texelSize=new Zb(1/this.deferredPostionTarget.width,1/this.deferredPostionTarget.height)},_renderSurface:function(a,b,c,d){d=d||new Yb.Vec4(1,1,1,1),this.setRenderTarget(b),this._gl.clearColor(d.x,d.y,d.z,d.w),this._gl.clear(this._gl.COLOR_BUFFER_BIT|this._gl.DEPTH_BUFFER_BIT),this._glowSurface._modelViewMatrix=new ac,this._glowSurface._normalMatrix=new _b,this.setupMatrices(this._glowSurface,a);var e,f;for(f in this._glowSurface.groups)e=this._glowSurface.groups[f],this.renderGroup(a,[],c,e,this._glowSurface)},renderHelper:function(a){vc.r(this,a,this.helperBox,this.helperGLNodeList,this.helperBox.getBillboards(),"stencil")},initSurfaceGroup:function(){this._glowSurface.setUpdateFlags(!0),hc(this._glowSurface);for(var a in this._glowSurface.groups){var b=this._glowSurface.groups[a];b.id=b.id===e?Yb.Network3D.GroupCache._groupCounter++:b.id,this.groupMap[b.id]===e&&(this.groupMap[b.id]={});var c=this.groupMap[b.id];this.createGroupBuffer(b,c),this.initGroupBuffer(this._glowSurface,b,c),gc.buildGroupBufferData(b,this._glowSurface,this._gl.DYNAMIC_DRAW,!1,this._glowSurfaceMaterial,this._gl,c,this)}this._glowSurface2.setUpdateFlags(!0),hc(this._glowSurface2);for(var a in this._glowSurface2.groups){var b=this._glowSurface2.groups[a];b.id=b.id===e?Yb.Network3D.GroupCache._groupCounter++:b.id,this.groupMap[b.id]===e&&(this.groupMap[b.id]={});var c=this.groupMap[b.id];this.createGroupBuffer(b,c),this.initGroupBuffer(this._glowSurface2,b,c),gc.buildGroupBufferData(b,this._glowSurface2,this._gl.DYNAMIC_DRAW,!1,this._glowSurfaceMaterial,this._gl,c,this)}},getOutlineMaterial:function(a,b){var c=(b.getStyle("select.width")||1)+1+" "+new Yb.Color(b.getStyle("select.color")).getUniqueCode()+a,d=this.outlineMaterialMap[c];return null==d&&(d=new Yb.EntityMaterial,"outline.normal"==a?(d._type="outline",d.outline=b.getStyle("select.width")||1):"outline.glow"==a?d._type="basic":(d.wireframe=!0,d.wireframeLinewidth=(b.getStyle("select.width")||1)+1),d.color=new Yb.Color(b.getStyle("select.color")),this.outlineMaterialMap[c]=d),d},renderNodes:function(a,b,c,d,e,f,g,h,i){var j,k,l,m,n,o,p;b?(n=a.length-1,o=-1,p=-1):(n=0,o=a.length,p=1);for(var q=n;q!==o;q+=p)if(j=a[q],m=j.node?j.transparent||j.opaque:j.material){this._overloadMaterial&&(m=this._overloadMaterial);var r=this.getOverLoadMaterial(j.node?j.node:j,m);if(r){var s=r.getUniqueCode(),t=Zc.getMaterial(s);t?m=t:(Zc.setMaterial(s,r),m=r)}if(!("opaque"==c&&1==m.transparent||"transparent"==c&&0==m.transparent)){if(f?(vc.setBlending(m.blendMode,m.blendEquation,m.blendSrc,m.blendDst,this),vc.setDepthWrite(!1,this)):vc.setDepthWrite(m.depthMask,this),j instanceof Yb.Billboard){var u=j.material.transparent?"transparent":"opaque";c==u&&this.billboardRenderer.render(this,[j],d,2*this._canvas.width,2*this._canvas.height)}else if(j.render){if(this.billboardRenderer&&this.billboardRenderer.disable(),k=j.node,l=j.group,vc.setDepthTest(m.depthTest,this),vc.setPolygonOffset(m.polygonOffset,m.polygonOffsetFactor,m.polygonOffsetUnits,this),this.setGLFaces(m),k instanceof Yb.Particle){if(k.verticesNeedUpdate||k.colorsNeedUpdate||k.sortParticles){var v=this.particleMap[k._id];ic(k,this._gl.DYNAMIC_DRAW,this._gl,v)}k.verticesNeedUpdate=!1,k.colorsNeedUpdate=!1}var w=this.getSelectStyle(k);if("outline"==w&&(w="outline.normal"),h?"glow.unselect"===h&&(k.isSelected()||(k instanceof Yb.BufferNode?this.renderBufferNode(d,e,m,l,k):vc.g(this,d,e,m,l,k))):(!k.isSelected()||"outline.normal"!==w&&"outline.wireframe"!==w&&"outline.glow"!==w?this.setStencilTest(!1):(this.setStencilTest(!0),"outline.glow"===w?this.renderOutlineGlow=!0:this.renderOutline=!0),k instanceof Yb.BufferNode?this.renderBufferNode(d,e,m,l,k):vc.g(this,d,e,m,l,k)),k.isSelected()&&this.renderSelect(k))if("outline.normal"===w||"outline.wireframe"===w||"outline.glow"===w){if(null!=h&&"glow.unselect"!=h)if("outline.normal"===w){if(k.renderSelected===!1){var x=this.getOutlineMaterial(w,k),y=this.normalNodeMap[k.getId()];if(null==y){var y=this.cloneNode(k,x);this.normalNodeMap[k.getId()]=y}this.setupMatrices(y,d);for(var z in y.groups)vc.g(this,d,e,x,y.groups[z],y);k.renderSelected=!0}}else if("outline.normal"!==w){var x=this.getOutlineMaterial(w,k);vc.g(this,d,e,x,l,k)}}else k.renderSelected===!1&&(this.renderNodeSelection(d,e,k),k.renderSelected=!0);k.getAlarmState().getPropagateSeverity()&&this.renderAlarmBorder(k)&&this.renderNodeAlarm(d,e,k)}k&&k.setUpdateFlags(!1)}}},cloneNode:function(a,b){var c,d,e=new Yb.Entity,f={vertices:[],uvs:[],faces:[]};for(c=0,d=a.vertices.length;d>c;c++)f.vertices.push(a.vertices[c].clone());for(c=0,d=a.faces.length;d>c;c++)f.faces.push(a.faces[c].clone());for(c=0,d=a.uvs.lenght;d>c;c++){for(var g=uvs[c],h=[],i=0;g>i;i++)h.push(g[i].clone());f.uvs.push(h)}return Yb.Node.prototype.mergeVertices.call(f),Yb.Node.prototype.computeFaceNormals.call(f),Yb.Node.prototype.computeVertexNormals.call(f,!0),e.setPosition(a.getPosition()),e.setScale(a.getScale()),e.setRotation(a.getRotation()),e.setParent(a.getParent()),e._modelViewMatrix=new ac,e._normalMatrix=new _b,e.data=f,e.vertices=f.vertices,e.uvs=f.uvs,e.faces=f.faces,e.material=b,e.primitive=new Yb.Primitive(f),e.setUpdateFlags(!0),hc(e),this.buildNodeBufferData(e),e},buildNodeBufferData:function(a){for(var b in a.groups){var c=a.groups[b];c.id=c.id===e?Yb.Network3D.GroupCache._groupCounter++:c.id,this.groupMap[c.id]===e&&(this.groupMap[c.id]={});var d=this.groupMap[c.id];this.createGroupBuffer(c,d),this.initGroupBuffer(a,c,d),gc.buildGroupBufferData(c,a,this._gl.DYNAMIC_DRAW,!1,a.material,this._gl,d,this)}},needSmoothNormal:function(a,b){var c=b.normalType;return c!=e?c===Yb.NormalTypeSmooth:this.needSmoothNormalFunction?this.needSmoothNormalFunction(a):!1},renderNodeSelection:function(a,b,c){c.createSelectionCube(this.selectionCube),this.setupMatrices(this.selectionCube,a);var d=this.selectionCube.groups;this.selectionCube.material.needsUpdate=!0;for(var f in d){var g=d[f];g.id=g.id===e?Yb.Network3D.GroupCache._groupCounter++:g.id,this.groupMap[g.id]===e&&(this.groupMap[g.id]={});var h=this.groupMap[g.id];h.__webglVertexBuffer||(this.createGroupBuffer(g,h),this.initGroupBuffer(c,g,h)),this.selectionCube.setUpdateFlags(!0),gc.buildGroupBufferData(g,this.selectionCube,this._gl.DYNAMIC_DRAW,!1,this.selectionCube.material,this._gl,h,this),this.renderGroup(a,[],this.selectionCube.material,g,this.selectionCube)}},renderNodeAlarm:function(a,b,c){c.createPropagateAlarmCube(this.alarmCube),this.setupMatrices(this.alarmCube,a);var d=this.alarmCube.groups;this.alarmCube.material.needsUpdate=!0;for(var f in d){var g=d[f];g.id=g.id===e?Yb.Network3D.GroupCache._groupCounter++:g.id,this.groupMap[g.id]===e&&(this.groupMap[g.id]={});var h=this.groupMap[g.id];h.__webglVertexBuffer||(this.createGroupBuffer(g,h),this.initGroupBuffer(c,g,h)),this.alarmCube.setUpdateFlags(!0),gc.buildGroupBufferData(g,this.alarmCube,this._gl.DYNAMIC_DRAW,!1,this.alarmCube.material,this._gl,h,this),this.renderGroup(a,[],this.alarmCube.material,g,this.alarmCube)}},renderBufferNode:function(a,b,c,d,e,f){if(c.visible!==!1){var g,h;g=this.pm.setProgram(a,b,this._fog,c,d,e),h=g.attributes;var i=e,j=!1,k=c.wireframe?1:0,l=16777215*d._id+2*g.id+k;(l!==this._currentGroupHash||f)&&(this._currentGroupHash=l,j=!0),j&&this.disableAttributes();var m=this._gl,n=i.attributes.index,o=this.bufferNodeMap[e._id];if(n){var p=i.offsets;p.length>1&&(j=!0);for(var q=0,r=p.length;r>q;q++){var s=p[q].index;if(j){var t=i.attributes.position,u=t.itemSize;m.bindBuffer(m.ARRAY_BUFFER,o.position),this.enableAttribute(h.position),m.vertexAttribPointer(h.position,u,m.FLOAT,!1,0,s*u*4);var v=i.attributes.normal;if(h.normal>=0&&v){var w=v.itemSize;m.bindBuffer(m.ARRAY_BUFFER,o.normal),this.enableAttribute(h.normal),m.vertexAttribPointer(h.normal,w,m.FLOAT,!1,0,s*w*4)}var x=i.attributes.uv;if(h.uv>=0&&x){var y=x.itemSize;m.bindBuffer(m.ARRAY_BUFFER,o.uv),this.enableAttribute(h.uv),m.vertexAttribPointer(h.uv,y,m.FLOAT,!1,0,s*y*4)}var z=i.attributes.color;if(h.color>=0&&z){var A=z.itemSize;m.bindBuffer(m.ARRAY_BUFFER,o.color),this.enableAttribute(h.color),m.vertexAttribPointer(h.color,A,m.FLOAT,!1,0,s*A*4)}m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,o.index)}m.drawElements(m.TRIANGLES,p[q].count,m.UNSIGNED_SHORT,2*p[q].start),this.info.render.calls++,this.info.render.vertices+=p[q].count,this.info.render.faces+=p[q].count/3}}else{if(j){var t=i.attributes.position,u=t.itemSize;m.bindBuffer(m.ARRAY_BUFFER,t.buffer),this.enableAttribute(h.position),m.vertexAttribPointer(h.position,u,m.FLOAT,!1,0,0);var v=i.attributes.normal;if(h.normal>=0&&v){var w=v.itemSize;m.bindBuffer(m.ARRAY_BUFFER,v.buffer),this.enableAttribute(h.normal),m.vertexAttribPointer(h.normal,w,m.FLOAT,!1,0,0)}var x=i.attributes.uv;if(h.uv>=0&&x){var y=x.itemSize;m.bindBuffer(m.ARRAY_BUFFER,x.buffer),this.enableAttribute(h.uv),m.vertexAttribPointer(h.uv,y,m.FLOAT,!1,0,0)}var z=i.attributes.color;if(h.color>=0&&z){var A=z.itemSize;m.bindBuffer(m.ARRAY_BUFFER,z.buffer),this.enableAttribute(h.color),m.vertexAttribPointer(h.color,A,m.FLOAT,!1,0,0)}}var t=i.attributes.position;m.drawArrays(m.TRIANGLES,0,t.numItems/3),this.info.render.calls++,this.info.render.vertices+=t.numItems/3,this.info.render.faces+=t.numItems/3/3}}},getOverLoadMaterial:function(a,b){return null},renderGroup:function(a,b,c,d,e){if(null==c&&console.log("material is null"),c.visible!==!1){var f,g=this._gl;if(e instanceof Yb.Entity?f=this.groupMap[d.id]:e instanceof Yb.Line?f=this.lineMap[d._id]:e instanceof Yb.Particle&&(f=this.particleMap[d._id]),null==f)return void(this.debug&&console.error("tempGroup for id:"+(d.id||d._id)+" is null,please check"));var h,i,j,k,l,m;h=this.pm.setProgram(a,b,this._fog,c,d,e),i=h.attributes;var n,o=!1,p=c.wireframe?1:0;if(n=null!=d.id?16777215*d.id+2*h.id+p:d._id+""+(2*h.id+p),n!==this._currentGroupHash&&(this._currentGroupHash=n,o=!0),o&&this.disableAttributes(),i.position>=0&&o&&(g.bindBuffer(g.ARRAY_BUFFER,f.__webglVertexBuffer),this.enableAttribute(i.position),g.vertexAttribPointer(i.position,3,g.FLOAT,!1,0,0)),o){if(d.__webglCustomAttributesList)for(l=0,m=d.__webglCustomAttributesList.length;m>l;l++)k=d.__webglCustomAttributesList[l],i[k.buffer.belongsToAttribute]>=0&&(g.bindBuffer(g.ARRAY_BUFFER,k.buffer),this.enableAttribute(i[k.buffer.belongsToAttribute]),g.vertexAttribPointer(i[k.buffer.belongsToAttribute],k.size,g.FLOAT,!1,0,0));i.color>=0&&(g.bindBuffer(g.ARRAY_BUFFER,f.__webglColorBuffer),this.enableAttribute(i.color),g.vertexAttribPointer(i.color,3,g.FLOAT,!1,0,0)),i.normal>=0&&(g.bindBuffer(g.ARRAY_BUFFER,f.__webglNormalBuffer),this.enableAttribute(i.normal),g.vertexAttribPointer(i.normal,3,g.FLOAT,!1,0,0)),i.uv>=0&&(g.bindBuffer(g.ARRAY_BUFFER,f.__webglUVBuffer),this.enableAttribute(i.uv),g.vertexAttribPointer(i.uv,2,g.FLOAT,!1,0,0)),i.uv2>=0&&(g.bindBuffer(g.ARRAY_BUFFER,f.__webglUV2Buffer),this.enableAttribute(i.uv2),g.vertexAttribPointer(i.uv2,2,g.FLOAT,!1,0,0)),i.lineDistance>=0&&(g.bindBuffer(g.ARRAY_BUFFER,f.__webglLineDistanceBuffer),this.enableAttribute(i.lineDistance),g.vertexAttribPointer(i.lineDistance,1,g.FLOAT,!1,0,0))}e instanceof Yb.Entity?(c.wireframe?(this.setLineWidth(c.wireframeLinewidth),this._gl.lineJoin="round",o&&g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,f.__webglLineBuffer),g.drawElements(g.LINES,f.__webglLineCount,g.UNSIGNED_SHORT,0)):(o&&g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,f.__webglFaceBuffer),g.drawElements(g.TRIANGLES,f.__webglFaceCount,g.UNSIGNED_SHORT,0)),this.info.render.calls++,this.info.render.vertices+=f.__webglFaceCount,this.info.render.faces+=f.__webglFaceCount/3):e instanceof Yb.Line?(j=e.type===Yb.LineStrip?g.LINE_STRIP:g.LINES,this.setLineWidth(c.linewidth),g.drawArrays(j,0,f.__webglLineCount),this.info.render.calls++):e instanceof Yb.Particle?(g.drawArrays(g.POINTS,0,f.__webglParticleCount),this.info.render.calls++,
this.info.render.points+=f.__webglParticleCount):e instanceof Yb.Ribbon&&(g.drawArrays(g.TRIANGLE_STRIP,0,d.__webglVertexCount),this.info.render.calls++)}},prepareData:function(){this.maxLightCount=this.dataBox.allocateLights(this._maxLights),this.maxShadows=this.dataBox.allocateShadows(),this.maxPointShadows=this.dataBox.allocatePointShadows()},wrapBillboardMaterial:function(a){a instanceof Yb.Billboard&&a.material&&(a.opaque=a.material.transparent?null:a.material,a.transparent=a.material.transparent?a.material:null)},sortNodesFunc:function(a){if(this.sortNodes&&(null!==this.paintSortFunction||this.sortOpaqueOrderByMaterial)){var b=this;this.sortOpaqueOrderByMaterial?null==this.__st&&(this.__st=function(a,c){b.wrapBillboardMaterial(a),b.wrapBillboardMaterial(a);var d="opaque";if(a[d]&&c[d])return a[d].id-c[d].id;if(!a[d]&&c[d])return-1;if(a[d]&&!c[d])return 1;var e=a.node?a.node:a,f=c.node?c.node:c;return e.z=a.z,f.z=c.z,b.paintSortFunction?b.paintSortFunction(e,f):void 0}):null==this.__st&&(this.__st=function(a,c){var d=a.node?a.node:a,e=c.node?c.node:c;return d.z=a.z,e.z=c.z,b.paintSortFunction?b.paintSortFunction(d,e):void 0}),a.sort(this.__st)}return a},renderNode:function(a,b){this.setupMatrices(a),a instanceof Yb.Entity&&renderEntity(a)},paintTopCanvas:function(){var a=this._topCanvas.getContext("2d");a.clearRect(0,0,this._topCanvas.width,this._topCanvas.height);var b=this.areaPickingRect;b&&(a.beginPath(),a.lineStyle="#FFffff",a.rect(b.x,b.y,b.w,b.h),a.stroke()),this.renderLicense()},setBackgroundImage:function(a){if("string"==typeof a){var b=new Image;a.startsWith("data:image")||(b.crossOrigin="use-credentials"),b.src=a,this._backgroundImage=b;var c=this;b.onload=function(){c.dirtyNetwork()}}else this._backgroundImage=a,this.dirtyNetwork()},paintBottom:function(a){var b=a.getContext("2d");b.clearRect(0,0,a.width,a.height);var c=this._backgroundImage;c instanceof Image&&c.height&&b.drawImage(c,0,0,a.width,a.height)},initBufferNode:function(a){if(!this.bufferNodeMap[a._id]){var b={};this.bufferNodeMap[a._id]=b;var c,d,e,f=this._gl;for(c in a.attributes)e="index"===c?f.ELEMENT_ARRAY_BUFFER:f.ARRAY_BUFFER,d=a.attributes[c],b[c]=f.createBuffer(),f.bindBuffer(e,b[c]),f.bufferData(e,d.array,f.STATIC_DRAW)}},setBufferNodeData:function(a,b,c){var d=this.bufferNodeMap[a._id],f=a.attributes,g=f.index,h=f.position,i=f.normal,j=f.uv,k=f.color,l=(f.tangent,this._gl);if(a.elementsNeedUpdate&&g!==e&&(l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,d.index),l.bufferData(l.ELEMENT_ARRAY_BUFFER,g.array,b)),a.verticesNeedUpdate&&h!==e&&(l.bindBuffer(l.ARRAY_BUFFER,d.position),l.bufferData(l.ARRAY_BUFFER,h.array,b)),a.normalsNeedUpdate&&i!==e&&(l.bindBuffer(l.ARRAY_BUFFER,d.normal),l.bufferData(l.ARRAY_BUFFER,i.array,b)),a.uvsNeedUpdate&&j!==e&&(l.bindBuffer(l.ARRAY_BUFFER,d.uv),l.bufferData(l.ARRAY_BUFFER,j.array,b)),a.colorsNeedUpdate&&k!==e&&(l.bindBuffer(l.ARRAY_BUFFER,d.color),l.bufferData(l.ARRAY_BUFFER,k.array,b)),c)for(var m in a.attributes);},initGroupBuffer:function(a,b,c,d){var f=b.faces3,g=b.faces4,h=3*f.length+4*g.length,i=1*f.length+2*g.length,j=3*f.length+4*g.length,k=gc.getMaterial(a,b.materialIndex?b.materialIndex:0),l=k.needUV(),m=k.getNormalType(),n=k.isVertexColor();if(c.__vertexArray=new Float32Array(3*h),m&&(c.__normalArray=new Float32Array(3*h)),!d){n&&(c.__colorArray=new Float32Array(3*h)),l&&(c.__uvArray=new Float32Array(2*h),a.uv2s&&(c.__uv2Array=new Float32Array(2*h))),c.__faceArray=new Uint16Array(3*i),c.__lineArray=new Uint16Array(2*j);var o,p;if(b.numMorphTargets)for(c.__morphTargetsArrays=[],o=0,p=b.numMorphTargets;p>o;o++)c.__morphTargetsArrays.push(new Float32Array(3*h));if(b.numMorphNormals)for(c.__morphNormalsArrays=[],o=0,p=b.numMorphNormals;p>o;o++)c.__morphNormalsArrays.push(new Float32Array(3*h));if(c.__webglFaceCount=3*i,c.__webglLineCount=2*j,k.attributes){c.__webglCustomAttributesList===e&&(c.__webglCustomAttributesList=[]);for(var q in k.attributes){var r=k.attributes[q],s={};for(var t in r)s[t]=r[t];if(!s.__webglInitialized||s.createUniqueBuffers){s.__webglInitialized=!0;var u=1;"v2"===s.type?u=2:"v3"===s.type?u=3:"v4"===s.type?u=4:"c"===s.type&&(u=3),s.size=u,s.array=new Float32Array(h*u),s.buffer=_gl.createBuffer(),s.buffer.belongsToAttribute=q,r.needsUpdate=!0,s.__original=r}c.__webglCustomAttributesList.push(s)}}c.__inittedArrays=!0}},createLineBuffers:function(a){null==this.lineMap[a._id]&&(this.lineMap[a._id]={});var b=this.lineMap[a._id],c=this._gl;b.__webglVertexBuffer=c.createBuffer(),b.__webglColorBuffer=c.createBuffer(),b.__webglLineDistanceBuffer=c.createBuffer(),this.info.memory.geometries++},initLineBuffers:function(a){null==this.lineMap[a._id]&&(this.lineMap[a._id]={});var b=this.lineMap[a._id],c=a.vertices.length;b.__vertexArray=new Float32Array(3*c),b.__colorArray=new Float32Array(3*c),b.__lineDistanceArray=new Float32Array(1*c),b.__webglLineCount=c},createParticleBuffers:function(a){null==this.particleMap[a._id]&&(this.particleMap[a._id]={});var b=this.particleMap[a._id],c=this._gl;b.__webglVertexBuffer=c.createBuffer(),b.__webglColorBuffer=c.createBuffer(),b.__webglNormalBuffer=c.createBuffer(),this.info.memory.geometries++},initParticleBuffers:function(a){null==this.particleMap[a._id]&&(this.particleMap[a._id]={});var b=this.particleMap[a._id],c=a.vertices.length;b.__vertexArray=new Float32Array(3*c),b.__colorArray=new Float32Array(3*c),b.__normalArray=new Float32Array(3*c),b.__sortArray=[],b.__webglParticleCount=c},createGroupBuffer:function(a,b){var c=this._gl;b.__webglVertexBuffer=c.createBuffer(),b.__webglNormalBuffer=c.createBuffer(),b.__webglColorBuffer=c.createBuffer(),b.__webglUVBuffer=c.createBuffer(),b.__webglUV2Buffer=c.createBuffer(),b.__webglFaceBuffer=c.createBuffer(),b.__webglLineBuffer=c.createBuffer(),this.info.memory.geometries++},setRenderTarget:function(a){var b=a instanceof xc,c=this._gl;if(a&&!a.__webglFramebuffer){a.depthBuffer===e&&(a.depthBuffer=!0),a.stencilBuffer===e&&(a.stencilBuffer=!0),a.__webglTexture=c.createTexture(),this.info.memory.textures++;var d=sc.isPowerOfTwo,f=d(a.width)&&d(a.height),g=sc.paramToGL(a.format,c),h=sc.paramToGL(a.type,c);a.type==Yb.FloatType;var i=g;if(b){a.__webglFramebuffer=[],a.__webglRenderbuffer=[],c.bindTexture(c.TEXTURE_CUBE_MAP,a.__webglTexture),this.pm.setTextureParameters(c.TEXTURE_CUBE_MAP,a,f);for(var j=0;6>j;j++)a.__webglFramebuffer[j]=c.createFramebuffer(),a.__webglRenderbuffer[j]=c.createRenderbuffer(),c.texImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+j,0,i,a.width,a.height,0,g,h,null),this.setupFrameBuffer(a.__webglFramebuffer[j],a,c.TEXTURE_CUBE_MAP_POSITIVE_X+j),this.setupRenderBuffer(a.__webglRenderbuffer[j],a);f&&c.generateMipmap(c.TEXTURE_CUBE_MAP)}else a.__webglFramebuffer=c.createFramebuffer(),a.shareDepthFrom?a.__webglRenderbuffer=a.shareDepthFrom.__webglRenderbuffer:a.__webglRenderbuffer=c.createRenderbuffer(),c.bindTexture(c.TEXTURE_2D,a.__webglTexture),this.pm.setTextureParameters(c.TEXTURE_2D,a,f),c.texImage2D(c.TEXTURE_2D,0,i,a.width,a.height,0,g,h,null),this.setupFrameBuffer(a.__webglFramebuffer,a,c.TEXTURE_2D),a.shareDepthFrom?a.depthBuffer&&!a.stencilBuffer?c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_ATTACHMENT,c.RENDERBUFFER,a.__webglRenderbuffer):a.depthBuffer&&a.stencilBuffer&&c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_STENCIL_ATTACHMENT,c.RENDERBUFFER,a.__webglRenderbuffer):this.setupRenderBuffer(a.__webglRenderbuffer,a),f&&c.generateMipmap(c.TEXTURE_2D);b?c.bindTexture(c.TEXTURE_CUBE_MAP,null):c.bindTexture(c.TEXTURE_2D,null),c.bindRenderbuffer(c.RENDERBUFFER,null),c.bindFramebuffer(c.FRAMEBUFFER,null)}var k,l,m,n,o;a?(k=b?a.__webglFramebuffer[a.activeCubeFace]:a.__webglFramebuffer,l=a.width,m=a.height,n=0,o=0):(k=null,l=this._viewportWidth,m=this._viewportHeight,n=this._viewportX,o=this._viewportY),k!==this._currentFramebuffer&&(c.bindFramebuffer(c.FRAMEBUFFER,k),c.viewport(n,o,l,m),this._currentFramebuffer=k),this._currentWidth=l,this._currentHeight=m},setupFrameBuffer:function(a,b,c){var d=this._gl;d.bindFramebuffer(d.FRAMEBUFFER,a),d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,c,b.__webglTexture,0)},setupRenderBuffer:function(a,b){var c=this._gl;c.bindRenderbuffer(c.RENDERBUFFER,a),b.depthBuffer&&!b.stencilBuffer?(c.renderbufferStorage(c.RENDERBUFFER,c.DEPTH_COMPONENT16,b.width,b.height),c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_ATTACHMENT,c.RENDERBUFFER,a)):b.depthBuffer&&b.stencilBuffer?(c.renderbufferStorage(c.RENDERBUFFER,c.DEPTH_STENCIL,b.width,b.height),c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_STENCIL_ATTACHMENT,c.RENDERBUFFER,a)):c.renderbufferStorage(c.RENDERBUFFER,c.RGBA4,b.width,b.height)},setLineWidth:function(a){a!==this._oldLineWidth&&(this._gl.lineWidth&&this._gl.lineWidth(a),this._oldLineWidth=a)},setupMatrices:function(a,b){a.fixSize(b),a.updateWorldMatrix(),a._modelViewMatrix.multiplyMatrices(b.worldMatrixInverse,a.worldMatrix),a._normalMatrix.getNormalMatrix(a._modelViewMatrix)},setDefaultGLState:function(){var a=this._gl,b=new Yb.Color(this._clearColor);a.clearColor(b.r,b.g,b.b,this._clearAlpha),a.clearDepth(1),cc.isIE||a.clearStencil(0),a.enable(a.DEPTH_TEST),a.depthFunc(a.LEQUAL),a.frontFace(a.CCW),a.cullFace(a.BACK),a.enable(a.CULL_FACE),a.enable(a.BLEND),a.blendEquation(a.FUNC_ADD),a.blendFunc(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA)},clear:function(a,b,c){var d=this._gl,f=0;(a===e||a)&&(f|=d.COLOR_BUFFER_BIT),(b===e||b)&&(f|=d.DEPTH_BUFFER_BIT),(c===e||c)&&(f|=d.STENCIL_BUFFER_BIT),d.clear(f)},setGLFaces:function(a){var b=this._gl,c=a.side===Yb.DoubleSide,d=a.side===Yb.BackSide;this._oldDoubleSided!==c&&(c?b.disable(b.CULL_FACE):b.enable(b.CULL_FACE),this._oldDoubleSided=c),this._oldFlipSided!==d&&(d?b.frontFace(b.CW):b.frontFace(b.CCW),this._oldFlipSided=d)},getView:function(){return this._canvas},getRootView:function(){return this._rootView},setBlending:function(a,b,c,d){vc.setBlending(a,b,c,d,this)},setDepthTest:function(a){vc.setDepthTest(a,this)},setStencilTest:function(a){this._oldStencilTest!=a&&(a?this._gl.enable(this._gl.STENCIL_TEST):this._gl.disable(this._gl.STENCIL_TEST),this._oldStencilTest=a)},setDepthWrite:function(a){vc.setDepthWrite(a,this)},getLineWidthRange:function(){var a=this._gl;return a.getParameter(a.ALIASED_LINE_WIDTH_RANGE)},setTexture:function(a,b){this.pm.setTexture(a,b)},disableAttributes:function(){for(var a in this._enabledAttributes)this._enabledAttributes[a]&&(this._gl.disableVertexAttribArray(a),this._enabledAttributes[a]=!1)},enableAttribute:function(a){this._enabledAttributes[a]||(this._gl.enableVertexAttribArray(a),this._enabledAttributes[a]=!0)},adjustRootViewBounds:function(a,b){var c=this._rootView;c.style.width=a+"px",c.style.height=b+"px"},adjustCanvasBounds:function(a,b,c,d,e){a.width=b*this.devicePixelRatio,a.height=c*this.devicePixelRatio,a.style.margin="0px",a.style.padding="0px",a.style.width=b+"px",a.style.height=c+"px"},adjustBounds:function(a,b,c,d){var e=this.getView();if(this.adjustRootViewBounds(a,b,c,d),this.adjustCanvasBounds(e,a,b,c,d),this.adjustCanvasBounds(this._topCanvas,a,b,c,d),this.adjustCanvasBounds(this._bottomCanvas,a,b,c,d),this.adjustCallback(a,b,c,d),this.setViewport(0,0,e.width,e.height),this.autoUpdateCameraAspect&&0!==b){var f=this._camera;f.aspect=a/b,f.updateProjectionMatrix(),this._currentCamera=null}this.dirtyNetwork()},adjustCallback:function(){},setViewport:function(a,b,c,d){this._viewportX=a!==e?a:0,this._viewportY=b!==e?b:0,this._viewportWidth=c!==e?c:_canvas.width,this._viewportHeight=d!==e?d:_canvas.height,this._gl.viewport(this._viewportX,this._viewportY,this._viewportWidth,this._viewportHeight)},setShowAxis:function(a){this.showAxis!==a&&(this.showAxis=a,this.showAxis&&(this.helperBox.contains(this.axis)||this.helperBox.addByDescendant(this.axis)),this.axis._visible=a,this.dirtyNetwork())},setShowAxisText:function(a){this.axis.showAxisText(a),this.dirtyNetwork()},setAxisSize:function(a){this.axis.setSize(a)},onSelect:function(a){null!=this.onSelectFunction&&this.onSelectFunction(a)},setOnSelectFunction:function(a){this.onSelectFunction=a},isSelectable:function(a){return a.isSelectable()?this.selectableFunction?this.selectableFunction(a):!0:!1},setSelectableFunction:function(a){this.selectableFunction=a},setRenderSelectFunction:function(a){this.renderSelectFunction=a},renderSelect:function(a){return this.renderSelectFunction?this.renderSelectFunction(a):!0},renderAlarmBorder:function(a){return this.renderAlarmBorderFunction?this.renderAlarmBorderFunction(a):!0},selectable:function(a){return a.element.isVisible()&&this.isSelectable(a.element)&&this.getDataBox().getSelectionModel().isSelectable(a.element)},editable:function(a){var b=this.selectable(a);return b&&null!=this.editableFunction?this.editableFunction(a.element):b},getFirstSelectElement:function(a){if(null==a)return null;for(var b,c=0;c<a.length;){var d=a[c];if(this.selectable(d)){b=d.element;break}c++}return b},getFirstEditElement:function(a){if(null==a)return null;for(var b,c=0;c<a.length;){var d=a[c];if(this.editable(d)){b=d.element;break}c++}return b},toImageData:function(a,b,c,d){return this.dirtyNetwork(),this.render(),a=a||"PNG",a.toUpperCase(),"PNG"===a?dc.saveAsPNG(this.getView(),b,!1,c,d):"JPEG"===a?dc.saveAsJPEG(this.getView(),b,!1,c,d):"BMP"===a?dc.saveAsBMP(this.getView(),b,!1,c,d):void console.log("Not surport type "+a)},getPickingByEvent:function(a){var b=this._camera,c={},d=this.getView(),e=d.getBoundingClientRect(),f=a.clientX,g=a.clientY;a.touches&&a.touches.length&&(f=a.touches[0].pageX,g=a.touches[0].pageY);var h=(f-e.left)/e.width,i=(g-e.top)/e.height;c.x=2*h-1,c.y=2*-i+1;var j=new Yb.Vec3(c.x,c.y,.5);this.projector.unprojectVector(j,b);var k=null;if(b instanceof Yb.PerspectiveCamera)k=new Yb.Picking(b._position,j.sub(b._position).normalize(),b.up,null,null,this);else{var l=j.clone().sub(b._position),m=b.getTarget().clone().sub(b.p()).normalize(),n=m.multiplyScalar(l.clone().dot(m)),o=l.sub(n),p=(new $b).addVectors(b._position,o);k=new Yb.Picking(p,j.sub(p).normalize(),b.up,null,null,this)}return k},getElementsByMouseEvent:function(a,b,c){var d=this.getPickingByEvent(a),e=new kc;e.addAll(this.dataBox.getNodes()),e.addAll(this.dataBox.getBillboards()),c&&e.addAll(new kc(this.alarmBillboards));var f=d.intersectObjects(e.toArray(),!1,b);return f},getElementByScreenPoint:function(a,b,c){var d={},e=this.getView(),f=this._camera,g=e.getBoundingClientRect();a.x&&(c=b,b=a.y,a=a.x),a/=g.width,b/=g.height,d.x=2*a-1,d.y=2*-b+1;var h=new Yb.Vec3(d.x,d.y,.5);this.projector.unprojectVector(h,f);var i=new Yb.Picking(f._position,h.sub(f._position).normalize(),f.up,null,null,this),j=new kc;j.addAll(this.dataBox.getNodes()),j.addAll(this.dataBox.getBillboards());var k=i.intersectObjects(j.toArray(),!1,c);return k},getFirstElementByMouseEvent:function(a,b,c,d){var e=this.getElementsByMouseEvent(a,b,d);if(e.length)for(var f=0;f<e.length;f++){var g=e[f],h=g.element;if(null==c||c.call(null,h))return g}return null},getUnProjectVector:function(a){var b={},c=this.getView().getBoundingClientRect(),d=a.x/c.width,e=a.y/c.height;b.x=2*d-1,b.y=2*-e+1;var f=new Yb.Vec3(b.x,b.y,.5);return this.projector.unprojectVector(f,this._camera),f},getFrustumByBounding:function(a){var b=a,c=this.getUnProjectVector(new Zb(b.x,b.y)),d=this.getUnProjectVector(new Zb(b.x+b.w,b.y)),e=this.getUnProjectVector(new Zb(b.x,b.y+b.h)),f=this.getUnProjectVector(new Zb(b.x+b.w,b.y+b.h)),g=this.getNearFarPoints(c),h=this.getNearFarPoints(d),i=this.getNearFarPoints(e),j=this.getNearFarPoints(f),k=new Yb.math.Plane,l=new Yb.math.Plane,m=new Yb.math.Plane,n=new Yb.math.Plane,o=new Yb.math.Plane,p=new Yb.math.Plane;k.setFromCoplanarPoints(g[0],h[0],i[0]),l.setFromCoplanarPoints(g[0],g[1],h[0]),m.setFromCoplanarPoints(g[0],i[0],g[1]),n.setFromCoplanarPoints(h[0],h[1],j[0]),o.setFromCoplanarPoints(i[0],j[0],i[1]),p.setFromCoplanarPoints(g[1],i[1],h[1]);var q=new Yb.Frustum(k,l,m,n,o,p);return q.setPoints([g[0],h[0],i[0],j[0],g[1],h[1],i[1],j[1]]),q},getNearFarPoints:function(a){var b=this._camera,c=a.sub(b._position).normalize(),d=b.target.clone().sub(b._position),e=c.angleTo(d),f=b.getNear()/Math.acos(e),g=b.getFar()/Math.acos(e),h=b._position.clone().add(c.clone().multiplyScalar(f)),i=b._position.clone().add(c.clone().multiplyScalar(g));return[h,i]},getSpacePointOnPlane:function(a,b){var c={},d=this.getView(),e=this._camera,f=d.getBoundingClientRect(),g=a.clientX,h=a.clientY;a.touches&&a.touches.length&&(g=a.touches[0].pageX,h=a.touches[0].pageY);var i=(g-f.left)/f.width,j=(h-f.top)/f.height;c.x=2*i-1,c.y=2*-j+1;var k=new Yb.Vec3(c.x,c.y,.5);this.projector.unprojectVector(k,e);var l=e._position,m=k.sub(e._position).normalize(),n=new Yb.Ray(l,m),o=n.distanceToPlane(b);if(0>o||Math.abs(o)<Yb.Picking.prototype.precision)return null;var p=n.at(o);return p},getElementsByBounding:function(a,b,c){var d=new kc;d.addAll(this.dataBox.getNodes()),d.addAll(this.dataBox.getBillboards());var e,f=this.getFrustumByBounding(a),g=[],h=new $b,i=this._camera;return d.forEach(function(a){if(a instanceof Yb.Billboard){h.setFromMatrixPosition(a.worldMatrix);var b=a.material,d=b.alignment;e=new Yb.Plane(1,1),(d.x||d.y)&&(e.setPosition(d.x,d.y,0),e=Yb.Utils.transformElement(e,!0)),e.setPosition(h);var j=(new $b).getScaleFromMatrix(a.worldMatrix);e.setScale(j.x,j.y,1);var k=i.getTarget().clone(),l=i.getPosition();k.sub(l);var m=e.getPosition().clone();b&&b.vertical&&(k.y=0),m.sub(k),e.lookAt(m),e.updateWorldMatrix(!0),f.intersectsObjectAccurate(e,c)&&g.push({element:a})}else a instanceof Yb.Line?f.intersectsObjectAccurate(a,c)&&g.push({element:a}):f.intersectsObjectAccurate(a,c)&&g.push({element:a})}),g},getViewPosition:function(a){var b=new $b;b=this.projector.projectVector(a,this._camera,b),b.x=b.x/2+.5,b.y=-b.y/2+.5;var c={x:this._canvas.width*b.x/this.devicePixelRatio,y:this._canvas.height*b.y/this.devicePixelRatio,h:this._canvas.height};return c},setInteractions:function(a){var b,c,d=this._interactions;if(d)for(b=0;b<d.length;b++)c=d[b],c.tearDown();if(this._interactions=a,a)for(b=0;b<a.length;b++)c=a[b],c.setUp()},getDefaultInteraction:function(){if(this._interactions&&this._interactions.length>0)for(var a=0;a<this._interactions.length;a++){var b=this._interactions[a];if(b instanceof Yb.DefaultInteraction)return b}return null},getInteractions:function(){return this._interactions},fireInteractionEvent:function(a){this._interactionDispatcher.fire(a)},addInteractionListener:function(a,b,c){this._interactionDispatcher.add(a,b,c)},removeInteractionListener:function(a,b){this._interactionDispatcher.remove(a,b)},dispose:function(){},setRenderInterval:function(a){(sc.isNaN(a)||5>=a)&&(a=5),this._renderInterval=a},_computeNetworkBoundingBox:function(){function a(a,b){a.applyMatrix4(b),h.push(a)}var b,c,d,e,f=this.getDataBox().size(),g=this.getDataBox().getDatas(),h=[];for(b=0;f>b;b++)if(c=g.get(b),c instanceof Yb.Node){d=c.getBoundingBox(),e=c.worldMatrix;var i=d.min,j=d.max;a(i.clone(),e),a(j.clone(),e),a(new $b(i.x,i.y,j.z),e),a(new $b(i.x,j.y,i.z),e),a(new $b(j.x,i.y,i.z),e),a(new $b(j.x,j.y,i.z),e),a(new $b(j.x,i.y,j.z),e),a(new $b(i.x,j.y,j.z),e)}if(h.length<=1)return null;var k=new Yb.BoundingBox;return k.setFromPoints(h),k},getNetworkBoundingBox:function(){return null==this.boundingBox&&(this.boundingBox=this._computeNetworkBoundingBox()),this.boundingBox},getSelectStyle:function(a){return a.getSelectStyle()},setZoomStandard:function(a){this._zoomStandard=a},getZoomStandard:function(){return this._zoomStandard},zoom:function(a,b){b=b||this._zoomStandard;var c=this._camera;c.zoom(a,b)},zoomIn:function(a){this.zoom(.9,a)},zoomOut:function(a){this.zoom(1.1,a)},move:function(a,b){var c=(new mono.Vec3(-a,-b,0),this._camera.t()),d=this._camera.p();this._camera.translateX(-a),this._camera.translateY(-b);var e=this._camera.p();c.add(e.clone().sub(d)),this._camera.lookAt(c)},moveLeft:function(a){a=a||50,this.move(-a,0)},moveRight:function(a){a=a||50,this.move(a,0)},moveUp:function(a){a=a||30,this.move(0,a)},moveDown:function(a){a=a||30,this.move(0,-a)},zoomEstimateOverview:function(a){var b=this.getNetworkBoundingBox();if(null!=b){var c=b.center(),d=new $b(0,b.max.y-b.min.y,b.max.z-b.min.z),e=new $b(b.max.x-b.min.x,0,0,0),f=d.clone();f.length()<e.length()&&(f=e.clone());var g;if(a){var h=d.length();d.y=d.z*Math.tan(a/180*Math.PI),d.setLength(h)}g=(new $b).addVectors(c,d.multiplyScalar(.5));var i=this._camera.fov,j=(this._camera.aspect,f.length()/2/Math.tan(i*Math.PI/180));g.add(d.normalize().multiplyScalar(j)),this._camera.setPosition(g),this._camera.lookAt(c),this._overviewDistance=this._camera.getDistance()}}}),Yb.Network3DId=0,Yb.Network3D.GroupCache={_groupCounter:0};var yc=function(){function a(){if(k===w){var a=new $RenderObject;return v.push(a),w++,k++,a}return v[k++]}function b(){if(m===y){var a=new $RenderVertex;return x.push(a),y++,m++,a}return x[m++]}function c(){if(o===A){var a=new Yb.RenderFace3;return z.push(a),A++,o++,a}return z[o++]}function d(){if(p===C){var a=new Yb.RenderFace4;return B.push(a),C++,p++,a}return B[p++]}function f(){if(r===E){var a=new Yb.RenderLine;return D.push(a),E++,r++,a}return D[r++]}function g(){if(t===G){var a=new Yb.RenderableParticle;return F.push(a),G++,t++,a}return F[t++]}function h(a,b){return b.z-a.z}function i(a,b){var c=0,d=1,e=a.z+a.w,f=b.z+b.w,g=-a.z+a.w,h=-b.z+b.w;return e>=0&&f>=0&&g>=0&&h>=0?!0:0>e&&0>f||0>g&&0>h?!1:(0>e?c=Math.max(c,e/(e-f)):0>f&&(d=Math.min(d,e/(e-f))),0>g?c=Math.max(c,g/(g-h)):0>h&&(d=Math.min(d,g/(g-h))),c>d?!1:(a.lerp(b,c),b.lerp(a,1-d),!0))}var j,k,l,m,n,o,p,q,r,s,t,u,v=[],w=0,x=[],y=0,z=[],A=0,B=[],C=0,D=[],E=0,F=[],G=0,H={objects:[],sprites:[],lights:[],elements:[]},I=new Yb.Vec3,J=new Yb.Vec4,K=new Yb.BoundingBox(new Yb.Vec3(-1,-1,-1),new Yb.Vec3(1,1,1)),L=new Yb.BoundingBox,M=new Array(3),N=new Array(4),O=new Yb.Mat4,P=new Yb.Mat4,Q=new Yb.Mat4,R=new Yb.Mat3,S=new Yb.Mat3,T=new Yb.Vec3,U=new Yb.Frustum,V=new Yb.Vec4,W=new Yb.Vec4;this.projectVector=function(a,b,c){return b.worldMatrixInverse.getInverse(b.worldMatrix),P.multiplyMatrices(b.projectionMatrix,b.worldMatrixInverse),c===e?a.applyProjection(P):(c.copy(a),c.applyProjection(P))},this.unprojectVector=function(a,b){return b.projectionMatrixInverse.getInverse(b.projectionMatrix),P.multiplyMatrices(b.worldMatrix,b.projectionMatrixInverse),a.applyProjection(P)},this.pickingRay=function(a,b){a.z=-1;var c=new Yb.Vec3(a.x,a.y,1);return this.unprojectVector(a,b),this.unprojectVector(c,b),c.sub(a).normalize(),new Yb.Picking(a,c)};var X=function(b,c){k=0,H.objects.length=0,H.sprites.length=0,H.lights.length=0;var d=function(b){var c;c=b instanceof Yb.DataBox?b.getRoots():b.getChildren(),c=c.toList();for(var e=0,f=c.size();f>e;e++){var g=c.get(e);g.isSelected()&&g instanceof Yb.Node&&(c.add(g.createCanvasSelectionCube(),e),e++)}for(var e=0,f=c.size();f>e;e++){var g=c.get(e);g._visible!==!1&&(g instanceof Yb.Light?H.lights.push(g):g instanceof Yb.Entity||g instanceof Yb.Line?(g.frustumCulled===!1||U.intersectsObject(g)===!0)&&(j=a(),j.object=g,null!==g.renderDepth?j.z=g.renderDepth:(I.copy(g.worldMatrix.getPosition()),I.applyProjection(P),j.z=I.z),H.objects.push(j)):g instanceof Yb.Billboard||g instanceof Yb.Particle?(j=a(),j.object=g,null!==g.renderDepth?j.z=g.renderDepth:(I.copy(g.worldMatrix.getPosition()),I.applyProjection(P),j.z=I.z),H.sprites.push(j)):(j=a(),j.object=g,null!==g.renderDepth?j.z=g.renderDepth:(I.copy(g.worldMatrix.getPosition()),I.applyProjection(P),j.z=I.z),H.objects.push(j)),d(g))}};return d(b),c===!0&&H.objects.sort(h),H};this.projectDataBox=function(a,j,k,v){var w,y,z,A,B,C,D,E,F,G,I,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia=!1;o=0,p=0,r=0,t=0,H.elements.length=0;for(var ja=0;ja<a.getRoots().size();ja++){var ka=a.getRoots().get(ja);ka.updateWorldMatrix()}for(j.parent===e&&j.updateWorldMatrix(!0,!1),O.copy(j.worldMatrixInverse.getInverse(j.worldMatrix)),P.multiplyMatrices(j.projectionMatrix,O),S.getInverse(O),S.transpose(),U.setFromMatrix(P),H=X(a,k),w=0,y=H.objects.length;y>w;w++)if(I=H.objects[w].object,u=I.worldMatrix,m=0,I instanceof Yb.Entity){for(Y=I,Z=Y.vertices,$=Y.faces,ba=Y.uvs,R.getInverse(u),R.transpose(),ga=I.material instanceof Yb.ArrayMaterial,ha=ga===!0?I.material:null,z=0,A=Z.length;A>z;z++)l=b(),l.positionWorld.copy(Z[z]).applyMatrix4(u),l.positionScreen.copy(l.positionWorld).applyMatrix4(P),l.positionScreen.x/=l.positionScreen.w,l.positionScreen.y/=l.positionScreen.w,l.positionScreen.z/=l.positionScreen.w,l.visible=!(l.positionScreen.x<-1||l.positionScreen.x>1||l.positionScreen.y<-1||l.positionScreen.y>1||l.positionScreen.z<-1||l.positionScreen.z>1);for(B=0,C=$.length;C>B;B++){_=$[B];var la=ga===!0?ha.materials[_.materialIndex]:I.material;if(la!==e){var ma=la.side;if(_ instanceof Yb.Face3){if(ca=x[_.a],da=x[_.b],ea=x[_.c],M[0]=ca.positionScreen,M[1]=da.positionScreen,M[2]=ea.positionScreen,ca.visible!==!0&&da.visible!==!0&&ea.visible!==!0&&!K.isIntersectionBox(L.setFromPoints(M)))continue;if(ia=(ea.positionScreen.x-ca.positionScreen.x)*(da.positionScreen.y-ca.positionScreen.y)-(ea.positionScreen.y-ca.positionScreen.y)*(da.positionScreen.x-ca.positionScreen.x)<0,ma!==Yb.DoubleSide&&ia!==(ma===Yb.FrontSide))continue;n=c(),n.v1.copy(ca),n.v2.copy(da),n.v3.copy(ea)}else if(_ instanceof Yb.Face4){if(ca=x[_.a],da=x[_.b],ea=x[_.c],fa=x[_.d],N[0]=ca.positionScreen,N[1]=da.positionScreen,N[2]=ea.positionScreen,N[3]=fa.positionScreen,ca.visible!==!0&&da.visible!==!0&&ea.visible!==!0&&fa.visible!==!0&&!K.isIntersectionBox(L.setFromPoints(N)))continue;if(ia=(fa.positionScreen.x-ca.positionScreen.x)*(da.positionScreen.y-ca.positionScreen.y)-(fa.positionScreen.y-ca.positionScreen.y)*(da.positionScreen.x-ca.positionScreen.x)<0||(da.positionScreen.x-ea.positionScreen.x)*(fa.positionScreen.y-ea.positionScreen.y)-(da.positionScreen.y-ea.positionScreen.y)*(fa.positionScreen.x-ea.positionScreen.x)<0,ma!==Yb.DoubleSide&&ia!==(ma===Yb.FrontSide))continue;n=d(),n.v1.copy(ca),n.v2.copy(da),n.v3.copy(ea),n.v4.copy(fa)}for(n.normalModel.copy(_.normal),ia!==!1||ma!==Yb.BackSide&&ma!==Yb.DoubleSide||n.normalModel.negate(),n.normalModel.applyMatrix3(R).normalize(),n.normalModelView.copy(n.normalModel).applyMatrix3(S),n.centroidModel.copy(_.centroid).applyMatrix4(u),aa=_.vertexNormals,D=0,E=aa.length;E>D;D++){var na=n.vertexNormalsModel[D];na.copy(aa[D]),ia!==!1||ma!==Yb.BackSide&&ma!==Yb.DoubleSide||na.negate(),na.applyMatrix3(R).normalize();var oa=n.vertexNormalsModelView[D];oa.copy(na).applyMatrix3(S)}n.vertexNormalsLength=aa.length;var pa=ba[B];for(F=0,G=pa.length;G>F;F++)n.uvs[0][F]=pa[F];n.color=_.color,n.material=la,T.copy(n.centroidModel).applyProjection(P),n.z=T.z,H.elements.push(n)}}}else if(I instanceof Yb.Line){Q.multiplyMatrices(P,u),Z=I.vertices,ca=b(),ca.positionScreen.copy(Z[0]).applyMatrix4(Q);var qa=I.type===Yb.LinePieces?2:1;for(z=1,A=Z.length;A>z;z++)ca=b(),ca.positionScreen.copy(Z[z]).applyMatrix4(Q),(z+1)%qa>0||(da=x[m-2],V.copy(ca.positionScreen),W.copy(da.positionScreen),i(V,W)===!0&&(V.multiplyScalar(1/V.w),W.multiplyScalar(1/W.w),q=f(),q.v1.positionScreen.copy(V),q.v2.positionScreen.copy(W),q.z=Math.max(V.z,W.z),q.material=I.material,H.elements.push(q)))}for(w=0,y=H.sprites.length;y>w;w++)I=H.sprites[w].object,u=I.worldMatrix,I instanceof Yb.Particle&&(J.set(u.elements[12],u.elements[13],u.elements[14],1),J.applyMatrix4(P),J.z/=J.w,J.z>0&&J.z<1&&(s=g(),s.object=I,s.x=J.x/J.w,s.y=J.y/J.w,s.z=J.z,s.rotation=I.rotation.z,s.scale.x=I.scale.x*Math.abs(s.x-(J.x+j.projectionMatrix.elements[0])/(J.w+j.projectionMatrix.elements[12])),s.scale.y=I.scale.y*Math.abs(s.y-(J.y+j.projectionMatrix.elements[5])/(J.w+j.projectionMatrix.elements[13])),s.material=I.material,H.elements.push(s)));return v===!0&&H.elements.sort(h),H}};Yb.Projector=yc,Yb.Billboard=function(a){null!=a&&null!=a.id?this._id=a.id:this._id=a,Yb.Element.call(this,this._id),this.material=new Yb.BillboardMaterial,this.rotation3d=this._rotation,this.rotation=0,this.vertices=[new $b(-.5,-.5,0),new $b(.5,-.5,0),new $b(.5,.5,0),new $b(-.5,.5,0)]},Yb.extend(Yb.Billboard,Yb.Element,{constructor:Yb.Billboard,className:"TGL.Billboard",updateMatrix:function(){this.matrix.setPosition(this._position),this.rotation=this._rotation.z,this.rotation3d.set(0,0,this.rotation),this.matrix.setRotationFromEuler(this.rotation3d),(1!==this._scale.x||1!==this._scale.y)&&this.matrix.scale(this._scale),this.matrixWorldNeedsUpdate=!0},clone:function(a){return a===e&&(a=new Yb.Billboard(this.material)),Yb.Element.prototype.clone.call(this,a),a},setMaterialStyle:function(a,b){var c=this.material.clone();a=a.substr(a.indexOf(".")+1),this._A97(c,a,b);var d=c.getUniqueCode(),e=Zc.getMaterial(d);null!=e?(Zc.unUseMaterial(this.material),this.material=e,Zc.useMaterial(e)):(Zc.unUseMaterial(this.material),Zc.setMaterial(d,c),this.material=c)}}),Yb.ShaderSprite={sprite:{vertexShader:["uniform int useScreenCoordinates;","uniform int sizeAttenuation;","uniform vec3 screenPosition;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 scale;","uniform vec2 alignment;","uniform vec2 uvOffset;","uniform vec2 uvScale;","uniform bool vertical;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uvOffset + uv * uvScale;","vec2 alignedPosition = (position + alignment) * scale;","vec2 rotatedPosition;","rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","vec4 finalPosition;","vec4 upPosition;","vec4 rightPosition = vec4(scale.x,0.0,0.0,1.0);","finalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","if(vertical){","upPosition =  modelViewMatrix * vec4( 0.0, 1.0, 0.0, 1.0 ) - finalPosition;","normalize(upPosition);","}","if(vertical){","finalPosition.xyz += (rotatedPosition.x * rightPosition.xyz / scale.x) + (rotatedPosition.y * upPosition.xyz / scale.y);","}else{","finalPosition.xy += rotatedPosition;","}","finalPosition = projectionMatrix * finalPosition;","gl_Position = finalPosition;","}"].join("\n"),fragmentShader:["uniform vec3 color;","uniform int useMap;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","void main() {","if(useMap > 0){","vec4 texture = texture2D( map, vUV );","if ( texture.a < alphaTest ) discard;","gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","} else {","gl_FragColor = vec4( color, 1.0);","}","if ( fogType > 0 ) {","float depth = gl_FragCoord.z / gl_FragCoord.w;","float fogFactor = 0.0;","if ( fogType == 1 ) {","fogFactor = smoothstep( fogNear, fogFar, depth );","} else {","const float LOG2 = 1.442695;","float fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );","fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","}","gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","}","}"].join("\n")}},Yb.BillboardRenderer=function(){function a(a,c){var d=b.createProgram(),e=b.createShader(b.FRAGMENT_SHADER),f=b.createShader(b.VERTEX_SHADER),g="precision "+c+" float;\n";return b.shaderSource(e,g+a.fragmentShader),b.shaderSource(f,g+a.vertexShader),b.compileShader(e),b.compileShader(f),b.attachShader(d,e),b.attachShader(d,f),b.linkProgram(d),d}var b,c,d,e={},f=(new Yb.Billboard,new Yb.BillboardMaterial({color:255}));this.init=function(f){this.enable=!0,f._currentGroupHash=null,b=f._gl,c=f,d=f.getPrecision(),e.vertices=new Float32Array(16),e.faces=new Uint16Array(6),e.lines=new Uint16Array(8);var g=0;e.vertices[g++]=-.5,e.vertices[g++]=-.5,e.vertices[g++]=0,e.vertices[g++]=0,e.vertices[g++]=.5,e.vertices[g++]=-.5,e.vertices[g++]=1,e.vertices[g++]=0,e.vertices[g++]=.5,e.vertices[g++]=.5,e.vertices[g++]=1,e.vertices[g++]=1,e.vertices[g++]=-.5,e.vertices[g++]=.5,e.vertices[g++]=0,e.vertices[g++]=1,g=0,e.faces[g++]=0,e.faces[g++]=1,e.faces[g++]=2,e.faces[g++]=0,e.faces[g++]=2,e.faces[g++]=3,g=0,
e.lines[g++]=0,e.lines[g++]=1,e.lines[g++]=0,e.lines[g++]=3,e.lines[g++]=1,e.lines[g++]=2,e.lines[g++]=2,e.lines[g++]=3,e.vertexBuffer=b.createBuffer(),e.elementBuffer=b.createBuffer(),b.bindBuffer(b.ARRAY_BUFFER,e.vertexBuffer),b.bufferData(b.ARRAY_BUFFER,e.vertices,b.STATIC_DRAW),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,e.elementBuffer),b.bufferData(b.ELEMENT_ARRAY_BUFFER,e.faces,b.STATIC_DRAW),e.program=a(Yb.ShaderSprite.sprite,d),e.attributes={},e.uniforms={},e.attributes.position=b.getAttribLocation(e.program,"position"),e.attributes.uv=b.getAttribLocation(e.program,"uv"),e.uniforms.uvOffset=b.getUniformLocation(e.program,"uvOffset"),e.uniforms.uvScale=b.getUniformLocation(e.program,"uvScale"),e.uniforms.rotation=b.getUniformLocation(e.program,"rotation"),e.uniforms.scale=b.getUniformLocation(e.program,"scale"),e.uniforms.alignment=b.getUniformLocation(e.program,"alignment"),e.uniforms.color=b.getUniformLocation(e.program,"color"),e.uniforms.useMap=b.getUniformLocation(e.program,"useMap"),e.uniforms.map=b.getUniformLocation(e.program,"map"),e.uniforms.opacity=b.getUniformLocation(e.program,"opacity"),e.uniforms.vertical=b.getUniformLocation(e.program,"vertical"),e.uniforms.useScreenCoordinates=b.getUniformLocation(e.program,"useScreenCoordinates"),e.uniforms.sizeAttenuation=b.getUniformLocation(e.program,"sizeAttenuation"),e.uniforms.screenPosition=b.getUniformLocation(e.program,"screenPosition"),e.uniforms.modelViewMatrix=b.getUniformLocation(e.program,"modelViewMatrix"),e.uniforms.projectionMatrix=b.getUniformLocation(e.program,"projectionMatrix"),e.uniforms.fogType=b.getUniformLocation(e.program,"fogType"),e.uniforms.fogDensity=b.getUniformLocation(e.program,"fogDensity"),e.uniforms.fogNear=b.getUniformLocation(e.program,"fogNear"),e.uniforms.fogFar=b.getUniformLocation(e.program,"fogFar"),e.uniforms.fogColor=b.getUniformLocation(e.program,"fogColor"),e.uniforms.alphaTest=b.getUniformLocation(e.program,"alphaTest"),this.inited=!0},this.render=function(a,d,g,h,i){this.inited||this.init(a);var j=new kc(d),k=j.size();if(k){var l=e.attributes,m=e.uniforms,n=!1;a.pm.currentProgram!=e.program&&(b.useProgram(e.program),a.pm.currentProgram=e.program,a._currentGroupHash=null,b.enableVertexAttribArray(l.position),b.enableVertexAttribArray(l.uv),b.disable(b.CULL_FACE),b.bindBuffer(b.ARRAY_BUFFER,e.vertexBuffer),b.vertexAttribPointer(l.position,2,b.FLOAT,!1,16,0),b.vertexAttribPointer(l.uv,2,b.FLOAT,!1,16,8),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,e.elementBuffer),this.enable=!0,n=!0),b.uniformMatrix4fv(m.projectionMatrix,!1,g.projectionMatrix.elements),n&&b.activeTexture(b.TEXTURE0),n&&b.uniform1i(m.map,0);var o=0,p=0,q=a.fog;q?(b.uniform3f(m.fogColor,q.color.r,q.color.g,q.color.b),q instanceof Yb.Fog?(b.uniform1f(m.fogNear,q.near),b.uniform1f(m.fogFar,q.far),b.uniform1i(m.fogType,1),o=1,p=1):q instanceof Yb.FogExp2&&(b.uniform1f(m.fogDensity,q.density),b.uniform1i(m.fogType,2),o=2,p=2)):(o=0,p=0);var r,s,t;for(r=0;k>r;r++)s=j.get(r),t=s.material,c.isVisible(s)&&0!==t.opacity&&(s.updateWorldMatrix(!0,!1),t.useScreenCoordinates?s.z=-s.position.z:(s._modelViewMatrix=new Yb.Mat4,s._modelViewMatrix.multiplyMatrices(g.worldMatrixInverse,s.worldMatrix),s.z=-s._modelViewMatrix.elements[14]));for(r=0;k>r;r++)s=j.get(r),this.renderBillboard(s,m,a,o,p),s._selected&&(s._scale.x=1.01*s._scale.x,s._scale.y=1.01*s._scale.y,s.material.clone(f),f.map=null,f.color.set(65280),this.renderBillboard(s,m,a,o,p,f),s._scale.x=s._scale.x/1.01,s._scale.y=s._scale.y/1.01)}},this.disable=function(){if(this.enable){var a=e.attributes;e.uniforms;b.disableVertexAttribArray(a.position),b.disableVertexAttribArray(a.uv),c._oldDoubleSided||b.enable(b.CULL_FACE),c._oldBlending===Yb.NoBlending&&b.disable(b.BLEND),vc.setDepthWrite(!0,c),this.enable=!1,this.lastMaterialId=null,c.pm.currentProgram=null}},this.renderBillboard=function(a,d,f,g,h,i){var j,k,l,m=[],n=new $b;if(j=i?i:a.material,c.isVisible(a)&&0!==j.opacity){var o=j.id,p=!(o==this.lastMaterialId);p&&b.uniform1f(d.alphaTest,j.alphaTest),p&&(j.useScreenCoordinates===!0?(b.uniform1i(d.useScreenCoordinates,1),b.uniform3f(d.screenPosition,(a.position.x*c.devicePixelRatio-halfViewportWidth)/halfViewportWidth,(halfViewportHeight-a.position.y*c.devicePixelRatio)/halfViewportHeight,Math.max(0,Math.min(1,a.position.z)))):(b.uniform1i(d.useScreenCoordinates,0),b.uniform1i(d.sizeAttenuation,j.sizeAttenuation?1:0))),j.useScreenCoordinates===!0?(m[0]=c.devicePixelRatio,m[1]=c.devicePixelRatio):(b.uniformMatrix4fv(d.modelViewMatrix,!1,a._modelViewMatrix.elements),m[0]=1,m[1]=1),l=f.fog&&j.fog?h:0,g!==l&&(b.uniform1i(d.fogType,l),g=l),k=1/(j.scaleByViewport?viewportHeight:1),n.getScaleFromMatrix(a.worldMatrix),m[0]*=k*n.x,m[1]*=k*n.y,p&&(b.uniform2f(d.uvScale,j.repeat.x,j.repeat.y),b.uniform2f(d.uvOffset,j.offset.x,j.offset.y),b.uniform2f(d.alignment,j.alignment.x,j.alignment.y),b.uniform1f(d.opacity,j.opacity),b.uniform1i(d.vertical,j.vertical),b.uniform3f(d.color,j.color.r,j.color.g,j.color.b),b.uniform1f(d.rotation,a.rotation)),b.uniform2fv(d.scale,m),p&&(c.setBlending(j.blending,j.blendEquation,j.blendSrc,j.blendDst),c.setDepthTest(j.depthTest),c.setDepthWrite(j.depthMask)),j.map&&j.map._image&&c.pm.addTexture(j.map),p=p||j.map&&c.pm.needsUpdateTexture(j.map),j.map&&j.map._image&&j.map._image.width?(p&&c.setTexture(j.map,0),p&&b.uniform1i(d.useMap,1)):p&&b.uniform1i(d.useMap,0),i?(p&&b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,e.elementBuffer),p&&b.bufferData(b.ELEMENT_ARRAY_BUFFER,e.lines,b.STATIC_DRAW),p&&b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,e.elementBuffer),b.drawElements(b.LINES,8,b.UNSIGNED_SHORT,0)):(p&&b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,e.elementBuffer),p&&b.bufferData(b.ELEMENT_ARRAY_BUFFER,e.faces,b.STATIC_DRAW),p&&b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,e.elementBuffer),b.drawElements(b.TRIANGLES,6,b.UNSIGNED_SHORT,0)),this.lastMaterialId=j.id}}};var wc=function(a,b,c){this.width=a,this.height=b,c=c||{},this.wrapS=c.wrapS!==e?c.wrapS:Yb.ClampToEdgeWrapping,this.wrapT=c.wrapT!==e?c.wrapT:Yb.ClampToEdgeWrapping,this.magFilter=c.magFilter!==e?c.magFilter:Yb.LinearFilter,this.minFilter=c.minFilter!==e?c.minFilter:Yb.LinearMipMapLinearFilter,this.anisotropy=c.anisotropy!==e?c.anisotropy:1,this.offset=new Yb.Vec2(0,0),this.repeat=new Yb.Vec2(1,1),this.format=c.format!==e?c.format:Yb.RGBAFormat,this.type=c.type!==e?c.type:Yb.UnsignedByteType,this.depthBuffer=c.depthBuffer!==e?c.depthBuffer:!0,this.stencilBuffer=c.stencilBuffer!==e?c.stencilBuffer:!0,this.generateMipmaps=!0,this.shareDepthFrom=null};wc.prototype={constructor:wc,clone:function(){var a=new wc(this.width,this.height);return a.wrapS=this.wrapS,a.wrapT=this.wrapT,a.magFilter=this.magFilter,a.minFilter=this.minFilter,a.anisotropy=this.anisotropy,a.offset.copy(this.offset),a.repeat.copy(this.repeat),a.format=this.format,a.type=this.type,a.depthBuffer=this.depthBuffer,a.stencilBuffer=this.stencilBuffer,a.generateMipmaps=this.generateMipmaps,a.shareDepthFrom=this.shareDepthFrom,a},getUniqueCode:function(){return this._id},dispose:function(){this.dispatchEvent({type:"dispose"})}};var xc=function(a,b,c){wc.call(this,a,b,c),this.activeCubeFace=0};Yb.extend(xc,wc,{});var zc,Ac="l=1.0\ntype=1\ngis=0\n3d=1\nstart=2015-10-21\nend=2016-10-31\nnote=This license applies to the evaluation version of TWaver. The License is limited to noncommercial use. Noncommercial use relates only to educational, research, personal or evaluation purposes. Any other use is commercial use. You may not use the Software in connection with any business activities.And You are not permitted to modify the software or attempt to decipher, decompile, disassemble or reverse engineer this Software.\nsignature=69b57c46f9801b1ad4c0ec28e49fafd90df6bd4f63e42b019ff240736150c9a2070b4f2c7c1b2d94063a1402d811e757aa6aced3defef6ccafdf6f28b0dd4bc4e5ee9b033b9d9a12629329c76b5e22d608e561c8caa0dfeafb1cd9d1b1c988edf1b7a8d1d9520555f87e20626de98388c1bd30c0079ebacc6229b199648b774538a5abd45055658bcdf472770f1b7574d6ee17c0ec273ec2bcdd3053b24e7f547e93dbd4a180f9cd937541164297564dfa4d28ea4709ca165cbd515262976cc230459a86a7790be4f696b49f5b14e03b30abd94ca1f034c4376e1fad9ab7252c3e2930d2ac9383e84182683ac47ee29e109388c8165ea8001a0526dac643ac073edbb5038f065378dd77d69b22fc9716cc0a8c2adf4e090de8ebe24724d3a14ff73855193182c01cf7e5344e4400d9303f3e9a8d762862cab6ac4d8f37af59c1dcde69eb92a1b7b1a3493d63c1404b6f0c5c00975e9ab12daa68d7f4d3fe3b6863a72618ec0c6a6f6cb77a8476fd904cefcff326eaf2328c49b05c35898418ca2b974359d639f399a9a6f4cb14caf3af590753e67c52d44fed018fcb607a042ebecb4b6bb7d43ed364f76fbe47644c125e9cd97f393029e9cee49a910ae672041ec026ec55709c02662cccb62818dcd33e96a4c59d13995752636ae6ca2a7f961421adabf1277986ed03bdec170e1d00cb4c3668fb65bcc087996a7174163f63179507fc710fbf8697b7e8ddc5bbe5d54177a4dbe073ed1d90e6b842b42f04e6fd69f26a7dc3227f0189c21424b556ccdaa8d2b1829c35039670ea7663a8088220fffe99a530863fdff1ca18a468edd6adcc5a680e13c5a432096977d5b157ff5848f6bf464ca5dbf670f2cb090c3cbc4ccd8f8355b91505502e215b97646b86",Bc=0xdeadbeefcafe,Cc=15715070==(16777215&Bc);Cc&&"Microsoft Internet Explorer"==navigator.appName?(q.prototype.am=t,zc=30):Cc&&"Netscape"!=navigator.appName?(q.prototype.am=s,zc=26):(q.prototype.am=v,zc=28),q.prototype.DB=zc,q.prototype.DM=(1<<zc)-1,q.prototype.DV=1<<zc;var Dc=52;q.prototype.FV=Math.pow(2,Dc),q.prototype.F1=Dc-zc,q.prototype.F2=2*zc-Dc;var Ec,Fc,Gc="0123456789abcdefghijklmnopqrstuvwxyz",Hc=new Array;for(Ec="0".charCodeAt(0),Fc=0;9>=Fc;++Fc)Hc[Ec++]=Fc;for(Ec="a".charCodeAt(0),Fc=10;36>Fc;++Fc)Hc[Ec++]=Fc;for(Ec="A".charCodeAt(0),Fc=10;36>Fc;++Fc)Hc[Ec++]=Fc;S.prototype.convert=T,S.prototype.revert=U,S.prototype.reduce=V,S.prototype.mulTo=W,S.prototype.sqrTo=X,Z.prototype.convert=$,Z.prototype.revert=_,Z.prototype.reduce=aa,Z.prototype.mulTo=ca,Z.prototype.sqrTo=ba,q.prototype.copyTo=y,q.prototype.fromInt=z,q.prototype.fromString=B,q.prototype.clamp=C,q.prototype.dlShiftTo=J,q.prototype.drShiftTo=K,q.prototype.lShiftTo=L,q.prototype.rShiftTo=M,q.prototype.subTo=N,q.prototype.multiplyTo=O,q.prototype.squareTo=P,q.prototype.divRemTo=Q,q.prototype.invDigit=Y,q.prototype.isEven=da,q.prototype.exp=ea,q.prototype.toString=D,q.prototype.negate=E,q.prototype.abs=F,q.prototype.compareTo=G,q.prototype.bitLength=I,q.prototype.mod=R,q.prototype.modPowInt=fa,q.ZERO=A(0),q.ONE=A(1),Ya.prototype.convert=Za,Ya.prototype.revert=Za,Ya.prototype.mulTo=$a,Ya.prototype.sqrTo=_a,db.prototype.convert=eb,db.prototype.revert=fb,db.prototype.reduce=gb,db.prototype.mulTo=ib,db.prototype.sqrTo=hb;var Ic=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],Jc=(1<<26)/Ic[Ic.length-1];q.prototype.chunkSize=ka,q.prototype.toRadix=ma,q.prototype.fromRadix=na,q.prototype.fromNumber=oa,q.prototype.bitwiseTo=ta,q.prototype.changeBit=Ka,q.prototype.addTo=Oa,q.prototype.dMultiply=Wa,q.prototype.dAddOffset=Xa,q.prototype.multiplyLowerTo=bb,q.prototype.multiplyUpperTo=cb,q.prototype.modInt=lb,q.prototype.millerRabin=ob,q.prototype.clone=ga,q.prototype.intValue=ha,q.prototype.byteValue=ia,q.prototype.shortValue=ja,q.prototype.signum=la,q.prototype.toByteArray=pa,q.prototype.equals=qa,q.prototype.min=ra,q.prototype.max=sa,q.prototype.and=va,q.prototype.or=xa,q.prototype.xor=za,q.prototype.andNot=Ba,q.prototype.not=Ca,q.prototype.shiftLeft=Da,q.prototype.shiftRight=Ea,q.prototype.getLowestSetBit=Ga,q.prototype.bitCount=Ia,q.prototype.testBit=Ja,q.prototype.setBit=La,q.prototype.clearBit=Ma,q.prototype.flipBit=Na,q.prototype.add=Pa,q.prototype.subtract=Qa,q.prototype.multiply=Ra,q.prototype.divide=Ta,q.prototype.remainder=Ua,q.prototype.divideAndRemainder=Va,q.prototype.modPow=jb,q.prototype.modInverse=mb,q.prototype.pow=ab,q.prototype.gcd=kb,q.prototype.isProbablePrime=nb,q.prototype.square=Sa,pb.prototype.init=qb,pb.prototype.next=rb;var Kc,Lc,Mc,Nc=256;if(null==Lc){Lc=new Array,Mc=0;var Oc;if("Netscape"==navigator.appName&&navigator.appVersion<"5"&&d.crypto){var Pc=d.crypto.random(32);for(Oc=0;Oc<Pc.length;++Oc)Lc[Mc++]=255&Pc.charCodeAt(Oc)}for(;Nc>Mc;)Oc=Math.floor(65536*Math.random()),Lc[Mc++]=Oc>>>8,Lc[Mc++]=255&Oc;Mc=0,ub()}xb.prototype.nextBytes=wb;Ab.prototype.doPublic=Cb,Ab.prototype.setPublic=Bb,Ab.prototype.encrypt=Db,Ab.prototype.doPrivate=Hb,Ab.prototype.setPrivate=Fb,Ab.prototype.setPrivateEx=Gb,Ab.prototype.decrypt=Ib;var Qc=function(){Rc.v(Ac)},Rc={},Sc="6a384c1259bdb5e731ec96b3174683f48a2c56a85e52e7a5bb20b58711ce50c1a294bd5e1d1752e766085e9ae94bae6d217c25dbb5fcdb86a8a9a7e180fa066723d00fcb85fcf7c9d29f8cc8859f53244a49c0bc30dcc45156daf8843ce1d24fe8ebc9a3c186bb26e9d0714041aef160304c1db8cc5728cf4acb39d29755f319",Tc="10001",Uc="61a921483dfa8f24e26204ace4d990b965d11e5bef5d8a5e768ebc5853a6bdd94b02369a3165207460fb91001d3fd83fbe69c6e51b8e40c8ae8a4e30a7c539dca98b44858bdc0b76f25af6803d4d13dacd9fa1a28f66cf561fa36309d4239a2cf50fe20ef0e99e01fc8701090f0685a524f411e00ca91f877d3b49d2d0052f9",Vc="b881f568eb43e7a60c256a8a90e08b7c7638fd66ce3cded9005c72e283ca4f2b8601e2edc687d7f898348a05723b515d9edeb626af7b499a56ddaea93b0c2047";Rc.cross=function(a){if(a){for(var b="",c=0;c<a.length;)c+1<a.length?(b+=a[c+1],b+=a[c]):b+=a[c],c+=2;return b}return null},Rc.reverse=function(a){if(a){for(var b="",c=a.length;c>0;c--)b+=a[c-1];return b}return null},Rc.v=function(a){if(a){var b=Rc;if(b.start=null,b.beginDate=null,b.end=null,b.endDate=null,b.gis=null,b["3D"]=null,b["3d"]=null,b.l=null,b.__li__=null,a.indexOf("signature=")>0){var c=a.split("signature="),d=c[0],e=c[1],f=new Ab;f.setPublic(Sc,Tc);for(var g=e,h=g.length,i=256,j=0,k="",l="";h>j;)k=g.substr(j,i),l+=f.decrypt(k),j+=i;if(l===d)return b.i(a),!0}}return!1},Rc.i=function(a){var b=Rc;b.__li__=a;var c,d,f,g,h,i=a.split("\n");for(c=0;c<i.length;c++)d=i[c],h=d.split("="),f=h[0],g=h[1],b[f]=g;b.start!=e&&(b.beginDate=new Date(Date.parse(b.start.replace(/-/g,"/")))),b.end!=e&&(b.endDate=new Date(Date.parse(b.end.replace(/-/g,"/"))));var j=b.gis;j!=e&&(j=parseInt(j)),j&&(b._isPermissionGIS=!0);var k=b["3D"]||b["3d"];k!=e&&(k=parseInt(k)),k&&(b._isPermission3D=!0),b.l!=e&&(b.version=b.l)};var Wc=function(a){return a.__li__!==e&&a._isPermission3D},Xc=function(a){if(!Wc(a))return!0;var b=new Date;return null!=a.beginDate&&a.beginDate.getTime()-b.getTime()>=0||null!=a.endDate&&a.endDate.getTime()-b.getTime()<=0};Rc.$z=function(a){var b=new Ab;b.setPublic(Sc,Tc);for(var c=a,d=c.length,e=256,f=0,g="",h="";d>f;)g=c.substr(f,e),h+=b.decrypt(g),f+=e;return h},Rc.twm=function(a){var b=Rc,c=b.$z("4cd18113d0c7046bfe51f7a3fbd41c2b7cf14dd785d6ea7cec9da17710d3acfb8ce0cb9cf10839f4bd51e88819de19cdc0db09278584396156fcb65abe0353ac49d01326b30efa0ea98a07da9f8ceeb7572fc1b37b5965ba6103ccba4913b62e36e49425c6ff21a2f008830c59cff8f29058769f858c8a9f0bab3eaea7fb8a9e"),d=this.type,f=this.markText,g=b.$z("648be38cd61c870e95ffc1ea0676af40736c1365015abc326e891a4de67b4de3d4b05da70b9aebedc83ec26ecf71eb74c72f42f6d9a4be2d507d2f67d2860b7b66e3ba1d565e15923f2db335ff922eef17c01b59818b583d5656412d6cc9d9ba70001c2c88e3efd492c6b13a07fda5f325b333138a2036f4696542ec137cc341");a[g]=b.__li__;var h=a;if(h._xyz=null,"3"!==d||Xc(Rc)||f!==e){a.DEBUG&&(console.log("license: "+Rc.__li__),console.log("license Type : "+d),console.log("beginDate: "+Rc.beginDate),console.log("endDate: "+Rc.endDate),console.log("mark: "+f)),a.__liLabel==e&&(a.__liLabel=document.createElement("div")),b.startDate===e&&(b.startDate=new Date);var i=(new Date).getTime()-b.startDate.getTime(),j="2"===d?7200:300;if(!(1e3*j>i)){var k=Xc(b)&&i>1e3*j,l=f;if(k?l=b.$z("0dd629dbd0ce341ecdd447e35ddc3135a0b46916f7571a687f38ae665cf0ae095fee885e14329caa75112d8787508da17285b0897845d8ccae73e6a2727dd19f1ca335fe139d0e60d240f9ececc78f81c2c5667f51aeed4135b9c4bb436b8acb7cd418eeeb404bc4f3bcdedb481ac0edff7644435ce2b9f2bda78c892bd56d73"):"2"!=d||l!==e&&""!=l?"1"!=d||f||(l=c):l=b.$z("644d54bf9c59afbd8a742a9e7e2731f23f149ccb7f04c3547548c50ac2d77faea108b55f1f6261e99869f1c06b84e8abdefdf45b5170048531421f3d528123972ba2f03d70f37c33f1341dc12f986e0089e42bab517e2a05b455d12d90991bbba9bc45c715a81943062ea5fa5408c8b1b9270d260cc5a67b38ecc4178ce512fc"),l!==e){var m=h.__liLabel;m.innerHTML=l,m.type=d,m.mark=f,m.expired=k,h._xyz=m,k&&(h.getView().style.opacity=.1)}}}},sc.validateLicense(Ac),Yb.Material=function(a){Yb.PropertyChangeDispatcher.call(this),this.id=Yb.MaterialIdCount++,this.type="basic",this.shaderID="",this.uniforms=e,this.vertexShader="",this.fragmentShader="",this.alarmColor=null,this.name="",this.side=Yb.FrontSide,this.fog=!0,this.normalType=e,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=Yb.NoColors,this.blendMode=Yb.NormalBlending,this.blendSrc=Yb.SrcAlphaFactor,this.blendDst=Yb.OneMinusSrcAlphaFactor,this.blendEquation=Yb.AddEquation,this.depthTest=!0,this.depthMask=!0,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.alphaTest=0,this.transparent=!1,this.opacity=1,this.visible=!0,this.needsUpdate=!0,this.setValues(a),this.useCount=0,this.styleMap={},this.offset=new Zb(0,0),this.repeat=new Zb(1,1),this.gradient={},this.gradientType=1,this.gradientCenter=new Zb(.5,.5),this.outline=0},Yb.extend(Yb.Material,Yb.PropertyChangeDispatcher,{generateKey:function(){},setMap:function(a,b){if(null==b&&(b="map"),this[b]!==a){var c=this[b];this[b]=a,this.firePropertyChange(b,c,a),this.onMapChanged(c,a)}},handleTextureChange:function(a){if("image"===a.property){this.firePropertyChange("needsUpdate",!1,!0)}else"disposed"===a.property},onPropertyChange:function(a,b,c){},onMapChanged:function(a,b){},setColor:function(a){if(this.color!==a){var b=this.color.clone();a instanceof Yb.Color?this.color.copy(a):this.color.set(a),this.firePropertyChange("color",b,a)}},setPropertyValue:function(a,b){if(this[a]!==b){var c=this[a];if(c instanceof Yb.Color)null!=b&&(c=c.clone(),b instanceof Yb.Color?this[a].copy(b):this[a].set(b));else if("gradient"==a){var d={};for(var e in b)b[e]instanceof Yb.Color?d[e]=b[e]:d[e]=new Yb.Color(b[e]);this[a]=d}else this[a]=b;this._uniqueCode=null,this.firePropertyChange(a,c,b)}},isTextureStyle:function(a){return"terrain"===this._type?a.startsWith("texture1.")||a.startsWith("texture2.")||a.startsWith("textureb.")||a.startsWith("texturen.")||a.startsWith("texturebp."):a.startsWith("texture.")||a.startsWith("lightmap")||a.startsWith("envmap")||a.startsWith("normalmap")||a.startsWith("specularmap")},setNeedsUpdate:function(a){},getShaderID:function(){return this instanceof Yb.BasicMaterial&&(this.shaderID="basic"),this.shaderID},setupMaterialShader:function(){var a=this.getShaderID(),b=Yb.ShaderLib[a];b&&(this.uniforms=Yb.UniformsUtils.clone(b.uniforms),this.vertexShader=b.vertexShader,this.fragmentShader=b.fragmentShader)},refreshUniforms:function(a,b){this.refreshUniformsCommon(a,b),this.refreshUniformsSpecific(a,b)},loadCameraPosition:function(a,b,c){if((this instanceof Yb.ShaderMaterial||this instanceof Yb.PhongMaterial||this.envMap||"phong"===this._type)&&null!=a.cameraPosition){var d=b.worldMatrix.getPosition();c.uniform3f(a.cameraPosition,d.x,d.y,d.z)}},loadViewMatrix:function(a,b,c){("lambert"===this.type||"phong"===this.type||material.skinning)&&null!==a.viewMatrix&&c.uniformMatrix4fv(p_uniforms.viewMatrix,!1,b.worldMatrixInverse.elements)},refreshUniformsSpecific:function(a){},refreshUniformsCommon:function(a){var b=this.uniforms,c=this;b.opacity.value=c.opacity;var d=sc.getObjectCount(this.gradient)>0;if(a?b.diffuse.value.copyGammaToLinear(this.alarmColor?this.alarmColor:this.color):b.diffuse.value=this.alarmColor?this.alarmColor:this.color,d){var f=[],g=[];for(var h in this.gradient)f.push(h);f.sort();for(var i=0;i<f.length;i++)g.push(this.gradient[f[i]]);b.gradientColor.value=g,b.gradientStop.value=f,b.gradientType.value=this.gradientType}b.map.value=c.map,b.lightMap.value=c.lightMap,b.specularMap.value=c.specularMap,c.bumpMap&&(b.bumpMap.value=c.bumpMap,b.bumpScale.value=c.bumpScale),c.normalMap&&"phong"===c._type&&(b.normalMap.value=c.normalMap,b.normalScale.value.copy(c.normalScale));var j;if(c.map?j=c.map:c.specularMap?j=c.specularMap:c.normalMap&&"phong"===c._type?j=c.normalMap:c.bumpMap&&"phong"===c._type&&(j=c.bumpMap),j!=e){var k=this.offset,l=this.repeat;b.offsetRepeat.value.set(k.x,k.y,l.x,l.y),b.flipX.value=j.flipX?1:0,b.mapLoaded.value=1,j._image&&!j._image.loaded&&b.offsetRepeat.value.set(0,0,1,1)}b.envMap.value=c.envMap,b.flipEnvMap.value=1,a?b.reflectivity.value=c.reflectRatio*c.reflectRatio:b.reflectivity.value=c.reflectRatio,b.refractionRatio.value=c.refractionRatio,b.combine.value=c.combine,b.useRefract.value=c.envMap&&c.envMap.mapping instanceof Yb.CubeRefractionMapping},loadGeneralUniforms:function(){},getNormalType:function(){var a=this&&this.normalType!==e&&this.normalType===Yb.NormalTypeSmooth;return a?Yb.SmoothShading:Yb.FlatShading},isVertexColor:function(){return this.vertexColors?this.vertexColors:!1},needUV:function(){return this.map||this.lightMap||this.bumpMap||this.normalMap||this.specularMap?!0:!0},setValues:function(a){if(a!==e)for(var b in a){var c=a[b];if(c!==e){if(b in this){var d=this[b];d instanceof Yb.Color&&c instanceof Yb.Color?d.copy(c):d instanceof Yb.Color?d.set(c):d instanceof Yb.Vec3&&c instanceof Yb.Vec3?d.copy(c):this[b]=c}}else console.warn("TGL.Material: '"+b+"' parameter is undefined.")}},isCustomAttributesNeedUpdate:function(){if(!this.attributes)return!1;for(var a in this.attributes)if(this.attributes[a].needsUpdate)return!0;return!1},clearCustomAttributes:function(){if(this.attributes)for(var a in this.attributes)this.attributes[a].needsUpdate=!1},clone:function(a){return a===e&&(a=new Yb.Material),a.name=this.name,a.side=this.side,a.blendMode=this.blendMode,a.blendSrc=this.blendSrc,a.blendDst=this.blendDst,a.blendEquation=this.blendEquation,a.depthTest=this.depthTest,a.depthMask=this.depthMask,a.polygonOffset=this.polygonOffset,a.polygonOffsetFactor=this.polygonOffsetFactor,a.polygonOffsetUnits=this.polygonOffsetUnits,a.alphaTest=this.alphaTest,a.transparent=this.transparent,a.opacity=this.opacity,a.visible=this.visible,a.normalType=this.normalType,a.wireframe=this.wireframe,a.wireframeLinecap=this.wireframeLinecap,a.wireframeLinejoin=this.wireframeLinejoin,a.wireframeLinewidth=this.wireframeLinewidth,a.gradient=this.gradient,a.gradientType=this.gradientType,a.outline=this.outline,a},dispose:function(){this.firePropertyChange("disposed",!1,!0)}}),Yb.MaterialIdCount=0,Yb.EntityMaterial=function(a){Yb.Material.call(this),this._type="basic",this.color=new Yb.Color(16777215),this.map=null,this.ambient=new Yb.Color(16777215),this.emissive=new Yb.Color(0),this.specular=new Yb.Color(1118481),this.specularStrength=1,this.shininess=30,this.wrapAround=!1,this.wrapRGB=new Yb.Vec3(1,1,1),this.lightMap=null,this.specularMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new Yb.Vec2(1,1),this.envMap=null,this.combine=Yb.MultiplyOperation,this.reflectRatio=1,this.refractionRatio=.98,this.fog=!0,this.shading=Yb.SmoothShading,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.metal=!1,this.perPixel=!0,this.map1=null,this.map2=null,this.blendMap=null,this.detailMap=null,this.specularMap=null,this.blendRange=new Zb(0,1),this.setValues(a)},Yb.extend(Yb.EntityMaterial,Yb.Material,{getShaderID:function(){return this.getType()},getUniqueCode:function(){if(null!=this._uniqueCode)return this._uniqueCode;var a=this._type+" "+this.color.r+this.color.g+this.color.b+" "+this.ambient.getUniqueCode()+" "+this.emissive.getUniqueCode()+this.specular.getUniqueCode()+" "+this.transparent+" "+this.visible+" "+this.opacity+" "+this.depthTest+this.depthMask+" "+this.side+" "+this.wireframe+" "+this.wireframeLinewidth+" "+this.polygonOffset+" "+this.polygonOffsetFactor+" "+this.polygonOffsetUnits+" "+this.overdraw+" "+this.shininess+" "+this.metal+" "+this.specularStrength;if(this.alphaTest&&(a+=this.alphaTest),a+=" "+this.normalType+" ",a+=this.repeat.x+" "+this.repeat.y+this.offset.x+" "+this.offset.y,a+=" "+this.blendRange.x+" "+this.blendRange.y,a+=" "+this.normalScale.x+" "+this.normalScale.y,a+=" "+this.reflectRatio,this.map&&(a+=this.map.getUniqueCode()),this.map1&&(a+=this.map1.getUniqueCode()),this.map2&&(a+=this.map2.getUniqueCode()),this.blendMap&&(a+=this.blendMap.getUniqueCode()),this.normalMap&&(a+=this.normalMap.getUniqueCode()),this.lightMap&&(a+=this.lightMap.getUniqueCode()),this.envMap&&(a+=this.envMap.getUniqueCode()),this.specularMap&&(a+=this.specularMap.getUniqueCode()),this.alarmColor&&(a+=" "+this.alarmColor.getUniqueCode()),this.gradient)for(var b in this.gradient)a+=" "+b+":"+this.gradient[b].getUniqueCode();return a+=" "+this.gradientType,a+=" "+this.outline,a+=this.combine,this._uniqueCode=a,a},loadViewMatrix:function(a,b,c){("lambert"===this._type||"phong"===this._type||material.skinning)&&null!==a.viewMatrix&&c.uniformMatrix4fv(p_uniforms.viewMatrix,!1,b.worldMatrixInverse.elements)},onMapChanged:function(a,b){if(Yb.TexturePool.useTexture(b),Yb.TexturePool.unUseTexture(a),b){var c=b.getUniqueCode();null==Yb.TexturePool.getTexture(c)&&Yb.TexturePool.setTexture(c,b)}},setType:function(a){if(this._type!==a){var b=this._type;this._type=a,this.firePropertyChange("type",b,a),this.onTypeChanged(b,a)}},onTypeChanged:function(){},getType:function(){return this._type},setStyle:function(a,b){if(null!=a){null==this.styleMap&&(this.styleMap={});var c=this.styleMap[a];return null==b?delete this.styleMap[a]:this.styleMap[a]=b,this.firePropertyChange(Yb.Styles.PREFIX_STYLE+a,c,b),this.onStyleChanged(a,c,b),this}},getStyle:function(a,b){null==b&&(b=!0);var c;return null!=this.styleMap&&(c=this.styleMap[a]),null==c&&b&&(c=Yb.Styles.getStyle(a)),c},clone:function(a){return a=a||new Yb.EntityMaterial,Yb.Material.prototype.clone.call(this,a),a._type=this._type,a.color.copy(this.color),a.setMap(this.map,"map"),a.setMap(this.map1,"map1"),a.setMap(this.map2,"map2"),a.setMap(this.blendMap,"blendMap"),a.setMap(this.normalMap,"normalMap"),a.setMap(this.specularMap,"specularMap"),a.setMap(this.envMap,"envMap"),a.ambient.copy(this.ambient),a.emissive.copy(this.emissive),a.specular.copy(this.specular),a.shininess=this.shininess,a.metal=this.metal,a.perPixel=this.perPixel,a.wrapAround=this.wrapAround,a.wrapRGB.copy(this.wrapRGB),a.setMap(this.lightMap,"lightMap"),a.bumpMap=this.bumpMap,a.bumpScale=this.bumpScale,a.normalScale.copy(this.normalScale),a.combine=this.combine,a.reflectRatio=this.reflectRatio,a.refractionRatio=this.refractionRatio,a.fog=this.fog,a.shading=this.shading,a.skinning=this.skinning,a.morphTargets=this.morphTargets,a.morphNormals=this.morphNormals,a.specularStrength=this.specularStrength,a.offset.copy(this.offset),a.repeat.copy(this.repeat),a.blendRange.copy(this.blendRange),a},refreshUniformsSpecific:function(a){var b=this.uniforms;"lambert"===this._type?(a?(b.ambient.value.copyGammaToLinear(this.ambient),b.emissive.value.copyGammaToLinear(this.emissive)):(b.ambient.value=this.ambient,b.emissive.value=this.emissive),this.wrapAround&&b.wrapRGB.value.copy(this.wrapRGB)):"phong"===this._type&&(b.shininess.value=this.shininess,a?(b.ambient.value.copyGammaToLinear(this.alarmColor?this.alarmColor:this.ambient),b.emissive.value.copyGammaToLinear(this.emissive),b.specular.value.copyGammaToLinear(this.specular)):(b.ambient.value=this.alarmColor?this.alarmColor:this.ambient,b.emissive.value=this.emissive,b.specular.value=this.specular),b.uspecularStrength.value=this.specularStrength,this.wrapAround&&b.wrapRGB.value.copy(this.wrapRGB))},refreshUniformsCommon:function(a){if("terrain"===this._type){var b=this.uniforms;b.enableDiffuse1.value=this.map?1:0,b.tDiffuse1.value=this.map,b.enableDiffuse2.value=this.map1?1:0,b.tDiffuse2.value=this.map1,b.enableDiffuse3.value=this.map2?1:0,b.tDiffuse3.value=this.map2,b.enableDisplacement.value=this.blendMap?1:0,b.tDisplacement.value=this.blendMap,b.uRepeatOverlay.value=this.repeat,null==this.blendRangeArray&&(this.blendRangeArray=[0,1]),this.blendRangeArray[0]=this.blendRange.x,this.blendRangeArray[1]=this.blendRange.y,b.blendRange.value=this.blendRangeArray}else if("outline"===this._type){var b=this.uniforms;b.diffuse.value=this.color,b.outline_offset.value=this.outline}else Yb.Material.prototype.refreshUniformsCommon.call(this,a)}}),Yb.BlurMaterial=function(){Yb.Material.call(this),this.orientation=0,this.blurAmount=5,this.blurScale=1,this.blurStrength=1,this.useBlur=1,this.texelSize=new Zb(512,512),this.blurGlobalAlpha=1},Yb.extend(Yb.BlurMaterial,Yb.Material,{refreshUniformsCommon:function(a){var b=this.uniforms;b.map.value=this.map,b.orientation.value=this.orientation,b.blurAmount.value=this.blurAmount,b.blurScale.value=this.blurScale,b.blurStrength.value=this.blurStrength,b.useBlur.value=this.useBlur,b.texelSize.value=this.texelSize,b.blurGlobalAlpha.value=this.blurGlobalAlpha},getShaderID:function(){return"blur"}}),Yb.DeferredMaterial=function(a){a=a||{},Yb.Material.call(this,a),this.linearDepth=30,this.isNormal=a.isNormal!==e?a.isNormal:0},Yb.extend(Yb.DeferredMaterial,Yb.Material,{getShaderID:function(){return"deferred"},refreshUniformsCommon:function(a){var b=this.uniforms;b.linearDepth.value=this.linearDepth,b.isNormal.value=this.isNormal}}),Yb.SSAOMaterial=function(a){Yb.Material.call(this),this.map1=null,this.map2=null,this.occluderBias=.05,this.samplingRadius=20,this.attenuation=new Zb(1,.02),this.texelSize=new Zb(1/512,1/512)},Yb.extend(Yb.SSAOMaterial,Yb.Material,{getShaderID:function(){return"ssao"},refreshUniformsCommon:function(a){var b=this.uniforms;b.map0.value=this.map,b.map1.value=this.map1,b.map2.value=this.map2,b.occluderBias.value=this.occluderBias,b.samplingRadius.value=this.samplingRadius,b.attenuation.value=this.attenuation,b.texelSize.value=this.texelSize}}),Yb.BasicMaterial=function(a){Yb.Material.call(this),this._type="basic",this.color=new Yb.Color(16777215),this.map=null,this.setValues(a),this.offset=new Zb(0,0),this.repeat=new Zb(1,1)},Yb.extend(Yb.BasicMaterial,Yb.Material,{getShaderID:function(){return"basic"},clone:function(){var a=new Yb.BasicMaterial;return Yb.Material.prototype.clone.call(this,a),a.color.copy(this.color),a.map=this.map,a},getUniqueCode:function(){var a=this.color.r+this.color.g+this.color.b+" "+this.transparent+" "+this.visible+" "+this.opacity+" "+this.depthTest+this.depthMask+" "+this.side+" "+this.wireframe+" "+this.wireframeLinewidth;return a+=this.repeat.x+" "+this.repeat.y+this.offset.x+" "+this.offset.y,this.map&&(a+=this.map.getUniqueCode()),a}}),Yb.LambertMaterial=function(a){Yb.Material.call(this),this._type="basic",this.color=new Yb.Color(16777215),this.ambient=new Yb.Color(16777215),this.emissive=new Yb.Color(0),this.wrapAround=!1,this.wrapRGB=new Yb.Vec3(1,1,1),this.map=null,this.lightMap=null,this.specularMap=null,this.envMap=null,this.combine=Yb.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=Yb.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=Yb.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(a)},Yb.extend(Yb.LambertMaterial,Yb.Material,{clone:function(){var a=new Yb.LambertMaterial;return Yb.Material.prototype.clone.call(this,a),a.color.copy(this.color),a.ambient.copy(this.ambient),a.emissive.copy(this.emissive),a.wrapAround=this.wrapAround,a.wrapRGB.copy(this.wrapRGB),a.map=this.map,a.lightMap=this.lightMap,a.specularMap=this.specularMap,a.envMap=this.envMap,a.combine=this.combine,a.reflectivity=this.reflectivity,a.refractionRatio=this.refractionRatio,a.fog=this.fog,
a.shading=this.shading,a.wireframe=this.wireframe,a.wireframeLinewidth=this.wireframeLinewidth,a.wireframeLinecap=this.wireframeLinecap,a.wireframeLinejoin=this.wireframeLinejoin,a.vertexColors=this.vertexColors,a.skinning=this.skinning,a.morphTargets=this.morphTargets,a.morphNormals=this.morphNormals,a},getShaderID:function(){return"lambert"},refreshUniformsSpecific:function(a){var b=this.uniforms;a?(b.ambient.value.copyGammaToLinear(this.ambient),b.emissive.value.copyGammaToLinear(this.emissive)):(b.ambient.value=this.ambient,b.emissive.value=this.emissive),this.wrapAround&&b.wrapRGB.value.copy(this.wrapRGB)}}),Yb.PhongMaterial=function(a){Yb.Material.call(this),this._type="basic",this.color=new Yb.Color(16777215),this.ambient=new Yb.Color(16777215),this.emissive=new Yb.Color(0),this.specular=new Yb.Color(1118481),this.shininess=30,this.metal=!1,this.perPixel=!0,this.wrapAround=!1,this.wrapRGB=new Yb.Vec3(1,1,1),this.map=null,this.lightMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new Yb.Vec2(1,1),this.specularMap=null,this.envMap=null,this.combine=Yb.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=Yb.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=Yb.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(a),this.offset=new Zb(0,0),this.repeat=new Zb(1,1)},Yb.extend(Yb.PhongMaterial,Yb.Material,{getUniqueCode:function(){var a="phong "+this.color.r+this.color.g+this.color.b+" "+this.transparent+" "+this.visible+" "+this.opacity+" "+this.depthTest+this.depthMask+" "+this.side+" "+this.wireframe+" "+this.wireframeLinewidth;return a+=this.repeat.x+" "+this.repeat.y+this.offset.x+" "+this.offset.y,this.map&&(a+=this.map.getUniqueCode()),a},clone:function(){var a=new Yb.PhongMaterial;return Yb.Material.prototype.clone.call(this,a),a.color.copy(this.color),a.ambient.copy(this.ambient),a.emissive.copy(this.emissive),a.specular.copy(this.specular),a.shininess=this.shininess,a.metal=this.metal,a.perPixel=this.perPixel,a.wrapAround=this.wrapAround,a.wrapRGB.copy(this.wrapRGB),a.map=this.map,a.lightMap=this.lightMap,a.bumpMap=this.bumpMap,a.bumpScale=this.bumpScale,a.normalMap=this.normalMap,a.normalScale.copy(this.normalScale),a.specularMap=this.specularMap,a.envMap=this.envMap,a.combine=this.combine,a.reflectivity=this.reflectivity,a.refractionRatio=this.refractionRatio,a.fog=this.fog,a.shading=this.shading,a.wireframe=this.wireframe,a.wireframeLinewidth=this.wireframeLinewidth,a.wireframeLinecap=this.wireframeLinecap,a.wireframeLinejoin=this.wireframeLinejoin,a.vertexColors=this.vertexColors,a.skinning=this.skinning,a.morphTargets=this.morphTargets,a.morphNormals=this.morphNormals,a},getShaderID:function(){return"phong"},refreshUniformsSpecific:function(a){var b=this.uniforms;b.shininess.value=this.shininess,a?(b.ambient.value.copyGammaToLinear(this.ambient),b.emissive.value.copyGammaToLinear(this.emissive),b.specular.value.copyGammaToLinear(this.specular)):(b.ambient.value=this.ambient,b.emissive.value=this.emissive,b.specular.value=this.specular),this.wrapAround&&b.wrapRGB.value.copy(material.wrapRGB)}}),Yb.LineMaterial=function(a){Yb.Material.call(this),this.color=new Yb.Color(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.dashed=!0,this.scale=1,this.dashSize=3,this.gapSize=1,this.vertexColors=!1,this.fog=!0,this.setValues(a)},Yb.extend(Yb.LineMaterial,Yb.Material,{getUniqueCode:function(){return this.color.getUniqueCode+" "+this.linewidth+" "+this.dashed},clone:function(){var a=new Yb.LineMaterial;return Yb.Material.prototype.clone.call(this,a),a.color.copy(this.color),a.linewidth=this.linewidth,a.linecap=this.linecap,a.linejoin=this.linejoin,a.dashed=this.dashed,a.scale=this.scale,a.dashSize=this.dashSize,a.gapSize=this.gapSize,a.vertexColors=this.vertexColors,a.fog=this.fog,a},getShaderID:function(){return this.dashed?"dashed":"basic"},refreshUniforms:function(a){Jb(this.uniforms,this),this.dashed&&Kb(this.uniforms,this)}}),Yb.ArrayMaterial=function(a){this.materials=a||[]},Yb.extend(Yb.ArrayMaterial,Object,{clone:function(){for(var a=new Yb.ArrayMaterial,b=0;b<this.materials.length;b++){var c=this.materials[b],d=this.materials.indexOf(c);null!=a.materials[d]?a.materials.push(a.materials[d]):a.materials.push(c.clone())}return a}}),Yb.BillboardMaterial=function(a){Yb.Material.call(this),this.alignment=Yb.BillboardAlignment.center.clone(),this.fog=!1,this.color=new Yb.Color(16777215),this.map=null,this.rotation=0,this.fog=!1,this.offset=new Yb.Vec2(0,0),this.repeat=new Yb.Vec2(1,1),this.transparent=!0,this.setValues(a),this.depthMask=!0,this.vertical=!1,this.alphaTest=0},Yb.extend(Yb.BillboardMaterial,Yb.Material,{clone:function(a){return a=a?a:new Yb.BillboardMaterial,Yb.Material.prototype.clone.call(this,a),a.alignment.copy(this.alignment),a.color.copy(this.color),a.map=this.map,a.rotation=this.rotation,a.offset.copy(this.offset),a.repeat.copy(this.repeat),a.fog=this.fog,a.vertical=this.vertical,a.transparent=this.transparent,a.alphaTest=this.alphaTest,a},getUniqueCode:function(){var a="Billboard "+this.color.r+this.color.g+this.color.b+" "+this.transparent+" "+this.visible+" "+this.opacity+" "+this.depthTest+this.depthMask+" "+this.side+" "+this.wireframe+" "+this.wireframeLinewidth;return a+=this.vertical+" "+this.alphaTest+" "+this.alignment.x+" "+this.alignment.y,a+=this.repeat.x+" "+this.repeat.y,a+=this.offset.x+" "+this.offset.y,this.map&&(a+=this.map.getUniqueCode()),a}}),Yb.BillboardAlignment={},Yb.BillboardAlignment.topLeft=new Yb.Vec2(.5,-.5),Yb.BillboardAlignment.topCenter=new Yb.Vec2(0,-.5),Yb.BillboardAlignment.topRight=new Yb.Vec2(-.5,-.5),Yb.BillboardAlignment.centerLeft=new Yb.Vec2(.5,0),Yb.BillboardAlignment.center=new Yb.Vec2(0,0),Yb.BillboardAlignment.centerRight=new Yb.Vec2(-.5,0),Yb.BillboardAlignment.bottomLeft=new Yb.Vec2(.5,.5),Yb.BillboardAlignment.bottomCenter=new Yb.Vec2(0,.5),Yb.BillboardAlignment.bottomRight=new Yb.Vec2(-.5,.5);var Yc=function(a){Yb.Material.call(this),this.fragmentShader="void main() {}",this.vertexShader="void main() {}",this.uniforms={},this.defines={},this.attributes=null,this.shaderID=a.shaderID||"depth",this._type="shader",this.shading=Yb.SmoothShading,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.vertexColors=Yb.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName="position",this.setValues(a)};Yb.ShaderMaterial=Yc,Yb.extend(Yb.ShaderMaterial,Yb.Material,{clone:function(){var a=new Yb.ShaderMaterial;return Yb.Material.prototype.clone.call(this,a),a.fragmentShader=this.fragmentShader,a.vertexShader=this.vertexShader,a.uniforms=Yb.UniformsUtils.clone(this.uniforms),a.attributes=this.attributes,a.defines=this.defines,a.shading=this.shading,a.wireframe=this.wireframe,a.wireframeLinewidth=this.wireframeLinewidth,a.fog=this.fog,a.lights=this.lights,a.vertexColors=this.vertexColors,a.skinning=this.skinning,a.morphTargets=this.morphTargets,a.morphNormals=this.morphNormals,a},needUV:function(){return!0},getShaderID:function(){return this.shaderID},refreshUniformsCommon:function(a,b){}}),Yb.TransformGizmoMaterial=function(a){Yb.BasicMaterial.call(this),this.depthTest=!1,this.depthMask=!1,this.side=Yb.DoubleSide,this.transparent=!0,this.setValues(a)},Yb.extend(Yb.TransformGizmoMaterial,Yb.BasicMaterial,{getUniqueCode:function(){var a=this.id+"TransformGizmo "+this.color.r+this.color.g+this.color.b+" "+this.transparent+" "+this.visible+" "+this.opacity+" "+this.depthTest+this.depthMask+" "+this.side+" "+this.wireframe+" "+this.wireframeLinewidth;return this.map&&(a+=this.map.getUniqueCode()),a}});var Zc={pools:{},useTimes:{},size:0,getMaterial:function(a){return Zc.pools[a]},setMaterial:function(a,b){Zc.size++,Zc.pools[a]=b},useMaterial:function(a){if(a){var b=a.id,c=Zc.useTimes[b]||0;c++,Zc.useTimes[b]=c}},unUseMaterial:function(a){if(a){var b=a.id,c=Zc.useTimes[b]||0;if(c--,Zc.useTimes[b]=c,0>=c){var d=a.getUniqueCode();delete Zc.pools[d],Zc.size--,a.dispose()}}}};Yb.MaterialPool=Zc,Zc.DefaultMaterial=new Yb.EntityMaterial,Zc.TestMaterial=new Yb.EntityMaterial,Zc.DefaultBillBoardMaterial=new Yb.BillboardMaterial,Zc.DefaultLineMaterial=new Yb.LineMaterial,Yb.ParticleMaterial=function(a){Yb.Material.call(this),this.color=new Yb.Color(16777215),this.map=null,this.size=2,this.sizeAttenuation=!1,this.vertexColors=!1,this.fog=!0,this.setValues(a)},Yb.extend(Yb.ParticleMaterial,Yb.Material,{clone:function(){var a=new Yb.ParticleMaterial;return Yb.Material.prototype.clone.call(this,a),a.color.copy(this.color),a.map=this.map,a.size=this.size,a.sizeAttenuation=this.sizeAttenuation,a.vertexColors=this.vertexColors,a.fog=this.fog,a},getShaderID:function(){return this.shaderID="particle_basic",this.shaderID},refreshUniforms:function(a){Lb(this.uniforms,this)}}),Yb.Light=function(a,b){Yb.Element.call(this,b),this.color=new Yb.Color(a),this.ambient=new Yb.Color,this.diffuse=new Yb.Color,this.specular=new Yb.Color,this.castShadow=!1,this.onlyShadow=!1},Yb.extend(Yb.Light,Yb.Element,{__accessor:["color","ambient","diffuse","specular"],constructor:Yb.Light,className:"TGL.Light",setCastShadow:function(a){this.castShadow=a},setOnlyShadow:function(a){this.onlyShadow=a},refreshShadowUniforms:function(a,b){var c=this;return a.shadowMatrix&&c.castShadow&&(c instanceof Yb.SpotLight||c instanceof Yb.DirectionalLight&&!c.shadowCascade)?(a.shadowMap.value[b]=c.shadowMap,a.shadowMapSize.value[b]=c.shadowMapSize,a.shadowMatrix.value[b]=c.shadowMatrix,a.shadowDarkness.value[b]=c.shadowDarkness,a.shadowBias.value[b]=c.shadowBias,!0):void 0},refreshUniformsPointShadow:function(a,b){var c=this;return a.pShadowMap&&c.castShadow&&c instanceof Yb.PointLight?(a.pShadowMap.value[b]=c.shadowMap,a.pShadowMapSize.value[b]=c.shadowMapSize,a.pShadowDarkness.value[b]=c.shadowDarkness||.5,a.pPosition.value[b]=c.getPosition(),!0):void 0}}),Yb.PointLight=function(a,b,c,d){if(1===arguments.length&&arguments[0]instanceof Object&&!Array.isArray(arguments[0])){var f=arguments[0];a=f.hex,b=f.intensity,c=f.intensity,d=f.id}Yb.Light.call(this,a,d),this.position=new Yb.Vec3(0,0,0),this.intensity=b!==e?b:1,this.distance=c!==e?c:0,this.shadowCameraNear=10,this.shadowCameraFar=1e4,this.shadowMapWidth=512,this.shadowMapHeight=512},Yb.extend(Yb.PointLight,Yb.Light,{constructor:Yb.PointLight,className:"TGL.PointLight",__accessor:["intensity","distance"]}),Yb.SpotLight=function(a,b,c,d,f){Yb.Light.call(this,a),this._position=new Yb.Vec3(0,1,0),this.target=new Yb.Element,this.intensity=b!==e?b:1,this.distance=c!==e?c:0,this.angle=d!==e?d:Math.PI/2,this.exponent=f!==e?f:10,this.shadowCameraNear=100,this.shadowCameraFar=5e3,this.shadowCameraFov=50,this.shadowCameraVisible=!1,this.shadowBias=0,this.shadowDarkness=.5,this.shadowMapWidth=512,this.shadowMapHeight=512,this.shadowMap=null,this.shadowMapSize=null,this.shadowCamera=null,this.shadowMatrix=null},Yb.extend(Yb.SpotLight,Yb.Light,{__accessor:["color","ambient","diffuse","specular","intensity","distance","angle","exponent"],constructor:Yb.SpotLight,className:"TGL.SpotLight"}),Yb.DirectionalLight=function(a,b,c){if(1===arguments.length&&arguments[0]instanceof Object&&!Array.isArray(arguments[0])){var d=arguments[0];a=d.hex,b=d.intensity,c=d.id}Yb.Light.call(this,a,c),this.direction=new Yb.Vec3(0,1,0),this.position=new Yb.Vec3(0,1,0),this.target=new Yb.Element,this.intensity=b!==e?b:1,this.shadowCameraNear=50,this.shadowCameraFar=5e3,this.shadowCameraLeft=-500,this.shadowCameraRight=500,this.shadowCameraTop=500,this.shadowCameraBottom=-500,this.shadowCameraVisible=!1,this.shadowBias=0,this.shadowDarkness=.5,this.shadowMapWidth=512,this.shadowMapHeight=512,this.shadowCascade=!1,this.shadowCascadeOffset=new Yb.Vec3(0,0,-1e3),this.shadowCascadeCount=2,this.shadowCascadeBias=[0,0,0],this.shadowCascadeWidth=[512,512,512],this.shadowCascadeHeight=[512,512,512],this.shadowCascadeNearZ=[-1,.99,.998],this.shadowCascadeFarZ=[.99,.998,1],this.shadowCascadeArray=[],this.shadowMap=null,this.shadowMapSize=null,this.shadowCamera=null,this.shadowMatrix=null},Yb.extend(Yb.DirectionalLight,Yb.Light,{className:"TGL.DirectionalLight",__accessor:["direction"]}),Yb.AmbientLight=function(a,b){if(1===arguments.length&&arguments[0]instanceof Object&&!Array.isArray(arguments[0])){var c=arguments[0];a=c.hex,b=c.id}Yb.Light.call(this,a,b)},Yb.extend(Yb.AmbientLight,Yb.Light,{constructor:Yb.AmbientLight,className:"TGL.AmbientLight",clone:function(){var a=new Yb.AmbientLight;return Yb.Light.prototype.clone.call(this,a),a}}),Yb.Camera=function(){Yb.Element.call(this),this.projectionMatrix=new Yb.Mat4,this.projectionMatrixInverse=new Yb.Mat4,this.worldMatrixInverse=new Yb.Mat4,this.target=new Yb.Vec3,this.setPosition(0,0,500),this.lookat=this.lookAt},Yb.extend(Yb.Camera,Yb.Element,{constructor:Yb.Camera,updateCameraMatrix:function(a){var b=this.matrix.clone();this.matrix.lookAt(this._position,this.target,this.up),this.rotationAutoUpdate&&this._rotation.setEulerFromRotationMatrix(this.matrix),!b.equals(this.matrix)&&a&&this.firePropertyChange("matrix",b,this.matrix)},lookAt:function(a,b){3===arguments.length&&a.x===e?(a=new mono.Vec3(arguments[0],arguments[1],arguments[2]),b=e):4===arguments.length&&a.x===e&&(a=new mono.Vec3(arguments[0],arguments[1],arguments[2]),b=arguments[4]),b===e&&(b=!0),this.target=a,this.updateCameraMatrix(b)},look:function(a){3===arguments.length&&a.x===e&&(a=new mono.Vec3(arguments[0],arguments[1],arguments[2])),this.lookAt(a,!0)},onUpChanged:function(a,b){this.updateCameraMatrix()},getTarget:function(){return this.target},t:function(){return this.getTarget()},getDistance:function(){return(new $b).subVectors(this._position,this.target).length()},setDistance:function(a){var b=this.getDistance();this.zoom(a/b)},lookAtElement:function(a,b,c){b instanceof $b?(c=b,b=this.getDistance()):c=c||new $b(0,0,1),a instanceof Yb.Element&&(b=b?b:this.getDistance(),this.setPosition(a.worldPosition(c,b)),this.look(a.getWorldPosition()))},zoomOut:function(a){this.zoom(1.1,a)},zoomIn:function(a){this.zoom(.9,a)},zoom:function(a,b){if(a>0){var c=b||this.getDistance();c*=a;var d=(new $b).addVectors(this.target,(new $b).subVectors(this._position,this.target).setLength(c));this.setPosition(d)}}}),Yb.OrthoCamera=function(a,b,c,d){Yb.Camera.call(this),this.width=a||1,this.aspect=b||1,this.near=c||.1,this.far=d||1e4,this.updateProjectionMatrix()},Yb.extend(Yb.OrthoCamera,Yb.Camera,{constructor:Yb.OrthoCamera,className:"TGL.OrthoCamera",__accessor:["width","aspect","near","far"],updateProjectionMatrix:function(){var a=this.getDistance(),b=a*this.width/2,c=-b,d=a/this.aspect*this.width/2,e=-d;this.projectionMatrix.makeOrthographic(c,b,d,e,this.near,this.far)},onPropertyChange:function(){this.updateProjectionMatrix()},updateCameraMatrix:function(a){Yb.Camera.prototype.updateCameraMatrix.call(this,a),this.updateProjectionMatrix()}}),Yb.PerspectiveCamera=function(a,b,c,d){Yb.Camera.call(this),this.fov=a!==e?a:50,this.aspect=b!==e?b:1,this.near=c!==e?c:1,this.far=d!==e?d:5e4,this.updateProjectionMatrix()},Yb.extend(Yb.PerspectiveCamera,Yb.Camera,{constructor:Yb.PerspectiveCamera,className:"TGL.PerspectiveCamera",__accessor:["fov","aspect","near","far"],updateProjectionMatrix:function(){this.projectionMatrix.makePerspective(this.fov,this.aspect,this.near,this.far)},onPropertyChange:function(){this.updateProjectionMatrix()}}),Yb.CameraHelper=function(a){function b(a,b,d){c(a,d),c(b,d)}function c(a,b){d.vertices.push(new Yb.Vec3),d.colors.push(new Yb.Color(b)),g[a]===e&&(g[a]=[]),g[a].push(d.vertices.length-1)}var d=new Yb.Entity,f=new Yb.LineMaterial({color:16777215,vertexColors:Yb.FaceColors}),g={},h=16755200,i=16711680,j=43775,k=16777215,l=3355443;b("n1","n2",h),b("n2","n4",h),b("n4","n3",h),b("n3","n1",h),b("f1","f2",h),b("f2","f4",h),b("f4","f3",h),b("f3","f1",h),b("n1","f1",h),b("n2","f2",h),b("n3","f3",h),b("n4","f4",h),b("p","n1",i),b("p","n2",i),b("p","n3",i),b("p","n4",i),b("u1","u2",j),b("u2","u3",j),b("u3","u1",j),b("c","t",k),b("p","c",l),b("cn1","cn2",l),b("cn3","cn4",l),b("cf1","cf2",l),b("cf3","cf4",l),Yb.Line.call(this,d.vertices,d.colors,f,Yb.LinePieces),this.camera=a,this.worldMatrix=a.worldMatrix,this.matrixAutoUpdate=!1,this.pointMap=g,this.update()},Yb.CameraHelper.prototype=Object.create(Yb.Line.prototype),Yb.CameraHelper.prototype.update=function(){var a=new Yb.Vec3,b=new Yb.Camera,c=new Yb.Projector;return function(){function d(d,g,h,i){a.set(g,h,i),c.unprojectVector(a,b);var j=f.pointMap[d];if(j!==e)for(var k=0,l=j.length;l>k;k++)f.vertices[j[k]].copy(a)}var f=this,g=1,h=1;b.projectionMatrix.copy(this.camera.projectionMatrix),d("c",0,0,-1),d("t",0,0,1),d("n1",-g,-h,-1),d("n2",g,-h,-1),d("n3",-g,h,-1),d("n4",g,h,-1),d("f1",-g,-h,1),d("f2",g,-h,1),d("f3",-g,h,1),d("f4",g,h,1),d("u1",.7*g,1.1*h,-1),d("u2",.7*-g,1.1*h,-1),d("u3",0,2*h,-1),d("cf1",-g,0,1),d("cf2",g,0,1),d("cf3",0,-h,1),d("cf4",0,h,1),d("cn1",-g,0,-1),d("cn2",g,0,-1),d("cn3",0,-h,-1),d("cn4",0,h,-1),this.verticesNeedUpdate=!0}}();var $c=function(){Yb.Element.call(this)};$c.prototype=Object.create(Yb.Element.prototype),$c.prototype.updateworldMatrix=function(a){this.matrixAutoUpdate&&this.updateMatrix(),(this.worldMatrixNeedsUpdate||a)&&(this._parent?(this.worldMatrix.multiplyMatrices(this._parent.worldMatrix,this.matrix),this.worldMatrix.decompose(this.translationWorld,this.QuatWorld,this.scaleWorld),this.matrix.decompose(this.translationObject,this.QuatObject,this.scaleObject),this.worldMatrix.compose(this.translationWorld,this.QuatObject,this.scaleWorld)):this.worldMatrix.copy(this.matrix),this.worldMatrixNeedsUpdate=!1,a=!0);for(var b=0,c=this.getChildren().size();c>b;b++)this.getChildren().get(b).updateworldMatrix(a)},$c.prototype.translationWorld=new Yb.Vec3,$c.prototype.translationObject=new Yb.Vec3,$c.prototype.QuatWorld=new Yb.Quat,$c.prototype.QuatObject=new Yb.Quat,$c.prototype.scaleWorld=new Yb.Vec3,$c.prototype.scaleObject=new Yb.Vec3;var _c=function(){function a(a,b){var c=new Yb.DirectionalLight;c.isVirtual=!0,c.onlyShadow=!0,c.castShadow=!0,c.shadowCameraNear=a.shadowCameraNear,c.shadowCameraFar=a.shadowCameraFar,c.shadowCameraLeft=a.shadowCameraLeft,c.shadowCameraRight=a.shadowCameraRight,c.shadowCameraBottom=a.shadowCameraBottom,c.shadowCameraTop=a.shadowCameraTop,c.shadowCameraVisible=a.shadowCameraVisible,c.shadowDarkness=a.shadowDarkness,c.shadowBias=a.shadowCascadeBias[b],c.shadowMapWidth=a.shadowCascadeWidth[b],c.shadowMapHeight=a.shadowCascadeHeight[b],c.pointsWorld=[],c.pointsFrustum=[];for(var d=c.pointsWorld,e=c.pointsFrustum,f=0;8>f;f++)d[f]=new Yb.Vec3,e[f]=new Yb.Vec3;var g=a.shadowCascadeNearZ[b],h=a.shadowCascadeFarZ[b];return e[0].set(-1,-1,g),e[1].set(1,-1,g),e[2].set(-1,1,g),e[3].set(1,1,g),e[4].set(-1,-1,h),e[5].set(1,-1,h),e[6].set(-1,1,h),e[7].set(1,1,h),c}function b(a,b){var c=a.shadowCascadeArray[b];c.position.copy(a.position),c.target.position.copy(a.target.position),c.lookAt(c.target),c.shadowCameraVisible=a.shadowCameraVisible,c.shadowDarkness=a.shadowDarkness,c.shadowBias=a.shadowCascadeBias[b];var d=a.shadowCascadeNearZ[b],e=a.shadowCascadeFarZ[b],f=c.pointsFrustum;f[0].z=d,f[1].z=d,f[2].z=d,f[3].z=d,f[4].z=e,f[5].z=e,f[6].z=e,f[7].z=e}function c(a,b){var c=b.shadowCamera,d=b.pointsFrustum,e=b.pointsWorld;n.set(1/0,1/0,1/0),o.set(-(1/0),-(1/0),-(1/0));for(var f=0;8>f;f++){var g=e[f];g.copy(d[f]),_c.__projector.unprojectVector(g,a),g.applyMatrix4(c.worldMatrixInverse),g.x<n.x&&(n.x=g.x),g.x>o.x&&(o.x=g.x),g.y<n.y&&(n.y=g.y),g.y>o.y&&(o.y=g.y),g.z<n.z&&(n.z=g.z),g.z>o.z&&(o.z=g.z)}c.left=n.x,c.right=o.x,c.top=o.y,c.bottom=n.y,c.updateProjectionMatrix()}function d(a){return a.material instanceof Yb.ArrayMaterial?a.material.materials[0]:a.material}var f,g,h,i,j,k,l=new Yb.Frustum,m=new Yb.Mat4,n=new Yb.Vec3,o=new Yb.Vec3,p=new Yb.Vec3;this.init=function(a){f=a._gl,g=a;var b=Yb.ShaderLib.depthRGBA,c=Yb.UniformsUtils.clone(b.uniforms);h=new Yc({fragmentShader:b.fragmentShader,vertexShader:b.vertexShader,uniforms:c}),_depthCubeMaterial=new Yc({fragmentShader:b.fragmentShader,vertexShader:b.vertexShader,uniforms:c,refreshUniformsCommon:function(a){this.uniforms.isCube.value=1}}),i=new Yc({fragmentShader:b.fragmentShader,vertexShader:b.vertexShader,uniforms:c,morphTargets:!0}),j=new Yc({fragmentShader:b.fragmentShader,vertexShader:b.vertexShader,uniforms:c,skinning:!0}),k=new Yc({fragmentShader:b.fragmentShader,vertexShader:b.vertexShader,uniforms:c,morphTargets:!0,skinning:!0}),h._shadowPass=!0,i._shadowPass=!0,j._shadowPass=!0,k._shadowPass=!0},this.render=function(a,b){g._shadowMapEnable&&this.update(a,b)},this.update=function(n,o){var q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=[],F=0;f.clearColor(1,1,1,1),f.disable(f.BLEND),f.enable(f.CULL_FACE),f.frontFace(f.CCW),g.shadowMapCullFace===Yb.CullFaceFront?f.cullFace(f.FRONT):f.cullFace(f.BACK),g.setDepthTest(!0);var G=n.getLights();for(q=0,r=G.size();r>q;q++)if(C=G.get(q),C.castShadow)if(C instanceof Yb.DirectionalLight&&C.shadowCascade)for(u=0;u<C.shadowCascadeCount;u++){var H;if(C.shadowCascadeArray[u])H=C.shadowCascadeArray[u];else{H=a(C,u),H.originalCamera=o;var I=new $c;I.position=C.shadowCascadeOffset,I.add(H),I.add(H.target),o.add(I),C.shadowCascadeArray[u]=H}b(C,u),E[F]=H,F++}else E[F]=C,F++;for(q=0,r=E.length;r>q;q++){if(C=E[q],!C.shadowMap){var J=Yb.LinearFilter;g.shadowMapType===Yb.PCFSoftShadowMap&&(J=Yb.NearestFilter);var K={minFilter:J,magFilter:J,format:Yb.RGBAFormat};C instanceof Yb.PointLight?(C.shadowMap=new xc(C.shadowMapWidth,C.shadowMapHeight,K),C.shadowMapSize=new Zb(C.shadowMapWidth,C.shadowMapHeight),C.shadowMatrix=new Yb.Mat4):(C.shadowMap=new wc(C.shadowMapWidth,C.shadowMapHeight,K),C.shadowMapSize=new Zb(C.shadowMapWidth,C.shadowMapHeight),C.shadowMatrix=new Yb.Mat4)}if(!C.shadowCamera){if(C instanceof Yb.SpotLight)C.shadowCamera=new Yb.PerspectiveCamera(C.shadowCameraFov,C.shadowMapWidth/C.shadowMapHeight,C.shadowCameraNear,C.shadowCameraFar);else if(C instanceof Yb.DirectionalLight)C.shadowCamera=new Yb.OrthoCamera(C.shadowCameraLeft,C.shadowCameraRight,C.shadowCameraTop,C.shadowCameraBottom,C.shadowCameraNear,C.shadowCameraFar);else{if(!(C instanceof Yb.PointLight)){console.error("Unsupported light type for shadow");continue}C.shadowCamera=new Yb.PerspectiveCamera(90,1,C.shadowCameraNear,C.shadowCameraFar)}C.shadowCamera.updateWorldMatrix();for(var L,M=n.getRoots(),N=M.size(),O=0;N>O;O++)L=M.get(O),L.updateWorldMatrix()}C.shadowCameraVisible&&!C.cameraHelper&&(C.cameraHelper=new Yb.CameraHelper(C.shadowCamera),C.shadowCamera.addChild(C.cameraHelper),C.shadowCamera.updateWorldMatrix(!0),g.helperBox.add(C.shadowCamera),g.helperBox.add(C.cameraHelper)),C.isVirtual&&H.originalCamera==o&&c(o,C);for(var P=C instanceof Yb.PointLight?6:1,Q=[new $b(1,0,0),new $b(-1,0,0),new $b(0,1,0),new $b(0,-1,0),new $b(0,0,1),new $b(0,0,-1)],F=0;P>F;F++)if(null==C.debugFace||F==C.debugFace){for(v=C.shadowMap,w=C.shadowMatrix,x=C.shadowCamera,x._position.setFromMatrixPosition(C.worldMatrix),C.target?p.setFromMatrixPosition(C.target.worldMatrix):p=x._position.clone().add(Q[F]),x.lookAt(p),x.updateWorldMatrix(!0),x.worldMatrixInverse.getInverse(x.worldMatrix),C.cameraHelper&&(C.cameraHelper.visible=C.shadowCameraVisible),C.shadowCameraVisible&&C.cameraHelper.update(),w.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),w.multiply(x.projectionMatrix),w.multiply(x.worldMatrixInverse),m.multiplyMatrices(x.projectionMatrix,x.worldMatrixInverse),l.setFromMatrix(m),v.activeCubeFace=F,g.debugPointLight==e&&g.setRenderTarget(v),g.clear(),D=g.glNodeList,s=0,t=D.length;t>s;s++)A=D[s],B=A.node,A.render=!1,B._visible&&B.castShadow&&((B instanceof Yb.Node||B instanceof Yb.Particle)&&B.frustumCulled&&!l.intersectsObject(B)||(B._modelViewMatrix.multiplyMatrices(x.worldMatrixInverse,B.worldMatrix),A.render=!0));var R,S,T;for(s=0,t=D.length;t>s;s++)A=D[s],A.render&&(B=A.node,y=A.group,R=d(B),S=!1,T=!1,z=B.customDepthMaterial?B.customDepthMaterial:T?S?k:j:S?i:1==P?h:_depthCubeMaterial,B instanceof Yb.BufferNode||g.renderGroup(x,n.getLights(),z,y,B))}}var U=g.getClearColor(),V=g.getClearAlpha();f.clearColor(U.r,U.g,U.b,V),f.enable(f.BLEND),g.shadowMapCullFace===Yb.CullFaceFront&&f.cullFace(f.BACK)}};_c.__projector=new Yb.Projector,Yb.Picking=function(a,b,c,d,e,f){this.network=f,this.origin=a,this.cameraUp=c,this.direction=b,this.near=d||0,this.far=e||1/0,this.ray=new Yb.Ray(a,b),this.ray.direction.length>0&&this.ray.direction.normalize()},Yb.Picking.testPlane=new Yb.Plane(1,1),Yb.Picking.prototype={constructor:Yb.Picking,precision:1e-4,linePrecision:2,matrixPosition:new Yb.Vec3,set:function(a,b){this.origin=a,this.direction=b,this.ray.set(a,b),this.ray.direction.length>0&&this.ray.direction.normalize()},intersectObject:function(a,b,c){var d=[];return b===!0&&Ob(a,this,d,c),Nb(a,this,d,c),d.sort(Mb),d},intersectObjects:function(a,b,c){a._as&&(a=a._as);for(var d=[],e=0,f=a.length;f>e;e++)Nb(a[e],this,d,c,this.network),b===!0&&Ob(a[e],this,d,c,this.network);return d.sort(Mb),d}};var ad=new Yb.Ray,bd=new Yb.Mat4,cd=new Yb.math.Plane,dd=new Yb.Vec3,ed=new Yb.BoundingSphere,fd=function(a){arguments.length>0&&this.init(a)};fd.prototype.init=function(a){this.status=a,this.points=new Array},fd.prototype.appendPoint=function(a){this.points.push(a)},fd.prototype.appendPoints=function(a){this.points=this.points.concat(a)},fd.intersectShapes=function(a,b){var c,d=a.getIntersectionParams(),e=b.getIntersectionParams();if(null!=d&&null!=e)if("Path"==d.name)c=fd.intersectPathShape(a,b);else if("Path"==e.name)c=fd.intersectPathShape(b,a);else{var f,g;if(d.name<e.name?(f="intersect"+d.name+e.name,g=d.params.concat(e.params)):(f="intersect"+e.name+d.name,g=e.params.concat(d.params)),!(f in fd))throw new Error("Intersection not available: "+f);c=fd[f].apply(null,g)}else c=new fd("No Intersection");return c},fd.intersectPathShape=function(a,b){return a.intersectShape(b)},fd.intersectBezier2Bezier2=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p=new fd("No Intersection");if(g=b.multiply(-2),i=a.add(g.add(c)),g=a.multiply(-2),h=b.multiply(2),j=g.add(h),k=new Zb(a.x,a.y),g=e.multiply(-2),l=d.add(g.add(f)),g=d.multiply(-2),h=e.multiply(2),m=g.add(h),n=new Zb(d.x,d.y),0==i.y){var q=i.x*(k.y-n.y),r=q-j.x*j.y,s=q+r,t=j.y*j.y;o=new Polynomial(i.x*l.y*l.y,2*i.x*m.y*l.y,i.x*m.y*m.y-l.x*t-l.y*q-l.y*r,-m.x*t-m.y*q-m.y*r,(k.x-n.x)*t+(k.y-n.y)*r)}else{var q=i.x*l.y-i.y*l.x,r=i.x*m.y-m.x*i.y,s=j.x*i.y-j.y*i.x,t=k.y-n.y,u=i.y*(k.x-n.x)-i.x*t,v=-j.y*s+i.y*u,w=s*s;o=new Polynomial(q*q,2*q*r,(-l.y*w+i.y*r*r+i.y*q*u+q*v)/i.y,(-m.y*w+i.y*r*u+r*v)/i.y,(t*w+u*v)/i.y)}for(var x=o.getRoots(),y=0;y<x.length;y++){var z=x[y];if(z>=0&&1>=z){var A=new Polynomial(i.x,j.x,k.x-n.x-z*m.x-z*z*l.x).getRoots(),B=new Polynomial(i.y,j.y,k.y-n.y-z*m.y-z*z*l.y).getRoots();if(A.length>0&&B.length>0){var C=1e-4;a:for(var D=0;D<A.length;D++){var E=A[D];if(E>=0&&1>=E)for(var F=0;F<B.length;F++)if(Math.abs(E-B[F])<C){p.points.push(l.multiply(z*z).add(m.multiply(z).add(n)));break a}}}}}return p.points.length>0&&(p.status="$Intersection"),p},fd.intersectBezier2Bezier3=function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s=new fd("No Intersection");h=b.multiply(-2),l=a.add(h.add(c)),h=a.multiply(-2),i=b.multiply(2),m=h.add(i),n=new Zb(a.x,a.y),h=d.multiply(-1),i=e.multiply(3),j=f.multiply(-3),k=h.add(i.add(j.add(g))),o=new Vector2D(k.x,k.y),h=d.multiply(3),i=e.multiply(-6),j=f.multiply(3),k=h.add(i.add(j)),p=new Vector2D(k.x,k.y),h=d.multiply(-3),i=e.multiply(3),j=h.add(i),q=new Vector2D(j.x,j.y),r=new Vector2D(d.x,d.y);for(var t=n.x*n.x,u=n.y*n.y,v=m.x*m.x,w=m.y*m.y,x=l.x*l.x,y=l.y*l.y,z=r.x*r.x,A=r.y*r.y,B=q.x*q.x,C=q.y*q.y,D=p.x*p.x,E=p.y*p.y,F=o.x*o.x,G=o.y*o.y,H=new Polynomial(-2*l.x*l.y*o.x*o.y+x*G+y*F,-2*l.x*l.y*p.x*o.y-2*l.x*l.y*p.y*o.x+2*y*p.x*o.x+2*x*p.y*o.y,-2*l.x*q.x*l.y*o.y-2*l.x*l.y*q.y*o.x-2*l.x*l.y*p.x*p.y+2*q.x*y*o.x+y*D+x*(2*q.y*o.y+E),2*n.x*l.x*l.y*o.y+2*n.y*l.x*l.y*o.x+m.x*m.y*l.x*o.y+m.x*m.y*l.y*o.x-2*r.x*l.x*l.y*o.y-2*l.x*r.y*l.y*o.x-2*l.x*q.x*l.y*p.y-2*l.x*l.y*q.y*p.x-2*n.x*y*o.x-2*n.y*x*o.y+2*r.x*y*o.x+2*q.x*y*p.x-w*l.x*o.x-v*l.y*o.y+x*(2*r.y*o.y+2*q.y*p.y),2*n.x*l.x*l.y*p.y+2*n.y*l.x*l.y*p.x+m.x*m.y*l.x*p.y+m.x*m.y*l.y*p.x-2*r.x*l.x*l.y*p.y-2*l.x*r.y*l.y*p.x-2*l.x*q.x*l.y*q.y-2*n.x*y*p.x-2*n.y*x*p.y+2*r.x*y*p.x-w*l.x*p.x-v*l.y*p.y+B*y+x*(2*r.y*p.y+C),2*n.x*l.x*l.y*q.y+2*n.y*l.x*q.x*l.y+m.x*m.y*l.x*q.y+m.x*m.y*q.x*l.y-2*r.x*l.x*l.y*q.y-2*l.x*r.y*q.x*l.y-2*n.x*q.x*y-2*n.y*x*q.y+2*r.x*q.x*y-w*l.x*q.x-v*l.y*q.y+2*x*r.y*q.y,-2*n.x*n.y*l.x*l.y-n.x*m.x*m.y*l.y-n.y*m.x*m.y*l.x+2*n.x*l.x*r.y*l.y+2*n.y*r.x*l.x*l.y+m.x*r.x*m.y*l.y+m.x*m.y*l.x*r.y-2*r.x*l.x*r.y*l.y-2*n.x*r.x*y+n.x*w*l.x+n.y*v*l.y-2*n.y*x*r.y-r.x*w*l.x-v*r.y*l.y+t*y+u*x+z*y+x*A),I=H.getRootsInInterval(0,1),J=0;J<I.length;J++){var K=I[J],L=new Polynomial(l.x,m.x,n.x-r.x-K*q.x-K*K*p.x-K*K*K*o.x).getRoots(),M=new Polynomial(l.y,m.y,n.y-r.y-K*q.y-K*K*p.y-K*K*K*o.y).getRoots();if(L.length>0&&M.length>0){var N=1e-4;a:for(var O=0;O<L.length;O++){var P=L[O];if(P>=0&&1>=P)for(var Q=0;Q<M.length;Q++)if(Math.abs(P-M[Q])<N){s.points.push(o.multiply(K*K*K).add(p.multiply(K*K).add(q.multiply(K).add(r))));break a}}}}return s.points.length>0&&(s.status="Intersection"),s},fd.intersectBezier2Circle=function(a,b,c,d,e){return fd.intersectBezier2Ellipse(a,b,c,d,e,e)},fd.intersectBezier2Ellipse=function(a,b,c,d,e,f){var g,h,i,j,k,l=new fd("No Intersection");g=b.multiply(-2),i=a.add(g.add(c)),g=a.multiply(-2),h=b.multiply(2),j=g.add(h),k=new Zb(a.x,a.y);for(var m=e*e,n=f*f,o=new Polynomial(n*i.x*i.x+m*i.y*i.y,2*(n*i.x*j.x+m*i.y*j.y),n*(2*i.x*k.x+j.x*j.x)+m*(2*i.y*k.y+j.y*j.y)-2*(n*d.x*i.x+m*d.y*i.y),2*(n*j.x*(k.x-d.x)+m*j.y*(k.y-d.y)),n*(k.x*k.x+d.x*d.x)+m*(k.y*k.y+d.y*d.y)-2*(n*d.x*k.x+m*d.y*k.y)-m*n).getRoots(),p=0;p<o.length;p++){var q=o[p];q>=0&&1>=q&&l.points.push(i.multiply(q*q).add(j.multiply(q).add(k)))}return l.points.length>0&&(l.status="Intersection"),l},fd.intersectBezier2Line=function(a,b,c,d,e){var f,g,h,i,j,k,l,m=d.min(e),n=d.max(e),o=new fd("No Intersection");f=b.multiply(-2),h=a.add(f.add(c)),f=a.multiply(-2),g=b.multiply(2),i=f.add(g),j=new Zb(a.x,a.y),l=new Vector2D(d.y-e.y,e.x-d.x),k=d.x*e.y-e.x*d.y,roots=new Polynomial(l.dot(h),l.dot(i),l.dot(j)+k).getRoots();for(var p=0;p<roots.length;p++){var q=roots[p];if(q>=0&&1>=q){var r=a.lerp(b,q),s=b.lerp(c,q),t=r.lerp(s,q);d.x==e.x?m.y<=t.y&&t.y<=n.y&&(o.status="Intersection",o.appendPoint(t)):d.y==e.y?m.x<=t.x&&t.x<=n.x&&(o.status="Intersection",o.appendPoint(t)):t.gte(m)&&t.lte(n)&&(o.status="Intersection",o.appendPoint(t))}}return o},fd.intersectBezier2Polygon=function(a,b,c,d){for(var e=new fd("No Intersection"),f=d.length,g=0;f>g;g++){var h=d[g],i=d[(g+1)%f],j=fd.intersectBezier2Line(a,b,c,h,i);e.appendPoints(j.points)}return e.points.length>0&&(e.status="Intersection"),e},fd.intersectBezier2Rectangle=function(a,b,c,d,e){var f=d.min(e),g=d.max(e),h=new Zb(g.x,f.y),i=new Zb(f.x,g.y),j=fd.intersectBezier2Line(a,b,c,f,h),k=fd.intersectBezier2Line(a,b,c,h,g),l=fd.intersectBezier2Line(a,b,c,g,i),m=fd.intersectBezier2Line(a,b,c,i,f),n=new fd("No Intersection");return n.appendPoints(j.points),n.appendPoints(k.points),n.appendPoints(l.points),n.appendPoints(m.points),n.points.length>0&&(n.status="Intersection"),n},fd.intersectBezier3Bezier3=function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o,p,q,r,s,t,u=new fd("No Intersection");i=a.multiply(-1),j=b.multiply(3),k=c.multiply(-3),l=i.add(j.add(k.add(d))),m=new Vector2D(l.x,l.y),i=a.multiply(3),j=b.multiply(-6),k=c.multiply(3),l=i.add(j.add(k)),n=new Vector2D(l.x,l.y),i=a.multiply(-3),j=b.multiply(3),k=i.add(j),o=new Vector2D(k.x,k.y),p=new Vector2D(a.x,a.y),i=e.multiply(-1),j=f.multiply(3),k=g.multiply(-3),l=i.add(j.add(k.add(h))),q=new Vector2D(l.x,l.y),i=e.multiply(3),j=f.multiply(-6),k=g.multiply(3),l=i.add(j.add(k)),r=new Vector2D(l.x,l.y),i=e.multiply(-3),j=f.multiply(3),k=i.add(j),s=new Vector2D(k.x,k.y),
t=new Vector2D(e.x,e.y);for(var v=p.x*p.x,w=p.x*p.x*p.x,x=p.y*p.y,y=p.y*p.y*p.y,z=o.x*o.x,A=o.x*o.x*o.x,B=o.y*o.y,C=o.y*o.y*o.y,D=n.x*n.x,E=n.x*n.x*n.x,F=n.y*n.y,G=n.y*n.y*n.y,H=m.x*m.x,I=m.x*m.x*m.x,J=m.y*m.y,K=m.y*m.y*m.y,L=t.x*t.x,M=t.x*t.x*t.x,N=t.y*t.y,O=t.y*t.y*t.y,P=s.x*s.x,Q=s.x*s.x*s.x,R=s.y*s.y,S=r.x*r.x,T=r.x*r.x*r.x,U=r.y*r.y,V=q.x*q.x,W=q.x*q.x*q.x,X=q.y*q.y,Y=q.y*q.y*q.y,Z=new Polynomial(-I*Y+K*W-3*m.x*J*V*q.y+3*H*m.y*q.x*X,-6*m.x*r.x*J*q.x*q.y+6*H*m.y*r.y*q.x*q.y+3*r.x*K*V-3*I*r.y*X-3*m.x*J*r.y*V+3*H*r.x*m.y*X,-6*s.x*m.x*J*q.x*q.y-6*m.x*r.x*J*r.y*q.x+6*H*r.x*m.y*r.y*q.y+3*s.x*K*V+3*S*K*q.x+3*s.x*H*m.y*X-3*m.x*s.y*J*V-3*m.x*S*J*q.y+H*m.y*q.x*(6*s.y*q.y+3*U)+I*(-s.y*X-2*U*q.y-q.y*(2*s.y*q.y+U)),o.x*n.y*m.x*m.y*q.x*q.y-o.y*n.x*m.x*m.y*q.x*q.y+6*s.x*r.x*K*q.x+3*o.x*n.x*m.x*m.y*X+6*p.x*m.x*J*q.x*q.y-3*o.x*n.x*J*q.x*q.y-3*o.y*n.y*m.x*m.y*V-6*p.y*H*m.y*q.x*q.y-6*t.x*m.x*J*q.x*q.y+3*o.y*n.y*H*q.x*q.y-2*n.x*F*m.x*q.x*q.y-6*s.x*m.x*r.x*J*q.y-6*s.x*m.x*J*r.y*q.x-6*m.x*s.y*r.x*J*q.x+6*s.x*H*m.y*r.y*q.y+2*D*n.y*m.y*q.x*q.y+T*K-3*p.x*K*V+3*p.y*I*X+3*t.x*K*V+G*m.x*V-E*m.y*X-3*p.x*H*m.y*X+3*p.y*m.x*J*V-2*o.x*n.y*H*X+o.x*n.y*J*V-o.y*n.x*H*X+2*o.y*n.x*J*V+3*t.x*H*m.y*X-n.x*F*m.y*V-3*t.y*m.x*J*V+D*n.y*m.x*X-3*m.x*S*J*r.y+H*m.y*q.x*(6*t.y*q.y+6*s.y*r.y)+H*r.x*m.y*(6*s.y*q.y+3*U)+I*(-2*s.y*r.y*q.y-t.y*X-r.y*(2*s.y*q.y+U)-q.y*(2*t.y*q.y+2*s.y*r.y)),6*o.x*n.x*m.x*m.y*r.y*q.y+o.x*n.y*m.x*r.x*m.y*q.y+o.x*n.y*m.x*m.y*r.y*q.x-o.y*n.x*m.x*r.x*m.y*q.y-o.y*n.x*m.x*m.y*r.y*q.x-6*o.y*n.y*m.x*r.x*m.y*q.x-6*p.x*r.x*K*q.x+6*t.x*r.x*K*q.x+6*p.y*I*r.y*q.y+2*G*m.x*r.x*q.x-2*E*m.y*r.y*q.y+6*p.x*m.x*r.x*J*q.y+6*p.x*m.x*J*r.y*q.x+6*p.y*m.x*r.x*J*q.x-3*o.x*n.x*r.x*J*q.y-3*o.x*n.x*J*r.y*q.x+2*o.x*n.y*r.x*J*q.x+4*o.y*n.x*r.x*J*q.x-6*p.x*H*m.y*r.y*q.y-6*p.y*H*r.x*m.y*q.y-6*p.y*H*m.y*r.y*q.x-4*o.x*n.y*H*r.y*q.y-6*t.x*m.x*r.x*J*q.y-6*t.x*m.x*J*r.y*q.x-2*o.y*n.x*H*r.y*q.y+3*o.y*n.y*H*r.x*q.y+3*o.y*n.y*H*r.y*q.x-2*n.x*F*m.x*r.x*q.y-2*n.x*F*m.x*r.y*q.x-2*n.x*F*r.x*m.y*q.x-6*t.y*m.x*r.x*J*q.x-6*s.x*m.x*s.y*J*q.x-6*s.x*m.x*r.x*J*r.y+6*t.x*H*m.y*r.y*q.y+2*D*n.y*m.x*r.y*q.y+2*D*n.y*r.x*m.y*q.y+2*D*n.y*m.y*r.y*q.x+3*s.x*S*K+3*P*K*q.x-3*m.x*s.y*S*J-3*P*m.x*J*q.y+H*r.x*m.y*(6*t.y*q.y+6*s.y*r.y)+H*m.y*q.x*(6*t.y*r.y+3*R)+s.x*H*m.y*(6*s.y*q.y+3*U)+I*(-2*t.y*r.y*q.y-q.y*(2*t.y*r.y+R)-s.y*(2*s.y*q.y+U)-r.y*(2*t.y*q.y+2*s.y*r.y)),o.x*s.x*n.y*m.x*m.y*q.y+o.x*n.y*m.x*s.y*m.y*q.x+o.x*n.y*m.x*r.x*m.y*r.y-o.y*n.x*s.x*m.x*m.y*q.y-o.y*n.x*m.x*s.y*m.y*q.x-o.y*n.x*m.x*r.x*m.y*r.y-6*o.y*s.x*n.y*m.x*m.y*q.x-6*p.x*s.x*K*q.x+6*t.x*s.x*K*q.x+2*s.x*G*m.x*q.x+6*p.x*s.x*m.x*J*q.y+6*p.x*m.x*s.y*J*q.x+6*p.x*m.x*r.x*J*r.y+6*p.y*s.x*m.x*J*q.x-3*o.x*n.x*s.x*J*q.y-3*o.x*n.x*s.y*J*q.x-3*o.x*n.x*r.x*J*r.y+2*o.x*s.x*n.y*J*q.x+4*o.y*n.x*s.x*J*q.x-6*p.y*s.x*H*m.y*q.y-6*p.y*H*s.y*m.y*q.x-6*p.y*H*r.x*m.y*r.y-6*t.x*s.x*m.x*J*q.y-6*t.x*m.x*s.y*J*q.x-6*t.x*m.x*r.x*J*r.y+3*o.y*s.x*n.y*H*q.y-3*o.y*n.y*m.x*S*m.y+3*o.y*n.y*H*s.y*q.x+3*o.y*n.y*H*r.x*r.y-2*n.x*s.x*F*m.x*q.y-2*n.x*s.x*F*m.y*q.x-2*n.x*F*m.x*s.y*q.x-2*n.x*F*m.x*r.x*r.y-6*t.y*s.x*m.x*J*q.x-6*s.x*m.x*s.y*r.x*J+6*t.y*H*s.y*m.y*q.x+2*D*s.x*n.y*m.y*q.y+2*D*n.y*s.y*m.y*q.x+2*D*n.y*r.x*m.y*r.y-3*p.x*S*K+3*t.x*S*K+3*P*r.x*K+G*m.x*S+3*p.y*m.x*S*J+o.x*n.y*S*J+2*o.y*n.x*S*J-n.x*F*S*m.y-3*t.y*m.x*S*J-3*P*m.x*J*r.y+D*n.y*m.x*(2*s.y*q.y+U)+o.x*n.x*m.x*m.y*(6*s.y*q.y+3*U)+s.x*H*m.y*(6*t.y*q.y+6*s.y*r.y)+E*m.y*(-2*s.y*q.y-U)+p.y*I*(6*s.y*q.y+3*U)+o.y*n.x*H*(-2*s.y*q.y-U)+o.x*n.y*H*(-4*s.y*q.y-2*U)+p.x*H*m.y*(-6*s.y*q.y-3*U)+H*r.x*m.y*(6*t.y*r.y+3*R)+t.x*H*m.y*(6*s.y*q.y+3*U)+I*(-2*t.y*s.y*q.y-r.y*(2*t.y*r.y+R)-t.y*(2*s.y*q.y+U)-s.y*(2*t.y*q.y+2*s.y*r.y)),-p.x*o.x*n.y*m.x*m.y*q.y+p.x*o.y*n.x*m.x*m.y*q.y+6*p.x*o.y*n.y*m.x*m.y*q.x-6*p.y*o.x*n.x*m.x*m.y*q.y-p.y*o.x*n.y*m.x*m.y*q.x+p.y*o.y*n.x*m.x*m.y*q.x+o.x*o.y*n.x*n.y*m.x*q.y-o.x*o.y*n.x*n.y*m.y*q.x+o.x*t.x*n.y*m.x*m.y*q.y+o.x*t.y*n.y*m.x*m.y*q.x+o.x*s.x*n.y*m.x*m.y*r.y+o.x*n.y*m.x*s.y*r.x*m.y-t.x*o.y*n.x*m.x*m.y*q.y-6*t.x*o.y*n.y*m.x*m.y*q.x-o.y*n.x*t.y*m.x*m.y*q.x-o.y*n.x*s.x*m.x*m.y*r.y-o.y*n.x*m.x*s.y*r.x*m.y-6*o.y*s.x*n.y*m.x*r.x*m.y-6*p.x*t.x*K*q.x-6*p.x*s.x*r.x*K-2*p.x*G*m.x*q.x+6*t.x*s.x*r.x*K+2*t.x*G*m.x*q.x+2*s.x*G*m.x*r.x+2*p.y*E*m.y*q.y-6*p.x*p.y*m.x*J*q.x+3*p.x*o.x*n.x*J*q.y-2*p.x*o.x*n.y*J*q.x-4*p.x*o.y*n.x*J*q.x+3*p.y*o.x*n.x*J*q.x+6*p.x*p.y*H*m.y*q.y+6*p.x*t.x*m.x*J*q.y-3*p.x*o.y*n.y*H*q.y+2*p.x*n.x*F*m.x*q.y+2*p.x*n.x*F*m.y*q.x+6*p.x*t.y*m.x*J*q.x+6*p.x*s.x*m.x*J*r.y+6*p.x*m.x*s.y*r.x*J+4*p.y*o.x*n.y*H*q.y+6*p.y*t.x*m.x*J*q.x+2*p.y*o.y*n.x*H*q.y-3*p.y*o.y*n.y*H*q.x+2*p.y*n.x*F*m.x*q.x+6*p.y*s.x*m.x*r.x*J-3*o.x*t.x*n.x*J*q.y+2*o.x*t.x*n.y*J*q.x+o.x*o.y*F*m.x*q.x-3*o.x*n.x*t.y*J*q.x-3*o.x*n.x*s.x*J*r.y-3*o.x*n.x*s.y*r.x*J+2*o.x*s.x*n.y*r.x*J+4*t.x*o.y*n.x*J*q.x+4*o.y*n.x*s.x*r.x*J-2*p.x*D*n.y*m.y*q.y-6*p.y*t.x*H*m.y*q.y-6*p.y*t.y*H*m.y*q.x-6*p.y*s.x*H*m.y*r.y-2*p.y*D*n.y*m.x*q.y-2*p.y*D*n.y*m.y*q.x-6*p.y*H*s.y*r.x*m.y-o.x*o.y*D*m.y*q.y-2*o.x*B*m.x*m.y*q.x+3*t.x*o.y*n.y*H*q.y-2*t.x*n.x*F*m.x*q.y-2*t.x*n.x*F*m.y*q.x-6*t.x*t.y*m.x*J*q.x-6*t.x*s.x*m.x*J*r.y-6*t.x*m.x*s.y*r.x*J+3*o.y*t.y*n.y*H*q.x+3*o.y*s.x*n.y*H*r.y+3*o.y*n.y*H*s.y*r.x-2*n.x*t.y*F*m.x*q.x-2*n.x*s.x*F*m.x*r.y-2*n.x*s.x*F*r.x*m.y-2*n.x*F*m.x*s.y*r.x-6*t.y*s.x*m.x*r.x*J-B*n.x*n.y*m.x*q.x+2*t.x*D*n.y*m.y*q.y+6*t.y*H*s.y*r.x*m.y+2*z*o.y*m.x*m.y*q.y+z*n.x*n.y*m.y*q.y+2*D*t.y*n.y*m.y*q.x+2*D*s.x*n.y*m.y*r.y+2*D*n.y*s.y*r.x*m.y+Q*K+3*v*K*q.x-3*x*I*q.y+3*L*K*q.x+C*H*q.x-A*J*q.y-o.x*B*H*q.y+z*o.y*J*q.x-3*v*m.x*J*q.y+3*x*H*m.y*q.x-z*F*m.x*q.y+B*D*m.y*q.x-3*P*m.x*s.y*J-3*L*m.x*J*q.y+3*N*H*m.y*q.x+o.x*n.x*m.x*m.y*(6*t.y*q.y+6*s.y*r.y)+E*m.y*(-2*t.y*q.y-2*s.y*r.y)+p.y*I*(6*t.y*q.y+6*s.y*r.y)+o.y*n.x*H*(-2*t.y*q.y-2*s.y*r.y)+D*n.y*m.x*(2*t.y*q.y+2*s.y*r.y)+o.x*n.y*H*(-4*t.y*q.y-4*s.y*r.y)+p.x*H*m.y*(-6*t.y*q.y-6*s.y*r.y)+t.x*H*m.y*(6*t.y*q.y+6*s.y*r.y)+s.x*H*m.y*(6*t.y*r.y+3*R)+I*(-2*t.y*s.y*r.y-N*q.y-s.y*(2*t.y*r.y+R)-t.y*(2*t.y*q.y+2*s.y*r.y)),-p.x*o.x*n.y*m.x*m.y*r.y+p.x*o.y*n.x*m.x*m.y*r.y+6*p.x*o.y*n.y*m.x*r.x*m.y-6*p.y*o.x*n.x*m.x*m.y*r.y-p.y*o.x*n.y*m.x*r.x*m.y+p.y*o.y*n.x*m.x*r.x*m.y+o.x*o.y*n.x*n.y*m.x*r.y-o.x*o.y*n.x*n.y*r.x*m.y+o.x*t.x*n.y*m.x*m.y*r.y+o.x*t.y*n.y*m.x*r.x*m.y+o.x*s.x*n.y*m.x*s.y*m.y-t.x*o.y*n.x*m.x*m.y*r.y-6*t.x*o.y*n.y*m.x*r.x*m.y-o.y*n.x*t.y*m.x*r.x*m.y-o.y*n.x*s.x*m.x*s.y*m.y-6*p.x*t.x*r.x*K-2*p.x*G*m.x*r.x+2*t.x*G*m.x*r.x+2*p.y*E*m.y*r.y-6*p.x*p.y*m.x*r.x*J+3*p.x*o.x*n.x*J*r.y-2*p.x*o.x*n.y*r.x*J-4*p.x*o.y*n.x*r.x*J+3*p.y*o.x*n.x*r.x*J+6*p.x*p.y*H*m.y*r.y+6*p.x*t.x*m.x*J*r.y-3*p.x*o.y*n.y*H*r.y+2*p.x*n.x*F*m.x*r.y+2*p.x*n.x*F*r.x*m.y+6*p.x*t.y*m.x*r.x*J+6*p.x*s.x*m.x*s.y*J+4*p.y*o.x*n.y*H*r.y+6*p.y*t.x*m.x*r.x*J+2*p.y*o.y*n.x*H*r.y-3*p.y*o.y*n.y*H*r.x+2*p.y*n.x*F*m.x*r.x-3*o.x*t.x*n.x*J*r.y+2*o.x*t.x*n.y*r.x*J+o.x*o.y*F*m.x*r.x-3*o.x*n.x*t.y*r.x*J-3*o.x*n.x*s.x*s.y*J+4*t.x*o.y*n.x*r.x*J-2*p.x*D*n.y*m.y*r.y-6*p.y*t.x*H*m.y*r.y-6*p.y*t.y*H*r.x*m.y-6*p.y*s.x*H*s.y*m.y-2*p.y*D*n.y*m.x*r.y-2*p.y*D*n.y*r.x*m.y-o.x*o.y*D*m.y*r.y-2*o.x*B*m.x*r.x*m.y+3*t.x*o.y*n.y*H*r.y-2*t.x*n.x*F*m.x*r.y-2*t.x*n.x*F*r.x*m.y-6*t.x*t.y*m.x*r.x*J-6*t.x*s.x*m.x*s.y*J+3*o.y*t.y*n.y*H*r.x+3*o.y*s.x*n.y*H*s.y-2*n.x*t.y*F*m.x*r.x-2*n.x*s.x*F*m.x*s.y-B*n.x*n.y*m.x*r.x+2*t.x*D*n.y*m.y*r.y-3*o.y*P*n.y*m.x*m.y+6*t.y*s.x*H*s.y*m.y+2*z*o.y*m.x*m.y*r.y+z*n.x*n.y*m.y*r.y+2*D*t.y*n.y*r.x*m.y+2*D*s.x*n.y*s.y*m.y-3*p.x*P*K+3*t.x*P*K+3*v*r.x*K-3*x*I*r.y+3*L*r.x*K+P*G*m.x+C*H*r.x-A*J*r.y+3*p.y*P*m.x*J-o.x*B*H*r.y+o.x*P*n.y*J+2*o.y*n.x*P*J+z*o.y*r.x*J-n.x*P*F*m.y-3*t.y*P*m.x*J-3*v*m.x*J*r.y+3*x*H*r.x*m.y-z*F*m.x*r.y+B*D*r.x*m.y-3*L*m.x*J*r.y+3*N*H*r.x*m.y+D*n.y*m.x*(2*t.y*r.y+R)+o.x*n.x*m.x*m.y*(6*t.y*r.y+3*R)+E*m.y*(-2*t.y*r.y-R)+p.y*I*(6*t.y*r.y+3*R)+o.y*n.x*H*(-2*t.y*r.y-R)+o.x*n.y*H*(-4*t.y*r.y-2*R)+p.x*H*m.y*(-6*t.y*r.y-3*R)+t.x*H*m.y*(6*t.y*r.y+3*R)+I*(-2*t.y*R-N*r.y-t.y*(2*t.y*r.y+R)),-p.x*o.x*n.y*m.x*s.y*m.y+p.x*o.y*n.x*m.x*s.y*m.y+6*p.x*o.y*s.x*n.y*m.x*m.y-6*p.y*o.x*n.x*m.x*s.y*m.y-p.y*o.x*s.x*n.y*m.x*m.y+p.y*o.y*n.x*s.x*m.x*m.y-o.x*o.y*n.x*s.x*n.y*m.y+o.x*o.y*n.x*n.y*m.x*s.y+o.x*t.x*n.y*m.x*s.y*m.y+6*o.x*n.x*t.y*m.x*s.y*m.y+o.x*t.y*s.x*n.y*m.x*m.y-t.x*o.y*n.x*m.x*s.y*m.y-6*t.x*o.y*s.x*n.y*m.x*m.y-o.y*n.x*t.y*s.x*m.x*m.y-6*p.x*t.x*s.x*K-2*p.x*s.x*G*m.x+6*p.y*t.y*I*s.y+2*t.x*s.x*G*m.x+2*p.y*E*s.y*m.y-2*E*t.y*s.y*m.y-6*p.x*p.y*s.x*m.x*J+3*p.x*o.x*n.x*s.y*J-2*p.x*o.x*s.x*n.y*J-4*p.x*o.y*n.x*s.x*J+3*p.y*o.x*n.x*s.x*J+6*p.x*p.y*H*s.y*m.y+6*p.x*t.x*m.x*s.y*J-3*p.x*o.y*n.y*H*s.y+2*p.x*n.x*s.x*F*m.y+2*p.x*n.x*F*m.x*s.y+6*p.x*t.y*s.x*m.x*J+4*p.y*o.x*n.y*H*s.y+6*p.y*t.x*s.x*m.x*J+2*p.y*o.y*n.x*H*s.y-3*p.y*o.y*s.x*n.y*H+2*p.y*n.x*s.x*F*m.x-3*o.x*t.x*n.x*s.y*J+2*o.x*t.x*s.x*n.y*J+o.x*o.y*s.x*F*m.x-3*o.x*n.x*t.y*s.x*J+4*t.x*o.y*n.x*s.x*J-6*p.x*t.y*H*s.y*m.y-2*p.x*D*n.y*s.y*m.y-6*p.y*t.x*H*s.y*m.y-6*p.y*t.y*s.x*H*m.y-2*p.y*D*s.x*n.y*m.y-2*p.y*D*n.y*m.x*s.y-o.x*o.y*D*s.y*m.y-4*o.x*t.y*n.y*H*s.y-2*o.x*B*s.x*m.x*m.y+3*t.x*o.y*n.y*H*s.y-2*t.x*n.x*s.x*F*m.y-2*t.x*n.x*F*m.x*s.y-6*t.x*t.y*s.x*m.x*J-2*o.y*n.x*t.y*H*s.y+3*o.y*t.y*s.x*n.y*H-2*n.x*t.y*s.x*F*m.x-B*n.x*s.x*n.y*m.x+6*t.x*t.y*H*s.y*m.y+2*t.x*D*n.y*s.y*m.y+2*z*o.y*m.x*s.y*m.y+z*n.x*n.y*s.y*m.y+2*D*t.y*s.x*n.y*m.y+2*D*t.y*n.y*m.x*s.y+3*v*s.x*K-3*x*I*s.y+3*L*s.x*K+C*s.x*H-A*s.y*J-3*N*I*s.y-o.x*B*H*s.y+z*o.y*s.x*J-3*v*m.x*s.y*J+3*x*s.x*H*m.y-z*F*m.x*s.y+B*D*s.x*m.y-3*L*m.x*s.y*J+3*N*s.x*H*m.y,p.x*p.y*o.x*n.y*m.x*m.y-p.x*p.y*o.y*n.x*m.x*m.y+p.x*o.x*o.y*n.x*n.y*m.y-p.y*o.x*o.y*n.x*n.y*m.x-p.x*o.x*t.y*n.y*m.x*m.y+6*p.x*t.x*o.y*n.y*m.x*m.y+p.x*o.y*n.x*t.y*m.x*m.y-p.y*o.x*t.x*n.y*m.x*m.y-6*p.y*o.x*n.x*t.y*m.x*m.y+p.y*t.x*o.y*n.x*m.x*m.y-o.x*t.x*o.y*n.x*n.y*m.y+o.x*o.y*n.x*t.y*n.y*m.x+o.x*t.x*t.y*n.y*m.x*m.y-t.x*o.y*n.x*t.y*m.x*m.y-2*p.x*t.x*G*m.x+2*p.y*E*t.y*m.y-3*p.x*p.y*o.x*n.x*J-6*p.x*p.y*t.x*m.x*J+3*p.x*p.y*o.y*n.y*H-2*p.x*p.y*n.x*F*m.x-2*p.x*o.x*t.x*n.y*J-p.x*o.x*o.y*F*m.x+3*p.x*o.x*n.x*t.y*J-4*p.x*t.x*o.y*n.x*J+3*p.y*o.x*t.x*n.x*J+6*p.x*p.y*t.y*H*m.y+2*p.x*p.y*D*n.y*m.y+2*p.x*o.x*B*m.x*m.y+2*p.x*t.x*n.x*F*m.y+6*p.x*t.x*t.y*m.x*J-3*p.x*o.y*t.y*n.y*H+2*p.x*n.x*t.y*F*m.x+p.x*B*n.x*n.y*m.x+p.y*o.x*o.y*D*m.y+4*p.y*o.x*t.y*n.y*H-3*p.y*t.x*o.y*n.y*H+2*p.y*t.x*n.x*F*m.x+2*p.y*o.y*n.x*t.y*H+o.x*t.x*o.y*F*m.x-3*o.x*t.x*n.x*t.y*J-2*p.x*D*t.y*n.y*m.y-6*p.y*t.x*t.y*H*m.y-2*p.y*t.x*D*n.y*m.y-2*p.y*z*o.y*m.x*m.y-p.y*z*n.x*n.y*m.y-2*p.y*D*t.y*n.y*m.x-2*o.x*t.x*B*m.x*m.y-o.x*o.y*D*t.y*m.y+3*t.x*o.y*t.y*n.y*H-2*t.x*n.x*t.y*F*m.x-t.x*B*n.x*n.y*m.x+3*x*o.x*n.x*m.x*m.y+3*o.x*n.x*N*m.x*m.y+2*t.x*D*t.y*n.y*m.y-3*v*o.y*n.y*m.x*m.y+2*z*o.y*t.y*m.x*m.y+z*n.x*t.y*n.y*m.y-3*L*o.y*n.y*m.x*m.y-w*K+y*I+M*K-O*I-3*p.x*L*K-p.x*C*H+3*v*t.x*K+p.y*A*J+3*p.y*N*I+t.x*C*H+v*G*m.x-3*x*t.y*I-x*E*m.y+L*G*m.x-A*t.y*J-E*N*m.y-p.x*z*o.y*J+p.y*o.x*B*H-3*p.x*x*H*m.y-p.x*B*D*m.y+p.y*z*F*m.x-o.x*B*t.y*H+3*v*p.y*m.x*J+v*o.x*n.y*J+2*v*o.y*n.x*J-2*x*o.x*n.y*H-x*o.y*n.x*H+z*t.x*o.y*J-3*p.x*N*H*m.y+3*p.y*L*m.x*J+o.x*L*n.y*J-2*o.x*N*n.y*H+t.x*B*D*m.y-o.y*n.x*N*H-v*n.x*F*m.y-3*v*t.y*m.x*J+3*x*t.x*H*m.y+x*D*n.y*m.x-z*t.y*F*m.x+2*L*o.y*n.x*J+3*t.x*N*H*m.y-L*n.x*F*m.y-3*L*t.y*m.x*J+D*N*n.y*m.x),$=Z.getRootsInInterval(0,1),_=0;_<$.length;_++){var aa=$[_],ba=new Polynomial(m.x,n.x,o.x,p.x-t.x-aa*s.x-aa*aa*r.x-aa*aa*aa*q.x).getRoots(),ca=new Polynomial(m.y,n.y,o.y,p.y-t.y-aa*s.y-aa*aa*r.y-aa*aa*aa*q.y).getRoots();if(ba.length>0&&ca.length>0){var da=1e-4;a:for(var ea=0;ea<ba.length;ea++){var fa=ba[ea];if(fa>=0&&1>=fa)for(var ga=0;ga<ca.length;ga++)if(Math.abs(fa-ca[ga])<da){u.points.push(q.multiply(aa*aa*aa).add(r.multiply(aa*aa).add(s.multiply(aa).add(t))));break a}}}}return u.points.length>0&&(u.status="Intersection"),u},fd.intersectBezier3Circle=function(a,b,c,d,e,f){return fd.intersectBezier3Ellipse(a,b,c,d,e,f,f)},fd.intersectBezier3Ellipse=function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p=new fd("No Intersection");h=a.multiply(-1),i=b.multiply(3),j=c.multiply(-3),k=h.add(i.add(j.add(d))),l=new Vector2D(k.x,k.y),h=a.multiply(3),i=b.multiply(-6),j=c.multiply(3),k=h.add(i.add(j)),m=new Vector2D(k.x,k.y),h=a.multiply(-3),i=b.multiply(3),j=h.add(i),n=new Vector2D(j.x,j.y),o=new Vector2D(a.x,a.y);for(var q=f*f,r=g*g,s=new Polynomial(l.x*l.x*r+l.y*l.y*q,2*(l.x*m.x*r+l.y*m.y*q),2*(l.x*n.x*r+l.y*n.y*q)+m.x*m.x*r+m.y*m.y*q,2*l.x*r*(o.x-e.x)+2*l.y*q*(o.y-e.y)+2*(m.x*n.x*r+m.y*n.y*q),2*m.x*r*(o.x-e.x)+2*m.y*q*(o.y-e.y)+n.x*n.x*r+n.y*n.y*q,2*n.x*r*(o.x-e.x)+2*n.y*q*(o.y-e.y),o.x*o.x*r-2*o.y*e.y*q-2*o.x*e.x*r+o.y*o.y*q+e.x*e.x*r+e.y*e.y*q-q*r),t=s.getRootsInInterval(0,1),u=0;u<t.length;u++){var v=t[u];p.points.push(l.multiply(v*v*v).add(m.multiply(v*v).add(n.multiply(v).add(o))))}return p.points.length>0&&(p.status="Intersection"),p},fd.intersectBezier3Line=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q=e.min(f),r=e.max(f),s=new fd("No Intersection");g=a.multiply(-1),h=b.multiply(3),i=c.multiply(-3),j=g.add(h.add(i.add(d))),k=new Vector2D(j.x,j.y),g=a.multiply(3),h=b.multiply(-6),i=c.multiply(3),j=g.add(h.add(i)),l=new Vector2D(j.x,j.y),g=a.multiply(-3),h=b.multiply(3),i=g.add(h),m=new Vector2D(i.x,i.y),n=new Vector2D(a.x,a.y),p=new Vector2D(e.y-f.y,f.x-e.x),o=e.x*f.y-f.x*e.y,roots=new Polynomial(p.dot(k),p.dot(l),p.dot(m),p.dot(n)+o).getRoots();for(var t=0;t<roots.length;t++){var u=roots[t];if(u>=0&&1>=u){var v=a.lerp(b,u),w=b.lerp(c,u),x=c.lerp(d,u),y=v.lerp(w,u),z=w.lerp(x,u),A=y.lerp(z,u);e.x==f.x?q.y<=A.y&&A.y<=r.y&&(s.status="Intersection",s.appendPoint(A)):e.y==f.y?q.x<=A.x&&A.x<=r.x&&(s.status="Intersection",s.appendPoint(A)):A.gte(q)&&A.lte(r)&&(s.status="Intersection",s.appendPoint(A))}}return s},fd.intersectBezier3Polygon=function(a,b,c,d,e){for(var f=new fd("No Intersection"),g=e.length,h=0;g>h;h++){var i=e[h],j=e[(h+1)%g],k=fd.intersectBezier3Line(a,b,c,d,i,j);f.appendPoints(k.points)}return f.points.length>0&&(f.status="Intersection"),f},fd.intersectBezier3Rectangle=function(a,b,c,d,e,f){var g=e.min(f),h=e.max(f),i=new Zb(h.x,g.y),j=new Zb(g.x,h.y),k=fd.intersectBezier3Line(a,b,c,d,g,i),l=fd.intersectBezier3Line(a,b,c,d,i,h),m=fd.intersectBezier3Line(a,b,c,d,h,j),n=fd.intersectBezier3Line(a,b,c,d,j,g),o=new fd("No Intersection");return o.appendPoints(k.points),o.appendPoints(l.points),o.appendPoints(m.points),o.appendPoints(n.points),o.points.length>0&&(o.status="Intersection"),o},fd.intersectCircleCircle=function(a,b,c,d){var e,f=b+d,g=Math.abs(b-d),h=a.distanceFrom(c);if(h>f)e=new fd("Outside");else if(g>h)e=new fd("Inside");else{e=new fd("Intersection");var i=(b*b-d*d+h*h)/(2*h),j=Math.sqrt(b*b-i*i),k=a.lerp(c,i/h),l=j/h;e.points.push(new Zb(k.x-l*(c.y-a.y),k.y+l*(c.x-a.x))),e.points.push(new Zb(k.x+l*(c.y-a.y),k.y-l*(c.x-a.x)))}return e},fd.intersectCircleEllipse=function(a,b,c,d,e){return fd.intersectEllipseEllipse(a,b,b,c,d,e)},fd.intersectCircleLine=function(a,b,c,d){var e,f=(d.x-c.x)*(d.x-c.x)+(d.y-c.y)*(d.y-c.y),g=2*((d.x-c.x)*(c.x-a.x)+(d.y-c.y)*(c.y-a.y)),h=a.x*a.x+a.y*a.y+c.x*c.x+c.y*c.y-2*(a.x*c.x+a.y*c.y)-b*b,i=g*g-4*f*h;if(0>i)e=new fd("Outside");else if(0==i)e=new fd("Tangent");else{var j=Math.sqrt(i),k=(-g+j)/(2*f),l=(-g-j)/(2*f);(0>k||k>1)&&(0>l||l>1)?e=new fd(0>k&&0>l||k>1&&l>1?"Outside":"Inside"):(e=new fd("Intersection"),k>=0&&1>=k&&e.points.push(c.lerp(d,k)),l>=0&&1>=l&&e.points.push(c.lerp(d,l)))}return e},fd.intersectCirclePolygon=function(a,b,c){for(var d,e=new fd("No Intersection"),f=c.length,g=0;f>g;g++){var h=c[g],i=c[(g+1)%f];d=fd.intersectCircleLine(a,b,h,i),e.appendPoints(d.points)}return e.points.length>0?e.status="Intersection":e.status=d.status,e},fd.intersectCircleRectangle=function(a,b,c,d){var e=c.min(d),f=c.max(d),g=new Zb(f.x,e.y),h=new Zb(e.x,f.y),i=fd.intersectCircleLine(a,b,e,g),j=fd.intersectCircleLine(a,b,g,f),k=fd.intersectCircleLine(a,b,f,h),l=fd.intersectCircleLine(a,b,h,e),m=new fd("No Intersection");return m.appendPoints(i.points),m.appendPoints(j.points),m.appendPoints(k.points),m.appendPoints(l.points),m.points.length>0?m.status="Intersection":m.status=i.status,m},fd.intersectEllipseEllipse=function(a,b,c,d,e,f){for(var g=[c*c,0,b*b,-2*c*c*a.x,-2*b*b*a.y,c*c*a.x*a.x+b*b*a.y*a.y-b*b*c*c],h=[f*f,0,e*e,-2*f*f*d.x,-2*e*e*d.y,f*f*d.x*d.x+e*e*d.y*d.y-e*e*f*f],i=fd.bezout(g,h),j=i.getRoots(),k=.001,l=(g[0]*g[0]+2*g[1]*g[1]+g[2]*g[2])*k,m=(h[0]*h[0]+2*h[1]*h[1]+h[2]*h[2])*k,n=new fd("No Intersection"),o=0;o<j.length;o++)for(var p=new Polynomial(g[0],g[3]+j[o]*g[1],g[5]+j[o]*(g[4]+j[o]*g[2])),q=p.getRoots(),r=0;r<q.length;r++){var s=(g[0]*q[r]+g[1]*j[o]+g[3])*q[r]+(g[2]*j[o]+g[4])*j[o]+g[5];Math.abs(s)<l&&(s=(h[0]*q[r]+h[1]*j[o]+h[3])*q[r]+(h[2]*j[o]+h[4])*j[o]+h[5],Math.abs(s)<m&&n.appendPoint(new Zb(q[r],j[o])))}return n.points.length>0&&(n.status="Intersection"),n},fd.intersectEllipseLine=function(a,b,c,d,e){var f,g=new Vector2D(d.x,d.y),h=Vector2D.fromPoints(d,e),i=new Vector2D(a.x,a.y),j=g.subtract(i),k=new Vector2D(h.x/(b*b),h.y/(c*c)),l=new Vector2D(j.x/(b*b),j.y/(c*c)),m=h.dot(k),n=h.dot(l),a=j.dot(l)-1,o=n*n-m*a;if(0>o)f=new fd("Outside");else if(o>0){var p=Math.sqrt(o),q=(-n-p)/m,r=(-n+p)/m;(0>q||q>1)&&(0>r||r>1)?f=new fd(0>q&&0>r||q>1&&r>1?"Outside":"Inside"):(f=new fd("Intersection"),q>=0&&1>=q&&f.appendPoint(d.lerp(e,q)),r>=0&&1>=r&&f.appendPoint(d.lerp(e,r)))}else{var s=-n/m;s>=0&&1>=s?(f=new fd("Intersection"),f.appendPoint(d.lerp(e,s))):f=new fd("Outside")}return f},fd.intersectEllipsePolygon=function(a,b,c,d){for(var e=new fd("No Intersection"),f=d.length,g=0;f>g;g++){var h=d[g],i=d[(g+1)%f],j=fd.intersectEllipseLine(a,b,c,h,i);e.appendPoints(j.points)}return e.points.length>0&&(e.status="Intersection"),e},fd.intersectEllipseRectangle=function(a,b,c,d,e){var f=d.min(e),g=d.max(e),h=new Zb(g.x,f.y),i=new Zb(f.x,g.y),j=fd.intersectEllipseLine(a,b,c,f,h),k=fd.intersectEllipseLine(a,b,c,h,g),l=fd.intersectEllipseLine(a,b,c,g,i),m=fd.intersectEllipseLine(a,b,c,i,f),n=new fd("No Intersection");return n.appendPoints(j.points),n.appendPoints(k.points),n.appendPoints(l.points),n.appendPoints(m.points),n.points.length>0&&(n.status="Intersection"),n},fd.intersectLineLine=function(a,b,c,d){var e,f=(d.x-c.x)*(a.y-c.y)-(d.y-c.y)*(a.x-c.x),g=(b.x-a.x)*(a.y-c.y)-(b.y-a.y)*(a.x-c.x),h=(d.y-c.y)*(b.x-a.x)-(d.x-c.x)*(b.y-a.y);if(0!=h){var i=f/h,j=g/h;i>=0&&1>=i&&j>=0&&1>=j?(e=new fd("Intersection"),e.points.push(new Zb(a.x+i*(b.x-a.x),a.y+i*(b.y-a.y)))):e=new fd("No Intersection")}else e=new fd(0==f||0==g?"Coincident":"Parallel");return e},fd.intersectLinePolygon=function(a,b,c){for(var d=new fd("No Intersection"),e=c.length,f=0;e>f;f++){var g=c[f],h=c[(f+1)%e],i=fd.intersectLineLine(a,b,g,h);d.appendPoints(i.points)}return d.points.length>0&&(d.status="Intersection"),d},fd.intersectLineRectangle=function(a,b,c,d){var e=c.min(d),f=c.max(d),g=new Zb(f.x,e.y),h=new Zb(e.x,f.y),i=fd.intersectLineLine(e,g,a,b),j=fd.intersectLineLine(g,f,a,b),k=fd.intersectLineLine(f,h,a,b),l=fd.intersectLineLine(h,e,a,b),m=new fd("No Intersection");return m.appendPoints(i.points),m.appendPoints(j.points),m.appendPoints(k.points),m.appendPoints(l.points),m.points.length>0&&(m.status="Intersection"),m},fd.intersectPolygonPolygon=function(a,b){for(var c=new fd("No Intersection"),d=a.length,e=0;d>e;e++){var f=a[e],g=a[(e+1)%d],h=fd.intersectLinePolygon(f,g,b);c.appendPoints(h.points)}return c.points.length>0&&(c.status="Intersection"),c},fd.intersectPolygonRectangle=function(a,b,c){var d=b.min(c),e=b.max(c),f=new Zb(e.x,d.y),g=new Zb(d.x,e.y),h=fd.intersectLinePolygon(d,f,a),i=fd.intersectLinePolygon(f,e,a),j=fd.intersectLinePolygon(e,g,a),k=fd.intersectLinePolygon(g,d,a),l=new fd("No Intersection");return l.appendPoints(h.points),l.appendPoints(i.points),l.appendPoints(j.points),l.appendPoints(k.points),l.points.length>0&&(l.status="Intersection"),l},fd.intersectRayRay=function(a,b,c,d){var e,f=(d.x-c.x)*(a.y-c.y)-(d.y-c.y)*(a.x-c.x),g=(b.x-a.x)*(a.y-c.y)-(b.y-a.y)*(a.x-c.x),h=(d.y-c.y)*(b.x-a.x)-(d.x-c.x)*(b.y-a.y);if(0!=h){var i=f/h;e=new fd("Intersection"),e.points.push(new Zb(a.x+i*(b.x-a.x),a.y+i*(b.y-a.y)))}else e=new fd(0==f||0==g?"Coincident":"Parallel");return e},fd.intersectRectangleRectangle=function(a,b,c,d){var e=a.min(b),f=a.max(b),g=new Zb(f.x,e.y),h=new Zb(e.x,f.y),i=fd.intersectLineRectangle(e,g,c,d),j=fd.intersectLineRectangle(g,f,c,d),k=fd.intersectLineRectangle(f,h,c,d),l=fd.intersectLineRectangle(h,e,c,d),m=new fd("No Intersection");return m.appendPoints(i.points),m.appendPoints(j.points),m.appendPoints(k.points),m.appendPoints(l.points),m.points.length>0&&(m.status="Intersection"),m},fd.bezout=function(a,b){var c=a[0]*b[1]-b[0]*a[1],d=a[0]*b[2]-b[0]*a[2],e=a[0]*b[3]-b[0]*a[3],f=a[0]*b[4]-b[0]*a[4],g=a[0]*b[5]-b[0]*a[5],h=a[1]*b[2]-b[1]*a[2],i=a[1]*b[4]-b[1]*a[4],j=a[1]*b[5]-b[1]*a[5],k=a[2]*b[3]-b[2]*a[3],l=a[3]*b[4]-b[3]*a[4],m=a[3]*b[5]-b[3]*a[5],n=j+l,o=i-k;return new Polynomial(c*h-d*d,c*o+e*h-2*d*f,c*n+e*o-f*f-2*d*g,c*m+e*n-2*f*g,e*m-g*g)},Yb.Intersection=fd,Yb.AreaPicking=function(a,b){this.network=a,this.bounding=b,this.cache={}},Yb.extend(Yb.AreaPicking,Object,{intersectObjects:function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];this.intersectObject(d,b)}return b},getViewPoint:function(a,b){var c=b.vertices[a].clone(),d=this.cache[b.getId()][c.x+" "+c.y+" "+c.z];return d?d:(c.applyMatrix4(b.worldMatrix),d=this.network.getViewPosition(c),d.y=d.h-d.y,d)},intersectObject:function(a,b){if(a instanceof Yb.Entity){this.cache[a.getId()]={};for(var c=0;c<a.vertices.length;c++){var d=a.vertices[c].clone();d.applyMatrix4(a.worldMatrix);var e=this.network.getViewPosition(d);if(e.y=e.h-e.y,this.cache[a.getId()][d.x+" "+d.y+" "+d.z]=e,e.x>this.bounding.x&&e.y>this.bounding.y&&e.x<this.bounding.x+this.bounding.w&&e.y<this.bounding.y+this.bounding.h){var f={element:a};return void b.push(f)}}}}}),Yb.BaseInteraction=function(a){this.network=a,this.view=a.getView()||document},Yb.addEventListener=function(a,b,c,d){var e="_"+a+"_";if(!d[e]){var f=function(a){d[b](a)};d[e]=f,c.addEventListener(a,f,!1)}},Yb.removeEventListener=function(a,b,c){var d="_"+a+"_",e=c[d];e&&(b.removeEventListener(a,e,!1),delete c[d])},Yb.extend(Yb.BaseInteraction,Object,{onPropertyChange:function(){},firePropertyChange:function(){},setUp:function(){},tearDown:function(){},update:function(){},addListener:function(){for(var a=0;a<arguments.length;a++){var b=arguments[a];Yb.addEventListener(b,"handle_"+b,this.network.getRootView(),this)}},removeListener:function(){for(var a=0;a<arguments.length;a++){arguments[a];Yb.removeEventListener(arguments[a],this.network.getRootView(),this)}},isCtrlDown:function(a){return a.ctrlKey||a.metaKey},isFinished:function(){return!0}}),Yb.DefaultInteraction=function(a){Yb.BaseInteraction.call(this,a),this.screen={width:0,height:0,offsetLeft:0,offsetTop:0},this.radius=this.screen.width/4,this.domElement=this.network.getRootView(),this.rotateSpeed=1,this.zoomSpeed=10,this.panSpeed=3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.easing=!0,this.dynamicDampingFactor=.05,this.timeInterval=2e3,this.minDistance=0,this.maxDistance=1/0,this.keys=[65,83,68],this.lastPosition=new Yb.Vec3;var b,c,e=this.STATE.NONE,f=(this.STATE.NONE,new Yb.Vec3),g=new Yb.Vec3,h=new Yb.Vec3,i=new Yb.Vec2,j=new Yb.Vec2,k=0,l=0,m=new Yb.Vec2,n=new Yb.Vec2;this.object=this.network._camera,this.object.target||(this.object.target=new Yb.Vec3),this.movementSpeed=1,this.lookSpeed=.005,this.verticalLookRatio=.1,this.keyboardEnable=!0,this.lookVertical=!0,this.autoForward=!1,this.fpsMode=!1,this.dragMode=!0,this.activeLook=!1,this.heightSpeed=!1,this.heightCoef=1,this.heightMin=0,this.heightMax=1,this.constrainVertical=!1,this.verticalFixed=!1,this.verticalMin=0,this.verticalMax=Math.PI,this.autoSpeedFactor=0,this.mouseX=0,this.mouseY=0,this.lat=0,this.lon=0,this.phi=0,this.theta=0,this.moveForward=!1,this.moveBackward=!1,this.moveLeft=!1,this.moveRight=!1,this.freeze=!1,this.mouseDragOn=!1,this.viewHalfX=0,this.viewHalfY=0,this.lastX=0,this.lastY=0,this.touchSeq=[1,2,3],this.network.getRootView().addEventListener("contextmenu",function(a){a.preventDefault()},!1),this.yRistrict=!0,this.yLowerLimitAngle=-Math.PI/2,this.yUpLimitAngle=Math.PI/2,this.updateIntervalTime=0;var o=null;this.handleResize=function(){this.screen.width=d.innerWidth,this.screen.height=d.innerHeight,this.screen.offsetLeft=0,this.screen.offsetTop=0,this.radius=(this.screen.width+this.screen.height)/4},this.handleResize(),this.handle_mousedown=function(a){if(!bc.isCtrlDown(a)){if(a.preventDefault(),this.fpsMode){if(this.domElement!==document&&this.domElement.focus(),this.activeLook)switch(a.button){case 0:this.moveForward=!0;break;case 2:this.moveBackward=!0}this.lastX=a.pageX,this.lastY=a.pageY,this.mouseDragOn=!0}else e===this.STATE.NONE&&(e=a.button),e!==this.STATE.ROTATE||this.noRotate?this.state!==this.STATE.ZOOM||this.noZoom?e!==this.STATE.PAN||this.noPan||(m=n=this.getMouseOnScreen(a.clientX,a.clientY)):i=j=this.getMouseOnScreen(a.clientX,a.clientY):(g=h=this.getMouseProjectionOnBall(a.clientX,a.clientY),b=c=this.getRotateY(a.clientX,a.clientY));this.beforeUpdate(),this.addListener("mousemove","mouseup")}},this.handle_mousemove=function(a){if(!a.stop){a.preventDefault(),this.fpsMode?this.dragMode?this.mouseDragOn?(this.mouseX=300*(a.pageX-this.lastX),this.mouseY=300*(a.pageY-this.lastY),this.lastX=a.pageX,this.lastY=a.pageY):(this.mouseX=0,this.mouseY=0):this.domElement===document?(this.mouseX=a.pageX-this.viewHalfX,this.mouseY=a.pageY-this.viewHalfY):(this.mouseX=a.pageX-this.domElement.offsetLeft-this.viewHalfX,this.mouseY=a.pageY-this.domElement.offsetTop-this.viewHalfY):e!==this.STATE.ROTATE||this.noRotate?e!==this.STATE.ZOOM||this.noZoom?e!==this.STATE.PAN||this.noPan||(n=this.getMouseOnScreen(a.clientX,a.clientY)):j=this.getMouseOnScreen(a.clientX,a.clientY):(h=this.getMouseProjectionOnBall(a.clientX,a.clientY),c=this.getRotateY(a.clientX,a.clientY));var b=(new Date).getTime();if(null==this._lt)this.update();else{if(b-this._lt<this.updateIntervalTime)return;this.update()}this._lt=b}},this.handle_mouseup=function(a){if(a.preventDefault(),this.fpsMode){if(this.activeLook)switch(a.button){case 0:this.moveForward=!1;break;case 2:this.moveBackward=!1}this.lastX=0,this.lastY=0,this.dragMode&&(this.mouseX=0,this.mouseY=0),this.mouseDragOn=!1}else e=this.STATE.NONE;this.removeListener("mousemove","mouseup"),this.update()},this.handle_touchstart=function(a){if(this.enabled!==!1){switch(a.touches.length){case this.touchSeq[0]:e=this.STATE.TOUCH_ROTATE,g=this.getMouseProjectionOnBall(a.touches[0].pageX,a.touches[0].pageY),b=c=this.getRotateY(a.touches[0].pageX,a.touches[0].pageY),h.copy(g);break;case this.touchSeq[1]:e=this.STATE.TOUCH_ZOOM;var d=a.touches[0].pageX-a.touches[1].pageX,f=a.touches[0].pageY-a.touches[1].pageY;l=k=Math.sqrt(d*d+f*f);break;case this.touchSeq[2]:e=this.STATE.TOUCH_PAN,m.copy(this.getMouseOnScreen(a.touches[0].pageX,a.touches[0].pageY)),n.copy(m);break;default:e=this.STATE.NONE}this.update()}},this.handle_touchmove=function(a){if(this.enabled!==!1){switch(a.preventDefault(),a.touches.length){case this.touchSeq[0]:h=this.getMouseProjectionOnBall(a.touches[0].pageX,a.touches[0].pageY,h),c=this.getRotateY(a.touches[0].pageX,a.touches[0].pageY);break;case this.touchSeq[1]:var b=a.touches[0].pageX-a.touches[1].pageX,d=a.touches[0].pageY-a.touches[1].pageY;l=Math.sqrt(b*b+d*d);break;case this.touchSeq[2]:n=this.getMouseOnScreen(a.touches[0].pageX,a.touches[0].pageY,n);break;default:e=this.STATE.NONE}this.update()}},this.handle_touchend=function(a){if(this.enabled!==!1){switch(a.touches.length){case this.touchSeq[0]:g.copy(this.getMouseProjectionOnBall(a.touches[0].pageX,a.touches[0].pageY,h));break;case this.touchSeq[1]:k=l=0;break;case this.touchSeq[2]:n.copy(this.getMouseOnScreen(a.touches[0].pageX,a.touches[0].pageY)),m.copy(n)}e=this.STATE.NONE,this.update()}},this.handle_DOMMouseScroll=function(a){this.handle_mousewheel(a)},this.handle_mousewheel=function(a){a.preventDefault();var b=0;a.wheelDelta?b=a.wheelDelta%120===0?a.wheelDelta/40:a.wheelDelta:a.detail&&(b=-a.detail/3),b&&(i.y+=1/b*.01),this.mouseMoving=!0,this.update()},this.handle_dblclick=function(a){if(this.isCtrlDown(a)){var b=this.network.getElementsByMouseEvent(a);b.length>0&&(o=b[0]),this.update()}},this.getMouseOnScreen=function(a,b){return new Yb.Vec2((a-this.screen.offsetLeft)/this.radius*.5,(b-this.screen.offsetTop)/this.radius*.5)},this.getRotateY=function(a,b){if(this.yRistrict){var c=(.5*this.screen.height+this.screen.offsetTop-b)/this.screen.height*2;return c}},this.handle_keydown=function(a){if(this.keyboardEnable){switch(a.keyCode){case 38:case 87:this.moveForward=!0;break;case 37:case 65:this.moveLeft=!0;break;case 40:case 83:this.moveBackward=!0;break;case 39:case 68:this.moveRight=!0;break;case 82:this.moveUp=!0;break;case 70:this.moveDown=!0;break;case 81:this.freeze=!this.freeze}this.update()}},this.handle_keyup=function(a){if(this.keyboardEnable){switch(a.keyCode){case 38:case 87:this.moveForward=!1;break;case 37:case 65:this.moveLeft=!1;break;case 40:case 83:this.moveBackward=!1;break;case 39:case 68:this.moveRight=!1;break;case 82:this.moveUp=!1;break;case 70:this.moveDown=!1}this.update()}},this.getMouseProjectionOnBall=function(a,b){if(this.yRistrict){var c=new Yb.Vec3((a-.5*this.screen.width-this.screen.offsetLeft)/(.5*this.screen.width),0,0),d=c.length();return d>1?c.normalize():c.z=Math.sqrt(1-d*d),c.normalize()}var c=new Yb.Vec3((a-.5*this.screen.width-this.screen.offsetLeft)/this.radius,(.5*this.screen.height+this.screen.offsetTop-b)/this.radius,0),d=c.length();d>1?c.normalize():c.z=Math.sqrt(1-d*d),f.copy(this.object._position).sub(this.object.target);var e=this.object.up.clone().setLength(c.y);return e.add(this.object.up.clone().cross(f).setLength(c.x)),e.add(f.setLength(c.z)),e},this.rotateCamera=function(){var a=g.dot(h)/g.length()/h.length(),d=Math.acos(a),e=!this.easing||Math.abs(d)<1e-4,i=!1;if(d){var j=(new Yb.Vec3).crossVectors(g,h).normalize(),k=new Yb.Quat;k.setFromAxisAngle(j,-d*this.dynamicDampingFactor*this.rotateSpeed),e?(k.setFromAxisAngle(j,-d*this.rotateSpeed),f.applyQuaternion(k),this.object.up.applyQuaternion(k),g.copy(h)):(k.setFromAxisAngle(j,-d*this.dynamicDampingFactor*this.rotateSpeed),f.applyQuaternion(k),this.object.up.applyQuaternion(k),k.setFromAxisAngle(j,d*this.dynamicDampingFactor),g.applyQuaternion(k),i=!0)}var e=!this.easing||Math.abs(c-b)<1e-4,l=(c-b)*f.length();if(!sc.isNaN(l))if(e)l&&this.yRistrict&&this.limitY(l),b=c;else{var l=l*this.dynamicDampingFactor;l&&this.yRistrict&&this.limitY(l),b+=(c-b)*this.dynamicDampingFactor,i=!0}i&&this.network.dirtyNetwork()},this.limitY=function(a){var b=f.length();Math.abs(f.x)<=.1*b&&Math.abs(f.z)<=.1*b&&(f.x=.1*b);var c=f.x,d=f.z,e=Math.sqrt(c*c+d*d),g=Math.tan(this.yLowerLimitAngle)*e,h=Math.tan(this.yUpLimitAngle)*e;f.y-=a,f.y>h?f.y=h:f.y<g&&(f.y=g)},this.getValueByTime=function(a,b){var c=(new Date).getTime(),d=c-this._timeStart;return d>this.timeInterval?b:a+(b-a)*d/this.timeInterval},this.zoomCamera=function(){if(e===this.STATE.TOUCH_ZOOM){var a=k/l;k=l,f.multiplyScalar(a)}else{var b=this.zoomSpeed;this.easing||(b*=5);var a;a=1+(j.y-i.y)*b,1!==a&&a>0&&(f.multiplyScalar(a),!this.easing||Math.abs(j.y-i.y)<.001?i.copy(j):(i.y+=(j.y-i.y)*this.dynamicDampingFactor,this.network.dirtyNetwork()))}},this.panCamera=function(){var a=n.clone().sub(m);if(a.lengthSq()){a.multiplyScalar(f.length()*this.panSpeed);var b=f.clone().cross(this.object.up).setLength(a.x),c=(new ac).extractRotation(this.object.matrix),d=this.object.up.clone().applyMatrix4(c);b.add(d.setLength(a.y));var e=this.object.p().add(b);this.object.checkPosition(e)&&(this.object.p(e),this.object.target.add(b)),m=n,this.network.dirtyNetwork()}},this.checkAngles=function(){},this.checkDistances=function(){this.noZoom&&this.noPan||(f.lengthSq()>this.maxDistance*this.maxDistance&&this.object._position.addVectors(this.object.target,f.setLength(this.maxDistance)),f.lengthSq()<this.minDistance*this.minDistance&&this.object._position.addVectors(this.object.target,f.setLength(this.minDistance)))},this.updateFPS=function(){var a=2;if(!this.freeze){if(this.heightSpeed){var b=Yb.Math.clamp(this.object._position.y,this.heightMin,this.heightMax),c=b-this.heightMin;this.autoSpeedFactor=a*c*this.heightCoef}else this.autoSpeedFactor=0;var d=a*this.movementSpeed;if(this.moveForward||this.autoForward&&!this.moveBackward){var e=this.object._position.clone();
this.object.translateZ(-(d+this.autoSpeedFactor));var g=this.object.target;this.verticalFixed&&this.object.setY(e.y);var h=this.object._position,i=new $b,j=new $b;i.subVectors(h,g),j.subVectors(e,g),i.z*j.z<=this.minDistance*this.minDistance&&this.object.target.subVectors(this.object._position,f)}if(this.moveBackward){var e=this.object._position.clone();this.object.translateZ(d),this.verticalFixed&&this.object.setY(e.y)}this.moveLeft&&(this.object.translateX(-d),this.object.target.subVectors(this.object._position,f)),this.moveRight&&(this.object.translateX(d),this.object.target.subVectors(this.object._position,f)),this.moveUp&&(this.object.translateY(d),this.object.target.subVectors(this.object._position,f)),this.moveDown&&(this.object.translateY(-d),this.object.target.subVectors(this.object._position,f));var k=a*this.lookSpeed;this.activeLook||this.dragMode||(k=0);var l=this.verticalLookRatio;if(this.constrainVertical&&(l=Math.PI/(this.verticalMax-this.verticalMin)),this.lon+=this.mouseX*k,this.dragMode&&(this.mouseX=0),this.lookVertical&&(this.lat-=this.mouseY*k*l),this.lat=Math.max(-85,Math.min(85,this.lat)),this.phi=Yb.Math.degToRad(90-this.lat),this.theta=Yb.Math.degToRad(this.lon),this.constrainVertical&&(this.phi=Yb.Math.mapLinear(this.phi,0,Math.PI,this.verticalMin,this.verticalMax)),this.fpsMode){var m=this.object.target,h=this.object._position;m.x=h.x+100*Math.sin(this.phi)*Math.sin(this.theta),m.y=h.y+100*Math.cos(this.phi),m.z=h.z-100*Math.sin(this.phi)*Math.cos(this.theta),this.object.look(m)}}},this.update=function(){if(f.subVectors(this.object._position,this.object.target),this.noRotate||this.fpsMode||this.rotateCamera(),this.noZoom||this.zoomCamera(),this.noPan||this.fpsMode||this.panCamera(),o&&o.element&&this.network.doubleClickToLookAtFunction(o.element)){this.object.target=o.point;var a=this.object._position.distanceTo(this.object.target),b=o.face.normal.clone();b=b.applyMatrix4((new Yb.Mat4).extractRotation(o.element.worldMatrix)),b.normalize(),f=b.multiplyScalar(a),o=null}this.object.setPosition(this.object._position.clone().addVectors(this.object.target,f)),this.updateFPS(),this.fpsMode||(this.checkDistances(),this.object.look(this.object.target)),this.lastPosition.distanceToSquared(this.object._position)>0&&this.lastPosition.copy(this.object._position)}},Yb.extend(Yb.DefaultInteraction,Yb.BaseInteraction,{STATE:{NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM:4,TOUCH_PAN:5},__accessor:["rotateSpeed","zoomSpeed","panSpeed","yLowerLimitAngle","yUpLimitAngle","minDistance","maxDistance","easing","touchSeq"],__bool:["noRotate","noPan","noZoom","fpsMode","yRistrict","keyboardEnable"],setUp:function(){this.addListener("mousedown","touchstart","touchend","touchmove","mousewheel","DOMMouseScroll","dblclick","keydown","keyup")},tearDown:function(){this.removeListener("mousedown","touchstart","touchend","touchmove","mousewheel","DOMMouseScroll","dblclick","keydown","keyup")},beforeUpdate:function(){},setUpdateIntervalTime:function(a){this.updateIntervalTime=a}}),Yb.SelectionInteraction=function(a){Yb.BaseInteraction.call(this,a),this.selectUnVisible=!0,this.ctrlDown=!1,this.deleteTimeoutId=null,this._areaPickingLevel=1},Yb.extend(Yb.SelectionInteraction,Yb.BaseInteraction,{constructor:Yb.SelectionInteraction,setAreaPickingLevel:function(a){this._areaPickingLevel=a},getAreaPickingLevel:function(){return this._areaPickingLevel},setUp:function(){this.addListener("mousedown")},tearDown:function(){this.removeListener("mousedown")},setFocus:function(a){if(document.activeElement!==a){var b,c,d,e=document.documentElement;document.body;e&&(cc.isIE||cc.isOpera||e.scrollLeft||e.scrollTop)&&(b=e.scrollLeft,c=e.scrollTop,d=e),a.focus(),d&&(d.scrollLeft=b,d.scrollTop=c)}},handle_mousedown:function(a){if(1!=a.stop&&!bc.isRightClick(a)){this.setFocus(this.network.getView()),this.isCtrlDown(a)?(this.addListener("mousemove","mouseup"),this.ctrlDownEvent=a):this.network.getDataBox().clearSelection();var b=this.network.getElementsByMouseEvent(a,!0),c=this.network.getFirstSelectElement(b);this.network.getDataBox().getSelectionModel().appendSelection(c),this.network.onSelect(c)}},handle_mousemove:function(a){var b=this.getBoundingByMouseEvent(a,this.ctrlDownEvent,this.network.devicePixelRatio);this.mousemoved=!0,this.network.areaPickingRect=b,this.network.paintTopCanvas()},handle_mouseup:function(a){this.network.areaPickingRect=null,this.network.paintTopCanvas();var b=this.getBoundingByMouseEvent(a,this.ctrlDownEvent);if(this.removeListener("mousemove","mouseup"),this.ctrlDownEvent=null,b&&this.mousemoved){var c=this.network.getElementsByBounding(b,!0,this._areaPickingLevel),d=new kc;if(c.length>0)for(var e=0;e<c.length;e++){var f=c[e].element;this.network.selectable(c[e])&&d.add(f)}d.size()>0&&this.network.getDataBox().getSelectionModel().appendSelection(d)}},getBoundingByMouseEvent:function(a,b,c){if(a&&b){var d=this.network.getView().getBoundingClientRect(),e=a.clientX-d.left,f=a.clientY-d.top,g=b.clientX-d.left,h=b.clientY-d.top,i=c||1,j=Math.min(e,g)*i,k=Math.min(f,h)*i,l=Math.abs(e-g)*i,m=Math.abs(f-h)*i;return 0===l&&0===m?null:{x:j,y:k,w:l,h:m}}}}),Yb.TransformGizmo=function(){var a=new Yb.TransformGizmoMaterial({color:16711680}),b=new Yb.TransformGizmoMaterial({color:65280}),c=new Yb.TransformGizmoMaterial({color:255});this.handleGizmos={X:[new Yb.Cylinder(a,.005,.005,1,4,1,!1,!1),new $b(.5,0,0),new $b(0,0,-Math.PI/2)],Y:[new Yb.Cylinder(b,.005,.005,1,4,1,!1,!1),new $b(0,.5,0)],Z:[new Yb.Cylinder(c,.005,.005,1,4,1,!1,!1),new $b(0,0,.5),new $b(Math.PI/2,0,0)]};var d=!1,f=!1;this.showHelpers=!0,this.showable=!0,this.init=function(){Yb.Element.call(this),this.handles=new Yb.Element,this.pickers=new Yb.Element,this.planes=new Yb.Element,this.addChild(this.handles),this.addChild(this.pickers),this.addChild(this.planes);var a=new Yb.BasicMaterial({wireframe:!1,color:65535,side:Yb.DoubleSide}),b=(new Yb.Plane(a,5e4,5e4,2,2),{XY:new Yb.Plane(a,5e4,5e4,2,2),YZ:new Yb.Plane(a,5e4,5e4,2,2),XZ:new Yb.Plane(a,5e4,5e4,2,2),XYZE:new Yb.Plane(a,5e4,5e4,2,2)});b.YZ._rotation.set(0,Math.PI/2,0),b.XZ._rotation.set(-Math.PI/2,0,0);for(var c in b)b[c].name=c,this.planes.addChild(b[c]),this.planes[c]=b[c],b[c]._visible=!0;for(var c in this.handleGizmos){var d=this.handleGizmos[c][0];if(d.name=c,this.handleGizmos[c][1]&&d._position.set(this.handleGizmos[c][1].x,this.handleGizmos[c][1].y,this.handleGizmos[c][1].z),this.handleGizmos[c][2]&&d._rotation.set(this.handleGizmos[c][2].x,this.handleGizmos[c][2].y,this.handleGizmos[c][2].z),d.mode=this.mode,this.handles.addChild(d),this.pickerGizmos&&this.pickerGizmos[c]){var e=this.pickerGizmos[c][0];this.pickerGizmos[c][1]&&e._position.set(this.pickerGizmos[c][1].x,this.pickerGizmos[c][1].y,this.pickerGizmos[c][1].z),this.pickerGizmos[c][2]&&e._rotation.set(this.pickerGizmos[c][2].x,this.pickerGizmos[c][2].y,this.pickerGizmos[c][2].z)}else var e=d.clone();e.mode=this.mode,e.name=c,this.pickers.addChild(e)}this.iterator(function(a){a instanceof Yb.Entity&&Yb.Utils.transformElement(a)})},this.hide=function(){this.handles.getChildren().forEach(function(a){a._visible=!1}),this.pickers.getChildren().forEach(function(a){a._visible=!1}),this.planes.getChildren().forEach(function(a){a._visible=!1})},this.show=function(){var a=this;this.handles.getChildren().forEach(function(b){b._visible=a.showHelpers&&a.showable}),this.pickers.getChildren().forEach(function(a){a._visible=d}),this.activePlane&&(this.activePlane._visible=f)},this.highlight=function(a){var b;for(var c in this.handleGizmos)b=this.handleGizmos[c][0],b.oldColor&&(b.material instanceof Yb.ArrayMaterial?(b.material.materials[0].color.copy(b.oldColor),b.material.materials[0].opacity=b.oldOpacity):(b.material.color.copy(b.oldColor),b.material.opacity=b.oldOpacity),b.oldColor=null);this.handleGizmos[a]&&(b=this.handleGizmos[a][0],b.material instanceof Yb.ArrayMaterial?(b.oldColor=b.oldColor||b.material.materials[0].color.clone(),b.oldOpacity=b.oldOpacit!==e?b.oldOpacity:b.material.materials[0].opacity,b.material.materials[0].opacity=1):(b.oldColor=b.oldColor||b.material.color.clone(),b.oldOpacity=b.material.opacity,b.setStyle("material.opacity",1)))},this.init()},Yb.TransformGizmo.prototype=Object.create(Yb.Element.prototype),Yb.TransformGizmo.prototype.update=function(a,b){for(var c=new $b(0,0,0),d=new $b(0,1,0),e=new ac,f=0;f<this.getChildren().size();f++)for(var g=0;g<this.getChildren().get(f).getChildren().size();g++){var h=this.getChildren().get(f).getChildren().get(g);-1!=h.name.search("E")?(h.quaternion.setFromRotationMatrix(e.lookAt(b,c,d)),h._rotation.setEulerFromQuaternion(h.quaternion)):(h.quaternion.setFromEuler(a),h._rotation.setEulerFromQuaternion(h.quaternion))}},Yb.TransformGizmoTranslate=function(){Yb.TransformGizmo.call(this);var a=new Yb.TransformGizmoMaterial({color:16711680,opacity:.2}),b=new Yb.TransformGizmoMaterial({color:65280,opacity:.2}),c=new Yb.TransformGizmoMaterial({color:255,opacity:.2}),d=new Yb.Arrow(a,1,.03,.2,.05,30),e=new Yb.Arrow(b,1,.03,.2,.05,30),f=new Yb.Arrow(c,1,.03,.2,.05,30),g=new Yb.TransformGizmoMaterial({color:255,opacity:.5}),h=new Yb.TransformGizmoMaterial({color:16711680,opacity:.5}),i=new Yb.TransformGizmoMaterial({color:65280,opacity:.5}),j=new Yb.TransformGizmoMaterial({color:16777215,opacity:.5}),k=new Yb.Circle(g,.5,10,0,Math.PI/2),l=new Yb.Circle(h,.5,10,0,Math.PI/2),m=new Yb.Circle(i,.5,10,0,Math.PI/2),n=new Yb.Octahedron(j,1e-4,0);this.handleGizmos={X:[d,new $b(1.6,0,0),new $b(0,0,-Math.PI/2)],Y:[e,new $b(0,1.6,0)],Z:[f,new $b(0,0,1.6),new $b(Math.PI/2,0,0)],XYZ:[n],XY:[k,new $b(0,0,0)],YZ:[l,new $b(0,0,0),new $b(Math.PI/2,Math.PI/2,0)],XZ:[m,new $b(0,0,0),new $b(Math.PI/2,0,0)]};var j=new Yb.TransformGizmoMaterial({color:16711680,opacity:.25}),o=new Yb.TransformGizmoMaterial({color:65280,opacity:.25}),p=new Yb.TransformGizmoMaterial({color:255,opacity:.25}),q=new Yb.Cylinder(j,.075,0,1.2,4,1,!1),r=new Yb.Cylinder(o,.075,0,1.2,4,1,!1),s=new Yb.Cylinder(p,.075,0,1.2,4,1,!1),n=new Yb.Octahedron(j,1e-4,0);this.pickerGizmos={X:[q,new $b(1.6,0,0),new $b(0,0,-Math.PI/2)],Y:[r,new $b(0,1.6,0)],Z:[s,new $b(0,0,1.6),new $b(Math.PI/2,0,0)],XYZ:[n]},this.setActivePlane=function(a,b){var c=new ac;b.applyProjection(c.getInverse(c.extractRotation(this.planes.XY.worldMatrix))),"X"==a&&(this.activePlane=this.planes.XY,Math.abs(b.y)>Math.abs(b.z)&&(this.activePlane=this.planes.XZ)),"Y"==a&&(this.activePlane=this.planes.XY,Math.abs(b.x)>Math.abs(b.z)&&(this.activePlane=this.planes.YZ)),"Z"==a&&(this.activePlane=this.planes.XZ,Math.abs(b.x)>Math.abs(b.y)&&(this.activePlane=this.planes.YZ)),"XYZ"==a&&(this.activePlane=this.planes.XYZE),"XY"==a&&(this.activePlane=this.planes.XY),"YZ"==a&&(this.activePlane=this.planes.YZ),"XZ"==a&&(this.activePlane=this.planes.XZ),this.hide(),this.show()},this.init()},Yb.TransformGizmoTranslate.prototype=Object.create(Yb.TransformGizmo.prototype),Yb.TransformGizmoTranslate.prototype.mode="translate",Yb.TransformGizmoRotate=function(){Yb.TransformGizmo.call(this);var a=new Yb.TransformGizmoMaterial({color:16711680,opacity:.2}),b=new Yb.TransformGizmoMaterial({color:65280,opacity:.2}),c=new Yb.TransformGizmoMaterial({color:255,opacity:.2}),d=new Yb.TransformGizmoMaterial({color:16776960}),e=new Yb.TransformGizmoMaterial({color:7895160,opacity:.25}),e=new Yb.TransformGizmoMaterial({color:16711680}),f=new Yb.Torus(a,1,.02,4,32,Math.PI),g=new Yb.Torus(b,1,.02,4,32,Math.PI),h=new Yb.Torus(c,1,.02,4,32,Math.PI);new Yb.Torus(d,1.25,.01,4,64),new Yb.Torus(e,1,.01,4,64);this.handleGizmos={X:[f,new $b(0,0,0),new $b(0,-Math.PI/2,-Math.PI/2)],Y:[g,new $b(0,0,0),new $b(Math.PI/2,0,0)],Z:[h,new $b(0,0,0),new $b(0,0,-Math.PI/2)]};var i=new Yb.TransformGizmoMaterial({color:16711680,opacity:.25}),j=new Yb.TransformGizmoMaterial({color:65280,opacity:.25}),k=new Yb.TransformGizmoMaterial({color:255,opacity:.25}),l=new Yb.TransformGizmoMaterial({color:983040,opacity:.25}),m=new Yb.Torus(i,1,.05,4,12,Math.PI),n=new Yb.Torus(j,1,.05,4,12,Math.PI),o=new Yb.Torus(k,1,.05,4,12,Math.PI);new Yb.Torus(l,1,.05,2,24);this.pickerGizmos={X:[m,new $b(0,0,0),new $b(0,-Math.PI/2,-Math.PI/2)],Y:[n,new $b(0,0,0),new $b(Math.PI/2,0,0)],Z:[o,new $b(0,0,0),new $b(0,0,-Math.PI/2)]},this.setActivePlane=function(a){"E"==a&&(this.activePlane=this.planes.XYZE),"X"==a&&(this.activePlane=this.planes.YZ),"Y"==a&&(this.activePlane=this.planes.XZ),"Z"==a&&(this.activePlane=this.planes.XY),this.hide(),this.show()},this.update=function(a,b){Yb.TransformGizmo.prototype.update.apply(this,arguments);var c={handles:this.handles,pickers:this.pickers},d=new ac,e=new Yb.Euler(0,0,1),f=new Yb.Quat,g=new $b(1,0,0),h=new $b(0,1,0),i=new $b(0,0,1),j=new Yb.Quat,k=new Yb.Quat,l=new Yb.Quat,m=b.clone();e.copy(this.planes.XY._rotation),f.setFromEuler(e),d.makeRotationFromQuaternion(f).getInverse(d),m.applyProjection(d);for(var n in c)for(var o=0;o<c[n].getChildren().size;o++){var p=c[n].getChildren().get(o);f.setFromEuler(e),"X"==p.name&&(j.setFromAxisAngle(g,Math.atan2(-m.y,m.z)),f.multiplyQuaternions(f,j),p.quaternion.copy(f)),"Y"==p.name&&(k.setFromAxisAngle(h,Math.atan2(m.x,m.z)),f.multiplyQuaternions(f,k),p.quaternion.copy(f)),"Z"==p.name&&(l.setFromAxisAngle(i,Math.atan2(m.y,m.x)),f.multiplyQuaternions(f,l),p.quaternion.copy(f))}},this.init()},Yb.TransformGizmoRotate.prototype=Object.create(Yb.TransformGizmo.prototype),Yb.TransformGizmoRotate.prototype.mode="rotate",Yb.TransformGizmoScale=function(){Yb.TransformGizmo.call(this);var a=new Yb.TransformGizmoMaterial({color:11184810,opacity:1}),b=new Yb.TransformGizmoMaterial({color:16711680,opacity:.2}),c=new Yb.TransformGizmoMaterial({color:65280,opacity:.2}),d=new Yb.TransformGizmoMaterial({color:255,opacity:.2}),e=new Yb.Cube(a,.25,.25,.25),f=new Yb.Cylinder(null,.1,.1,1,4,1,!1),g=new Yb.Cube(a,.225,.225,.225),h=new Yb.Cylinder(null,.1,0,1,20,1,!0);h._position.y=.05;var h=Yb.Utils.createElement(f,h,b),i=(Yb.Utils.createElement(f,h,c),Yb.Utils.createElement(f,h,d),new Yb.Cylinder(b,.08,0,1,4,1,!1)),j=new Yb.Cylinder(c,.08,0,1,4,1,!1),k=new Yb.Cylinder(d,.08,0,1,4,1,!1),l=new Yb.Element;l.material=new Yb.BasicMaterial;var m=new Yb.Element;m.material=new Yb.BasicMaterial;var n=new Yb.Element;n.material=new Yb.BasicMaterial,this.handleGizmos={X:[i,new $b(.5,0,0),new $b(0,0,-Math.PI/2)],Y:[j,new $b(0,.5,0)],Z:[k,new $b(0,0,.5),new $b(Math.PI/2,0,0)],XY:[l],YZ:[m],XZ:[n],XYZ:[e]};var o=new Yb.TransformGizmoMaterial({color:16711680,opacity:.25}),p=new Yb.TransformGizmoMaterial({color:65280,opacity:.25}),q=new Yb.TransformGizmoMaterial({color:255,opacity:.25}),r=new Yb.Cylinder(o,.125,0,1,4,1,!1),s=new Yb.Cylinder(p,.125,0,1,4,1,!1),t=new Yb.Cylinder(q,.125,0,1,4,1,!1);this.pickerGizmos={X:[r,new $b(.6,0,0),new $b(Math.PI/4,0,-Math.PI/2)],Y:[s,new $b(0,.6,0),new $b(0,Math.PI/4,0)],Z:[t,new $b(0,0,.6),new $b(Math.PI/2,Math.PI/4,0)],XYZ:[g]},this.setActivePlane=function(a,b){var c=new ac;b.applyProjection(c.getInverse(c.extractRotation(this.planes.XY.worldMatrix))),"X"==a?(this.activePlane=this.planes.XY,Math.abs(b.y)>Math.abs(b.z)&&(this.activePlane=this.planes.XZ)):"Y"==a?(this.activePlane=this.planes.XY,Math.abs(b.x)>Math.abs(b.z)&&(this.activePlane=this.planes.YZ)):"Z"==a?(this.activePlane=this.planes.XZ,Math.abs(b.x)>Math.abs(b.y)&&(this.activePlane=this.planes.YZ)):"XYZ"==a?this.activePlane=this.planes.XYZE:this.activePlane=this.planes[a],this.hide(),this.show()},this.init()},Yb.TransformGizmoScale.prototype=Object.create(Yb.TransformGizmo.prototype),Yb.TransformGizmoScale.prototype.mode="scale",Yb.EditInteraction=function(a){function b(b){if(r.network._keyboardRemoveEnabled&&46==b.keyCode&&a.getDataBox().getSelectionModel().size()>0){var c="Delete?";d.confirm(c)&&a.getDataBox().removeSelection()}}function c(a){1===a.touches.length&&(r.deleteTimeoutId=setTimeout(function(){var b=r.network.getElementsByMouseEvent(a,r.selectUnVisible);if(b.length>0){var c=b[0],e="Delete?";d.confirm(e)&&r.network.getDataBox().remove(c.element)}},300))}function f(a){clearTimeout(r.deleteTimeoutId)}function g(a){clearTimeout(r.deleteTimeoutId)}function h(a){r.update()}function i(a){if(r.object&&!s){a.preventDefault(),a.stopPropagation();var b=a.touches?a.touches[0]:a,c=n(b,r.filterIntersectPicker(r.pickers));if(c)r.axis=c.object.name,r.setMode(c.object.mode);else{var d=l(a);d===r.object||null!=d&&d.editTransformToParent&&d.isDescendantOf(r.object)?(r.axis=r.getAxis(),r.setMode(r.getMode())):r.axis=!1}r.update(!0)}}function j(b){if(!b.stop){if(X.set(b.clientX,b.clientY),r.showHelpers&&r.axis||(m(b),i(b)),!r.object||s)return void r.network.dirtyNetwork();b.preventDefault(),b.stopPropagation();var c=b.touches?b.touches[0]:b;if(0===c.button||c.button==e){var d=r.filterIntersectPicker(r.pickers),f=n(c,d),g=l(b);if(f||(g===r.object||null!=g&&g.editTransformToParent&&g.isDescendantOf(r.object))&&r.getDefaultPickers()&&(f={object:r.getDefaultPickers()}),f){r.axis=f.object.name,A.copy(U).sub(R).normalize(),r.gizmo[t].setActivePlane(r.axis,A);var h=n(c,[r.gizmo[t].activePlane]);if(!h&&g&&(h=n(c,[g])),h){M.copy(r.object._position),N.copy(r.object._scale),O.extractRotation(r.object.matrix),T.extractRotation(r.object.worldMatrix);var j=r.object.getParent();j==e&&(j=a),P.extractRotation(j.worldMatrix),Q.getScaleFromMatrix(B.getInverse(j.worldMatrix)),v.copy(h.point)}}}r.update(!0),s=!0}}function k(b){if(r.object&&r.axis&&s){b.preventDefault(),b.stopPropagation(),b.stop=!0;var c=b.touches?b.touches[0]:b,d=n(c,[r.gizmo[t].activePlane]);if(d||(d=n(c,[r.object])),d){if(r.moving?a.fireInteractionEvent({kind:"liveMoveBetween",event:Tc}):(a.fireInteractionEvent({kind:"liveMoveStart",event:Tc}),r.moving=!0),u.copy(d.point),"translate"==t&&r.translateable){if(u.sub(v),u.multiply(Q),"local"==r.space&&(u.applyMatrix4(B.getInverse(T)),-1==r.axis.search("X")&&(u.x=0),-1==r.axis.search("Y")&&(u.y=0),-1==r.axis.search("Z")&&(u.z=0),u.applyMatrix4(O),r.object.setPosition(M.clone().add(u))),"world"==r.space||-1!=r.axis.search("XYZ")){-1==r.axis.search("X")&&(u.x=0),-1==r.axis.search("Y")&&(u.y=0),-1==r.axis.search("Z")&&(u.z=0),u.applyMatrix4(B.getInverse(P)),r.object._position.copy(M);var e=r.object._position.clone().add(u);r.snap&&(-1!=r.axis.search("X")&&(e.x=Math.round(r.object._position.x/r.snap)*r.snap),-1!=r.axis.search("Y")&&(e.y=Math.round(r.object._position.y/r.snap)*r.snap),-1!=r.axis.search("Z")&&(e.z=Math.round(r.object._position.z/r.snap)*r.snap)),r.object.setPosition(e)}}else if("scale"==t&&r.scaleable){u.sub(v),u.multiply(Q);var f=r.object._scale.clone(),g=(r.scaleRate||1)/10;if("XYZ"==r.axis)j=1+u.y*g,f.x=N.x*j,f.y=N.y*j,f.z=N.z*j;else if("XY"===r.axis){var h=1+u.x*g,i=1+u.y*g;if(r.forceSameScale){var j=Math.max(h,i);f.x=N.x*j,f.y=N.y*j}else f.x=N.x*h,f.y=N.y*i}else if("YZ"===r.axis){var k=1+u.z*g,i=1+u.y*g;if(r.forceSameScale){var j=Math.max(k,i);f.z=N.z*j,f.y=N.y*j}else f.z=N.z*k,f.y=N.y*i}else if("XZ"===r.axis){var h=1+u.x*g,k=1+u.z*g;if(r.forceSameScale){var j=Math.max(h,i);f.x=N.x*j,f.z=N.z*j}else f.x=N.x*h,f.z=N.z*k}else u.applyMatrix4(B.getInverse(T)),"X"==r.axis&&(f.x=N.x*(1+u.x*g)),"Y"==r.axis&&(f.y=N.y*(1+u.y*g)),"Z"==r.axis&&(f.z=N.z*(1+u.z*g));r.object.setScale(f)}else if("rotate"==t&&r.rotateable)if(u.sub(R),u.multiply(Q),C.copy(v).sub(R),C.multiply(Q),"E"==r.axis)u.applyMatrix4(B.getInverse(z)),C.applyMatrix4(B.getInverse(z)),w.set(Math.atan2(u.z,u.y),Math.atan2(u.x,u.z),Math.atan2(u.y,u.x)),x.set(Math.atan2(C.z,C.y),Math.atan2(C.x,C.z),Math.atan2(C.y,C.x)),D.setFromRotationMatrix(B.getInverse(P)),L.setFromAxisAngle(A,w.z-x.z),H.setFromRotationMatrix(T),D.multiplyQuaternions(D,L),D.multiplyQuaternions(D,H),r.object.quaternion.copy(D);else if("XYZE"==r.axis)L.setFromEuler(u.clone().cross(C).normalize()),D.setFromRotationMatrix(B.getInverse(P)),I.setFromAxisAngle(L,-u.clone().angleTo(C)),H.setFromRotationMatrix(T),D.multiplyQuaternions(D,I),D.multiplyQuaternions(D,H),r.object.quaternion.copy(D);else if("local"==r.space){u.applyMatrix4(B.getInverse(T)),C.applyMatrix4(B.getInverse(T)),w.set(Math.atan2(u.z,u.y),Math.atan2(u.x,u.z),Math.atan2(u.y,u.x)),x.set(Math.atan2(C.z,C.y),Math.atan2(C.x,C.z),Math.atan2(C.y,C.x)),H.setFromRotationMatrix(O),I.setFromAxisAngle(E,w.x-x.x),J.setFromAxisAngle(F,w.y-x.y),K.setFromAxisAngle(G,w.z-x.z),"X"==r.axis&&H.multiplyQuaternions(H,I),"Y"==r.axis&&H.multiplyQuaternions(H,J),"Z"==r.axis&&H.multiplyQuaternions(H,K),r.object.quaternion.copy(H);var l=r.object._rotation.clone();l.setEulerFromQuaternion(H),r.object.setRotation(l)}else if("world"==r.space){w.set(Math.atan2(u.z,u.y),Math.atan2(u.x,u.z),Math.atan2(u.y,u.x)),x.set(Math.atan2(C.z,C.y),Math.atan2(C.x,C.z),Math.atan2(C.y,C.x)),D.setFromRotationMatrix(B.getInverse(P)),I.setFromAxisAngle(E,w.x-x.x),J.setFromAxisAngle(F,w.y-x.y),K.setFromAxisAngle(G,w.z-x.z),H.setFromRotationMatrix(T),"X"==r.axis&&D.multiplyQuaternions(D,I),"Y"==r.axis&&D.multiplyQuaternions(D,J),"Z"==r.axis&&D.multiplyQuaternions(D,K),D.multiplyQuaternions(D,H),r.object.quaternion.copy(D);var l=r.object._rotation.clone();l.setEulerFromQuaternion(D),r.object.setRotation(l)}r.changed=!0}r.update(!0),r.updateTextNote(b,r.object)}}function l(b){var c=r.network.getElementsByMouseEvent(b);return a.getFirstEditElement(c)}function m(b){if(null===W&&(W=new Zb),W.set(b.clientX,b.clientY),a.getDataBox().clearEditing(),0===W.distanceTo(X)){var c=r.network.getElementsByMouseEvent(b),d=a.getFirstEditElement(c);d&&(d!==r.object,r.object=d,r.translateable&&r.gizmo.translate.show(),r.rotateable&&r.gizmo.rotate.show(),r.scaleable&&r.gizmo.scale.show()),d||(r.gizmo[t].hide(),r.gizmo.translate.hide(),r.gizmo.rotate.hide(),r.gizmo.scale.hide(),r.object=null)}else r.changed&&r.onElementPropertyChanged&&(r.changed=!1,r.moving=!1,r.onElementPropertyChanged(b,r.object),a.fireInteractionEvent({kind:"liveMoveEnd",event:{e:b,source:r.object,time:(new Date).getTime()}}));r.axis=!1,s=!1,r.update(!0),r.hideTextNote()}function n(a,b){if(!b)return null;var c=r.network.getPickingByEvent(a),d=c.intersectObjects(b,!0,!0);return d[0]?d[0]:!1}Yb.BaseInteraction.call(this,a);var o=new Yb.Element,p=a.getCamera(),q=a.getRootView();q=q!==e?q:document,this.domElement=q,this.gizmo={},this.gizmo.translate=new Yb.TransformGizmoTranslate,this.gizmo.rotate=new Yb.TransformGizmoRotate,this.gizmo.scale=new Yb.TransformGizmoScale,o.addChild(this.gizmo.translate),o.addChild(this.gizmo.rotate),o.addChild(this.gizmo.scale),this.gizmo.translate.hide(),this.gizmo.rotate.hide(),this.gizmo.scale.hide(),this.object=!1,this.snap=!1,this.space="local",this.size=1,this.axis=!1;var r=this;this.scaleable=!0,this.rotateable=!0,this.translateable=!0,this.setShowHelpers(!0);var s=!1,t="translate",u=(new Yb.Picking,new Yb.Projector,new $b,new $b),v=new $b,w=new $b,x=new $b,y=1,z=new ac,A=new $b,B=new ac,C=new $b,D=new Yb.Quat,E=new $b(1,0,0),F=new $b(0,1,0),G=new $b(0,0,1),H=new Yb.Quat,I=new Yb.Quat,J=new Yb.Quat,K=new Yb.Quat,L=new Yb.Quat,M=new $b,N=new $b,O=new ac,P=new ac,Q=new $b,R=new $b,S=new Yb.Euler,T=new ac,U=new $b,V=new Yb.Euler;this.showNote=!0,this.handleDataBoxChange=function(a){"remove"==a.kind?a.data==r.object&&(r.gizmo.translate.hide(),r.gizmo.rotate.hide(),r.gizmo.scale.hide()):"clear"==a.kind&&(r.gizmo.translate.hide(),r.gizmo.rotate.hide(),r.gizmo.scale.hide())},this.network.getDataBox().addDataBoxChangeListener(this.handleDataBoxChange,this),this.network.addPropertyChangeListener(function(a){if("dataBox"==a.property){var b=a.oldValue,c=a.value;b.removeDataBoxChangeListener(this.handleDataBoxChange),c.addDataBoxChangeListener(this.handleDataBoxChange,this)}}),this.defaultMode="TranslateXY",this.pickers=[],this.gizmo.translate.pickers.getChildren().forEach(function(a){r.pickers.push(a)}),this.gizmo.rotate.pickers.getChildren().forEach(function(a){r.pickers.push(a)}),this.gizmo.scale.pickers.getChildren().forEach(function(a){r.pickers.push(a)}),this.attach=function(a){r.object=a,this.gizmo.translate.hide(),this.gizmo.rotate.hide(),this.gizmo.scale.hide(),this.gizmo[t].show(),r.update()},this.detach=function(a){r.object=!1,this.axis=!1,this.gizmo.translate.hide(),this.gizmo.rotate.hide(),this.gizmo.scale.hide()},this.setMode=function(a){t=a?a:t,this.update()},this.setUp=function(){q.addEventListener("mousedown",j,!1),q.addEventListener("touchstart",j,!1),q.addEventListener("mousemove",i,!1),q.addEventListener("touchmove",i,!1),q.addEventListener("mousemove",k,!1),q.addEventListener("touchmove",k,!1),q.addEventListener("mouseup",m,!1),q.addEventListener("mouseout",m,!1),q.addEventListener("touchend",m,!1),q.addEventListener("touchcancel",m,!1),q.addEventListener("touchleave",m,!1),q.addEventListener("keydown",b,!1),q.addEventListener("touchstart",c,!1),q.addEventListener("touchmove",f,!1),q.addEventListener("touchend",g,!1),q.addEventListener("mousewheel",h,!1),r.network.helperBox.addByDescendant(o)},this.tearDown=function(){q.removeEventListener("mousedown",j,!1),q.removeEventListener("touchstart",j,!1),q.removeEventListener("mousemove",i,!1),q.removeEventListener("touchmove",i,!1),q.removeEventListener("mousemove",k,!1),q.removeEventListener("touchmove",k,!1),q.removeEventListener("mouseup",m,!1),q.removeEventListener("mouseout",m,!1),q.removeEventListener("touchend",m,!1),q.removeEventListener("touchcancel",m,!1),q.removeEventListener("touchleave",m,!1),q.removeEventListener("keydown",b,!1),q.removeEventListener("touchstart",c,!1),q.removeEventListener("touchmove",f,!1),q.removeEventListener("touchend",g,!1),q.removeEventListener("mousewheel",h,!1),r.gizmo.translate.hide(),r.gizmo.rotate.hide(),r.gizmo.scale.hide(),r.network.helperBox.removeByDescendant(o)},this.setSnap=function(a){r.snap=a},this.setSize=function(a){r.size=a,this.update()},this.setSpace=function(a){r.space=a,this.update()},this.update=function(a){r.object&&(r.object.updateWorldMatrix(),R.getPositionFromMatrix(r.object.worldMatrix),S.setFromRotationMatrix(B.extractRotation(r.object.worldMatrix)),p.updateWorldMatrix(),U.getPositionFromMatrix(p.worldMatrix),V.setFromRotationMatrix(B.extractRotation(p.worldMatrix)),y=R.distanceTo(U)/12*r.size,o.setPosition(R),o.setScale(y,y,y),A.copy(U).sub(R).normalize(),this.gizmo.scale.update(S,A),"local"==r.space?(this.gizmo.translate.update(S,A),this.gizmo.rotate.update(S,A)):(this.gizmo.translate.update(new Yb.Euler,A),this.gizmo.rotate.update(new Yb.Euler,A)),this.gizmo.translate.highlight(null),this.gizmo.rotate.highlight(null),this.gizmo.scale.highlight(null),this.gizmo[t].highlight(r.axis),o.updateWorldMatrix(!0),a&&r.network.dirtyNetwork())},this.getDefaultPickers=function(){return"TranslateX"===this.defaultMode?r.gizmo.translate.pickers.getChildren().get(0):"TranslateY"===this.defaultMode?r.gizmo.translate.pickers.getChildren().get(1):"TranslateZ"===this.defaultMode?r.gizmo.translate.pickers.getChildren().get(2):"TranslateXY"===this.defaultMode?r.gizmo.translate.pickers.getChildren().get(4):"TranslateYZ"===this.defaultMode?r.gizmo.translate.pickers.getChildren().get(5):"TranslateXZ"===this.defaultMode?r.gizmo.translate.pickers.getChildren().get(6):"TranslateXYZ"===this.defaultMode?r.gizmo.translate.pickers.getChildren().get(3):"RotateX"===this.defaultMode?r.gizmo.rotate.pickers.getChildren().get(0):"RotateY"===this.defaultMode?r.gizmo.rotate.pickers.getChildren().get(1):"RotateZ"===this.defaultMode?r.gizmo.rotate.pickers.getChildren().get(2):"ScaleX"===this.defaultMode?r.gizmo.scale.pickers.getChildren().get(0):"ScaleY"===this.defaultMode?r.gizmo.scale.pickers.getChildren().get(1):"ScaleZ"===this.defaultMode?r.gizmo.scale.pickers.getChildren().get(2):"ScaleXYZ"===this.defaultMode?r.gizmo.scale.pickers.getChildren().get(6):"ScaleXY"===this.defaultMode?r.gizmo.scale.pickers.getChildren().get(3):"ScaleYZ"===this.defaultMode?r.gizmo.scale.pickers.getChildren().get(4):"ScaleXZ"===this.defaultMode?r.gizmo.scale.pickers.getChildren().get(5):null},this.getMode=function(){var a=this.defaultMode;return a.startsWith("Translate")?"translate":a.startsWith("Rotate")?"rotate":a.startsWith("Scale")?"scale":"translate"},this.getAxis=function(){var a=this.defaultMode;return a.endsWith("XYZ")?"XYZ":a.endsWith("XY")?"XY":a.endsWith("YZ")?"YZ":a.endsWith("XZ")?"XZ":a.endsWith("Y")?"X":a.endsWith("Y")?"Y":a.endsWith("Z")?"Z":""};var W=null,X=new Zb;this.filterIntersectPicker=function(a){var b=[];if(!this.showHelpers)return b;for(var c=0;c<a.length;c++){var d=a[c];d.getParent()===this.gizmo.translate.pickers&&this.translateable&&b.push(d),d.getParent()===this.gizmo.rotate.pickers&&this.rotateable&&b.push(d),d.getParent()===this.gizmo.scale.pickers&&this.scaleable&&b.push(d)}return b}},Yb.extend(Yb.EditInteraction,Yb.BaseInteraction,{setShowHelpers:function(a){this.showHelpers=a,this.gizmo.translate.showHelpers=a,this.gizmo.rotate.showHelpers=a,this.gizmo.scale.showHelpers=a,this.resetHelpers()},onElementPropertyChanged:function(a,b){},resetHelpers:function(){this.showHelpers&&this.translateable&&this.object?this.gizmo.translate.show():this.gizmo.translate.hide(),this.showHelpers&&this.rotateable&&this.object?this.gizmo.rotate.show():this.gizmo.rotate.hide(),this.showHelpers&&this.scaleable&&this.object?this.gizmo.scale.show():this.gizmo.scale.hide(),this.update(!0)},setShowNote:function(a){this.showNote=a},setScaleable:function(a){this.scaleable=a,this.gizmo.scale.showable=a,this.resetHelpers()},setRotateable:function(a){this.rotateable=a,this.gizmo.rotate.showable=a,this.resetHelpers()},setTranslateable:function(a){this.translateable=a,this.gizmo.translate.showable=a,this.resetHelpers()},setDefaultMode:function(a){this.defaultMode=a},setScaleRate:function(a){this.scaleRate=a||1},setForceSameScale:function(a){this.forceSameScale=a},setSpaceMode:function(a){"world"==a?this.space="world":this.space="local",this.update()},createTextNote:function(){this.textNote=document.createElement("div"),this.textNote.style.position="relative",this.textNote.style.color="black",this.textNote.style.height="0px",this.textNote.style.zIndex="1000",this.domElement.appendChild(this.textNote);var a=document.createElement("table");this.noteTable=a,this.textNote.appendChild(this.noteTable);a.createTHead();a.style.borderLeft="1px solid #ffa500",a.style.borderTop="1px solid #ffa500",a.style.fontSize="14px",a.style.backgroundColor="rgba(255, 170, 13, 0.5)",a.setAttribute("border",0),a.setAttribute("cellspacing",0),a.setAttribute("cellpadding",0);for(var b=0;4>b;b++){for(var c=document.createElement("tr"),d=0;4>d;d++){var e=document.createElement("td");e.style.borderRight="1px solid #ffa500",e.style.borderBottom="1px solid #ffa500",e.style.paddingLeft="5px",e.style.paddingRight="5px",e.style.paddingTop="2px",e.style.paddingBottom="2px",0==b&&d>0||b>0&&0==d?(e.style.textAlign="center",e.style.fontWeight="bold"):e.style.textAlign="right",c.appendChild(e)}a.appendChild(c)}},showTextNote:function(){this.showNote&&(null==this.textNote&&this.createTextNote(),this.textNote.style.display="")},hideTextNote:function(){this.textNote&&(this.textNote.style.display="none")},updateTextNote:function(a,b){if(null!=b&&this.showNote){var c=this.network.getRootView().getBoundingClientRect();this.showTextNote(),this.textNote.style.top=a.clientY-c.top+20+"px",this.textNote.style.left=a.clientX-c.left+20+"px";for(var d=b.getRotation(),e=b.getPosition(),f=b.getScale(),g=[[" ","x","y","z"],["p",e.x,e.y,e.z],["r",d.x,d.y,d.z],["s",f.x,f.y,f.z]],h=this.noteTable,i=0;4>i;i++)for(var j=0;4>j;j++){var k=g[i][j];i>0&&j>0&&(k=2==i?(180*k/Math.PI).toFixed(0)+"&deg;":k.toFixed(2)),h.rows[i].cells[j].innerHTML=""+k}}}});var gd=1e-5,hd=0,id=1,jd=2,kd=3;Yb.CSG=function(a){var b,c,d,e,f,g,h,i=[];if(!(a instanceof Yb.Element)){if(a instanceof nd)return this.tree=a,this.matrix=new ac,this;throw"TGL.CSG: Given geometry is unsupported"}for(a.computeNodeData&&a.computeNodeData(),a.updateWorldMatrix(!0),this.matrix=a.worldMatrix.clone(),b=0,c=a.faces.length;c>b;b++){if(d=a.faces[b],f=a.uvs[b],g=a.uv2s[b],h=new ld,d instanceof oc)e=a.vertices[d.a],e=new md(e.x,e.y,e.z,d.vertexNormals[0],new Zb(f[0].x,f[0].y),g[0].clone()),e.materialIndex=d.materialIndex,
e.applyMatrix4(this.matrix),h.vertices.push(e),e=a.vertices[d.b],e=new md(e.x,e.y,e.z,d.vertexNormals[1],new Zb(f[1].x,f[1].y),g[1].clone()),e.materialIndex=d.materialIndex,e.applyMatrix4(this.matrix),h.vertices.push(e),e=a.vertices[d.c],e=new md(e.x,e.y,e.z,d.vertexNormals[2],new Zb(f[2].x,f[2].y),g[2].clone()),e.applyMatrix4(this.matrix),e.materialIndex=d.materialIndex,h.vertices.push(e);else{if(!(d instanceof pc))throw"Invalid face type at index "+b;e=a.vertices[d.a],e=new md(e.x,e.y,e.z,d.vertexNormals[0],new Zb(f[0].x,f[0].y),g[0].clone()),e.materialIndex=d.materialIndex,e.applyMatrix4(this.matrix),h.vertices.push(e),e=a.vertices[d.b],e=new md(e.x,e.y,e.z,d.vertexNormals[1],new Zb(f[1].x,f[1].y),g[1].clone()),e.materialIndex=d.materialIndex,e.applyMatrix4(this.matrix),h.vertices.push(e),e=a.vertices[d.c],e=new md(e.x,e.y,e.z,d.vertexNormals[2],new Zb(f[2].x,f[2].y),g[2].clone()),e.materialIndex=d.materialIndex,e.applyMatrix4(this.matrix),h.vertices.push(e),e=a.vertices[d.d],e=new md(e.x,e.y,e.z,d.vertexNormals[3],new Zb(f[3].x,f[3].y),g[3].clone()),e.applyMatrix4(this.matrix),e.materialIndex=d.materialIndex,h.vertices.push(e)}isNaN(h.calculateProperties().w)?console.log("Not right polygon"):i.push(h)}if(this.tree=new nd(i),this.tree.materialSize=a.getMaterialSize?a.getMaterialSize():0,a.material instanceof Yb.ArrayMaterial)this.tree.material=a.material;else{var j=new Yb.ArrayMaterial;this.tree.material=j;for(var b=0;b<this.tree.materialSize;b++)j.push(a.material)}},Yb.CSG.prototype.substract=function(a){var b=this.tree.clone(),c=a.tree.clone();return b.sumMateriaSize(c),b.invert(),b.clipTo(c),c.clipTo(b),c.invert(),c.clipTo(b),c.invert(),b.build(c.allPolygons()),b.invert(),b=new Yb.CSG(b),b.matrix=this.matrix,b},Yb.CSG.prototype.union=function(a){var b=this.tree.clone(),c=a.tree.clone();return b.sumMateriaSize(c),b.clipTo(c),c.clipTo(b),c.invert(),c.clipTo(b),c.invert(),b.build(c.allPolygons()),b=new Yb.CSG(b),b.matrix=this.matrix,b},Yb.CSG.prototype.intersect=function(a){var b=this.tree.clone(),c=a.tree.clone();return b.sumMateriaSize(c),b.invert(),c.clipTo(b),c.invert(),b.clipTo(c),c.clipTo(b),b.build(c.allPolygons()),b.invert(),b=new Yb.CSG(b),b.matrix=this.matrix,b},Yb.CSG.prototype.inverse=function(){var a=this.tree.clone();return a.polygons.map(function(a){a.flip()}),a=new Yb.CSG(a)},Yb.CSG.prototype.toGeometry=function(a){var b,c,d,e,f,g,h,i,j,k,l,m=((new ac).getInverse(this.matrix),new Yb.Entity(this.tree.material,a)),n=this.tree.allPolygons(),o=n.length,p={};for(b=0;o>b;b++)for(d=n[b],e=d.vertices.length,c=2;e>c;c++){k=[],l=[],i=d.vertices[0],k.push(new Zb(i.uv.x,i.uv.y)),l.push(i.uv2.clone());var q=i.materialIndex;i=new $b(i.x,i.y,i.z),"undefined"!=typeof p[i.x+","+i.y+","+i.z]?f=p[i.x+","+i.y+","+i.z]:(m.vertices.push(i),f=p[i.x+","+i.y+","+i.z]=m.vertices.length-1),i=d.vertices[c-1],k.push(new Zb(i.uv.x,i.uv.y)),l.push(i.uv2.clone()),i=new $b(i.x,i.y,i.z),"undefined"!=typeof p[i.x+","+i.y+","+i.z]?g=p[i.x+","+i.y+","+i.z]:(m.vertices.push(i),g=p[i.x+","+i.y+","+i.z]=m.vertices.length-1),i=d.vertices[c],k.push(new Zb(i.uv.x,i.uv.y)),l.push(i.uv2.clone()),i=new $b(i.x,i.y,i.z),"undefined"!=typeof p[i.x+","+i.y+","+i.z]?h=p[i.x+","+i.y+","+i.z]:(m.vertices.push(i),h=p[i.x+","+i.y+","+i.z]=m.vertices.length-1),j=new oc(f,g,h,new $b(d.normal.x,d.normal.y,d.normal.z)),j.materialIndex=q||0,m.faces.push(j),m.uvs.push(k),m.uv2s.push(l)}return m},Yb.CSG.prototype.toMesh=function(a){var b=this.toGeometry(a);return b.computeBoundingBox(),b};var ld=function(a,b,c){a instanceof Array||(a=[]),this.vertices=a,a.length>0?this.calculateProperties():this.normal=this.w=e};ld.prototype.calculateProperties=function(){var a=this.vertices[0],b=this.vertices[1],c=this.vertices[2],d=b.clone().subtract(a),e=c.clone().subtract(a);return this.normal=d.cross(e).normalize(),this.w=this.normal.clone().dot(a),this},ld.prototype.clone=function(){var a,b,c=new ld;for(a=0,b=this.vertices.length;b>a;a++)c.vertices.push(this.vertices[a].clone());return c.calculateProperties(),c},ld.prototype.flip=function(){var a,b=[];for(this.normal.multiplyScalar(-1),this.w*=-1,a=this.vertices.length-1;a>=0;a--)b.push(this.vertices[a]);return this.vertices=b,this},ld.prototype.classifyVertex=function(a){var b=this.normal.dot(a)-this.w;return-gd>b?jd:b>gd?id:hd},ld.prototype.classifySide=function(a){var b,c,d,e=0,f=0,g=a.vertices.length;for(b=0;g>b;b++)c=a.vertices[b],d=this.classifyVertex(c),d===id?e++:d===jd&&f++;return e>0&&0===f?id:0===e&&f>0?jd:0===e&&0===f?hd:kd},ld.prototype.splitPolygon=function(a,b,c,d,e){var f=this.classifySide(a);if(f===hd)(this.normal.dot(a.normal)>0?b:c).push(a);else if(f===id)d.push(a);else if(f===jd)e.push(a);else{var g,h,i,j,k,l,m,n,o,p=[],q=[];for(h=0,g=a.vertices.length;g>h;h++)i=(h+1)%g,l=a.vertices[h],m=a.vertices[i],j=this.classifyVertex(l),k=this.classifyVertex(m),j!=jd&&p.push(l),j!=id&&q.push(l),(j|k)===kd&&(n=(this.w-this.normal.dot(l))/this.normal.dot(m.clone().subtract(l)),o=l.interpolate(m,n),p.push(o),q.push(o));p.length>=3&&d.push(new ld(p).calculateProperties()),q.length>=3&&e.push(new ld(q).calculateProperties())}},Yb.CSG.Polygon=ld;var md=function(a,b,c,d,e,f){this.x=a,this.y=b,this.z=c,this.normal=d||new $b,this.uv=e||new Zb,this.uv2=f||new Zb};md.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},md.prototype.clone=function(){var a=new md(this.x,this.y,this.z,this.normal.clone(),this.uv.clone(),this.uv2.clone());return a.materialIndex=this.materialIndex,a},md.prototype.add=function(a){return this.x+=a.x,this.y+=a.y,this.z+=a.z,this},md.prototype.subtract=function(a){return this.x-=a.x,this.y-=a.y,this.z-=a.z,this},md.prototype.multiplyScalar=function(a){return this.x*=a,this.y*=a,this.z*=a,this},md.prototype.cross=function(a){var b=this.x,c=this.y,d=this.z;return this.x=c*a.z-d*a.y,this.y=d*a.x-b*a.z,this.z=b*a.y-c*a.x,this},md.prototype.normalize=function(){var a=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);return this.x/=a,this.y/=a,this.z/=a,this},md.prototype.dot=function(a){return this.x*a.x+this.y*a.y+this.z*a.z},md.prototype.lerp=function(a,b){return this.add(a.clone().subtract(this).multiplyScalar(b)),this.normal.add(a.normal.clone().sub(this.normal).multiplyScalar(b)),this.uv.add(a.uv.clone().sub(this.uv).multiplyScalar(b)),this.uv2.add(a.uv2.clone().sub(this.uv2).multiplyScalar(b)),this},md.prototype.interpolate=function(a,b){return this.clone().lerp(a,b)},md.prototype.applyMatrix4=function(a){var b=this.x,c=this.y,d=this.z,e=a.elements;return this.x=e[0]*b+e[4]*c+e[8]*d+e[12],this.y=e[1]*b+e[5]*c+e[9]*d+e[13],this.z=e[2]*b+e[6]*c+e[10]*d+e[14],this},Yb.CSG.Vertex=md;var nd=function(a){var b,c,d=[],f=[];if(this.polygons=[],this.front=this.back=e,a instanceof Array&&0!==a.length){for(this.divider=a[0].clone(),b=0,c=a.length;c>b;b++)this.divider.splitPolygon(a[b],this.polygons,this.polygons,d,f);d.length>0&&(this.front=new nd(d)),f.length>0&&(this.back=new nd(f))}};nd.isConvex=function(a){var b,c;for(b=0;b<a.length;b++)for(c=0;c<a.length;c++)if(b!==c&&a[b].classifySide(a[c])!==jd)return!1;return!0},nd.prototype.build=function(a){var b,c,d=[],e=[];for(this.divider||(this.divider=a[0].clone()),b=0,c=a.length;c>b;b++)this.divider.splitPolygon(a[b],this.polygons,this.polygons,d,e);d.length>0&&(this.front||(this.front=new nd),this.front.build(d)),e.length>0&&(this.back||(this.back=new nd),this.back.build(e))},nd.prototype.allPolygons=function(){var a=this.polygons.slice();return this.front&&(a=a.concat(this.front.allPolygons())),this.back&&(a=a.concat(this.back.allPolygons())),a},nd.prototype.clone=function(){var a=new nd;if(this.divider&&(a.divider=this.divider.clone()),a.polygons=this.polygons.map(function(a){return a.clone()}),a.front=this.front&&this.front.clone(),a.back=this.back&&this.back.clone(),a.materialSize=this.materialSize,a.material=new Yb.ArrayMaterial,this.material)for(var b=0;b<this.material.materials.length;b++)a.material.materials.push(this.material.materials[b]);return a},nd.prototype.invert=function(){var a,b,c;for(a=0,b=this.polygons.length;b>a;a++)this.polygons[a].flip();return this.divider&&this.divider.flip(),this.front&&this.front.invert(),this.back&&this.back.invert(),c=this.front,this.front=this.back,this.back=c,this},nd.prototype.clipPolygons=function(a){var b,c,d,e;if(!this.divider)return a.slice();for(d=[],e=[],b=0,c=a.length;c>b;b++)this.divider.splitPolygon(a[b],d,e,d,e);return this.front&&(d=this.front.clipPolygons(d)),e=this.back?this.back.clipPolygons(e):[],d.concat(e)},nd.prototype.clipTo=function(a){this.polygons=a.clipPolygons(this.polygons),this.front&&this.front.clipTo(a),this.back&&this.back.clipTo(a)},nd.prototype.sumMateriaSize=function(a){a.changeMaterialIndex(this.materialSize),this.materialSize=this.materialSize+a.materialSize;for(var b=0;b<a.material.materials.length;b++)this.material.materials.push(a.material.materials[b])},nd.prototype.changeMaterialIndex=function(a){for(var b=0;b<this.polygons.length;b++)for(var c=this.polygons[b],d=0;d<c.vertices.length;d++){var e=c.vertices[d];e.materialIndex=e.materialIndex+a}this.front&&this.front.changeMaterialIndex(a),this.back&&this.back.changeMaterialIndex(a)},Yb.CSG.Node=nd,Yb.XmlSerializer=function(a,b,c){this.dataBox=a,this.settings=b?b:new Yb.SerializationSettings,this.filterFunction=c,this.ref=0,this.refMap={},this.idMap={},this.xmlString=""},Yb.extend(Yb.XmlSerializer,Object,{serialize:function(){return this.xmlString="<TGL version='"+Yb.version+"' platform='html5'>\n",this.serializeBody(),this.xmlString+="</TGL>\n",this.xmlString},serializeBody:function(){this.ref=0,this.dataBox.getRoots().forEach(this.initRefs,this),this.settings.isDataBoxSerializable&&(this.xmlString+="<dataBox class='"+this.dataBox.getClassName()+"'>\n",this.dataBox.serializeXml(this,this.dataBox.newInstance()),this.xmlString+="</dataBox>\n"),this.dataBox.getRoots().forEach(this.serializeData,this)},initRefs:function(a){this.refMap[a.getId()]=this.ref++,a.getChildren().forEach(this.initRefs,this)},isSerializable:function(a){return this.dataBox.contains(a)?this.filterFunction&&!this.filterFunction(a)?!1:!0:!1},getPropertyType:function(a,b){var c=this.settings.getPropertyType(b);return c||a.__SizePropeties&&-1!=a.__SizePropeties.indexOf(b)&&(c="number"),c},serializeData:function(a){if(this.isSerializable(a)){var b=a.newInstance(),c=this.refMap[a.getId()];this.xmlString+="<data class='"+a.getClassName()+"' ref='"+c+"'",null!=this.settings.getPropertyType("id")&&(this.xmlString+=" id='"+a.getId()+"'"),this.xmlString+=">\n",a.serializeXml(this,b),this.xmlString+="</data>\n"}a.getChildren().forEach(this.serializeData,this)},serializePropertyXml:function(a,b,c){var d=this.getPropertyType(a,b);if(d){var e=Yb.getValue(a,b,d),f=Yb.getValue(c,b,d);e!==f&&this.serializeValue("p",b,e,f,d)}},serializeStyleXml:function(a,b,c){var d=this.settings.getStyleType(b);if(d){var e=a.getStyle(b),f=c.getStyle(b);e!=f&&this.serializeValue("s",b,e,f,d)}},serializeClientXml:function(a,b,c){var d=this.settings.getClientType(b);if(null!=d){var e=a.getClient(b),f=c.getClient(b);e!=f&&this.serializeValue("c",b,e,f,d)}},serializeValue:function(a,b,c,d,e){if("s"===a&&(c=this.flattenArray(c),c instanceof Array&&"string"!==e&&"color"!==e&&"number"!==e&&(e="list."+e,c=new kc(c))),null==c)this.xmlString+="	<"+a+" n='"+b+"' none=''/>\n";else if("cdata"===e)this.xmlString+="	<"+a+" n='"+b+"'><![CDATA["+c+"]]></"+a+">\n";else if("data"===e){var f=this.refMap[c.getId()];null!=f&&(this.xmlString+="	<"+a+" n='"+b+"' ref='"+f+"'/>\n")}else"vec2"===e?d&&c.x===d.x&&c.y===d.y||(this.xmlString+="	<"+a+" n='"+b+"' x='"+c.x+"' y='"+c.y+"'/>\n"):"vec3"===e?d&&c.x===d.x&&c.y===d.y&&c.z==d.z||(this.xmlString+="	<"+a+" n='"+b+"' x='"+c.x+"' y='"+c.y+"' z='"+c.z+"'/>\n"):"list.vec2"===e?(this.xmlString+="	<"+a+" n='"+b+"'>\n",c instanceof Array&&(c=new kc(c)),c.forEach(function(b){if(b instanceof Array){this.xmlString+="	<"+a+">\n";for(var c=0;c<b.length;c++){var d=b[c];this.xmlString+="		<p x='"+d.x+"' y='"+d.y+"'/>\n"}this.xmlString+="	</"+a+">\n"}else this.xmlString+="		<p x='"+b.x+"' y='"+b.y+"'/>\n"},this),this.xmlString+="	</"+a+">\n"):"list.vec3"===e?(this.xmlString+="	<"+a+" n='"+b+"'>\n",c instanceof Array&&(c=new kc(c)),c.forEach(function(b){if(b instanceof Array){this.xmlString+="	<"+a+">\n";for(var c=0;c<b.length;c++){var d=b[c];this.xmlString+="	<"+a+"' x='"+d.x+"' y='"+d.y+"' z='"+d.z+"'/>\n"}this.xmlString+="	</"+a+">\n"}else this.xmlString+="		<"+a+"' x='"+b.x+"' y='"+b.y+"' z='"+b.z+"'/>\n"},this),this.xmlString+="	</"+a+">\n"):"list.string"===e||"list.number"===e||"list.color"===e?(this.xmlString+="	<"+a+" n='"+b+"'>\n",c.forEach(function(a){this.xmlString+="		<s>"+a+"</s>\n"},this),this.xmlString+="	</"+a+">\n"):this.xmlString+="	<"+a+" n='"+b+"'>"+c+"</"+a+">\n"},flattenArray:function(a){if(a instanceof Array){for(var b=0;b<a.length-1;b++)if(a[b]!=a[b+1]){if(!a[b]||!a[b].equals)return a;if(!a[b].equals(a[b+1]))return a}return a[0]}return a},deserialize:function(a,b){Yb.isDeserializing=!0,this.xmlString=a;var c=Yb.xml(a).documentElement;this.refMap={},this.idMap={};var d,e,f,g=new kc,h=new kc,i=c.getElementsByTagName("data"),j=i.length;for(f=0;j>f;f++){e=i[f];var k=e.getAttribute("class"),l=this.settings.getPropertyType("id");if(l&&e.hasAttribute("id")){var m=null;if("string"===l)m=e.getAttribute("id");else if("int"===l)m=parseInt(e.getAttribute("id"));else{if("number"!==l)throw"Unsupported id type '"+l+"'";m=parseFloat(e.getAttribute("id"))}if("remove"===e.getAttribute("action")){this.dataBox.removeById(m);continue}d=this.dataBox.getDataById(m),d||(d=Yb.newInstance(k,m))}else d=Yb.newInstance(k);if(e.hasAttribute("ref")){var n=e.getAttribute("ref");this.refMap[n]=d}g.add(d),h.add(e),this.idMap[d.getId()]=d}for(this.dataBox.forEach(function(a){this.idMap[a.getId()]=a},this),j=g.size(),f=0;j>f;f++)d=g.get(f),this.dataBox.containsById(d.getId())||(b&&!d.getParent()&&d.setParent(b),this.dataBox.add(d));for(f=0;j>f;f++)d=g.get(f),e=h.get(f),d.deserializeXml(this,e);this.settings.isDataBoxSerializable&&1===c.getElementsByTagName("dataBox").length&&this.dataBox.deserializeXml(this,c.getElementsByTagName("dataBox")[0]),Yb.isDeserializing=!1},deserializePropertyXml:function(a,b,c){var d=this.getPropertyType(a,c);d&&Yb.setValue(a,c,this.deserializeValue(b,d))},deserializeStyleXml:function(a,b,c){var d=this.settings.getStyleType(c);d&&a.setStyle(c,this.deserializeValue(b,d))},deserializeClientXml:function(a,b,c){var d=this.settings.getClientType(c);d&&a.setClient(c,this.deserializeValue(b,d))},deserializePoint:function(a){var b=a.getAttribute("x")?parseFloat(a.getAttribute("x")):null,c=a.getAttribute("a")?parseFloat(a.getAttribute("a")):null;if(null!=b){var d=a.getAttribute("y")?parseFloat(a.getAttribute("y")):null,e=a.getAttribute("z")?parseFloat(a.getAttribute("z")):null,f=a.getAttribute("w")?parseFloat(a.getAttribute("w")):null;return null!=f?new Yb.Vec4(b,d,e,f):null!=e?new Yb.Vec3(b,d,e):new Yb.Vec2(b,d)}if(null!=c){var g=a.getAttribute("b")?parseFloat(a.getAttribute("b")):null,h=a.getAttribute("c")?parseFloat(a.getAttribute("c")):null,i=a.getAttribute("d")?parseFloat(a.getAttribute("d")):null;return null!=i?new Yb.Face4(c,g,h,i):new Yb.Face3(c,g,h)}return null},arrayStyleValue:function(a,b){var c=[];if(a.indexOf(",")){if(c=a.split(","),"string"===b)return c;if("number"===b){for(var d=[],e=0;e<c.length;e++)d.push(parseFloat(c[e]));return d}if("color"===b){for(var f=[],e=0;e<c.length;e++)f.push(new Yb.Color(c[e]));return f}}},deserializeValue:function(a,b,c){if(a.hasAttribute("@none"))return null;var d="s"===a.nodeName,e=d&&-1!==a.textContent.indexOf(",");if("string"===b)return e?this.arrayStyleValue(a.textContent,b):a.textContent;if("color"===b)return e?this.arrayStyleValue(a.textContent,b):a.textContent;if("number"===b)return e?this.arrayStyleValue(a.textContent,b):parseFloat(a.textContent);if("boolean"===b)return"true"===a.textContent;if("int"===b)return parseInt(a.textContent);if("point"===b)return this.deserializePoint(a);if("vec2"===b){var f=parseFloat(a.getAttribute("x")),g=parseFloat(a.getAttribute("y"));if(!isNaN(f)&&!isNaN(g)||!d)return new Yb.Vec2(f,g);b="list.point"}if("vec3"===b){var f=parseFloat(a.getAttribute("x")),g=parseFloat(a.getAttribute("y")),h=parseFloat(a.getAttribute("z"));return new Yb.Vec3(f,g,h)}if("data"===b){var i=a.getAttribute("ref"),j=this.refMap[i];return j?j:this.idMap[i]}var k,l,m,n;if("list.point"===b){var o=new kc,p=a.getElementsByTagName("p");for(k=p.length,n=0;k>n;n++){var q=p[n];o.add(this.deserializePoint(q))}return d?o._as:o}if("list.string"===b){var r=new kc;for(m=a.getElementsByTagName("s"),k=m.length,n=0;k>n;n++)r.add(m[n].textContent);return r}if("list.number"===b){for(l=new kc,m=a.getElementsByTagName("s"),k=m.length,n=0;k>n;n++)l.add(parseFloat(m[n].textContent));return l}if("array.string"===b)return a.textContent.split(",");if("array.number"===b){for(l=a.textContent.split(","),k=l.length,n=0;k>n;n++)l[n]=parseFloat(l[n]);return l}return"rectangle"===b?{x:parseFloat(a.getAttribute("x")),y:parseFloat(a.getAttribute("y")),width:parseFloat(a.getAttribute("w")),height:parseFloat(a.getAttribute("h"))}:a.textContent}}),Yb.addMethod(Yb.Data,{serializeXml:function(a,b){if(this.__SizePropeties&&this.__SizePropeties.length){var c,d;for(c=0,d=this.__SizePropeties.length;d>c;c++)this.serializePropertyXml(a,this.__SizePropeties[c],b)}else this.serializePropertyXml(a,"materialSize",b),this.vertices&&this.vertices.length&&this.serializePropertyXml(a,"vertices",b),this.faces&&this.faces.length&&this.serializePropertyXml(a,"faces",b),this.uvs&&this.uvs.length&&this.serializePropertyXml(a,"uvs",b);if(a.settings.isClientSerializable&&this._clientMap)for(var e in this._clientMap)this.serializeClientXml(a,e,b);this.serializePropertyXml(a,"name",b),this.serializePropertyXml(a,"parent",b)},serializePropertyXml:function(a,b,c){a.serializePropertyXml(this,b,c)},serializeClientXml:function(a,b,c){a.serializeClientXml(this,b,c)},deserializeXml:function(a,b){var c,d,e,f,g=b.getElementsByTagName("p"),h=g.length;for(c=0;h>c;c++)d=g[c],d.hasAttribute("n")&&this.deserializePropertyXml(a,d,d.getAttribute("n"));if(a.settings.isClientSerializable)for(e=b.getElementsByTagName("c"),h=e.length,c=0;h>c;c++)f=e[c],f.hasAttribute("n")&&this.deserializeClientXml(a,f,f.getAttribute("n"))},deserializePropertyXml:function(a,b,c){a.deserializePropertyXml(this,b,c)},deserializeClientXml:function(a,b,c){a.deserializeClientXml(this,b,c)}}),Yb.addMethod(Yb.Element,{serializeXml:function(a,b){if(a.settings.isStyleSerializable&&this.styleMap)for(var c in this.styleMap)this.isSideStyle(c)||this.serializeStyleXml(a,c,b);this.serializePropertyXml(a,"position",b),this.serializePropertyXml(a,"rotation",b),this.serializePropertyXml(a,"scale",b),Yb.Element.superClass.serializeXml.call(this,a,b),this._alarmState.getHighestNativeAlarmSeverity()&&"alarmstate"===a.settings.getPropertyType("alarmState")&&(a.xmlString+="	<p n='alarmState'>\n",Yb.AlarmSeverity.forEach(function(b){var c=this.getNewAlarmCount(b);c>0&&(a.xmlString+="		<n n='"+b.name+"' c='"+c+"'/>\n")},this._alarmState),Yb.AlarmSeverity.forEach(function(b){var c=this.getAcknowledgedAlarmCount(b);c>0&&(a.xmlString+="		<a n='"+b.name+"' c='"+c+"'/>\n")},this._alarmState),a.xmlString+="	</p>\n")},serializeStyleXml:function(a,b,c){a.serializeStyleXml(this,b,c)},deserializeXml:function(a,b){if(Yb.Element.superClass.deserializeXml.call(this,a,b),a.settings.isStyleSerializable){var c,d,e=b.getElementsByTagName("s"),f=e.length;for(c=0;f>c;c++)d=e[c],d.hasAttribute("n")&&this.deserializeStyleXml(a,d,d.getAttribute("n"))}},deserializeStyleXml:function(a,b,c){a.deserializeStyleXml(this,b,c)},deserializePropertyXml:function(a,b,c){if("alarmState"===c){if("alarmstate"===a.settings.getPropertyType("alarmState")){var d,e,f,g=b.getElementsByTagName("n");for(e=0;e<g.length;e++)f=g[e],d=mono.AlarmSeverity.getByName(f.getAttribute("n")),this._alarmState.setNewAlarmCount(d,parseInt(f.getAttribute("c")));for(g=b.getElementsByTagName("a"),e=0;e<g.length;e++)f=g[e],d=mono.AlarmSeverity.getByName(f.getAttribute("n")),this._alarmState.setAcknowledgedAlarmCount(d,parseInt(f.getAttribute("c")))}}else Yb.Element.superClass.deserializePropertyXml.call(this,a,b,c)}}),Yb.addMethod(Yb.DataBox,{serializeXml:function(a,b){if(a.settings.isClientSerializable&&this._clientMap)for(var c in this._clientMap)this.serializeClientXml(a,c,b);this.serializePropertyXml(a,"name",b)},serializePropertyXml:function(a,b,c){a.serializePropertyXml(this,b,c)},serializeClientXml:function(a,b,c){a.serializeClientXml(this,b,c)},deserializeXml:function(a,b){var c,d,e,f,g=b.getElementsByTagName("p"),h=g.length;for(c=0;h>c;c++)d=g[c],d.hasAttribute("n")&&this.deserializePropertyXml(a,d,d.getAttribute("n"));if(a.settings.isClientSerializable)for(e=b.getElementsByTagName("c"),h=e.length,c=0;h>c;c++)f=e[c],f.hasAttribute("n")&&this.deserializeClientXml(a,f,f.getAttribute("n"))},deserializePropertyXml:function(a,b,c){a.deserializePropertyXml(this,b,c)},deserializeClientXml:function(a,b,c){a.deserializeClientXml(this,b,c)}}),Yb.JsonSerializer=function(a,b,c){this.dataBox=a,this.settings=b?b:new Yb.SerializationSettings,this.filterFunction=c,this.ref=0,this.refMap={},this.idMap={},this.jsonObject={}},Yb.extend(Yb.JsonSerializer,Object,{constructor:Yb.JsonSerializer,className:"TGL.JsonSerializer",serialize:function(){return this.jsonObject={v:Yb.version,platform:"html5"},this.serializeBody(),JSON.stringify(this.jsonObject)},serializeBody:function(){if(this.ref=0,this.dataBox.getRoots().forEach(this.initRefs,this),this.settings.isDataBoxSerializable){var a={"class":this.dataBox.getClassName(),p:{},s:{},c:{}};this.jsonObject.dataBox=a,this.dataBox.serializeJson(this,this.dataBox.newInstance(),a),sc.isEmptyObject(a.p)&&delete a.p,sc.isEmptyObject(a.s)&&delete a.s,sc.isEmptyObject(a.c)&&delete a.c}this.jsonObject.datas=[],this.dataBox.getRoots().forEach(this.serializeData,this)},initRefs:function(a){if(this.refMap[a.getId()]=this.ref++,a.getChildren().forEach(this.initRefs,this),a instanceof Yb.ComboNode)for(var b=0;b<a.combos.length;b++){var c=a.combos[b];this.refMap[c.getId()]||(this.refMap[c.getId()]=this.ref++)}},isSerializable:function(a){return this.dataBox.contains(a)?this.filterFunction&&!this.filterFunction(a)?!1:!0:!1},serializeData:function(a){if(this.isSerializable(a)){var b=a.newInstance(),c=this.refMap[a.getId()],d={"class":a.getClassName(),ref:c,p:{},s:{},c:{}};this.settings.getPropertyType("id")&&(this.jsonObject.id=a.getId()),this.jsonObject.datas.push(d),a.serializeJson(this,b,d),sc.isEmptyObject(d.p)&&delete d.p,sc.isEmptyObject(d.s)&&delete d.s,sc.isEmptyObject(d.c)&&delete d.c}a.getChildren().forEach(this.serializeData,this)},serializeDataValue:function(a){var b=a.newInstance(),c=this.refMap[a.getId()],d={"class":a.getClassName(),ref:c,p:{},s:{},c:{}};return a.serializeJson(this,b,d),sc.isEmptyObject(d.p)&&delete d.p,sc.isEmptyObject(d.s)&&delete d.s,sc.isEmptyObject(d.c)&&delete d.c,d},getPropertyType:function(a,b){var c=this.settings.getPropertyType(b);return c||(a.__bool&&-1!=a.__bool.indexOf(b)?c="boolean":a.__SizePropeties&&-1!=a.__SizePropeties.indexOf(b)&&(c="number")),c},getStyleType:function(a,b){a.isSideStyle(b)&&(b=b.substr(b.indexOf(".")+1));var c=this.settings.getStyleType(b);return c},serializePropertyJson:function(a,b,c,d){var e=this.getPropertyType(a,b);if(e){var f=Yb.getValue(a,b,e),g=Yb.getValue(c,b,e);f!==g&&(f&&f.equals?!f.equals(g)&&this.serializeValue(b,f,g,e,d.p):this.serializeValue(b,f,g,e,d.p))}},serializeStyleJson:function(a,b,c,d){var e=this.getStyleType(a,b);if(e){var f=a.getStyle(b),g=c.getStyle(b);b.startsWith("m.")&&(f=this.flattenArray(f),g=this.flattenArray(g)),b.endsWith(".image")&&(f=this.encodeURI(f),g=this.encodeURI(g)),f!=g&&(f&&f.equals?!f.equals(g)&&this.serializeValue(b,f,g,e,d.s):this.serializeValue(b,f,g,e,d.s))}},serializeClientJson:function(a,b,c,d){var e=this.settings.getClientType(b);if(null!=e){var f=a.getClient(b),g=c.getClient(b);f!=g&&(f&&f.equals?!f.equals(g)&&this.serializeValue(b,f,g,e,d.c):this.serializeValue(b,f,g,e,d.c))}},serializeValue:function(a,b,c,d,e){if(null==b)e[a]=null;else if(b instanceof kc)e[a]=b._as;else if("data"===d){var f=this.refMap[b.getId()];null!=f&&(e[a]=f)}else if("data.list"===d){for(var g=[],h=0;h<b.length;h++)g.push(this.serializeDataValue(b[h]));e[a]=g}else if("serializeabe.list"===d){for(var g=[],h=0;h<b.length;h++)g.push(b[h].serializeJsonValue());e[a]=g}else b.serializeJsonValue?e[a]=b.serializeJsonValue():e[a]=b},deserialize:function(a,b){Yb.isDeserializing=!0,this.jsonObject=JSON.parse(a),this.refMap={},this.idMap={};var c,d=new kc,e=new kc,f=this.jsonObject.datas.length;null!=this.deserializeStartCreateData&&this.deserializeStartCreateData(f);for(var g=0;f>g;g++){var h=this.jsonObject.datas[g],i=h["class"],j=this.settings.getPropertyType("id");if(j&&null!=h.id){if("remove"===h.action){this.dataBox.removeById(h.id);continue}c=this.dataBox.getDataById(h.id),c||(c=Yb.newInstance(i,h.id))}else{c=Yb.newInstance(i)}null!=h.ref&&(this.refMap[h.ref]=c),d.add(c),e.add(h),this.idMap[c.getId()]=c,this.deserializeCreateData&&this.deserializeCreateData(g,f)}for(this.dataBox.forEach(function(a){this.idMap[a.getId()]=a},this),f=d.size(),this.deserializeStartFillData&&this.deserializeStartFillData(f),g=0;f>g;g++)c=d.get(g),c.deserializeJson(this,e.get(g)),this.deserializeFillData&&this.deserializeFillData(g,f);for(this.deserializeStartAddData&&this.deserializeStartAddData(f),g=0;f>g;g++)c=d.get(g),this.dataBox.containsById(c.getId())||(b&&!c.getParent()&&c.setParent(b),"TGL.Entity"===c.getClassName()&&(c.computed=!1,c.computeNodeData()),this.dataBox.add(c),this.deserializeAddData&&this.deserializeAddData(g,f));this.settings.isDataBoxSerializable&&this.jsonObject.dataBox&&this.dataBox.deserializeJson(this,this.jsonObject.dataBox),Yb.isDeserializing=!1},deserializePropertyJson:function(a,b,c){var d=this.getPropertyType(a,c);d&&Yb.setValue(a,c,this.deserializeValue(b,d))},deserializeStyleJson:function(a,b,c){var d=this.getStyleType(a,c);if(d){var e=this.deserializeValue(b,d);e._as&&(e=e._as),a.setStyle(c,e)}},deserializeClientJson:function(a,b,c){var d=this.settings.getClientType(c);d&&a.setClient(c,this.deserializeValue(b,d))},getClassName:function(a){return null!=a?a["class"]?a["class"]:a.w!==e&&a.x!==e&&a.y!==e&&a.z!==e?"TGL.Vec4":a.x!==e&&a.y!==e&&a.z!==e?"TGL.Vec3":a.x!==e&&a.y!==e?"TGL.Vec2":a.a!==e&&a.b!==e&&a.c!==e&&a.d!==e?"TGL.Face4":a.a!==e&&a.b!==e&&a.c!==e?"TGL.Face3":void 0:void 0},translateJson:function(a){if(null!=a){if(null!=this.getClassName(a)){var b=Yb.newInstance(this.getClassName(a));if(b.deserializeJsonValue)b.deserializeJsonValue(a);else for(var c in a)b[c]=a[c];return b}if(a instanceof Array)for(var d=0;d<a.length;d++)a[d]=this.translateJson(a[d]);return a}},isChinese:function(a){return a=a||"",escape(a).indexOf("%u")>0},encodeURI:function(a){if(a instanceof Array){for(var b=0;b<a.length;b++)a[b]=this.encodeURI(a[b]);return a}return"string"==typeof a&&this.isChinese(a)?encodeURI(a):a},flattenArray:function(a){if(a instanceof Array){for(var b=0;b<a.length-1;b++)if(a[b]!=a[b+1]){if(!a[b]||!a[b].equals)return a;if(!a[b].equals(a[b+1]))return a}return a[0]}return a},deserializeValue:function(a,b){if("data"===b){var c=this.refMap[a];return c?c:this.idMap[a]}if("data.list"===b){for(var d,f,g=[],h=0;h<a.length;h++)d=a[h],f=Yb.newInstance(d["class"]),null!=d.ref&&(this.refMap[d.ref]=f),f.deserializeJson(this,d),g.push(f);return g}if("color"===b&&a.r!=e){var i=new Yb.Color;return i.setRGB(a.r,a.g,a.b),i}if("TGL.Path"===a["class"]){var j=new Yb.Path;return j.deserializeJsonValue(a),j}if(a instanceof Array){for(var h=0;h<a.length;h++)a[h]=this.translateJson(a[h]);return a}return null!=this.getClassName(a)?this.translateJson(a):a}}),Yb.addMethod(Yb.DataBox,{serializeJson:function(a,b,c){if(a.settings.isClientSerializable&&this._clientMap)for(var d in this._clientMap)this.serializeClientJson(a,d,b,c);this.serializePropertyJson(a,"name",b,c)},serializePropertyJson:function(a,b,c,d){a.serializePropertyJson(this,b,c,d)},serializeClientJson:function(a,b,c,d){a.serializeClientJson(this,b,c,d)},deserializeJson:function(a,b){var c;for(c in b.p)this.deserializePropertyJson(a,b.p[c],c);if(a.settings.isClientSerializable)for(c in b.c)this.deserializeClientJson(a,b.c[c],c)},deserializePropertyJson:function(a,b,c){a.deserializePropertyJson(this,b,c)},deserializeClientJson:function(a,b,c){a.deserializeClientJson(this,b,c)}}),Yb.addMethod(Yb.Data,{serializeJson:function(a,b,c){if(this.__SizePropeties&&this.__SizePropeties.length){var d,e;for(d=0,e=this.__SizePropeties.length;e>d;d++)this.serializePropertyJson(a,this.__SizePropeties[d],b,c)}else this.materialSize&&this.serializePropertyJson(a,"materialSize",b,c),this instanceof Yb.Entity&&(this.vertices&&this.vertices.length&&this.serializePropertyJson(a,"vertices",b,c),this.faces&&this.faces.length&&this.serializePropertyJson(a,"faces",b,c),this.uvs&&this.uvs.length&&this.serializePropertyJson(a,"uvs",b,c),this.uv2s&&this.uv2s.length&&this.serializePropertyJson(a,"uv2s",b,c));if(a.settings.isClientSerializable&&this._clientMap)for(var f in this._clientMap)this.serializeClientJson(a,f,b,c);this.serializePropertyJson(a,"name",b,c),this.serializePropertyJson(a,"parent",b,c)},serializePropertyJson:function(a,b,c,d){a.serializePropertyJson(this,b,c,d)},serializeClientJson:function(a,b,c,d){a.serializeClientJson(this,b,c,d)},deserializeJson:function(a,b){var c;for(c in b.p)this.deserializePropertyJson(a,b.p[c],c);if(a.settings.isClientSerializable)for(c in b.c)this.deserializeClientJson(a,b.c[c],c)},deserializePropertyJson:function(a,b,c){a.deserializePropertyJson(this,b,c)},deserializeClientJson:function(a,b,c){a.deserializeClientJson(this,b,c)}}),Yb.addMethod(Yb.Element,{serializeJson:function(a,b,c){if(a.settings.isStyleSerializable&&this.styleMap)for(var d in this.styleMap)this.isSideStyle(d)||this.serializeStyleJson(a,d,b,c);if(Yb.Element.superClass.serializeJson.call(this,a,b,c),this.serializePropertyJson(a,"position",b,c),this.serializePropertyJson(a,"rotation",b,c),this.serializePropertyJson(a,"scale",b,c),this._alarmState.getHighestNativeAlarmSeverity()&&"alarmstate"===a.settings.getPropertyType("alarmState")){var e={n:{},a:{}};c.p.alarmState=e,Yb.AlarmSeverity.forEach(function(a){var b=this.getNewAlarmCount(a);b>0&&(e.n[a.name]=b)},this._alarmState),Yb.AlarmSeverity.forEach(function(a){var b=this.getAcknowledgedAlarmCount(a);b>0&&(e.a[a.name]=b)},this._alarmState),sc.isEmptyObject(e.n)&&delete e.n,sc.isEmptyObject(e.a)&&delete e.a,sc.isEmptyObject(e)&&delete c.p.alarmState}},serializeStyleJson:function(a,b,c,d){a.serializeStyleJson(this,b,c,d)},deserializeJson:function(a,b){if(Yb.Element.superClass.deserializeJson.call(this,a,b),a.settings.isStyleSerializable)for(var c in b.s)this.deserializeStyleJson(a,b.s[c],c)},deserializeStyleJson:function(a,b,c){a.deserializeStyleJson(this,b,c)},deserializePropertyJson:function(a,b,c){if("alarmState"===c){if("alarmstate"===a.settings.getPropertyType("alarmState")){var d;for(d in b.n)this._alarmState.setNewAlarmCount(mono.AlarmSeverity.getByName(d),b.n[d]);for(d in b.a)this._alarmState.setAcknowledgedAlarmCount(mono.AlarmSeverity.getByName(d),b.a[d])}}else Yb.Element.superClass.deserializePropertyJson.call(this,a,b,c)}}),Yb.addMethod(Yb.Light,{serializeJson:function(a,b,c){if(Yb.Light.superClass.serializeJson.call(this,a,b,c),this.serializePropertyJson(a,"color",b,c),this.serializePropertyJson(a,"ambient",b,c),this.serializePropertyJson(a,"diffuse",b,c),this.serializePropertyJson(a,"specular",b,c),this.serializePropertyJson(a,"castShadow",b,c),this.serializePropertyJson(a,"onlyShadow",b,c),b.__accessor&&b.__accessor.length)for(var d=0;d<b.__accessor.length;d++)this.serializePropertyJson(a,b.__accessor[d],b,c)}});var od=Yb.Animate=function(a){var b=this;b.type=null==a.type?"number":a.type,b.delay=null==a.delay?0:a.delay,b.dur=null==a.dur?1e3:a.dur,
b.interval=null==a.interval?0:a.interval,b.finish=null==a.finish?b.delay+b.dur+b.interval:a.finish,b.repeat=null==a.repeat?1:a.repeat,b.reverse=null==a.reverse?!0:a.reverse,b.easing=null==a.easing?"easeNone":a.easing,b.onUpdate=a.onUpdate,b.onDone=a.onDone,b.onStop=a.onStop,b.onPlay=a.onPlay,b.attr=a.attr,b.source=a.source,b.filter=a.filter,b.from=a.from,b.to=a.to,b.start=null,b.time=0,b.total=0,b.count=0,b.started=!1,b.stopped=!1,b.id=qd++};Yb.extend(Yb.Animate,Object,{play:function(){return Qb(this)},stop:function(a){return Tb(this,a)},clone:function(){return new od(this)},chain:function(a){var b,c=this;return c.onDone?(b=c.onDone,c.onDone=function(){b.call(c),a.play()}):c.onDone=function(){a.play()},c}});var pd={},qd=1,rd=!1;!function sd(a){requestAnimationFrame(sd),rd&&(rd=!1,Vb(a))}(0)}(window),function(a,b){var c=a.make={},d={},e={},f=[],g={};c.Default={path:"./",resPath:"",getImagePath:function(a){return this.path+this.resPath+"res/images/"+(a||"")},register:function(a,b,c){c=c||{},c.name=c.name||a,c.modelDefaultParameters=c.modelDefaultParameters||{},c.description=c.description||c.name,d[a]&&console.log(a," already exist"),d[a]=b;var h=c.category||"",i=e[h]||{};i[a]=b,e[h]=i,g[a]=c,-1==f.indexOf(h)&&f.push(h),this.checkModelDefaultParameters(c.modelDefaultParameters)},checkModelDefaultParameters:function(a){if(a)for(var d in a){var e=a[d];e instanceof Object||(e={value:e},a[d]=e),e.propertyName=d,e.hidden=!!e.hidden,e.propertyType=e.propertyType||c.Default.PARAMETER_PROPERTY_TYPE_FIELD,e.type=e.type||c.Default.PARAMETER_TYPE_STRING,e.category=e.category||c.Default.PARAMETER_CATEGORY_DETAIL,e.editable=e.editable===b?!0:!!e.editable,e.index=e.index===b?100:parseInt(e.index)}},remove:function(a){if(d[a]){d[a]=b,delete d[a];var h=c.Default.getCategory(a),i=e[h];delete i[a];var j=0;for(var k in i)k&&j++;if(0==j)for(var k=0;k<f.length;k++){var l=f.indexOf(h);l>=0&&f.splice(l,1)}delete g[a]}else console.log(a," not exist")},getCategories:function(){return f},getCreatorsForCategory:function(a){return e[a]},getCreator:function(a){return d[a]},getIds:function(a){var b=[];for(var c in d)(!a||a&&a(this.getParameters(c)))&&b.push(c);return b},getModelDefaultParameters:function(a){var b=this.getParameters(a);return b.modelDefaultParameters},getDescription:function(a){var b=this.getParameters(a);return b.description},getName:function(a){var b=this.getParameters(a);return b.name},getIcon:function(a){var b=this.getParameters(a);return this.path+b.icon},isAsync:function(a){var b=this.getParameters(a);return b.async},isCombo:function(a){var b=this.getParameters(a);return b.combo},getCategory:function(a){var b=this.getParameters(a);return b.category},getOrder:function(a){var b=this.getParameters(a);return b.order||0},getType:function(a){var b=this.getParameters(a);return b.type},getOtherParameter:function(a,b){var c=this.getParameters(a);return c[b]},registerIcon:function(a,b){var c=this.getParameters(a);if(c)return c.icon=b,c.icon},registerDescription:function(a,b){var c=this.getParameters(a);return c.description=b,c.description},registerName:function(a,b){var c=this.getParameters(a);return c.name=b,c.name},registerOther:function(a,b,c){var d=e[b],e=this.getParameters(a);return e[b]=c,"modelDefaultParameters"===b&&(console.warn("rewrite modelDefaultParameters: id={0}, oldValue={}, newValue={}",a,d,c),this.checkModelDefaultParameters(c)),d},appendModelDefaultParameter:function(a,b,c,d,e,f,g){},getParameters:function(a){return g[a]||{}},load:function(a,b,c){var d,c=c||{},e=c.isRelation;if(b){var f=b;b=function(b){e&&a instanceof Array&&a.length>1&&b instanceof Array&&b.length>1&&this._relation(a,b),f(b)}}if(a instanceof Array){var g={};if(b){var h=function(c,d){var e=a.length;return function(a){c.datas=c.datas||[],c.datas.push(a),c._total===e&&b(c.datas)}(d)};g._total=0;for(var i=0;i<a.length;i++){var j=a[i];this.load(j,function(a){g._total++,h(g,a)})}return null}d=[];for(var i=0;i<a.length;i++){var j=a[i],k=this.load(j);k&&d.push(k)}}else{var l={};"string"==typeof a?l.id=a:l=a,l=this.filterJson(l),b?this._load(l,b):d=this._load(l)}return e&&d instanceof Array&&d.length>1&&this._relation(a,d),d},_relation:function(a,b){var c={};b.forEach(function(a){a.getId&&(c[a.getId()]=a)}),a.forEach(function(a){a.objectId&&a.parentId&&c[a.objectId]&&c[a.parentId]&&c[a.objectId].setParent&&c[a.objectId].setParent(c[a.parentId])})},_load:function(a,b){var d=a.id,e=this.getCreator(d);if(!e)return console.log("unknown id: ",d),null;if(!b){var f=e(a);return c.Default._setObjectClientId(f,d),f}e(a,function(a){c.Default._setObjectClientId(a,d),b&&b(a)})},_setObjectClientId:function(a,b){a&&(a instanceof mono.Element||a instanceof twaver.Data)&&a.setClient("id",b)},copyArray:function(a,b,c){if(b=[],a)for(var d,e=0,f=a.length;f>e;e++)d={},this.copyProperties(a[e],d),b.push(d);return b},copyProperties:function(a,d,e){if(a&&d)for(var f in a)e&&e.indexOf(f)>=0||f.startsWith("_")||(d[f]===b&&(a[f]instanceof Array?d[f]=[]:a[f]instanceof Function?d[f]=a[f]:a[f]instanceof Object?d[f]={}:d[f]=a[f]),a[f]instanceof Object&&d[f]instanceof Object&&c.Default.copyProperties(a[f],d[f]))},getModelDefaultParametersValues:function(a,b){var d=this.getModelDefaultParameters(a),e={};for(var f in d){var g=d[f];b&&b(g)||(g.propertyType==c.Default.PARAMETER_PROPERTY_TYPE_CLIENT?(e.client=e.client||{},e.client[f]=g.value):g.propertyType==c.Default.PARAMETER_PROPERTY_TYPE_STYLE?(e.style=e.style||{},e.style[f]=g.value):e[f]=g.value)}return e},getModelDefaultParameterProperties:function(a){var b=this,d=[],e=this.getModelDefaultParameters(a);if(!e)return d;e.id||(e.id={propertyName:"id",name:"模型ID",category:c.Default.PARAMETER_CATEGORY_BASIC,editable:!1,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD,type:c.Default.PARAMETER_TYPE_STRING,exportable:!1,index:-2}),e.objectId||(e.objectId={propertyName:"objectId",name:"实例ID",category:c.Default.PARAMETER_CATEGORY_BASIC,editable:!1,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD,type:c.Default.PARAMETER_TYPE_STRING,exportable:!1,index:-1});for(var f in e)d.push(e[f]);return d.sort(function(a,b){return a.index-b.index}),d=d.map(function(a){return b.modelParameterToProperty(a)})},_getNameFromPropertyName:function(a){for(var b=a.split("."),c="",d=0;d<b.length;d++)b[d].length>0&&(c+=b[d].substring(0,1).toUpperCase()+b[d].substring(1,b[d].length)),d<b.length-1&&(c+=" ");return c},modelParameterToProperty:function(a){var b=new twaver.Property;return b.setCategoryName(a.category),a.name||(a.name=this._getNameFromPropertyName(a.propertyName)),b.setName(a.name),b.setEditable(a.editable),b.setPropertyType(a.propertyType),b.setPropertyName(a.propertyName),b.setValueType(a.type),b.setEnumInfo(a.enumInfo),b.isVisible=function(){return!a.hidden},b},filterJson:function(a){var d=this.getModelDefaultParameters(a.id);for(var e in d){var f=d[e].propertyType||"client",g=d[e].value;f==c.Default.PARAMETER_PROPERTY_TYPE_STYLE?a.style&&a.style[e]!==b||(a.style=a.style||{},a.style[e]=g):f==c.Default.PARAMETER_PROPERTY_TYPE_CLIENT?a.client&&a.client[e]!==b||(a.client=a.client||{},a.client[e]=g):a[e]===b&&(a[e]=g)}return a},UNIT_HEIGHT:4.445,EQUIPMENT_WIDTH:45.5,RACK_OFFSET_X:7.25,RACK_OFFSET_Y:6.655,RACK_WIDTH:60,getUnitHeight:function(){return this.UNIT_HEIGHT},getEquipmentWidth:function(){return this.EQUIPMENT_WIDTH},getEquipmentHeight:function(a){return parseInt(a)>0||console.error("method getEquipmentHeight's first argument scale value is zero"),this.UNIT_HEIGHT*a},getRackWidth:function(){return this.RACK_WIDTH},getRackHeight:function(a){return parseInt(a)>0||console.error("method getRackHeight's first argument scale value is zero"),this.RACK_OFFSET_Y+this.UNIT_HEIGHT*parseInt(a)+this.RACK_OFFSET_Y}},c.Default.toJson=function(a,b){if(a instanceof mono.Element||a instanceof twaver.Data){var d=a.getClient("id"),e=c.Default.getModelDefaultParameters(d),f={},g=null,h=null;for(var i in e)if(e[i].exportable!==!1){var j=e[i].propertyType,h=e[i].value;j==c.Default.PARAMETER_PROPERTY_TYPE_ACCESSOR?(g=a[_twaver.getter(i)](),c.Default.equals(g,h)||(f[i]=g)):j==c.Default.PARAMETER_PROPERTY_TYPE_FIELD?(g=a[i],c.Default.equals(g,h)||(f[i]=g)):j==c.Default.PARAMETER_PROPERTY_TYPE_STYLE?(g=a.getStyle(i),c.Default.equals(g,h)||(f.style=f.style||{},f.style[i]=g)):j==c.Default.PARAMETER_PROPERTY_TYPE_CLIENT&&(g=a.getClient(i),c.Default.equals(g,h)||(f.client=f.client||{},f.client[i]=g))}return f.id=d,c.Default.EXPORT_OBJECT_ID&&(f.objectId=a.getId()),b&&(f=b(f)),f}return b&&(a=b(a)),a},c.Default.copy=function(a,b,d,e,f){var g=function(a,b,d,e,f){f=f||{};var g={},h={},i=c.Default.getParameters(b);c.Default.copyProperties(i,h),e instanceof Function?g=e(h)||{}:c.Default.copyProperties(e,g),f.copyDefaultParamCoverage&&delete h.modelDefaultParameters,f.copyParamCoverage||c.Default.copyProperties(h,g),c.Default.register(a,function(a,e){var f={id:b};d instanceof Function?d(a):c.Default.copyProperties(d,f),c.Default.copyProperties(a,f);var g=c.Default.load(f,e);return g},g)};g(a,b,d,e,f)},c.Default.PARAMETER_CATEGORY_BASIC="BASIC",c.Default.PARAMETER_CATEGORY_DETAIL="Detail",c.Default.PARAMETER_TYPE_STRING="string",c.Default.PARAMETER_TYPE_BOOLEAN="boolean",c.Default.PARAMETER_TYPE_COLOR="color",c.Default.PARAMETER_TYPE_INT="int",c.Default.PARAMETER_TYPE_NUMBER="number",c.Default.PARAMETER_TYPE_IMAGE="image",c.Default.PARAMETER_TYPE_ARRAY_STRING="array.string",c.Default.PARAMETER_TYPE_ARRAY_NUMBER="array.number",c.Default.PARAMETER_TYPE_ARRAY_INT="array.int",c.Default.PARAMETER_PROPERTY_TYPE_FIELD="field",c.Default.PARAMETER_PROPERTY_TYPE_ACCESSOR="accessor",c.Default.PARAMETER_PROPERTY_TYPE_STYLE="style",c.Default.PARAMETER_PROPERTY_TYPE_CLIENT="client",String.prototype.replaceAll=function(a,b,c){return RegExp.prototype.isPrototypeOf(a)?this.replace(a,b):this.replace(new RegExp(a,c?"gi":"g"),b)},String.prototype.format=function(a){var b=this;if(arguments.length>1){for(var c=[],d=0;d<arguments.length;d++)c.push(arguments[d]);a=c}if(a){if(a instanceof Array)a.forEach(function(a,c){a instanceof Object&&(a=JSON.stringify(a)),b=b.replaceAll("{"+c+"}",a)});else{if(!(a instanceof Object))return b.replaceAll("{}",a);for(var e in a){var f=a[e];f instanceof Object&&(f=JSON.stringify(f)),b=b.replaceAll("{"+e+"}",f)}}}return b},c.Default.getId=function(a){return a.getClient("id")},c.Default.objectWrapper=function(a,b,c,d){a.__defineGetter__(b,function(){var d=a["___"+b];return c&&(d=c.call(a,d,a,b)),d}),a.__defineSetter__(b,function(c){var e=a[b];d&&(c=d.call(a,c,a,b)),e!==c&&(a["___"+b]=c,this.firePropertyChange&&this.firePropertyChange(b,e,c))})},c.Default.equals=function(a,b){return a instanceof Object&&b instanceof Object?JSON.stringify(a)==JSON.stringify(b):a==b},c.Default.EXPORT_OBJECT_ID=!0,c.Utils2D={create2dShapeNode:function(a){var b=a.position||[0,0,0],d=a.data,e=a.image,f=(a.objType,a.objectId),g=a.closed,h=new c.Default.WallShapeNode(f);"innerWall"==a.objType?h=new c.Default.InnerWallShapeNode(f):"floor"==a.objType?h=new c.Default.FloorShapeNode(f):"cable"==a.objType&&(h=new c.Default.LineWidthShapeNode(f));var i=c.Default.create2dShapePath(d,b);return c.Default.objectWrapper(h,"id",function(){return this.getClient("id")}),c.Default.objectWrapper(h,"objectId",function(){return this.getId()}),h.setSegments(i.segments),h.setPoints(i.points),g&&h.setClient("closed",!0),e&&h.setClient("imageSrc",e),c.Default.setObject2dCSProps(h,a),h},create2dShapePath:function(a,b){var c=new twaver.List,d=new twaver.List;if(a.length>0)if(c.add("moveto"),a[0]instanceof Array){d.add({x:parseFloat(a[0][0])+parseFloat(b[0]),y:parseFloat(a[0][1])+parseFloat(b[2])});for(var e=1;e<a.length;e++){var f=a[e];"c"==f[0]?(c.add("quadto"),d.add({x:parseFloat(f[1])+parseFloat(b[0]),y:parseFloat(f[2])+parseFloat(b[2])}),d.add({x:parseFloat(f[3])+parseFloat(b[0]),y:parseFloat(f[4])+parseFloat(b[2])})):(c.add("lineto"),d.add({x:parseFloat(f[0])+parseFloat(b[0]),y:parseFloat(f[1])+parseFloat(b[2])}))}}else{d.add({x:parseFloat(a[0])+parseFloat(b[0]),y:parseFloat(a[1])+parseFloat(b[2])});for(var e=2;e<a.length;e+=2)c.add("lineto"),d.add({x:parseFloat(a[e])+parseFloat(b[0]),y:parseFloat(a[e+1])+parseFloat(b[2])})}return{segments:c,points:d}},setObject2dCSProps:function(a,b){var c=b.style,d=b.client;if(c)for(var e in c)a.setStyle(e,c[e]);if(d)for(var e in d)a.setClient(e,d[e])},createBlockObject:function(a,b){var d=a.objectId,e=new c.Default.Block(d);"door"==b?e=new c.Default.Door(d):"window"==b&&(e=new c.Default.Window(d)),a.width&&e.setClient("length",a.width);var f=a.client||{};return e.setClient("edgeIndex",f.edgeIndex||1),e.setClient("offset",f.offset||0),c.Default.setObject2dCSProps(e,a),e},createNode:function(a){var b=a.position||[0,0,0],d=a.rotation||[0,0,0],e=a.width||50,f=a.depth||50,g=a.image,h=a.objectId,i=new twaver.Follower(h);return c.Default.objectWrapper(i,"id",function(){return this.getClient("id")}),c.Default.objectWrapper(i,"objectId",function(){return this.getId()}),i.setSize(parseFloat(e),parseFloat(f)),i.setCenterLocation({x:parseFloat(b[0]),y:parseFloat(b[2])}),i.setAngle(d[1]),i.setClient("positionY",b[1]),g?i.setImageUrl(g):(i.setStyle("body.type","vector"),i.setStyle("vector.shape","rectangle")),i.setStyle("select.style","border"),i.setStyle("select.color","#F07819"),i.setStyle("select.width",.7),i.setStyle("vector.outline.width",1),i.setStyle("vector.outline.color","#BEC9BE"),i.setStyle("label.position","center"),c.Default.setObject2dCSProps(i,a),i},createFollower:function(a){var b=a,a={};c.Default.copyProperties(b,a),a.id=a.objectId||_twaver.id(),a.depth=a.depth||5,a.position=a.position||[0,0,0],a.rotation=a.rotation||[0,0,0];var d=new twaver.Follower(a);return c.Default.objectWrapper(d,"id",function(){return d.getClient("id")}),c.Default.objectWrapper(d,"objectId",function(){return d.getId()}),c.Default.objectWrapper(d,"depth"),c.Default.objectWrapper(d,"position",null,function(a){return this.setLocation({x:a[0],y:a[1]}),a}),c.Default.objectWrapper(d,"rotation",null,function(a){return this.setAngle(a[2]),a}),d.depth=a.depth,d.position=a.position,d.rotation=a.rotation,d.addPropertyChangeListener(function(a){var b=a.property,c=a.source;"location"==b?(c.position[0]=a.newValue.x,c.position[1]=a.newValue.y):"angle"==b&&(c.rotation[2]=a.newValue)},d),a.x&&d.setX(a.x),a.y&&d.setY(a.y),d.z=a.z,a.location&&(a.location instanceof Array?d.setLocation({x:a.location[0],y:a.location[1]}):d.setLocation(a.location)),a.centerLocation&&(a.centerLocation instanceof Array?d.setCenterLocation({x:a.centerLocation[0],y:a.centerLocation[1]}):d.setCenterLocation(a.centerLocation)),a.size&&d.setSize(a.size),a.angle&&d.setAngle(a.angle),d.setStyle("select.style","border"),d.setStyle("select.color","#F07819"),d.setStyle("select.width",.7),d.setStyle("vector.outline.color","#BEC9BE"),c.Default.setObject2dCSProps(d,a),d},align:function(a,b){if(b&&a&&!(a.size()<2)){var c=this["_align_"+b];c&&c.call(this,a)}},_align_up:function(a){for(var b=a.get(0).getLocation().y,c=1;c<a.size();c++)b=Math.min(b,a.get(c).getLocation().y);a.forEach(function(a){a.setY(b)})},_align_down:function(a){for(var b=a.get(0).getLocation().y+a.get(0).getSize().height,c=1;c<a.size();c++)b=Math.max(b,a.get(c).getLocation().y+a.get(c).getSize().height);a.forEach(function(a){a.setY(b-a.getSize().height)})},_align_left:function(a){for(var b=a.get(0).getLocation().x,c=1;c<a.size();c++)b=Math.min(b,a.get(c).getLocation().x);a.forEach(function(a){a.setX(b)})},_align_right:function(a){for(var b=a.get(0).getLocation().x+a.get(0).getSize().width,c=1;c<a.size();c++)b=Math.max(b,a.get(c).getLocation().x+a.get(c).getSize().width);a.forEach(function(a){a.setX(b-a.getSize().width)})},_align_center:function(a){for(var b=0,c=0;c<a.size();c++)b+=a.get(c).getCenterLocation().y;var d=b/a.size();a.forEach(function(a){a.setY(d-a.getSize().height/2)})},_align_middle:function(a){for(var b=0,c=0;c<a.size();c++)b+=a.get(c).getCenterLocation().x;var d=b/a.size();a.forEach(function(a){a.setX(d-a.getSize().width/2)})},flow:function(a,b,c){if(b&&a&&!(a.size()<2)){var d=this["_flow_"+b];d&&d.call(this,a,c)}},_flow_hor:function(a,b){this.sort(a,function(a,b){return a.getLocation().y-b.getLocation().y}),this.sort(a,function(a,b){return a.getLocation().x-b.getLocation().x});for(var c=a.get(0),d=1;d<a.size();d++){var e=a.get(d),f=c.getLocation().x;e.setX(f+b),c=e}},_flow_ver:function(a,b){this.sort(a,function(a,b){return a.getLocation().x-b.getLocation().x}),this.sort(a,function(a,b){return a.getLocation().y-b.getLocation().y});for(var c=a.get(0),d=1;d<a.size();d++){var e=a.get(d),f=c.getLocation().y;e.setY(f+b),c=e}},sort:function(a,b){for(var c,d,e,f,g=a.size(),h=0;g>h;h++){c=a.get(h);for(var i=h+1;g>i;i++)d=a.get(i),e=b?b(c,d):0,e>0&&(f=d,d=c,c=f,a.set(h,c),a.set(i,d))}},wrapper:function(a,b){c.Default.objectWrapper(a,"id",function(){return this.getClient("id")}),c.Default.objectWrapper(a,"objectId",function(){return this.getId()}),c.Default.objectWrapper(a,"width"),c.Default.objectWrapper(a,"height"),c.Default.objectWrapper(a,"depth"),c.Default.objectWrapper(a,"px"),c.Default.objectWrapper(a,"py"),c.Default.objectWrapper(a,"pz"),c.Default.objectWrapper(a,"rx"),c.Default.objectWrapper(a,"ry"),c.Default.objectWrapper(a,"rz"),c.Default.objectWrapper(a,"position"),c.Default.objectWrapper(a,"rotation"),b&&b.forEach(function(b){c.Default.objectWrapper(a,b)})}};for(var h in c.Utils2D)c.Default[h]=c.Utils2D[h];c.Utils3D={positionFloor:"floor-top",_objMap:{},_objObject:{},_envMaps:{envmap1:"envmap1.jpg",envmap2:"envmap2.jpg",envmap3:"envmap3.jpg"},getEnvMap:function(a){var b=c.Default.getImagePath()+c.Default._envMaps[a];return[b,b,b,b,b,b]},getOBjPath:function(a){return a?a.indexOf("http")>=0?a:this.path+a:this.path+"obj/"},createFloorForWall:function(a){var b={type:"twaver.floor",data:a.getClient("data")},c=this.getCreator(b.type);if(c){var d=this.loadData(b);d.setParent(a)}},createCombo:function(a,b){var c=[],d=[],e=[],f=[];!a||a instanceof Array||(a=[a]);for(var g=0;g<a.length;g++){var h=a[g],i=h.op||"+",j=h.style,k=h.client,l=h.position||[0,0,0],m=h.rotation||[0,0,0],n=h.scale||[1,1,1],o=null;if("cube"===h.type&&(o=this.createCube(h)),"cylinder"===h.type&&(o=this.createCylinder(h)),"sphere"===h.type&&(o=this.createSphere(h)),"polygon"===h.type&&(o=this.createPolygon(h)),"torus"===h.type&&(o=this.createTorus(h)),"path"===h.type&&(o=this.createPathCube(h)),"pathNode"===h.type&&(o=this.createPathNode(h)),"shapeNode"===h.type&&(o=this.createShapeNode(h)),o){if(m&&!h.rotationAnchor&&o.setRotation(m[0],m[1],m[2]),h.rotationAnchor){var p=o.getPosition();l=[l[0]+p.x,l[1]+p.y,l[2]+p.z]}o.setPosition(l[0],l[1],l[2]),o.setScale(n[0],n[1],n[2]),j&&o.s(j),k&&o.c(k),h.op?(o.getChildren().size()>0&&(c=c.concat(o.getChildren().toArray())),c.push(o),o.getChildren().size()>0?o.getChildren().forEach(function(){e.push(i)}):c.length>1&&e.push(i),f.push(o.getId())):d.push(o)}}if(c.length>0){var q;return q=b?new mono.ComboNode(c,e,!1,b):new mono.ComboNode(c,e),q.setNames(f),q}return 1==d.length?d[0]:d},setMainObject:function(a){function b(a,b){if(a){var c=a.getBoundingBox(),d=b.getBoundingBox(),e=c.min,f=c.max,g=d.min,h=d.max;(f.x-e.x<h.x-g.x||f.z-e.z<h.z-g.z)&&(a=b)}else a=b;return a}var c=null;if(a instanceof Array){for(var d=0;d<a.length;d++){var e=a[d];e instanceof mono.Entity&&(c=b(c,e))}for(var d=0;d<a.length;d++){var e=a[d];e instanceof mono.Entity&&c!=e&&a[d].setParent(c)}}else c=a;return c&&c.setClient("main",!0),c},createCube:function(a){var b,c=a.width,d=a.height,e=a.depth,f=a.color,g=a.rotation||[0,0,0],h=a.rotationAnchor,i=a.topColor||f,j=a.image,k=a.frontImage,l=a.wrapMode;if(b=a.id?new mono.Cube({id:a.id,width:c,height:d,depth:e}):new mono.Cube(c,d,e),b.s({"m.color":f,"m.ambient":f,"left.m.lightmap.image":this.getImagePath("inside_lightmap.jpg"),"right.m.lightmap.image":this.getImagePath("outside_lightmap.jpg"),"front.m.lightmap.image":this.getImagePath("outside_lightmap.jpg"),"back.m.lightmap.image":this.getImagePath("inside_lightmap.jpg"),"top.m.color":i,"top.m.ambient":i,"bottom.m.color":i,"bottom.m.ambient":i}),j&&b.setStyle("m.texture.image",j),k&&b.setStyle("front.m.texture.image",k),l&&b.setWrapMode(l),h){var m,n;"left"===h&&(m=new mono.Vec3(c/2,0,0),n=new mono.Vec3(0,1,0)),"right"===h&&(m=new mono.Vec3(-c/2,0,0),n=new mono.Vec3(0,1,0)),b.rotateFromAxis(n.clone(),m.clone(),g[1])}else b.setRotation(g[0],g[1],g[2]);return b},createCylinder:function(a){var b=a.radius,c=a.topRadius||b,d=a.bottomRadius||b,e=a.height,f=a.color,g=a.image,h=new mono.Cylinder(c,d,e);return h.s({"m.normalType":mono.NormalTypeSmooth,"m.type":"phong","m.color":f,"m.ambient":f,"side.m.lightmap.image":this.getImagePath("inside_lightmap.jpg")}),g&&h.setStyle("m.texture.image",g),h},createSphere:function(a){var b=a.radius,c=a.color||"#F5F5F5",d=a.image,e=new mono.Sphere(b);return e.s({"m.normalType":mono.NormalTypeSmooth,"m.type":"phong","m.color":c,"m.ambient":c,"m.lightmap.image":this.getImagePath("inside_lightmap.jpg")}),d&&e.setStyle("m.texture.image",d),e},createPolygon:function(a){var b=a.radius||100,c=a.topRadius||b,d=a.bottomRadius||b,e=a.height||200,f=a.radialSegments||3,g=a.color||"#F5F5F5",h=a.topColor||g,i=a.smooth||!0,j=a.image,k=new mono.Cylinder(c,d,e,f,i);return k.s({"m.normalType":mono.NormalTypeSmooth,"m.type":"phong","m.color":g,"m.ambient":g,"top.m.color":h,"top.m.ambient":h,"bottom.m.color":h,"bottom.m.ambient":h,"side.m.lightmap.image":this.getImagePath("inside_lightmap.jpg")}),j&&k.setStyle("m.texture.image",j),k},createTorus:function(a){var b=a.radius||50,c=a.tube||30,d=a.tubularSegments||3,e=a.radialSegments||6,f=a.color||"#F5F5F5",g=a.image,h=new mono.Torus(b,c,d,e);return h.s({"m.normalType":mono.NormalTypeSmooth,"m.type":"phong","m.color":f,"m.ambient":f,"m.lightmap.image":this.getImagePath("outside_lightmap.jpg")}),g&&h.setStyle("m.texture.image",g),h},createBillboard:function(a){var b=a.position||[0,0,0],c=a.scale||[1,1,1],d=a.image||this.getImagePath("outside_lightmap.jpg"),e=new mono.Billboard;return e.s({"m.texture.image":d,"m.alignment":mono.BillboardAlignment.bottomCenter,"m.depthTest":!1}),e.setScale(c[0],c[1],c[2]),e.p(b[0],b[1],b[2]),e},createPathNodePath:function(a){var b;if(a[0]&&a[0]instanceof Array)for(var c=0;c<a.length;c++){var d=a[c];b?"c"===d[0]?b.quadraticCurveTo(d[1],d[2],d[3],d[4],d[5],d[6]):b.lineTo(d[0],0,d[1]):(b=new mono.Path,b.moveTo(d[0],0,d[1]))}else for(var c=0;c<a.length;c+=3)b?b.lineTo(a[c],a[c+1],a[c+2]):(b=new mono.Path,b.moveTo(a[c],a[c+1],a[c+2]));return b},createPathNode:function(a){var b,c=a.radius,d=a.pathImage,e=a.repeat||50,f=a.offset||new mono.Vec2(0,0),g=a.startCap||"plain",h=a.endCap||"plain",i=a.pathWidth,j=a.pathHeight,k=i/2,l=j/2,m=[{x:k,y:-l},{x:k,y:l},{x:-k,y:l},{x:-k,y:-l}],n=this.createPathNodePath(a.data),o=n.getLength();return i&&j?b=new mono.PathNode({path:n,shape:m,segments:10,segmentsR:5}):(n=mono.PathNode.prototype.adjustPath(n,5),b=new mono.PathNode(n,c,3)),b.s({"m.texture.image":d,"m.texture.repeat":new mono.Vec2(o/e,1),"m.texture.offset":f}),g&&b.setStartCap(g),h&&b.setEndCap(h),b},createShapeNodePath:function(a){var b;if(a[0]&&a[0]instanceof Array)for(var c=0;c<a.length;c++){var d=a[c];b?"c"===d[0]?b.quadraticCurveTo(d[1],-d[2],0,d[3],-d[4],0):b.lineTo(d[0],-d[1],0):(b=new mono.Path,b.moveTo(d[0],-d[1],0))}else for(var c=0;c<a.length;c+=2)b?b.lineTo(a[c],-a[c+1],0):(b=new mono.Path,b.moveTo(a[c],-a[c+1],0));return b},createShapeNode:function(a){var c=a.repeat||100,d=a.amount||2,e=!0;(null!==a.vertical||a.vertical!=b)&&(e=a.vertical);var f,g=this.createShapeNodePath(a.data);return f=a.id?new mono.ShapeNode({id:a.id,path:g}):new mono.ShapeNode(g),a.curveSegments&&f.setCurveSegments(a.curveSegments),f.setAmount(d),f.setVertical(e),f.setRepeat(c),f},createPathCube:function(a){var b=a.width,c=a.height,d=a.data,e=a.insideColor,f=a.outsideColor,g=a.asideColor,h=a.zsideColor,i=a.topColor,j=a.bottomColor,k=a.insideImage||a.image,l=a.outsideImage||a.image,m=a.insideMap,n=a.outsideMap,o=a.repeat||a.height,p=a.closed,q=this.createShapeNodePath(d);p&&q.closePath();var r=new mono.PathCube(q,b,c);return r.s({"outside.m.color":f,"inside.m.type":"basic","inside.m.color":e,"aside.m.color":g||f,"zside.m.color":h||f,"top.m.color":i,"bottom.m.color":j||i,"inside.m.lightmap.image":m,"outside.m.lightmap.image":n,"aside.m.lightmap.image":n,"zside.m.lightmap.image":n,"inside.m.texture.image":k,"outside.m.texture.image":l}),r.setRepeat(o),r},getPicInfo:function(a,b){var c={};"string"==typeof b&&(b=[b]);for(var d=0;d<b.length;d++){var e=b[d],f=e.substring(0,e.indexOf(".")).toLowerCase();e=a+e,c[f]=e}return c},getRByD:function(a){return a*Math.PI/180},getDByR:function(a){return 180*a/Math.PI},getRsByDs:function(a){var b;if(a&&a.length>0){b=[];for(var d=0;d<a.length;d++)b.push(c.Default.getRByD(a[d]))}return b},setObject3dCSProps:function(a,b){b.client&&a.c(b.client),b.style&&a.s(b.style)},cloneObjElement:function(a,b){var d=c.Default.getRsByDs(a.rotation)||[0,0,0],e=a.scale||[1,1,1],f=a.position||[0,0,0];f[1]=parseFloat(f[1])||0;var g=this._objObject[a.name],h=g.getBoundingBoxWithChildren(),i=(h.max.y-h.min.y)/2,j=g.clonePrefab();if(a._id&&(j._id=a._id),a.client)for(var k in a.client)j.setClient(k,a.client[k]);return a.s&&j.s(a.s),j.setClient("type",a.name),j.setClient("showShadow",a.showShadow),a.showShadow&&j.setClient("shadowImage",a.shadowImage),a.shadowType&&j.setClient("shadowType",a.shadowType),j.setClient("json",a),j.setScale(e[0],e[1],e[2]),j.setPosition(f[0],f[1]+i*e[1],f[2]),j.setRotation(d[0],d[1],d[2]),b&&b(j),j},createObj:function(a,b){var c=this;if(this._objObject[a.name]){var d=this.getOBjPath(a.path),e=a.shadowImage=d+a.name+"S.png";return this.cloneObjElement(a,b)}if(!this._objMap[a.name]){this._objMap[a.name]=[];var d=this.getOBjPath(a.path),f=d+a.name+".obj",g=d+a.name+".mtl";a.scale||[1,1,1];if(a.showShadow){var e=a.shadowImage=d+a.name+"S.png";twaver.Util.registerImageByUrl(e,e)}var h=new mono.OBJMTLLoader;h.load(f,g,null,function(b){a.merged&&(b=mono.Utils.mergeElements(b.getDescendants())),c._objObject[a.name]=b,c._objMap[a.name].forEach(function(a){return c.cloneObjElement(a.json,a.callback)})})}this._objMap[a.name].push({json:a,callback:b})},getTextSize:function(a,b,c,d){var e=document.createElement("canvas"),f=e.getContext("2d"),g=a.split("\n"),h=0;f.font=b;for(var i=0;i<g.length;i++){var j=g[i],k=f.measureText(j).width;k>h&&(h=k)}var l=f.measureText("e").width*g.length*3+4,m={w:h+c,h:l+d};return m},generateTextCanvas:function(a,b,d,e,f){var g=document.createElement("canvas"),d=d||"bold 80px 微软雅黑,sans-serif",h=100,i=40,j=g.getContext("2d"),k=a.split("\n"),l=c.Default.getTextSize(a,d,h,i),m=l.w,n=l.h,o={width:m,height:n};g.height=mono.Utils.nextPowerOfTwo(l.h),g.width=mono.Utils.nextPowerOfTwo(l.w),e&&(j.save(),j.globalAlpha=1,j.fillStyle=f||"#FE642E",j.beginPath(),j.moveTo(0,0),j.lineTo(m,0),j.lineTo(m,n),j.lineTo(0,n),j.closePath(),j.fill()),j.restore(),j.fillStyle=b||"white",j.textBaseline="middle",j.textAlign="center",j.font=d;var p=j.measureText("o").width;if(1==k.length)j.fillText(k[0],g.width/2,g.height/2);else for(var q=0;q<k.length;q++)j.fillText(k[q],m/2,n/2+p*q*2.5);return g.drawRect=o,g},generateShadowNode:function(a,b){var d=null,e=a.getDescendants();if(e.forEach(function(a){a instanceof mono.Entity&&a.getClient("type")&&"floor"==a.getClient("type")&&(d=a)}),d){var f=d.getBoundingBox(),g=f.max.z-f.min.z,h=f.max.x-f.min.x,i=a.getRotation();a.setRotation(0,0,0);var j=c.Default.createShadowImage(a,d,b),k=new mono.Cube(h,1,g);k.s({"m.visible":!1,"top.m.visible":!0,"top.m.transparent":!0,"top.m.polygonOffset":!0,"top.m.polygonOffsetFactor":-1,"top.m.polygonOffsetUnits":-1,"top.m.texture.image":j});var l=d.getBoundingBox();return k.p((l.max.x+l.min.x)/2,1.5,(l.max.z+l.min.z)/2),k.setParent(d),a.setRotation(i),k}},_getWorldRotation:function(a){var b=(new mono.Mat4).extractRotation(a.worldMatrix),c=new mono.Vec3;return c.setEulerFromRotationMatrix(b),c},createShadowImage:function(a,b,d){var e=b.getBoundingBox(),f=e.max.z-e.min.z,g=e.max.x-e.min.x,h=Math.max(2048,Math.max(g,f)),i=h/2048,j=document.createElement("canvas"),k=mono.Utils.nextPowerOfTwo(g/i),l=mono.Utils.nextPowerOfTwo(f/i),m=g/k,n=f/l;j.width=k,j.height=l;var o=j.getContext("2d");o.beginPath(),o.rect(0,0,k,l);var p,q=a.getPosition(),r=a?a.getBoundingBox():null,s=-(r.max.x+r.min.x)/2-q.x,t=-(r.max.z+r.min.z)/2-q.z,u=a.getDescendants();if(u.forEach(function(a){return a.getClient&&"wallCombos"==a.getClient("id")?void(p=a):void 0}),p){var v=p.getClient("combos");v.forEach(function(a){if(a.getClient&&!a.getClient("resetPos")){var b=a.getPosition();a.p(b.x+parseFloat(q.x),b.y+parseFloat(q.y),b.z+parseFloat(q.z)),a.setClient("resetPos",!0)}u.push(a)})}return u.push(a),u.forEach(function(a){var b=a.getWorldPosition(),e=k/2+b.x/m,f=l/2+b.z/n,h=c.Default._getWorldRotation(a),i=a.getClient("type");if("wall"==i||"inner_wall"==i||"glass_wall"==i){var j=a.getClient("data");if(o.save(),o.translate(e,f),o.beginPath(),j[0]&&j[0]instanceof Array){for(var p=0;p<j.length;p++)0==p?o.moveTo(j[p][0]/m+s/m,j[p][1]/n+t/n):o.lineTo(j[p][0]/m+s/m,j[p][1]/n+t/n);"wall"==i&&o.lineTo(j[0][0]/m+s/m,j[0][1]/n+t/n)}else{for(var p=0;p<j.length;p+=2)0==p?o.moveTo(j[p]/m+s/m,j[p+1]/n+t/n):o.lineTo(j[p]/m+s/m,j[p+1]/n+t/n);"wall"==i&&o.lineTo(j[0]/m+s/m,j[1]/n+t/n)}o.lineWidth=20/m,o.strokeStyle="#ccc",o.shadowColor="#000";var q=Math.min(parseInt(g/15),300);o.shadowBlur=parseInt(q/m),("inner_wall"==i||"glass_wall"==i)&&(o.translate(e,f),o.lineWidth=10/m,o.shadowBlur=parseInt(q/m)),o.shadowOffsetX=0,o.shadowOffsetY=0,o.stroke(),o.stroke(),parseInt(g/15)>200&&(o.stroke(),o.stroke()),o.restore()}var r=a.getClient("showShadow");d&&(r=r&&d(a));var u=a.getClient("shadowImage"),v=a.getClient("shadowType")||0,w=a.getClient("shadowWeight")||2;if(r){var x=a.getBoundingBox(),y=x.size(),z=y.x/m*.99,A=depth=y.z/n*.99;if(h.y%(Math.PI/2)==0&&(z=y.x/n*.99,A=depth=y.z/m*.99),h.y%Math.PI==0&&(z=y.x/m*.99,A=depth=y.z/n*.99),1==v){var B=Math.min(y.x,y.z);z=B/m*.99,A=depth=B/n*.99,h.y%(Math.PI/2)==0&&(z=B/n*.99,A=depth=B/m*.99),h.y%Math.PI==0&&(z=B/m*.99,A=depth=B/n*.99)}if(u){var C=twaver.Util.getImageAsset(u);if(!C)return;o.save(),o.translate(e+s/m,f+t/n),o.rotate(-h.y);var D=.3*Math.max(z,depth);h.y%(Math.PI/2)==0&&(o.drawImage(C.getImage(),-z/2-D/2,-depth/2-D/n/4,z+D,depth+D/m),o.drawImage(C.getImage(),-z/2-D/2,-depth/2-D/n/4,z+D,depth+D/m)),h.y%Math.PI==0&&(o.drawImage(C.getImage(),-z/2-D/2,-depth/2-D/2,z+D,depth+D),o.drawImage(C.getImage(),-z/2-D/2,-depth/2-D/2,z+D,depth+D)),o.restore()}else if(0==v){o.save(),o.translate(e+s/m,f+t/n),o.rotate(-h.y),o.beginPath(),o.moveTo(-z/2,0),o.lineTo(z/2,0),o.lineWidth=A,o.strokeStyle="gray",o.shadowColor="#333";var E=Math.min(z,depth);o.shadowBlur=2*E,o.shadowOffsetX=0,o.shadowOffsetY=0,1==w?(o.shadowBlur=3*E,o.stroke()):2==w&&(o.stroke(),o.stroke()),o.restore()}else if(1==v){var e=e+s/m,f=f+t/n,F=a.getClient("shadowRadius");F?F/=n:F=Math.sqrt(z*z+depth*depth)/2,o.save(),o.beginPath(),o.arc(e,f,F,0,2*Math.PI,!1),o.fillStyle="gray",o.shadowColor="black",o.shadowBlur=2*F,o.shadowOffsetX=0,o.shadowOffsetY=0,1==w?(o.shadowBlur=3*F,o.fill()):2==w&&(o.fill(),o.fill()),o.restore()}}}),j},getRelativePosition:function(a,b){var c,d;c=(new mono.Mat4).getInverse(a.worldMatrix.clone()),d=(new mono.Mat4).multiplyMatrices(c,b.worldMatrix.clone());var e=main.position=(new mono.Vec3).getPositionFromMatrix(d);return e},getPathBoundingBox:function(a){var b={},c={centerPoint:{x:0,y:0},min:{x:0,y:0},max:{x:0,y:0},size:{x:0,y:0}};if(0==a.length)return c;var d,e,f,g;if(a[0]instanceof Array){d=a[0][0],e=a[0][0],f=-a[0][1],g=-a[0][1];for(var h=1;h<a.length;h++)d=Math.min(d,a[h][0]),e=Math.max(e,a[h][0]),f=Math.min(f,-a[h][1]),g=Math.max(g,-a[h][1])}else{if(a.length<2)return c;d=a[0],e=a[0],f=-a[1],g=-a[1];for(var h=2;h<a.length;h+=2)d=Math.min(d,a[h]),e=Math.max(e,a[h]),f=Math.min(f,-a[h+1]),g=Math.max(g,-a[h+1])}return b.centerPoint={x:(d+e)/2,y:(f+g)/2},b.min={x:d,y:f},b.max={x:e,y:g},b.size={x:e-d,y:g-f},b},setPositionY:function(a,b){if("number"==typeof b)a.setPositionY(b);else if(b==c.Default.positionFloor){
var d=a.getBoundingBox().size();a.setPositionY(d.y/2)}},playAnimation:function(a,b,c){var d=b.split(":");if("move"===d[0]){var e=d[1];this.animateMove(a,e,c)}if("rotation"===d[0]){var f=d[1],g=d[2],h=parseInt(d[3])||1e3,i=parseInt(d[4]),j=d[5];this.animateRotate(a,f,g,h,i,j,c)}},animateMove:function(a,b,c){var d=a.getBoundingBox().size().multiply(a.getScale()),e=.8,f=new mono.Vec3(0,0,1),g=0;"right"===b&&(f=new mono.Vec3(1,0,0),g=d.x),"left"===b&&(f=new mono.Vec3(-1,0,0),g=d.x),"top"===b&&(f=new mono.Vec3(0,1,0),g=d.y),"bottom"===b&&(f=new mono.Vec3(0,-1,0),g=d.y),"front"===b&&(f=new mono.Vec3(0,0,1),g=d.z),"back"===b&&(f=new mono.Vec3(0,0,-1),g=d.z),g*=e,a.getClient("animated")&&(f=f.negate());var h=a.getPosition().clone();a.setClient("animated",!a.getClient("animated")),new twaver.Animate({from:0,to:1,dur:2e3,easing:"bounceOut",onUpdate:function(b){a.setPosition(h.clone().add(f.clone().multiplyScalar(g*b)))},onDone:function(){c&&c()}}).play()},animateRotate:function(a,c,d,e,f,g,h){g=g||"easeInStrong";var i=a.getBoundingBox().size().multiply(a.getScale()),j=0,k=1;a.getClient("animated")&&(k=-1),a.setClient("animated",!a.getClient("animated"));var l,m;if("left"===c){l=new mono.Vec3(-i.x/2,0,0);var m=new mono.Vec3(0,1,0)}if("right"===c){l=new mono.Vec3(i.x/2,0,0);var m=new mono.Vec3(0,1,0)}if("center-z"===c){l=new mono.Vec3(0,0,0);var m=new mono.Vec3(0,0,1)}var n=new twaver.Animate({from:j,to:k,dur:e,delay:f,easing:g,onUpdate:function(c){this.lastValue===b&&(this.lastValue=0),a.rotateFromAxis(m.clone(),l.clone(),Math.PI/180*-d*(c-this.lastValue)),this.lastValue=c},onDone:function(){delete this.lastValue,h&&h()}});n.play()},animateCameraPosition:function(a,b,c,d){var e=a.getPosition(),f=new twaver.Animate({from:0,to:1,dur:c,easing:"easeBoth",onUpdate:function(c){var d=e.x+(b.x-e.x)*c,f=e.y+(b.y-e.y)*c,g=e.z+(b.z-e.z)*c,h=new mono.Vec3(d,f,g);a.setPosition(h)}});return f.onDone=d,f}};for(var h in c.Utils3D)c.Default[h]=c.Utils3D[h];c.Default.register("twaver.cube",function(a,b){a.rotation=c.Default.getRsByDs(a.rotation||[0,0,0]);var d=c.Default.createCube(a),e=a.position||[0,0,0];return d.p(e[0],e[1],e[2]),b&&b(d),d},{category:"基本模型",type:"mono.Element",name:"立方体",icon:"model/idc/icons/cube.png",description:"立方体是make里面提供的最基本的模型，可以用这种模型扩展出各种立方体形状的模型，比如箱子，柱子，盒子等。支持更改长，宽，高，贴图等基本参数",modelDefaultParameters:{width:{name:"宽",value:100,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},height:{name:"高",value:100,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},depth:{name:"深",value:100,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},color:{name:"颜色",value:"white",type:c.Default.PARAMETER_TYPE_COLOR,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},image:{name:"贴图",value:b,type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},position:{value:[0,0,0],name:"位置",type:c.Default.PARAMETER_TYPE_ARRAY_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD,editable:!1},rotation:{value:[0,0,0],name:"旋转角度",type:c.Default.PARAMETER_TYPE_ARRAY_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD,editable:!1}}}),c.Default.register("twaver.cylinder",function(a,b){var d=c.Default.createCylinder(a);return b&&b(d),d},{category:"基本模型",type:"mono.Element",name:"圆柱体",icon:"model/idc/icons/cylinder.png",description:"圆柱体是make中提供的最基本模型，支持更改半径，高度的参数。可以更改这些参数扩展出各个圆柱体形状的模型，比如圆形柱子，桌子腿，瓶子，圆筒等",modelDefaultParameters:{topRadius:{name:"顶半径",value:60,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},bottomRadius:{name:"底半径",value:60,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},height:{name:"高",value:100,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},color:{name:"颜色",value:"white",type:c.Default.PARAMETER_TYPE_COLOR,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},image:{name:"贴图",value:b,type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},position:{value:[0,0,0],name:"位置",type:c.Default.PARAMETER_TYPE_ARRAY_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD,editable:!1},rotation:{value:[0,0,0],name:"旋转角度",type:c.Default.PARAMETER_TYPE_ARRAY_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD,editable:!1}}}),c.Default.register("twaver.sphere",function(a,b){var d=c.Default.createSphere(a);return b&&b(d),d},{category:"基本模型",type:"mono.Element",name:"球体",icon:"model/idc/icons/sphere.png",description:"球体是make中提供的最基本模型，支持更改半径的参数。可以更改这些参数扩展出各个球体形状的模型，比如圆球等",modelDefaultParameters:{radius:{name:"半径",value:80,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},color:{name:"颜色",value:"#F5F5F5",type:c.Default.PARAMETER_TYPE_COLOR,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},image:{name:"贴图",value:b,type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},position:{value:[0,0,0],name:"位置",type:c.Default.PARAMETER_TYPE_ARRAY_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD,editable:!1},rotation:{value:[0,0,0],name:"旋转角度",type:c.Default.PARAMETER_TYPE_ARRAY_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD,editable:!1}}}),c.Default.register("twaver.polygon",function(a,b){var d=c.Default.createPolygon(a);return b&&b(d),d},{category:"基本模型",type:"mono.Element",name:"多边形",icon:"model/idc/icons/polygon.png",description:"多边形是make中提供的最基本模型，支持更改半径，高度，边数的参数。可以更改这些参数扩展出各个多边形状的模型，比如多边形柱子，多边形箱子，各种支架等",modelDefaultParameters:{color:{name:"颜色",value:"white",type:c.Default.PARAMETER_TYPE_COLOR,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},image:{name:"贴图",value:b,type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},topRadius:{name:"顶半径",value:100,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},bottomRadius:{name:"底半径",value:100,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},height:{name:"高",value:200,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},radialSegments:{name:"边数",value:3,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},position:{value:[0,0,0],name:"位置",type:c.Default.PARAMETER_TYPE_ARRAY_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD,editable:!1},rotation:{value:[0,0,0],name:"旋转角度",type:c.Default.PARAMETER_TYPE_ARRAY_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD,editable:!1}}}),c.Default.register("twaver.torus",function(a,b){var d=c.Default.createTorus(a);return b&&b(d),d},{category:"基本模型",type:"mono.Element",name:"圆环",icon:"model/idc/icons/torus.png",description:"圆环体是make中提供的最基本模型，支持更改半径，高度，扁平程度，管半径的参数。可以更改这些参数扩展出各个圆环体形状的模型，比如轮胎等",modelDefaultParameters:{color:{name:"颜色",value:"white",type:c.Default.PARAMETER_TYPE_COLOR,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},image:{name:"贴图",value:b,type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},radius:{name:"半径",value:50,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},tube:{name:"内外径差",value:30,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},tubularSegments:{name:"扁平程度",value:3,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},radialSegments:{name:"边数",value:6,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},position:{value:[0,0,0],name:"位置",type:c.Default.PARAMETER_TYPE_ARRAY_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD,editable:!1},rotation:{value:[0,0,0],name:"旋转角度",type:c.Default.PARAMETER_TYPE_ARRAY_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD,editable:!1}}});var i=0;c.Default.register("twaver.combo",function(a,b){var d="pack_"+i++,e=a.data;if(e&&mono.Utils.isArray(e)){for(var f=null,g=null,h=[],j=0;j<e.length;j++){if(g=c.Default.load(e[j]),f){var k=g.getClient("type");"inner_wall"==k||"column"==k||"glass_wall"==k?(h.push(g),g.getChildren().size()>0&&g.getChildren().forEachReverse(function(a){a.setParent(f)})):g.setParent(f)}else f=g;g.setClient?g.setClient("pack",d):(g.client=g.client||{},g.client.pack=d)}for(var l=[],j=1;j<h.length;j++)l.push("+");if(h&&h.length>0){var m=new mono.ComboNode(h);m.setClient("id","wallCombos"),m.setClient("combos",m.getCombos()),m.setParent(f)}return b&&b(f),f}},{icon:"model/idc/icons/combo.png",category:"基本模型",type:"mono.Element",name:"组合模型",description:"组合模型，可以把多个不同的模型组合在一块，组成一个新的模型，传如参数是一个数组"}),c.Default.registerObj=function(a,b,d,e,f,g){var h=function(a,e){return a.name=b,a.path=d,a.showShadow=f,g&&(a.shadowType=g),null==a.merged&&(a.merged=!0),c.Default.createObj(a,e)};e=e||{},e.async=!0,c.Default.register(a,h,e)},c.Default.register("twaver.loader",function(a,b){return c.Default.load(a.data,b)}),c.Default.devicePanel_server={"f5-big-ip3600":{height:1,description:"F5 BIG-IP LTM 3600，可将您的网络转变为灵活的应用交付基础架构"},hp_3par_7400:{height:6,description:""},hp_c7000_matrix:{height:10,description:"BladeSystem c7000 机箱可提供模块化服务器、互连和存储组件当前和未来几年所需的电力、散热能力及 I/O 基础设施。 该机箱高 10U，可容纳 16 台服务器和/或存储刀片，以及可选的冗余网络和存储互连模块"},hp_dl360_gen8_3par:{height:1,description:"HP ProLiant DL360e Gen8是一款电子产品，CPU型号为XeonE5-24031.8GHz，标配CPU数量为1颗"},hp_rp4440:{height:4,description:"惠普HP 9000 rp4440-8，是一款处理器类型为PA-8900，处理器主频为800MHz/1GHz"},hp_rp7420:{height:2,description:"惠普9000rp7420-16是一款小型机，处理器主频为1.1GHz"},hp_rx3600_1:{height:2,description:"类别:机架式 结构:2U CPU类型:双处理器 支持CPU个数:2 内存大小:2GB 硬盘大小（GB）:73GB"},hp_rx3600:{height:2,description:"类别:机架式 结构:2U CPU类型:双处理器 支持CPU个数:2 内存大小:2GB 硬盘大小（GB）:73GB"},hp_rx9800:{height:4,description:"HP Integrity rx9800融合了HP Integrity Server，Blade-system server的优势，能够显著提高灵活性并大大简化复杂的基础设施"},hp_rx9900:{height:10,description:"HP Integrity rx9900融合了HP Integrity Server，Blade-system server的优势，能够显著提高灵活性并大大简化复杂的基础设施"},hp_rx9900:{height:10,description:"HP Integrity rx9900融合了HP Integrity Server，Blade-system server的优势，能够显著提高灵活性并大大简化复杂的基础设施"},hp_san:{height:1,description:"HP StorageWorks SAN虚拟化服务平台(SVSP)是一款基于网络的虚拟化解决方案，客户可以集中管理存储池，并在不同的服务器环境中创建惠普与非惠普存储资源虚拟卷"},hp_tape_5300:{height:3,description:"HP tape array 5300是一个3U的机柜系统，可安装两个全高阵列模块，四个半高模块，或者一个全高和两个半高模块。该机柜系统支持惠普阵列模块，包括Ultrium（傲群）230、Ultrium（傲群）215、DLT80、DLT vs80、DAT40和DAT24磁带驱动器，以及DVD-ROM"},netopti2200:{height:1,description:""},nsae6500:{height:2,description:"SonicWALL NSA E6500是一款企业级防火墙，网络吞吐量是3072Mbps"},yh_610l:{height:4,description:"用户界面友好,带前置过滤网易于维护,支持250W ATX PFC PS/2电源,前置电源和HDD状态指示灯,抗振荡抗冲击,能在高温下稳定工作,防震设计的驱动器台可以容和3个5.25寸及1个3.5寸前端驱动器,灵活的机械设计支持PS/2单电源和冗余电源 "},amp_category_5e_system:{height:1,description:""},h3c_ix3000:{height:4,description:"IX3000设备的控制器在NeoStor控制台中显示为NeoStor服务器。每台IX3000设备有两个控制器，在NeoStor控制台中对应有两个NeoStor服务器"},ddf:{height:3,description:"数字配线架是数字复用设备之间，数字复用设备与程控交换设备或数据业务设备等其他专业设备之间的配线连接设备"},"hikvision_ds-8108hs_s":{height:2,description:""},hp_p6300:{height:4,description:"HP EVA P6000 是一款简单易用、容量增强的存储系统，它内置虚拟化功能，可整合存储和简化 IT。 EVA P6000 还提供高性能、高可用性和可靠的数据保护"},modem:{height:4,description:"调制解调器(Modem,Modulator-Demodulator)是一个将数字信号调制到模拟载波信号上进行传输,并解调收到的模拟信号以得到数字信息的电子设备"},"raritan_kx2-432":{height:1,description:""},fw1000_gm_ne:{height:1,description:""},gzz:{height:9,description:""},gxpxj:{height:2,description:""},storageworks:{height:4,description:"网络存储器"},ct_Ttss2000:{height:3,description:""},xsqjp:{height:8,description:""},zxjmzz:{height:1,description:""},kedong_stone_wall_2000:{height:1,description:""},ibm_x3650_m3:{height:2,data:[{width:500,height:89,style:{"vector.fill.color":"#404040"},id:"twaver.idc.network.panel"},{position:[306,11,0],id:"twaver.idc.disk_01.panel"},{position:[0,35,0],id:"twaver.idc.deco_02.panel"},{position:[482,36,0],id:"twaver.idc.deco_02.panel"},{position:[475,0,0],id:"twaver.idc.logo_ibm.panel"},{position:[343,0,0],id:"twaver.idc.grid_01.panel"},{position:[351,33,0],id:"twaver.idc.VGA_01.panel"},{position:[386,37,0],id:"twaver.idc.port_03.panel"},{position:[396,36,0],id:"twaver.idc.usb_01.panel"},{position:[411,36,0],id:"twaver.idc.usb_01.panel"},{position:[406,30,0],id:"twaver.idc.text_01.panel"},{position:[434,37,0],id:"twaver.idc.text_02.panel"},{position:[348,48,0],id:"twaver.idc.disk_02.panel"},{position:[348,66,0],id:"twaver.idc.disk_03.panel"},{position:[2,11,0],id:"twaver.idc.deco_01.panel"},{position:[288,11,0],id:"twaver.idc.disk_01.panel"},{position:[270,11,0],id:"twaver.idc.disk_01.panel"},{position:[252,11,0],id:"twaver.idc.disk_01.panel"},{position:[234,11,0],id:"twaver.idc.disk_01.panel"},{position:[216,11,0],id:"twaver.idc.disk_01.panel"},{position:[198,11,0],id:"twaver.idc.disk_01.panel"},{position:[180,11,0],id:"twaver.idc.disk_01.panel"},{position:[162,11,0],id:"twaver.idc.disk_01.panel"},{position:[144,11,0],id:"twaver.idc.disk_01.panel"},{position:[126,11,0],id:"twaver.idc.disk_01.panel"},{position:[108,11,0],id:"twaver.idc.disk_01.panel"},{position:[90,11,0],id:"twaver.idc.disk_01.panel"},{position:[72,11,0],id:"twaver.idc.disk_01.panel"},{position:[54,11,0],id:"twaver.idc.disk_01.panel"},{position:[36,11,0],id:"twaver.idc.disk_01.panel"}]},ibm_p750:{height:4,data:[{height:178,id:"twaver.idc.network.panel"},{position:[-3,0,0],id:"twaver.idc.deco_03.panel"},{position:[437,0,0],id:"twaver.idc.deco_03.panel"},{position:[205,97,0],id:"twaver.idc.disk_05.panel"},{position:[224,97,0],id:"twaver.idc.disk_05.panel"},{position:[243,97,0],id:"twaver.idc.disk_05.panel"},{position:[357,97,0],id:"twaver.idc.disk_05.panel"},{position:[262,97,0],id:"twaver.idc.disk_05.panel"},{position:[281,97,0],id:"twaver.idc.disk_05.panel"},{position:[300,97,0],id:"twaver.idc.disk_05.panel"},{position:[319,97,0],id:"twaver.idc.disk_05.panel"},{position:[338,97,0],id:"twaver.idc.disk_05.panel"},{position:[201,97,0],id:"twaver.idc.deco_05.panel"},{position:[220,97,0],id:"twaver.idc.deco_05.panel"},{position:[239,97,0],id:"twaver.idc.deco_05.panel"},{position:[258,97,0],id:"twaver.idc.deco_05.panel"},{position:[277,97,0],id:"twaver.idc.deco_05.panel"},{position:[296,97,0],id:"twaver.idc.deco_05.panel"},{position:[315,97,0],id:"twaver.idc.deco_05.panel"},{position:[334,97,0],id:"twaver.idc.deco_05.panel"},{position:[353,97,0],id:"twaver.idc.deco_05.panel"},{position:[376,97,0],id:"twaver.idc.disk_05.panel"},{position:[391,97,0],id:"twaver.idc.deco_05.panel"},{position:[12,84,0],id:"twaver.idc.deco_04.panel"},{position:[11,71,0],id:"twaver.idc.deco_08.panel"},{position:[230,4,0],id:"twaver.idc.disk_04.panel"},{position:[368,0,0],id:"twaver.idc.deco_07.panel"},{position:[207,71,0],id:"twaver.idc.port_04.panel"},{position:[271,71,0],id:"twaver.idc.disk_06.panel"},{position:[12,1,0],id:"twaver.idc.grid_02.panel"},{position:[437,127,0],id:"twaver.idc.deco_06.panel"},{position:[372,97,0],id:"twaver.idc.deco_05.panel"},{width:15,height:15,position:[437,67,0],id:"twaver.idc.logo_ibm.panel"}]}},c.Default.devicePanel_network={cisco_2950:{height:1,description:"Cisco Catalyst 2950系列智能以太网交换机是一个固定配置、可堆叠的独立设备系列，提供了线速快速以太网和千兆位以太网连接",data:[{id:"twaver.idc.cisco_2950.panel"},{position:[412,28,0],id:"twaver.idc.port_02.panel"},{position:[432,28,0],id:"twaver.idc.port_02.panel"},{client:{bid:"1"},position:[44,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"2"},position:[58,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"3"},position:[73,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"4"},position:[88,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"5"},position:[103,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"6"},position:[118,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"7"},position:[133,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"8"},position:[147,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"9"},position:[165,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"10"},position:[180,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"11"},position:[195,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"12"},position:[210,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"13"},position:[225,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"14"},position:[240,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"15"},position:[255,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"16"},position:[269,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"17"},position:[288,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"18"},position:[303,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"19"},position:[318,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"20"},position:[333,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"21"},position:[348,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"22"},position:[363,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"23"},position:[377,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"24"},position:[391,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"}]},cisco_2960:{height:1,description:"Cisco Catalyst 2960系列交换机是一系列采用以太网供电或非PoE配置，可提供桌面快速以太网和千兆以太网连接，并可为入门级企业、中间市场和分支机构网络实现高级局域网服务的固定配置独立式智能以太网设备",data:[{id:"twaver.idc.cisco_2960.panel"},{client:{bid:"1"},position:[214,14,0],id:"twaver.idc.rj4502.panel"},{client:{bid:"2"},position:[214,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"3"},position:[229,14,0],id:"twaver.idc.rj4502.panel"},{client:{bid:"4"},position:[229,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"5"},position:[244,14,0],id:"twaver.idc.rj4502.panel"},{client:{bid:"6"},position:[244,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"7"},position:[259,14,0],id:"twaver.idc.rj4502.panel"},{client:{bid:"8"},position:[259,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"9"},position:[274,14,0],id:"twaver.idc.rj4502.panel"},{client:{bid:"10"},position:[274,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"11"},position:[289,14,0],id:"twaver.idc.rj4502.panel"},{client:{bid:"12"},position:[289,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"13"},position:[309,14,0],id:"twaver.idc.rj4502.panel"},{client:{bid:"14"},position:[309,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"15"},position:[324,14,0],id:"twaver.idc.rj4502.panel"},{client:{bid:"16"},position:[324,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"17"},position:[339,14,0],id:"twaver.idc.rj4502.panel"},{client:{bid:"18"},position:[339,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"19"},position:[354,14,0],id:"twaver.idc.rj4502.panel"},{client:{bid:"20"},position:[354,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"21"},position:[369,14,0],id:"twaver.idc.rj4502.panel"},{client:{bid:"22"},position:[369,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"23"},position:[384,14,0],id:"twaver.idc.rj4502.panel"},{client:{bid:"24"},position:[384,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"25"},position:[408,27,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"26"},position:[432,27,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"}]},h3c_s1050t:{height:1,description:" H3C S1050T-E是H3C公司为政府、教育、中小企业等用户量身打造的一款高性能无管理以太网交换产品，提供48个的10/100M自适应以太网端口以及2个10/100/1000M自适应以太网端口，所有端口均支持全线速无阻塞交换以及端口自动翻转功能，外形采用19英寸标准机架设计。S1050T-E以其所有端口全线速的转发、电信级的稳定性和最广泛的适用性成为高密度接入设备的最佳选择",data:[{id:"twaver.idc.h3c_s1050t.panel"},{client:{bid:"9"},position:[74,12,0],id:"twaver.idc.rj4503.panel"},{client:{bid:"11"},position:[90,12,0],id:"twaver.idc.rj4503.panel"},{client:{bid:"13"},position:[106,12,0],id:"twaver.idc.rj4503.panel"},{client:{bid:"15"},position:[122,12,0],id:"twaver.idc.rj4503.panel"},{client:{bid:"17"},position:[138,12,0],id:"twaver.idc.rj4503.panel"},{client:{bid:"19"},position:[154,12,0],id:"twaver.idc.rj4503.panel"},{client:{bid:"21"},position:[170,12,0],id:"twaver.idc.rj4503.panel"},{client:{bid:"2"},position:[10,24,0],rotation:[0,0,180],id:"twaver.idc.rj4503.panel"},{client:{bid:"4"},position:[26,24,0],rotation:[0,0,180],id:"twaver.idc.rj4503.panel"},{client:{bid:"6"},position:[42,24,0],rotation:[0,0,180],id:"twaver.idc.rj4503.panel"},{client:{bid:"8"},position:[58,24,0],rotation:[0,0,180],id:"twaver.idc.rj4503.panel"},{client:{bid:"10"},position:[74,24,0],rotation:[0,0,180],id:"twaver.idc.rj4503.panel"},{client:{bid:"12"},position:[90,24,0],rotation:[0,0,180],id:"twaver.idc.rj4503.panel"},{client:{bid:"14"},position:[106,24,0],rotation:[0,0,180],id:"twaver.idc.rj4503.panel"},{client:{bid:"16"},position:[122,24,0],rotation:[0,0,180],id:"twaver.idc.rj4503.panel"},{client:{bid:"18"},position:[138,24,0],rotation:[0,0,180],id:"twaver.idc.rj4503.panel"},{client:{bid:"20"},position:[154,24,0],rotation:[0,0,180],id:"twaver.idc.rj4503.panel"},{client:{bid:"22"},position:[170,24,0],rotation:[0,0,180],id:"twaver.idc.rj4503.panel"},{client:{bid:"24"},position:[186,24,0],rotation:[0,0,180],id:"twaver.idc.rj4503.panel"},{client:{bid:"1"},position:[10,12,0],id:"twaver.idc.rj4503.panel"},{client:{bid:"3"},position:[26,12,0],id:"twaver.idc.rj4503.panel"},{client:{bid:"5"},position:[42,12,0],id:"twaver.idc.rj4503.panel"},{client:{bid:"7"},position:[58,12,0],id:"twaver.idc.rj4503.panel"},{client:{bid:"23"},position:[186,12,0],id:"twaver.idc.rj4503.panel"},{client:{bid:"25"},position:[210,12,0],id:"twaver.idc.rj4503.panel"},{client:{bid:"26"},position:[210,24,0],rotation:[0,0,180],id:"twaver.idc.rj4503.panel"},{client:{bid:"27"},position:[226,12,0],id:"twaver.idc.rj4503.panel"},{client:{bid:"28"},position:[226,24,0],rotation:[0,0,180],id:"twaver.idc.rj4503.panel"},{client:{bid:"29"},position:[242,12,0],id:"twaver.idc.rj4503.panel"},{client:{bid:"30"},position:[242,24,0],rotation:[0,0,180],id:"twaver.idc.rj4503.panel"},{client:{bid:"31"},position:[258,12,0],id:"twaver.idc.rj4503.panel"},{client:{bid:"32"},position:[258,24,0],rotation:[0,0,180],id:"twaver.idc.rj4503.panel"},{client:{bid:"33"},position:[274,12,0],id:"twaver.idc.rj4503.panel"},{client:{bid:"34"},position:[274,24,0],rotation:[0,0,180],id:"twaver.idc.rj4503.panel"},{client:{bid:"35"},position:[290,12,0],id:"twaver.idc.rj4503.panel"},{client:{bid:"36"},position:[290,24,0],rotation:[0,0,180],id:"twaver.idc.rj4503.panel"},{client:{bid:"37"},position:[306,12,0],id:"twaver.idc.rj4503.panel"},{client:{bid:"38"},position:[306,24,0],rotation:[0,0,180],id:"twaver.idc.rj4503.panel"},{client:{bid:"39"},position:[322,12,0],id:"twaver.idc.rj4503.panel"},{client:{bid:"40"},position:[322,24,0],rotation:[0,0,180],id:"twaver.idc.rj4503.panel"},{client:{bid:"41"},position:[338,12,0],id:"twaver.idc.rj4503.panel"},{client:{bid:"42"},position:[338,24,0],rotation:[0,0,180],id:"twaver.idc.rj4503.panel"},{client:{bid:"43"},position:[354,12,0],id:"twaver.idc.rj4503.panel"},{client:{bid:"44"},position:[354,24,0],rotation:[0,0,180],id:"twaver.idc.rj4503.panel"},{client:{bid:"45"},position:[370,12,0],id:"twaver.idc.rj4503.panel"},{client:{bid:"46"},position:[370,24,0],rotation:[0,0,180],id:"twaver.idc.rj4503.panel"},{client:{bid:"47"},position:[386,12,0],id:"twaver.idc.rj4503.panel"},{client:{bid:"48"},position:[386,24,0],rotation:[0,0,180],id:"twaver.idc.rj4503.panel"},{client:{bid:"49"},position:[416,25,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"50"},position:[435,25,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"}]},h3c_s1224:{height:1,description:"H3C S1224是H3C公司自主开发的全千兆无管理以太网交换产品，提供了24个10/100/1000M以太网端口，所有端口均支持全线速无阻塞交换以及MDI/MDIX自适应功能，外形采用13英寸铁壳设",data:[{id:"twaver.idc.h3c_s1224.panel"},{client:{bid:"1"},position:[29,12,0],id:"twaver.idc.rj4502.panel"},{client:{bid:"2"},position:[29,25,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"3"},position:[49,12,0],id:"twaver.idc.rj4502.panel"},{client:{bid:"4"},position:[49,25,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"5"},position:[69,12,0],id:"twaver.idc.rj4502.panel"},{client:{bid:"6"},position:[69,25,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"7"},position:[88,12,0],id:"twaver.idc.rj4502.panel"},{client:{bid:"8"},position:[88,25,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"9"},position:[125,12,0],id:"twaver.idc.rj4502.panel"},{client:{bid:"10"},position:[125,25,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"11"},position:[145,12,0],id:"twaver.idc.rj4502.panel"},{client:{bid:"12"},position:[145,25,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"13"},position:[165,12,0],id:"twaver.idc.rj4502.panel"},{client:{bid:"14"},position:[165,25,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"15"},position:[185,12,0],id:"twaver.idc.rj4502.panel"},{client:{bid:"16"},position:[185,25,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"17"},position:[222,12,0],id:"twaver.idc.rj4502.panel"},{client:{bid:"18"},position:[222,25,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"19"},position:[242,12,0],id:"twaver.idc.rj4502.panel"},{client:{bid:"20"},position:[242,25,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"21"},position:[262,12,0],id:"twaver.idc.rj4502.panel"},{client:{bid:"22"},position:[262,25,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"23"},position:[281,12,0],id:"twaver.idc.rj4502.panel"},{client:{bid:"24"},position:[281,25,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"}]},hw_s2700:{height:1,description:"S2700系列企业交换机(以下简称S2700)是华为公司推出的新一代绿色节能的以太智能百兆接入交换机",data:[{id:"twaver.idc.hw_s2700.panel"},{position:[33,14,0],id:"twaver.idc.jack3.panel"},{position:[67,14,0],id:"twaver.idc.switch_01.panel"},{client:{bid:"1"},position:[98,13,0],id:"twaver.idc.rj4502.panel"},{client:{bid:"2"},position:[98,26,10],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"3"},position:[113,13,10],id:"twaver.idc.rj4502.panel"},{client:{bid:"4"},position:[113,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"5"},position:[128,13,20],id:"twaver.idc.rj4502.panel"},{client:{bid:"6"},position:[128,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"7"},position:[143,13,30],id:"twaver.idc.rj4502.panel"},{client:{bid:"8"},position:[143,26,20],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"9"},position:[167,13,10],id:"twaver.idc.rj4502.panel"},{client:{bid:"10"},position:[167,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"11"},position:[182,13,20],id:"twaver.idc.rj4502.panel"},{client:{bid:"12"},position:[182,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"13"},position:[197,13,30],id:"twaver.idc.rj4502.panel"},{client:{bid:"14"},position:[197,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"15"},position:[212,13,40],id:"twaver.idc.rj4502.panel"},{client:{bid:"16"},position:[212,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"17"},position:[237,13,0],id:"twaver.idc.rj4502.panel"},{client:{bid:"18"},position:[237,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"19"},position:[252,13,0],id:"twaver.idc.rj4502.panel"},{client:{bid:"20"},position:[252,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"21"},position:[267,13,0],id:"twaver.idc.rj4502.panel"},{client:{bid:"22"},position:[267,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"23"},position:[282,13,0],id:"twaver.idc.rj4502.panel"},{client:{bid:"24"},position:[282,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"29"},position:[399,25,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"27"},position:[379,13,0],id:"twaver.idc.rj4503.panel"},{client:{bid:"28"},position:[379,26,0],rotation:[0,0,180],id:"twaver.idc.rj4503.panel"},{client:{bid:"26"},position:[358,26,0],id:"twaver.idc.port_01.panel"},{client:{bid:"25"},position:[340,26,0],id:"twaver.idc.port_01.panel"}]},hw_s3700:{height:1,description:"S3700系列企业交换机是华为公司推出的新一代绿色节能的三层以太交换机",data:[{id:"twaver.idc.hw_s3700.panel"},{position:[35,15,0],id:"twaver.idc.jack3.panel"},{position:[70,15,0],id:"twaver.idc.switch_01.panel"},{client:{bid:"1"},position:[98,13,0],id:"twaver.idc.rj4502.panel"},{client:{bid:"2"},position:[98,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"3"},position:[113,13,0],id:"twaver.idc.rj4502.panel"},{client:{bid:"4"},position:[113,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"5"},position:[128,13,0],id:"twaver.idc.rj4502.panel"},{client:{bid:"6"},position:[128,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"7"},position:[143,13,0],id:"twaver.idc.rj4502.panel"},{client:{bid:"8"},position:[143,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"9"},position:[168,13,0],id:"twaver.idc.rj4502.panel"},{client:{bid:"10"},position:[168,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"11"},position:[183,13,0],id:"twaver.idc.rj4502.panel"},{client:{bid:"12"},position:[183,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"13"},position:[198,13,0],id:"twaver.idc.rj4502.panel"},{client:{bid:"14"},position:[198,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"15"},position:[213,13,0],id:"twaver.idc.rj4502.panel"},{client:{bid:"16"},position:[213,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"17"},position:[237,13,0],id:"twaver.idc.rj4502.panel"},{client:{bid:"18"},position:[237,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"19"},position:[252,13,0],id:"twaver.idc.rj4502.panel"},{client:{bid:"20"},position:[252,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"21"},position:[267,13,0],id:"twaver.idc.rj4502.panel"},{client:{bid:"22"},position:[267,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"23"},position:[282,13,0],id:"twaver.idc.rj4502.panel"},{client:{bid:"24"},position:[282,26,0],rotation:[0,0,180],id:"twaver.idc.rj4502.panel"},{client:{bid:"30"},position:[379.3911044003451,25.61816220880069,0],rotation:[0,0,180],id:"twaver.idc.rj4503.panel"},{client:{bid:"31"},position:[399,25,0],id:"twaver.idc.rj4502.panel"},{client:{bid:"29"},position:[379,13,0],id:"twaver.idc.rj4503.panel"},{client:{bid:"28"},position:[358,26,0],id:"twaver.idc.port_01.panel"},{client:{bid:"27"},position:[341,26,0],id:"twaver.idc.port_01.panel"},{client:{bid:"26"},position:[321,26,0],id:"twaver.idc.port_01.panel"},{client:{bid:"25"},position:[304,26,0],id:"twaver.idc.port_01.panel"}]},cisco_3800:{height:3,description:"Cisco 3800(路由器)系列让客户可以在使用并发数据、安全、话音和高级服务时获得最高的性能、可用性、密度和最大限度的增长空间"},h3c_s5120_series:{height:1,description:"交换机"},h3c_sr8808:{height:7,description:"H3C SR8808 路由器类型:核心业务路由器，集成了防火墙、安全网关、网络流量分析等功能"}},c.Default.Block=function(){c.Default.Block.superClass.constructor.apply(this,arguments),this.setClient("length",90),this.setClient("edgeIndex",-1),this.setClient("offset",.5),this.setClient("gap",0),this.setClient("angle",0),this.setClient("focus",!1),this.setStyle("vector.outline.width",2),this.setStyle("vector.outline.color","gray"),this.setStyle("vector.fill.color","white"),this.setSize(0,0),this.setClient("fullWidth",!1),this.setClient("horizontalFlip",!1),this.setImage("image_block"),this.setClient("height",this.blockHeight),this.setClient("positionY",this.positionY),c.Default.objectWrapper(this,"id",function(){return this.getClient("id")}),c.Default.objectWrapper(this,"objectId",function(){return this.getId()})},twaver.Util.ext("make.Default.Block",twaver.Node,{onPropertyChanged:function(a){c.Default.Block.superClass.onPropertyChanged.call(this,a),
!this.getParent()||"C:length"!==a.property&&"C:edgeIndex"!==a.property&&"C:offset"!==a.property&&"C:gap"!==a.property||this.refresh()},refresh:function(){var a=this.getParent(),b=this.getClient("edgeIndex"),c=this.getClient("offset"),d=a.getPoints();if(d&&b>=0&&b<d.size()){var e=d.get(b),f=d.get(b===d.size()-1?0:b+1),g=f.x-e.x,h=f.y-e.y,i={x:e.x+g*c,y:e.y+h*c},j=this.getAngle(g,h),k=this.getStyle("vector.outline.width"),l=this.getClient("gap"),m=this.getClient("length")/2+k/2,n=a.getStyle("vector.outline.width")/2+k/2+l,o=twaver.Util.getRect([twaver.Util.transformPoint(i,j,-m,-n).point,twaver.Util.transformPoint(i,j,m,-n).point,twaver.Util.transformPoint(i,j,m,n).point,twaver.Util.transformPoint(i,j,-m,n).point]);this.setSize(o.width,o.height),this.setCenterLocation(i),this.setClient("angle",j),this.setClient("leftPoint",twaver.Util.transformPoint(i,j,-m,0).point),this.setClient("rightPoint",twaver.Util.transformPoint(i,j,m,0).point)}},getAngle:function(a,b){return 0===a?0===b?0:b>0?Math.PI/2:-Math.PI/2:Math.atan(b/a)},getEdgeIndex:function(){return this.getClient("edgeIndex")},isDoor:function(){return this instanceof c.Default.Door},isWindow:function(){return this instanceof c.Default.Window},isCutoff:function(){return this instanceof c.Default.Cutoff},getBlockWidth:function(){return Math.abs(this.getClient("length"))},getBlockHeight:function(){return Math.abs(this.getClient("height"))},getBlockDepth:function(){return Math.abs(this.getClient("depth"))},getBlockPicture:function(){return this.getClient("picture")},getBlockPositionY:function(){return Math.abs(this.getClient("positionY"))}}),c.Default.Door=function(){c.Default.Door.superClass.constructor.apply(this,arguments),this.setClient("positionY",0),this.setClient("length",205)},twaver.Util.ext("make.Default.Door",c.Default.Block,{}),c.Default.Window=function(){c.Default.Window.superClass.constructor.apply(this,arguments),this.setClient("positionY",100),this.setClient("length",120)},twaver.Util.ext("make.Default.Window",c.Default.Block,{}),c.Default.Cutoff=function(){c.Default.Cutoff.superClass.constructor.apply(this,arguments),this.setClient("positionY",100)},twaver.Util.ext("make.Default.Cutoff",c.Default.Block,{}),twaver.Util.registerImage("image_block",{rotate:'<%=getClient("angle")*180/Math.PI%>',diameter:function(a,b){var c=10,d=a.getParent();return d&&(c=d.getStyle("vector.outline.width")+2*a.getClient("gap")),c},v:[{shape:"rect",rect:function(a,b){var c=a.getClient("length");c&&(c=Math.abs(c));var d=a.getParent(),e=10;d&&(e=d.getStyle("vector.outline.width")+2*a.getClient("gap"));var f=this.diameter(a,b);return c>f&&(c-=f),e=e,[-c/2,-e/2,c,e]},lineWidth:'<%=getStyle("vector.outline.width")%>',lineColor:'<%if(getClient("focus")){return "green"}else{return getStyle("vector.outline.color")}%>',fill:'<%=getStyle("vector.fill.color")%>'},{shape:"line",x1:function(a,b){if(a instanceof c.Default.Window||a instanceof c.Default.Door){var d=a.getClient("length");d&&(d=Math.abs(d));var e=this.diameter(a,b);return d>e&&(d-=e),-d/2}return 0},y1:0,x2:function(a,b){if(a instanceof c.Default.Window||a instanceof c.Default.Door){var d=a.getClient("length");d&&(d=Math.abs(d));var e=this.diameter(a,b);return d>e&&(d-=e),d/2}return 0},y2:0,lineWidth:'<%=getStyle("vector.outline.width")%>',lineColor:'<%if(getClient("focus")){return "green"}else{return getStyle("vector.outline.color")}%>',lineDash:function(a){return a instanceof c.Default.Door?[10,2]:void 0}},{shape:"circle",cx:function(a,b){var c=a.getClient("length");c&&(c=Math.abs(c));var d=this.diameter(a,b);return c>d&&(c-=d),-c/2},cy:0,r:function(a,b){if(null==b||!b.getSelectionModel().contains(a))return 0;var c=a.getParent(),d=10;return c&&(d=c.getStyle("vector.outline.width")+2*a.getClient("gap")),d=d,d/2},lineWidth:1,fill:"yellow",stroke:"black"},{shape:"circle",cx:function(a,b){var c=a.getClient("length");c&&(c=Math.abs(c));var d=this.diameter(a,b);return c>d&&(c-=d),c/2},cy:0,r:function(a,b){if(null==b||!b.getSelectionModel().contains(a))return 0;var c=a.getParent(),d=10;return c&&(d=c.getStyle("vector.outline.width")+2*a.getClient("gap")),d=d,d/2},lineWidth:1,fill:"yellow",stroke:"black"}]});var j=function(a){return a.indexOf("/")>0?a:c.Default.path+"model/idc/images/"+a};c.Default.ImageShapeNode=function(){c.Default.ImageShapeNode.superClass.constructor.apply(this,arguments),this.setClient("showFloor",!0),this.setClient("closed",!0),this.setClient("focusColor","green"),this.setClient("resizeBorderWidth",10),this.setClient("resizeBorderLength",18),this.setClient("resizeBorderGap",10),this.setClient("resizeBorderColor","yellow"),this.setClient("size",{x:0,y:300,z:10}),this.setClient("fill",!0),this.setClient("imageSrc","floor.png"),this.setStyle("vector.outline.color","#333333"),this.setStyle("vector.outline.width",10),this.setStyle("vector.fill.color","rgba(184,211,240,0.5)"),this.setStyle("select.style","none"),this.setClient("repeat",1e3),this.setClient("dimLeadLength",35),this.setClient("dimLineOffset",.7),this.setClient("dimLineWidth",1),this.setClient("dimColor","#F07819"),this.setClient("dimTextGap",5),this.setClient("dimTextFont","12px Arial"),this.setClient("dimArrowWidth",8),this.setClient("dimArrowHeight",3),this.setClient("coordTextColor","white"),this.setClient("coordTextFont","12px Arial"),this.setClient("coordTextOffsetX",0),this.setClient("coordTextOffsetY",20),this.setClient("coordTextAlign","center"),this.setClient("coordTextBaseline","middle"),this.setClient("coordTextBackground","rgba(240,120,25,0.7)"),this.setClient("decimalNumber",0)},twaver.Util.ext("make.Default.ImageShapeNode",twaver.ShapeNode,{getCanvasUIClass:function(){return c.Default.ImageShapeNodeUI},getElementUIClass:function(){return c.Default.ImageShapeNodeUI},getVectorUIClass:function(){return c.Default.ImageShapeNodeUI},onChildRemoved:function(a,b){this.refreshChilden()},onChildAdded:function(a,b){this.refreshChilden()},onPropertyChanged:function(a){c.Default.ImageShapeNode.superClass.onPropertyChanged.call(this,a),"points"===a.property&&this.refreshChilden()},checkBlockOnEdge:function(a){var b=!1;return this.getChildren().forEach(function(c){c.getClient("edgeIndex")===a&&(b=!0)}),b},refreshChilden:function(){this.getChildren().forEach(function(a){a.refresh&&a.refresh()})},isPointOnPoints:function(a){for(var b=this.getPoints(),c=0;c<b.size();c++)if(_twaver.math.getDistance(a,b.get(c))<=10)return!0;return!1},getPointIndex:function(a){var b=this.getPoints();if(b.size()<2)return-1;for(var c=0;c<b.size();c++)if(_twaver.math.getDistance(a,b.get(c))<=10)return-1;for(var d,e=b.get(0),c=1;c<b.size();c++){if(d=b.get(c),this.isPointOnLine(a,e,d,10))return c-1;e=d}return e=b.get(0),this.isPointOnLine(a,e,d,10)?b.size()-1:-1},isPointOnLine:function(a,b,c,d){0>d&&(d=0);var e=this.getDistanceFromPointToLine(a,b,c);return d>=e&&a.x>=Math.min(b.x,c.x)-d&&a.x<=Math.max(b.x,c.x)+d&&a.y>=Math.min(b.y,c.y)-d&&a.y<=Math.max(b.y,c.y)+d},getDistanceFromPointToLine:function(a,b,c){if(b.x===c.x)return Math.abs(a.x-b.x);var d=(c.y-b.y)/(c.x-b.x),e=(c.x*b.y-b.x*c.y)/(c.x-b.x);return Math.abs(d*a.x-a.y+e)/Math.sqrt(d*d+1)},setOffsetYofPoints:function(a){this.offsetY=a},setOffsetXofPoints:function(a){this.offsetX=a},getOffsetYofPoints:function(){return this.offsetY||0},getOffsetXofPoints:function(){return this.offsetX||0},setNegatedYInterval:function(a){this.negatedYInterval=a},getNegatedYInterval:function(){return this.negatedYInterval}}),c.Default.ImageShapeNodeUI=function(a,b){c.Default.ImageShapeNodeUI.superClass.constructor.apply(this,arguments)},twaver.Util.ext("make.Default.ImageShapeNodeUI",twaver.vector.ShapeNodeUI,{drawDefaultBody:function(a){var b=this._element;if(b._points&&!(b._points.size()<1)){var c=this._getZoomPoints(),d=b._segments,e=b.getStyle("vector.outline.width"),f=b.getStyle("vector.outline.pattern"),g=b.getStyle("vector.outline.width"),h=b.getStyle("vector.outline.color"),i=b.getClient("closed"),k=twaver.Util.getRect(c),l=a;e>0&&twaver.Util.grow(k,e,e);var m,n=this._network.isSelected(this._element),o=this._element.getClient("resizeBorderWidth"),p=this._element.getClient("resizeBorderLength"),q=this._element.getClient("resizeBorderGap"),r=this._element.getClient("resizeBorderColor");n&&(m=_twaver.clone(k)),l=this.setShadow(this,l),l.beginPath();var s=j(b.getClient("imageSrc"));if(s){var t=twaver.Util.getImageAsset(s);t?l.fillStyle=l.createPattern(t.getImage(),"repeat"):twaver.Util.registerImageByUrl(s,s,null,function(){b.setClient("imageSrc-trigger",1)})}l.lineWidth=g,l.strokeStyle=h,_twaver.g.drawLinePoints(l,c,f,d,i),b.getClient("fill")&&l.fill(),l.stroke();var u=b.getClient("focusIndex");if(u>=0){var v=c.get(u),w=c.get(u===c.size()-1?0:u+1);l.beginPath(),l.strokeStyle=b.getClient("focusColor"),l.moveTo(v.x,v.y),l.lineTo(w.x,w.y),l.stroke()}if(n){l.lineWidth=o+2,l.strokeStyle="black",l.beginPath(),this._borderLines=[];var x,y,z;x={x:m.x-q,y:m.y-q},y={x:x.x,y:x.y+p},z={x:x.x+p,y:x.y},this._addBorderLine(l,x,y,z),x={x:m.x+m.width+q,y:m.y-q},y={x:x.x-p,y:x.y},z={x:x.x,y:x.y+p},this._addBorderLine(l,x,y,z),x={x:m.x+m.width+q,y:m.y+m.height+q},y={x:x.x,y:x.y-p},z={x:x.x-p,y:x.y},this._addBorderLine(l,x,y,z),x={x:m.x-q,y:m.y+m.height+q},y={x:x.x+p,y:x.y},z={x:x.x,y:x.y-p},this._addBorderLine(l,x,y,z),l.stroke(),l.beginPath(),l.lineWidth=o,l.strokeStyle=r,p-=1,x={x:m.x-q,y:m.y-q},y={x:x.x,y:x.y+p},z={x:x.x+p,y:x.y},l.moveTo(y.x,y.y),l.lineTo(x.x,x.y),l.lineTo(z.x,z.y),x={x:m.x+m.width+q,y:m.y-q},y={x:x.x-p,y:x.y},z={x:x.x,y:x.y+p},l.moveTo(y.x,y.y),l.lineTo(x.x,x.y),l.lineTo(z.x,z.y),x={x:m.x+m.width+q,y:m.y+m.height+q},y={x:x.x,y:x.y-p},z={x:x.x-p,y:x.y},l.moveTo(y.x,y.y),l.lineTo(x.x,x.y),l.lineTo(z.x,z.y),x={x:m.x-q,y:m.y+m.height+q},y={x:x.x+p,y:x.y},z={x:x.x,y:x.y-p},l.moveTo(y.x,y.y),l.lineTo(x.x,x.y),l.lineTo(z.x,z.y),l.stroke()}n&&(this.drawCoord(l),this.drawDim(l))}},validateBodyBounds:function(){c.Default.ImageShapeNodeUI.superClass.validateBodyBounds.call(this);var a=this._element;if(a._points&&!(a._points.size()<1)){var b=this._getZoomPoints();if(!(b.size()<2)){var d=a.getStyle("vector.outline.width"),e=this.getPathRect("vector",!0);d>0&&twaver.Util.grow(e,d,d);var f=this._network.isSelected(this._element),g=this._element.getClient("resizeBorderWidth"),h=this._element.getClient("resizeBorderGap");f&&twaver.Util.grow(e,(g+h)/this._network.getZoom()*2+2,(g+h)/this._network.getZoom()*2+2),this.addBodyBounds(e)}}},_addBorderLine:function(a,b,c,d){this._borderLines.push({point1:c,point2:b}),this._borderLines.push({point1:b,point2:d}),a.moveTo(c.x,c.y),a.lineTo(b.x,b.y),a.lineTo(d.x,d.y)},isPointOnBorderLine:function(a){if(!this._borderLines)return null;for(var b=this._element.getClient("resizeBorderWidth"),c=0;c<this._borderLines.length;c++){var d=this._borderLines[c];if(this._element.isPointOnLine(a,d.point1,d.point2,b))return Math.floor(c/2)}return null},drawDim:function(a){function b(a,b,e){if(0!=e){var f=_twaver.math.getCenterPoint(a,b),g=angle1=_twaver.math.getAngle(a,b);b.x<a.x&&(g=Math.PI+g);var h=e.toFixed(2),k=d.measureText(h).width,l=_twaver.math.createMatrix(g,a.x,a.y),n=l.transform({x:a.x,y:a.y-i}),q=l.transform({x:a.x,y:a.y-i*j});l=_twaver.math.createMatrix(g,b.x,b.y);var r=l.transform({x:b.x,y:b.y-i}),s=l.transform({x:b.x,y:b.y-i*j}),t=c.getPointBetween(q,s,.5-(k/2+m)/e),u=c.getPointBetween(q,s,.5+(k/2+m)/e),v=c.getPointBetween(q,s,o/e);l=_twaver.math.createMatrix(g,v.x,v.y);var w=l.transform({x:v.x,y:v.y-p}),x=l.transform({x:v.x,y:v.y+p}),y=c.getPointBetween(q,s,1-o/e);l=_twaver.math.createMatrix(g,y.x,y.y);var z=l.transform({x:y.x,y:y.y-p}),A=l.transform({x:y.x,y:y.y+p});d.beginPath(),d.moveTo(a.x,a.y),d.lineTo(n.x,n.y),d.moveTo(b.x,b.y),d.lineTo(r.x,r.y),d.moveTo(q.x,q.y),d.lineTo(t.x,t.y),d.moveTo(u.x,u.y),d.lineTo(s.x,s.y),d.moveTo(q.x,q.y),d.lineTo(w.x,w.y),d.moveTo(q.x,q.y),d.lineTo(x.x,x.y),d.moveTo(s.x,s.y),d.lineTo(z.x,z.y),d.moveTo(s.x,s.y),d.lineTo(A.x,A.y),d.stroke(),d.save(),f={x:(q.x+s.x)/2,y:(q.y+s.y)/2},d.translate(f.x,f.y),d.rotate(angle1),d.translate(-f.x,-f.y),d.fillText(h,f.x,f.y),d.restore()}}var c=this,d=a,e=this._element,f=this._getZoomPoints(),g=e.getPoints();if(f&&!(f.size()<2)&&this._network.isSelected(e)){var h=this.getBodyRect(),i=e.getClient("dimLeadLength"),j=e.getClient("dimLineOffset"),k=e.getClient("dimLineWidth"),l=e.getClient("dimColor"),m=e.getClient("dimTextGap"),n=e.getClient("dimTextFont"),o=e.getClient("dimArrowWidth"),p=e.getClient("dimArrowHeight"),q={x:h.x-i,y:h.y-i,width:h.width+2*i,height:h.height+2*i};this.isClockwise()&&(i=-i),this.addBodyBounds(q),d=this.setShadow(this,d),d.strokeStyle=l,d.lineWidth=k,d.fillStyle=l,d.font=n,d.textAlign="center",d.textBaseline="middle";for(var r=f.get(0),s=g.get(0),t=1,u=f.size();u>t;t++){var v=f.get(t),w=g.get(t),x=_twaver.math.getDistance(s,w);s=w,b(r,v,x),r=v}if(u>2){var x=_twaver.math.getDistance(s,g.get(0));b(r,f.get(0),x)}}},getPointBetween:function(a,b,c){return{x:a.x+(b.x-a.x)*c,y:a.y+(b.y-a.y)*c}},isClockwise:function(a){var b=this._element,a=b.getPoints();if(!a||a.size()<2)return!0;for(var c=0,d=a.size(),e=0;d>e;e++){var f=a.get(e),g=a.get(e+1===d?0:e+1);c+=(g.x-f.x)*(g.y+f.y)}return c>0},drawCoord:function(a){var b=a,c=this._element,d=this._getZoomPoints(),e=c.getPoints();if(d&&e){var f=this.getBodyRect(),g=c.getClient("coordTextColor"),h=c.getClient("coordTextFont"),i=c.getClient("coordTextOffsetX"),j=c.getClient("coordTextOffsetY"),k=c.getClient("coordTextAlign"),l=c.getClient("coordTextBaseline"),m=c.getClient("coordTextBackground"),n=c.getClient("decimalNumber"),o={x:f.x-100,y:f.y-50,width:f.width+200,height:f.height+100};this.addBodyBounds(o),b=this.setShadow(this,b),b.save(),b.font=h;for(var p=0,q=d.size();q>p;p++){var r=d.get(p),s=e.get(p),t="("+(r.x+c.getOffsetXofPoints()).toFixed(n)+", "+(r.y*(c.getNegatedYInterval()?-1:1)+c.getOffsetYofPoints()).toFixed(n)+")";s&&(t="("+(s.x+c.getOffsetXofPoints()).toFixed(n)+", "+(s.y*(c.getNegatedYInterval()?-1:1)+c.getOffsetYofPoints()).toFixed(n)+")");var u=_twaver.g.getTextSize(b.font,t);b.fillStyle=m,b.fillRect(r.x-u.width/2+i,r.y-u.height/2+j,u.width,u.height),b.fillStyle=g,b.textAlign=k,b.textBaseline=l,b.fillText(t,r.x,r.y+j)}b.restore()}}}),c.Default.WallShapeNode=function(){c.Default.WallShapeNode.superClass.constructor.apply(this,arguments)},twaver.Util.ext(c.Default.WallShapeNode,c.Default.ImageShapeNode,{}),c.Default.InnerWallShapeNode=function(){c.Default.InnerWallShapeNode.superClass.constructor.apply(this,arguments),this.setClient("imageSrc","room.png"),this.setStyle("vector.outline.color","#333333"),this.setStyle("vector.outline.width",5),this.setClient("closed",!1),this.setClient("showFloor",!1),this.setClient("focusColor","green"),this.setClient("resizeBorderWidth",10),this.setClient("resizeBorderLength",25),this.setClient("resizeBorderGap",10),this.setClient("resizeBorderColor","yellow"),this.setClient("size",{x:0,y:230,z:4}),this.setClient("repeat",{row:1,column:1})},twaver.Util.ext(c.Default.InnerWallShapeNode,c.Default.WallShapeNode,{}),c.Default.FloorShapeNode=function(){c.Default.FloorShapeNode.superClass.constructor.apply(this,arguments),this.setClient("imageSrc","floor.png"),this.setStyle("vector.outline.color","#FFFFFF"),this.setStyle("vector.outline.width",0),this.setClient("closed",!0),this.setClient("focusColor","blue"),this.setClient("repeat",100),this.setClient("size",{x:0,y:0,z:.1})},twaver.Util.ext("make.Default.FloorShapeNode",c.Default.ImageShapeNode,{}),c.Default.LineWidthShapeNode=function(){c.Default.LineWidthShapeNode.superClass.constructor.apply(this,arguments),this.setStyle("vector.outline.color","#B45F04"),this.setStyle("vector.outline.width",5),this.setStyle("vector.fill.color","rgba(184,211,240,0)"),this.setClient("closed",!1),this.setClient("size",{x:0,y:0,z:.1}),this.setClient("transparent",!1),this.setClient("opacity",1),this.setClient("fill",!1)},twaver.Util.ext(c.Default.LineWidthShapeNode,c.Default.ImageShapeNode,{});var k=function(a){return a.indexOf("/")>0?a:c.Default.path+"model/idc/icons/"+a},l=function(a){return a.indexOf("/")>0?a:c.Default.path+"model/idc/images/"+a},m=function(a){return a.indexOf("/")>0?a:a.length>4&&a.lastIndexOf(".svg")==a.length-4?c.Default.path+"model/idc/svg/"+a:c.Default.path+"model/idc/svg/"+a+".svg"},n={wall:100,innerWall:200,wallChild:300,innerWallChild:400,area:500,channel:600,rack:700,"default":800},o=function(a,b,c,d,e,f,g,h,i){return{name:a||"外墙",description:b||"外墙说明",icon:k(c||"column.png"),category:d||"默认模型",categoryNumber:e||10,order:f||10,type:h||"twaver.Node",layer:i||n["default"],modelDefaultParameters:g||{}}},p=function(a,d){a=a||{};var e={bid:{name:"业务ID",value:b,type:c.Default.PARAMETER_TYPE_STRING,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_CLIENT},width:{name:"宽度",value:a.width,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_ACCESSOR},height:{name:"厚度",value:a.depth,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_ACCESSOR,hidden:!1},x:{name:"X轴位置",value:0,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_ACCESSOR,exportable:!1},y:{name:"Z轴位置",value:0,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_ACCESSOR,exportable:!1},angle:{name:"Y轴旋转",value:0,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_ACCESSOR,exportable:!1}};return d===!1&&(e.width.editable=!1,e.height.editable=!1),e},q=function(a){return a=a||{},{bid:{name:"业务ID",value:b,type:c.Default.PARAMETER_TYPE_STRING,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_CLIENT},width:{name:"宽度",value:a.width,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_ACCESSOR},height:{name:"厚度",value:a.depth,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_ACCESSOR,hidden:!1},x:{name:"X轴位置",value:0,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_ACCESSOR,exportable:!1},y:{name:"Z轴位置",value:0,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_ACCESSOR,exportable:!1},position:{name:"位置",value:[0,0,0],type:c.Default.PARAMETER_TYPE_ARRAY_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD,hidden:!0},angle:{name:"Y轴旋转",value:0,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_ACCESSOR,exportable:!1}}},r=function(a){return a=a||{},{bid:{name:"业务ID",value:b,type:c.Default.PARAMETER_TYPE_STRING,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_CLIENT},x:{name:"X轴位置",value:0,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_ACCESSOR,exportable:!1},y:{name:"Z轴位置",value:0,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_ACCESSOR,exportable:!1},position:{name:"位置",value:[0,0,0],type:c.Default.PARAMETER_TYPE_ARRAY_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD,hidden:!0},angle:{name:"Y轴旋转",value:0,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_ACCESSOR,exportable:!1},color:{name:"颜色",value:"#B45F04",type:c.Default.PARAMETER_TYPE_COLOR,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD,hidden:!0},"vector.outline.color":{name:"颜色",value:"#B45F04",type:c.Default.PARAMETER_TYPE_COLOR,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_STYLE,exportable:!1}}},s=function(a){return a=a||{},{bid:{name:"业务ID",value:b,type:c.Default.PARAMETER_TYPE_STRING,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_CLIENT},x:{name:"X轴位置",value:0,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_ACCESSOR,exportable:!1},y:{name:"Z轴位置",value:0,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_ACCESSOR,exportable:!1},position:{name:"位置",value:[0,200,0],type:c.Default.PARAMETER_TYPE_ARRAY_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD,hidden:!0},positionY:{name:"离地高度",value:200,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_CLIENT,exportable:!1},angle:{name:"Y轴旋转",value:0,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_ACCESSOR,exportable:!1}}};c.Default.register("twaver.idc.wall.top",function(a){var b={objType:"wall",client:{data:a.data,type:"wall"}};c.Default.copyProperties(a,b);var d=c.Default.create2dShapeNode(b),e=a.children;return e&&e.forEach(function(a){var b=c.Default.load(a);b.setParent(d)}),d},o("外墙","外墙说明","wall.png","2d房间模型",10,10,{bid:{name:"业务ID",value:b,type:c.Default.PARAMETER_TYPE_STRING,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_CLIENT}},"wall",n.wall)),c.Default.register("twaver.idc.wall1.top",function(a){var b={id:"twaver.idc.wall.top",data:[[-2e3,-2e3],[2e3,-2e3],[2e3,2e3],[-2e3,2e3]]};return c.Default.copyProperties(a,b),c.Default.load(b)},o("外墙1","外墙说明","wall1.png","2d房间模型",10,20,{bid:{name:"业务ID",value:b,type:c.Default.PARAMETER_TYPE_STRING,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_CLIENT}},"wall1",n.wall)),c.Default.register("twaver.idc.wall2.top",function(a){var b={id:"twaver.idc.wall.top"},d={data:[[-2500,-2500],[0,-2500],[0,0],[2500,0],[2500,2500],[-2500,2500]]};return c.Default.copyProperties(a,b),c.Default.copyProperties(d,b),c.Default.load(b)},o("外墙2","外墙说明","wall2.png","2d房间模型",10,20,{bid:{name:"业务ID",value:b,type:c.Default.PARAMETER_TYPE_STRING,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_CLIENT}},"wall2",n.wall)),c.Default.register("twaver.idc.wall3.top",function(a){var b={id:"twaver.idc.wall.top"},d={data:[[-2500,-500],[-1300,-500],[-1300,-2500],[1300,-2500],[1300,-500],[2500,-500],[2500,2500],[-2500,2500]]};return c.Default.copyProperties(a,b),c.Default.copyProperties(d,b),c.Default.load(b)},o("外墙3","外墙说明","wall3.png","2d房间模型",10,20,{bid:{name:"业务ID",value:b,type:c.Default.PARAMETER_TYPE_STRING,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_CLIENT}},"wall3",n.wall)),c.Default.register("twaver.idc.wall4.top",function(a){var b={id:"twaver.idc.wall.top"},d={data:[[-2500,-500],[-1500,-500],[-1e3,-2500],[1e3,-2500],[1500,-500],[2500,-500],[2500,2500],[-2500,2500]]};return c.Default.copyProperties(a,b),c.Default.copyProperties(d,b),c.Default.load(b)},o("外墙4","外墙说明","wall4.png","2d房间模型",10,20,{bid:{name:"业务ID",value:b,type:c.Default.PARAMETER_TYPE_STRING,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_CLIENT}},"wall4",n.wall)),c.Default.register("twaver.idc.innerWall.top",function(a){var b={objType:"innerWall",client:{data:a.data,type:"innerWall"}};c.Default.copyProperties(a,b);var d=c.Default.create2dShapeNode(b),e=a.children;return e&&e.forEach(function(a){var b=c.Default.load(a);b.setParent(d)}),d},o("内墙","内墙说明","innerWall.png","2d房间模型",10,20,{},"innerWall",n.innerWall)),c.Default.copy("twaver.idc.glassWall.top","twaver.idc.innerWall.top",{},{name:"玻璃内墙1",icon:k("glasswall.png")}),c.Default.copy("twaver.idc.glassWall2.top","twaver.idc.innerWall.top",{},{name:"玻璃内墙2",icon:k("glasswall2.png")}),c.Default.register("twaver.idc.floor.top",function(a){var b={objType:"floor",client:{data:a.data,type:"floor"}};c.Default.copyProperties(a,b);var d=c.Default.create2dShapeNode(b);return d},o("楼层","楼层说明","floor.png","2d房间模型",10,20,{},"floor",n.wallChild));var t=function(){var a={bid:{name:"业务ID",value:b,type:c.Default.PARAMETER_TYPE_STRING,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_CLIENT},width:{name:"宽度",type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_ACCESSOR,editable:!1},height:{name:"厚度",type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_ACCESSOR,editable:!1},label:{name:"标签",type:c.Default.PARAMETER_TYPE_STRING,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_CLIENT},"label.xoffset":{name:"标签位置X",type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_STYLE},"label.yoffset":{name:"标签位置Z",type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_STYLE},"label.color":{name:"标签颜色",value:"red",type:c.Default.PARAMETER_TYPE_STRING,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_STYLE},"label.font":{name:"标签字体",value:"bold 360px 微软雅黑,sans-serif",type:c.Default.PARAMETER_TYPE_STRING,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_STYLE},opacity:{name:"透明度",value:.05,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_CLIENT}};return a};c.Default.register("twaver.idc.area.top",function(a){var b={objType:"floor",client:{data:a.data,type:"area"},style:{"shapenode.closed":!0,"vector.outline.color":"#B45F04","vector.outline.width":4,"label.position":"center"}};c.Default.copyProperties(a,b),b.data=b.data||[],b.position=b.position||[0,0,0];var d=new twaver.ShapeNode(a.objectId),e=a.children;e&&e.forEach(function(a){var b=c.Default.load(a);b.setParent(d)});var f=c.Default.create2dShapePath(b.data,b.position);return d.setSegments(f.segments),d.setPoints(f.points),c.Default.setObject2dCSProps(d,b),d},o("机房","机房说明","area.png","2d房间模型",10,10,t(),"area",n.area)),c.Default.register("twaver.idc.door.top",function(a){var b={client:{type:"door",bid:a.bid}};c.Default.copyProperties(a,b);var d=c.Default.createBlockObject(b,"door");return d},o("门","门说明","door.png","2d房间模型",10,30,{bid:{name:"业务ID",value:b,type:c.Default.PARAMETER_TYPE_STRING,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_CLIENT}},"door",n.wallChild)),c.Default.copy("twaver.idc.door1.top","twaver.idc.door.top",{},{icon:k("door1.png")}),c.Default.register("twaver.idc.window.top",function(a){var b={client:{type:"window",bid:a.bid}};c.Default.copyProperties(a,b);var d=c.Default.createBlockObject(b,"window");return d},o("窗户","窗户说明","window.png","2d房间模型",10,40,{bid:{name:"业务ID",value:b,type:c.Default.PARAMETER_TYPE_STRING,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_CLIENT}},"window",n.wallChild)),c.Default.register("twaver.idc.column.top",function(a){var b={client:{type:"column",bid:a.bid},style:{"vector.fill.color":"#BDBCBC"}};c.Default.copyProperties(a,b);var d=c.Default.createNode(b);return d},o("柱子","柱子说明","column.png","2d房间模型",10,40,{},"column",n.wallChild)),c.Default.register("twaver.idc.rack.top",function(a){a.client=a.client||{};var b={image:a.image||m("racktop"),width:a.width,depth:a.depth,client:{type:a.client.type||"rack"}};c.Default.copyProperties(a,b);var d=c.Default.createNode(b);return d},o("42U机柜","机柜说明","rack.png","2d机柜模型",20,60,q({width:60,depth:80,height:c.Default.getRackHeight(47)}),"rack",n.rack));for(var u=function(a){c.Default.register("twaver.idc.rack"+a+".top",function(a){return a.id="twaver.idc.rack.top",c.Default.load(a)},o(a+"U机柜","机柜说明","rack.png","2d机柜模型",20,10+10*(a-42),q({width:60,depth:80,height:c.Default.getRackHeight(a)}),"rack",n.rack))},v=42;47>=v;v++)u(v);c.Default.register("twaver.idc.headerRack.top",function(a){return a.id="twaver.idc.rack.top",a.image=a.image||m("headerracktop"),a.client=a.client||{},a.client.type="header_rack",c.Default.load(a)},o("列头柜","列头柜说明","headerRack.png","2d机柜模型",20,30,p({width:60,depth:80,height:200}),"header_rack",n.rack));var w=function(){return{bid:{name:"BID",type:c.Default.PARAMETER_TYPE_STRING,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_CLIENT},x:{name:"X轴位置",type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_ACCESSOR,exportable:!1},y:{name:"Z轴位置",type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_ACCESSOR,exportable:!1},angle:{name:"Y轴旋转",value:0,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_ACCESSOR,exportable:!1},rackWidth:{name:"机柜宽度",value:60,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},rackDepth:{name:"机柜深度",value:80,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},rackHeight:{name:"机柜高度",value:220,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},rackNumber:{name:"机柜数量",value:20,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},aisleDepth:{name:"通道深度",value:140,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},isSingle:{name:"是否为单通道",value:!1,type:c.Default.PARAMETER_TYPE_BOOLEAN,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},side:{name:"单通道类型",value:"right",type:c.Default.PARAMETER_TYPE_STRING,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},showRack:{name:"显示机柜",value:!0,type:c.Default.PARAMETER_TYPE_BOOLEAN,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_CLIENT}}},x=function(a,b){if(a.getClient("showRack")){var c=a.getClient(b);if(c)return c}return""},y=function(){var a={font:"20px arial",origin:{x:0,y:0},clip:!0,v:[{shape:"draw",draw:function(a,b,c){var d=b.rackNumber,e=!!b.isSingle,f=b.rackWidth,g=b.rackDepth,h=b.aisleDepth,i=b.side||"right",j=e?d:d/2,k=f*j,l=h+g*(e?1:2),m=f-4,n=b.getClient("channel.color")||"#61B6ef",o=(b.getClient("channel.label.font")||"24px arial",b.getClient("channel.location.font")||"20px arial"),p=b.getClient("channel.rackText.font")||"10px arial",q=(b.getClient("channel.label.color")||"#61B6ef",b.getClient("channel.location.color")||"#61B6ef"),r=b.getClient("channel.rackText.color")||"#61B6ef",s=2,t=Math.floor((s-1)/2),u=20,v=-10;if(a.drawShape({shape:"rect",rect:[0,0,k,l],fill:"#f5f5f5",lineWidth:3,lineColor:n}),e)if("right"==i){for(var w=0;j>w;w++){var y=w*f,z=0;a.drawShape({shape:"rect",rect:[y,z,f,g],lineWidth:1}),a.drawShape({shape:"text",text:x(b,"1-"+(w+1)),textAlign:"center",textBaseline:"center",font:p,fill:r,w:m,x:y+f/2,y:z+g/2+(w%s-t)*u+v}),a.drawShape({shape:"text",text:"1-"+(w+1),textAlign:"center",textBaseline:"center",font:o,fill:q,x:y+f/2,y:z+g+14})}a.drawShape({shape:"rect",rect:[0,g,k,h],lineWidth:1})}else for(a.drawShape({shape:"rect",rect:[0,0,k,h],lineWidth:1}),w=0;j>w;w++){var y=w*f,z=h;a.drawShape({shape:"rect",rect:[y,z,f,g],lineWidth:1}),a.drawShape({shape:"text",text:x(b,"1-"+(w+1)),textAlign:"center",textBaseline:"center",font:p,fill:r,w:m,x:y+f/2,y:z+g/2+(w%s-t)*u+v}),a.drawShape({shape:"text",text:"1-"+(w+1),textAlign:"center",textBaseline:"center",font:o,fill:q,x:y+f/2,y:z-14})}else{for(var w=0;j>w;w++){var y=w*f,z=0;a.drawShape({shape:"rect",rect:[y,z,f,g],lineWidth:1}),a.drawShape({shape:"text",text:x(b,"1-"+(w+1)),textAlign:"center",textBaseline:"center",font:p,fill:r,w:m,x:y+f/2,y:z+g/2+(w%s-t)*u+v}),a.drawShape({shape:"text",text:"1-"+(w+1),textAlign:"center",textBaseline:"center",font:o,fill:q,x:y+f/2,y:z+g+14})}for(a.drawShape({shape:"rect",rect:[0,g,k,h],lineWidth:1}),w=0;j>w;w++){var y=w*f,z=g+h;a.drawShape({shape:"rect",rect:[y,z,f,g],lineWidth:1}),a.drawShape({shape:"text",text:x(b,"2-"+(w+1)),textAlign:"center",textBaseline:"center",font:p,fill:r,w:m,x:y+f/2,y:z+g/2+(w%s-t)*u+v}),a.drawShape({shape:"text",text:"2-"+(w+1),textAlign:"center",textBaseline:"center",font:o,fill:q,x:y+f/2,y:z-14})}}}}]};return a},z=function(a){var b,c;return a.isSingle?(b=a.rackWidth*a.rackNumber,c=a.aisleDepth+a.rackDepth):(b=a.rackWidth*a.rackNumber/2,c=a.aisleDepth+2*a.rackDepth),{width:b,height:c}};c.Default.register("twaver.idc.aisle.top",function(a){function b(a,b,c){return this.ready&&setTimeout(function(){var d=z(b);b.setSize(d),b.setClient(c,a),b.isSingle?"right"==b.side?b.setStyle("label.yoffset",b.rackWidth/2):b.setStyle("label.yoffset",-b.rackWidth/2):b.setStyle("label.yoffset",0)},1),a}a.client=a.client||{};var d=z(a);a.width&&(d.width=a.width,a.rackNumber=a.width/a.rackWidth,a.isSingle||(a.rackNumber=a.rackNumber/2)),a.height&&(d.height=a.height,a.isSingle?a.aisleDepth=a.height-a.rackDepth:a.aisleDepth=a.height-a.rackDepth-a.rackDepth);var e={width:d.width,depth:d.height,client:{type:a.client.type||"channel"}};c.Default.copyProperties(a,e);var f=y();e.image=f;var g=c.Default.createNode(e);return g.ready=!1,g.setStyle("label.font","30px arial"),g.setStyle("label.color","#61B6ef"),c.Default.objectWrapper(g,"rackWidth",null,b),c.Default.objectWrapper(g,"rackDepth",null,b),c.Default.objectWrapper(g,"rackHeight",null,b),c.Default.objectWrapper(g,"rackNumber",null,b),
c.Default.objectWrapper(g,"aisleDepth",null,b),c.Default.objectWrapper(g,"isSingle",null,b),c.Default.objectWrapper(g,"side",null,b),g.rackWidth=a.rackWidth,g.rackDepth=a.rackDepth,g.rackHeight=a.rackHeight,g.rackNumber=a.rackNumber,g.aisleDepth=a.aisleDepth,g.isSingle=a.isSingle,g.side=a.side,g.ready=!0,g.isSingle?"right"==g.side?g.setStyle("label.yoffset",g.rackWidth/2):g.setStyle("label.yoffset",-g.rackWidth/2):g.setStyle("label.yoffset",0),g},o("通道","通道说明","channel.png","2d机柜模型",20,30,w(),"channel",n.channel)),c.Default.register("twaver.idc.airCondition.top",function(a){return a.id="twaver.idc.rack.top",a.width=100,a.depth=80,a.client=a.client||{},a.client.type="airCondition",c.Default.load(a)},o("空调","空调说明","airCondition.png","2d机柜模型",20,30,p({width:100,depth:80,height:200}))),c.Default.copy("twaver.idc.airCondition1.top","twaver.idc.airCondition.top",{},o("空调1","空调说明","airCondition1.png","2d机柜模型",20,30,p({width:188,depth:75,height:174}))),c.Default.copy("twaver.idc.airCondition2.top","twaver.idc.airCondition.top",{},o("空调2","空调说明","airCondition2.png","2d机柜模型",20,30,p({width:188,depth:75,height:174}))),c.Default.register("twaver.idc.model.top",function(a){var b={image:a.image||m("upstop"),width:a.width||80,depth:a.depth||60,client:{type:"model"}};c.Default.copyProperties(a,b);var d=c.Default.createNode(b);return d}),c.Default.register("twaver.idc.alternator.top",function(a){a.id="twaver.idc.model.top",a.image=a.image||k("alternator.png");var b=c.Default.load(a);return b},o("发电机","发电机说明","alternator.png","2d机柜模型",20,30,p({width:200,depth:85,height:107}))),c.Default.register("twaver.idc.switchgear.top",function(a){a.id="twaver.idc.model.top",a.width=a.width||60,a.depth=a.depth||60;var b=c.Default.load(a);return b},o("开关柜","开关柜说明","switchgear.png","2d机柜模型",20,30,p({width:60,depth:60,height:180}))),c.Default.register("twaver.idc.pdc.top",function(a){a.id="twaver.idc.model.top",a.width=a.width||60,a.depth=a.depth||60;var b=c.Default.load(a);return b},o("配电柜","配电柜说明","pdc.png","2d机柜模型",20,30,p({width:60,depth:60,height:180}))),c.Default.register("twaver.idc.ups.top",function(a){a.id="twaver.idc.model.top",a.image=a.image||m("upstop"),a.width=a.width||80,a.depth=a.depth||60;var b=c.Default.load(a);return b},o("ups","UPS说明","ups.png","2d机柜模型",20,30,p({width:60,depth:80,height:200}))),c.Default.register("twaver.idc.battery.top",function(a){a.id="twaver.idc.model.top",a.image=a.image||m("batterytop"),a.width=a.width||150,a.depth=a.depth||60;var b=c.Default.load(a);return b},o("蓄电池","蓄电池说明","battery.png","2d机柜模型",20,30,p({width:150,depth:60,height:80}))),c.Default.register("twaver.idc.yangan.top",function(a){a.id="twaver.idc.model.top",a.image=a.image||m("yangan"),a.width=33.51,a.depth=33.51;var b=c.Default.load(a);return b},o("烟感","烟感说明","yangan.png","2d环境模型",20,30,s())),c.Default.register("twaver.idc.changuanqi.top",function(a){a.id="twaver.idc.model.top",a.image=a.image||m("wendu"),a.width=a.width||5.14,a.depth=a.depth||10.52;var b=c.Default.load(a);return b},o("传感器","传感器说明","wendu.png","2d环境模型",20,30,s())),c.Default.register("twaver.idc.shuangjian.top",function(a){a.id="twaver.idc.model.top",a.image=a.image||m("shuangjian"),a.width=a.width||9.21,a.depth=a.depth||15.92;var b=c.Default.load(a);return b},o("双鉴","双鉴说明","shuangjian.png","2d环境模型",20,30,s())),c.Default.register("twaver.idc.shuijin.top",function(a){a.id="twaver.idc.model.top",a.image=a.image||m("shuijin"),a.width=a.width||31.98,a.depth=a.depth||31.98;var b=c.Default.load(a);return b},o("水浸","水浸说明","shuijin.png","2d环境模型",20,30,s())),c.Default.register("twaver.idc.watercable.top",function(a){var b={objType:"cable",client:{data:a.data,type:"cable"}};c.Default.copyProperties(a,b);var d=c.Default.create2dShapeNode(b);return d.setStyle("vector.outline.color",a.color||"#B45F04"),d},o("水浸线","水浸说明","cable.png","2d环境模型",20,30,r(),"watercable")),c.Default.register("twaver.idc.camera.top",function(a){a.id="twaver.idc.model.top",a.image=a.image||k("camera.png"),a.width=33.51,a.depth=33.51,a.style=a.style||{"label.font":"10px","label.position":"bottom"};var b=c.Default.load(a);return b},o("摄像头1","摄像头说明","camera.png","2d环境模型",20,30,s())),c.Default.register("twaver.idc.camera1.top",function(a){a.id="twaver.idc.model.top",a.image=a.image||k("camera1.png"),a.width=33.51,a.depth=33.51,a.style=a.style||{"label.font":"10px","label.position":"bottom"};var b=c.Default.load(a);return b},o("摄像头2","摄像头说明","camera1.png","2d环境模型",20,30,s())),c.Default.register("twaver.idc.generator.top",function(a){a.id="twaver.idc.model.top",a.width=a.width||425,a.depth=a.depth||233;var b=c.Default.load(a);return b},o("发电机","发电机说明","generator.png","2d机柜模型",20,30,p({width:425,depth:233,height:180}))),c.Default.register("twaver.idc.fire.top",function(a){a.id="twaver.idc.model.top",a.width=a.width||23.9382,a.depth=a.depth||23.9382;var b=c.Default.load(a);return b},o("灭火器","灭火器说明","fire.png","2d机柜模型",20,30,p({width:23.9382,depth:23.9382,height:90.116})));var A=function(a,b){var b=b||"twaver.idc.rack{}.front".format(a),d="{}U机柜".format(a),e="rack.png".format(a),f="rack{}U.svg".format(a),g=c.Default.RACK_OFFSET_X,h=c.Default.RACK_OFFSET_Y,i=c.Default.RACK_WIDTH,j=c.Default.getRackHeight(a);c.Default.register(b,function(d){return c.Default.copyProperties({imageUrl:m(f),width:i,height:j,client:{id:b,host:!0,childrenSize:a,offsetX:g,offsetY:h}},d),c.Default.createFollower(d)},{name:d,category:"机柜",icon:k(e),offsetX:g,offsetY:h,host:!0})};A(42,"twaver.idc.rack.front");for(var v=42;47>=v;v++)A(v);for(var B=function(a,b){return{imageUrl:b.image?l(b.image):m("u-0"+a),width:c.Default.getEquipmentWidth(),height:c.Default.getEquipmentHeight(a),client:{size:a,category:"server"}}},C=function(a,d){return{name:a+"U设备",modelDefaultParameters:{bid:{name:"BID",value:b,type:c.Default.PARAMETER_TYPE_STRING,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_CLIENT},loc:{name:"位置",value:0,type:c.Default.PARAMETER_TYPE_INT,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_CLIENT},panel:{name:"面板",value:"twaver.idc.equipment.newPanel",type:c.Default.PARAMETER_TYPE_STRING,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_CLIENT}},description:d,category:"设备2D",icon:k("server"+a+".png")}},D=function(a,b,d){b=b||"twaver.idc.equipment"+a+".front",c.Default.register(b,function(b){var d={};return c.Default.copyProperties(B(a,b),d),b.image&&delete b.image,c.Default.copyProperties(b,d),c.Default.createFollower(d)},C(a,d))},E=1;8>=E;E++)D(E);D(2,"twaver.idc.equipment.front","{}U的服务器设备".format(2)),D(8,"twaver.idc.equipment8-1.front","{}U的服务器设备。这是一种挖空的机架".format(8));var F=function(a){return{name:a.label,modelDefaultParameters:{width:{name:"宽度",value:10*c.Default.getEquipmentWidth(),type:c.Default.PARAMETER_TYPE_INT,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_ACCESSOR},height:{name:"高度",value:10*c.Default.getEquipmentHeight(1),type:c.Default.PARAMETER_TYPE_INT,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_ACCESSOR}},category:"面板背板",icon:k(a.label+".png"),host:!0}},G=function(a,b){var d="twaver.idc."+a+".panel";c.Default.register(d,function(b){c.Default.copyProperties({imageUrl:m(a),client:{category:"networkDevice-panel",host:!0,editable:!0}},b);var d=c.Default.createFollower(b);return d},F(b))},H={hw_s2700:{label:"hw_s2700",width:44,height:442},hw_s3700:{label:"hw_s3700",width:44,height:442},cisco_2950:{label:"cisco_2950",width:44,height:442},cisco_2960:{label:"cisco_2960",width:44,height:442},h3c_s1050t:{label:"h3c_s1050t",width:44,height:442},h3c_s1224:{label:"h3c_s1224",width:44,height:442}};for(var I in H)G(I,H[I]);c.Default.register("twaver.idc.network.panel",function(a){return c.Default.copyProperties({style:{"body.type":"vector","vector.shape":"rectangle","vector.fill":!0},client:{category:"networkDevice-panel",host:!0,resizeable:!0,editable:!0}},a),c.Default.createFollower(a)},{name:"设备",modelDefaultParameters:{width:{name:"宽度",value:10*c.Default.getEquipmentWidth(),type:c.Default.PARAMETER_TYPE_INT,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_ACCESSOR},height:{name:"高度",value:10*c.Default.getEquipmentHeight(1),type:c.Default.PARAMETER_TYPE_INT,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_ACCESSOR},"vector.fill.color":{name:"背景色",value:"#444444",type:c.Default.PARAMETER_TYPE_COLOR,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_STYLE}},category:"面板背板",icon:k("network_panel.png"),host:!0}),c.Default.register("twaver.idc.card.panel",function(a){return c.Default.copyProperties({style:{"body.type":"vector","vector.shape":"rectangle","vector.fill":!0},client:{category:"networkDevice-panel",host:!0,resizeable:!0,editable:!0}},a),c.Default.createFollower(a)},{name:"设备",modelDefaultParameters:{width:{name:"宽度",value:50,type:c.Default.PARAMETER_TYPE_INT,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_ACCESSOR},height:{name:"高度",value:500,type:c.Default.PARAMETER_TYPE_INT,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_ACCESSOR},"vector.fill.color":{name:"背景色",value:"#444444",type:c.Default.PARAMETER_TYPE_COLOR,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_STYLE}},category:"面板背板",icon:k("card_panel.png"),host:!0});for(var J=function(a){return{imageUrl:m(a+"u"),width:10*c.Default.getEquipmentWidth(),height:10*c.Default.getEquipmentHeight(a),client:{size:a,category:"device-panel",host:!0}}},K=function(a){return{name:a+"U设备",category:"面板背板",icon:k(""+a+"u.png"),host:!0}},L=function(a){var b="twaver.idc.equipment"+a+".panel";c.Default.register(b,function(d){return c.Default.copyProperties(J(a,d.scale),d),d.client.id=b,c.Default.createFollower(d)},K(a))},E=1;8>=E;E++)L(E);var M=function(a){var d={width:{name:"宽度",value:a.width,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_ACCESSOR},height:{name:"高度",value:a.height,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_ACCESSOR},position:{name:"位置[x,y,z]",value:[0,0,0],type:c.Default.PARAMETER_TYPE_ARRAY_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD,hidden:!0},x:{name:"X轴位置",value:0,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_ACCESSOR,exportable:!1},y:{name:"Y轴位置",value:0,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_ACCESSOR,exportable:!1},rotation:{name:"旋转[x,y,z]",value:[0,0,0],type:c.Default.PARAMETER_TYPE_ARRAY_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD,hidden:!0},angle:{name:"Z轴旋转",value:0,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_ACCESSOR,exportable:!1},decoration:{name:"装饰部件",value:a.decoration,type:c.Default.PARAMETER_TYPE_BOOLEAN,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_CLIENT,hidden:!0}};a.decoration||(d.bid={name:"业务ID",value:b,type:c.Default.PARAMETER_TYPE_STRING,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_CLIENT,index:0});var e={name:a.label,modelDefaultParameters:d,category:"面板部件",icon:k(I+".png")};return e},N=function(a,b){var d="twaver.idc."+a+".panel";c.Default.register(d,function(b){c.Default.copyProperties({imageUrl:m(a),client:{category:"device-panel-comp",host:!1}},b);var d=c.Default.createFollower(b);return d},M(b))},O={DP:{label:"DP",width:16.91,height:6.3,decoration:!0},AV:{label:"AV",width:30.04,height:8,decoration:!0},"DVI-24-1":{label:"DVI-24-1",width:35.07,height:7.8,decoration:!0},HDMI:{label:"HDMI",width:13.91,height:5.17,decoration:!0},"DVI-24-5":{label:"DVI-24-5",width:35.07,height:7.8,decoration:!0},MicroHDMI:{label:"MicroHDMI",width:5.91,height:2.88,decoration:!0},VGA:{label:"VGA",width:24.62,height:7.94,decoration:!0},"ball-black":{label:"ball-black",width:5,height:5},"ball-green":{label:"ball-green",width:5,height:5},"ball-yellow":{label:"ball-yellow",width:5,height:5},"ball-red":{label:"ball-red",width:5,height:5},"button-power":{label:"button-power",width:17.92,height:17.92},ground:{label:"ground",width:12,height:12},idc15:{label:"idc15",width:39.1,height:12.55},idc25:{label:"idc25",width:53.1,height:12.55},dell:{label:"dell",width:17.92,height:17.92},SCART:{label:"SCART",width:23.71,height:8.39},USB:{label:"USB",width:12,height:4.6},idc37:{label:"idc37",width:69.5,height:12.55},jack3:{label:"jack3",width:26,height:20.49},led:{label:"led",width:12.35,height:3.53},logo_HBC:{label:"logo_HBC",width:18,height:4.52},logo_cisco01:{label:"logo_cisco01",width:13,height:6.85},miniHDMI:{label:"miniHDMI",width:10.41,height:2.41},logo_cisco02:{label:"logo_cisco02",width:21,height:11.85},mini_USB:{label:"mini_USB",width:6.82,height:3.11},port38:{label:"port38",width:33.6,height:6.95},idc9:{label:"idc9",width:30.8,height:12.55},logo_HUAWEI:{label:"logo_HUAWEI",width:25,height:5.89},port_1394_4pin:{label:"port_1394_4pin",width:6,height:3.78},port_13w3:{label:"port_13w3",width:54.59,height:15.5},port_5din:{label:"port_5din",width:15,height:15},mirco_usb:{label:"mirco_usb",width:7.18,height:1.94},port_1394_6pin:{label:"port_1394_6pin",width:11.22,height:5.15},port_4din:{label:"port_4din",width:15,height:15},port_6din:{label:"port_6din",width:15,height:15},port_bnc:{label:"port_bnc",width:18.19,height:15},port_8din:{label:"port_8din",width:15,height:15},port_card34:{label:"port_card34",width:35.36,height:5.2},port_card54:{label:"port_card54",width:54,height:5.2},port_db9:{label:"port_db9",width:18,height:9.28},"ps2-mouse":{label:"ps2-mouse",width:10,height:10},port_db25:{label:"port_db25",width:38,height:8.29},"ps2-keyboard":{label:"ps2-keyboard",width:10,height:10},rj11:{label:"rj11",width:9.26,height:10.9},radiator:{label:"radiator",width:31.65,height:31.68},"radiator-2":{label:"radiator-2",width:78,height:16.33},rj4502:{label:"rj4502",width:13.06,height:9.55},port_db36:{label:"port_db36",width:50,height:13.28},rj4503:{label:"rj4503",width:13.78,height:9.55},"screw-black":{label:"screw-black",width:9,height:9},rj4504:{label:"rj4504",width:18,height:12.6},"screw-gray":{label:"screw-gray",width:12,height:12},"usb-printer":{label:"usb-printer",width:8.12,height:10.05},warn:{label:"warn",width:14,height:14},ypbpr:{label:"ypbpr",width:28.66,height:16.96},rj4501:{label:"rj4501",width:13.77,height:9.55},switch_01:{label:"switch_01",width:11.39,height:21.64},port_01:{label:"port_01",width:14.2,height:9.94},port_02:{label:"port_02",width:7.7,height:6.94},logo_hp:{label:"logo_hp",width:8.88,height:5.2},w01:{label:"w01",width:189.15,height:20.81},deco_01:{label:"deco_01",width:14.73,height:15.66},deco_01:{label:"deco_01",width:14.73,height:15.66},VGA_01:{label:"VGA_01",width:29.27,height:11.54},deco_02:{label:"deco_02",width:17.98,height:52.17},disk_01:{label:"disk_01",width:17.92,height:76.52},disk_03:{label:"disk_03",width:126.43,height:16.44},disk_02:{label:"disk_02",width:126.42,height:16.45},grid_01:{label:"grid_01",width:129.55,height:26.16},logo_ibm:{label:"logo_ibm",width:24.83,height:25.99},port_03:{label:"port_03",width:5.07,height:3.92},text_01:{label:"text_01",width:6.9,height:3.07},text_02:{label:"text_02",width:34.65,height:4.95},usb_01:{label:"usb_01",width:12.55,height:6.38},deco_03:{label:"deco_03",width:14.55,height:177.81},deco_05:{label:"deco_05",width:3.09,height:76.12},deco_04:{label:"deco_04",width:179.63,height:93.09},deco_06:{label:"deco_06",width:14.55,height:10.95},deco_07:{label:"deco_07",width:67.41,height:177.56},deco_08:{label:"deco_08",width:191.8,height:11.44},disk_04:{label:"disk_04",width:133.71,height:49.85},disk_05:{label:"disk_05",width:14.44,height:75.49},disk_06:{label:"disk_06",width:127.87,height:11.44},port_04:{label:"port_04",width:60.8,height:11.44},grid_02:{label:"grid_02",width:212.96,height:67.61},deco_09:{label:"deco_09",width:359.13,height:61.35},deco_10:{label:"deco_10",width:22.15,height:88.91},deco_11:{label:"deco_11",width:52.33,height:42.96},deco_12:{label:"deco_12",width:155.36,height:48.68},deco_13:{label:"deco_13",width:169.03,height:2.19},deco_15:{label:"deco_15",width:18.66,height:19.58},deco_14:{label:"deco_14",width:64.68,height:5.51},deco_16:{label:"deco_16",width:18.66,height:19.58},deco_17:{label:"deco_17",width:27.27,height:8.34},deco_18:{label:"deco_18",width:9.32,height:4.45},deco_19:{label:"deco_19",width:21.42,height:88.91},disk_07:{label:"disk_07",width:80.34,height:18.14},dvd:{label:"dvd",width:133.53,height:21.27},port_05:{label:"port_05",width:13.99,height:6.73},logo_intel:{label:"logo_intel",width:15.84,height:19.66},port_06:{label:"port_06",width:13.37,height:6.15},port_15din:{label:"port_15din",width:8.96,height:31.31},power:{label:"power",width:7.28,height:7.28},text_03:{label:"text_03",width:16.56,height:9.98}};for(var I in O)N(I,O[I]);var P=function(a){return c.Default.path+"model/idc/icons/device/"+a+"_front.png"},Q=function(a){return c.Default.path+"model/idc/images/device/"+a+"_front.png"};c.Default.register("twaver.idc.panel.loader",function(a){var b=a.data||[],d=a.scale||1,e=a.x||0,f=a.y||0;if(b&&0!=b.length){b.forEach(function(a){a.scale=d});var g=c.Default.load(b);if(c.Default.getOtherParameter(b[0].id,"host")){for(var h=g,i=h[0],j=1;j<h.length;j++)h[j].setMovable(!1),h[j].setHost(i),h[j].setParent(i),i.addChild(h[j]);return i.setLocation(e,f),i}var k=[],l={},m=[],n=[];return g.forEach(function(a,b){if(a.index=b,c.Default.getOtherParameter(c.Default.getId(a),"link"))n.push(a);else{m.push(a);var d=a.getClient("bid");d&&d.length>0&&(l[d]=a)}}),m.forEach(function(a){a.setMovable(!1),k.push(a)}),n.forEach(function(a){var c=b[a.index];a.setFromNode(l[c.from]),a.setToNode(l[c.to]),k.push(a)}),k}},{category:"设备面板",icon:P("panel")});for(var R=function(a,b,d){var e=b.height;c.Default.copy("twaver.idc."+a+".device.front","twaver.idc.equipment"+e+".front",function(b){b.image=Q(a)},{icon:P(a),subType:d}),c.Default.copy("twaver.idc."+a+".panel.loader","twaver.idc.panel.loader",{data:b.data},{subType:d,icon:P(a)})},S=["server","network"],v=0;v<S.length;v++){var T=S[v],U="devicePanel_"+T,V=c.Default[U];for(var I in V)V[I].data&&R(I,V[I],T)}c.Default.copy("twaver.idc.wall5.top","twaver.idc.wall.top"),c.Default.copy("twaver.idc.innerWall2.top","twaver.idc.innerWall.top"),c.Default.copy("twaver.idc.glassWall1.top","twaver.idc.glassWall.top",{},{icon:k("glasswall1.png")}),c.Default.copy("twaver.idc.glassWall3.top","twaver.idc.glassWall2.top",{},{icon:k("glasswall3.png")}),c.Default.copy("twaver.idc.column1.top","twaver.idc.column.top"),c.Default.copy("twaver.idc.column2.top","twaver.idc.column.top"),c.Default.copy("twaver.idc.door2.top","twaver.idc.door1.top",{},{icon:k("door2.png")}),c.Default.copy("twaver.idc.headerRack1.top","twaver.idc.headerRack.top",{},{icon:k("headerRack1.png")}),c.Default.copy("twaver.idc.headerRack2.top","twaver.idc.headerRack.top",{},{icon:k("headerRack2.png")}),c.Default.copy("twaver.idc.headerRack3.top","twaver.idc.headerRack.top",{},{icon:k("headerRack3.png")}),c.Default.copy("twaver.idc.rack2.top","twaver.idc.rack.top",{},{icon:k("simpleRack2.png"),category:"2d机柜模型"}),c.Default.copy("twaver.idc.simpleRack2.top","twaver.idc.simpleRack.top",{},{category:"2d机柜模型",icon:k("simpleRack2.png")});for(var E=42;47>=E;E++)c.Default.copy("twaver.idc.rack2-"+E+".top","twaver.idc.rack2.top"),c.Default.copy("twaver.idc.rack2-"+E+".front","twaver.idc.rack2.front"),c.Default.copy("twaver.idc.simpleRack2-"+E+".top","twaver.idc.simpleRack2",{height:E});c.Default.register("twaver.idc.bigScreen2.top",function(a){var b={width:290,depth:2058,client:{type:"model"}};c.Default.copyProperties(a,b);var d=c.Default.createNode(b);return d},{category:"2d房间模型",type:"mono.Element",icon:k("bigScreen2.png")});var l=function(a){return a.indexOf("/")>0?a:c.Default.path+"model/idc/images/"+a},k=function(a){return a.indexOf("/")>0?a:c.Default.path+"model/idc/icons/"+a},W=function(){return{bid:{value:"",name:"业务ID",type:c.Default.PARAMETER_TYPE_STRING,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_CLIENT},position:{value:[0,0,0],name:"位置",type:c.Default.PARAMETER_TYPE_ARRAY_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD,editable:!1},rotation:{value:[0,0,0],name:"旋转角度",type:c.Default.PARAMETER_TYPE_ARRAY_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD,editable:!1}}},X=function(a,b,d){var e={width:{value:a,name:"宽",type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},height:{value:b,name:"高",type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},depth:{value:d,name:"深",type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD}},f=W();return c.Default.copyProperties(f,e),e},Y=function(a){var a=a||"42U";return X(60,a,80)},Z=function(a){var b=Y(a),d={cutWidth:{name:"内宽",value:45.5,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},frontImage:{name:"正面图片",value:"",type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},backImage:{name:"背面图片",value:"rack_back_door.png",type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},topImage:{name:"顶部图片",value:"rack_top.png",type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},sideImage:{name:"侧面图片",value:"rack_side.png",type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},fontDoorImage:{name:"门正面图片",value:"rack_front_door.jpg",type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},backDoorImage:{name:"门反面图片",value:"rack_door_back.png",type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},insideTopImage:{name:"内部顶贴图",value:"inside_top.jpg",type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},insideSideImage:{name:"内部侧贴图",value:"inside_side.jpg",type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},insideBackImage:{name:"内部后贴图",value:"inside_back.jpg",type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},doorAngle:{name:"机柜开门角度",value:-150,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},evnmap:{name:"机柜环境贴图",value:"envmap1",type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},reflectRatio:{name:"环境反射率",value:1,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD}};return c.Default.copyProperties(d,b),b},$=function(a,b){var a=parseInt(a),c=l("rack.png");return 100>b?c=l("rack"+a+"u.png"):42==a?c=l("rack-120.png"):47==a&&(c=l("rack47U-120.png")),c};c.Default.register("twaver.idc.rack",function(a,b){a=a||{},a.client=a.client||{},a.style=a.style||{};var d=a.position||[0,0,0],e=d[0],f=d[1],g=d[2],h=c.Default.getRsByDs(a.rotation)||[0,0,0],i=a.width,j=a.height,k=a.depth,m=a.cutWidth,n=l(a.backImage),o=l(a.sideImage),p=l(a.topImage),q=a.frontImage||l("rack"+parseInt(j)+"u.png"),r=c.Default.getRackHeight(j),s=a.doorAngle,t=c.Default.getEnvMap(a.evnmap),u=a.reflectRatio,v=l(a.insideTopImage),w=l(a.insideSideImage),x=l(a.insideBackImage),y=l(a.fontDoorImage),z=l(a.backDoorImage),A=a.doorTransparent||!1,B=2*c.Default.RACK_OFFSET_Y,C=new mono.Cube(i,r,k);C.s({"m.color":"#666666","m.ambient":"#ffffff","m.specular":"#e5e5e5","m.type":"phong","m.specularStrength":3,"left.m.texture.image":o,"right.m.texture.image":o,"top.m.texture.image":p,"bottom.m.texture.image":p,"back.m.texture.image":n,"front.m.texture.image":q,"front.m.specularStrength":2});var D=new mono.Cube(m,r-B+1,.7*k);D.s({"m.type":"basic","m.lightmap.image":c.Default.getImagePath("outside_lightmap.jpg"),"back.m.texture.image":x,"left.m.texture.image":w,"left.m.texture.flipX":!0,"right.m.texture.image":w,"top.m.texture.image":v,"top.m.texture.flipY":!0,"bottom.m.texture.image":v}),D.setPosition(0,0,C.getDepth()/2-D.getDepth()/2+2);var E;E=a.objectId?new mono.ComboNode({id:a.objectId,combos:[C,D],operators:["-"]}):new mono.ComboNode([C,D],["-"]);for(var F in a.client)E.setClient(F,a.client[F]);var G=new mono.Cube(i,r,2);return G.s({"m.type":"phong","m.transparent":A,"front.m.texture.image":y,"back.m.texture.image":z,"m.envmap.image":t,"m.reflectRatio":u}),G.setParent(E),G.setClient("animation","rotation:right:{}:1000:0:bounceOut".format(s||"-150")),G.setClient("type","rack_door"),G.setClient("inbuilt",!0),G.setPosition(0,0,k/2+1),E.rackDoor=G,E.setPosition(e,0,g),c.Default.setPositionY(E,f),E.setClient("type","rack"),E.setClient("showShadow",!0),E.setRotation(h[0],h[1],h[2]),c.Default.setObject3dCSProps(E,a),b&&b(E),E},{name:"机柜",category:"机柜模型",description:"机房最常见的模型。机柜是由机柜的主体和机柜门组成的，机柜门支持动画打开，关闭。 支持42U-47U高度，默认42U的高度。模型上还支持常见的长，宽，机柜贴图的设置",icon:k("rack.png"),type:"rack",sdkCategory:"rack",modelDefaultParameters:Z("42U")});for(var _=function(a){c.Default.register("twaver.idc.rack"+a,function(b,d){var e={id:"twaver.idc.rack",height:a+"U"};return c.Default.copyProperties(b,e),c.Default.load(e,d)},{childrenSize:a,name:a+"U机柜",description:a+"U机柜, 机房最常见的模型。机柜是由机柜的主体和机柜门组成的，机柜门支持动画打开，关闭",icon:k("rack.png"),category:"机柜模型",type:"mono.Element",sdkCategory:"rack",modelDefaultParameters:Z(a+"U")})},v=42;47>=v;v++)_(v);c.Default.register("twaver.idc.rack1",function(a,b){var d=a.position||[0,0,0],e=d[0],f=d[1],g=d[2],h=a.width,i=a.height,j=a.depth,k=c.Default.getRackHeight(i),m=c.Default.getRsByDs(a.rotation)||[0,0,0],n=l("white.png"),o=2*c.Default.RACK_OFFSET_Y,p=$(i,h),q=new mono.Cube(h,k,j);q.s({"m.type":"phong","m.color":"#557E7A","m.ambient":"#557E7A","m.specularStrength":50,"m.lightmap.image":c.Default.getImagePath("outside_lightmap.jpg"),"m.normalmap.image":c.Default.getImagePath("metal_normalmap.jpg"),"m.specularmap.image":c.Default.getImagePath("outside_lightmap.jpg"),"m.envmap.image":c.Default.getEnvMap("envmap1"),"front.m.normalmap.image":c.Default.getImagePath("outside_lightmap.jpg"),"front.m.texture.image":p,"front.m.texture.repeat":new mono.Vec2(1,1),"front.m.specularmap.image":l("white.png"),"front.m.specularStrength":200,"front.m.envmap.image":[n,n,n,n,n,n]});var r=new mono.Cube(45.5,k-o,.7*j);r.s({"m.type":"basic","m.color":"#888888","m.ambient":"#888888","m.lightmap.image":c.Default.getImagePath("inside_lightmap.jpg"),"left.m.texture.image":l("rack_panel.png"),"right.m.texture.image":l("rack_panel.png"),"back.m.texture.image":l("rack_panel.png")}),r.setPosition(0,0,q.getDepth()/2-r.getDepth()/2+2);var s;s=a.objectId?new mono.ComboNode({id:a.objectId,combos:[q,r],operators:["-"]}):new mono.ComboNode([q,r],["-"]);var t=new mono.Cube(h,k,2);return t.s({"m.type":"phong","m.color":"#A5F1B5","m.ambient":"#A4F4EC","front.m.texture.image":l("rack_front_door.jpg"),"back.m.texture.image":l("rack_door_back.png"),"m.envmap.image":c.Default.getEnvMap("envmap1")}),t.setParent(s),t.setPosition(0,0,j/2+1),t.setClient("type","rack_door"),t.setClient("animation","rotation:right:-150:1000:0:bounceOut"),t.setClient("inbuilt",!0),s.p(e,0,g),s.setRotation(m[0],m[1],m[2]),c.Default.setPositionY(s,f),s.setClient("type","rack"),c.Default.setObject3dCSProps(s,a),b&&b(s),s},{name:"机柜1",description:'机房最常见的模型。和"twaver.idc.rack"区别在于这种类型的机柜加了环境贴图，是另外一种风格的机柜样式',icon:k("rack1.png"),category:"机柜模型",type:"rack",sdkCategory:"rack",modelDefaultParameters:Y("47U")});var aa=function(){var a=Y(),b={image:{name:"贴图",value:"rack_wrap.jpg",type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD}};return c.Default.copyProperties(b,a),a};c.Default.register("twaver.idc.simpleRack",function(a,b){var d=a.position||[0,0,0],e=d[0],f=d[1],g=d[2],h=a.width,i=a.height,j=a.depth;i=c.Default.getRackHeight(i);var k,m=c.Default.getRsByDs(a.rotation)||[0,0,0],n=l(a.image);return k=a.objectId?new mono.Cube({id:a.objectId,width:h,height:i,depth:j}):new mono.Cube(h,i,j),k.s({"m.type":"phong","m.color":"#666666","m.ambient":"#ffffff","m.specular":"#e5e5e5","m.specularStrength":2,"m.texture.image":n}),k.setWrapMode("six-each"),k.p(e,0,g),k.setRotation(m[0],m[1],m[2]),c.Default.setPositionY(k,f),k.setClient("type","rack"),k.setClient("showShadow",!0),c.Default.setObject3dCSProps(k,a),b&&b(k),k},{name:"简单机柜",description:"机柜的简单实现，一个cube加一个贴图，外观和twaver.idc.rack一样，但没有门和内部结构，可用于不关注内部细节时显示",icon:k("racks.png"),category:"机柜模型",type:"rack",sdkCategory:"rack",modelDefaultParameters:aa()});var ba=function(a){var b=l("head_rack.png");return 220==a&&(b=l("head_rack1.jpg")),b},ca=function(){var a=X(60,200,80);return a.color={name:"颜色",value:"white",type:c.Default.PARAMETER_TYPE_COLOR,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},a.frontImage={name:"前贴图",value:"",type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},a.backImage={name:"后贴图",value:"head_rack_side.png",type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},a.topImage={name:"顶图片",value:"head_rack_side.png",type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},a.sideImage={name:"边贴图",value:"head_rack_side.png",type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},a};c.Default.register("twaver.idc.headerRack",function(a,b){var d=a.position||[0,0,0],e=d[0],f=d[1],g=d[2],h=a.width,i=a.height,j=a.depth,k=c.Default.getRsByDs(a.rotation)||[0,0,0],m=a.color,n=l(a.sideImage),o=l(a.topImage)||n,p=l(a.backImage)||n,q=a.frontImage;q||(q=ba(i));var r;return r=a.objectId?new mono.Cube({id:a.objectId,width:h,height:i,depth:j}):new mono.Cube(h,i,j),r.s({"m.type":"phong","m.color":m,"m.ambient":m,"m.specular":"#FFFFFF","m.specularStrength":3,"m.lightmap.image":c.Default.getImagePath("outside_lightmap.jpg"),"m.specularmap.image":c.Default.getImagePath("outside_lightmap.jpg"),"m.texture.image":n,"top.m.texture.image":o,"back.m.texture.image":p,"front.m.texture.image":q,"front.m.envmap.image":c.Default.getEnvMap("envmap1"),"m.reflectRatio":.2}),r.p(e,0,g),r.setRotation(k[0],k[1],k[2]),c.Default.setPositionY(r,f),r.setClient("type","header_rack"),r.setClient("showShadow",!0),c.Default.setObject3dCSProps(r,a),b&&b(r),r},{name:"列头柜",description:"机房常见设备之一，列头柜支持修改长，宽，高，颜色参数。",icon:k("headerRack.png"),category:"机柜模型",type:"header_rack",sdkCategory:"rack",modelDefaultParameters:ca()});var da={1:"equipment_front-1U.png",2:"equipment_front-2U.png",3:"equipment_front-3U.png",4:"equipment_front-4U.png",5:"equipment_front-5U.png",6:"equipment_front-6U.png",7:"equipment_front-7U.png",8:"equipment_front-8U.png"},ea=function(a,b){var d=W(),e={width:{value:45,name:"宽",propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},height:{value:a,name:"高(U)",propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD,editable:!1},depth:{value:50,name:"深",propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},frontImage:{value:b||da[a],name:"正面贴图",type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD}};return c.Default.copyProperties(d,e),e},fa=function(a,b){return{size:a,type:"server",category:"设备模型",name:a+"U设备",icon:k(b||"server1.png"),description:a+"U的服务器设备。高度为U数，宽度默认是45cm。支持修改宽度，深度和贴图。",modelDefaultParameters:ea(a)}};c.Default.register("twaver.idc.equipment",function(a,b){var d=a.position||[0,0,0],e=d[0],f=d[1],g=d[2],h=a.width,i=parseInt(a.height||1),j=a.depth,k=4.445*i,m=da,n=a.cut,o=new mono.Cube(h-2,k-1,j);o.s({"m.color":"#666","m.ambient":"#666","m.type":"phong","m.side":mono.DoubleSide,"m.texture.image":l("rack_inside.png"),"m.lightmap.image":c.Default.getImagePath("outside_lightmap.jpg")});var p=new mono.Cube(parseFloat(h)+5,parseFloat(k),1),q=l("server.png");n||(q=l(a.frontImage||m[i])),p.s({"m.type":"phong","m.color":"#333","m.ambient":"#333","m.texture.image":l("rack_inside.png"),"front.m.transparent":!0,"m.side":mono.DoubleSide,"front.m.texture.image":q,"front.m.texture.repeat":new mono.Vec2(1,1),"front.m.color":"#fff","front.m.ambient":"#fff"}),p.p(0,0,o.getDepth()/2+p.getDepth()/2);var r;if(r=a.objectId?new mono.ComboNode({id:a.objectId,combos:[o,p],operators:["+"]}):new mono.ComboNode([o,p],["+"]),a.client)for(var s in a.client)r.setClient(s,a.client[s]);return r.setClient("animation","move:front:1:1000:0:bounceOut"),r.p(e,0,g),c.Default.setPositionY(r,f),c.Default.setObject3dCSProps(r,a),b&&b(r),r},fa(2,"server2.png"));for(var ga=function(a){
c.Default.register("twaver.idc.equipment{}".format(a),function(b,d){var e={id:"twaver.idc.equipment",height:a};return c.Default.copyProperties(b,e),c.Default.load(e,d)},fa(a,"server{}.png".format(a)))},v=1;8>=v;v++)ga(v);c.Default.register("twaver.idc.equipment8-1",function(a,b){return a.id="twaver.idc.equipment",a.height=a.height||8,a.cut=!0,c.Default.load(a,b)},{type:"server",category:"设备模型",name:"8U机框",icon:k("server8-1.png"),description:"U的服务器设备。这是一种挖空的机架，支持修改宽度和深度",modelDefaultParameters:ea(8)});var ha=function(){var a=X(5,50,50);return a.color={name:"颜色",value:"white",type:c.Default.PARAMETER_TYPE_COLOR,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},a.image={value:"card2.png",name:"贴图",type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},a};c.Default.register("twaver.idc.card",function(a,b){var d=a.position||[0,0,0],e=d[0],f=d[1],g=d[2],h=a.width,i=a.height,j=a.depth,k=c.Default.getRsByDs(a.rotation)||[0,0,0],m=a.color||"white",n=l(a.image||"card2.png"),o=[{type:"cube",width:h,height:i,depth:1,position:[0,0,0],rotation:k,op:"+",style:{"m.color":m,"m.ambient":m,"m.texture.image":l("gray.png"),"front.m.texture.image":n,"back.m.texture.image":n}},{type:"cube",width:1,height:.95*i,depth:j,position:[0,0,-j/2],rotation:k,op:"+",style:{"m.color":m,"m.ambient":m,"m.texture.image":l("gray.png"),"left.m.texture.image":l("card_body.png"),"right.m.texture.image":l("card_body.png"),"left.m.texture.flipX":!0,"m.transparent":!0,"m.lightmap.image":c.Default.getImagePath("outside_lightmap.jpg")}}],p=c.Default.createCombo(o,a.objectId);return p.p(e,f,g),c.Default.setObject3dCSProps(p,a),b&&b(p),p},{category:"设备模型",type:"card",name:"板卡",icon:k("card.png"),description:"板卡",modelDefaultParameters:ha()});var ia=function(){return{image:{name:"贴图",value:"floor.jpg",type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},repeat:{name:"重复次数",value:183,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},data:{name:"点位置",value:"",type:c.Default.PARAMETER_TYPE_ARRAY_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},position:{value:[0,0,0],name:"位置",type:c.Default.PARAMETER_TYPE_ARRAY_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD,editable:!1},rotation:{value:[0,0,0],name:"旋转角度",type:c.Default.PARAMETER_TYPE_ARRAY_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD,editable:!1}}};c.Default.register("twaver.idc.floor",function(a,b){var d=a.data,e=l(a.image),f=a.repeat,g=a.position||[0,0,0],h={type:"shapeNode",data:d,vertical:!0,repeat:f,position:g,client:{type:"floor"},style:{"m.type":"basic","m.texture.image":e}},i=c.Default.createCombo([h]);return c.Default.setObject3dCSProps(i,a),b&&b(i),i},{category:"房间模型",type:"floor",name:"地板",icon:k("floor.png"),description:"地板是和墙，内墙一起使用的。用来创建3d机房的房间轮廓",modelDefaultParameters:ia()});var ja=function(){var a=X(60,261,60);return a.color={value:"#E8E8E8",name:"颜色",type:c.Default.PARAMETER_TYPE_COLOR,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},a.topColor={value:"#F7F7F7",name:"顶部颜色",type:c.Default.PARAMETER_TYPE_COLOR,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},a.image={value:"",name:"贴图",type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},a};c.Default.register("twaver.idc.column",function(a,b){var d=a.width,e=a.height,f=a.depth,g=a.position||[0,0,0],h=a.color,i=c.Default.getRsByDs(a.rotation)||[0,0,0],j=l(a.image),k=new mono.Cube(d,e,f);return k.s({"m.type":"basic","m.color":h,"m.lightmap.image":c.Default.getImagePath("inside_lightmap1.png"),"top.m.lightmap.image":l("white.png"),"top.m.color":a.topColor}),k.c({type:"column"}),a.image&&(k.setStyle("left.m.texture.image",j),k.setStyle("right.m.texture.image",j),k.setStyle("front.m.texture.image",j),k.setStyle("back.m.texture.image",j)),k.p(g[0],0,g[2]),k.setRotation(i[0],i[1],i[2]),k.setClient("showShadow",!0),c.Default.setPositionY(k,g[1]),c.Default.setObject3dCSProps(k,a),b&&b(k),k},{category:"房间模型",type:"column",name:"柱子",icon:k("column.png"),sdkCategory:"floor-child",description:"柱子一般是加在房间外墙上，有些机房会在通道内也会有柱子对象",modelDefaultParameters:ja()});var ka=function(a,b,c){var d=0,e={x:a[0],y:a[2]},f=[],c=c||[0,0,0];if(b[0]instanceof Array){for(var g=0;g<b.length;g++)f.push(b[g]);f.push(b[0]);for(var g=0;g<f.length-1;g++){var h={x:f[g][0]+c[0],y:f[g][1]+c[2]},i={x:f[g+1][0]+c[0],y:f[g+1][1]+c[2]};la(e,h,i,10)&&(d=Math.atan((h.y-i.y)/(h.x-i.x)))}}else{for(var g=0;g<b.length;g++)f.push(b[g]);f.push(b[0]),f.push(b[1]);for(var g=0;g<f.length-2;g+=2){var h={x:f[g]+c[0],y:f[g+1]+c[2]},i={x:f[g+2]+c[0],y:f[g+3]+c[2]};la(e,h,i,10)&&(d=Math.atan((h.y-i.y)/(h.x-i.x)))}}return 180*-d/Math.PI},la=function(a,b,c,d){0>d&&(d=0);var e=ma(a,b,c);return d>=e&&a.x>=Math.min(b.x,c.x)-d&&a.x<=Math.max(b.x,c.x)+d&&a.y>=Math.min(b.y,c.y)-d&&a.y<=Math.max(b.y,c.y)+d},ma=function(a,b,c){if(b.x===c.x)return Math.abs(a.x-b.x);var d=(c.y-b.y)/(c.x-b.x),e=(c.x*b.y-b.x*c.y)/(c.x-b.x);return Math.abs(d*a.x-a.y+e)/Math.sqrt(d*d+1)},na=function(){return{data:{name:"坐标点",value:[],type:c.Default.PARAMETER_TYPE_STRING,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},closed:{name:"是否合并",value:!1,type:c.Default.PARAMETER_TYPE_BOOLEAN,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},showFloor:{name:"是否显示地板",value:!1,type:c.Default.PARAMETER_TYPE_BOOLEAN,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},floorId:{name:"地板编号",value:"",type:c.Default.PARAMETER_TYPE_STRING,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},floorImage:{name:"地板贴图",value:"floor.jpg",type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},wallDepth:{name:"墙厚度",value:30,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},wallHeight:{name:"墙高度",value:261,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},insideColor:{name:"内墙颜色",value:"#EFEFEF",type:c.Default.PARAMETER_TYPE_COLOR,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},outsideColor:{name:"外墙颜色",value:"#DCE8E9",type:c.Default.PARAMETER_TYPE_COLOR,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},asideColor:{name:"外墙颜色",value:"#B8CAD5",type:c.Default.PARAMETER_TYPE_COLOR,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},zsideColor:{name:"外墙颜色",value:"#B8CAD5",type:c.Default.PARAMETER_TYPE_COLOR,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},topColor:{name:"顶部颜色",value:"#F7F7F7",type:c.Default.PARAMETER_TYPE_COLOR,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},bottomColor:{name:"底部颜色",value:"#F7FEFF",type:c.Default.PARAMETER_TYPE_COLOR,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},insideImage:{name:"内墙贴图",value:"",type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},outsideImage:{name:"外墙贴图",value:"wall.png",type:c.Default.PARAMETER_TYPE_COLOR,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},insideMap:{name:"内墙Light贴图",value:"inside_lightmap.jpg",type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},outsideMap:{name:"外墙Light贴图",value:"outside_lightmap.jpg",type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},repeat:{name:"重复高度",value:"130",type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},children:{name:"孩子对象",value:[],hidden:!0,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD}}};c.Default.register("twaver.idc.wall",function(a,b){var d=[],e=(a.client||{},a.wallDepth),f=a.position||[0,0,0];f[1]=parseFloat(f[1])||0;var g=a.insideImage?l(a.insideImage):null,h=a.outsideImage?l(a.outsideImage):null,i=a.insideMap?c.Default.getImagePath(a.insideMap):null,j=a.outsideMap?c.Default.getImagePath(a.outsideMap):null,k={type:"path",op:"+",width:e,height:a.wallHeight,insideColor:a.insideColor,outsideColor:a.outsideColor,asideColor:a.asideColor,zsideColor:a.zsideColor,topColor:a.topColor,bottomColor:a.bottomColor,insideImage:g,outsideImage:h,insideMap:i,outsideMap:j,repeat:a.repeat,data:a.data,closed:a.closed};if(d.push(k),a.children)for(var m=0;m<a.children.length;m++){a.children[m].inbuilt=!0,a.children[m].depth=e+6;var n=ka(a.children[m].position,a.data,a.position);a.children[m].rotation=[0,n,0];var o=a.children[m].position;a.children[m].position=[o[0]-f[0],o[1]-f[1],o[2]-f[2]];var p=c.Default.load(a.children[m]);d=d.concat(p)}for(var q=[],r=[],m=0;m<d.length;m++){var s=d[m];s.op?q.push(s):r.push(s)}var t=c.Default.createCombo(q);if(a.objectId&&(t._id=a.objectId),t.setPosition(f[0],f[1],f[2]),a.style&&t.s(a.style),t.setClient("data",a.data),t.setClient("type","wall"),r.length>0)for(var m=0;m<r.length;m++){var u=r[m],v=c.Default.createCombo(u);v.setParent&&v.setParent(t)}if(c.Default.setObject3dCSProps(t,a),a.showFloor){var f=a.position||[0,0,0],w=a.floorImage,x=a.floorId||"twaver.idc.floor",y=c.Default.load({id:x,data:a.data,image:w});y.setParent(t)}return b&&b(t),t},{category:"房间模型",type:"wall",name:"外墙",icon:k("wall.png"),description:"外墙是和内墙，地板一起使用的。用来创建3d机房的房间轮廓",sdkCategory:"floor",modelDefaultParameters:na()});var oa=function(a){var b=na();return b.closed.value=!0,b.showFloor.value=!0,b.data.value=a,b};c.Default.register("twaver.idc.wall1",function(a,b){return a.id="twaver.idc.wall",c.Default.load(a,b)},{category:"房间模型",type:"wall",name:"外墙1",icon:k("wall1.png"),description:"固定形状的房间，带地板",sdkCategory:"floor",modelDefaultParameters:oa([[-2e3,-2e3],[2e3,-2e3],[2e3,2e3],[-2e3,2e3]])}),c.Default.register("twaver.idc.wall2",function(a,b){return a.id="twaver.idc.wall",c.Default.load(a,b)},{category:"房间模型",type:"wall",name:"外墙2",icon:k("wall2.png"),description:"固定形状的房间，带地板",sdkCategory:"floor",modelDefaultParameters:oa([[-2500,-2500],[0,-2550],[0,0],[2500,0],[2500,2500],[-2500,2500]])}),c.Default.register("twaver.idc.wall3",function(a,b){return a.id="twaver.idc.wall",c.Default.load(a,b)},{category:"房间模型",type:"wall",name:"外墙3",icon:k("wall3.png"),description:"固定形状的房间，带地板",sdkCategory:"floor",modelDefaultParameters:oa([[-2500,-500],[-1300,-500],[-1300,-2500],[1300,-2500],[1300,-500],[2500,-500],[2500,2500],[-2500,2500]])}),c.Default.register("twaver.idc.wall4",function(a,b){return a.id="twaver.idc.wall",c.Default.load(a,b)},{category:"房间模型",type:"wall",name:"外墙4",icon:k("wall4.png"),description:"固定形状的房间，带地板",sdkCategory:"floor",modelDefaultParameters:oa([[-2500,-500],[-1500,-500],[-1e3,-2500],[1e3,-2500],[1500,-500],[2500,-500],[2500,2500],[-2500,2500]])});var pa=function(){var a=na();return a.wallDepth.value=20,a.outsideColor.value="#EFEFEF",a.outsideImage.value="",delete a.showFloor,delete a.closed,a};c.Default.register("twaver.idc.innerWall",function(a,b){var d=[],e=(a.client||{},a.wallDepth),f=a.wallHeight,g=a.insideMap?c.Default.getImagePath(a.insideMap):null,h=a.outsideMap?c.Default.getImagePath(a.outsideMap):null,i={type:"path",op:"+",width:e,height:f,insideColor:a.insideColor,outsideColor:a.outsideColor,asideColor:a.asideColor,zsideColor:a.zsideColor,topColor:a.topColor,bottomColor:a.bottomColor,insideImage:a.insideImage,outsideImage:a.outsideImage,insideMap:g,outsideMap:h,repeat:a.repeat,position:a.position,data:a.data};if(d.push(i),a.children)for(var j=0;j<a.children.length;j++){a.children[j].inbuilt=!0,a.children[j].depth=e+6;var k=ka(a.children[j].position,a.data,a.position);a.children[j].rotation=[0,k,0];var l=c.Default.load(a.children[j]);d=d.concat(l)}for(var m=[],n=[],j=0;j<d.length;j++){var o=d[j];o.op?m.push(o):n.push(o)}var p=c.Default.createCombo(m);if(a.style&&p.s(a.style),p.setClient("data",a.data),p.setClient("type","inner_wall"),n.length>0)for(var j=0;j<n.length;j++){var q=n[j],r=c.Default.createCombo(q);r.setParent&&r.setParent(p)}return c.Default.setObject3dCSProps(p,a),b&&b(p),p},{category:"房间模型",type:"innerWall",name:"内墙",icon:k("innerWall.png"),description:"内墙是和外墙，地板一起使用的。用来创建3d机房的房间轮廓",sdkCategory:"floor-child",modelDefaultParameters:pa()});var qa=function(){return{data:{name:"坐标点",value:[],type:c.Default.PARAMETER_TYPE_STRING,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},wallDepth:{name:"墙面厚度",value:20,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},wallHeight:{name:"墙高度",value:261,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},insideColor:{name:"内墙颜色",value:"#62F3FF",type:c.Default.PARAMETER_TYPE_COLOR,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},outsideColor:{name:"外墙颜色",value:"#62F3FF",type:c.Default.PARAMETER_TYPE_COLOR,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},asideColor:{name:"外墙颜色",value:"#000000",type:c.Default.PARAMETER_TYPE_COLOR,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},zsideColor:{name:"外墙颜色",value:"#333333",type:c.Default.PARAMETER_TYPE_COLOR,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},topColor:{name:"顶部颜色",value:"#F7F7F7",type:c.Default.PARAMETER_TYPE_COLOR,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},bottomColor:{name:"底部颜色",value:"#D6E4EC",type:c.Default.PARAMETER_TYPE_COLOR,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},insideImage:{name:"内墙贴图",value:"glass_wall.png",type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},outsideImage:{name:"外墙贴图",value:"glass_wall.png",type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},repeat:{name:"重复高度",value:260,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},children:{name:"孩子对象",value:"",hidden:!0,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD}}};c.Default.register("twaver.idc.glassWall",function(a,b){var d=[],e=(a.client||{},a.wallDepth),f=l(a.insideImage),g=l(a.outsideImage),h={type:"path",op:"+",width:e,height:a.wallHeight,floorShadow:!0,repeat:a.repeat,position:a.position,data:a.data,insideColor:a.insideColor,outsideColor:a.outsideColor,asideColor:a.asideColor,zsideColor:a.zsideColor,topColor:a.topColor,bottomColor:a.bottomColor,insideImage:f,outsideImage:g,style:{"m.type":"phong","m.polygonOffset":!0,"m.polygonOffsetFactor":6,"m.polygonOffsetUnits":2,"m.transparent":!0,"m.specularStrength":100,"m.envmap.image":c.Default.getEnvMap("envmap2"),"m.specularmap.image":l("white.png")}};if(d.push(h),a.children)for(var i=0;i<a.children.length;i++){a.children[i].inbuilt=!0,a.children[i].depth=e+6;var j=ka(a.children[i].position,a.data,a.position);a.children[i].rotation=[0,j,0];var k=c.Default.load(a.children[i]);d=d.concat(k)}for(var m=[],n=[],i=0;i<d.length;i++){var o=d[i];o.op?m.push(o):n.push(o)}var p=c.Default.createCombo(m);if(a.style&&p.s(a.style),p.setClient("data",a.data),p.setClient("type","glass_wall"),n.length>0)for(var i=0;i<n.length;i++){var q=n[i],r=c.Default.createCombo(q);r.setParent&&r.setParent(p)}return c.Default.setObject3dCSProps(p,a),b&&b(p),p},{category:"房间模型",type:"innerWall",name:"玻璃墙",icon:k("glasswall.png"),description:"内墙是和外墙，地板一起使用的。用来创建3d机房的房间轮廓",sdkCategory:"floor-child",modelDefaultParameters:qa()});var ra=function(){var a=qa(),b={glassImage:{name:"玻璃贴图",value:"",type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},glassColor:{name:"玻璃颜色",value:"#01A9DB",type:c.Default.PARAMETER_TYPE_COLOR,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},glassOpacity:{name:"玻璃透明度",value:"0.5",type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD}};return c.Default.copyProperties(b,a),a.insideColor.value="#B8CAD5",a.outsideColor.value="#A5BDDD",a.asideColor.value="#D6E4EC",a.zsideColor.value="#D6E4EC",a.topColor.value="#D6E4EC",a.bottomColor.value="#D6E4EC",a.insideImage.value="",a.outsideImage.value="",a};c.Default.register("twaver.idc.glassWall2",function(a,b){var d=[],e=a.wallDepth,f=a.wallHeight,g=.6*f,h=a.position||[0,0,0],i={type:"path",op:"+",width:e,height:f,insideColor:a.insideColor,outsideColor:a.outsideColor,asideColor:a.asideColor,zsideColor:a.zsideColor,topColor:a.topColor,bottomColor:a.bottomColor,repeat:a.repeat,position:a.position,data:a.data,closed:a.closed};d.push(i);var j={type:"path",width:e+2,height:g,op:"-",position:[0+h[0],(f-g)/3*2+h[1],0+h[2]],insideColor:a.insideColor,outsideColor:a.outsideColor,asideColor:a.asideColor,zsideColor:a.zsideColor,topColor:a.topColor,bottomColor:a.bottomColor,data:a.data,closed:a.closed};d.push(j);var k={type:"path",width:1,height:g,op:"+",position:[0+h[0],(f-g)/3*2+h[1],0+h[2]],insideImage:a.glassImage,outsideImage:a.glassImage,topColor:a.topColor,bottomColor:"json.bottomColor",style:{"m.type":"phong","m.transparent":!0,"m.opacity":a.glassOpacity,"m.color":a.glassColor,"m.ambient":a.glassColor,"m.specularStrength":100,"m.envmap.image":c.Default.getEnvMap("envmap1"),"m.specularmap.image":c.Default.getImagePath("metal_normalmap1.jpg")},data:a.data,closed:a.closed};if(d.push(k),a.children)for(var l=0;l<a.children.length;l++){a.children[l].inbuilt=!0,a.children[l].depth=e+6;var m=ka(a.children[l].position,a.data,a.position);a.children[l].rotation=[0,m,0];var n=c.Default.load(a.children[l]);d=d.concat(n)}for(var o=[],p=[],l=0;l<d.length;l++){var q=d[l];q.op?o.push(q):p.push(q)}var r=c.Default.createCombo(o);if(a.style&&r.s(a.style),r.setClient("data",a.data),r.setClient("type","glass_wall"),p.length>0)for(var l=0;l<p.length;l++){var s=p[l],t=c.Default.createCombo(s);t.setParent&&t.setParent(r)}if(c.Default.setObject3dCSProps(r,a),a.showFloor){var h=a.position||[0,0,0],u=a.floorImage,v=a.floorId||"twaver.idc.floor",w=c.Default.load({id:v,data:a.data,image:u,position:[h[0],-1,h[2]]});w.setParent(r)}return b&&b(r),r},{category:"房间模型",type:"innerWall",name:"玻璃墙",icon:k("glasswall2.png"),description:"内墙是和外墙，地板一起使用的。用来创建3d机房的房间轮廓",sdkCategory:"floor",modelDefaultParameters:ra()});var sa=function(){var a=X(120,150,50),b={image:{name:"贴图",value:"window.png",type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},transparent:{name:"是否透明",value:!0,type:c.Default.PARAMETER_TYPE_BOOLEAN,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},glassDepth:{name:"玻璃厚度",value:4,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD}};return c.Default.copyProperties(b,a),a};c.Default.register("twaver.idc.window",function(a){var b=a.position||[0,0,0],d=b[0],e=b[1],f=b[2],g=c.Default.getRsByDs(a.rotation)||[0,0,0],h=a.width,i=a.height,j=a.depth,k=(a.client,a.glassDepth),m=5,n=45,o=10,p=l(a.image),q=(a.transparent,a.platform),r={type:"cube",width:h,height:i,depth:j,rotation:g,position:[d,e+30+i/2,f],op:"-",sideColor:"#EFEFEF",topColor:"#EFEFEF"},s={type:"cube",width:h-.5,height:i-.5,depth:k,rotation:g,position:[d,e+30+i/2,f],op:"+",style:{"m.color":"#F0F0F0","m.ambient":"#F0F0F0","m.type":"phong","m.specularStrength":.1,"m.envmap.image":c.Default.getEnvMap("envmap1"),"m.texture.repeat":new mono.Vec2(1,1),"m.texture.image":p},client:{type:"window"}};0!=a.transparent&&(s.style["front.m.transparent"]=!0,s.style["back.m.transparent"]=!0);var t=[r,s];return q&&t.push({type:"cube",width:h,height:m,depth:n,position:[d,e,f+o],rotation:g,op:"+",sideColor:"#A5BDDD",topColor:"#D6E4EC"}),a.inbuilt?t:c.Default.createCombo(t)},{category:"房间模型",type:"window",name:"窗户",icon:k("window.png"),description:"窗户一般不单独使用，是加在内墙或外墙模型上，作为这类模型的孩子对象",sdkCategory:"floor-child",modelDefaultParameters:sa()});var ta=function(){var a=X(100,180,26),b={color:{name:"颜色",value:"#9E9E9E",type:c.Default.PARAMETER_TYPE_COLOR,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},image:{name:"贴图",value:"door_right.png",type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},transparent:{name:"是否透明",value:!0,type:c.Default.PARAMETER_TYPE_BOOLEAN,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD}};return c.Default.copyProperties(b,a),a};c.Default.register("twaver.idc.door1",function(a){var d=a.position||[0,0,0],e=d[0],f=d[1],g=d[2],h=c.Default.getRsByDs(a.rotation)||[0,0,0],i=a.width,j=a.height,k=a.depth,m=10,n=2,o=l(a.image),p=!0,q=a.color,r=a.client||{};null!=a.transparent&&a.transparent!=b&&(p=a.transparent);var s=[{type:"cube",width:i,height:j,depth:k,op:"+",position:[e,f+j/2,g],rotation:h,sideColor:"#CDCDCD",topColor:"#CDCDCD",style:{"m.type":"phong","m.specularStrength":50}},{type:"cube",width:i-m,height:j-m/2-n,depth:k+2,op:"-",position:[e,f+n+j/2,g],rotation:h,sideColor:"#FEFEFE",topColor:"#CCCCCC"},{type:"cube",width:i-m-2,height:j-m/2-n-2,depth:2,position:[e,f+n+1+j/2,g],sideColor:q,topColor:q,rotation:h,style:{"top.m.polygonOffset":!0,"top.m.polygonOffsetFactor":100,"top.m.polygonOffsetUnits":20,"m.type":"phong","m.transparent":p,"front.m.texture.image":o,"back.m.texture.image":o,"front.m.texture.flipX":!0,"m.specularStrength":100,"m.envmap.image":p?c.Default.getEnvMap("envmap2"):null,"m.specularmap.image":l("white.png")},client:{animation:"rotation:left:-80:1000:0:bounceOut",type:"door",bid:r.bid}}];return a.inbuilt?s:c.Default.createCombo(s)},{category:"房间模型",type:"door",name:"单开门",icon:k("door1.png"),description:"门一般不单独使用，是加在内墙或外墙模型上，作为这类模型的孩子对象",sdkCategory:"floor-child",modelDefaultParameters:ta()});var ua=function(){var a=X(205,180,26),b={color:{name:"颜色",value:"#9E9E9E",type:c.Default.PARAMETER_TYPE_COLOR,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},leftImage:{name:"左门贴图",value:"door_left.png",type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},rightImage:{name:"右门贴图",value:"door_right.png",type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},frame:{name:"显示门框",value:!1,type:c.Default.PARAMETER_TYPE_BOOLEAN,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},acs:{name:"显示门禁",value:!1,type:c.Default.PARAMETER_TYPE_BOOLEAN,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD}};return c.Default.copyProperties(b,a),a},va=function(a){var b=a.position||[0,0,0],d=b[0],e=b[1],f=b[2],g=c.Default.getRsByDs(a.rotation)||[0,0,0],h=a.width||205,i=a.height||213,j=a.depth||26,k=10,m=5,n=a.client||{},o=a.color,p=a.acs,q=a.frame,r=l(a.leftImage),s=l(a.rightImage),t=a.envmap,u=[];return q&&u.push({type:"cube",width:h,height:i,depth:j,op:"+",position:[d,e+i/2,f],rotation:g,sideColor:"#CDCDCD",topColor:"#CDCDCD",style:{"m.type":"phong","m.specularStrength":50}}),u.push({type:"cube",width:h-k,height:i-k/2-m,depth:j+2,op:"-",position:[d,e+m+i/2,f],rotation:g,sideColor:"#FEFEFE",topColor:"#CCCCCC"}),u.push({type:"cube",width:(h-k)/2-2,height:i-k/2-m-5,depth:2,position:[d-(h-k)/4+1,e+m+1+i/2+3,f],sideColor:o,topColor:o,rotation:g,rotationAnchor:"left",style:{"m.type":"phong","m.transparent":!0,"front.m.texture.image":r,"back.m.texture.image":s,"m.specularStrength":100,"m.envmap.image":t,"m.specularmap.image":l("white.png")},client:{animation:"rotation:left:-90:1000:0:bounceOut",type:"door",bid:n.bid+"-left"}}),u.push({type:"cube",width:(h-k)/2-2,height:i-k/2-m-5,depth:2,position:[d+(h-k)/4-1,e+m+1+i/2+3,f],sideColor:o,topColor:o,rotation:g,rotationAnchor:"right",style:{"m.type":"phong","m.transparent":!0,"front.m.texture.image":s,"back.m.texture.image":r,"m.specularStrength":100,"m.envmap.image":t,"m.specularmap.image":l("white.png")},client:{animation:"rotation:right:90:1000:0:bounceOut",type:"door",bid:n.bid+"-right"}}),p&&u.push({type:"cube",width:11.6,height:11.6,depth:2,rotation:g,rotationAnchor:"left",position:[d+h/2+8,(i-k/2-m-2)/2,f+10],style:{"m.color":"#ffffff","m.ambient":"#ffffff","m.specular":"#FFFFFF","m.type":"phong","m.texture.image":l("rack_inside.png"),"front.m.texture.image":l("acs.jpg")}}),u};c.Default.register("twaver.idc.door",function(a){var b=va(a);if(a.inbuilt)return b;var d=c.Default.createCombo(b);return c.Default.setObject3dCSProps(d,a),d},{category:"房间模型",type:"door",name:"双开门",icon:k("door.png"),description:"门一般不单独使用，是加在内墙或外墙模型上，作为这类模型的孩子对象",sdkCategory:"floor-child",modelDefaultParameters:ua()});var wa=function(){return{height:{name:"高",value:5,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},color:{name:"颜色",value:"#abc",type:c.Default.PARAMETER_TYPE_COLOR,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},label:{name:"标签",value:"",type:c.Default.PARAMETER_TYPE_STRING,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},labelColor:{name:"标签颜色",value:"red",type:c.Default.PARAMETER_TYPE_COLOR,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},labelFont:{name:"标签字体",value:"bold 360px 微软雅黑,sans-serif",type:c.Default.PARAMETER_TYPE_COLOR,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},labelPositionX:{name:"标签位置X",type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},labelPositionZ:{name:"标签位置Z",type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},data:{name:"坐标点",value:[],type:c.Default.PARAMETER_TYPE_STRING,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},opacity:{name:"透明度",value:.05,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD}}};c.Default.register("twaver.idc.area",function(a,d){var e=a.height,f=a.position||[0,0,0],g=a.color,h=(a.client||{},a.label),i=a.labelPositionX,j=a.labelPositionZ,k=a.labelColor||"red",l=a.labelFont,m=a.opacity,n=c.Default.createShapeNodePath(a.data),o=new mono.ShapeNode(n);if(o.s({"m.type":"phong","m.side":"both","m.color":g,"m.ambient":g,"m.transparent":!0,"m.opacity":m}),o.setAmount(e),o.setVertical(!0),o.setClient("type","area"),o.renderDepth=-100,o.p(f[0],f[1],f[2]),h){var p=(c.Default.getPathBoundingBox(a.data).size,o.getBoundingBox()),q=p.min,r=p.max,s=c.Default.generateTextCanvas(h,k,l,!1),t=s.drawRect,u=new mono.Cube(t.width,1,t.height);u.s({"m.transparent":!1,"m.alphaTest":.5,"left.m.visible":!1,"right.m.visible":!1,"front.m.visible":!1,"back.m.visible":!1,"bottom.m.visible":!1,"top.m.texture.image":s,"m.texture.repeat":new mono.Vec2(t.width/s.width,t.height/s.height),"m.texture.offset":new mono.Vec2((s.width-t.width)/2/s.width,(s.height-t.height)/2/s.height)}),u.setSelectable(!1),(null===i||i===b)&&(i=(q.x+r.x)/2),(null===j||j===b)&&(j=(q.z+r.z)/2),u.p(i,(q.y+r.y)/2+e/2+2,j),u.setParent(o)}return c.Default.setObject3dCSProps(o,a),d&&d(o),o},{category:"房间模型",type:"area",name:"区域",icon:k("area.png"),description:"区域是加在某个房间上的。用来对房间进一步细分。可以指定区域的高度，文字，颜色等属性",sdkCategory:"room",modelDefaultParameters:wa()});var xa=function(){return{rackWidth:{name:"机柜宽度",value:60,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},rackHeight:{name:"机柜高度",value:200,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},rackDepth:{name:"机柜深度",value:80,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},rackNumber:{name:"机柜数量",value:20,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},aisleDepth:{name:"通道深度",value:140,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},windowAnimationType:{name:"天窗类型",value:2,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},doorAnimationType:{name:"门动画类型",value:2,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},isSingle:{name:"是否为单通道",value:!1,type:c.Default.PARAMETER_TYPE_BOOLEAN,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},side:{name:"单通道类型",value:"left",type:c.Default.PARAMETER_TYPE_STRING,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD}}};c.Default.register("twaver.idc.aisle1",function(a,b){a.isSingle=!0;var d=a.side||"left";return a.side=d,a.id="twaver.idc.aisle",aisle=c.Default.load(a,b),aisle},{category:"机柜模型",type:"channel",name:"单通道，由通道门和天窗组成。可以设置通道内摆放的机柜数和通道的高度",icon:k("aisle1.png"),description:"",sdkCategory:"channel",modelDefaultParameters:xa()}),c.Default.register("twaver.idc.aisle",function(a,b){var d=a.position||[0,0,0],e=d[0],f=d[1],g=d[2],h=c.Default.getRsByDs(a.rotation)||[0,0,0],i=a.axis||"x",j=a.client,k=parseFloat(a.rackNumber),m=parseFloat(a.rackWidth),n=k/2*m,o=parseFloat(a.rackHeight),p=parseFloat(a.rackDepth),q=parseFloat(a.aisleDepth),r=a.windowAnimationType,s=a.doorAnimationType,t=a.isSingle,u=a.side,v=[],w=[],x=2*p+q,y=new mono.Cube(n,o,x);y.s({"m.transparent":!0,"m.opacity":.001}),y.setPosition(0,o/2+1,0);var z=[],A=0,B=0,C=0;t&&(x=p+q/2*2-5,s=s||1,"left"==u?(A=-p/2+2.5,B=q/2-2,C=-q/4):(A=p/2-2.5,B=-q/2+2,C=q/4),v.push({type:"cube",width:n+5,height:o,depth:5,op:"+",position:[0,0,B],style:{"m.type":"phong","m.side":"both","m.color":"#62F3FF","m.ambient":"#62F3FF","m.envmap.image":c.Default.getEnvMap("envmap2"),"m.transparent":!0,"m.texture.image":l("skylight01-1.png"),"m.polygonOffset":!0,"m.polygonOffsetFactor":6,"m.polygonOffsetUnits":3}}));for(var D=-1;2>D;D+=2)v.push({type:"cube",width:n+5,height:12,depth:2,op:"+",position:[0,o/2,(q-5)/2*D],style:{"m.type":"phong","m.color":"#666666","m.ambient":"#0c0c0c","m.specular":"#e5e5e5","m.specularStrength":3}});for(var D=-1;2>D;D+=2)v.push({type:"cube",width:10,height:16,depth:x,op:"+",position:[(n/2+5)*D,o/2-3,A],style:{"m.type":"phong","m.color":"#666666","m.ambient":"#0c0c0c","m.specular":"#e5e5e5","m.specularStrength":3}});for(var D=-1;2>D;D+=2){var E="door1",F="move:front:0.8";1==s&&(F="rotation:front:-120:1000:0:bounceOut"),1==D&&(E="door2",1==s&&(F="rotation:front:120:1000:0:bounceOut")),w.push({type:"cube",width:5,height:o-5,depth:q/2,position:[n/2*D,0,q/4],style:{"m.type":"phong","m.color":"#62F3FF","m.ambient":"#62F3FF","m.envmap.image":c.Default.getEnvMap("envmap2"),"left.m.transparent":!0,"left.m.texture.image":l("right-door.png"),"right.m.transparent":!0,"right.m.texture.image":l("left-door.png")},client:{animation:F,"animation-group":E}})}for(var D=-1;2>D;D+=2){var E="door1",F="move:back:0.8";1==s&&(F="rotation:back:120:1000:0:bounceOut"),1==D&&(E="door2",1==s&&(F="rotation:back:-120:1000:0:bounceOut")),w.push({type:"cube",width:5,height:o-5,depth:q/2,position:[n/2*D,0,-q/4],style:{"m.type":"phong","m.color":"#62F3FF","m.ambient":"#62F3FF","m.envmap.image":c.Default.getEnvMap("envmap2"),"left.m.transparent":!0,"left.m.texture.image":l("left-door.png"),"right.m.transparent":!0,"right.m.texture.image":l("right-door.png")},client:{animation:F,"animation-group":E}})}var j={};2==r&&(j={animation:"rotation:center-z:90:1000:0:bounceOut","animation-group":"skylight"});for(var D=0;k/2>D;D++){var G={type:"cube",width:m,height:2,depth:q,position:[-m*k/4+m/2+D*m,o/2+6,0],style:{"m.type":"phong","m.color":"#00ECFF","m.ambient":"#00ECFF","m.envmap.image":c.Default.getEnvMap("envmap2"),"m.transparent":!0,"m.texture.image":l("skylight.png")},client:j};w.push(G)}var H=c.Default.createCombo(v);z.push(H);for(var I=c.Default.createCombo(w),D=0;D<I.length;D++)z.push(I[D]);y.setClient("real_channel",z);for(var D=0;D<z.length;D++)z[D].setParent(y);return y.p(e,0,g),c.Default.setPositionY(y,f),y.setDepth(x),y.setClient("type","aisle"),"z"===i?y.setRotation(0,Math.PI/2,0):y.setRotation(h[0],h[1],h[2]),y.getSkyLights=function(){return I},c.Default.setObject3dCSProps(y,a),b&&b(y),y},{category:"机柜模型",type:"channel",name:"通道",icon:k("channel.png"),description:"通道是机房中用于摆放机柜的节能模块，分为单通道和双通道，由通道门和天窗组成。可以设置通道内摆放的机柜数和通道的高度",sdkCategory:"channel",modelDefaultParameters:xa()}),c.Default.register("twaver.idc.simpleAisle",function(a,b){var d=a.position||[0,0,0],e=d[0],f=d[1],g=d[2],h=c.Default.getRsByDs(a.rotation)||[0,0,0],i=a.axis||"x",j=parseFloat(a.rackNumber),k=parseFloat(a.rackWidth)+1,m=j/2*k,n=parseFloat(a.rackHeight),o=parseFloat(a.rackDepth),p=parseFloat(a.aisleDepth),q=(a.windowAnimationType,a.doorAnimationType),r=a.isSingle,s=a.side||"left",t=2*o+p,u=new mono.Cube(m,n,t);u.s({"m.transparent":!0,"m.opacity":.001});var v=[],w=0,x=0,y=0;if(r){t=o+p-5,q=a.doorAnimationType||1,"left"==s?(w=-o/2+2.5,x=68,y=o/2):(w=o/2-2.5,x=-68,y=-o/2);var z=new mono.Cube(m+5,n,5);z.p(0,0,x+y),z.s({"m.type":"phong","m.side":"both","m.color":"#62F3FF","m.ambient":"#62F3FF","m.envmap.image":c.Default.getEnvMap("envmap1"),"m.transparent":!0,"m.texture.image":l("skylight01.png"),
"m.polygonOffset":!0,"m.polygonOffsetFactor":6,"m.polygonOffsetUnits":3}),v.push(z)}var A=new mono.Cube(m,n,p);A.p(0,0,y),A.s({"m.type":"phong","m.transparent":!0,"m.side":"both","front.m.opacity":0,"back.m.opacity":0,"bottom.m.opacity":0,"left.m.color":"#62F3FF","left.m.ambient":"#62F3FF","left.m.texture.image":l("door.png"),"left.m.envmap.image":c.Default.getEnvMap("envmap1"),"right.m.color":"#62F3FF","right.m.ambient":"#62F3FF","right.m.texture.image":l("door.png"),"right.m.envmap.image":c.Default.getEnvMap("envmap1"),"top.m.color":"#62F3FF","top.m.ambient":"#62F3FF","top.m.texture.image":l("skylight01.png"),"top.m.envmap.image":c.Default.getEnvMap("envmap1")}),v.push(A);for(var B=0;B<v.length;B++)v[B].setParent(u);return u.p(e,0,g),c.Default.setPositionY(u,f),u.setDepth(t),u.setClient("type","aisle"),"z"===i?u.setRotation(0,Math.PI/2,0):u.setRotation(h[0],h[1],h[2]),b&&b(u),u},{category:"机柜模型",type:"channel",name:"通道",icon:k("simpleAisle.png"),description:"同上。区别在于 简单通道只是没有细节，是用几个cube加贴图组成，通道窗户不能打开。主要用于和真实通道之间的切换。",sdkCategory:"channel",modelDefaultParameters:xa()});var ya=function(){var a=X(100,200,80),b={sideImage:{name:"侧面贴图",value:"air-condition-side.jpg",type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},frontImage:{name:"正面贴图",value:"air-condition-front.jpg",type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},backImage:{name:"正面贴图",value:"air-condition-side.jpg",type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},topImage:{name:"顶部贴图",value:"air-condition-top.jpg",type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD}};return c.Default.copyProperties(b,a),a};c.Default.register("twaver.idc.airCondition",function(a,b){var d=a.position||[0,0,0],e=d[0],f=d[1],g=d[2],h=a.width,i=a.height,j=a.depth,k=l(a.sideImage),m=l(a.topImage),n=l(a.frontImage),o=c.Default.getRsByDs(a.rotation)||[0,0,0],p=new mono.Cube(h,i,j);return p.s({"m.type":"phong","m.color":"#557E7A","m.specular":"#ffffff","m.specularStrength":3,"m.specularmap.image":c.Default.getImagePath("outside_lightmap.jpg"),"m.texture.image":k,"front.m.texture.image":n,"top.m.texture.image":m,"front.m.envmap.image":c.Default.getEnvMap("envmap1"),"m.reflectRatio":.2}),p.setPosition(e,0,g),p.setRotation(o[0],o[1],o[2]),c.Default.setPositionY(p,f),c.Default.setObject3dCSProps(p,a),p.setClient("type","airCondition"),p.setClient("showShadow",!0),b&&b(p),p},{name:"空调",description:"精密空调是机房中用于散热，排风的模块，保证机房的恒温恒湿。支持修改长，宽，高基本参数",icon:k("airCondition.png"),category:"机柜模型",type:"airCondition",modelDefaultParameters:ya()}),c.Default.register("twaver.idc.airCondition1",function(a,b){var d,e=a.position||[0,0,0],f=e[0],g=e[1],h=e[2],i=a.width,j=a.height,k=a.depth,m=c.Default.getRsByDs(a.rotation)||[0,0,0],n=a.color||"#FFFFFF";return d=a.objectId?new mono.Cube({id:a.objectId,width:i,height:j,depth:k}):new mono.Cube(i,j,k),d.s({"m.type":"phong","m.color":n,"m.ambient":n,"m.texture.image":l("air-condition1-side.jpg"),"front.m.texture.image":l("air-condition1-front.jpg"),"back.m.texture.image":l("air-condition1-back.jpg"),"top.m.texture.image":l("air-condition1-top.jpg"),"front.m.envmap.image":c.Default.getEnvMap("envmap1"),"m.reflectRatio":.5}),d.p(f,0,h),d.setRotation(m[0],m[1],m[2]),c.Default.setPositionY(d,g),d.setClient("type","airCondition"),d.setClient("showShadow",!0),c.Default.setObject3dCSProps(d,a),b&&b(d),d},{name:"空调",description:"精密空调是机房中用于散热，排风的模块，保证机房的恒温恒湿。支持修改长，宽，高基本参数",icon:k("airCondition1.png"),category:"机柜模型",type:"airCondition",modelDefaultParameters:X(188,174,75)}),c.Default.register("twaver.idc.airCondition2",function(a,b){return a.id="twaver.idc.airCondition1",a.color="#A4F4EC",c.Default.load(a,b)},{name:"空调",description:"精密空调是机房中用于散热，排风的模块，保证机房的恒温恒湿。支持修改长，宽，高基本参数",icon:k("airCondition2.png"),category:"机柜模型",type:"airCondition",modelDefaultParameters:X(188,174,75)}),c.Default.register("twaver.idc.switchgear",function(a,b){var d,e=a.position||[0,0,0],f=e[0],g=e[1],h=e[2],i=a.width,j=a.height,k=a.depth,m=c.Default.getRsByDs(a.rotation)||[0,0,0];return d=a.objectId?new mono.Cube({id:a.objectId,width:i,height:j,depth:k}):new mono.Cube(i,j,k),d.s({"m.type":"phong","m.texture.image":l("switch_wrap.jpg"),"m.envmap.image":c.Default.getEnvMap("envmap1"),"m.reflectRatio":.2}),d.setWrapMode("six-each"),d.p(f,0,h),d.setRotation(m[0],m[1],m[2]),c.Default.setPositionY(d,g),d.setClient("type","switchgear"),d.setClient("showShadow",!0),c.Default.setObject3dCSProps(d,a),b&&b(d),d},{name:"开关柜",description:"机房常见设备之一，开关柜支持修改长，宽，高等基本参数。",icon:k("switchgear.png"),category:"机柜模型",type:"switchgear",modelDefaultParameters:X(60,180,37)}),c.Default.register("twaver.idc.pdc",function(a,b){var d,e=a.position||[0,0,0],f=e[0],g=e[1],h=e[2],i=a.width,j=a.height,k=a.depth,m=c.Default.getRsByDs(a.rotation)||[0,0,0];return d=a.objectId?new mono.Cube({id:a.objectId,width:i,height:j,depth:k}):new mono.Cube(i,j,k),d.s({"m.type":"phong","m.texture.image":l("pdc_wrap.jpg"),"m.envmap.image":c.Default.getEnvMap("envmap1"),"m.reflectRatio":.2}),d.setWrapMode("six-each"),d.p(f,0,h),d.setRotation(m[0],m[1],m[2]),c.Default.setPositionY(d,g),d.setClient("type","pdc"),d.setClient("showShadow",!0),c.Default.setObject3dCSProps(d,a),b&&b(d),d},{name:"配电柜",description:"机房常见设备之一，配电柜支持修改长，宽，高等基本参数。",icon:k("pdc.png"),category:"机柜模型",type:"pdc",modelDefaultParameters:X(80,180,37)}),c.Default.register("twaver.idc.ups",function(a,b){var d=a.position||[0,0,0],e=d[0],f=d[1],g=d[2],h=a.width,i=a.height,j=a.depth,k=c.Default.getRsByDs(a.rotation)||[0,0,0],m=new mono.Cube(h,i,j);return m.s({"m.type":"phong","m.specular":"#ffffff","m.specularStrength":3,"m.specularmap.image":c.Default.getImagePath("outside_lightmap.jpg"),"m.texture.image":l("ups-side.jpg"),"top.m.texture.image":l("ups-top.jpg"),"front.m.texture.image":l("ups-front.jpg"),"front.m.envmap.image":c.Default.getEnvMap("envmap1"),"m.reflectRatio":.2}),m.setPosition(e,0,g),c.Default.setPositionY(m,f),m.setRotation(k[0],k[1],k[2]),m.setClient("showShadow",!0),c.Default.setObject3dCSProps(m,a),b&&b(m),m},{name:"UPS",description:"用于给单台计算机、计算机网络系统或其它垫子设备如电磁阀、压力变送器等提供稳定、不间断的电力供应，保证机房在突发情况下也能正常运转",icon:k("ups.png"),category:"机柜模型",type:"ups",modelDefaultParameters:X(80,200,60)}),c.Default.register("twaver.idc.ups1",function(a,b){var d=a.position||[0,0,0],e=d[0],f=d[1],g=d[2],h=a.width,i=a.height,j=a.depth,k=c.Default.getRsByDs(a.rotation)||[0,0,0],m=new mono.Cube(h,i,j);return m.s({"m.type":"phong","m.texture.image":l("ups_wrap.jpg"),"m.envmap.image":c.Default.getEnvMap("envmap1"),"m.reflectRatio":.2}),m.setWrapMode("six-each"),m.p(e,0,g),m.setRotation(k[0],k[1],k[2]),c.Default.setPositionY(m,f),m.setClient("type","ups"),m.setClient("showShadow",!0),c.Default.setObject3dCSProps(m,a),b&&b(m),m},{name:"UPS",description:"用于给单台计算机、计算机网络系统或其它垫子设备如电磁阀、压力变送器等提供稳定、不间断的电力供应，保证机房在突发情况下也能正常运转",icon:k("ups1.png"),category:"机柜模型",type:"ups",modelDefaultParameters:X(80,200,60)}),c.Default.register("twaver.idc.battery",function(a,b){var d=a.position||[0,0,0],e=d[0],f=d[1],g=d[2],h=a.width,i=a.height,j=a.depth,k=c.Default.getRsByDs(a.rotation)||[0,0,0],m=new mono.Cube(h,i,j);return m.s({"m.type":"phong","m.specular":"#ffffff","m.specularStrength":3,"m.transparent":!0,"m.specularmap.image":c.Default.getImagePath("outside_lightmap.jpg"),"m.texture.image":l("battery-side.png"),"front.m.texture.image":l("battery-front.png"),"back.m.texture.image":l("battery-front.png"),"top.m.texture.image":l("battery-top.jpg"),"front.m.envmap.image":c.Default.getEnvMap("envmap1"),"m.reflectRatio":.2}),m.setRotation(k[0],k[1],k[2]),m.setPosition(e,0,g),m.setClient("showShadow",!0),c.Default.setPositionY(m,f),c.Default.setObject3dCSProps(m,a),b&&b(m),m},{name:"蓄电池",description:"机房蓄电池用于给UPS或其他设备不间断供电，保证机房的稳定运行",icon:k("battery.png"),category:"机柜模型",type:"battery",modelDefaultParameters:X(150,80,60)}),c.Default.register("twaver.idc.alternator",function(a,b){var d=a.position||[0,0,0],e=d[0],f=d[1],g=d[2],h=a.width,i=a.height,j=a.depth,k=new mono.Cube(h,i,j);return k.s({"m.type":"phong","m.specular":"#ffffff","m.specularStrength":3,"m.specularmap.image":c.Default.getImagePath("outside_lightmap.jpg"),"m.texture.image":l("alternator-side.jpg"),"front.m.texture.image":l("alternator-front.jpg"),"back.m.texture.image":l("alternator-front.jpg"),"top.m.texture.image":l("alternator-top.jpg"),"bottom.m.texture.image":l("alternator-top.jpg")}),k.setPosition(e,0,g),c.Default.setPositionY(k,f),k.setClient("showShadow",!0),c.Default.setObject3dCSProps(k,a),b&&b(k),k},{name:"发电机",description:"发电机也是保证机房正常工作的设备之一，在电停的时候发电机自动启动，电来时候，自动停止工作",icon:k("alternator.png"),category:"机柜模型",type:"alternator",modelDefaultParameters:X(200,107,85)}),c.Default.register("twaver.idc.camera",function(a,b){var d=a.position||[0,0,0],e=c.Default.getRsByDs(a.rotation)||[0,0,0],f=d[0],g=d[1],h=d[2],i=new mono.Cylinder(8,8,30);i.s({"m.type":"phong","m.texture.image":l("bbb.png"),"top.m.texture.image":l("camera.png"),"bottom.m.texture.image":l("eee.png")}),i.setRotationX(Math.PI/3*2);var j=new mono.Cylinder(12,12,40),k=new mono.Cylinder(10,10,40),m=new mono.Cube(20,40,20),n=new mono.ComboNode([j,m,k],["+","-"]);n.s({"m.type":"phong","m.color":"#333","m.ambient":"#333"}),n.setRotationX(Math.PI/3*2);var o=new mono.Path;o.moveTo(0,0,0),o.lineTo(0,-20,0),o.lineTo(0,-22,-1),o.lineTo(0,-24,-24),o.lineTo(0,-24,-40);var p=new mono.PathNode(o,10,4,10,"round","round");p.s({"m.type":"phong","m.color":"#333","m.ambient":"#333"});var q=new mono.ComboNode([i,n,p],["+","+"]);return q.p(f,g,h),q.setRotation(e[0],e[1],e[2]),b&&b(q),q},{name:"摄像头",description:"机房摄像头，这种类型的摄像头只在某个固定的角度监控视频。支持修改旋转角度",icon:k("camera.png"),category:"动环模型",type:"camera",modelDefaultParameters:W()}),c.Default.register("twaver.idc.camera1",function(a,b){var d=a.position||[0,0,0],e=c.Default.getRsByDs(a.rotation)||[0,0,0],f=d[0],g=d[1],h=d[2],i=new mono.Sphere(10);i.s({"m.type":"phong","m.color":"#ADADAD","m.ambient":"#ADADAD","m.envmap.image":c.Default.getEnvMap("envmap1")});var j=new mono.Path;j.moveTo(0,0),j.lineTo(0,8);var k=new mono.PathNode(j,20,3,20,"plain","round");k.s({"m.type":"phong","m.color":"#DFDAD0","m.ambient":"#DFDAD0"}),k.setPositionY(12),k.setParent(i),j=new mono.Path,j.moveTo(0,0),j.lineTo(0,.5);var l=new mono.PathNode(j,20,12,20,"plain","round");l.s({"m.type":"phong","m.color":"#DFDAD0","m.ambient":"#DFDAD0","m.specularStrength":20}),l.setScaleY(1.7),l.setParent(i);var j=new mono.Path;j.moveTo(0,0,0),j.lineTo(0,14,0),j.curveTo(0,15,0,-1,15,0),j.lineTo(-10,15,0),j.curveTo(-12,15,0,-15,13,0);var m=new mono.PathNode(j,10,2,10,"plain","plain");return m.s({"m.type":"phong","m.color":"#DFDAD0","m.ambient":"#DFDAD0"}),m.setPosition(0,12,0),m.setParent(i),i.setPosition(f,g,h),i.setRotation(e[0],e[1],e[2]),b&&b(i),i},{name:"摄像头1",description:"360度无死角摄像头，这种类型的摄像头监控的范围更广一些",icon:k("camera1.png"),category:"动环模型",type:"camera",modelDefaultParameters:W()}),c.Default.register("twaver.idc.ACS",function(a,b){var d=a.position||[0,0,0],e=d[0],f=d[1],g=d[2],h=a.width,i=a.height,j=a.depth,k=(c.Default.getRsByDs(a.rotation)||[0,0,0],c.Default.createCombo({type:"cube",width:h,height:i,depth:j,position:[e,f,g],style:{"m.color":"#ffffff","m.ambient":"#ffffff","m.specular":"#FFFFFF","m.type":"phong","m.texture.image":l("rack_inside.png"),"front.m.texture.image":l("acs.jpg")}}));return b&&b(k),k},{name:"门禁",description:"门禁一般不单独创建，是和门一起使用的，放在门边上的一种控制系统",icon:k("acs.png"),category:"房间模型",type:"acs",modelDefaultParameters:X(11.6,11.6,2)}),c.Default.register("twaver.idc.watercable",function(a,b){var d=a.position||[0,0,0],e=a.color||"#B45F04",f={type:"pathNode",data:a.data,radius:100,repeat:25,pathImage:l("flow.jpg"),style:{"m.type":"phong","m.specularStrength":50,"m.color":e,"m.ambient":e},client:{type:"cable"}},g=c.Default.createCombo(f);return g.setStartCap("plain"),g.setEndCap("plain"),g.setPosition(d[0],d[1],d[2]),g.setClient("showShadow",!0),b&&b(g),g},{name:"水浸线",description:"水浸线描述",icon:k("cable.png"),category:"动环模型",type:"watercable",modelDefaultParameters:{color:{name:"颜色",value:"white",type:c.Default.PARAMETER_TYPE_COLOR,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},data:{name:"点位置",value:"",type:c.Default.PARAMETER_TYPE_ARRAY_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD}}}),c.Default.registerObj("twaver.idc.yangan","yangan","./model/idc/obj/",{name:"烟感",description:"烟感描述",icon:k("yangan.png"),category:"动环模型",type:"yangan",modelDefaultParameters:{}},!0),c.Default.registerObj("twaver.idc.changuanqi","wendu","./model/idc/obj/",{name:"传感器",description:"传感器描述",icon:k("changuanqi.png"),category:"动环模型",type:"changuanqi",modelDefaultParameters:{}},!0),c.Default.registerObj("twaver.idc.shuangjian","shuangjian","./model/idc/obj/",{name:"双涧",description:"双涧描述",icon:k("shuangjian.png"),category:"动环模型",type:"shuangjian",modelDefaultParameters:{}},!0),c.Default.registerObj("twaver.idc.shuijin","shuijin","./model/idc/obj/",{name:"水浸",description:"水浸描述",icon:k("shuijin.png"),category:"动环模型",type:"generator",modelDefaultParameters:{}},!0),c.Default.registerObj("twaver.idc.generator","fadianji1","./model/idc/obj/",{name:"发电机",description:"发电机描述",icon:k("generator.png"),category:"动环模型",type:"generator",modelDefaultParameters:{}},!0),c.Default.registerObj("twaver.idc.fire","miehuoqi","./model/idc/obj/",{name:"灭火器",description:"灭火器描述",icon:k("fire.png"),category:"动环模型",type:"fire",modelDefaultParameters:{}},!0,1),c.Default.registerObj("twaver.idc.fireExtinguisher","miehuosystem","./model/idc/obj/",{name:"灭火器组",description:"灭火器组描述",icon:k("fireBox.png"),category:"动环模型",type:"fireExtinguisher",modelDefaultParameters:{}},!0),c.Default.registerObj("twaver.idc.dianchizu","dianchizu","./model/idc/obj/",{name:"电池组",description:"电池组箱描述",icon:k("dianchizu.png"),category:"动环模型",type:"dianchizu",modelDefaultParameters:{}},!0),c.Default.registerObj("twaver.idc.worker","worker","./model/idc/obj/",{name:"工人",description:"工人描述",icon:k("worker.png"),category:"动环模型",type:"worker",modelDefaultParameters:{}},!1),c.Default.registerObj("twaver.idc.ren","ren","./model/idc/obj/",{name:"人",description:"人描述",icon:k("ren.png"),category:"动环模型",type:"ren",modelDefaultParameters:{}},!1),c.Default.register("twaver.idc.plant",function(a,b){var d,e=a.scale||[2,2,2],f=e[0],g=e[1],h=e[2],i=a.position||[0,0,0],j=i[0],k=i[1],m=i[2];if(this._plantInstance)d=this._plantInstance.clone();else{var n=a.width,o=a.height,p=l(a.picture),q=[],r=new mono.Cylinder(.5*n,.4*n,2*o,20,1,!1,!1);r.s({"m.type":"phong","m.color":"#ADADAD","m.ambient":"#ADADAD","m.texture.repeat":new mono.Vec2(10,4),"m.specularmap.image":c.Default.getImagePath("metal_normalmap.jpg"),"m.normalmap.image":c.Default.getImagePath("metal_normalmap.jpg")});var s=r.clone();s.setScale(.9,1,.9);var t=s.clone();t.setScale(.9,.9,.9),t.s({"m.type":"phong","m.color":"#163511","m.ambient":"#163511","m.texture.repeat":new mono.Vec2(10,4)});var u=new mono.ComboNode([r,s,t],["-","+"]);q.push(u);for(var v=5,w=0;v>w;w++){var d=new mono.Cube(2*n,o+20,.01);d.s({"m.transparent":!0,"front.m.visible":!0,"front.m.texture.image":p,"back.m.visible":!0,"back.m.texture.image":p}),d.setSelectable(!1),d.setEditable(!1),d.setParent(u),d.setPositionY(r.getHeight()/2+d.getHeight()/2-20),d.setRotationY(Math.PI*w/v),q.push(d)}this._plantInstance=new mono.ComboNode(q),this._plantInstance.setClient("plant.original.y",r.getHeight()/2+r.getHeight()/4*Math.min(f,h)),this._plantInstance.setClient("showShadow",!0),this._plantInstance.setClient("shadowType",1),this._plantInstance.setClient("shadowRadius",.4*n),d=this._plantInstance}return d.setPosition(j,d.getClient("plant.original.y")+k,m),d.setScale(f,g,h),d},{name:"植物",description:"植物描述",icon:k("plant.png"),category:"动环模型",type:"plant",modelDefaultParameters:{width:{name:"宽",value:30,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},height:{name:"高",value:30,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},picture:{name:"贴图",value:"plant.png",type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD}}});for(var za=function(a){return c.Default.path+"model/idc/icons/device/"+a+"_front.png"},Aa=function(a){return c.Default.path+"model/idc/images/device/"+a},Ba=function(a,b,d){b.height;c.Default.copy("twaver.idc."+a+".device","twaver.idc.equipment",function(a){a.frontImage=Aa(a.frontImage)},Ca(a,b,d))},Ca=function(a,b,c){var d=b.height,e={name:a,type:"device",category:"设备模型",modelDefaultParameters:ea(d,a+"_front.jpg"),icon:za(a),description:b.description,subType:c};return e},S=["server","network"],v=0;v<S.length;v++){var T=S[v],U="devicePanel_"+T,V=c.Default[U];for(var I in V)Ba(I,V[I],T)}c.Default.register("twaver.idc.tv",function(a,b){var d=a.position||[0,0,0],e=d[0],f=d[1],g=d[2],h=4,i=2,j=l(a.image),k=a.rotate||[0,0,0],m=[{type:"cube",width:150,height:80,depth:5,translate:[e,f,g],rotate:k,op:"+",style:{"m.type":"phong","m.color":"#2D2F31","m.ambient":"#2D2F31","m.normalmap.image":c.Default.getImagePath("metal_normalmap.jpg"),"m.texture.repeat":new mono.Vec2(10,6),"m.specularStrength":20}},{type:"cube",width:130,height:75,depth:5,translate:[e,f+i,g+h],rotate:k,op:"-",style:{"m.type":"phong","m.color":"#2D2F31","m.ambient":"#2D2F31","m.normalmap.image":c.Default.getImagePath("metal_normalmap.jpg"),"m.texture.repeat":new mono.Vec2(10,6),"m.specularStrength":100}},{type:"cube",width:130,height:75,depth:1,translate:[e,f+i,g+1.6],rotate:k,op:"+",style:{"m.type":"phong","m.specularStrength":200,"front.m.texture.image":j}}],n=c.Default.createCombo(m);return n.setClient("type","tv"),n},{name:"电视",description:"电视描述",icon:k("tv.png"),category:"动环模型",type:"tv",modelDefaultParameters:{width:{name:"宽",value:130,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},height:{name:"高",value:75,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},image:{name:"贴图",value:"tv.jpg",type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD}}}),c.Default.register("twaver.idc.post",function(a,b){var c=a.position||[0,0,0],d=c[0],e=c[1],f=c[2],g=a.width,h=a.height,i=l(a.image),j=new mono.Cube(g,h,0);return j.s({"m.visible":!1}),j.s({"m.texture.image":i,"front.m.visible":!0}),j.setPosition(d,e,f),j.setClient("type","post"),j},{name:"刷卡机",description:"刷卡机描述",icon:k("post.png"),category:"动环模型",type:"post",modelDefaultParameters:{width:{name:"宽",value:70,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},height:{name:"高",value:120,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},image:{name:"贴图",value:"post.jpg",type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD}}}),c.Default.register("twaver.idc.door_control",function(a){var b=a.width,c=a.height,d=a.depth,e=new mono.Cube(b,c,d),f=l(a.image);return e.s({"left.m.visible":!1,"right.m.visible":!1,"top.m.visible":!1,"bottom.m.visible":!1,"m.specularStrength":50,"front.m.texture.image":f,"back.m.texture.image":f}),e.setClient("type","door_control"),e},{name:"控制门",description:"控制门描述",icon:k("door_control.png"),category:"动环模型",type:"control",modelDefaultParameters:{width:{name:"宽",value:10,type:"number",propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},height:{name:"高",value:20,type:"string",propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},depth:{name:"深",value:1,type:"number",propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},image:{name:"贴图",value:"lock.png",type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD}}}),c.Default.register("twaver.idc.pipeline",function(a){var b=a.color,c=a.radius,d=l(a.image),e=new mono.Path;e.moveTo(-100,0,0),e.lineTo(100,0,0);var f=new mono.PathNode({radius:c,path:e});return f._autoAdjust=!0,f.s({"m.type":"phong","m.color":b,"m.ambient":b}),d&&f.s({"m.texture.image":d,"m.texture.repeat":new mono.Vec2(100,1)}),f},{category:"动环模型",type:"mono.Element",icon:k("pipeline.png"),modelDefaultParameters:{color:{name:"颜色",value:"cyan",type:c.Default.PARAMETER_TYPE_STRING,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},radius:{value:2,name:"半径",type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},image:{name:"贴图",value:"flow.jpg",type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD}}}),c.Default.register("twaver.idc.water_leaking_sign",function(a){var b=a.radius;image=l(a.image);var d=new mono.Billboard;d.s({"m.texture.image":image,"m.vertical":!0}),d.setScale(80,160,1),d.setPosition(0,90,0);var e=new mono.Sphere(b);e.s({"m.transparent":!0,"m.opacity":.8,"m.type":"phong","m.color":"#58FAD0","m.ambient":"#81BEF7","m.specularStrength":50,"m.normalmap.image":c.Default.getImagePath("metal_normalmap2.jpg")}),e.setScale(1,.1,.7);var f=new mono.Cube(.1,.1,.1);return d.setParent(f),e.setParent(f),f},{category:"动环模型",type:"mono.Element",icon:k("sign.png"),modelDefaultParameters:{radius:{value:30,name:"半径",type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},image:{name:"贴图",value:"alert.png",type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD}}});var Da=function(){var a=na();return a.wallHeight.value=310,a.insideImage.value="wall.jpg",a.outsideImage.value="",a.outsideColor.value="#A9B1BB",a.outsideMap.value="",a.repeat.value=310,a};c.Default.copy("twaver.idc.wall5","twaver.idc.wall",null,{modelDefaultParameters:Da(),icon:k("wall5.png")});var Ea=function(){var a=pa();return a.wallHeight.value=300,a};c.Default.copy("twaver.idc.innerWall2","twaver.idc.innerWall",null,{description:"同上，高度为300的内墙",modelDefaultParameters:Ea()});var Fa=function(){var a=qa();return a.wallHeight.value=300,a.wallDepth.value=15,a.topColor.value="#E3E3E3",a.repeat.value=300,a};c.Default.copy("twaver.idc.glassWall1","twaver.idc.glassWall",function(a,b){a.insideImage=l("glass.png"),a.outsideImage=l("glass.png")},{icon:k("glasswall1.png"),modelDefaultParameters:Fa()});var Ga=function(){var a=ra();return a.wallDepth.value=15,a.insideColor.value="#bababa",a.outsideColor.value="#bababa",a.topColor.value="#E3E3E3",a.bottomColor.value="#8F8F8F",a.glassColor.value="#FFF",a};c.Default.copy("twaver.idc.glassWall3","twaver.idc.glassWall2",function(a,b){a.glassImage=l("glass.png")},{icon:k("glasswall3.png"),modelDefaultParameters:Ga()}),c.Default.copy("twaver.idc.column1","twaver.idc.column",function(a,b){a.height=300}),c.Default.copy("twaver.idc.column2","twaver.idc.column",function(a,b){a.height=310,a.color="#777",a.topColor="#aaa"},{icon:k("column2.png")}),c.Default.copy("twaver.idc.door2","twaver.idc.door1",function(a,b){a.width=120,a.transparent=!1,a.image=l("door1.png")},{icon:k("door2.png")}),c.Default.copy("twaver.idc.headerRack1","twaver.idc.headerRack",function(a){a.sideImage=l("h1srack.jpg"),a.topImage=l("h1track.jpg"),a.frontImage=l("h1frack.jpg"),a.backImage=l("h1brack.jpg")},{icon:k("headerRack1.png")}),c.Default.copy("twaver.idc.headerRack2","twaver.idc.headerRack",function(a,b){a.sideImage=l("h2srack.jpg"),a.topImage=l("h2track.jpg"),a.frontImage=l("h2frack.jpg"),a.backImage=l("h2brack.jpg")},{icon:k("headerRack2.png")}),c.Default.copy("twaver.idc.headerRack3","twaver.idc.headerRack",function(a,b){a.sideImage=l("h3srack.jpg"),a.topImage=l("h3track.jpg"),a.frontImage=l("h3frack.jpg"),a.backImage=l("h3brack.jpg")},{icon:k("headerRack3.png")}),c.Default.copy("twaver.idc.rack2","twaver.idc.rack",function(a,b){var c={42:"r1frack42.png",43:"r1frack43.png",44:"r1frack44.png",45:"r1frack45.png",46:"r1frack46.png",47:"r1frack47.png"};a.backImage=l("r1brack.jpg"),a.sideImage=l("r1srack.jpg"),a.topImage=l("r1track.jpg");var d=c[a.height&&parseInt(a.height)]||c[42];a.frontImage=l(d),a.fontDoorImage=l("r1frack.jpg"),a.backDoorImage=l("r1brack.jpg")},{icon:k("simpleRack2.png")}),c.Default.copy("twaver.idc.simpleRack2","twaver.idc.simpleRack",function(a,b){a.image=l("srack.jpg")},{icon:k("simpleRack2.png")});for(var E=42;47>=E;E++)c.Default.copy("twaver.idc.rack2-"+E,"twaver.idc.rack2",{height:E}),c.Default.copy("twaver.idc.simpleRack2-"+E,"twaver.idc.simpleRack2",{height:E});c.Default.copy("twaver.idc.rack3","twaver.idc.rack",function(a,b){a.backImage=l("back.jpg"),a.sideImage=l("side.jpg"),a.topImage=l("top.jpg"),a.fontDoorImage=l("front.jpg"),a.backDoorImage=l("dback.jpg"),a.frontImage=l("frack.png"),a.reflectRatio=.5},{icon:k("rack3.png")}),c.Default.copy("twaver.idc.simpleRack3","twaver.idc.simpleRack",function(a,b){a.image=l("srack-2.jpg")},{icon:k("rack3.png")}),c.Default.copy("twaver.idc.innerWall3","twaver.idc.innerWall",function(a,b){a.insideColor="#abacb0",a.outsideColor="#abacb0"},{icon:k("innerWall3.png")}),c.Default.copy("twaver.idc.airCondition3","twaver.idc.airCondition",function(a,b){a.sideImage=l("a1sair.jpg"),a.frontImage=l("a1fair.jpg"),a.backImage=l("a1bair.jpg"),a.topImage=l("a1tair.jpg")},{icon:k("airCondition3.png")}),c.Default.copy("twaver.idc.headerRack4","twaver.idc.headerRack",function(a,b){a.id="twaver.idc.headerRack",a.sideImage=l("h1shead.jpg"),a.frontImage=l("h1fhead.jpg"),a.backImage=l("h1bhead.jpg"),a.topImage=l("h1thead.jpg")},{icon:k("headerRack4.png")}),c.Default.registerObj("twaver.idc.jiankongshi","jiankongshi","./model/idc/obj/jiankongshi/",{},!0),c.Default.register("twaver.idc.bigScreen",function(a,b){var c=a.position||[0,0,0],d=(c[0],c[1],c[2],l(a.image)),e=(a.rotation||[0,0,0],a.width),f=a.height,g=a.depth,h=new mono.Cube(e,f,g);return h.s({"m.type":"phong","front.m.texture.image":d}),h},{category:"动环模型",type:"mono.Element",icon:k("bigScreen.png"),modelDefaultParameters:{width:{type:"number",value:700,name:"宽"},height:{type:"number",value:200,name:"高"},depth:{type:"number",value:10,name:"深"},image:{type:"image",value:"screen.jpg",name:"image"}}}),c.Default.registerObj("twaver.idc.bigScreen2","pingmu","./model/idc/obj/pingmu/",{category:"动环模型",type:"mono.Element",icon:k("bigScreen2.png")}),c.Default.register("twaver.idc.postFlag",function(a){var b=a.color||"#094bc7",d=[{type:"cube",width:5,height:300,depth:5,op:"+",position:[0,0,0],style:{"m.type":"phong","m.specularStrength":50,"m.color":b,"m.ambient":b}},{type:"cube",width:150,height:100,depth:2,op:"+",position:[75,100,0],style:{"m.type":"phong","m.specularStrength":50,"m.color":b,"m.ambient":b,"front.m.texture.image":l("postPeople.png"),"back.m.texture.image":l("postPeople.png")}}];return c.Default.createCombo(d)},{category:"动环模型",type:"post",name:"岗位旗",icon:k("postFlag.png"),description:"岗位旗",sdkCategory:"post"});var Ha=function(a){return a.indexOf("/")>0?a:c.Default.path+"model/meeting/icons/"+a},Ia=function(a){return a=a||{},{bid:{name:"业务ID",value:b,type:c.Default.PARAMETER_TYPE_STRING,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_CLIENT},x:{name:"X轴位置",value:0,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_ACCESSOR,exportable:!1},y:{name:"Z轴位置",value:0,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_ACCESSOR,exportable:!1},angle:{name:"Y轴旋转",value:0,type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_ACCESSOR,exportable:!1}}};c.Default.register("twaver.meeting.table1.top",function(a){var b={width:500,depth:180,client:{type:"model"}};c.Default.copyProperties(a,b);var d=c.Default.createNode(b);return d},{name:"桌子",description:"桌子说明",icon:Ha("table1.png"),category:"meeting",modelDefaultParameters:Ia()}),c.Default.register("twaver.meeting.chair2.top",function(a){var b={width:62,depth:78,client:{type:"model"}};c.Default.copyProperties(a,b);var d=c.Default.createNode(b);return d},{name:"椅子",description:"椅子说明",icon:Ha("chair2.png"),category:"meeting",modelDefaultParameters:Ia({width:62,depth:78})});var Ja=function(a,b){return function(d){var e={width:a,depth:b,client:{type:"model"}};c.Default.copyProperties(d,e);var f=c.Default.createNode(e);return f}};c.Default.register("twaver.meeting.table.top",Ja(155,360),{name:"桌子",description:"桌子说明",icon:Ha("table.png"),category:"meeting",modelDefaultParameters:Ia({width:62,depth:78})}),c.Default.register("twaver.meeting.officeTable1.top",Ja(185,184),{name:"办公桌1",description:"办公桌1说明",icon:Ha("officeTable1.png"),category:"meeting",modelDefaultParameters:Ia({width:62,depth:78})}),c.Default.register("twaver.meeting.officeTable2.top",Ja(134,122),{name:"办公桌2",description:"办公桌2说明",icon:Ha("officeTable2.png"),category:"meeting",modelDefaultParameters:Ia({width:62,depth:78})}),c.Default.register("twaver.meeting.boardroomTable1.top",Ja(421,742),{name:"董事会桌1",description:"董事会桌1说明",icon:Ha("boardroomTable1.png"),category:"meeting",modelDefaultParameters:Ia({width:62,depth:78})}),c.Default.register("twaver.meeting.boardroomTable2.top",Ja(373,784),{name:"董事会桌2",description:"董事会桌2说明",icon:Ha("boardroomTable2.png"),category:"meeting",modelDefaultParameters:Ia({width:62,depth:78})}),c.Default.register("twaver.meeting.boardroomTable3.top",Ja(242,388),{name:"董事会桌3",description:"董事会桌3说明",icon:Ha("boardroomTable3.png"),category:"meeting",modelDefaultParameters:Ia({width:62,depth:78})}),c.Default.register("twaver.meeting.boardroomTable4.top",Ja(220,541),{name:"董事会桌4",description:"董事会桌4说明",icon:Ha("boardroomTable4.png"),category:"meeting",modelDefaultParameters:Ia({width:62,depth:78})}),c.Default.register("twaver.meeting.receptionDesk.top",Ja(173,584),{name:"接待桌",description:"接待桌说明",icon:Ha("receptionDesk.png"),category:"meeting",modelDefaultParameters:Ia({width:62,depth:78})}),c.Default.register("twaver.meeting.wardrobe.top",Ja(180,62),{name:"衣柜",description:"衣柜说明",icon:Ha("wardrobe.png"),category:"meeting",modelDefaultParameters:Ia({width:62,depth:78})});var Ha=function(a){return a.indexOf("/")>0?a:c.Default.path+"model/meeting/icons/"+a};c.Default.registerObj("twaver.meeting.table1","zhuozi001","./model/meeting/obj/zhuozi001/",{name:"桌子",description:"桌子描述",icon:Ha("table1.png"),category:"办公模型",type:"mono.Element",modelDefaultParameters:{}},!0),c.Default.registerObj("twaver.meeting.chair1","yizi002","./model/meeting/obj/yizi002/",{name:"椅子1",description:"椅子描述",icon:Ha("chair1.png"),category:"办公模型",type:"mono.Element",modelDefaultParameters:{}}),c.Default.registerObj("twaver.meeting.chair2","yizi001","./model/meeting/obj/yizi001/",{name:"椅子2",description:"椅子描述",icon:Ha("chair2.png"),category:"办公模型",type:"mono.Element",modelDefaultParameters:{}},!0),c.Default.registerObj("twaver.meeting.table","jk","./model/meeting/obj/jiankongshi/",{name:"监控桌",description:"监控桌描述",icon:Ha("table.png"),category:"办公模型",type:"mono.Element",modelDefaultParameters:{}},!0),c.Default.registerObj("twaver.meeting.officeTable1","bangongzhuo1","./model/meeting/obj/bangongzhuo1/",{name:"办公桌",description:"办公桌描述",icon:Ha("officeTable1.png"),category:"办公模型",type:"mono.Element",modelDefaultParameters:{}},!0),c.Default.registerObj("twaver.meeting.officeTable2","bangongzhuo2","./model/meeting/obj/bangongzhuo2/",{name:"办公桌2",description:"办公桌描述",icon:Ha("officeTable2.png"),category:"办公模型",type:"mono.Element",modelDefaultParameters:{}},!0),c.Default.registerObj("twaver.meeting.boardroomTable1","huiyizhuo1","./model/meeting/obj/huiyizhuo1/",{name:"会议桌1",description:"会议桌1描述",icon:Ha("boardroomTable1.png"),category:"办公模型",type:"mono.Element",modelDefaultParameters:{}},!0),c.Default.registerObj("twaver.meeting.boardroomTable2","huiyizhuo2","./model/meeting/obj/huiyizhuo2/",{name:"会议桌2",description:"会议桌2描述",icon:Ha("boardroomTable2.png"),category:"办公模型",type:"mono.Element",modelDefaultParameters:{}},!0),c.Default.registerObj("twaver.meeting.boardroomTable3","huiyizhuo3","./model/meeting/obj/huiyizhuo3/",{name:"会议桌3",description:"会议桌3描述",icon:Ha("boardroomTable3.png"),category:"办公模型",type:"mono.Element",modelDefaultParameters:{}},!0),c.Default.registerObj("twaver.meeting.boardroomTable4","huiyizhuo4","./model/meeting/obj/huiyizhuo4/",{name:"会议桌4",description:"会议桌4描述",icon:Ha("boardroomTable4.png"),
category:"办公模型",type:"mono.Element",modelDefaultParameters:{}},!0),c.Default.registerObj("twaver.meeting.receptionDesk","jiedaichu","./model/meeting/obj/jiedaichu/",{name:"接待处",description:"接待处描述",icon:Ha("receptionDesk.png"),category:"办公模型",type:"mono.Element",modelDefaultParameters:{}},!0),c.Default.registerObj("twaver.meeting.wardrobe","yigui","./model/meeting/obj/yigui/",{name:"衣柜",description:"衣柜描述",icon:Ha("wardrobe.png"),category:"办公模型",type:"mono.Element",modelDefaultParameters:{}},!0),c.Default.registerObj("twaver.meeting.langan","langan001","./model/meeting/obj/langan001/",{name:"栏杆",description:"栏杆描述",icon:Ha("langan1.png"),category:"办公模型",type:"mono.Element",modelDefaultParameters:{}}),c.Default.registerObj("twaver.meeting.sound1","yinxiang001","./model/meeting/obj/yinxiang001/",{name:"音响1",description:"音响1描述",icon:Ha("sound1.png"),category:"办公模型",type:"mono.Element",modelDefaultParameters:{}},!0),c.Default.registerObj("twaver.meeting.sound2","yinxiang002","./model/meeting/obj/yinxiang002/",{name:"音响2",description:"音响2描述",icon:Ha("sound2.png"),category:"办公模型",type:"mono.Element",modelDefaultParameters:{}}),c.Default.registerObj("twaver.meeting.sound3","yinxiang003","./model/meeting/obj/yinxiang003/",{name:"音响3",description:"音响3描述",icon:Ha("sound3.png"),category:"办公模型",type:"mono.Element",modelDefaultParameters:{}},!0),c.Default.registerObj("twaver.meeting.guizi1","guizi001","./model/meeting/obj/guizi001/",{name:"柜子1",description:"柜子1描述",icon:Ha("guizi1.png"),category:"办公模型",type:"mono.Element",modelDefaultParameters:{}},!0),c.Default.registerObj("twaver.meeting.zhuozi2","zhuozi002","./model/meeting/obj/zhuozi002/",{name:"桌子2",description:"桌子2描述",icon:Ha("zhuozi2.png"),category:"办公模型",type:"mono.Element",modelDefaultParameters:{}},!0),c.Default.registerObj("twaver.meeting.television2","dianshi002","./model/meeting/obj/dianshi002/",{name:"电视2",description:"电视2描述",icon:Ha("television2.png"),category:"办公模型",type:"mono.Element",modelDefaultParameters:{}},!0),c.Default.registerObj("twaver.meeting.television1","dianshi001","./model/meeting/obj/dianshi001/",{name:"电视1",description:"电视1描述",icon:Ha("television1.png"),category:"办公模型",type:"mono.Element",modelDefaultParameters:{}},!0),c.Default.registerObj("twaver.meeting.computer1","diannao001","./model/meeting/obj/diannao001/",{name:"电脑",description:"电脑描述",icon:Ha("computer1.png"),category:"办公模型",type:"mono.Element",modelDefaultParameters:{}}),c.Default.registerObj("twaver.meeting.computer2","diannao002","./model/meeting/obj/diannao002/",{name:"电脑",description:"电脑描述",icon:Ha("computer2.png"),category:"办公模型",type:"mono.Element",modelDefaultParameters:{}},!0),c.Default.registerObj("twaver.meeting.printer1","dayinji001","./model/meeting/obj/dayinji001/",{name:"打印机1",description:"打印机001描述",icon:Ha("printer1.png"),category:"办公模型",type:"mono.Element",modelDefaultParameters:{}},!0),c.Default.registerObj("twaver.meeting.printer2","dayinji002","./model/meeting/obj/dayinji002/",{name:"打印机2",description:"打印机002描述",icon:Ha("printer2.png"),category:"办公模型",type:"mono.Element",modelDefaultParameters:{}},!0),c.Default.registerObj("twaver.meeting.projector1","touyingyi001","./model/meeting/obj/touyingyi001/",{name:"投影仪001",description:"投影仪001描述",icon:Ha("projector1.png"),category:"办公模型",type:"mono.Element",modelDefaultParameters:{}}),c.Default.registerObj("twaver.meeting.projector2","touyingyi002","./model/meeting/obj/touyingyi002/",{name:"投影仪002",description:"投影仪002描述",icon:Ha("projector2.png"),category:"办公模型",type:"mono.Element",modelDefaultParameters:{}});var Ka=function(a){return a.indexOf("/")>0?a:c.Default.path+"model/scene/images/"+a},La=function(a){return a.indexOf("/")>0?a:c.Default.path+"model/scene/icons/"+a},W=function(){return{bid:{value:"",name:"业务ID",type:c.Default.PARAMETER_TYPE_STRING,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_CLIENT},position:{value:[0,0,0],name:"位置",type:c.Default.PARAMETER_TYPE_ARRAY_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD,editable:!1},rotation:{value:[0,0,0],name:"旋转角度",type:c.Default.PARAMETER_TYPE_ARRAY_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD,editable:!1}}},Ma=function(){var a={radius:{value:500,name:"半径",type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},segmentsW:{value:50,name:"横切数",type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},segmentsH:{value:50,name:"纵切数",type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},rotation:{value:[0,Math.PI,0],name:"旋转角度",type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},image:{value:"world.jpg",name:"贴图",type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD}},b=W();return c.Default.copyProperties(b,a),a};c.Default.register("twaver.scene.earth",function(a,b){var c=a.radius,d=a.segmentsW,e=a.segmentsH;rotation=a.rotation||[0,0,0];var f=Ka(a.image),g=new mono.Sphere(c,d,e);g.s({"m.texture.image":f,"m.type":"phong"});var h=new mono.Billboard;return h.s({"m.texture.image":Ka("glow.png"),"m.transparent":!0}),h.setScale(1300,1300,1),h.setParent(g),g.setRotation(rotation[0],rotation[1],rotation[2]),g.setClient("type","earth"),g},{name:"地球",description:"地球模型，带光润",icon:La("earth.png"),category:"场景模型",type:"scene",sdkCategory:"earth",modelDefaultParameters:Ma()}),c.Default.copy("twaver.scene.earth1","twaver.scene.earth",function(a){a.image=Ka("map.jpg"),a.rotation=[0,Math.PI/180*230,0]},{name:"地球1",icon:La("earth1.png")});var Na=function(){var a={radius:{value:5e3,name:"半径",type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},image:{value:"star_sky.jpg",name:"贴图",type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},sunImage:{value:"sun.png",name:"贴图",type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD}},b=W();return c.Default.copyProperties(b,a),a};c.Default.register("twaver.scene.skybox3",function(a,b){var c=a.radius;image=Ka(a.image),sunImage=Ka(a.sunImage),position=a.position||[0,0,0];var d=new mono.Sphere(c);d.s({"m.texture.image":image,"m.side":mono.DoubleSide,"m.texture.repeat":new mono.Vec2(14,7)});var e=new mono.Billboard;return e.s({"m.texture.image":sunImage,"m.transparent":!0,"m.depthTest":!1}),e.setScale(3e3,1e3,1),e.setPosition(0,600,-600),e.setParent(d),d.p(position[0],position[1],position[2]),d},{name:"天空盒",description:"星空类的天空盒",icon:La("keybox.png"),category:"场景模型",type:"scene",icon:La("skybox3.png"),sdkCategory:"earthSkybox",modelDefaultParameters:Na()});var Oa=function(){var a={radius:{value:3e3,name:"半径",type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},image:{value:"skybox_sixblue.jpg",name:"贴图",type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},floorImage:{value:"6.png",name:"地面贴图",type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD}},b=W();return c.Default.copyProperties(b,a),a};c.Default.register("twaver.scene.skybox",function(a,b){var c=a.radius;image=Ka(a.image),floorImage=Ka(a.floorImage),position=a.position||[0,0,0];var d=new mono.Sphere(c);d.s({"m.texture.image":image,"m.side":mono.BackSide}),d.setScaleY(.8);var e=new mono.Cube(2*c,10,2*c);return e.s({"m.texture.image":floorImage}),e.setPositionY(2*-c/3),e.setParent(d),e.setClient("type","parkSkybox"),d.setClient("type","parkSkybox"),d.setPosition(position[0],position[1],position[2]),b&&b(d),d},{name:"天空盒",description:"圆球形天空盒",category:"场景模型",type:"scene",icon:La("skybox.png"),sdkCategory:"parkSkybox",modelDefaultParameters:Oa()});var Pa=function(){var a={radius:{value:5e3,name:"半径",type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},image:{value:"skybox.jpg",name:"贴图",type:c.Default.PARAMETER_TYPE_IMAGE,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD}},b=W();return c.Default.copyProperties(b,a),a};c.Default.register("twaver.scene.skybox1",function(a,b){var c=Ka(a.image),d=a.radius,e=new mono.Sphere(d,30,30);e.s({"m.texture.image":c,"m.side":mono.BackSide});var f=new mono.Cube(2*d,2*d,2*d);f.s({"m.visible":!1}),f.setPositionY(-f.getHeight()/2);var g=new mono.ComboNode([e,f],["-"]);f.setPositionY(f.getHeight()/2),e.setScaleY(.1);var h=new mono.ComboNode([e,f],["-"]),i=new mono.ComboNode([g,h],["+"]);i.getBoundingBox();return i.setClient("type","parkSkybox"),b&&b(i),i},{name:"天空盒",description:"天空盒描述",category:"场景模型",type:"scene",icon:La("skybox1.png"),sdkCategory:"parkSkybox",modelDefaultParameters:Pa()});var Qa=function(){var a={scaleX:{value:60,name:"X轴缩放",type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},scaleY:{value:40,name:"Y轴缩放",type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},image:{value:"pin1.png",name:"图片",type:c.Default.PARAMETER_TYPE_NUMBER,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD}},b=W();return c.Default.copyProperties(b,a),a};c.Default.register("twaver.scene.datacenter",function(a,b){var c=a.position||[0,0,0],d=c[0],e=c[1],f=c[2],g=Ka(a.image),h=a.scaleX,i=a.scaleY,j=new mono.Billboard;return j.s({"m.texture.image":g,"m.alignment":mono.BillboardAlignment.bottomCenter,"m.depthTest":!1}),j.setScale(h,i,1),j.p(d,e,f),j.setClient("type","datacenter"),j},{name:"数据中心",description:"数据中心描述",icon:La("datacenter.png"),category:"场景模型",type:"scene",sdkCategory:"datacenter",modelDefaultParameters:Qa()}),c.Default.copy("twaver.scene.datacenter2","twaver.scene.datacenter",{image:"pin2.png"},{icon:La("datacenter2.png")}),c.Default.copy("twaver.scene.datacenter3","twaver.scene.datacenter",{image:"pin3.png"},{icon:La("datacenter3.png")});var Ra=function(){var a=Pa(),b={skyboxId:{value:"twaver.scene.skybox1",name:"天空盒ID",type:c.Default.PARAMETER_TYPE_STRING,propertyType:c.Default.PARAMETER_PROPERTY_TYPE_FIELD},skyboxRadius:a.radius,skyboxPosition:a.position,skyboxRotation:a.rotation},d=W();return c.Default.copyProperties(d,b),b.skyboxPosition.value=[0,1200,0],b};c.Default.registerObj("twaver.scene.ground","dimian1","./model/scene/obj/scene1/dimian/"),c.Default.registerObj("twaver.scene.tree","tree","./model/scene/obj/scene1/tree/"),c.Default.registerObj("twaver.scene.buildingObj","bangonglou","./model/scene/obj/scene1/building/"),c.Default.registerObj("twaver.scene.logo","logo","./model/scene/obj/scene1/logo/"),c.Default.register("twaver.scene.building1",function(a,b){var d=[{id:"twaver.scene.buildingObj",scale:[.752,.752,.752]}],e=c.Default.load(d,b);if(e){var f,g=e[0];if(!g)return null;g.p(0,0,0),g.setStyle("m.ambient","#FFFFFF");for(var h=1;h<e.length;h++)f=e[h],f.setParent(g),f.setStyle("m.ambient","#FFFFFF");return g}},{name:"园区大楼",description:"园区大楼描述",type:"scene",async:!0,sdkCategory:"building"}),c.Default.register("twaver.scene.scene1",function(a,b){var d=a.position||[0,0,0],e=(d[0],d[1],d[2],c.Default.getRsByDs(a.rotation)||[0,0,0]),f=a.skyboxId,g=["twaver.scene.ground"];g.push({id:f,radius:a.skyboxRadius,image:a.skyboxImage,position:a.skyboxPosition,rotation:a.skyboxRotation});var h={shu1:[[-486,-100,-513],[-337,-100,-513],[-187,-100,-513],[-106,-100,-513],[213.5,-100,-480.5],[374,-100,-502],[328,-100,-447.5],[477,-100,-447],[539,-100,-465],[563,-100,-360],[349,-100,-275],[386,-100,-174],[382,-100,-48],[577,-100,-240],[585,-100,-132],[550,-100,-63],[534,-100,282],[496,-100,351.5],[441,-100,444],[509,-100,479],[404,-100,492],[335,-100,457.5],[285,-100,489],[215,-100,454],[-374,-100,482],[-267,-100,481.5],[-159,-100,482.5],[-51,-100,482],[-480,-100,485],[-594,-100,443.5],[-554,-100,384],[-559,-100,-381],[-557,-100,-289],[-559,-100,-197],[-559,-100,2],[-576,-100,116],[-390,-100,-48.5],[-351,-100,-109],[-355.5,-100,-205],[-209,-100,-215]],shu2:[[-573.5,-100,-327],[-571.5,-100,-243],[-551.5,-100,-133.5],[-576.5,-100,-94],[-555,-100,-54.5],[-578.5,-100,46],[-553.5,-100,77.5],[-546.5,-100,160],[-619.5,-100,393.5],[-519.5,-100,461.5],[-524.5,-100,506.5],[-438.5,-100,467.5],[-416.5,-100,497.5],[-312.5,-100,468.5],[-309.5,-100,498.5],[-217.5,-100,465.5],[-201.5,-100,495.5],[-92.5,-100,497.5],[-299.5,-100,202],[-246.5,-100,202],[-194.5,-100,202.5],[-140.5,-100,202.5],[-88.5,-100,202.5],[-32.5,-100,202],[162.5,-100,490.5],[219.5,-100,506.5],[267.5,-100,448],[388.5,-100,451],[491.5,-100,438],[531.5,-100,407.5],[545.5,-100,342.5],[487.5,-100,305],[-398.5,-100,-230.5],[-316.5,-100,-223.5],[-250.5,-100,-223.5],[-277.5,-100,-203],[-339.5,-100,-156.5],[-389.5,-100,-178.5],[-405.5,-100,-136.5],[-394,-100,-97.5],[-433.5,-100,-501],[-392.5,-100,-509],[-279.5,-100,-503.5],[-237.5,-100,-511.5],[281.5,-100,-490.5],[324.5,-100,-500.5],[474.5,-100,-484.5],[427.5,-100,-446.5],[386.5,-100,-438],[515.5,-100,-406],[563,-100,-412.5],[540.5,-100,-294.5],[588,-100,-301.5],[542.5,-100,-200.5],[584.5,-100,-184],[540,-100,-110.5],[584.5,-100,-71.5],[582.5,-100,-6]]};h.shu1.forEach(function(a,b){g.push({id:"twaver.scene.tree",position:a})}),h.shu2.forEach(function(a,b){g.push({id:"twaver.scene.tree",position:a,scale:[.7,.7,.7]})}),g.push({id:"twaver.scene.logo",position:[280,-100,-517]});var i;a.dcId&&(i=new mono.Cube(2048,0,1226),i.s({"top.m.texture.image":"../images/map/"+a.dcId+"/12.jpg","top.m.texture.flipX":!0,"top.m.texture.flipY":!0,"m.visible":!1}),i.setClient("type","mask"),i.setPositionY(200));var j=c.Default.load(g,b);if(j){var k,l=j[0];l.setStyle("m.ambient","#FFFFFF");for(var m=1;m<j.length;m++)k=j[m],k.setParent(l),k.setStyle("m.ambient","#FFFFFF");return i&&i.setParent(l),l.setPosition(d[0],d[1],d[2]),l.setRotation(e[0],e[1],e[2]),l}return null},{name:"园区",description:"园区描述",category:"场景模型",type:"scene",icon:La("scene1.png"),async:!0,buildings:[{id:"twaver.scene.building1",position:[0,100,0]}],sdkCategory:"park",modelDefaultParameters:Ra()});var Sa=function(){var a=Ra();return a.skyboxId="twaver.scene.skybox",a.skyboxRadius.value=3e3,a.skyboxPosition.value=[0,800,0],a};c.Default.registerObj("twaver.scene.building2","lou","./model/scene/obj/scene2/dalou/"),c.Default.registerObj("twaver.scene.ground2","yuanqu","./model/scene/obj/scene2/yuanqu/"),c.Default.register("twaver.scene.scene2",function(a,b){var d=a.position||[0,0,0],e=(d[0],d[1],d[2],c.Default.getRsByDs(a.rotation)||[0,0,0]),f=["twaver.scene.ground2"],g=a.skyboxId;f.push({id:g,radius:a.skyboxRadius,image:a.skyboxImage,position:a.skyboxPosition,rotation:a.skyboxRotation});var h;a.dcId&&(h=new mono.Cube(2048,0,1226),h.s({"top.m.texture.image":"../images/map/"+a.dcId+"/12.jpg","top.m.texture.flipX":!0,"top.m.texture.flipY":!0,"m.visible":!1}),h.setClient("type","mask"),h.setPositionY(350));var i=c.Default.load(f,b);if(i&&i.length>0){for(var j,k=i[0],l=1;l<i.length;l++)j=i[l],j.setParent(k);return h&&h.setParent(k),k.setPosition(d[0],d[1],d[2]),k.setRotation(e[0],e[1],e[2]),k}return null},{name:"园区",description:"园区描述",category:"场景模型",type:"scene",icon:La("scene2.png"),async:!0,buildings:[{id:"twaver.scene.building2",position:[0,-175,0]}],sdkCategory:"park",modelDefaultParameters:Sa()});var Ta=function(){var a=Ra();return a.skyboxId="twaver.scene.skybox",a.skyboxRadius.value=8e3,a.skyboxPosition.value=[0,2e3,0],a};c.Default.registerObj("twaver.scene.ground3","dimian","./model/scene/obj/scene3/dimian/"),c.Default.registerObj("twaver.scene.building3","you1","./model/scene/obj/scene3/building01/"),c.Default.registerObj("twaver.scene.building4","jianzhu0","./model/scene/obj/scene3/jianzhu0/"),c.Default.registerObj("twaver.scene.jianzhu1","jianzhu1","./model/scene/obj/scene3/jianzhu1/"),c.Default.registerObj("twaver.scene.jianzhu5","jianzhu5","./model/scene/obj/scene3/jianzhu5/"),c.Default.registerObj("twaver.scene.jianzhu6","jianzhu","./model/scene/obj/scene3/jianzhu6/"),c.Default.registerObj("twaver.scene.jianzhu7","jianzhu7","./model/scene/obj/scene3/jianzhu7/"),c.Default.registerObj("twaver.scene.menfang","menfang","./model/scene/obj/scene3/menfang/"),c.Default.registerObj("twaver.scene.bigtree","dashu","./model/scene/obj/scene3/shu/",{name:"大树",description:"树描述",category:"场景模型",type:"scene",icon:La("smalltree.png"),sdkCategory:"park"}),c.Default.registerObj("twaver.scene.smalltree","xiaoshu","./model/scene/obj/scene3/shu/",{name:"小树",description:"树描述",category:"场景模型",type:"scene",icon:La("smalltree.png"),sdkCategory:"park"}),c.Default.register("twaver.scene.scene3",function(a,b){var d=a.position||[0,0,0],e=(d[0],d[1],d[2],c.Default.getRsByDs(a.rotation)||[0,0,0]),f=["twaver.scene.ground3"],g=a.skyboxId;f.push({id:g,radius:a.skyboxRadius,image:a.skyboxImage,position:a.skyboxPosition,rotation:a.skyboxRotation});var h={shu1:[[-2382.8,-200,-1717],[-2493.7,-200,-1607.9],[-2570.6,-200,-1431.4],[-2638.25,-200,-1228.9],[-2452.55,-200,-1998.75],[-2353.6,-200,-2108.9],[-2299,-200,-2474.6],[-2102.6,-200,-2448.8],[-3306.65,-200,-521.2],[-3107.65,-200,-500.5],[-917.25,-200,1051.45],[-838.95,-200,931.5],[-226.5,-200,-2058.7],[-479.4,-200,-2195.2],[-436.15,-200,-2326.75],[-610.8,-200,-2405],[-697.3,-200,-2574.8],[-947.5,-200,-2583.6],[-1157.1,-200,-2601.9],[-1580.3,-200,-2825.1],[178.35,-200,-1949],[493.75,-200,-1747],[760.6,-200,-1627.35],[863.2,-200,-1760.3],[1058.75,-200,-1602.05],[1623.9,-200,-1586.9],[1932.1,-200,-1644.4],[2157.45,-200,-1690.2],[2469.2,-200,-1785.15],[2732.9,-200,-1944.6],[3285.2,-200,-2068.4],[3829,-200,-2244.15],[373.5,-200,-1155.75],[2141.8,-200,-1112.35],[2304.6,-200,-1085.65],[-226.1,-200,-1349.75],[-1793.3,-200,-2302.05],[-1952.6,-200,-1946.75],[-1842.7,-200,-1835.65],[-1460.7,-200,-1744.35],[-1279,-200,-1652.35],[-1107.3,-200,-1557.85],[-1311.7,-200,-622.55],[-1891.8,-200,290.95],[-1665.9,-200,473.05],[-1141.7,-200,-249.95],[-1325.2,-200,-43.55],[-765.4,-200,-1060.45],[2309.5,-200,914.35],[2450.8,-200,1125.25],[3091,-200,1732.45],[3010.75,-200,-997.65],[3460.1,-200,749.15],[3697.9,-200,1307.6]],shu2:[[-711.7,-200,1040.2],[-91.1,-200,-2197.25],[303.85,-200,-1858.85],[1199.9,-200,-1673.55],[1595.35,-200,-1732],[1498,-200,-1617.55],[2075.4,-200,-1980.45],[2341.8,-200,-1948.75],[572.15,-200,728.05],[709.15,-200,763.95],[828.2,-200,749.85],[1275.15,-200,890.5],[1267.6,-200,749.3],[1344.7,-200,997.9],[1368.9,-200,1086.15],[1394.75,-200,1176.15],[1457.75,-200,1247.75],[1499.55,-200,1381.4],[1547.7,-200,1490],[1569.85,-200,1589.35],[1676.2,-200,1625.15],[1891.5,-200,1994.15],[1972.2,-200,2070.8],[2032.5,-200,2151.55],[2046.35,-200,2239.65],[2202.3,-200,2352.15],[2289.2,-200,2452.95],[2672.2,-200,2769.1],[2817,-200,2825.6],[2915.2,-200,2840.35],[3006,-200,2819.85],[3196.4,-200,2776.45],[3343.65,-200,2820.65],[3445.9,-200,2768.25],[3524.45,-200,2719.95],[3562.9,-200,2606.95],[3684.2,-200,2596.05],[3715.5,-200,2503.7],[3783.9,-200,2484.75],[3854.8,-200,2405.55],[3894.35,-200,2314.05],[3964.4,-200,2134.25],[4083.5,-200,1909.55],[4048.85,-200,1809.75],[4086.5,-200,1759.6],[4076.45,-200,1657.05],[4060.55,-200,1548.65],[3996.3,-200,1367.15],[4032.4,-200,1260.95],[3979.6,-200,1161.05],[3993.2,-200,1103.05],[3968.6,-200,1004.15],[3920.55,-200,917.35],[3813.1,-200,748.65],[3727.8,-200,616.45],[3668.4,-200,532.75],[3694.35,-200,459.95],[3636.35,-200,383.75],[3527.6,-200,392.15],[3408.9,-200,408.05],[3439,-200,296.75],[3399.7,-200,163.65],[3501.7,-200,176.25],[3365.4,-200,59.1],[3383.8,-200,-40.5],[3357.05,-200,-188.6],[3221.6,-200,-460.55],[3214.75,-200,-551.9],[3139.75,-200,-682.1],[-1475.9,-200,769],[-1470.1,-200,865.8],[-1407,-200,627.6],[-1389.5,-200,530.7],[-1261,-200,382.2],[-1094,-200,199],[-104.8,-200,-774.9],[-152.9,-200,-664.8],[-184.1,-200,-538.2],[-232.2,-200,-362.5],[2014.4,-200,654],[2068.4,-200,749.6],[2119.7,-200,842.4],[2180.7,-200,926.9],[2223.7,-200,1021.1],[2270.8,-200,1104.3],[2319.4,-200,1191.5],[2394.4,-200,1284.8],[2537.2,-200,1262.7],[2576,-200,1351.3],[2456.8,-200,1367.7],[2518.4,-200,1452.9],[2587.7,-200,1532],[2665.8,-200,1611.1],[2735.9,-200,1682.2],[2808.5,-200,1760.2],[2961.8,-200,1705.1],[2896.9,-200,1832.8],[2988.6,-200,1868.8],[3089.6,-200,1868.8],[3202,-200,1816.4],[3239.1,-200,1731.3],[3133.2,-200,1623.9],[3242.4,-200,1609.7],[3175.1,-200,1421],[3215.2,-200,1509.2],[3139.2,-200,1317.1],[3085.1,-200,1215.9],[3051.9,-200,1126],[3002.9,-200,1032.2],[2973.2,-200,922.2],[2875.4,-200,897.8],[2837.7,-200,778.8],[2761.7,-200,683.6],[2696.2,-200,604.2],[2464.3,-200,-554.8],[2482.6,-200,-418.3],[1789.2,-200,-194.4],[1759.6,-200,-663.1],[1876.5,-200,-736.3],[2054,-200,-770.1],[1923.2,-200,-485.1],[1744.7,-200,-447.1],[1894,-200,-129.1],[1156.3,-200,-.9],[1132.3,-200,-454.6],[1125.2,-200,-635.4],[1132.3,-200,-742.9],[986.6,-200,-737.2],[1006.4,-200,-662.3],[982.4,-200,-468.7],[911.3,-200,-434.8],[895.7,-200,-310.7],[869.4,-200,-134.4],[839,-200,31.9],[484.8,-200,-1182.8],[572,-200,-1134.7],[684.8,-200,-1112.9],[465.7,-200,-1088.3],[784.9,-200,-1104.6],[893.1,-200,-1078.3],[1118.5,-200,-1047.4],[1355.2,-200,-1028.2],[1526.1,-200,-1032.8],[1644.3,-200,-1046.4],[1757.9,-200,-1062.7],[1858.8,-200,-1077.3],[1983.3,-200,-1090.9],[-290.5,-200,-1457.2],[-380.3,-200,-1429.4],[-381.4,-200,-1510.9],[-480.6,-200,-1498.3],[-573.2,-200,-1571.7],[-681.7,-200,-1642.6],[-1636.8,-200,-2225.4],[-1514.2,-200,-2158.6],[-2035.3,-200,-1637.6],[-1913.7,-200,-1655.9],[-2020.1,-200,-1493.4],[-2126.5,-200,-1307.3],[-2151.3,-200,-1116.7],[-2007.2,-200,-1036.5],[-2094.8,-200,-1010.3],[-1943,-200,-921.8],[-1875.9,-200,-956.8],[-1803,-200,-835.3],[-1732.9,-200,-872.2],[-1668.5,-200,-746.6],[-1595.5,-200,-782.6],[-1533.3,-200,-664],[-2295.7,-200,-915.2],[-2372.6,-200,-817],[-2656.7,-200,-275.2],[-2631.1,-200,-432.6],[-2493.3,-200,-161.1],[-2331.7,-200,-46.5],[-2178.1,-200,63.6],[-2016.6,-200,179.7],[-2875.4,-200,-69.2],[-3008.3,-200,96.1],[-3152.1,-200,267.3],[-2948.7,-200,521.5],[-2824.7,-200,635.4],[-2693.3,-200,761.1],[-2578.1,-200,856.3],[-1893.3,-200,766.6],[-1783.7,-200,693.9],[-1726.9,-200,605.3],[-1582.2,-200,355.1],[-1514.2,-200,254.5],[-1444.7,-200,165.9],[-1386.8,-200,74.7],[-1258.3,-200,-189.1],[-1127.6,-200,-393.7],[-1065.8,-200,-509.5],[-995,-200,-623],[-940.2,-200,-740.5],[-871.5,-200,-857],[-740,-200,-902.8],[-796.7,-200,-793.2],[-847.6,-200,-666.8],[-897.4,-200,-546.3],[-960.2,-200,-434.8],[-1010,-200,-305.1],[185.2,-200,385.3],[291.1,-200,421.6],[401,-200,446.8],[526,-200,479],[648,-200,493.2],[766,-200,508.3],[900.1,-200,515.3],[1040.7,-200,521.4],[1161.7,-200,521.4],[1273.6,-200,477.1],[1416.8,-200,508.3],[1508.7,-200,577.1],[1585.4,-200,663.7],[1664,-200,744.4],[1377.7,-200,681.9],[1417,-200,813.2],[1457.3,-200,933.1],[1504.7,-200,1033.9],[3057.95,-200,-1146.7],[2914.55,-200,-1126.2],[2796.25,-200,-1105.45],[2735.95,-200,-1018.15],[2761.8,-200,-892.2],[2792.2,-200,-778.25],[2816.25,-200,-660],[2833.85,-200,-537.5],[2926.85,-200,-428.25],[3038.85,-200,-315.95],[3099.55,-200,-217.65],[3149.95,-200,-102.25],[3189.65,-200,28.9],[3229.6,-200,139.95],[3246.35,-200,272.55],[3249.95,-200,423.25],[3218.25,-200,652.95],[3274.75,-200,775.95],[3331.45,-200,903.15],[3503.55,-200,942.85],[3394.15,-200,1009.95],[3448.35,-200,1140.75],[3600.85,-200,1142.8],[3508.85,-200,1259.15],[3571.25,-200,1386.1],[3628.95,-200,1503.75],[3604.85,-200,1650.35],[3728.95,-200,1703.05]]};h.shu1.forEach(function(a,b){f.push({id:"twaver.scene.bigtree",position:a})}),h.shu2.forEach(function(a,b){f.push({id:"twaver.scene.smalltree",position:a})});var i;a.dcId&&(i=new mono.Cube(9212,0,6388),i.s({"top.m.texture.image":"../images/map/"+a.dcId+"/12.jpg","top.m.texture.flipX":!0,"top.m.texture.flipY":!0,"m.visible":!1}),i.setClient("type","mask"),i.setPositionY(350));var j=c.Default.load(f,b);if(j&&j.length>0){for(var k,l=j[0],m=1;m<j.length;m++)k=j[m],k.setParent(l);return i&&i.setParent(l),l.setPosition(d[0],d[1],d[2]),l.setRotation(e[0],e[1],e[2]),l}return null},{name:"园区",description:"园区描述",category:"场景模型",buildings:[{id:"twaver.scene.building3",position:[-2523,0,383],rotation:[0,140,0]},{id:"twaver.scene.building3",position:[-1983,0,-388],rotation:[0,145,0]},{id:"twaver.scene.building3",position:[-1456,0,-1293],rotation:[0,150,0]},{id:"twaver.scene.building4",position:[-408,0,-594],rotation:[0,70,0]},{id:"twaver.scene.jianzhu1",position:[0,0,0]},{id:"twaver.scene.jianzhu5",position:[0,0,0]},{id:"twaver.scene.jianzhu6",position:[0,0,0]},{id:"twaver.scene.jianzhu7",position:[0,0,0]}],type:"scene",icon:La("scene3.png"),async:!0,sdkCategory:"park",modelDefaultParameters:Ta()});var Ua=function(){var a=Ra();return a.skyboxId="twaver.scene.skybox1",console.log(a),a.skyboxRadius.value=1e4,a.skyboxPosition.value=[0,800,0],a};c.Default.registerObj("twaver.scene.ground4","dimian","./model/scene/obj/scene4/park/"),c.Default.registerObj("twaver.scene.building5","jianzhu","./model/scene/obj/scene4/building/"),c.Default.register("twaver.scene.scene4",function(a,b){var d=a.position||[0,0,0],e=(d[0],d[1],d[2],c.Default.getRsByDs(a.rotation)||[0,90,0]),f=["twaver.scene.ground4"],g=a.skyboxId;f.push({id:g,radius:a.skyboxRadius,image:a.skyboxImage,position:a.skyboxPosition,rotation:a.skyboxRotation});var h={shu1:[[-2258,-150,835.5],[-2089,-150,835.5],[-1982,-150,773.5],[-1945,-150,-202.5],[-2211,-150,-588.5],[-1952,-150,-2190.5],[-1299,-150,-2266.5],[-1072,-150,-1807.5],[-1205,-150,-950.5],[-983,-150,-861.5],[-1087,-150,-651.5],[-1200,-150,-580.5],[-1082,-150,-443.5],[-973,-150,-493.5],[-1026,-150,-233.5],[-1135,-150,-168.5],[-1294,-150,971.5],[-1173,-150,971.5],[-1132,-150,671.5],[-1040,-150,466.5],[-1037,-150,371.5],[-764,-150,852.5],[-591,-150,976.5],[-465,-150,968.5],[-436,-150,1535.5],[-708,-150,1602.5],[-637,-150,648.5],[-507,-150,607.5],[-53,-150,505.5],[83,-150,514.5],[119,-150,966.5],[241,-150,968.5],[611,-150,966.5],[511,-150,447.5],[422,-150,340.5],[1413,-150,1735.5],[1692,-150,1680.5],[2034,-150,730.5],[2310,-150,662.5],[2450,-150,-702.5],[2716,-150,-761.5],[2364,-150,-2095.5],[1954,-150,-2510.5],[1816,-150,-2110.5],[1921,-150,-1268.5],[2036,-150,-1115.5],[614,-150,-472.5],[497,-150,-268.5],[381,-150,-205.5],[603,-150,-108.5],[420,-150,-1908.5],[304,-150,-2065.5],[410,-150,-2272.5],[190,-150,-2364.5],[632,-150,-1287.5],[632,-150,-1063.5],[627,-150,-727.5],[88,-150,-1281.5],[-447,-150,-1286.5],[1029,-150,520.5],[1148,-150,453.5],[1145,-150,670.5],[1254,-150,617.5],[1251,-150,248.5],[1022,-150,155.5],[1413,-150,248.5],[1530,-150,400.5],[1515,-150,186.5],[1634,-150,340.5],[1632,-150,-24.5],[1403,-150,-117.5],[1516,-150,-460.5],[1619,-150,-517.5],[1509,-150,-680.5],[1397,-150,-598.5],[1617,-150,-887.5],[1379,-150,-980.5],[1257,-150,-887.5],[1159,-150,-817.5],[1253,-150,-1243.5],[1030,-150,-1339.5],[1038,-150,-980.5],[1141,-150,-1036.5]]};h.shu1.forEach(function(a,b){f.push({id:"twaver.scene.bigtree",position:a})});var i;a.dcId&&(i=new mono.Cube(4096,0,2452),i.s({"top.m.texture.image":"../images/map/"+a.dcId+"/12.jpg","top.m.texture.flipX":!0,"top.m.texture.flipY":!0,"m.visible":!1}),i.setClient("type","mask"),i.setPositionY(350));var j=c.Default.load(f,b);if(j&&j.length>0){for(var k,l=j[0],m=1;m<j.length;m++)k=j[m],k.setParent(l);return i&&i.setParent(l),l.setPosition(d[0],d[1],d[2]),l.setRotation(e[0],e[1],e[2]),l}return null},{name:"园区",description:"园区描述",category:"场景模型",type:"scene",async:!0,buildings:[{id:"twaver.scene.building5",position:[-2523,45,383],rotation:[0,300,0]}],sdkCategory:"park",modelDefaultParameters:Ua()})}(window),function(a,b){var c={};a.doodle=c;var d={};d.edit={},d.edit.interaction={},d.edit.ui={},d.edit.data={},c._version="1.5.1",c.getVersion=function(){return c._version},c._debug=!1,c.isDebug=function(){return c._debug},c.id=function(a){return c.isDebug()?c.debugId(a):(a=a||"",a+mono.id())},c.idIndex=1e4,c.ID_PREFIX="doodle",c.debugId=function(a){return(a?a:c.ID_PREFIX)+"-"+c.idIndex++};var e=function(){};e.prototype.isNotNull=function(a){return a!==b&&"undefined"!==a&&null!==a&&"null"!==a&&""!==a},e.prototype.loadFile=function(a,c){if(a){var d=new XMLHttpRequest;c!==b&&d.addEventListener("load",function(a){c(a.target.responseText)},!1),d.open("GET",a,!0),d.send(null)}},e.prototype.isCtrlDown=function(a){return a.ctrlKey||a.metaKey},e.prototype.isAltDown=function(a){return a.altKey},e.prototype.isShiftDown=function(a){return a.shiftKey},e.prototype.load2dSceneCategory=function(){var a=new c.AccordionData;return a.filterCategory=function(a){return"2d房间模型"==a||"2d机柜模型"==a||"2d环境模型"==a?!0:!1},a.sortCategories=function(a){return a},a.filterModel=function(a){return"twaver.idc.floor.top"==a||"twaver.idc.column.top"==a?!1:!0},a.getData()},e.prototype.load2dRackCategory=function(a){var b=new c.AccordionData;return b.filterCategory=function(b){return"基本模型"==b?!1:""==b?!1:a||"设备2D"==b||"设备模板"==b?"机柜"!=b&&"设备2D"!=b&&"设备模板"!=b&&"机柜模板"!=b?!1:!0:!1},b.getData()},e.prototype.load2dDeviceCategory=function(){var a=new c.AccordionData;return a.filterCategory=function(a){return"基本模型"==a?!1:""==a?!1:["设备面板","面板部件","面板背板"].indexOf(a)<0?!1:!0},a.getData()},e.prototype.load2dCircuitCategory=function(){var a=new c.AccordionData;return a.filterCategory=function(a){return"基本模型"==a?!1:""==a?!1:"基本"==a?!0:["组件"].indexOf(a)<0?!1:!0},a.getData()},e.prototype.load3dModelCategory=function(){var a=new c.AccordionData;return a.filterCategory=function(a){return"基本模型"==a||"机柜模型"==a||"设备模型"==a||"板卡"==a?!0:!1},a.getData()},e.prototype.transformAndScaleCanvasContext=function(b,c){var d=b.getContext("2d");if(!c&&b.isTransfor&&b.width&&b.height)return d;var e=a.devicePixelRatio||1,f=d.webkitBackingStorePixelRatio||d.mozBackingStorePixelRatio||d.msBackingStorePixelRatio||d.oBackingStorePixelRatio||d.backingStorePixelRatio||1,g=e/f;if(e!==f){var h=b.width,i=b.height;b.width=h*g,b.height=i*g,b.style.width=h+"px",b.style.height=i+"px",d.scale(g,g)}return b.width&&b.height&&(b.isTransfor=!0),d},e.prototype.animateCamera=function(a,b,c,d,e){var f=a.getPosition().sub(a.getTarget()),g=new twaver.Animate({from:0,to:1,dur:500,easing:"easeBoth",onUpdate:function(e){var g=c.x+(d.x-c.x)*e,h=c.y+(d.y-c.y)*e,i=c.z+(d.z-c.z)*e,j=new mono.Vec3(g,h,i);a.lookAt(j),b.target=j;var k=(new mono.Vec3).addVectors(f,j);a.setPosition(k)}});g.onDone=e,g.play()},e.prototype.findFirstObjectByMouse=function(a,c,d){d===b&&(d=this.findFirstObjectByMouseFilter);var e=a.getElementsByMouseEvent(c);if(e.length){if(!d)return e[0];for(var f=0;f<e.length;f++){var g=e[f],h=g.element;if(d(h))return g}}return null},e.prototype.findFirstObjectByMouseFilter=function(a){return!(a instanceof mono.Billboard)},e.prototype.getUrlParam=function(b){var c=new RegExp("(^|&)"+b+"=([^&]*)(&|$)"),d=a.location.search.substr(1).match(c);return null!=d?unescape(d[2]):null},e.prototype.getModelParameter=function(a){return make.Default.getModelDefaultParameters(a)},e.prototype.initPropertySheet=function(a){a.setEditable(!0);a.getPropertyBox()},e.prototype.addProperties=function(a,b){b.forEach(function(b){a.add(b)})},e.prototype.createSceneNetwork3D=function(a){var b=this;a=a||{};var c=a.network||new mono.Network3D,d=c.getDataBox();if(!a.initialized){var e=new mono.PerspectiveCamera(30,1.5,50,2e4);c.setCamera(e),e.p(1328.647469988342,2925.856952899234,2084.0725294541244),e.look(new mono.Vec3(1356.0876637604608,255.78986100252212,-567.4369627978233));var f=c.getDefaultInteraction();f.yLowerLimitAngle=Math.PI/180*2,f.yUpLimitAngle=Math.PI/2,f.maxDistance=1e4,f.minDistance=50,f.zoomSpeed=3,f.panSpeed=.2,c.setInteractions([f]);var g=new mono.PointLight(16777215,.1);g.setPosition(8e3,8e3,8e3),d.add(g),d.add(new mono.AmbientLight("white"))}var h=c.getRootView(),i=null;a.renderView&&"string"!=typeof a.renderView&&(i=a.renderView),i||(i=document.getElementById(a.renderView)),i||(i=document.getElementsByClassName(a.renderView)[0]),i||(i=document.createElement("div"),i.setAttribute("class","renderView-scene-3d"),i.style.position="absolute",i.style.width="100%",i.style.height="100%",document.body.appendChild(i)),i.appendChild(h),mono.Utils.autoAdjustNetworkBounds(c,i,"clientWidth","clientHeight",0,0);var j=h.getAttribute("class");return j||(j=""),h.setAttribute("class",j+"  network3d-view"),h.addEventListener("dblclick",function(d){b.handleDoubleClick(d,c,a.handleDoubleClick)}),c},e.prototype.loadSceneData=function(a,b,c){
var d=make.Default.load(b,null,{});for(var e in d){var b=d[e];c&&c(b)||a.addByDescendant(b)}},e.prototype.loadDeviceData=function(a,b,c,d){var e=b,f=make.Default.RACK_OFFSET_Y,g=make.Default.getUnitHeight(),h=e.getBoundingBox(),i=make.Default.load(c);for(var j in i){var k=i[j];if(!d||!d(k)){var l=c[j].client.loc,m=k.getBoundingBox(),n=f+l*g-(h.max.y-h.min.y)/2+g;k.setY(n),k.setZ((h.max.z-h.min.z)/2-(m.max.z-m.min.z)/2+1),k.setParent(e),a.addByDescendant(k)}}},e.prototype.handleDoubleClick=function(a,b,c){var d=b.getCamera(),e=b.getDefaultInteraction(),f=this.findFirstObjectByMouse(b,a);if(f){var g=f.element,h=f.point,i=d.getTarget();if(this.animateCamera(d,e,i,h,function(){g.getClient("animation")&&make.Default.playAnimation(g,g.getClient("animation"))}),g.getClient("dbl.func")){var j=g.getClient("dbl.func");j(g,b,f,a)}else if("rack_door"==g.getClient("type")){var j=g.getParent().getClient("dbl.func");j&&j(g.getParent(),b,f,a)}c&&c(g,b,f,a)}else{var i=d.getTarget(),h=new mono.Vec3(0,0,0);this.animateCamera(d,e,i,h)}},e.prototype.createPanelDialog=function(){if(a.$&&a.$.ui&&a.$.ui.dialog){var b=$("<div class='panel-main'></div>").appendTo(document.body);return $(b).dialog({title:"设备面板",width:1e3,height:500,modal:!0,close:function(){b.network.dispose(),b.remove()}}),b}throw"there is not import jquery and jquery-ui.js"},e.prototype.createPanelNetwork2D=function(a){a=a||{};var b=a.network||new twaver.vector.Network,c=(b.getElementBox(),b.getView());b.setMaxZoom(50),c.setAttribute("class","network-view-device-panel");var d=null;a.renderView&&"string"!=typeof a.renderView&&(d=a.renderView),d||(d=document.getElementById(a.renderView)),d||(d=document.getElementsByClassName(a.renderView)[0]),d||(d=document.createElement("div"),d.setAttribute("class","renderView-panel"),d.style.position="absolute",d.style.width="100%",d.style.height="100%",document.body.appendChild(d)),d.appendChild(c);var e=d.clientWidth,f=d.clientHeight;return b.adjustBounds({x:0,y:0,width:e,height:f}),setTimeout(function(){b.zoomOverview()},500),b},e.prototype.loadPanelData=function(a,b,c,d,e){e=e||1,c=c||0,d=d||0;var f=make.Default.load({id:"twaver.idc.panel.loader",data:b,scale:e,x:c,y:d});f instanceof Array?f.forEach(function(b){a.addByDescendant(b)}):a.addByDescendant(f)},e.prototype.getSceneEditorModel3dId=function(a){var b=a.replace(j.MODEL_SUFFIX_SEPARATOR+j.SCENE_MODEL_SUFFIX,""),c=b+j.MODEL_SUFFIX_SEPARATOR+j.SCENE_MODEL_SUFFIX;return j.sceneEditorModel2dTo3dMapping[c]||b},e.prototype.getSceneEditorModel2dId=function(a){var b=a.replace(j.MODEL_SUFFIX_SEPARATOR+j.SCENE_MODEL_SUFFIX,""),c=b+j.MODEL_SUFFIX_SEPARATOR+j.SCENE_MODEL_SUFFIX;return j.sceneEditorModel3dTo2dMapping[b]||c},e.prototype.getRackEditorModel3dId=function(a){var b=a.replace(j.MODEL_SUFFIX_SEPARATOR+j.RACK_MODEL_SUFFIX,""),c=b+j.MODEL_SUFFIX_SEPARATOR+j.RACK_MODEL_SUFFIX;return j.rackEditorModel2dTo3dMapping[c]||b},e.prototype.getRackEditorModel2dId=function(a){var b=a.replace(j.MODEL_SUFFIX_SEPARATOR+j.RACK_MODEL_SUFFIX,""),c=b+j.MODEL_SUFFIX_SEPARATOR+j.RACK_MODEL_SUFFIX;return j.rackEditorModel3dTo2dMapping[b]||c},e.prototype.getDeviceEditorModel3dId=function(a){var b=a.replace(j.MODEL_SUFFIX_SEPARATOR+j.DEVICE_MODEL_SUFFIX,""),c=b+j.MODEL_SUFFIX_SEPARATOR+j.DEVICE_MODEL_SUFFIX;return j.deviceEditorModel2dTo3dMapping[c]||b},e.prototype.getDeviceEditorModel2dId=function(a){var b=a.replace(j.MODEL_SUFFIX_SEPARATOR+j.DEVICE_MODEL_SUFFIX,""),c=b+j.MODEL_SUFFIX_SEPARATOR+j.DEVICE_MODEL_SUFFIX;return j.deviceEditorModel3dTo2dMapping[b]||c},e.prototype.createImportDialog=function(a,b,c){this.fileIndex=this.fileIndex||1;var e="files-"+this.fileIndex;this.fileIndex++;var f=new d.edit.Dialog(a,{OK:function(){var a=$("#"+e)[0];if(a.files&&a.files.length>0){var d=a.files[0];if(d.name.indexOf(".")>0){var f=d.name.split(".");if(f[1]!=b)return void alert("file format should be "+b);var g=new FileReader;g.readAsText(d),g.onloadend=function(){g.error?console.log(g.error):c&&c(g.result)}}}$(this).dialog("close")},Cancel:function(){$(this).dialog("close")}});f.init(),f.getView().dialog("option","width",450),f.getView().dialog("option","height",180);var g="<div   ><label class='field'>File Path:</label>   <input id='"+e+"' type='file' class='input' size='20'/></div>";return f.setData(g),f},e.prototype.createExportDialog=function(a){a instanceof Object&&(a=JSON.stringify(a));var b="<div>导出数据：<br><textarea>"+a+"</textarea></div>";$(b).dialog({title:"导出json",width:400,height:500})},e.prototype.createJsonObject=function(a,b,c){if(b.length>0)for(var d=0;d<b.length;d++){var e=b[d];c&&(e.dataType=c);var f=g._getJsonData(e);a.add(f)}},e.prototype._getJsonData=function(a){var b=new d.edit.data.JsonObject,c=a.id,e=a.data,f=a.position||[0,0,0],h=a.width,i=a.depth;if(c&&(b.id=c),a.objectId&&(b.objectId=a.objectId),null!=e&&e.length>0){var j=[];if(e[0]instanceof Array)for(var k=0;k<e.length;k++){var l=e[k],m=e[k].length;2==m?j.push([l[0]-f[0],l[1]-f[2]]):5==m&&j.push([l[0],l[1]-f[0],l[2]-f[2],l[3]-f[0],l[4]-f[2]])}else for(var k=0;k<e.length;k+=2)j.push([e[k]-f[0],e[k+1]-f[2]]);b.setData(j)}if(a.children){for(var n=[],k=0;k<a.children.length;k++){var o=a.children[k],p=g._getJsonData(o);n.push(p)}b.setChildren(n)}return f&&b.setPosition(f),h&&b.setWidth(h),i&&b.setDepth(i),a.rotation&&b.setRotation(a.rotation),a.closed&&b.setClosed(a.closed),a.showFloor&&b.setShowFloor(a.showFloor),a.client=a.client||{},a.client.label=make.Default.getName(c),a.dataType&&(b.client.dataType=a.dataType),a.client&&b.setClient(a.client),b},e.prototype.isEditModel=function(a){return!0},e.prototype.isMoveModel=function(a){return!0},e.prototype.isChild=function(a){var b=a.getClient("type"),c=["door","window"];return b&&c.indexOf(b)>=0?!0:!1},e.prototype.stopPropagation=function(a){a.stopPropagation&&a.stopPropagation(),a.preventDefault?a.preventDefault():a.returnValue=!1},e.prototype.parseDxf=function(a){var b=new d.edit.ImportDxf,c=b.loadDxf(a);return c},e.prototype.o2s=function(a){try{return JSON.stringify(a)}catch(b){throw b}},e.prototype.s2o=function(a){try{return JSON.parse(a)}catch(b){throw b}},e.prototype.clone=function(a){return a.clone?a.clone():g.s2o(g.o2s(a))},e.prototype.ext=function(a,b,c){var d=a.prototype;if(twaver.Util.ext(a,b,c),d&&a.prototype)for(var e in d)a.prototype[e]=d[e]},e.prototype.addMask=function(a){var b;parseInt(document.body.scrollWidth),parseInt(document.body.scrollHeight);return b=document.createElement("div"),a?b.setAttribute("id","mask_"+a):b.setAttribute("id","mask"),b.setAttribute("class","mask"),document.body.appendChild(b),b},e.prototype.setDialogRect=function(a){var b=document.getElementById("mask");if(document.getElementById("mask_"+a)&&(b=document.getElementById("mask_"+a)),b){var c=b.offsetWidth,d=b.offsetHeight,e=document.getElementById(a),f=e.offsetWidth,g=e.offsetHeight;e.style.left=c/2-f/2+"px",e.style.top=d/2-g/2+"px"}},e.prototype.queryString=function(a,b){var c=new RegExp(""+b+"=([^&?]*)","ig");return a.match(c)?a.match(c)[0].substr(b.length+1):null},e.prototype.isPointInRect=function(a,b){return a.x>b.x&&a.x<b.x+b.width&&a.y>b.y&&a.y<b.y+b.height},e.prototype.moveSelectionElements=function(a,b,c,d){var e=a.getSelectionModel().getSelection();if(e.size()>0){var f=0,g=0;"left"===b&&(f=-c),"right"===b&&(f=c),"top"===b&&(g=-d),"bottom"===b&&(g=d),twaver.Util.moveElements(e,f,g,!1)}},e.prototype.isNodeInNode=function(a,b){var c=this.getNodePoints(a),d=b.getCenterLocation();return this.isPointInPolygon(c,d)},e.prototype.isPointInPolygon=function(a,b){var c=0,d=0,e=!1,f=a.length;for(c=0,d=f-1;f>c;d=c++){var g=a[c],h=a[d];g.y>b.y!=h.y>b.y&&b.x<(h.x-g.x)*(b.y-g.y)/(h.y-g.y)+g.x&&(e=!e)}return e},e.prototype.rotatePoint=function(a,b,c){var c=c||{x:0,y:0},d=c.x,e=c.y,f=a.x,g=a.y,h=b,i=(f-d)*Math.cos(h)-(g-e)*Math.sin(h)+d,j=(f-d)*Math.sin(h)+(g-e)*Math.cos(h)+e;return{x:i,y:j}},e.prototype.getNodePoints=function(a){var b=this,c=a.getCenterLocation(),d=a.getAngle()/180*Math.PI,e=a.getLocation(),f=a.getSize(),g=[{x:e.x,y:e.y},{x:e.x+f.width,y:e.y},{x:e.x+f.width,y:e.y+f.height},{x:e.x,y:e.y+f.height}],h=g.map(function(a){return b.rotatePoint(a,d,c)});return h};var f={};e.prototype.runDelayTask=function(a,b,c){f[a]&&clearTimeout(f[a]),f[a]=setTimeout(function(){f[a]=null,c&&c()},b)};var g=new e;c.Utils=c.utils=g;var h=function(){this._data=[],this.init()};h.prototype={init:function(){this._data=[];var a=this,b=make.Default.getCategories(),c=[];b.forEach(function(b){a.filterCategory&&a.filterCategory(b)===!1||c.push(b)}),this.sortCategories&&(c=this.sortCategories(c)),c.forEach(function(b){var c=[],d=make.Default.getCreatorsForCategory(b);for(var e in d)if(!a.filterModel||a.filterModel(e)!==!1){var f=make.Default.getParameters(e),g=make.Default.getIcon(e),h=make.Default.isCombo(e);c.push({id:e,icon:g,label:f.name,category:b,combo:h})}a.sortModels&&(c=a.sortModels(c)),c&&c.length>0&&a._data.push({title:b,contents:c})})},getData:function(){return this.init(),this._data},filterCategory:function(a){return"基本模型"==a?!1:""==a?!1:!0},sortCategories:function(a){return a},filterModel:function(a){return!0},sortModels:function(a){return a}},c.AccordionData=h,c.utils.ext(h,Object);var i=function(){this.init(),this._categories=[],this._visible=!0,this._reset=!0};i.prototype={init:function(){this.paneBox=$('<div id="accordion-resizer" class="ui-widget-content"></div>'),this.mainPane=$('<div id="accordion"></div>').appendTo(this.paneBox),this.mainPane.accordion({heightStyle:"fill"})},setCategories:function(a){var b=this._categories;this._categories=a,this.mainPane.accordion("destroy"),this.mainPane.empty();var c=this;if(a)for(var d=0;d<a.length;d++){var e=a[d],f=$("."+e.title);0==f.length&&(f=$('<h3 class="'+e.title+'">'+e.title+"</h3>").appendTo(this.mainPane),$('<ul class="mn-accordion"></ul>').appendTo(this.mainPane));var g=f.next(".mn-accordion");e.contents.forEach(function(a){var b=a.icon;(!b||b.indexOf("undefined")>=0)&&(b="images/cloud-up-icon.png");var d=$('<li class="item-li"></li>').appendTo(g),e=$("<img src="+b+" title="+(a.description||a.label)+"></img>"),f=$('<div class="item-label">'+a.label+"</div>");d.append(e),d.append(f),c.setImageDraggable(e[0],a)})}return this.mainPane.accordion({heightStyle:"fill"}),this.mainPane.accordion("refresh"),this.refresh(),b},getCategories:function(){return this._categories},setVisible:function(a){this._visible!=a&&(this._visible=a,this._visible?this.paneBox.show():this.paneBox.hide())},isVisible:function(){return this._visible},refresh:function(){var a=this;setTimeout(function(){a.mainPane.accordion("refresh")},100)},getView:function(){return this.paneBox[0]},setImageDraggable:function(a,b){var c=this;d.edit.DragAndDrop.setDragTarget(a,b,{effectAllowed:"copyMove",dragImage:b.dragImage||b.icon,ondrag:function(a){c.ondrag&&c.ondrag(a,b)}})},ondrag:function(a,b){}},c.AccordionPane=d.edit.AccordionPane=i,c.utils.ext(i,Object);var j={MODEL_SUFFIX_SEPARATOR:".",SCENE_MODEL_SUFFIX:"top",RACK_MODEL_SUFFIX:"front",DEVICE_MODEL_SUFFIX:"panel",REDIRECT_RACK_EDITOR:!0,REDIRECT_DEVICE_EDITOR:!0,sceneEditorModel3dTo2dMapping:{},sceneEditorModel2dTo3dMapping:{},rackEditorModel3dTo2dMapping:{},rackEditorModel2dTo3dMapping:{},deviceEditorModel3dTo2dMapping:{},deviceEditorModel2dTo3dMapping:{},circuitEditorModel3dTo2dMapping:{},circuitEditorModel2dTo3dMapping:{},pasteOffsetX:10,pasteOffsetY:10,pasteOffsetZ:10};c.consts=j,d.edit.Consts=j;var k=d.edit.Dialog=function(a,b,c,d){var a=a||"Dialog";this.dialog=$('<div id="export-message" title = "'+a+'"></div>'),this.content=$('<div class="inner" ></div>'),this.dialog.append(this.content),this.buttons=b,this.params=c||{}};k.prototype.setData=function(a){"string"==typeof a?this.content.html(a):this.content.append(a)},k.prototype.getView=function(){return this.dialog},k.prototype.init=function(){this.buttons||(this.buttons={Ok:function(){$(this).dialog("close")}}),this.dialog.dialog({height:300,width:350,autoOpen:!1,show:{effect:"fade"},hide:{effect:"fade"},modal:!0,buttons:this.buttons,close:this.params.close})},k.prototype.show=function(){this.dialog.dialog("open")},k.prototype.hide=function(){this.dialog.dialog("close")};var l=d.edit.DragAndDrop={};l.setDragImage=function(a,b){if(a){var c=a;"string"==typeof a&&(a=document.createElement("img"),a.setAttribute("src",c)),b.dataTransfer.setDragImage&&b.dataTransfer.setDragImage(a,a.width/2,a.height/2)}},l.setDragTarget=function(a,b,c){c=c||{},a.setAttribute("dragable",!0);var d=b;null!=b&&"string"!=typeof d&&(d=JSON.stringify(d));var e=c.dragImage;a.ondragstart=function(a){d&&a.dataTransfer.setData("Text",d),c.effectAllowed&&(a.dataTransfer.effectAllowed=c.effectAllowed),l.setDragImage(e,a),c.ondragstart&&c.ondragstart(a)},c.ondragend&&(a.ondragend=c.ondragend),c.ondrag&&(a.ondrag=c.ondrag)},l.allowDrop=function(a){a.preventDefault()},l.setDropTarget=function(a,b){b=b||{},b.ondragenter&&(a.ondragenter=b.ondragenter),a.ondragover=function(a){l.allowDrop(a),b.dropEffect&&(a.dataTransfer.dropEffect=b.dropEffect);var c=a.dataTransfer.getData("Text");b.ondragover&&b.ondragover(a,c)},a.ondragleave=b.ondragleave,a.ondrop=function(a){a.preventDefault();var c=a.dataTransfer.getData("Text");b.ondrop&&b.ondrop(a,c)}};var m=function(a){var b=this;this.parentView=$(a),this._accordionVisible=!0,this._propertySheetVisible=!0,this.accordionPane=null,this.ruler=null,this.network2d=null,this.bidQuickFinder=null,this.undoManager=null,this.copyFilter=function(a){return a},this.pasteFilter=function(a){return a},this.flowAndCopyFilter=function(a){return a},this.parentView.resize(function(){b.parentResizeHandle&&b.parentResizeHandle()}),this.contentPane=$('<div class="editor-container"></div>').appendTo(a),this.propertySheetBox=$('<div class="propertySheetBox right-content"></div>').appendTo(this.contentPane),this.accordionPaneBox=$('<div class="accordionPaneBox"></div>').appendTo(this.contentPane),this.networkBox=$('<div class="networkBox"></div>').appendTo(this.contentPane),this.adjustBounds({left:"0px",right:"0px",top:"0px",bottom:"0px"}),this.flowOffsetX=0,this.flowOffsetY=0,this.pasteOffsetDx=j.pasteOffsetX,this.pasteOffsetDy=j.pasteOffsetY,this.pasteOffsetDz=j.pasteOffsetZ,this.pasteOffsetX=j.pasteOffsetX,this.pasteOffsetY=j.pasteOffsetY,this.pasteOffsetZ=j.pasteOffsetZ,this._copyAnchor=[],this._init()};m.prototype={_init:function(){this.setPropertySheetVisible(!0),this.setAccordionVisible(!0),this.propertySheetBox.hide()},setAccordionVisible:function(a){this._accordionVisible!=a&&(this._accordionVisible=a,a?(this.accordionPaneBox.show(),this.networkBox.css("left",200)):(this.accordionPaneBox.hide(),this.networkBox.css("left",0)),this.invalidate())},invalidate:function(){},addKeyMoveListener:function(a){var b=a.getElementBox();a.getView().addEventListener("keydown",function(c){var d=!1,e=a.getPositionMagneticX(),f=a.getPositionMagneticY();37==c.keyCode&&(g.moveSelectionElements(b,"left",e,f),d=!0),38==c.keyCode&&(g.moveSelectionElements(b,"top",e,f),d=!0),39==c.keyCode&&(g.moveSelectionElements(b,"right",e,f),d=!0),40==c.keyCode&&(g.moveSelectionElements(b,"bottom",e,f),d=!0),d&&(c.preventDefault(),c.stopPropagation())})},isAccordionVisible:function(){return this._accordionVisible},setPropertySheetVisible:function(a){this._propertySheetVisible!=a&&(this._propertySheetVisible=a,a?this.propertySheetBox.show():this.propertySheetBox.hide())},resetPropertySheetBoxSize:function(a){var b=this;clearTimeout(this.resetPropertySheetBoxSizeTimer),this.resetPropertySheetBoxSizeTimer=setTimeout(function(){var c=a.getDataDiv().clientHeight;b.propertySheetBox.height(c+1);var d=b.propertySheetBox.width(),e=b.propertySheetBox.height();a.adjustBounds({x:0,y:0,width:d,height:e})},500)},isPropertySheetVisible:function(){return this._propertySheetVisible},adjustBounds:function(a){for(var b in a)this.contentPane.css(b,a[b])},parentResizeHandle:function(){this.ruler&&this.ruler.invalidate(),this.accordionPane&&this.accordionPane.refresh()},getBounds:function(){if(this.parentNode){var a=this.parentNode.getLocation(),b=this.parentNode.getSize();return{width:b.width,height:b.height,x:a.x,y:a.y}}var c=this.network2d.getUnionBounds();return c},getScaleByRegion:function(a,b){var c=this.getBounds(),d=a/c.width,e=b/c.height,f=Math.min(d,e);return f},toCanvas:function(a){var b=this.getBounds(),c=a.scale||1,d=a.x||b.x,e=a.y||b.y,f=a.width||b.width,g=a.height||b.height,h=this.network2d.toCanvasByRegion({width:f,height:g,x:d,y:e},c);return{width:h._viewRect.width,height:h._viewRect.height,content:h}},getImage:function(a){a=a||2;var b=this.toCanvas({scale:a}),c=b.content,d=mono.Utils.nextPowerOfTwo(b.width),e=mono.Utils.nextPowerOfTwo(b.height),f=document.createElement("canvas");f.width=d,f.height=e;var g=f.getContext("2d");return g.clearRect(0,0,d,e),g.drawImage(c,0,0,d,e),f.toDataURL()},getIcon:function(a,b){a=a||84,b=b||84;var c=this.getScaleByRegion(a,b),d=this.getBounds();d.scale=c;var e=this.toCanvas(d).content,f=e.width,g=e.height,h=(a-f)/2,i=(b-g)/2,j=document.createElement("canvas");j.width=a,j.height=b;var k=j.getContext("2d");return k.clearRect(0,0,a,b),k.drawImage(e,h,i),j.toDataURL()},setShowGrid:function(a){this.network2d.setShowGrid(a)},isShowGrid:function(){return this.network2d.isShowGrid()},setAutoShowOrHideGrid:function(a){this.network2d.autoShowOrHide=a},isAutoShowOrHideGrid:function(){return this.network2d.autoShowOrHide},getPositionMagneticX:function(){return this.network2d.getPositionMagneticX()},setPositionMagneticX:function(a){return this.network2d.setPositionMagneticX(a)},getPositionMagneticY:function(){return this.network2d.getPositionMagneticY()},setPositionMagneticY:function(a){return this.network2d.setPositionMagneticY(a)},isPositionMagneticEnabled:function(){return this.network2d.isPositionMagneticEnabled()},setPositionMagneticEnabled:function(a){return this.network2d.setPositionMagneticEnabled(a)},setGrids:function(a){var b=this.network2d.setGrids(a);return this.network2d.repaint(),b},getGrids:function(){return this.network2d.getGrids()},zoomOverview:function(){console.warn("this method[{}] is not supported".format("zoomOverview"))},getData:function(){return console.warn("this method[{}] is not supported".format("getData")),[]},setData:function(a){console.warn("this method[{}] is not supported".format("setData"))},getSelectedData:function(){return console.warn("this method[{}] is not supported".format("getSelectedData")),[]},appendData:function(a){console.warn("this method[{}] is not supported".format("appendData"))},removeData:function(a){console.warn("this method[{}] is not supported".format("appendData"))},clear:function(){return console.warn("this method[{}] is not supported".format("clear")),[]},copySelection:function(a){a=a||this.copyFilter;var b=this.getSelectedData();return this._clearPasteOffset(),a&&(b=a(b)),this._copyAnchor=b,this._copyAnchor},pasteSelection:function(a,b){b=b||this.pasteFilter;var d=this;if(!this._copyAnchor||0==this._copyAnchor.length)return null;var e=this.network2d.getSelectionModel();a=a||this._getPasteOffset();var f=[];this._copyAnchor.forEach(function(e){var h=g.clone(e);if(h.objectId=c.id(),f.push(h),h.position){var i=h.position;h.position=[i[0]+a.x,i[1],i[2]+a.z]}if(h.location){var j=h.location;j instanceof Array?h.location=[i[0]+a.x,i[1]+a.z]:(h.location.x+=a.x,h.location.y+=a.z)}h.x&&(h.x+=a.x),h.y&&(h.y+=a.z),b&&(h=b(h)),h&&d.appendData(h)}),setTimeout(function(){e.clearSelection(),f.forEach(function(a){var b=d.network2d.getElementBox().getDataById(a.objectId);e.appendSelection(b)})},100)},flowAndCopy:function(a,b,d){d=d||this.flowAndCopyFilter;var e=this,f=this.getSelectedData(d);if(1!=f.length)return"you can use this fun only select one data";f=f[0];var h=[],i=this.network2d.getElementBox().getDataById(f.objectId);if(!i.getSize)return"this fun used node";var j=i.getSize();j=j||{width:60,height:60};for(var k=j.width+this.flowOffsetX,l=j.height+this.flowOffsetY,m=k,n=l,o=0;b>o;o++){var p=g.clone(f);if(p.objectId=c.id(),h.push(p),p.position){var q=p.position;"hor"==a?(q[0]+=m,m+=k):(q[2]+=n,n+=l)}d&&(p=d(p)),p&&this.appendData(p)}setTimeout(function(){var a=e.network2d.getSelectionModel();h.forEach(function(b){var c=e.network2d.getElementBox().getDataById(b.objectId);a.appendSelection(c)})},100)},_getPasteOffset:function(){return this.pasteOffsetX+=this.pasteOffsetDx,this.pasteOffsetY+=this.pasteOffsetDy,this.pasteOffsetZ+=this.pasteOffsetDz,{x:this.pasteOffsetX,y:this.pasteOffsetY,z:this.pasteOffsetZ}},_clearPasteOffset:function(){this.pasteOffsetX=0,this.pasteOffsetY=0,this.pasteOffsetZ=0},findByBID:function(a){return this.bidQuickFinder||(this.bidQuickFinder=new twaver.QuickFinder(this.network2d.getElementBox(),"bid","client")),this.bidQuickFinder.findFirst(a)},setUndoManagerEnabled:function(a){this.undoManager=this.undoManager||this.network2d.getElementBox().getUndoManager(),this.undoManager.setEnabled(a)},undo:function(){this.undoManager=this.undoManager||this.network2d.getElementBox().getUndoManager(),this.undoManager.undo()},redo:function(){this.undoManager=this.undoManager||this.network2d.getElementBox().getUndoManager(),this.undoManager.redo()},startBatch:function(){this.undoManager=this.undoManager||this.network2d.getElementBox().getUndoManager(),this.undoManager.startBatch()},endBatch:function(){this.undoManager=this.undoManager||this.network2d.getElementBox().getUndoManager(),this.undoManager.endBatch()}},c.utils.ext(m,Object),c.Editor=m,d.edit.GridNetwork=function(a){a=a||new twaver.ElementBox,d.edit.GridNetwork.superClass.constructor.call(this,a),this._positionMagneticEnabled=!0,this._positionMagneticX=10,this._positionMagneticY=10,this.grids=[],this._showGrid=!0,this.autoShowOrHide=!0,this.grid1={width:1e3,height:1e3,visible:!0,visibleFilter:function(a){return a>.05},shapeColor:"#FF0000",shapeSize:1,shape:"line"},this.grid2={width:100,height:100,skipX:[],skipY:[],visible:!0,visibleFilter:function(a){return a>.12},shapeColor:"#FFAA00",shapeSize:1,shape:"line"},this.grid3={width:50,height:50,skipX:[100],skipY:[100],visible:!0,visibleFilter:function(a){return a>1},shapeColor:"#FFFFAE",shapeSize:1,shape:"line"},this.grid4={width:10,height:10,skipX:[100,50],skipY:[100,50],visible:!0,visibleFilter:function(a){return a>2},shapeColor:"#AAFF00",shapeSize:2.5,shape:"point"},this.initGridNetwork()},d.edit.GridNetwork.prototype={initGridNetwork:function(){var a=this;this.setKeyboardRemoveEnabled(!1),this._box.addDataBoxChangeListener(function(b){var c=b.kind,d=b.data;"add"==c&&a.nodePositionMagneticInit(d)},this),this.addInteractionListener(function(b){if("liveMoveStart"==b.kind){var c=a._box.getSelectionModel().getSelection();a.beginMove(c)}else if("liveMoveEnd"==b.kind){var c=a._box.getSelectionModel().getSelection();a.endMove(c)}else"doubleClickBackground"==b.kind&&a.autoShowOrHide&&a.setShowGrid(!a.isShowGrid())},this),this.addPropertyChangeListener(function(a){"zoom"==a.property&&this.invalidateGrids(this.grids)},this),this.grids.push(this.grid1),this.grids.push(this.grid2),this.grids.push(this.grid3),this.grids.push(this.grid4),this.invalidateGrids(this.grids)},beginMove:function(a){a&&a.size()>0&&a.forEach(function(a){a instanceof twaver.Node&&(a.childNodeLiveMove=!0,a.childNodeLastPoint=a.getLocation(),a.childNodeLastPointOffset={x:0,y:0})})},endMove:function(a){a&&a.size()>0&&a.forEach(function(a){delete a.childNodeLiveMove,delete a.childNodeLastPoint,delete a.childNodeLastPointOffset})},setGrids:function(a){this.grids=a,this.invalidateGrids(this.grids)},getGrids:function(){return this.grids},resizeCanvas:function(a){this.repaint()},repaint:function(){this.invalidateElementUIs()},setShowGrid:function(a){this._showGrid=a,this.repaint()},isShowGrid:function(){return this._showGrid},setCursorPosition:function(a){this.cursorPosition=a,this.repaint()},getCursorPosition:function(){return this.cursorPosition},invalidateGrids:function(a){for(var b=this.getZoom(),c=a.length,d=0;c>d;d++){var e=a[d];e.skipX=[],e.skipY=[];for(var f=0;d>f;f++)e.skipX.push(a[f].width),e.skipY.push(a[f].height);e.visibleFilter&&(e.visible=e.visibleFilter(b))}},isSkipX:function(a,b){for(var c=0;c<a.skipX.length;c++)if(b%a.skipX[c]==0)return!0;return!1},paintGridAction:function(a,b,c,d){var e=b.width,f=b.height,g=b.bound.x,h=b.bound.y,i=b.bound.w,j=b.bound.h,k=a,l=this.getZoom(),m=g%e,n=h%f,g=g-m-e,h=h-n-f,i=i+2*e,j=j+2*f,o=g,p=g+i,q=h,r=h+j,s={xFrom:o,xEnd:p,yFrom:q,yEnd:r,width:i,height:j},t=b.shapeSize/l;k.lineWidth=t,k.strokeStyle=b.shapeColor;var u=t/2;b.offset=u;for(var v=o;p>v;v+=e)this.isSkipX(b,v)||c.call(this,b,k,s,v);for(var w=q;r>w;w+=f)this.isSkipY(b,w)||d.call(this,b,k,s,w)},isSkipY:function(a,b){for(var c=0;c<a.skipY.length;c++)if(b%a.skipY[c]==0)return!0;return!1},paintPointGrid:function(a,b){this.paintGridAction(a,b,this.paintPointGridX,this.paintPointGridY)},paintPointGridX:function(a,b,c,d){for(var e=c.yFrom;e<c.yEnd;e+=a.height)this.isSkipY(a,e)||(b.moveTo(d-a.offset,e),b.lineTo(d+a.offset,e),b.moveTo(d,e-a.offset),b.lineTo(d,e+a.offset))},paintPointGridY:function(a,b,c,d){},paintLineGrid:function(a,b){this.paintGridAction(a,b,this.paintLineGridX,this.paintLineGridY)},paintLineGridX:function(a,b,c,d){b.moveTo(d-a.offset,c.yFrom),b.lineTo(d-a.offset,c.yEnd)},paintLineGridY:function(a,b,c,d){b.moveTo(c.xFrom,d-a.offset),b.lineTo(c.xEnd,d-a.offset)},paintGrid:function(a,b){this._showGrid&&b.visible&&(a.beginPath(),"point"==b.shape?this.paintPointGrid(a,b):this.paintLineGrid(a,b),a.stroke())},paintGrids:function(a,b){var c=this.grids.length;if(c>0){var d=this.getViewRect(),e=this.getZoom(),f=d.x/e,g=d.y/e,h=d.width/e,i=d.height/e,j=a;j.save();for(var d={x:f,y:g,w:h,h:i},k=0;c>k;k++){var l=this.grids[k];l.bound=d,this.paintGrid(a,l)}j.restore()}},paintBottom:function(a,b){this.paintGrids(a,b)},getPositionMagneticX:function(){return this._positionMagneticX},setPositionMagneticX:function(a){this._positionMagneticX=a},getPositionMagneticY:function(){return this._positionMagneticY},setPositionMagneticY:function(a){this._positionMagneticY=a},isPositionMagneticEnabled:function(){return!!this._positionMagneticEnabled},setPositionMagneticEnabled:function(a){return this._positionMagneticEnabled=a},getNodePositionMagneticX:function(a){if(a){var c=a.getClient("magnetic.x");if(c!=b&&null!=c)return c}return this.getPositionMagneticX()},getNodePositionMagneticY:function(a){if(a){var c=a.getClient("magnetic.y");if(c!=b&&null!=c)return c}return this.getPositionMagneticY()},isNodePositionMagneticDisabled:function(a){if(a){var b=a.getClient("magnetic.disabled");if(b)return!0}return!this.isPositionMagneticEnabled()},setNodePositionMagnetic:function(a,b,c){if(!this.isNodePositionMagneticDisabled(a)&&!this.isEditingElement(a))var d=this.getNodePositionMagneticX(a),e=this.getNodePositionMagneticY(a),b=Math.round(b/d)*d,c=Math.round(c/e)*e;a.originalSetLocation(b,c)},nodePositionMagneticInit:function(a){if(a instanceof twaver.Node&&!a.originalSetLocation){var b=this,c=a.setLocation;a.originalSetLocation=c,a.setLocation=function(c,d){if(1==arguments.length){var e=c;c=e.x,d=e.y}b.setNodePositionMagnetic(a,c,d)};var d=a.translate;a.translate=function(c,e){if(a.childNodeLiveMove){a.childNodeLastPointOffset.x+=c,a.childNodeLastPointOffset.y+=e;var f=a.childNodeLastPoint.x+a.childNodeLastPointOffset.x,g=a.childNodeLastPoint.y+a.childNodeLastPointOffset.y;b.setNodePositionMagnetic(a,f,g)}else d.call(a,c,e)};var e=a.getX(),f=a.getY();a.setLocation(e,f)}}},c.utils.ext(d.edit.GridNetwork,twaver.vector.Network),d.edit.PropertySheetPane=function(a){this.rightContent=$('<div class = "right-content"></div>'),this.box=a||new twaver.DataBox,this.initPropertySheet()},twaver.Util.ext(d.edit.PropertySheetPane,Object,{element:null,jsonObj:null,initPropertySheet:function(){this.sheet=new CPropertySheet(this.box),this.sheet.setEditable(!0),this.sheet.setSelectColor("#dadada");var a=this.sheet.getView();a.style.background="white",a.style.position="absolute",a.style.right=0,a.style.top=0,a.style.left=0,a.style.bottom=0,this.rightContent.append($(a));var b=this;this.params=null;var c=new d.edit.Dialog("选择图片资源",{OK:function(a){if(b.params){var d=b.params.view;if(d._isCommitting)return;d._isCommitting=!0,d.commitEditValue(b.params,$("#image-url")[0])}c.hide()},Cancel:function(a){var d=b.params.view;d._isCanceling=!0,d.cancelEditing(),c.hide()}},{close:function(){var a=b.params.view;a._isCanceling=!0,a.cancelEditing(),c.hide()}});$("body").append(c.getView()),c.init(),c.getView().dialog("option","width",500),c.getView().dialog("option","height",400);var e=function(a){return a.indexOf("/")>0?a:make.Default.path+"model/idc/images/"+a};this.sheet.renderEditor=function(a){if(b.params=a,a.view._currentEditor)return a.view._currentEditor;if("image"==a.property.getClient("dataType")){var d=a.property.getClient("dataCategory"),f=a.property.getClient("dataId"),g=((new Date).getTime(),"<label>选择图片资源</label><select id='image-url'>"),h=b.getImageResourcesForEdit(d,f,a.property.getPropertyName());if(!h||!h.length)return a.view._currentEditor;h.forEach(function(b){g+=b===a.value?"<option value="+b+" selected='selected'> "+b+"</option>":"<option value="+b+"> "+b+"</option>"}),g+="</select><br><br><br><image id = 'dialogImage'></image>",c.setData(g),c.show(),$("#dialogImage").attr("src",e(a.value)),$("#image-url").change(function(a){var b=$("#image-url").val();b=e(b),$("#dialogImage").attr("src",b)});var i={view:$("#image-url")[0],onKeyDown:[{keyCode:13,handlerEvent:function(b){var d=a.view;d._isCommitting||(d._isCommitting=!0,d.commitEditValue(a,b.target),c.hide())}},{keyCode:27,handlerEvent:function(b){var d=a.view;d._isCanceling=!0,d.cancelEditing(),c.hide()}}]};return i}return null}},getImageResourcesForEdit:function(a,b,c){var d={"设备":["equipment_front-2U.png","server.png","./idc_images/server001.jpg","./idc_images/server002.jpg","./idc_images/server003.jpg","./idc_images/server004.jpg","./idc_images/server005.jpg"],"板卡":["./idc_images/card1.png","card2.png","./idc_images/card3.png","./idc_images/card4.png","./idc_images/card5.png"],"机柜模型":["alternator-top.jpg","air-condition-side.jpg","battery-top.jpg"]};return d[a]},setElement:function(a){var b=this;if(a){this._setValued=!1;var c=a.id,d=make.Default.getModelDefaultParameterProperties(c),e=this.sheet.getPropertyBox();e.clear(),g.addProperties(e,d),this.jsonObj=make.Default.getModelDefaultParametersValues(c),this._generateNode(a,this.jsonObj),this._setValued=!0}setTimeout(function(){var a=b.sheet.getDataDiv().clientHeight;b.rightContent.height(a+1);var c=b.rightContent.width(),d=b.rightContent.height();b.sheet.adjustBounds({x:0,y:0,width:c,height:d})},500)},_generateNode:function(a,b){this.box.clear();var c=this.node=new twaver.Node({id:a.objectId});c.setClient("id",a.id),this.box.add(c),make.Default.objectWrapper(c,"id",function(){return this.getClient("id")}),make.Default.objectWrapper(c,"objectId",function(){return this.getId()}),delete b.id,delete b.objectId;for(var d in b)make.Default.objectWrapper(c,d),c[d]=a[d]||b[d];this.box.getSelectionModel().setSelection(c)},getData:function(){return make.Default.toJson(this.node)},show:function(a,b){var c=this;this.rightContent.css({marginRight:10,width:220}),c.sheet.invalidate(),setTimeout(function(){var a=c.sheet.getDataDiv().clientHeight;c.rightContent.height(a+1);var b=c.rightContent.width(),d=c.rightContent.height();c.sheet.adjustBounds({x:0,y:0,width:b,height:d})},500),b&&b()},hide:function(){this.rightContent.css({marginRight:-220,width:0})},getView:function(){return this.sheet.getView()}}),CPropertySheet=function(a){CPropertySheet.superClass.constructor.call(this,a)},twaver.Util.ext(CPropertySheet,twaver.controls.PropertySheet,{updateCurrentRowIndex:function(a){var b=this._rowList.size();(0>a||a>=b)&&(a=-1);var c,d=this._currentRowIndex;if(a!==d&&(d>=0&&b>d&&(c=this._rowList.get(d),c.nameRender&&(c.nameRender.style.backgroundColor="")),this._currentRowIndex=a),a>=0&&(c=this._rowList.get(a),c.nameRender&&(c.nameRender.style.backgroundColor=this.getSelectColor(),!this._currentEditor&&c.valueRender&&c.valueRender._editInfo))){
var e=c.valueRender._editInfo,f=this.renderEditor&&this.renderEditor(c);f?(this._currentEditor=f.view,null!=e.value&&(this._currentEditor.value=e.value)):e.enumInfo?this._currentEditor=$html.createSelect(e.enumInfo,e.value):(this._currentEditor=document.createElement("input"),null!=e.value&&(this._currentEditor.value=e.value));var g=this;if(this._currentEditor){if(f&&f.onKeyDown){var h=f.onKeyDown;h&&Array.isArray(h)&&g._currentEditor.addEventListener("keydown",function(a){for(var b=0;b<h.length;b++)if(h[b].combKey){var c=null;switch(h[b].combKey){case"ctrlKey":c=a.ctrlKey;break;case"shiftKey":c=a.shiftKey;break;case"altKey":c=a.altKey}a.keyCode===h[b].keyCode&&c&&h[b].handlerEvent&&h[b].handlerEvent(a)}else a.keyCode===h[b].keyCode&&h[b].handlerEvent&&h[b].handlerEvent(a)})}else this._currentEditor.addEventListener("keydown",function(a){var b=a.target._editInfo.view;if(13!==a.keyCode||!a.shiftKey)if(13===a.keyCode){if(b._isCommitting)return;b._isCommitting=!0,b.commitEditValue(a.target._editInfo,a.target)}else 27===a.keyCode&&(b._isCanceling=!0,b.cancelEditing())},!1);if(this._currentEditor.keepDefault=!0,this._currentEditor._rowInfo=c,this._currentEditor._editInfo=e,!this._currentEditor.parentNode){var i=this._currentEditor.style;i.position="absolute",i.margin="0px",i.border="0px",i.padding="0px",i.left=this._indent+this._propertyNameWidth+"px",i.top=c.rowDiv.style.top,i.width=c.valueRender.style.width,i.height=c.valueRender.style.height,this._rootDiv.appendChild(this._currentEditor)}twaver.Util.setFocus(this._currentEditor)}}}}),d.edit.Ruler=function(a){d.edit.Ruler.superClass.constructor.apply(this,arguments),this._view=this.createElement("div"),this._view.style.position="absolute",this._view.style.left="0px",this._view.style.right="0px",this._view.style.top="0px",this._view.style.bottom="0px",this._topRuler=this.createElement("canvas"),this._leftRuler=this.createElement("canvas"),this._initRuler(),this.setComponent(a),this.init(),this.invalidate()},twaver.Util.ext(d.edit.Ruler,twaver.controls.ViewBase,{_defaultGap:10,_rulerWidth:20,_lineColor:"#888",_lineIntervalLineColor:"#ccc",_mousePoint:null,_showGuides:!0,onPropertyChanged:function(a){this.invalidate()},init:function(){this._topRuler.visible&&this._view.appendChild(this._topRuler),this._leftRuler.visible&&this._view.appendChild(this._leftRuler),this.component.getView?this._view.appendChild(this.component.getView()):this._view.appendChild(this.component)},setComponent:function(a){var b=this.component,c=this;this.component=a,this.firePropertyChange("component",b,a),this.addViewPropertyChangeListener(a,this._handleViewPropertyChange),$(this._view).resize(function(){var a=$(this._view).width(),b=$(this._view).height();c.component.adjustBounds({x:0,y:0,width:a,height:b}),c.invalidate()})},getAbsPostion:function(a){for(var b=0,c=0;a=a.offsetParent;)b+=a.offsetTop,c+=a.offsetLeft;return{left:c,top:b}},_initRuler:function(){this._topRuler.visible=!0,this._leftRuler.visible=!0,this._topRuler.style.borderBottom="1px solid "+this._lineColor,this._topRuler.style.borderLeft="1px solid "+this._lineColor,this._leftRuler.style.borderRight="1px solid "+this._lineColor,this._leftRuler.style.borderTop="1px solid "+this._lineColor},_drawRuler:function(){var a=this.getComponentViewRect(),b=this.getComponentZoom();this.calculateGap(b);var c=this.getGap(),d=a.x,e=a.y,f=a.width,h=a.height,i=d%(5*c),d=d-i-5*c-1,j=Math.round((a.x-i-5*c)/b),k=d-a.x;1===Math.abs(Math.round(d/(5*c))%2)&&(k-=5*c,j-=5*this._defaultGap);var l=f+10*c;if(a&&this._topRuler.visible){var m=g.transformAndScaleCanvasContext(this._topRuler);this._drawHRuler(m,k,j,c,l,this._rulerWidth)}var n=e%(5*c),e=e-n-5*c-1,o=Math.round((a.y-n-5*c)/b),p=e-a.y;1===Math.abs(Math.round(e/(5*c))%2)&&(p-=5*c,o-=5*this._defaultGap);var q=h+10*c;if(a&&this._leftRuler.visible){var m=g.transformAndScaleCanvasContext(this._leftRuler);this._drawVRuler(m,p,o,c,q,this._rulerWidth)}},_drawHRuler:function(a,b,c,d,e,f){a.clearRect(b,0,e,f),a.save(),a.strokeStyle=this._lineIntervalLineColor,a.beginPath(),a.lineWidth=1;for(var g=1,h=f,i=f-6,j=(this.getComponentZoom(),b+d);b+e>j;j+=d)i=f-6,g%5==0&&(i=f-10),g%10!==0&&(a.moveTo(j,h),a.lineTo(j,i)),g++;a.closePath(),a.stroke(),g=1,a.beginPath(),a.strokeStyle=this._lineColor;for(var j=b+d;b+e>j;j+=d)g%10===0&&(i=1,a.moveTo(j,h),a.lineTo(j,i)),g++;a.stroke(),a.restore(),a.save(),a.textBaseline="middle",a.font="11px Arial",a.fillStyle=this._lineColor;for(var k=c,l=b;b+e>l;l+=10*d,k+=10*this._defaultGap)a.fillText(k,l+5,8);a.restore(),this._showGuides&&this._mousePoint&&(a.save(),a.strokeStyle="#f07819",a.lineWidth=3,a.beginPath(),a.moveTo(this._mousePoint.x,0),a.lineTo(this._mousePoint.x,20),a.stroke(),a.restore())},_drawVRuler:function(a,b,c,d,e,f){a.clearRect(0,b,f,e),a.save(),a.strokeStyle=this._lineIntervalLineColor,a.beginPath(),a.lineWidth=1;for(var g=1,h=f,i=f-6,j=(this.getComponentZoom(),b+d);b+e>j;j+=d)i=f-6,g%5==0&&(i=f-10),g%10!==0&&(a.moveTo(h,j),a.lineTo(i,j)),g++;a.closePath(),a.stroke(),a.restore(),g=1,a.beginPath(),a.strokeStyle=this._lineColor;for(var j=b+d;b+e>j;j+=d)g%10===0&&(i=1,a.moveTo(h,j),a.lineTo(i,j)),g++;a.stroke(),a.restore(),a.save(),a.textBaseline="middle",a.textAlign="left",a.font="11px Arial",a.fillStyle=this._lineColor;for(var k=c,l=b;b+e>l;l+=10*d,k+=10*this._defaultGap){a.save();var m=_twaver.g.getTextSize(a.font,k),n={x:2,y:l-8,width:m.width,height:m.height};a.translate(n.x,n.y),a.rotate(3*Math.PI/2),a.translate(-n.x,-n.y),a.fillText(k,0,l-2),a.restore()}a.restore(),this._showGuides&&this._mousePoint&&(a.save(),a.strokeStyle="#f07819",a.lineWidth=3,a.beginPath(),a.moveTo(0,this._mousePoint.y),a.lineTo(20,this._mousePoint.y),a.stroke(),a.restore())},getComponentZoom:function(){return this.component.getZoom()||1},getGap:function(){var a=this.getComponentZoom();return this._defaultGap*a},calculateGap:function(a){.17>a?this._defaultGap=50:.5>a?this._defaultGap=20:.9>a?this._defaultGap=10:3.2>a?this._defaultGap=5:this._defaultGap=1},setShowGuides:function(a){this._showGuides;this._showGuides=a,this._drawRuler()},isShowGuides:function(){return this._showGuides},setShowRuler:function(a){var b=this._topRuler.visible;this._topRuler.visible=a,this._leftRuler.visible=a,a?(this.hasChildNode(this._view,this._topRuler)||this._view.appendChild(this._topRuler),this.hasChildNode(this._view,this._leftRuler)||this._view.appendChild(this._leftRuler)):(this.hasChildNode(this._view,this._topRuler)&&this._view.removeChild(this._topRuler),this.hasChildNode(this._view,this._leftRuler)&&this._view.removeChild(this._leftRuler)),this.firePropertyChange("showRuler",b,a)},hasChildNode:function(a,b){var c=a.childNodes;for(var d in c)if(c[d]==b)return!0;return!1},getComponentViewRect:function(){return this.component.getViewRect?this.component.getViewRect():null},addViewPropertyChangeListener:function(a,b){a&&a.addPropertyChangeListener&&a.addPropertyChangeListener(b,this)},_handleViewPropertyChange:function(a){"viewRect"==a.property&&this._drawRuler()},createElement:function(a){return document.createElement(a)},validateImpl:function(){var a=this._view.offsetWidth,b=this._view.offsetHeight,c=0,d=0,e=0,f=0,h=0,i=0,j=a,k=b;this._topRuler.visible&&(c=this._rulerWidth,f=this._rulerWidth,i=this._rulerWidth),this._leftRuler.visible&&(d=this._rulerWidth,e=this._rulerWidth,h=this._rulerWidth),j=a-d,k=b-c,this._topRuler.visible&&(this._topRuler.width=j,this._topRuler.height=c,_twaver.setViewBounds(this._topRuler,{x:e,y:0,width:j,height:c}),g.transformAndScaleCanvasContext(this._topRuler,!0)),this._leftRuler.visible&&(this._leftRuler.width=d,this._leftRuler.height=k,_twaver.setViewBounds(this._leftRuler,{x:0,y:f,width:d,height:k}),g.transformAndScaleCanvasContext(this._leftRuler,!0)),this.component&&(_twaver.setViewBounds(this.component,{x:h,y:i,width:j,height:k}),g.transformAndScaleCanvasContext(this.component._rootCanvas,!0)),this._drawRuler()},getView:function(){return this._view},left:function(a){this._view.style.left=a+"px",this.invalidate()}});var n=function(a){n.superClass.constructor.call(this,a),this.currentItem=null,this.pasteOffsetDz=0,this.parentNode=null,this.model3dTo2dMapping=j.deviceEditorModel3dTo2dMapping,this.model2dTo3dMapping=j.deviceEditorModel2dTo3dMapping,this.copyChildNode=null,this.lastSelectedChildNode=null,this._editable=!1,this.isAddChildNode=!1,this.KEY_CODE_COPY_ONE=81,this.PANEL_CATEGORY="设备面板",this.init()};n.prototype={init:function(){var a=this;this.accordionPane=new c.AccordionPane,this.network2dView=this._initNetwork2d(),this.network2d.setMaxZoom(40);var b=this.sheet=new twaver.controls.PropertySheet(this.box);g.initPropertySheet(b);var d=this.propertySheetBox.width(),e=this.propertySheetBox.height();b.adjustBounds({x:0,y:0,width:d,height:e}),this.propertySheetBox.append(this.sheet.getView()),this.accordionPaneBox.append(this.accordionPane.getView()),this.networkBox.append(this.network2dView),this.copyChildNode=this._createCopyChildNode(),this.addKeyMoveListener(this.network2d),$(this.network2dView).on("mousemove",function(b){if(a.copyChildNode){var c=a.network2d.getLogicalPoint(b);a.copyChildNode.setCenterLocation(c)}}),$(document).on("keyup",function(b){b.keyCode==a.KEY_CODE_COPY_ONE&&a.box.contains(a.copyChildNode)&&a.box.remove(a.copyChildNode)}),$(this.network2dView).on("keydown",function(b){if(32==b.keyCode){var c=a.box.getSelectionModel().getLastData();if(!c)return;var d=c.getAngle();c.setAngle(d+90)}else if(b.keyCode==a.KEY_CODE_COPY_ONE&&a.lastSelectedChildNode&&!a.box.contains(a.copyChildNode)){var e=a.lastSelectedChildNode.getSize(),d=a.lastSelectedChildNode.getAngle();a.copyChildNode.setSize(e),a.copyChildNode.setAngle(d),a.copyChildNode.setClient("id",a.lastSelectedChildNode.getClient("id")),a.box.add(a.copyChildNode)}else 8==b.keyCode&&b.preventDefault()}),$(this.network2dView).on("dblclick",function(b){a.network2d.setDefaultInteractions()}),$(this.network2dView).on("click",function(b){if(a.box.contains(a.copyChildNode)){var c=a.copyChildNode.getClient("id"),d=a.network2d.getLogicalPoint(b),e=a.copyChildNode.getSize(),f=a.copyChildNode.getAngle(),g=[d.x,d.y,0];g[0]-=e.width/2,g[1]-=e.height/2;var h={position:g,rotation:[0,0,f],width:e.width,height:e.height};return a.loadChild(c,h),b.preventDefault(),!1}}),this.refreshAccordion()},_initNetwork2d:function(){var a=this,b=this.network2d=new d.edit.GridNetwork;this.network2d.setPositionMagneticX(5),this.network2d.setPositionMagneticY(5),this.network2d.setEditableFunction(function(b){return!a.isHost(b)&&a.copyChildNode!=b||a.isResizeable(b)});var c=this.box;this.network2d.getView().addEventListener("keydown",function(b){var d=!1,e=a.network2d.getPositionMagneticX(),f=a.network2d.getPositionMagneticY();37==b.keyCode&&(g.moveSelectionElements(c,"left",e,f),d=!0),38==b.keyCode&&(g.moveSelectionElements(c,"top",e,f),d=!0),39==b.keyCode&&(g.moveSelectionElements(c,"right",e,f),d=!0),40==b.keyCode&&(g.moveSelectionElements(c,"bottom",e,f),d=!0),d&&(b.preventDefault(),b.stopPropagation())});var c=this.box=this.network2d.getElementBox(),e=this.packQuickFinder=new twaver.QuickFinder(this.box,"pack","client"),f=this.selectionModel=this.box.getSelectionModel();f.addSelectionChangeListener(function(b){var c=f.getLastData();clearTimeout(a.selectionChangeHandleTimer),a.selectionChangeHandleTimer=setTimeout(function(){a._resetPropertySheet(),a.lastSelectedChildNode=null,c&&!a.isHost(c)&&(a.lastSelectedChildNode=c),a.parentNode&&(a.network2d.isSelected(a.parentNode)?a.parentNode.setStyle("whole.alpha",1):f.size()>0?a.parentNode.setStyle("whole.alpha",.3):a.parentNode.setStyle("whole.alpha",1))},100);var d=f.getSelection();if(d&&0!=d.size()){var g=c.getClient("pack");if(g){var h=e.find(g);if(d)for(var i=0;i<d.size();i++){var j=d.get(i);h.contains(j)||(f.removeSelection(j),i--)}h.forEach(function(a){f.contains(a)||f.appendSelection(a)},this)}}}),f.setFilterFunction(function(b){return a.isEditable(b)});var h=c.getLayerBox(),i=this.parentLayer=new twaver.Layer("parentLayer"),j=this.childrenLayer=new twaver.Layer("childrenLayer");h.add(i),h.add(j),h.moveToTop(i);var k=this.network2d.getView();l.setDropTarget(k,{self:this,dropEffect:"copy",ondrop:function(d,e){e=JSON.parse(e);var f=e.id;if(!a.onDropHandler||!a.onDropHandler(d,e,c,b)){var g=make.Default.getOtherParameter(f,"category");if(g==a.PANEL_CATEGORY)return void a.setData(make.Default.load(f));var h=a.network2d.getLogicalPoint(d),i=make.Default.getOtherParameter(a.getEditId(f),"host"),j={position:[h.x,h.y,0],centerLocation:{x:h.x,y:h.y}},k=null;i?(k=a.loadParent(f,j),setTimeout(function(){a.network2d.zoomOverview()},100)):k=a.loadChild(f,j),k&&(a.selectionModel.clearSelection(),a.selectionModel.setSelection(k),a._resetPropertySheet())}},ondragover:function(a){},ondragleave:function(a){}});var m=this.ruler=new d.edit.Ruler(this.network2d);m.getView().setAttribute("class","room-ruler"),m.setShowGuides(!1),m.setShowRuler(!0);var n=$(m.getView());return n},onDropHandler:function(a,b,c,d){},getEditId:function(a){return g.getDeviceEditorModel2dId(a)},isEditable:function(a){return a.getClient("editable")===!0?!0:!this.isHost(a)},isHost:function(a){return!!a.getClient("host")},isResizeable:function(a){return!!a.getClient("resizeable")},_createCopyChildNode:function(){var a=new twaver.Node;return a.setLayerId(this.childrenLayer.getId()),a.setStyle("body.type","vector"),a.setStyle("vector.shape","rectangle"),a.setStyle("vector.fill",!1),a.setStyle("vector.outline.width",2),a.setStyle("vector.outline.color","#a0a819"),a},loadChildren:function(a){var b=[],c=this,d=[];if(a instanceof Array)a.forEach(function(a){if(make.Default.getOtherParameter(a.id,"link"))d.push(a);else{var e=c.loadChild(a.id,a);b.push(e)}}),d.forEach(function(a){var d=c.loadChild(a.id,a);b.push(d)});else{var e=c.loadChild(a.id,a);b.push(e)}return b},loadChild:function(a,b){this.parentNode||console.warn("parentNode is null");var d=this;a=a.replace("."+j.DEVICE_MODEL_SUFFIX,""),b.id=this.getEditId(a),b.objectId=c.id();var e=make.Default.load(b);if(make.Default.getOtherParameter(b.id,"link")){var f=e;f.setFromNode(d.findByBID(b.from)),f.setToNode(d.findByBID(b.to)),d.box.add(f)}else if(e instanceof Array){var g=e;g.forEach(function(a){a.setLayerId(d.childrenLayer.getId()),d.parentNode&&a.setHost(d.parentNode),d.box.add(a)})}else{var h=e;h.setLayerId(d.childrenLayer.getId()),d.parentNode&&h.setHost(d.parentNode),d.box.add(h)}return e},loadParent:function(a,b){a=a.replace("."+j.DEVICE_MODEL_SUFFIX,""),b.id=this.getEditId(a),b.objectId=c.id(),this.box.clear();var d=make.Default.load(b);return d.setLayerId(this.parentLayer.getId()),d.setLocation(0,0),d.setMovable(!1),this.parentNode=d,this.startBatch(),this.box.add(d),this.endBatch(),d},setData:function(a){for(var b=this,c=[],d=0;d<a.length;d++){var e=a[d];make.Default.getOtherParameter(e.id,"link")?c.push(e):0==d&&make.Default.getOtherParameter(e.id,"host")?b.loadParent(e.id,e):b.loadChild(e.id,e)}c.forEach(function(a){b.loadChild(a.id,a)})},clear:function(){this.box.clear()},_resetPropertySheet:function(){if(this.isPropertySheetVisible()){var a=this,b=a.sheet.getPropertyBox();b.clear();var c=this.box.getSelectionModel();if(1!=c.size())b.clear(),this.propertySheetBox.hide();else{this.propertySheetBox.show();var d=c.getLastData();g.addProperties(b,make.Default.getModelDefaultParameterProperties(make.Default.getId(d))),a.resetPropertySheetBoxSize(this.sheet)}}},align:function(a){var b=this;if(a){var c=this.selectionModel.getSelection(),d=new twaver.List;c.forEach(function(a){a&&!b.isHost(a)&&d.add(a)}),!d||d.size()<2||make.Default.align(d,a)}},flow:function(a,b){var c=this;if(a){var d=this.selectionModel.getSelection(),e=new twaver.List;d.forEach(function(a){a&&!c.isHost(a)&&e.add(a)}),!e||e.size()<2||make.Default.flow(e,a,b)}},zoomOverview:function(){this.network2d.zoomOverview()},setMouseEditable:function(a){var b=this._editable;b!=a&&(this._editable=a,this._editable?this.network2d.setInteractions([new twaver.vector.interaction.DefaultInteraction(this.network2d),new twaver.vector.interaction.EditInteraction(this.network2d)]):this.network2d.setInteractions([new twaver.vector.interaction.DefaultInteraction(this.network2d)]))},setDragToPan:function(a){this.network2d.setDragToPan(a)},getData:function(){var a=[],b=this;return this.box.forEach(function(c){if(c==b.parentNode){var d=make.Default.toJson(c);a.splice(0,0,d)}else{var d=make.Default.toJson(c);a.push(d)}}),a},appendData:function(a){this.loadChildren(a)},removeData:function(a){var b=this;return a instanceof Array?a.map(function(a){return b.box.removeById(a.objectId)}):b.box.removeById(a.objectId)},getSelectedData:function(){var a=this,b=[],c=this.selectionModel.getSelection().toList();return c&&c.size()>0&&c.forEach(function(c){if(!a.isHost(c)){var d=make.Default.toJson(c);b.push(d)}}),b},refreshAccordion:function(a){a=a||c.utils.load2dDeviceCategory(),this.accordionPane.setCategories(a)}},c.DeviceEditor=n,c.utils.ext(n,m),CircuitCreateLinkInteraction=function(a,b){CircuitCreateLinkInteraction.superClass.constructor.call(this,a,b)},twaver.Util.ext("CircuitCreateLinkInteraction",twaver.vector.interaction.CreateLinkInteraction,{paint:function(a){a.beginPath();a.lineWidth=this.network.getEditLineWidth(),this.currentPoint&&this.paintLine(a),a.closePath()},paintLine:function(a){var b=this.network.getEditLineColor(),c=this.fromNode.hotPoint.x,d=this.fromNode.hotPoint.y,e=this.currentPoint.x,f=this.currentPoint.y,g=this.network.getViewRect();isFoleLink?(a.strokeStyle=b,a.beginPath(),a.moveTo(c-g.x,d-g.y),a.lineTo(e,d-g.y),a.lineTo(e,f),a.stroke()):(a.strokeStyle=b,a.beginPath(),a.moveTo(c-g.x,d-g.y),a.lineTo(e,f),a.stroke())},clear:function(){this.currentPoint=null,this.currentNode=null,this.fromNode=null,this.toNode=null,this.lastNode=null},handle_mousedown:function(a){if(this.network.isValidEvent(a)){if(this.fromNode){if(this.toNode=this.currentNode,this.toNode instanceof twaver.HorizontalLine){var b=this.createLink(),c=this.toNode.getClient("IntersectionPointOffset")||0;b.s("link.to.percent",[c,0]),b&&this.network.addElementByInteraction(b),this.lastNode.setClient("IntersectionPoint",null)}else if(this.toNode instanceof twaver.VerticalLine){var b=this.createLink(),c=this.toNode.getClient("IntersectionPointOffset")||0;b.s("link.to.percent",[0,c]),b&&this.network.addElementByInteraction(b),this.lastNode.setClient("IntersectionPoint",null)}else if(this.toNode instanceof twaver.Node){var d=this.network.getElementUI(this.toNode);if(!d)return;var e=d._hotPoint1,f=d._hotPoint2;if(!e||!f)return;var g=this.network.getLogicalPoint2(a);Math.pow(g.x-e.x,2)+Math.pow(g.y-e.y,2)<Math.pow(g.x-f.x,2)+Math.pow(g.y-f.y,2)?this.toNode.hotPoint=e:this.toNode.hotPoint=f;var b=this.createLink();b&&this.network.addElementByInteraction(b)}this.clear()}else{this.fromNode=this.currentNode,this.currentNode=null,this.currentPoint=null,this.repaint();var d=this.network.getElementUI(this.fromNode);if(!d)return;var e=d._hotPoint1,f=d._hotPoint2;if(!e||!f)return;var g=this.network.getLogicalPoint2(a);Math.pow(g.x-e.x,2)+Math.pow(g.y-e.y,2)<Math.pow(g.x-f.x,2)+Math.pow(g.y-f.y,2)?this.fromNode.hotPoint=e:this.fromNode.hotPoint=f}if(this.lastNode){var h=this.lastNode;h.setClient("drawIntersectionPoint1",!1),h.setClient("drawIntersectionPoint2",!1),h.setClient("IntersectionPoint",null)}}},handle_mousemove:function(a){var b=this.getMarkerPoint(a);if(b){if(this.network.isMovingElement()||this.network.isEditingElement())return void this.clear();var c=null;if(this.fromNode){if(this.currentNode=this.getToNode(a,this.fromNode),this.currentPoint=b,this.repaint(),this.currentNode instanceof twaver.HorizontalLine){var d=this.currentNode.getPoints();if(2!==d.size())return;var e=this.network.getLogicalPoint2(a),f=this.currentNode.getLineLength(),g=Math.abs(e.x-d.get(0).x)/f;this.currentNode.setClient("IntersectionPointOffset",g),Math.abs(g)>0&&Math.abs(g)<1&&(g*=f);var h={x:d.get(0).x+g,y:d.get(0).y};this.currentNode.setClient("IntersectionPoint",h),this.lastNode=this.currentNode,this.currentNode.hotPoint=h}else if(this.currentNode instanceof twaver.VerticalLine){var d=this.currentNode.getPoints();if(2!==d.size())return;var e=this.network.getLogicalPoint2(a),f=this.currentNode.getLineLength(),i=Math.abs(e.y-d.get(0).y)/f;this.currentNode.setClient("IntersectionPointOffset",i),Math.abs(i)>0&&Math.abs(i)<1&&(i*=f);var h={x:d.get(0).x,y:d.get(0).y+i};this.currentNode.setClient("IntersectionPoint",h),this.lastNode=this.currentNode,this.currentNode.hotPoint=h}else if(this.currentNode instanceof twaver.Node){if(!this.currentNode.getClient("connectable"))return;var j=this.network.getElementUI(this.currentNode),k=j._hotPoint1,l=j._hotPoint2;if(this.lastNode=this.currentNode,!k||!l)return;var e=this.network.getLogicalPoint2(a);Math.pow(e.x-k.x,2)+Math.pow(e.y-k.y,2)<Math.pow(e.x-l.x,2)+Math.pow(e.y-l.y,2)?this.currentNode.setClient("drawIntersectionPoint1",!0):this.currentNode.setClient("drawIntersectionPoint2",!0)}else if(this.lastNode){var m=this.lastNode;m.setClient("drawIntersectionPoint1",!1),m.setClient("drawIntersectionPoint2",!1),m.setClient("IntersectionPoint",null)}}else if(c=this.getFromNode(a),this.currentNode!==c)if(this.currentNode=c,c instanceof twaver.Node){if(this.lastNode=c,!c.getClient("connectable"))return;var j=this.network.getElementUI(c),k=j._hotPoint1,l=j._hotPoint2;if(!k||!l)return;var e=this.network.getLogicalPoint2(a);Math.pow(e.x-k.x,2)+Math.pow(e.y-k.y,2)<Math.pow(e.x-l.x,2)+Math.pow(e.y-l.y,2)?c.setClient("drawIntersectionPoint1",!0):c.setClient("drawIntersectionPoint2",!0)}else if(this.lastNode){var m=this.lastNode;m.setClient("drawIntersectionPoint1",!1),m.setClient("drawIntersectionPoint2",!1)}}},getNode:function(a,b){var c=this.network.getElementAt(a);return c instanceof twaver.Node&&this.network.isLinkable(c,b)&&this.network.getElementBox().getSelectionModel().isSelectable(c)?c:null}}),CircuitCreatePolyLineInteraction=function(a,b){CircuitCreatePolyLineInteraction.superClass.constructor.call(this,a,b)},twaver.Util.ext("CircuitCreatePolyLineInteraction",twaver.vector.interaction.CreateShapeNodeInteraction,{handle_mousedown:function(a){if(0===a.button){var b=this.network.getLogicalPoint2(a);if(b){if(2===a.detail||a.timeStamp-this.timeStamp<300){if(this.points){var c=this.shapeNodeFunction(this.points);this.network.addElementByInteraction(c),this.clear();var d=this;setTimeout(function(){d.network.setEditingElement(!1)},0)}}else{if(this.network.isEditingElement()||this.network.setEditingElement(!0),this.points||(this.points=new twaver.List),this.points.size()>0){var e=this.points.get(this.points.size()-1);if(e.x===b.x&&e.y===b.y)return;Math.abs(b.x-e.x)>=Math.abs(b.y-e.y)?b.y=e.y:b.x=e.x}this.points.add(b)}this.timeStamp=a.timeStamp,this.repaint()}}},handle_mousemove:function(a){this.points&&(this.currentPoint=this.network.getLogicalPoint2(a),this.repaint())}});var o=function(a){o.superClass.constructor.call(this,a),this.currentItem=null,this.parentNode=null,this.model3dTo2dMapping=j.circuitEditorModel3dTo2dMapping,this.model2dTo3dMapping=j.circuitEditorModel2dTo3dMapping,this.copyChildNode=null,this.lastSelectedChildNode=null,this._editable=!1,this.isAddChildNode=!1,this.KEY_CODE_COPY_ONE=0,this.PANEL_CATEGORY="设备面板",this.init()};o.prototype={init:function(){var a=this;this.accordionPane=new c.AccordionPane,this.network2dView=this._initNetwork2d(),this.network2d.setMaxZoom(40);var b=this.sheet=new twaver.controls.PropertySheet(this.box);g.initPropertySheet(b);var d=this.propertySheetBox.width(),e=this.propertySheetBox.height();b.adjustBounds({x:0,y:0,width:d,height:e}),this.propertySheetBox.append(this.sheet.getView()),this.accordionPaneBox.append(this.accordionPane.getView()),this.networkBox.append(this.network2dView),this.copyChildNode=this._createCopyChildNode(),$(this.network2dView).on("mousemove",function(b){if(a.copyChildNode){var c=a.network2d.getLogicalPoint(b);a.copyChildNode.setCenterLocation(c)}}),$(document).on("keyup",function(b){b.keyCode==a.KEY_CODE_COPY_ONE&&a.box.contains(a.copyChildNode)&&a.box.remove(a.copyChildNode)}),$(this.network2dView).on("keydown",function(b){if(32==b.keyCode){var c=a.box.getSelectionModel().getLastData();if(!c)return;var d=c.getAngle();c.setAngle(d+90)}else if(b.keyCode==a.KEY_CODE_COPY_ONE&&a.lastSelectedChildNode&&!a.box.contains(a.copyChildNode)){var e=a.lastSelectedChildNode.getSize(),d=a.lastSelectedChildNode.getAngle();a.copyChildNode.setSize(e),a.copyChildNode.setAngle(d),a.copyChildNode.setClient("id",a.lastSelectedChildNode.getClient("id")),a.box.add(a.copyChildNode)}else 8==b.keyCode&&b.preventDefault()}),$(this.network2dView).on("dblclick",function(b){a.network2d.setDefaultInteractions()}),$(this.network2dView).on("click",function(b){if(a.box.contains(a.copyChildNode)){var c=a.copyChildNode.getClient("id"),d=a.network2d.getLogicalPoint(b),e=a.copyChildNode.getSize(),f=a.copyChildNode.getAngle(),g={centerLocation:{x:d.x,y:d.y},width:e.width,height:e.height,angle:f};return a.loadChild(c,g),b.preventDefault(),!1}}),this.refreshAccordion()},_initNetwork2d:function(){var a=this,b=this.network2d=new d.edit.GridNetwork;this.network2d.setPositionMagneticX(5),this.network2d.setPositionMagneticY(5),this.network2d.setWheelToZoom(!1),this.network2d.setPositionMagneticEnabled(!1),this.network2d.setEditableFunction(function(b){return!a.isHost(b)&&a.copyChildNode!=b||a.isResizeable(b)});var c=this.box=this.network2d.getElementBox(),e=this.selectionModel=this.box.getSelectionModel();e.addSelectionChangeListener(function(b){clearTimeout(a.selectionChangeHandleTimer),a.selectionChangeHandleTimer=setTimeout(function(){a._resetPropertySheet(),a.lastSelectedChildNode=null;var b=e.getLastData();b&&!a.isHost(b)&&(a.lastSelectedChildNode=b),a.parentNode&&(a.network2d.isSelected(a.parentNode)?a.parentNode.setStyle("whole.alpha",1):e.size()>0?a.parentNode.setStyle("whole.alpha",.3):a.parentNode.setStyle("whole.alpha",1)),a.network2d.invalidate()},100)}),e.setFilterFunction(function(b){return a.isEditable(b)});var f=c.getLayerBox(),g=this.parentLayer=new twaver.Layer("parentLayer"),h=this.childrenLayer=new twaver.Layer("childrenLayer");f.add(g),f.add(h),f.moveToTop(g);var i=this.network2d.getView();l.setDropTarget(i,{self:this,dropEffect:"copy",ondrop:function(d,e){e=JSON.parse(e);var f=e.id;if(!a.onDropHandler||!a.onDropHandler(d,e,c,b)){var g=make.Default.getOtherParameter(f,"category");if(g==a.PANEL_CATEGORY)return void a.setData(make.Default.load(f));var h=a.network2d.getLogicalPoint(d),i=make.Default.getOtherParameter(a.getEditId(f),"host"),j={centerLocation:{x:h.x,y:h.y}},k=null;i?(k=a.loadParent(f,j),setTimeout(function(){a.network2d.zoomOverview()},100)):k=a.loadChild(f,j),k&&(a.selectionModel.clearSelection(),a.selectionModel.setSelection(k),a._resetPropertySheet())}},ondragover:function(a){},ondragleave:function(a){}});var j=this.ruler=new d.edit.Ruler(this.network2d);j.getView().setAttribute("class","room-ruler"),j.setShowGuides(!1),j.setShowRuler(!0);var k=$(j.getView());return k},onDropHandler:function(a,b,c,d){var e=b.id,f=make.Default.getOtherParameter(e,"interaction");if("createPolyLink"===f)d.setInteractions([new CircuitCreatePolyLineInteraction(d,function(a){var b=make.Default.load(e);return b.setPoints(a),b}),new twaver.vector.interaction.DefaultInteraction(d)]);else if("createLink"==f)return isFoleLink=!1,d.setInteractions([new CircuitCreateLinkInteraction(d,function(a,b){var c,d=a.getCenterLocation(),f=b.getCenterLocation(),g="arc";if(b instanceof twaver.HorizontalLine){if(a.hotPoint)if(a.hotPoint.x>d.x)c=[1,.5];else if(a.hotPoint.x<d.x)c=[0,.5];else if(a.hotPoint.y>d.y){c=[.5,1];var h={x:a.hotPoint.x,y:a.hotPoint.y+30}}else{c=[.5,0];var h={x:a.hotPoint.x,y:a.hotPoint.y-30}}else c=[.5,.5];var i=make.Default.load({id:e,style:{"link.from.percent":c,"link.bundle.enable":!1,"link.type":"arc","link.corner":"none"},client:{"link.type":"HorizontalLine",fromControlPoint:h}});return i.setFromNode(a),i.setToNode(b),i}if(b instanceof twaver.VerticalLine){c=a.hotPoint?a.hotPoint.x>d.x?[1,.5]:a.hotPoint.x<d.x?[0,.5]:a.hotPoint.y>d.y?[.5,1]:[.5,0]:[.5,.5];var i=make.Default.load({id:e,style:{"link.from.percent":c,"link.bundle.enable":!1,"link.type":"arc","link.corner":"none"},client:{"link.type":"VerticalLine"}});return i.setFromNode(a),i.setToNode(b),i}if(a.hotPoint&&b.hotPoint){a.hotPoint.x>d.x&&b.hotPoint.x<f.x?g="orthogonal.horizontal":a.hotPoint.x>d.x&&b.hotPoint.x>f.x?g="extend.right":a.hotPoint.x>d.x?g="orthogonal.H.V":a.hotPoint.x<d.x&&b.hotPoint.x<f.x?g="extend.left":a.hotPoint.x<d.x&&b.hotPoint.x>f.x?g="orthogonal.horizontal":a.hotPoint.x<d.x?g="orthogonal.H.V":a.hotPoint.y>d.y&&b.hotPoint.y<f.y?g="orthogonal.vertical":a.hotPoint.y>d.y&&b.hotPoint.y>f.y?g="extend.bottom":a.hotPoint.y>d.y?g="orthogonal.V.H":a.hotPoint.y<d.y&&b.hotPoint.y<f.y?g="extend.top":a.hotPoint.y<d.y&&b.hotPoint.y>f.y?g="orthogonal.vertical":a.hotPoint.y<d.y&&(g="orthogonal.V.H");var i=make.Default.load({id:e,style:{"link.type":g,"link.corner":"none"}});return i.setFromNode(a),i.setToNode(b),i}}),new twaver.vector.interaction.DefaultInteraction(d)]),!0},getEditId:function(a){return g.getDeviceEditorModel2dId(a)},isEditable:function(a){return a.getClient("editable")===!0?!0:!this.isHost(a)},isHost:function(a){return!!a.getClient("host")},isResizeable:function(a){return!!a.getClient("resizeable")},_createCopyChildNode:function(){var a=new twaver.Node;return a.setLayerId(this.childrenLayer.getId()),a.setStyle("body.type","vector"),a.setStyle("vector.shape","rectangle"),a.setStyle("vector.fill",!1),a.setStyle("vector.outline.width",2),a.setStyle("vector.outline.color","#a0a819"),a},loadChildren:function(a){var b=[],c=this,d=[];if(a instanceof Array)a.forEach(function(a){if(make.Default.getOtherParameter(a.id,"link"))d.push(a);else{var e=c.loadChild(a.id,a);b.push(e)}}),d.forEach(function(a){var d=c.loadChild(a.id,a);b.push(d)});else{var e=c.loadChild(a.id,a);b.push(e)}return b},loadChild:function(a,b){this.parentNode||console.warn("parentNode is null");var d=this;a=a.replace("."+j.DEVICE_MODEL_SUFFIX,""),b.id=this.getEditId(a),b.objectId=c.id();var e=make.Default.load(b);if(make.Default.getOtherParameter(b.id,"link")){var f=e;f.setFromNode(d.findByBID(b.from)),f.setToNode(d.findByBID(b.to)),d.box.add(f)}else if(e instanceof Array){var g=e;g.forEach(function(a){a.setLayerId(d.childrenLayer.getId()),d.parentNode&&a.setHost(d.parentNode),d.box.add(a)})}else{var h=e;h.setLayerId(d.childrenLayer.getId()),d.parentNode&&h.setHost(d.parentNode),d.box.add(h)}return h},loadParent:function(a,b){a=a.replace("."+j.DEVICE_MODEL_SUFFIX,""),b.id=this.getEditId(a),b.objectId=c.id(),this.box.clear();var d=make.Default.load(b);return d.setLayerId(this.parentLayer.getId()),this.box.add(d),d.setLocation(0,0),d.setMovable(!1),this.parentNode=d,d},setData:function(a){for(var b=this,c=[],d=0;d<a.length;d++){var e=a[d];make.Default.getOtherParameter(e.id,"link")?c.push(e):0==d&&make.Default.getOtherParameter(e.id,"host")?b.loadParent(e.id,e):b.loadChild(e.id,e)}c.forEach(function(a){b.loadChild(a.id,a)})},_resetPropertySheet:function(){if(this.isPropertySheetVisible()){var a=this,b=a.sheet.getPropertyBox();b.clear();var c=this.box.getSelectionModel();if(1!=c.size())b.clear(),this.propertySheetBox.hide();else{this.propertySheetBox.show();var d=c.getLastData();if(!make.Default.getId(d))return;g.addProperties(b,make.Default.getModelDefaultParameterProperties(make.Default.getId(d))),a.resetPropertySheetBoxSize(this.sheet)}}},align:function(a){var b=this;if(a){var c=this.selectionModel.getSelection(),d=new twaver.List;c.forEach(function(a){a&&!b.isHost(a)&&d.add(a)}),!d||d.size()<2||make.Default.align(d,a)}},flow:function(a,b){var c=this;if(a){var d=this.selectionModel.getSelection(),e=new twaver.List;d.forEach(function(a){a&&!c.isHost(a)&&e.add(a)}),!e||e.size()<2||make.Default.flow(e,a,b)}},zoomOverview:function(){this.network2d.zoomOverview()},setMouseEditable:function(a){var b=this._editable;b!=a&&(this._editable=a,this._editable?this.network2d.setInteractions([new twaver.vector.interaction.DefaultInteraction(this.network2d),new twaver.vector.interaction.EditInteraction(this.network2d)]):this.network2d.setInteractions([new twaver.vector.interaction.DefaultInteraction(this.network2d)]));
},setDragToPan:function(a){this.network2d.setDragToPan(a)},getData:function(a){var b=[],c=null;this.parentNode&&(c=this.parentNode.getId());var d=this,e=0,f=0;return a&&(e=9999999999,f=9999999999,this.box.forEach(function(a){e=Math.min(e,a.getX()),f=Math.min(f,a.getY())})),this.box.forEach(function(a){if(a==d.parentNode){var g=make.Default.toJson(a,function(a){return a.x=a.x||0,a.y=a.y||0,a.x-=e,a.y-=f,a});b.splice(0,0,g)}else{var g=make.Default.toJson(a,function(a){return a.x-=e,a.y-=f,a.parentObjectId=c,a});b.push(g)}}),b},appendData:function(a){this.loadChildren(a)},removeData:function(a){var b=this;return a instanceof Array?a.map(function(a){return b.box.removeById(a.objectId)}):b.box.removeById(a.objectId)},getSelectedData:function(){var a=this,b=[],c=this.selectionModel.getSelection().toList();return c&&c.size()>0&&c.forEach(function(c){if(!a.isHost(c)){var d=make.Default.toJson(c,function(a){return a});b.push(d)}}),b},refreshAccordion:function(a){a=a||c.utils.load2dCircuitCategory(),this.accordionPane.setCategories(a)},pasteSelection:function(a){var b=this;return this._copyAnchor&&0!=this._copyAnchor.length?(a=a||this._getPasteOffset(),void this._copyAnchor.forEach(function(d){var e=g.clone(d);if(e.objectId=c.id(),e.position){var f=e.position;e.position=[f[0]+a.x,f[1]+a.y,f[2]+a.z]}if(e.location){var h=e.location;h instanceof Array?e.location=[f[0]+a.x,f[1]+a.z]:(e.location.x+=a.x,e.location.y+=a.z)}e.x&&(e.x+=a.x),e.y&&(e.y+=a.z),e.points&&e.points._as.forEach(function(b){b.x+=a.x,b.y+=a.z}),b.appendData(e)})):null}},c.CircuitEditor=o,c.utils.ext(o,m);var p=function(a){p.superClass.constructor.call(this,a),this.jsonObj=null,this._modelChangeDispatcher=new mono.EventDispatcher,this._modelPropertyChangeDispatcher=new mono.EventDispatcher,this._currentModel=null,this.refreshAccordion()};p.prototype={_init:function(){this.accordionPane=new c.AccordionPane,this.propertySheetPane=new d.edit.PropertySheetPane(this.box),this.network3dView=this._initNetwork3d(),this.accordionPaneBox.append(this.accordionPane.getView()),this.propertySheetBox.append(this.propertySheetPane.getView()),this.networkBox.append(this.network3dView),this.addPropertySheetListener(),this.adjustNetwork3dBoundingBox()},parentResizeHandle:function(){p.superClass.parentResizeHandle.call(this),this.invalidate()},addPropertySheetListener:function(){var a=this.propertySheetPane.box;a.addDataPropertyChangeListener(this._handleSheetPropertyChanged,this)},getJsonObject:function(){var a=this.propertySheetPane.getData();return a},setElement:function(a){this.propertySheetPane.setElement(a),this.isPropertySheetVisible()&&(this.propertySheetBox.show(),this.resetPropertySheetBoxSize(this.propertySheetPane.sheet))},importJsonObject:function(a){a.objectId=a.objectId||c.id();var b=this.network3d.getDataBox();b.clear();var d=make.Default.load(a);b.addByDescendant(d),this.setElement(a)},_handleSheetPropertyChanged:function(a){if(this.propertySheetPane._setValued){var b=this.propertySheetPane.getData(),c=make.Default.load(b);this.network3d.getDataBox().clear(),this.network3d.getDataBox().addByDescendant(c),this._currentModel=c,this.fireModelPropertyChange(c,a.property,a.oldValue,a.newValue)}},_initNetwork3d:function(){var a=this.network3d=new mono.Network3D,b=new mono.PerspectiveCamera(30,1.5,50,5e3);a.setCamera(b),a.setClearColor("#000000"),a.setClearAlpha(0),a.setBackgroundImage("./images/bg_network.jpg"),b.p(107,156,609),b.look(new mono.Vec3(0,0,0));var d=a.getDefaultInteraction();d.yLowerLimitAngle=Math.PI/180*2,d.yUpLimitAngle=Math.PI/2,d.maxDistance=1e3,d.minDistance=100,d.zoomSpeed=3,d.panSpeed=.2,a.setInteractions([d]);var e=this.box=a.getDataBox(),f=new mono.PointLight(16777215,.1);f.setPosition(1e3,1e3,1e3),e.add(f),e.add(new mono.AmbientLight("white")),a.getRootView().setAttribute("class","network3d-view");var g=this;return a.getRootView().addEventListener("dblclick",function(b){g._handleDoubleClick(b,a)}),l.setDropTarget(a.getRootView(),{self:this,ondrop:function(d,f){if(!g.onDropHandler||!g.onDropHandler(d,f,e,a)){e.clear();var h=JSON.parse(f);h.objectId=h.objectId||c.id();var i=make.Default.load(h);e.addByDescendant(i),mono.Utils.playCameraAnimation(b,new mono.Vec3(107,156,609),new mono.Vec3(0,0,0),1e3),g.setElement(h),i.setClient("data",f),g.fireModelChange(g._currentModel,i),g._currentModel=i}}}),a.getRootView()},onDropHandler:function(a,b,c,d){},adjustNetwork3dBoundingBox:function(){mono.Utils.autoAdjustNetworkBounds(this.network3d,this.networkBox[0],"clientWidth","clientHeight",0,0)},fireModelChange:function(a,b){this._modelChangeDispatcher.fire({source:this,oldValue:a,newValue:b})},fireModelPropertyChange:function(a,b,c,d){this._modelPropertyChangeDispatcher.fire({source:a,property:b,oldValue:c,newValue:d})},addModelChangeListener:function(a,b,c){this._modelChangeDispatcher.add(a,b,c)},removeModelChangeListener:function(a,b){this._modelChangeDispatcher.remove(a,b)},addModelPropertyChangeListener:function(a,b,c){this._modelPropertyChangeDispatcher.add(a,b,c)},removeModelPropertyChangeListener:function(a,b){this._modelPropertyChangeDispatcher.remove(a,b)},_handleDoubleClick:function(a,b){var c=b.getCamera(),d=b.getDefaultInteraction(),e=g.findFirstObjectByMouse(b,a);if(e){var f=e.element,h=e.point,i=c.getTarget();f.getClient("animation")?make.Default.playAnimation(f,f.getClient("animation")):g.animateCamera(c,d,i,h)}else{var i=c.getTarget(),h=new mono.Vec3(0,0,0);g.animateCamera(c,d,i,h)}},refreshAccordion:function(a){a=a||c.utils.load3dModelCategory(),this.accordionPane.setCategories(a)},invalidate:function(){this.adjustNetwork3dBoundingBox()},getCurrentModel:function(){return this._currentModel},getData:function(){var a=this.getJsonObject();return a?a:null},setData:function(a){a instanceof Array?this.importJsonObject(a[0]):this.importJsonObject(a)},getSelectedData:function(){throw"not support this function[{}]".format("getSelectedData")},appendData:function(){throw"not support this function[{}]".format("appendData")},copySelection:function(){throw"not support this function[{}]".format("copySelection")},pasteSelection:function(){throw"not support this function[{}]".format("pasteSelection")}},c.ModelEditor=p,c.utils.ext(p,m);var q=function(a,b,d){q.superClass.constructor.call(this,a),this.modelClass=b,this.objectId=d||c.id(),this.parentNode=null,this.dragNode=null,this.currentItem=null,this.model3dTo2dMapping=j.rackEditorModel3dTo2dMapping,this.model2dTo3dMapping=j.rackEditorModel2dTo3dMapping,this.unitHeight=make.Default.getUnitHeight()||1,this.offsetX=0,this.offsetY=0,this.isSettingLocation=!1,this.isAddChildNode=!1,this.DEVICE_PATTEN="设备模板",this.RACK_PATTEN="机柜模板",this.accordionPane=new c.AccordionPane,this.init()};q.prototype={init:function(){var b=this;this.accordionPane.ondrag=function(a,d){if(!b.isPatten(d.id)&&!b.currentItem){var e=b.getEditId(d.id);if(make.Default.getOtherParameter(e,"host"))return;b.currentItem=d,b.dragNode=make.Default.load({id:b.getEditId(d.id),objectId:c.id()}),b.dragNode.setClient("id",d.id)}},this.network2dView=this._initNetwork2d(),this.network2d.setMaxZoom(15);var d=this.sheet=new twaver.controls.PropertySheet(this.box);g.initPropertySheet(d);var e=this.propertySheetBox.width(),f=this.propertySheetBox.height();d.adjustBounds({x:0,y:0,width:e,height:f}),this.propertySheetBox.append(this.sheet.getView()),this.accordionPaneBox.append(this.accordionPane.getView()),this.networkBox.append(this.network2dView),this.network2d.addInteractionListener(function(c){if("doubleClickElement"==c.kind){var d=c.element;if(!b.isHost(d)){var e=d.getId(),f=d.getClient("id"),g=d.getClient("panel");a.open("deviceEditor.html?objectId="+e+"&modelClass="+f+"&panelName="+g)}}}),$(this.network2dView).on("keydown",function(a){8==a.keyCode&&a.preventDefault()}),this.refreshAccordion(),this.modelClass&&this.loadParent(this.modelClass)},_initNetwork2d:function(){var a=this,b=this.network2d=new d.edit.GridNetwork;this.network2d.setPositionMagneticEnabled();var c=this.box=this.network2d.getElementBox();this._setChildPositionMagnetic(c);var e=this.selectionModel=this.box.getSelectionModel();e.setSelectionMode("singleSelection"),e.addSelectionChangeListener(function(b){a._resetPropertySheet(),a.resetNodeName()}),e.setFilterFunction(function(b){return b!=a.parentNode});var f=c.getLayerBox(),g=this.parentLayer=new twaver.Layer("parentLayer"),h=this.childrenLayer=new twaver.Layer("childrenLayer");f.add(g),f.add(h),f.moveToTop(g);var i=this.network2d.getView();l.setDropTarget(i,{self:this,dropEffect:"copy",ondrop:function(d,e){if(!a.onDropHandler||!a.onDropHandler(d,e,c,b))if(e=JSON.parse(e),a.isPatten(e.id)){var f=make.Default.getOtherParameter(e.id,"category");if(f==a.RACK_PATTEN){var g=make.Default.load(e.id);a.loadParent(g.parent),a.setData(g.data),setTimeout(function(){a.zoomOverview()},10)}else if(a.parentNode){var g=make.Default.load(e.id);a.setData(g)}else alert("add rack first")}else a.dragNode?(c.getSelectionModel().clearSelection(),c.getSelectionModel().appendSelection(a.dragNode),a.dragNode.setStyle("whole.alpha",1),a._resetPropertySheet(),a.resetChildNodeLocation(a.dragNode)):(a.loadParent(e.id),setTimeout(function(){a.network2d.zoomOverview()},10)),a.dragNode&&(a.dragNode=null,a.currentItem=null)},ondragover:function(b){if(b.dataTransfer.dropEffect="copy",a.dragNode&&!a.isHost(a.dragNode)){var d=a.getSize(a.dragNode);if(!a.parentNode||!a._haveSpace(d,a.dragNode))return void(b.dataTransfer.dropEffect="none");a.dragNode.isAddInBox||(a.dragNode.isAddInBox=!0,a.dragNode.setStyle("whole.alpha",.7),a._initChildNode(a.dragNode,h),c.add(a.dragNode),a.box.getSelectionModel().clearSelection(),a.box.getSelectionModel().appendSelection(a.dragNode));var e=a.network2d.getLogicalPoint(b),f=e.x,g=e.y;g-=a.dragNode.getSize().height/2,e=a.formatLocation(a.dragNode,f,g),e?a.dragNode.setLocation(e.x,e.y):a.resetChildNodeLocation(a.dragNode)}},ondragleave:function(b){a.dragNode&&(a.dragNode.isAddInBox&&c.remove(a.dragNode),a.dragNode=null,a.currentItem=null)}});var j=this.ruler=new d.edit.Ruler(this.network2d);j.getView().setAttribute("class","room-ruler"),j.setShowGuides(!1),j.setShowRuler(!0);var k=$(j.getView());return k},onDropHandler:function(a,b,c,d){},isPatten:function(a){var b=make.Default.getOtherParameter(a,"category");return b==this.DEVICE_PATTEN||b==this.RACK_PATTEN},getEditId:function(a){return g.getRackEditorModel2dId(a)},isHost:function(a){return!!a.getClient("host")},getSize:function(a){return a.getClient("size")||1},setData:function(a){var b=this;a.forEach(function(a){b.loadChild(a.id,a)})},loadChild:function(a,b){b.id=this.getEditId(a);var c=make.Default.load(b);return this._initChildNode(c,this.childrenLayer),this.isAddChildNode=!0,this.box.add(c),this.resetChildNodeLocation(c),c},_initChildNode:function(a,b){var c=this;a.setLayerId(b.getId()),a.setHost(this.parentNode);var d=a.setLocation;a.originalSetLocation=d,a.setLocation=function(b,e){var f=c.formatLocation(a,b,e);f?d.call(a,f.x,f.y):c.resetChildNodeLocation(a)};var e=a.translate;return a.translate=function(b,f){if(c.childNodeLiveMove){c.childNodeLastPointOffset.x+=b,c.childNodeLastPointOffset.y+=f;var g=c.childNodeLastPoint.x+c.childNodeLastPointOffset.x,h=c.childNodeLastPoint.y+c.childNodeLastPointOffset.y,i=c.formatLocation(a,g,h);i?d.call(a,i.x,i.y):c.resetChildNodeLocation(a)}else e.call(a,b,f)},a},loadParent:function(a){var b={id:this.getEditId(a),objectId:this.objectId},c=make.Default.load(b);return this._initParentNode(c,this.parentLayer),this.box.clear(),this.box.add(c),c.setLocation(0,0),this._resetPropertySheet(),c.setMovable(!1),this.parentNode=c,c},_initParentNode:function(a,b){a.setLayerId(b.getId()),this.offsetX=a.getClient("offsetX"),this.offsetY=a.getClient("offsetY"),this.childrenSize=a.getClient("childrenSize")},_findChildren:function(){return this.box.toDatas(function(a){return this.parentNode!=a?a:void 0},this)},_isEmpty:function(a,b,c){var d=this._findChildren();if(!d||0==d.size())return!0;var e=this.parentNode.getClient("childrenSize"),f=d.size(),g=a,h=a+b-1;if(h>e-1)return!1;for(var i=0;f>i;i++){var j=d.get(i);if(c!=j){var k=j.getClient("size"),l=parseInt(j.getClient("loc"))-1,m=l,n=l+k-1;if(!(g>n||m>h))return!1}}return!0},_haveSpace:function(a,b){var c=this._findChildren();if(!c||0==c.size())return!0;for(var d=this.parentNode.getClient("childrenSize")||42,e=0;d-a>=e;e++)if(this._isEmpty(e,a,b))return!0;return!1},_getNextLoc:function(a,b){if(this._haveSpace(a,b))for(var c=this.parentNode.getClient("childrenSize"),d=0;c>d;d++)if(this._isEmpty(d,a,b))return d;throw"there have not enough space for "+a+"U  server"},_setChildPositionMagnetic:function(a){var b=this;a.addDataPropertyChangeListener(function(a){var c=a.property,d=a.source;d.getClient("host")?j.HOST_EDITABLE:"C:loc"==c?(d.eventType="loc",b.changeChildNodeHandler(d,a)):"location"==c&&(b.isSettingLocation?b.isSettingLocation=!1:b.moveChildNodeHandler(d,a))}),a.addDataBoxChangeListener(function(a){var c=a.kind,d=a.data;"add"!=c||d.getClient("host")||b.addChildNodeHandler(d,a)}),this.network2d.addInteractionListener(function(a){var c=b.box.getSelectionModel().getLastData();c&&!c.getClient("host")&&("liveMoveStart"==a.kind?(b.childNodeLiveMove=!0,b.childNodeLastPoint=c.getLocation(),b.childNodeLastPointOffset={x:0,y:0},c.setStyle("whole.alpha",.5)):"liveMoveEnd"==a.kind&&(b.moveChildNodeEndHandler(c,a),delete b.childNodeLiveMove,delete b.childNodeLastPoint,delete b.childNodeLastPointOffset,c.setStyle("whole.alpha",1)))})},_getLoc:function(a,b){var c=this.parentNode.getClient("childrenSize"),d=this.parentNode.getLocation(),e=c*this.unitHeight-(a-d.y-this.offsetY),f=Math.round(e/this.unitHeight);return b||(f=Math.max(0,f),f=Math.min(c-1,f)),f},formatLocation:function(a,b,c){var d=this.parentNode.getLocation(),e=this.parentNode.getClient("childrenSize");c=Math.max(d.y+this.offsetY,c),c=Math.min(d.y+this.offsetY+e*this.unitHeight-a.getSize().height,c);var f=a.getClient("size"),g=this._getLoc(c+a.getSize().height);if(!this._isEmpty(g,f,a))return null;var d=this.parentNode.getLocation(),b=d.x+this.offsetX,c=d.y+(e-1-g+1)*this.unitHeight+this.offsetY-a.getSize().height;return{x:b,y:c,loc:g}},addChildNodeHandler:function(a){if(this.isAddChildNode)return void(this.isAddChildNode=!1);var b=a.getLocation(),c=this._getLoc(b.y+a.getSize().height);a.setClient("loc",c-1)},resetNodeName:function(){this.box.forEach(function(a){a.setName(null)});var a=this.selectionModel.getLastData();if(a&&!this.isHost(a)){a.setStyle("label.position","right.right"),a.setStyle("label.xoffset",10);var b=parseInt(a.getClient("loc")),c=parseInt(a.getClient("size")),d=""+b+"U - "+(b+c-1)+"U";a.setName(d)}},changeChildNodeHandler:function(a,b){if(this.resetNodeName(a),"moveChildNodeHandler-loc"==this.eventType)return void(this.eventType=null);var c=a.getClient("size"),d=parseInt(b.newValue)-1;if(this._isEmpty(d,c,a)){var e=this.parentNode.getClient("childrenSize"),f=this.parentNode.getLocation(),g=f.x+this.offsetX,h=f.y+(e-1-d+1)*this.unitHeight+this.offsetY-a.getSize().height;this.setChildNodeLocation(a,g,h)}else d=this._getNextLoc(c,a),a.setClient("loc",d+1)},moveChildNodeHandler:function(a,b){if(this.eventType)return void(this.eventType=null);var c=this,d=a.getClient("size"),e=null;e=b?parseFloat(b.newValue.y):a.getLocation().y;var f=this._getLoc(e+a.getSize().height);if(this._isEmpty(f,d,a)){var g=parseInt(a.getClient("loc"))-1;g!=f&&(this.eventType="moveChildNodeHandler-loc"),a.setClient("loc",f+1)}setTimeout(function(){c.resetChildNodeLocation(a)},500)},moveChildNodeEndHandler:function(a,b){this.resetChildNodeLocation(a)},setChildNodeLocation:function(a,b,c){var d=this.parentNode.getClient("childrenSize"),e=a.getLocation(),f=this.parentNode.getLocation();c=Math.max(f.y+this.offsetY,c),c=Math.min(f.y+this.offsetY+d*this.unitHeight-a.getSize().height,c),(e.x!=b||e.y!=c)&&(this.isSettingLocation=!0,a.setLocation(b,c))},resetChildNodeLocation:function(a){var b=parseInt(a.getClient("loc"))-1,c=this.parentNode.getClient("childrenSize"),d=this.parentNode.getLocation(),e=d.x+this.offsetX,f=d.y+(c-1-b+1)*this.unitHeight+this.offsetY-a.getSize().height,g=a.getLocation();(g.x!=e||g.y!=f)&&(this.isSettingLocation=!0,a.originalSetLocation(e,f))},_resetPropertySheet:function(){if(this.isPropertySheetVisible()){var a=this,b=a.sheet.getPropertyBox();b.clear();var c=this.box.getSelectionModel();if(0==c.size())b.clear(),this.propertySheetBox.hide();else{this.propertySheetBox.show();var d=c.getLastData();g.addProperties(b,make.Default.getModelDefaultParameterProperties(make.Default.getId(d))),a.resetPropertySheetBoxSize(this.sheet)}}},zoomOverview:function(){this.network2d.zoomOverview()},getData:function(){if(!this.parentNode)return[];var a=[],b=this.parentNode.getId(),c=this;return this.box.forEach(function(d){if(d!=c.parentNode){var e=make.Default.toJson(d,function(a){return a.id=g.getRackEditorModel3dId(a.id),a.parentObjectId=b,a});a.push(e)}}),a},refreshAccordion:function(a){a=a||c.utils.load2dRackCategory(!this.modelClass),this.accordionPane.setCategories(a)}},c.RackEditor=q,c.utils.ext(q,m),d.edit.BoxBridge=function(a,b){this.box2d=a,this.jsonBox=b,this.binded=!1,this.wallChildLayer=300,this.innerWallLayer=200,this.innerWallChildLayer=400,this.refMap2d={},this.refMapJson={},this.isAdjusting=!1},mono.extend(d.edit.BoxBridge,Object,{bind:function(){this.binded||(this.box2d.addDataBoxChangeListener(this._handle2dBoxChange,this),this.box2d.addDataPropertyChangeListener(this._handle2dDataChange,this),this.jsonBox.addDataBoxChangeListener(this._handleJsonBoxChange,this),this.binded=!0)},unbind:function(){this.box2d.removeDataBoxChangeListener(this._handle2dBoxChange,this),this.box2d.removeDataPropertyChangeListener(this._handle2dDataChange,this),this.jsonBox.removeDataBoxChangeListener(this._handleJsonBoxChange,this),this.binded=!1},synchronizeFilter:function(a,b){return!0},_getJsonData:function(a){var b=new d.edit.data.JsonObject({objectId:a.getId()}),c=a.getClient("radius"),e=a.getCenterLocation(),f=a.getAngle(),h=g.getSceneEditorModel3dId(a.getClient("id")),i=a.getPoints&&a.getPoints(),j=a.getClient("objName"),k=a.getClient("wallWidth")||a.getWidth(),l=a.getHeight(),m=a.getClient("height"),n=a.getClient("positionY"),o=a.getClient("label"),p=a.getClient("bid"),q=a.getClient("closed"),r=a.getClient("showFloor"),s=null;a.getParent()&&(s=a.getParent()),b.setParentId(s);var t=a.getClient("pointsY"),u={};if(c&&b.setRadius(c),e&&b.setPosition([e.x,0,e.y]),f&&b.setRotation([0,f,0]),h&&(b.id=h),j&&b.setName(j),k&&b.setWidth(k),l&&b.setDepth(l),m&&b.setHeight(m),q&&b.setClosed(!0),r&&b.setShowFloor(!0),n){var v=b.getPosition()||[0,0,0];b.setPosition(v[0],n,v[2])}if(null!=i&&i.size()>0){for(var w=[],x=0;x<i.size();x++)t?w.push([i.get(x).x-e.x,i[x]||20,i.get(x).y-e.y]):w.push([i.get(x).x-e.x,i.get(x).y-e.y]);b.setData(w)}return o&&(u.label=o),p&&(u.bid=p),b.setClient(u),b},_addJsonData:function(a){if(this.synchronizeFilter(a,null)&&this.box2d.contains(a)){var b=this._getJsonData(a);this.jsonBox.add(b),this.refMapJson[a.getId()]=b}},_removeJsonData:function(a){null!=a&&(this.jsonBox.removeById(a.getId()),delete this.refMapJson[a.getId()]);var b=a.getClient("type");if("door"==b||"window"==b){var c=a.getId();for(var d in this.refMapJson)if(this.refMapJson[d]){var e=this.refMapJson[d].getChildren();if(e&&e.length>0)for(var f=0;f<e.length;f++)e[f].getObjectId()==c&&(this.refMapJson[d].getChildren().splice(e.indexOf(e[f]),1),console.log(this.refMapJson[d]))}}},_handle2dBoxChange:function(a){if(!this.isAdjusting){this.isAdjusting=!0;var b=a.data,c=a.kind;"add"==c?(this._addJsonData(b),this.resetParent(b)):"remove"==c?this._removeJsonData(b):"clear"==c&&(this.jsonBox.clear(),this.refMapJson={},this.refMap2d={}),this.isAdjusting=!1}},_handle2dDataChange:function(a){var b=this;if(!this.isAdjusting){this.isAdjusting=!0;var c=a.source,d=a.newValue,e=(a.oldValue,a.property);if(c.getParent()&&("door"==c.getClient("type")||"window"==c.getClient("type"))){var f,g=this.jsonBox.getDataById(c.getParent().getId());if(g.getChildren().forEach(function(a){a.getObjectId()==c.getId()&&(f=a)}),e.startsWith("C:")){w=e.substr(e.indexOf(":")+1),("edgeIndex"==w||"offset"==w)&&(f.client=f.client||{},f.client[w]=d),"length"==w&&f.setWidth(d);var h=c.getCenterLocation(),i=f.getPosition()[1];f.setPosition([h.x,i,h.y]);var j=f.getClient()||{};j[w]=d,f.setClient(j)}}var g=this.jsonBox.getDataById(c.getId());if(!g)return void(this.isAdjusting=!1);if("points"==e){var k=[],l=d,m=c.getCenterLocation(),n=c.getClient("pointsY"),o=c.getSegments();if(o&&o.size()>0&&o.size()>l.size())return;if(o&&o.size()>0)for(var p=0,q=0;p<o.size();p++,q++){var r=o.get(p),s=l.get(q);if("moveto"==r||"lineto"==r)n?k.push([parseInt(s.x-m.x),n[q],parseInt(s.y-m.y)]):k.push([parseInt(s.x-m.x),parseInt(s.y-m.y)]);else if("quadto"==r)if(n){var t=l.get(++q),u=n[q]||0;k.push(["c",parseInt(s.x-m.x),n[q],parseInt(s.y-m.y),parseInt(t.x-m.x),u,parseInt(t.y-m.y)])}else k.push(["c",parseInt(s.x-m.x),parseInt(s.y-m.y),parseInt(t.x-m.x),parseInt(t.y-m.y)])}else for(var p=0;p<l.size();p++)n?k.push([l.get(p).x-m.x,n[p],l.get(p).y-m.y]):k.push([l.get(p).x-m.x,l.get(p).y-m.y]);g.setData(k)}else if("location"==e){var m=c.getCenterLocation(),v=(c.getSize(),g.getPosition()||[0,0,0]);g.setPosition([m.x,v[1],m.y]),b.resetParent(c)}else if("angle"==e)g.setRotation([0,-d,0]);else if("width"==e)g.setWidth(d);else if("height"==e)g.setDepth(d);else if(e.startsWith("C:")){var w=e.substr(e.indexOf(":")+1);if("radius"==w)g.setRadius(d);else if("height"==w)g.setHeight(d);else if("positionY"==w){var v=g.getPosition()||[0,0,0];g.setPosition([v[0],parseInt(d),v[2]])}else if("pointsY"==w){for(var n=d,k=g.getData(),p=0;p<k.length;p++)k[p][1]=n[p];g.setData(k)}else"parentId"==w&&g.setParentId(d);var j=g.getClient()||{};j[w]=d,g.setClient(j)}else if(e.startsWith("S:")){var w=e.substr(e.indexOf(":")+1);"vector.outline.color"==w&&g.setColor(d);var x=g.getStyle()||{};x[w]=d,g.setStyle(x)}this.isAdjusting=!1}},_handleJsonBoxChange:function(a){if(!this.isAdjusting){this.isAdjusting=!0;var b=a.data,c=a.kind;"add"==c?(this.refMapJson[b.getObjectId()]||(this.refMapJson[b.getObjectId()]=b),this._add2dData(b)):"remove"==c?this._remove2dData(b):"clear"==c&&(this.box2d.clear(),this.refMapJson={},this.refMap2d={}),this.isAdjusting=!1}},_remove2dData:function(a){null!=a&&(this.box2d.removeById(a.getObjectId()),delete this.refMap2d[a.getObjectId()])},_replaceMappingId:function(a){var b={};return make.Default.copyProperties(a,b),this._replaceMappingIdAction(b),b},_replaceMappingIdAction:function(a){var b=g.getSceneEditorModel2dId(a.id);if(a.id=b,a.children)for(var c in a.children){var d=a.children[c];this._replaceMappingIdAction(d)}},_add2dData:function(a){var b=this;if(this.synchronizeFilter(null,a)&&this.jsonBox.contains(a)&&!this.box2d.getDataById(a.getObjectId())){var c=this._replaceMappingId(a),d=make.Default.load(c);if(d.setClient("id",a.id),this.box2d.add(d),d.getChildren&&d.getChildren().size()>0){d.setClient("magnetic.disabled",!0);var e=d.getChildren(),b=this;e.forEach(function(a){b.box2d.getDataById(a.getId())||(a.setClient("magnetic.disabled",!0),b.box2d.add(a))})}this.refMap2d[a.getObjectId()]=d,b.resetParent(d)}},resetParent:function(a){var b=this,c=a.getId();g.runDelayTask(c,1,function(){b._resetParent(a)})},_resetParent:function(a){var b=this;if(a.getHost&&a.setHost){var c=this.getParent(a);if(c){if(c!=a.getHost()){a.setHost(c),a.setClient("parentId",c.getId());var d=this.refMapJson[a.getId()];d?d.setParentId(c.getId()):console.warn("2D对象参数与jsonObject不匹配, id2d="+a.getId(),a,this.refMapJson)}}else a.setHost(null),a.setClient("parentId",null),this.refMapJson[a.getId()].setParentId(null)}var e=this.getChildren(a);e.forEach(function(c){c.getHost&&c.setHost&&a!=c.getHost()&&(c.setHost(a),c.setClient("parentId",a.getId()),b.refMapJson[c.getId()].setParentId(a.getId()))})},getParent:function(a){var b=this._getParent(a);return b},_getParent:function(a){for(var b=(a.getCenterLocation(),a.getLayerId()),c=this.box2d.getLayerBox(),d=c.size(),e=d-1;e>=0;e--){var f=c.getDataAt(e);if(!(f.getId()>=b)&&f.getId()!=this.wallChildLayer&&f.getId()!=this.innerWallChildLayer&&f.getId()!=this.innerWallLayer)for(var h=0;h<this.box2d.size();h++){var i=this.box2d.getDataAt(h);if(i.getLayerId()==f.getId()&&g.isNodeInNode(i,a))return i}}},getChildren:function(a){var b=this._getChildren(a);return b},_getChildren:function(a){for(var b=[],c=a.getLocation(),d=a.getSize(),e=({x:c.x,y:c.y,width:d.width,height:d.height},a.getLayerId()),f=this.box2d.getLayerBox(),h=f.size(),i=0;h>i;i++){var j=f.getDataAt(i);if(!(j.getId()<=e)&&j.getId()!=this.wallChildLayer&&j.getId()!=this.innerWallChildLayer&&j.getId()!=this.innerWallLayer)for(var k=0;k<this.box2d.size();k++){var l=this.box2d.getDataAt(k);l.getCenterLocation();if(l.getLayerId()==j.getId()&&g.isNodeInNode(a,l)){var m=this.getParent(l);m==a&&b.push(l)}}}return b}}),d.edit.Edit2D=function(a,b){this.jsonBox=a||new d.edit.JsonBox,this.editor=b,this._init(),this.loadDataFlag=!1},d.edit.Edit2D.CONTAINER_CLASS="edit2d-container",twaver.Util.ext(d.edit.Edit2D,Object,{_init:function(){this.accordionPane=new c.AccordionPane;this.network2d=new d.edit.GridNetwork,this.network2d.setMinZoom(.1),this.network2d.setMaxZoom(5),this.box=this.network2d.getElementBox();var a=this.sheet=new twaver.controls.PropertySheet(this.box);g.initPropertySheet(a),this.network2dView=this._initNetwork2d(),this.clientBidQuickFinder=new twaver.QuickFinder(this.box,"bid","client");var b=new d.edit.BoxBridge(this.box,this.jsonBox);b.bind(),this.setDragAndDropImage(this.network2d.getView()),this.network2d.addInteractionListener(function(a){"doubleClickElement"==a.kind&&this.doubleClickRackHandler&&this.doubleClickRackHandler(a.element,this.box)},this),this.box.getSelectionModel().addSelectionChangeListener(this.handleSelectionChange,this),this.editor.propertySheetBox.append(this.sheet.getView()),this.editor.accordionPaneBox.append(this.accordionPane.getView()),this.editor.networkBox.append(this.network2dView)},createNodesByJson:function(a){g.createJsonObject(this.jsonBox,a),this.box.getSelectionModel().clearSelection()},zoomOverview:function(){this.network2d.zoomOverview()},setDragAndDropImage:function(a){var b=this;l.setDropTarget(a,{dropEffect:"copyMove",ondrop:function(a,c){b.dragNode&&(b.dragNode=null,b.currentItem=null)},ondragover:function(a){if(a.preventDefault(),b.dragNode){b.dragNode.isAddInBox||(b.dragNode.isAddInBox=!0,b.dragNode.setStyle("whole.alpha",.7),b.box.add(b.dragNode));var c=b.network2d.getLogicalPoint(a),d=c.x,e=c.y;e-=b.dragNode.getSize().height/2,b.dragNode.setLocation(d,e)}},ondragleave:function(a){b.dragNode&&(b.dragNode.isAddInBox&&b.box.remove(b.dragNode),b.dragNode=null,b.currentItem=null)}})},_initNetwork2d:function(){var a=new d.edit.interaction.RoomListener(this.network2d,this.propertySheetPane,this.jsonBox);a.initRoomSettings();var b=this.ruler=new d.edit.Ruler(this.network2d);return b.getView().setAttribute("class","room-ruler"),b.setShowGuides(!1),b.setShowRuler(!0),this.network2d.getLabel=function(a){if(g.isEditModel(a)){var b=a.getClient("bid");return b&&b.trim().length>0?b:a.getClient("label")}},b.getView()},layoutGUI:function(){this.ruler.invalidate()},getJsonBox:function(){return this.jsonBox},getRegionJson:function(a){var b=null,c=this;return b=this.jsonBox.toJson(function(b){return c._isRegion(b,a)})},_isRegion:function(a,b){var c=a.type;return b&&b!=a.getId()?!1:"area-rect"==c||"area-round"==c||"area-polygon"==c?!0:!1},loadData:function(){var b=this.network2d.getElementBox();this.loadDataFlag||(this.loadDataFlag=!0,d.edit.model.model2d.loadData(b,JSON.parse(a.localStorage.getItem("scene"))||[]));var c=[];b.forEach(function(a){"area"==a.getClient("type")&&c.push(a)}),c.forEach(function(a){b.remove(a)}),d.edit.model.model2d.loadData(b,JSON.parse(a.localStorage.getItem("region"))||[])},getObject2dById:function(a){return a?this.clientBidQuickFinder.findFirst(a):null},doubleClickRackHandler:function(a,b){},handleSelectionChange:function(){if(this.editor.isPropertySheetVisible()){var a=this,b=a.sheet.getPropertyBox();b.clear();var c=this.box.getSelectionModel();if(1!=c.size())b.clear(),this.editor.propertySheetBox.hide();else{this.editor.propertySheetBox.show();var d=c.getLastData(),e=make.Default.getId(d);e=g.getSceneEditorModel2dId(e),g.addProperties(b,make.Default.getModelDefaultParameterProperties(e)),a.editor.resetPropertySheetBoxSize(this.sheet)}}}}),d.edit.Edit3D=function(a,b){this.jsonBox=a||new d.edit.JsonBox,this.editor=b,this._init(),this.isZoom=!1},twaver.Util.ext(d.edit.Edit3D,Object,{_init:function(){this.network3dView=this._initNetwork3d(),this.jsonBox.addDataBoxChangeListener(this._handleJsonBoxChange,this),this.editor.contentPane3d.append(this.network3dView)},_initNetwork3d:function(){var a=this.network3d=new mono.Network3D,b=new mono.PerspectiveCamera(30,1.5,50,2e4);a.setCamera(b),b.p(638,2571,2763),a.setClearColor("#000000"),a.setClearAlpha(0),a.setBackgroundImage("./images/bg_network.jpg");var c=a.getDefaultInteraction();c.yLowerLimitAngle=Math.PI/180*2,c.yUpLimitAngle=Math.PI/2,c.maxDistance=1e4,c.minDistance=50,c.zoomSpeed=3,c.panSpeed=.2,a.setInteractions([c]);var d=this.box=a.getDataBox(),e=new mono.PointLight(16777215,.1);e.setPosition(8e3,8e3,8e3),d.add(e),d.add(new mono.AmbientLight("white")),a.getRootView().setAttribute("class","network3d-view");var f=function(a,b){var c=b.getCamera(),d=b.getDefaultInteraction(),e=g.findFirstObjectByMouse(b,a);if(e){var f=e.element,h=e.point,i=c.getTarget();if(f.getClient("animation"))if("rack_door"==f.getClient("type")&&f.getClient("animated")){var j=f.getParent().getChildren().toList(function(a){return f!=a&&a.getClient("animated")}),k=j.size(),l=0;k>0?j.forEach(function(a){make.Default.playAnimation(a,a.getClient("animation"),function(){l++,l==k&&make.Default.playAnimation(f,f.getClient("animation"))})}):make.Default.playAnimation(f,f.getClient("animation"))}else make.Default.playAnimation(f,f.getClient("animation"));else g.animateCamera(c,d,i,h);if(f.getClient("dbl.func")){var m=f.getClient("dbl.func");m(f,b,e,a)}else if(f.getParent()&&f.getParent().getClient("dbl.func")){var m=f.getParent().getClient("dbl.func");m&&m(f.getParent(),b,e,a)}}else{var i=c.getTarget(),h=new mono.Vec3(0,0,0);g.animateCamera(c,d,i,h)}};return a.getRootView().addEventListener("dblclick",function(b){f(b,a)}),a.getRootView()},refreshNetwork3d:function(){var a=this,b=this.network3d.getDataBox();b.clear();var c=this.jsonBox.toJson();make.Default.load(c,function(c){if(c&&c.length>0){for(var d=0;d<c.length;d++){var e=c[d];b.addByDescendant(e),e.setClient("dbl.func",function(c,d){a.doubleClickHandler(c,b)})}setTimeout(function(){var a=new mono.Cube(.1,.1,.1);b.add(a),setTimeout(function(){b.remove(a)},500)},500)}});this.isZoom||this.zoomToOverview()},findByBID:function(a){return this.bidQuickFinder||(this.bidQuickFinder=new mono.QuickFinder(this.network3d.getDataBox(),"bid","client")),this.bidQuickFinder.findFirst(a)},doubleClickHandler:function(a,b){},zoomToOverview:function(){this.isZoom=!0,this.network3d.zoomEstimateOverview(45);var a=this.network3d.getNetworkBoundingBox();console.log(a);var b=this.network3d.getCamera(),c=b.p(),d=b.t();b.setPosition(c.x+2500,c.y+3500,c.z+3500),setTimeout(function(){mono.Utils.playCameraAnimation(b,new mono.Vec3(c.x+500,c.y+500,c.z+500),d,500)},1e3)},getView:function(){return this.network3dView},getJsonBox:function(){return this.jsonBox},_handleJsonBoxChange:function(a){kind=a.kind,"clear"==kind&&this.network3d.getDataBox().clear()}}),d.edit.EditDrop=function(){this.dropFunctionMap={},this.registerDropFunction("model",this.onModelDrop),this.registerDropFunction("default",this.onDefaultDrop)},mono.extend(d.edit.EditDrop,Object,{registerDropFunction:function(a,b){this.dropFunctionMap[a]=b},onDrop:function(a,b){"string"==typeof b&&(b=JSON.parse(b));var c=b.dragType,d=this.dropFunctionMap[c];d?d(a,b):this.onDefaultDrop(a,b)},onModelDrop:function(a,b){var c=b.model;
c&&console.log("load model : "+c)},onDefaultDrop:function(a,b){console.log("onDefaultDrop"),a.setInteractions([new d.edit.interaction.RoomDragInteraction(a)])}}),d.edit.ImportDxf=function(a){this.scale=a||1},twaver.Util.ext(d.edit.ImportDxf,Object,{loadDxf:function(a){var b=this;if(!(a instanceof File))return b._loadDxfFile(a);if(a.name.match(/\.dxf$/i)){var c=new FileReader;c.onload=function(a){b.loadDxf(a.target.result)},c.readAsText(a)}else alert("Only dxf file is supported")},_loadDxfFile:function(a){function b(a){var d=make.Default.getType(a.attrib.layer);if(d&&"wall"==d)a instanceof dxf.LineData?(e=a.y1<e?a.y1:e,e=a.y2<e?a.y2:e,f=a.y1>f?a.y1:f,f=a.y2>f?a.y2:f,g=a.x1<g?a.x1:g,g=a.x2<g?a.x2:g,h=a.x1>h?a.x1:h,h=a.x2>h?a.x2:h):a instanceof dxf.PolylineData?a.points.forEach(function(a){e=a.y<e?a.y:e,f=a.y>f?a.y:f,g=a.x<g?a.x:g,h=a.x>h?a.x:h}):a instanceof dxf.InsertData;else if(a instanceof dxf.InsertData&&"road"===a.name){var i=c.getEntitiesFromInsertData(a);i.forEach(function(a){b(a)})}}var c=this;c.data=a;var d=c.parser=new dxf.Dxf;d.parse(a);var e=Number.POSITIVE_INFINITY,f=Number.NEGATIVE_INFINITY,g=Number.POSITIVE_INFINITY,h=Number.NEGATIVE_INFINITY,i=[];d.sections.entities.forEach(function(a){b(a)}),c.minY=e,c.maxY=f,c.minX=g,c.maxX=h;var j=[],i=c.walls=[];d.sections.entities.forEach(function(a){var b=a.attrib.layer,d=make.Default.getType(b);("wall"==d||"innerWall"==d)&&c.createJsonArray(a,j,b)}),d.sections.entities.forEach(function(a){var b=a.attrib.layer,d=make.Default.getType(b);"door"==d?c.createBlockJson(a,b,i,10):"window"==d&&c.createBlockJson(a,b,i,50)});var k=[],l=c.scale;return d.sections.entities.forEach(function(a){var b=a.attrib.layer;a instanceof dxf.MTextData&&k.push({id:b,point:{x:a.ipx*l,y:-a.ipy*l},text:a.text,entity:a})}),d.sections.entities.forEach(function(a){var b=a.attrib.layer,d=make.Default.getType(b);"wall"==d||"innerWall"==d||"door"==d||"window"==d||c.createJsonArray(a,j,b,k)}),console.log(k),j},createBlockJson:function(a,b,c,d){var e,f=this,g=this.translatePoint({x:a.x1,y:a.y1}),h=this.translatePoint({x:a.x2,y:a.y2});if(c.some(function(a){return index=f.getPointIndex(a,g),index<0&&(index=f.getPointIndex(a,h)),index>=0&&(e=a),null!=e}),!(null==e||index<0)){var i={x:(g.x+h.x)/2,y:(g.y+h.y)/2},j=this.getPointOffset(e,i,index),k=Math.atan((g.y-h.y)/(g.x-h.x));e.children=e.children||[];var l=Math.sqrt((g.x-h.x)*(g.x-h.x)+(g.y-h.y)*(g.y-h.y)),m={id:b,position:[i.x,d,i.y],rotation:[0,k,0],width:l,client:{edgeIndex:index,offset:j}};e.children.push(m)}},createJsonArray:function(a,b,c,d){var e=this,f=(a.attrib.layer.split("#"),make.Default.getType(c)),g=this.getEntityPoints(a,1===a.flags),h={};if("wall"==f||"innerWall"==f||"floor"==f)h={id:c,data:g},"wall"==f&&g[0].toString()==g[g.length-1].toString()&&(g=g.slice(0,g.length-1),h.data=g,h.closed=!0,h.showFloor=!0);else{var i=this.getRectOfPoints(g);if(!i)return null;var j=i.max.x-i.min.x,k=i.max.y-i.min.y,l=i.center(),m=0;a instanceof dxf.InsertData&&(m=a.angle),h={id:c,width:j,depth:k,rotation:[0,m,0],position:[l.x,"floor-top",l.y]};var n=e.getText(c,i.min,i.max,d);n&&(h.objectId=n,h.client=h.client||{},h.client.bid=n)}b.push(h),("wall"==f||"innerWall"==f)&&this.walls.push(h)},getText:function(a,b,c,d){for(var e=0;e<d.length;e++){var f=d[e];if(f.id==a){var g=f.point;if(g.x>b.x&&g.x<c.x&&g.y>b.y&&g.y<c.y){var h=f.text;return d.splice(e,1),h}}}},translatePoint:function(a){var b=0,c=0,d=0,e=0,f=d-b,g=e-c,h=0,i=0,j=this.scale;return{x:(a.x-b-f/2)*j+h,y:(-a.y+e-g/2)*j+i}},getFixedNumber:function(a){return parseFloat(a.toFixed(0))},getEntitiesPoints:function(a,b,c){var d=[],e=this;return a.forEach(function(a){var f=e.getEntityPoints(a,1===a.flags,b,c),g=d.length;g>=4&&d[g-2]===f[0]&&d[g-1]===f[1]&&(f.shift(),f.shift()),d.push.apply(d,f)}),d},getRectOfPoints:function(a){if(!a||a.length/2<2)return null;var b=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,d=Number.POSITIVE_INFINITY,e=Number.NEGATIVE_INFINITY,f=0,g=a.length,h=function(a,f){d=Math.min(d,a),e=Math.max(e,a),b=Math.min(b,f),c=Math.max(c,f)};if(g>0&&a[f]instanceof Array)for(;g>f;f++){var i=a[f];2==i.length?h(i[0],i[1]):5==i.length&&"c"==i[0]&&h(i[3],i[4])}else for(;g>f;f+=2)h(a[f],a[f+1]);return{min:{x:d,y:b},max:{x:e,y:c},center:function(){return{x:(this.min.x+this.max.x)/2,y:(this.min.y+this.max.y)/2}}}},getBulgeVertex:function(a,b,c){var d={x:b.x,y:b.y},e={x:c.x,y:c.y},f={},g=(d.x-e.x)*(d.y-e.y)*a;return g>0?f={x:e.x,y:d.y}:0>g&&(f={x:d.x,y:e.y}),f},getEntityPoints:function(a,b,c,d){c=c||0,d=d||0;var e=[],f=this;if(a instanceof dxf.LineData){var g=f.translatePoint({x:a.x1+c,y:a.y1+d});e.push(this.getFixedNumber(g.x),this.getFixedNumber(g.y)),g=f.translatePoint({x:a.x2+c,y:a.y2+d}),e.push(this.getFixedNumber(g.x),this.getFixedNumber(g.y))}else if(a instanceof dxf.PolylineData)for(var h=0;h<a.points.length;h++){var i=a.points[h],g=f.translatePoint({x:i.x+c,y:i.y+d});if(e.push([f.getFixedNumber(g.x),f.getFixedNumber(g.y)]),i.bulge&&.414==Math.abs(i.bulge.toFixed(3))){b=!1;var j=a.points[++h]||a.points[0],k=f.getBulgeVertex(i.bulge.toFixed(3),i,j),l=f.translatePoint({x:j.x+c,y:j.y+d}),m=f.translatePoint({x:k.x+c,y:k.y+d});e.push(["c",f.getFixedNumber(m.x),f.getFixedNumber(m.y),f.getFixedNumber(l.x),f.getFixedNumber(l.y)])}}else if(a instanceof dxf.InsertData){var n=a.name,o=null,p=f.parser.sections.blocks,q=a.ipx+c,r=a.ipy+d;o=p[n],e=f.getEntitiesPoints(o.entities,q,r)}if(b){var s=e.length;(e[s-2]!=e[0]||e[s-1]!=e[1])&&e.push(e[0])}return e},pointArrayToPointObjects:function(a){var b=0,c=a.length,d=[];if(a[0]instanceof Array)for(;c>b;b++)d.push({x:a[b][0],y:a[b][1]});else for(;c>b;b+=2)d.push({x:a[b],y:a[b+1]});return d},isPointOnLine:function(a,b,c,d){0>d&&(d=0);var e=this.getDistanceFromPointToLine(a,b,c);return d>=e&&a.x>=Math.min(b.x,c.x)-d&&a.x<=Math.max(b.x,c.x)+d&&a.y>=Math.min(b.y,c.y)-d&&a.y<=Math.max(b.y,c.y)+d},getDistanceFromPointToLine:function(a,b,c){if(b.x===c.x)return Math.abs(a.x-b.x);var d=(c.y-b.y)/(c.x-b.x),e=(c.x*b.y-b.x*c.y)/(c.x-b.x);return Math.abs(d*a.x-a.y+e)/Math.sqrt(d*d+1)},getPointOffset:function(a,b,c){var d=a.data,e=this.pointArrayToPointObjects(d),f=e[c],g=e[c+1];g=g||e[0];var h=0;return f.x!=g.x?h=(b.x-f.x)/(g.x-f.x):f.y!=g.y&&(h=(b.y-f.y)/(g.y-f.y)),h},getPointIndex:function(a,b){var c=a.data,d=this.pointArrayToPointObjects(c);if(d.length<2)return-1;for(var e=0;e<d.length;e++)if(_twaver.math.getDistance(b,d[e])<=10)return-1;for(var f,g=d[0],e=1;e<d.length;e++){if(f=d[e],this.isPointOnLine(b,g,f,10))return e-1;g=f}return g=d[0],this.isPointOnLine(b,g,f,10)?d.length-1:-1}}),d.edit.JsonBox=function(){this._dataList=new mono.List,this._dataMap={},this._dataBoxChangeDispatcher=new TGL.EventDispatcher,this._dataPropertyChangeDispatcher=new TGL.EventDispatcher},mono.extend(d.edit.JsonBox,Object,{add:function(a){if(a){1===arguments.length&&(index=-1);var b=a.getObjectId();if(this._dataMap.hasOwnProperty(b))throw"Data with ID '"+b+"' already exists";this._dataList.add(a),this._dataMap[b]=a,this._dataBoxChangeDispatcher.fire({kind:"add",data:a,source:this}),a.addPropertyChangeListener(this.handleDataPropertyChange,this)}},contains:function(a){return a?this._dataMap[a.getObjectId()]===a:!1},remove:function(a){if(a){this._dataList.remove(a);var b=a.getObjectId();delete this._dataMap[b],this._dataBoxChangeDispatcher.fire({kind:"remove",data:a,source:this}),a.removePropertyChangeListener(this.handleDataPropertyChange,this)}},getDataById:function(a){return this._dataMap[a]},removeById:function(a){var b=this.getDataById(a);this.remove(b)},getDatas:function(){return this._dataList},clear:function(a){if(this._dataList.size()>0){var b=this._dataList.toList();b.forEach(function(a){a.removePropertyChangeListener(this.handleDataPropertyChange,this)},this),this._dataList.clear(),this._dataMap={},this._dataBoxChangeDispatcher.fire({kind:"clear",datas:b})}},toJson:function(a){var b=[],c=this._dataList;return c.forEach(function(c){var d=c.getId();if("twaver.idc.door"!=d&&"twaver.idc.window"!=d){var e={};c.serializeJson(c,e),(!a||a(c))&&b.push(e)}}),b},fromJson:function(a){for(var b=0;b<a.length;b++){var c=a[b];if(null!=c.objectId){if("remove"===c.action){this.removeById(c.objectId);continue}data=this.getDataById(c.objectId),data||(data=new d.edit.data.JsonObject(c.objectId),data._id=c.objectId)}else{data=new d.edit.data.JsonObject}if(data.deserializeJson(data,c),c.children&&c.children.length>0)for(var e=[],f=0;f<c.children.length;f++){var g=c.children[f],h=new d.edit.data.JsonObject(g.objectId);h.deserializeJson(h,g),e.push(h)}data.setChildren(e),this.add(data)}},handleDataPropertyChange:function(a){var b=a.source;this.onDataPropertyChanged(b,a),this._dataPropertyChangeDispatcher.fire(a)},onDataPropertyChanged:function(a,b){},addDataBoxChangeListener:function(a,b,c){this._dataBoxChangeDispatcher.add(a,b,c)},removeDataBoxChangeListener:function(a,b){this._dataBoxChangeDispatcher.remove(a,b)},addDataPropertyChangeListener:function(a,b,c){this._dataPropertyChangeDispatcher.add(a,b,c)},removeDataPropertyChangeListener:function(a,b){this._dataPropertyChangeDispatcher.remove(a,b)}});var r=function(a){r.superClass.constructor.call(this,a),this.pasteOffsetDy=0,this.contentPane3d=$('<div class="edit3d-container"></div>').appendTo(this.parentView),this.jsonBox=new d.edit.JsonBox,this.edit2d=this.edit2d=new d.edit.Edit2D(this.jsonBox,this),this.edit3d=new d.edit.Edit3D(this.jsonBox,this),this.model3dTo2dMapping=j.sceneEditorModel3dTo2dMapping,this.model2dTo3dMapping=j.sceneEditorModel2dTo3dMapping,this.accordionPane=this.edit2d.accordionPane,this.ruler=this.edit2d.ruler,this.network2d=this.edit2d.network2d,this.box=this.network2d.getElementBox(),this.fileIndex=1,this.init()};r.prototype={init:function(){var a=this;this.edit3d.doubleClickHandler=function(b,c){a.doubleClickHandler3D(b,c)},this.edit2d.doubleClickRackHandler=function(b,c){a.doubleClickHandler2D(b,c)},this.addKeyMoveListener(this.network2d),this.refreshAccordion(),this.adjustNetwork3dBoundingBox(),this.show2D(),this.hide3D()},adjustNetwork3dBoundingBox:function(){mono.Utils.autoAdjustNetworkBounds(this.edit3d.network3d,this.contentPane3d[0],"clientWidth","clientHeight",0,0)},doubleClickHandler3D:function(a,b){},doubleClickHandler2D:function(a,b){},isHost:function(a){return"wall"==a.getClient("type")},loadDxfFile:function(a,b){var c=this.edit2d,e=new d.edit.ImportDxf(.1),f=e.loadDxf(a);b&&(f=b(f)),c.createNodesByJson(f),setTimeout(function(){c.zoomOverview()},500)},parentResizeHandle:function(){r.superClass.parentResizeHandle.call(this),this.adjustNetwork3dBoundingBox()},align:function(a){var b=this;if(a){var c=this.edit2d.box.getSelectionModel().getSelection(),d=new twaver.List;c.forEach(function(a){a&&!b.isHost(a)&&d.add(a)}),!d||d.size()<2||make.Default.align(d,a)}},flow:function(a,b){var c=this;if(a){var d=this.edit2d.box.getSelectionModel().getSelection(),e=new twaver.List;d.forEach(function(a){a&&!c.isHost(a)&&e.add(a)}),!e||e.size()<2||make.Default.flow(e,a,b)}},refreshAccordion:function(a){a=a||c.utils.load2dSceneCategory(),this.edit2d.accordionPane.setCategories(a)},show2D:function(){this.contentPane.show(),this.edit2d.layoutGUI()},hide2D:function(){this.contentPane.hide()},show3D:function(){this.contentPane3d.show(),this.adjustNetwork3dBoundingBox(),this.edit3d.refreshNetwork3d()},hide3D:function(){this.contentPane3d.hide(),this.edit3d.box.clear()},zoomOverview:function(){this.edit2d.zoomOverview()},getData:function(a){var b=this,c=this.jsonBox.toJson();if(a){var d=[];return c.forEach(function(a){var c={};make.Default.copyProperties(a,c);var e=c.parentId,f=b.jsonBox.getDataById(e);f&&(f.position=f.position||[0,0,0],c.position=c.position||[0,0,0],c.position[0]-=f.position[0],c.position[2]-=f.position[2]),d.push(c)}),d}return c},setData:function(a,b){var c=this,d={};b&&(a.forEach(function(a){d[a.objectId]=a}),a.forEach(function(a){var b=a.parentId,e=d[b];e||(e=c.jsonBox.getDataById(b)),e&&(e.position=e.position||[0,0,0],a.position=a.position||[0,0,0],a.position[0]+=e.position[0],a.position[2]+=e.position[2])})),this.jsonBox.fromJson(a),setTimeout(function(){c.zoomOverview()},100)},getSelectedData:function(){var a=this.edit2d.box.getSelectionModel().getSelection();if(!a||0==a.size())return[];for(var b=[],c=0;c<a.size();c++){var d=a.get(c),e=this.jsonBox.getDataById(d.getId());e?b.push(e):console.warn("jsonObject is null, node.id="+d.getId())}return b},getSelectedNode:function(){var a=this.edit2d.box.getSelectionModel().getSelection();return a&&0!=a.size()?a.toArray():[]},appendData:function(a){return this.jsonBox.add(a)},removeData:function(a){var b=this;return a instanceof Array?a.map(function(a){return b.jsonBox.removeById(a.objectId)}):b.jsonBox.removeById(a.objectId)},removeNode:function(a){var b=this;return a instanceof Array?a.map(function(a){return b.box.removeById(a.getId())}):b.box.removeById(a.getId())},clear:function(){this.jsonBox.clear()}},c.SceneEditor=r,c.utils.ext(r,m);var s=d.edit.data.JsonObject=function(a){mono.PropertyChangeDispatcher.call(this),a=a||{},this.objectId=a.objectId||c.id("JsonObject"),this.name=a.name,this.id=a.id,this.radius=a.radius,this.width=a.width,this.height=a.height,this.depth=a.depth,this.position=a.position,this.rotation=a.rotation,this.color=a.color,this.data=a.data,this.client=a.client||{},this.style=a.style||{},this.children=a.children,this.parentId=a.parentId};mono.extend(s,mono.PropertyChangeDispatcher,{_init:function(){},_a:function(){},getObjectId:function(){return this.objectId},getId:function(){return this.id},setId:function(a){var b=this.id;b!=a&&(this.id=a,this.firePropertyChange("id",b,a))},getColor:function(){return this.color},setColor:function(a){var b=this.color;b!=a&&(this.color=a,this.firePropertyChange("radius",b,a))},getParentId:function(){return this.parentId},setParentId:function(a){var b=this.parentId;b!=a&&(this.parentId=a,this.firePropertyChange("parentId",b,a))},getWidth:function(){return this.width},setWidth:function(a){var b=this.width;b!=a&&(this.width=a,this.firePropertyChange("width",b,a))},getHeight:function(){return this.height},setHeight:function(a){var b=this.height;b!=a&&(this.height=a,this.firePropertyChange("height",b,a))},getDepth:function(){return this.depth},setDepth:function(a){var b=this.depth;b!=a&&(this.depth=a,this.firePropertyChange("depth",b,a))},getName:function(){return this.name},setName:function(a){var b=this.name;b!=a&&(this.name=a,this.firePropertyChange("name",b,a))},isClosed:function(){return this.closed},setClosed:function(a){var b=this.closed;b!=a&&(this.closed=a,this.firePropertyChange("closed",b,a))},isShowFloor:function(){return this.showFloor},setShowFloor:function(a){var b=this.showFloor;b!=a&&(this.showFloor=a,this.firePropertyChange("showFloor",b,a))},getPosition:function(){return this.position},setPosition:function(a){var b=this.position;b!=a&&(this.position=a,this.firePropertyChange("position",b,a))},getRotation:function(){return this.rotation},setRotation:function(a){var b=this.rotation;b!=a&&(this.rotation=a,this.firePropertyChange("rotation",b,a))},getData:function(){return this.data},setData:function(a){var b=this.data;b!=a&&(this.data=a,this.firePropertyChange("data",b,a))},getClient:function(){return this.client},setClient:function(a){var b=this.client;b!=a&&(this.client=a,this.firePropertyChange("client",b,a))},getStyle:function(){return this.style},setStyle:function(a){var b=this.style;b!=a&&(this.style=a,this.firePropertyChange("style",b,a))},getChildren:function(a){return this.children},setChildren:function(a){var b=this.children;b!=a&&(this.children=a,this.firePropertyChange("children",b,a))},serializeJson:function(a,b){this._serializeJsonCommon(a,b),this._serializeJsonType(b),b.client&&(delete b.client.id,delete b.client.objectId,delete b.client.parentId)},_serializeJsonCommon:function(a,b){this.serializePropertyJson("id",a,b),this.serializePropertyJson("objectId",a,b),this.serializePropertyJson("parentId",a,b),this.serializePropertyJson("name",a,b),this.serializePropertyJson("width",a,b),this.serializePropertyJson("height",a,b),this.serializePropertyJson("depth",a,b),a.position&&"0,0,0"!=a.position.toString()&&this.serializePropertyJson("position",a,b),a.rotation&&"0,0,0"!=a.rotation&&this.serializePropertyJson("rotation",a,b),this.serializePropertyJson("data",a,b),this.serializePropertyJson("radius",a,b),this.serializePropertyJson("closed",a,b),this.serializePropertyJson("showFloor",a,b),this.serializePropertyJson("client",a,b),this.serializePropertyJson("style",a,b),this.serializePropertyJson("color",a,b),this.serializeArray("children",a,b)},_serializeJsonType:function(a){var c=make.Default.getType(a.id);if(t[c]){var d=t[c],e=d.client||{},f=d.style||{},g=a.client||{},h=a.style||{};for(var i in e){var j=e[i];g[i]!==b&&(a[j]=g[i],delete g[i])}for(var i in f){var j=f[i];h[i]!==b&&(a[j]=h[i],delete h[i])}}},serializeArray:function(a,b,c){var d=b[a],e=[];if(d&&d instanceof Array&&d.length>0){for(var f=0;f<d.length;f++){var g={};this.serializeJson(d[f],g),e.push(g)}c[a]=e}},serializePropertyJson:function(a,b,c){b[a]&&(c[a]=g.clone(b[a]))},deserializeJson:function(a,b){this._deserializeJsonType(b);for(var c in b)this.deserializePropertyJson(a,b[c],c)},deserializePropertyJson:function(a,b,c){a[c]=g.clone(b)},_deserializeJsonType:function(a){var c=make.Default.getType(a.id);if(t[c]){var d=t[c],e=d.client||{},f=d.style||{},g=a.client||{},h=a.style||{};for(var i in e){var j=e[i];a[j]!==b&&(g[i]=a[j],delete a[j])}for(var i in f){var j=f[i];a[j]!==b&&(h[i]=a[j],delete a[j])}a.client=g,a.style=h}},clone:function(){var a=new s;return make.Default.copyProperties(this,a),a}});var t=c.serializeMap={channel:{client:{rackWidth:"rackWidth",rackDepth:"rackDepth",rackHeight:"rackHeight",rackNumber:"rackNumber",isSingle:"isSingle",side:"side",aisleDepth:"aisleDepth"},style:{},isRemain:!1},area:{client:{label:"label",opacity:"opacity"},style:{"label.xoffset":"labelPositionX","label.yoffset":"labelPositionZ","label.color":"labelColor","label.font":"labelFont"},isRemain:!1}},u=d.edit.interaction.MyCreateShapeNodeInteraction=function(a,b){d.edit.interaction.MyCreateShapeNodeInteraction.superClass.constructor.call(this,a,b)};twaver.Util.ext(d.edit.interaction.MyCreateShapeNodeInteraction,twaver.vector.interaction.CreateShapeNodeInteraction,{handle_mousedown:function(a){if(0===a.button){var b=this.currentPoint||this.network.getLogicalPoint2(a);if(b){if(2===a.detail){if(this.points){var c=this.shapeNodeFunction(this.points);this.network.addElementByInteraction(c),this.clear();var d=this;setTimeout(function(){d.network.setEditingElement(!1)},0)}}else{if(this.network.isEditingElement()||this.network.setEditingElement(!0),this.points||(this.points=new twaver.List),this.points.size()>0){var e=this.points.get(this.points.size()-1);if(e.x===b.x&&e.y===b.y)return}this.points.add(b)}this.repaint()}}},handle_mousemove:function(a){if(this.points){var b=this.points.get(this.points.size()-1),c=this.network.getLogicalPoint2(a);if(!_twaver.isCtrlDown(a)){var d=c.x-b.x,e=c.y-b.y;Math.abs(d)>=Math.abs(e)?c.y=b.y:c.x=b.x}this.currentPoint=c,this.repaint()}}}),d.edit.interaction.RoomDragInteraction=function(a,b,c){d.edit.interaction.RoomDragInteraction.superClass.constructor.call(this,a),this.propertySheetPane=b,this.jsonBox=c},twaver.Util.ext(d.edit.interaction.RoomDragInteraction,twaver.vector.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown","mousemove","mouseup","dragover","drop","dblclick")},tearDown:function(){this.removeListener("mousedown","mousemove","mouseup","dragover","drop","dblclick")},handle_dblclick:function(a){},handle_dragover:function(a){a.preventDefault?a.preventDefault():a.returnValue=!1,a.dataTransfer.dropEffect="copy";var b=this.network.getElementAt(a);if(b){if(this.network.lastElement&&this.network.lastElement!==b&&(this.network.lastElement instanceof make.Default.WallShapeNode&&this.network.lastElement.setClient("focusIndex",-1),this.network.lastElement=null),b instanceof make.Default.WallShapeNode){var c=this.network.getLogicalPoint(a),d=b.getPointIndex(c);b.setClient("focusIndex",d),d>=0&&(this.network.lastElement=b)}else this.network.lastElement=null;return!1}},handle_drop:function(a){a.stopPropagation&&a.stopPropagation(),a.preventDefault?a.preventDefault():a.returnValue=!1;var b=a.dataTransfer.getData("Text");if(!b)return!1;var c=JSON.parse(b),e=g.getSceneEditorModel3dId(c.id),f=g.getSceneEditorModel2dId(e),h=this.network.getElementAt(a);if(c.id)if(c.combo){var i=make.Default.load(c.id);g.createJsonObject(this.jsonBox,i,c.id)}else{var j=(make.Default.getOtherParameter(f,"layer")||900,make.Default.getOtherParameter(f,"type"));if("watercable"===j||"wall"===j||"area"===j||"innerWall"===j){var j=function(a){var b=[];a.forEach(function(a){b.push(a.x),b.push(a.y)});var c=make.Default.getType(e);if("wall"==c&&b.length<6)return null;if("area"==c&&b.length<6)return null;if("innerWall"==c&&b.length<4)return null;var d=make.Default.load({id:f,data:b});return d};this._createShapeNodeInteractions(j)}else if("door"===j||"window"===j){if(h&&h instanceof make.Default.WallShapeNode){var k=this.network.getLogicalPoint(a);h.setClient("focusIndex",-1);var l=h.getPointIndex(k);if(l>=0){var m=h.getPoints(),n=m.get(l),o=m.get(l===m.size()-1?0:l+1),p=o.x-n.x,q=o.y-n.y,r=Math.abs(p)>Math.abs(q)?(k.x-n.x)/p:(k.y-n.y)/q,s=(Math.atan((n.y-o.y)/(n.x-o.x)),new d.edit.data.JsonObject);s.id=e,s.position=[k.x,0,k.y],"window"===make.Default.getOtherParameter(f,"type")?(s.position=[k.x,30,k.y],s.setWidth(120)):"door"===make.Default.getOtherParameter(f,"type")&&(s.position=[k.x,0,k.y],s.setWidth(205)),s.client={edgeIndex:l,offset:r},s.client.id=e;var t=this.jsonBox.getDataById(h.getId());if(this.jsonBox.remove(t),t){var u=t.getChildren()||[];u.push(s),t.setChildren(u)}this.jsonBox.add(t)}}}else{this.network.getSelectionModel().clearSelection();var v=this.network.getLogicalPoint(a),w=[v.x,"floor-top",v.y],x=make.Default.getModelDefaultParameters(g.getSceneEditorModel2dId(e));x&&x.positionY&&(w[1]=x.positionY.value);var y=new d.edit.data.JsonObject;y.id=e,y.position=w,y.client=c,y.client.id=y.id,this.jsonBox.add(y);var z=this.network.getElementBox();this.network.getSelectionModel().appendSelection(z.getDataById(y.getObjectId()))}}return this._setNetworkCreateShapeNodeCursor(),!1},_createShapeNodeInteractions:function(a){this.network.setInteractions([new u(this.network,a),new twaver.vector.interaction.DefaultInteraction(this.network)])},_setNetworkCreateShapeNodeCursor:function(){var a=this;this.network.getInteractions().forEach(function(b){b instanceof twaver.vector.interaction.CreateShapeNodeInteraction&&(a.network.getView().style.cursor="crosshair")})},handle_mousedown:function(a){if(this.mouseDown=!0,this.lastLogicalPoint=this.network.getLogicalPoint(a),this.lastLogicalPoint){var b=this.network.getElementAt(a);if(!b||g.isMoveModel(b)){if(b instanceof make.Default.WallShapeNode)if(resize=this.network.getElementUI(b).isPointOnBorderLine(this.lastLogicalPoint),null!==resize)this.lastElement=b,this.network.isMovable=function(a){return!1};else{var c=b.getPointIndex(this.network.getLogicalPoint(a));c>=0&&(this.lastIndex=c,this.lastElement=b,this.network.isMovable=function(a){return!1})}b instanceof make.Default.Block&&(this.block=b)}}},handle_mousemove:function(a){var b;if(this._setNetworkCreateShapeNodeCursor(),this.mouseDown){var c=this.network.getLogicalPoint(a);if(!c)return this.network.getView().scrollTop+=10,void(this.network.getView().scrollLeft+=10);if(this.lastElement&&!g.isMoveModel(this.lastElement))return;if(this.block&&!g.isMoveModel(this.block))return;if(offsetX=this.lastLogicalPoint?c.x-this.lastLogicalPoint.x:0,offsetY=this.lastLogicalPoint?c.y-this.lastLogicalPoint.y:0,this.lastIndex>=0){g.stopPropagation(a);var d=this.lastElement.getPoints(),e=d.get(this.lastIndex),f=d.get(this.lastIndex===d.size()-1?0:this.lastIndex+1);this.network.enableSingleOrientationMove?this.mouseMoved||(this.horizontal=e.x==f.x,this.vertical=!this.horizontal,this.mouseMoved=!0):!this.mouseMoved&&_twaver.isCtrlDown(a)&&(this.horizontal=Math.abs(offsetX)>=Math.abs(offsetY),this.vertical=!this.horizontal,this.mouseMoved=!0),this.vertical||(e.x+=offsetX,f.x+=offsetX),this.horizontal||(e.y+=offsetY,f.y+=offsetY),this.lastElement.firePointsChange(null,this.lastElement.getPoints()),this.lastLogicalPoint=c}if(this.block){var h=this.block.getClient("edgeIndex"),i=this.block.getClient("length"),j=this.block.getClient("offset"),d=this.block.getParent().getPoints(),e=d.get(h),f=d.get(h===d.size()-1?0:h+1),k=f.x-e.x,l=f.y-e.y,m=Math.abs(k)>Math.abs(l),n=m?offsetX:offsetY,o=n;if(this.block.getClient("focusLeft"))m?k>0&&(o=-o):(k>=0&&0>l&&(n=-n),k>=0&&l>0&&(o=-o),0>k&&l>0&&(n=-n,o=-o)),this.block.setClient("length",i-n),this.block.setClient("offset",j-o/Math.abs(m?k:l)/2);else if(this.block.getClient("focusRight"))m?0>k&&(o=-o):(k>=0&&0>l&&(n=-n,o=-o),0>k&&l>0&&(n=-n),0>k&&0>l&&(o=-o)),this.block.setClient("length",i+n),this.block.setClient("offset",j+o/Math.abs(m?k:l)/2);else{var j=Math.abs(k)>Math.abs(l)?(c.x-this.lastLogicalPoint.x)/k:(c.y-this.lastLogicalPoint.y)/l;this.block.setClient("offset",this.block.getClient("offset")+j)}this.lastLogicalPoint=c}null!==b&&this.lastElement&&(0===b?(this.lastElement.setLocation(this.lastElement.getX()+offsetX,this.lastElement.getY()+offsetY),this.lastElement.setSize(this.lastElement.getWidth()-offsetX,this.lastElement.getHeight()-offsetY)):1===b?(this.lastElement.setLocation(this.lastElement.getX(),this.lastElement.getY()+offsetY),this.lastElement.setSize(this.lastElement.getWidth()+offsetX,this.lastElement.getHeight()-offsetY)):2===b?this.lastElement.setSize(this.lastElement.getWidth()+offsetX,this.lastElement.getHeight()+offsetY):3===b&&(this.lastElement.setLocation(this.lastElement.getX()+offsetX,this.lastElement.getY()),this.lastElement.setSize(this.lastElement.getWidth()-offsetX,this.lastElement.getHeight()+offsetY)),this.lastLogicalPoint=c)}else{var p=this.network.getElementAt(a),c=this.network.getLogicalPoint(a);if(p&&!g.isMoveModel(p))return;if(this.lastElement&&this.lastElement!==p&&(this.lastElement instanceof make.Default.WallShapeNode&&(this.lastElement.setClient("focusIndex",-1),this.network.getView().style.cursor="default"),this.lastElement instanceof make.Default.Block&&(this.lastElement.setClient("focus",!1),this.lastElement.setClient("focusLeft",!1),this.lastElement.setClient("focusRight",!1),this.network.getView().style.cursor="default"),this.lastElement=null),p instanceof make.Default.WallShapeNode)if(b=this.network.getElementUI(p).isPointOnBorderLine(c),null!==b)this.lastElement=p,this.network.getView().style.cursor="move";else{var h=p.getPointIndex(c);p.setClient("focusIndex",h),h>=0?(this.lastElement=p,_twaver.isAltDown(a)?this.network.getView().style.cursor=this.addPointCursor:this.network.getView().style.cursor="move"):p.isPointOnPoints(c)||(this.network.getView().style.cursor="default")}else p instanceof make.Default.Block?(p.setClient("focus",!0),this.network.getSelectionModel().contains(p)&&_twaver.math.getDistance(c,p.getClient("leftPoint"))<=10?(p.setClient("focusLeft",!0),p.setClient("focusRight",!1),this.network.getView().style.cursor="move"):this.network.getSelectionModel().contains(p)&&_twaver.math.getDistance(c,p.getClient("rightPoint"))<=10?(p.setClient("focusLeft",!1),p.setClient("focusRight",!0),this.network.getView().style.cursor="move"):(p.setClient("focusLeft",!1),p.setClient("focusRight",!1),this.network.getView().style.cursor="default"),this.lastElement=p):this.lastElement=null}},handle_mouseup:function(a){this.mouseDown=!1,this.mouseMoved=!1,this.horizontal=!1,this.vertical=!1,this.lastIndex=-1,this.lastElement=null,this.lastLogicalPoint=null,this.block=null,this.resize=!1,this.network.getView().style.cursor="default",delete this.network.isMovable},getAllElementsAt:function(a){var b={x:a.x-1,y:a.y-1,width:2,height:2},c=this.network.getElementsAtRect(b,!0,null,!1);return c},findFirstFloorAt:function(a){var b=this.getAllElementsAt(a);if(b)for(var c=0;c<b.size();c++)if(b.get(c)instanceof d.edit.data.FloorShapeNode)return b.get(c)}}),d.edit.interaction.RoomEditInteraction=function(a,b){d.edit.interaction.RoomEditInteraction.superClass.constructor.call(this,a)},twaver.Util.ext(d.edit.interaction.RoomEditInteraction,twaver.vector.interaction.EditInteraction,{deletePointCursor:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAACXBIWXMAAAsTAAALEwEAmpwYAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAGYSURBVHja1JS/SwJhGMc/r16ieXENRSBJQijo0OIS/gE1BK4tzorQVHNTU3OB2ByNDW21tTidtClY0A+nFvHojsCyt+UNTvMujSL6LHccz/fD8/Lc+4hsNssQa8A6kAPS6lsTqAHnwIW72DRNRqG53hPAFlAqpyw9M9tjKfoKwL2jrTa6odVKyygCVeAQuMMHzSXdKyatQj7uEAnKgaKM0SNj9NhYdPSzdnTn6NpYAHb95AH13ComrcJmwv4kdRMJSjYTNsWkVVCnw0+8BpTycYdxUbUllfUUr5dTlu7X6ajOyylLV0P2FOcysz0mRWVyfuL0x/QnQWXSXw3vxwkAzXtHmzioMk0/ca3RDU0sVpman/i80jLs574YW/rcF1Rahq2uuKf4AqietaNji1VtdXhvuAnGYjGAVr0TngsH5cryzAtTAe9OTx90jq6NY2DfNM3uV+IucFXvhPsntzMrUU2GEDCtSV7eBDdPU1w+Rtg25+16J3ygpL5LSHxnbXqtygGxlPJX/mPtOyEhhPyzjn/1Sv8v8fsAeL2I1faEYBkAAAAASUVORK5CYII'),auto",
setUp:function(){d.edit.interaction.RoomEditInteraction.superClass.setUp.apply(this,arguments)},tearDown:function(){d.edit.interaction.RoomEditInteraction.superClass.setUp.apply(this,arguments)},handle_mouseup:function(a){if(this.isStart){var b=_twaver.clone(this._endLogical);if(this.resizingRect)if(this.lazyMode)if(this.network.isResizeAnimate()){var c=this,d=new twaver.animate.AnimateBounds(this.node,this.resizingRect,function(){c.network.fireInteractionEvent({kind:"lazyResizeEnd",event:a,element:c.node,resizeDirection:c.resizeDirection})});twaver.animate.AnimateManager.start(d)}else this.node.setLocation(this.resizingRect.x,this.resizingRect.y),this.node.setSize(this.resizingRect.width,this.resizingRect.height),this.network.fireInteractionEvent({kind:"lazyResizeEnd",event:a,element:this.node,resizeDirection:this.resizeDirection});else this.node.setLocation(this.resizingRect.x,this.resizingRect.y),this.node.setSize(this.resizingRect.width,this.resizingRect.height),this.network.fireInteractionEvent({kind:"liveResizeEnd",event:a,element:this.node,resizeDirection:this.resizeDirection});else if(this.shapeNode&&this.pointIndex>=0&&b){var e=this.shapeNode.getPoints().get(this.pointIndex);this.horizontal&&(b.y=e.y),this.vertical&&(b.x=e.x),this.shapeNode.setPoint(this.pointIndex,b),this.network.fireInteractionEvent({kind:"liveMovePointEnd",event:a,element:this.shapeNode,pointIndex:this.pointIndex})}else if(this.shapeLink&&this.pointIndex>=0&&b){var e=this.shapeLink.getPoints().get(this.pointIndex);this.horizontal&&(b.y=e.y),this.vertical&&(b.x=e.x),this.shapeLink.setPoint(this.pointIndex,b),this.network.fireInteractionEvent({kind:"liveMovePointEnd",event:a,element:this.shapeLink,pointIndex:this.pointIndex})}else this.linkUI&&b&&(this.linkUI.setControlPoint(b),this.network.fireInteractionEvent({kind:"liveMovePointEnd",event:a,element:this.linkUI._element}))}this._handle_mouseup(a),this.clear()},_isEditingShapeNode:function(a,b){if(this.node instanceof twaver.ShapeNode){this.shapeNode=this.node;for(var c=this.shapeNode.getPoints(),d=this.network.getEditPointSize(),e=0,f=c.size();f>e;e++){var g=c.get(e);if(this._contains(a,g,d))return _twaver.isAltDown(b)?this._setCursor(this.deletePointCursor):this._setCrossCursor(),this.pointIndex=e,!0}if(!this.shapeNode.getPointIndex)return!1;if(null!=this.shapeNode.getPointIndex(a)&&this.shapeNode.getPointIndex(a)>=0)return!0}return this.pointIndex=-1,!1},_resetShapeNodePoints:function(a){if(this.lastPoint){if(!_twaver.isCtrlDown(event)){var b=a.x-this.lastPoint.x,c=a.y-this.lastPoint.y;Math.abs(b)>=Math.abs(c)?a.y=this.lastPoint.y:a.x=this.lastPoint.x}}else this.lastPoint=a;d.edit.interaction.RoomEditInteraction.superClass._resetShapeNodePoints.call(this,a)},handle_mousemove:function(a){if(this.network.isValidEvent(a)){if(this.isStartRotate&&this.node)return this._handleRotateElement(a,this.node),void(this.network.isShowRotateScale()&&this.repaint());if(this.isStart){if(this.shapeNode&&this.pointIndex>=0){this._handleMovingShapeNodePoint(a);return}if(this.shapeLink&&this.pointIndex>=0)return void this._handleMovingShapeLinkPoint(a);if(this.node&&this.resizeDirection)return void this._handleResizing(a);if(this.linkUI)return void this._handleMovingLinkControlPoint(a);var b=this.network.getLogicalPoint2(a);if(this.node&&this.node instanceof twaver.ShapeNode&&this.node.getPointIndex(b)&&this.node.getPointIndex(b)>=0)return void(this.network._dragToPan=!1)}else{this.lastPoint=null;var c=this.network.getElementAt(a);if(!c||g.isMoveModel(c)){if(this.network.isSelectingElement()||this.network.isMovingElement()||0===this.network.getSelectionModel().size())return void this.clear();var d=this.network.getElementUI(c);if(!d||!d.getEditAttachment())return void this.clear();var b=this.network.getLogicalPoint2(a);if(c instanceof twaver.ShapeNode&&(b=this.network.getLogicalPoint(a)),c instanceof twaver.Node){if(this.node=c,this.node instanceof make.Default.Block)return this.network._dragToPan=!1,void(this.isStart=!0);if(this._isEditingShapeNode(b,a)||this._isResizingNode(b))return void this.network.setEditingElement(!0);if(this._isRotatingElement(b))return this.network.setRotatingElement(!0),void this.network.setEditingElement(!0)}else if(c instanceof twaver.ShapeLink){if(this.shapeLink=c,this._isEditingShapeLink(b))return void this.network.setEditingElement(!0)}else if(d instanceof twaver.network.LinkUI&&twaver.Link.isOrthogonalLink(d._element)){this.linkUI=d;var e=this.linkUI.getControlPoint();return void(e&&this._contains(b,e)&&(this._setCrossCursor(),this.network.setEditingElement(!0)))}this.clear()}}}},handle_mousedown:function(a){if(0===a.button)if(!_twaver.isAltDown(a)||this.network.isEditingElement()){if(this.network.isEditingElement()&&!this.isStart&&!this.isStartRotate)if(this.node&&this.resizeDirection)this.isStart=!0,this._handle_mousedown(a),this.network.fireInteractionEvent({kind:this.lazyMode?"lazyResizeStart":"liveResizeStart",event:a,element:this.node,resizeDirection:this.resizeDirection});else if(this.shapeNode&&this.pointIndex>=0){var b=this.shapeNode.getPoints()._as.length;_twaver.isAltDown(a)?2==b?confirm("You will delete the entire wall, Sure to Delete")&&(this.shapeNode.removeAt(0),this.shapeNode.removeAt(1),this.network.fireInteractionEvent({kind:"removePoint",event:a,element:this.shapeNode})):confirm("Sure to Delete")&&(3==b&&this.shapeNode.setClient("shapenode.closed",!1),this.shapeNode.removeAt(this.pointIndex),this.network.fireInteractionEvent({kind:"removePoint",event:a,element:this.shapeNode})):(this.isStart=!0,this._handle_mousedown(a),this.network.fireInteractionEvent({kind:"liveMovePointStart",event:a,element:this.shapeNode,pointIndex:this.pointIndex}))}else this.shapeLink&&this.pointIndex>=0?_twaver.isAltDown(a)?(this.shapeLink.removeAt(this.pointIndex),this.network.fireInteractionEvent({kind:"removePoint",event:a,element:this.shapeLink})):(this.isStart=!0,this._handle_mousedown(a),this.network.fireInteractionEvent({kind:"liveMovePointStart",event:a,element:this.shapeLink,pointIndex:this.pointIndex})):this.linkUI?(this.isStart=!0,this._handle_mousedown(a),this.network.fireInteractionEvent({kind:"liveMovePointStart",event:a,element:this.linkUI._element})):this.shapeNode?this.isStart=!0:this.node&&(this.node.getClient("className")&&"mono.Billboard"==this.node.getClient("className")||(this.isStartRotate=!0,this._handle_mousedown(a)))}else{var c=this.network.getElementAt(a),d=this.network.getLogicalPoint(a);if(c instanceof twaver.ShapeNode){var e=this.getPointIndex(c.getPoints(),d,!0);e>0&&(this._handle_mousedown(a),this.pointIndex=e,this.shapeNode=c,c.addPoint(d,e),this._setCrossCursor(),this.network.setEditingElement(!0),this.isStart=!0,this.network.fireInteractionEvent({kind:"addPoint",event:a,element:c,pointIndex:e}),this.network.fireInteractionEvent({kind:"liveMovePointStart",event:a,element:c,pointIndex:e}))}if(c instanceof twaver.ShapeLink){var f=new twaver.List(c.getPoints()),g=this.network.getElementUI(c);f.add(g.getFromPoint(),0),f.add(g.getToPoint());var e=this.getPointIndex(f,d)-1;e>0&&(this._handle_mousedown(a),this.pointIndex=e,this.shapeLink=c,c.addPoint(d,e),this._setCrossCursor(),this.network.setEditingElement(!0),this.isStart=!0,this.network.fireInteractionEvent({kind:"addPoint",event:a,element:c,pointIndex:e}),this.network.fireInteractionEvent({kind:"liveMovePointStart",event:a,element:c,pointIndex:e}))}}},clear:function(){d.edit.interaction.RoomEditInteraction.superClass.clear.apply(this,arguments),this.network._dragToPan=!0,this.network.setRotatePointSize(twaver.Defaults.NETWORK_ROTATE_POINT_SIZE)}}),d.edit.interaction.RoomListener=function(a,b,c){d.edit.interaction.RoomListener.superClass.constructor.apply(this,arguments),this.network=a,this.propertySheetPane=b,this.jsonBox=c,this.box2d=this.network.getElementBox(),this.initLayer()},twaver.Util.ext(d.edit.interaction.RoomListener,Object,{initLayer:function(){for(var a=this.box2d.getLayerBox(),b=100;900>=b;b+=100){var c=new twaver.Layer(b);a.add(c)}},initRoomSettings:function(){this.network.enableSingleOrientationMove=!1,this.network.getView().setAttribute("draggable","true"),this.network.setEditPointFillColor("yellow"),this.network.setEditPointOutlineColor("#333333"),this.network.setEditPointOutlineWidth(1),this.network.setEditPointSize(10),this.network.setResizePointSize(0),this.network.setToolTipEnabled(!1),this.network.setKeyboardRemoveEnabled(!1),this.network.setRotatePointFillColor("yellow"),this.interactions2d=[new d.edit.interaction.RoomDragInteraction(this.network,this.propertySheetPane,this.jsonBox),new d.edit.interaction.RoomEditInteraction(this.network),new twaver.vector.interaction.DefaultInteraction(this.network)],this.network.setInteractions(this.interactions2d),this.installNetwork2dFunctions(this.network),this.installNetwork2dListeners(this.network)},installNetwork2dFunctions:function(a){a.isRotatable=function(a){return g.isChild(a)?!1:g.isEditModel(a)},a.isEditable=function(){return!0},a.setMovableFunction(function(a){return g.isChild(a)?!1:g.isMoveModel(a)}),a.setEditableFunction(function(a){return g.isChild(a)?!1:g.isEditModel(a)})},installNetwork2dListeners:function(a){var b=this;a.getElementBox().addDataBoxChangeListener(this.handleDataBoxChange,this),a.addElementByInteraction=function(a){twaver.vector.Network.prototype.addElementByInteraction.call(this,a),setTimeout(function(){b.network.setInteractions(b.interactions2d)},100)}},handleDataBoxChange:function(a){var b=a.kind,c=a.data;if("add"===b){var d=g.getSceneEditorModel2dId(c.getClient("id"));c.setLayerId(make.Default.getOtherParameter(d,"layer")||900);var e=make.Default.getOtherParameter(d,"type");e&&e.indexOf("wall")>=0}}})}(window),function(a,b){function c(){this._w=4096,this._h=2048,this.init()}var d={};a.it=d,d.version="0.1.2";var e=d.Util={};e._debug=!0,e.dropImg=new Image,e.dropImg.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJAAAADYCAYAAAAETWq5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAFDCSURBVHja7L15mF1XdS/4W3ufc2+VSpKt0ZMk22BsPOGBMRBsYcCAgTCElxcSBpOXfEl35+vQ6X7f+zqdPEje13ndyQuQgYRMYMeZQ4B8gG1IbIw7wcZmkBmMB2JkY8myLVm2Sqqqe8/ea/Ufe+199jn33Bo02JJcx1xUVbfqDuf87lq/tdZvrUUignhcufUKLPX44i0343g+pqenL161atW24/X9Hcw1z6+7wfIx7sTSlVuvMADeOj09fcbyGek+lgE0/igATDjnLID3L5+OZQAdDIBWEehVIvK25dOxDKCDAdBq56qSiLZMT09vXT4lywBa6rlZWfZ65+n3Vy+fkmUALeWwACaMMSv1+/dOT0+fuHxaRs30csg+5sP1jv/4E+cBgACg8LO3ArjmeHqT813TxYT4yxZoTAjfn+iXmzZv2gwA0FyZiPxvy2dnGUALHs87++xiw4YNk5s2bX4+QCAiiABE9ILp6emLl8/QMoDmPcqyKE5cs2blxpNPugikBojS3e9fPkPLAJrvoFWrVk+sXrX6hKkVU2dACAIBBNCyzzKZXgbQ/MeKqRW98y684HlkzISAwQwwM7Ky4XJIvwyg7uOubdustXbFWc973ktI3Rczg1kgItEKLbuxZQB1H4/u2lVMTk6u2rBh/YUigPcMZg+vIOIAoNOnp6ffuny2lgE0wn8e3fXoRFGWJ65avfr5ATAM7wXecXBjnKL6ZSu0DKBRAFlrp84977xLyrJcy8LwlcB7DyfBCgmSG7t8OaRfBlDjeHD7g4X3furkU05+kQAQBrx4eGGw83DMcD64suWQfhlAI9bnnrvv7lfD4QkbNm7cKixg9nDewzuGF4b3DOc8WBKI3vtsF5uNrYU9y+peAED7pqcnN23Z8vyJiYlNzjGcd2DP8MwACSAMQwTvGUQEY2wM6T94PJ6QxWBg2QLpedixY0cpzCecfsbprwEAz8HieC9gL4FIq/tyXkJEFqzQ+5/NicVnO4Ao3nY+vKMvIus2bNh4RQAHw3sfbuwDiNjBO4ZjDy8SLBNwwrOZC5lnOXjiv/apJ5+cOv2M01/cn+hv8kqWK8cQ8YAIRBgigsp7iGdw5Zet0LIFCtZn7969pfd+7WmbNr8JCHke7xleAE6Z6ODSxLtArtmnnz2brZBZtj4wP3zwocmy1ztjzdo1l7EI2Huw8/BOcz8ikFBPhWOBY+VEHAi2ZqevXgbQsxNE9qmnnjph0+bNbzDGTLCXkO9hASAQFggo+1rgnVohF8DlnQdCeePqZQA9y9IY//797088uXfv2pNPOfmdLKHW5T1DEFwUEYW8j/IgKD8SQcgPMcPXNbKPPNu40LPZhREA7H5896oznnPma4qiWOu9gCUAJ1oXFk5aIBGAAZAIKlfBM6PyAUAuWKFnHRd6Nlsg8+TevcWe3btPPPW0065WhwXvBJ7V2qiTE/2/KOdgQUouimOIZqafjRGZeRZbH7r33vtWbT7j9NdOTk6ezT5wHCcMycVjAqgmEUqF0sMEmYcPLowZzjesEC0D6DgG0e7HH7eP7Nix+tRTT/1ZgMASLIj4lCBMIBIQKCKHaovEPvzMVR4CUiAFK7R///4TlwF0fL5fAkDbvvHNFWeceeZrJyYmzvXeQ0TgvIeAIXW1vTZDWeRP+jNBdGs+EetKrZCIfPDZYIXMs9T6FA888MDKTVs2/3xwRSocY68RmLosSV/pv6T2SGElMfoiiPcQHywYBwv2v05PT5++DKDjEEC3fvnW/iWXXvraiYmJC0OtK8g0hAXsQ9QV/JdkLDpzZurGoriMRQL4EML9ynH8g99dBtBxRp537thh//3++6fOet5Z/zcQXI5nRjV08KwV9yzaisnDGkISwKUxPavFYSGwVxDWJY4fm56eftUygI6jyOumf/6XyTe95S0/U/Z6GyvnIcwhs4xQfWdIEoyJSMMYSZYPivyHod9H8ZlaJY3IAOADywA69sEDAHTnV++wExMTm0/bdNp/YbU2ngVD79X6xAp7yO0Ic7I2klCEdB9DAgDZq7UiVSwiJBeDFbp8enr6fcsAOg5A9PWvfW3qZS9/+a8YY6ac8yoSC/kf7xmsLTzMouUJ1FYIdSJRMmvELJo3UiD58Lis2WkV4H/4eE0ummeL9fnUP3yy94KLLnr5mrVrfjJINRgMla2ygJ2vc0FqeSRFYUqZM9clWXE1Nh8mQu2DhohZUB3nJY5nhQu7a9s2+v7996865/nnfBgAKrU+7CWIw2LTIKtrkhiK59Ymxe5NEElMAYTvY0baZ2RaE5MfmJ6ePnMZQMeg9fnWtrtW/PhP/Idf7k9MnOU8g6WWYUSwBBDUEVgiz40jyw+lKD+SaLVcIEDq7g2vhVk9PrEMoGMLQObOr95RbNmy5fwNGzf+oojAOQdhBK4iElwZB3eE5MJS8yDyQewiGYiiFWJkuSBOvMh7To/j67D+8uNNM2SOZ+tz17ZtdMvNN68878ILft8YMzWsNNpiDvUr8aGmpRaIY8SFJnhk1BQlV9b4XgIwQQQBo3LBKjEzqppQH1eaoePaAt1x2+39H/+J//DLk5OTL3Sxu0IFYR7Qdh3lQOrKIiked7TvC1ZIassj9WN59nCsbUEKIiXUH1wG0FGeNLz1li/bc84994L1Gzb8koigqkJrDnsgFE8DLwnEWV2XILUty3woalXIGlaIAfGBCzGzdrUK2DUI9S8dL3OnzXEIHty1bZu59ZZbVp57/nkfDa7L1a7LuwZPYU0IQqOuceDpdmOZFRJpcaEAKC+hDcgjJBarykcrds3x4MqORwtkvnTTzb33/sz7fn1ycvKFIWRXkZiG1sw+XdyoJGQgH5ow7yHtGmuOKImlEIaom6y8T6kC7z0q5wDg9OMhN2SOM+tD111zrb3s8stfsWbt2l8UCYm82vqE0FqihINrofx81qfbCknDnUkK7dUS+VrVyMyhVUgEnpEsn+aGLl4G0FFy3LVtm1m/fv2pzznrudcCwGBYaWkh9Lg7rsN0r+J5lqVZnxEyLR1eTQCGRl2aI/IMTVIGLjSsfPzTa5YBdJRYn89+5p8mLn7hpR8piuKU4bBKxVJhhvcO4Cxs17ZTHpPzWTSQ8v9vFF0pFF0RxPneM3ylfEhC5b+qHABcND09/cFlAD3DCcPrrrm29853/fQvrFq16i2xrz0m82KZQUDatqwzflKNSxYNnm431jREqdCq0Vj8mzisSrSXzB0Hrux4AJC59ZYv24suvvgVGzZu/KCIYDh0oSyhIbtXixPrVlEoFkP3gz3GujG1QkKhTTqANDxvGA0TXCZ7xqCOyj5zLEZl5hi3PPaubduImTdt3rL5D40xU4NBBWavep04XbXusvDeq/xi6dZnsW6stkKIHauIFX3vHLxTV6byjywq++AygJ7mnM+3tt214tzzzvtQ2eudHfI9DCcMB+h0DQEIQWnIDrF9ORRUD9bydLgxQWdpQzT/EwFFRHDs4aBJTRat3h+bCUZzDIOHrv/s5/qvvPyyX5haOfUW70N9y7NAPHQuizQ5SNL6cCZPPUTrI90AS1V7Du4y7NyoC7bMAg/92guqysXXcky5MnOsgufOr95RbD59y4+u37Dh/xURDCoHrwMQCFS314iABMFtqMqQBYcMnLYTk24ylIDknSYW9S7vKkBVkLFaX1WpVnbNMoCOIIDuv+8+Ozs7u+mMM8/8RxHBYOiydQSagwGDtI0w1buizhkHH7Z3uzGMuDFpCc8401ZHrZFjl6yQ98GVqRj/LdPT0+9fBtARsDwIhdIV5194wd8S0cqhczrLMCoEQ5aZiBAbuLx2T8QLvNSk4cG4sREupGNjkGWrfWwJ0iq+Zy361jrqi5cBdHjBY/7h7/5+4qo3v+n3+v3+i4aVg6vU8kDSLMPU6w4tbKY9F9ECHW4X1u3GUkQW74+SEZ3UIAC8c5BcZuIZw2HiQ0d9wdUcI+ABAHzxxhvLl77spT+/atWq9wR9TYi6vDb5peEG8cJx/QmPEzcOK/NZwI0lV9a4cQJT4EikURqnSr53STt0EYCPLAPoMIDozq/eUZ62afOPnrhmzW8wCwaDKksOCoQ4zfSpl6SEUXQsPrt4R8L6zO/GqPV7teYo1skYzBTainxwZ05VBAjT8N/XeihqPSx1PNUygOJx/3332enp6VNP23TaXxDR1LCqVACvkzQ4jJuDULA0ELCL4XIotgtqLnLkju5oTLKcUO3G8oZFoHJVsJiox+YN69D+w9PT05eMAQmN44odYKMO8B23AEq85/av3DZ1yQsvvSEUSR0qxwkYISz3yk051aCifJXZJwHZEYHMItxY83frDDiIMndG8OzDxDPPqQQzCHzoBACf0JlD80slm/92WSl5Nlkg8w9/9/cTr7vqDR8vy/KcwbDC0Hl1SyqNEN/oWU+jdzkbO3cEXddSojFoMTdvRKx/ppEZhQSj17qZ9zUfEpEPt6xIfjOLdGVxztphsUbmKLY+5tZbvtx78Utf8j+tWLHibS5uytGRcpLfpHYNUfUX9cchB3PkwdPlxqT12Vd7o66MU/MiMpIdxswA8AzJRs9kfOjqedwXOoCFBfjTfK7vmANQnuuxa9as+dH169f/diTNARSoZaPS1OF4ZrjMAh1J17UYN9b+Olqc4OJUL5R3vEZXFoc9tPhQzA/t37//4kW6ssWSbGr9bdtKHVsW6P777rNr1qw5/4znnPkpEcHcoNJwXTtKNVkY61y56xIfs841WX36rM8YvXR+GbKWaEEYTJVhKBPnM+Al5Yec9zE/dIKIfHz//v1ruqx29u84cMxnpeazascGgO7ats3ufWLvKZu2bP4bgFbODYdBAKYj5EJtK3KaKJTXBSgZeT7MXHGJVqjFZUcoLYEka4mOI4Vl1B2nUTLqmodV4kOfWIDHLDb6kgXclxwLFigRwTu/esfkGc8583fLsjxnbjBEVXmdGoZALtW61M18enI5dl4o7+Gn1/IsypEkIiShyhJLHJxFZdkIGUZcuykq+wgcaRiksD82PT39S4s8t7JA2N/1iheFjaPJAplP/cMne6+76g3/ecWKFW8dVC7rqAiAIK7XLkWQpOEIXhv4pNnb/ozgRlpXZIwDIBHdhBhft29wOtadHcKSBGhOd3Sofuh39u/fv7VlPcw8IKEFOBGNAZKMc2XmaLE+t97yZXvhRS+4as2aNb/mvEc1rOoqeoCLapjREXUpeI5AueLwWqJGOKa5K6qTi0T1fdESxWAg8iYOrjsmGUXkH2dnZ9eO4T5mARe3EKEeR6bpaAFQ6iTdeNJJrzjp5JOvZWYMBlWoD+WkmJuzenzWz54a+USedtK8cDg/j08jNAYwptwQ0WgmW2t8opEm+wginOCc++fsWhoAtsPKmHlAMo4DzT8w+2iwQHdt22an9+079aSTNn6MiKbmhgE8LCGZph3sjSglWqZQR/KZy3qmXdc8UzzSoHsauRwCCtOntUctr9nF2lnUEAUeGArH3qVhni/Yv3///8iAI2OiMtsC2nxRl3Rx1DaYzDNsfcydX71j8pznP/8TZa939txgCFfVbcChixQj4EmS0DhWNw1KOOqc1/i3nn/Gc6GZ56ws03TXnlXT5JsTP0I1X35x//79b87AYTpARIuIzqjjMdIrbf2tmGcQPPSxj/5h76o3v+m/Ta5YccXcYKikWQkiC8CxVoSaD7Bk+p5aHB87L55RWGSupzmMqslBKVqidCk0rOdaxZjWKeRSEG0FiklUpy3T2eyhPztw4MAlGF9gRcuSLBTmy0IJX/MMgQef+dSny61XvOqNq1ev/iXnXFDicT01lVFX22NIzikDHaep8tNQYX8aLJGG9VF4L9nwKiKAKCuOUHDpUZ4Se+0HgVSvFpE/HgwGawEU6rJsCzDxlt83X/mjK7pLA/7MM2F57tq2zW7esvmCU0877RrPjLmBC2smfd6rHn6ZGxFXnfPhvI34aIAC0dKATE1LRJpVjwlGzjXVkhdhBQQDjtukWeuDnjEYegC4sKqq38osjcmItV3AZY1LJo5NC5in2/LctW2b+dJNN0895znP+WsQTYUyhQ9twJpBJpGQU8MoeGqrFH73qEgYYtxMoQUC5SwzLVAdt7rB5mxGGYnWjLEpvKhTASnJ+FMHDhx4d4v/5EBq8xuzgIsbF7097RbI3HHb7f13vuunP1GUvbPn5gah0hxdlFoTRjbEO46Myy2R1OA5qh3USDAs2dmvc0KkFijNZ8ymeqT7DcGYZLZAmqE0ZEIjgeO068MHUv3fZ2dnL56HUI8Dkmn9nOazRuZptD7mizfeWL72Da//hampqbfNDYc6ACGOWQnI4WzeYGMSfKOEARxTtIe6PQERhVsi1JRF0BFMkZwTiAyM9ioJAFuYYLkMYKwNU0A4dsLKau/9dcPhcK2Cpcj+NWOsEuYh350/f9os0K23fNmefPIpP7p27dpfr5yHq2Ivl4au4mtek42LSxPEUgTyzOd7Dj4TLYnvtD/TBFKgZIlf/aAYSyDSbJEhGKLg4hmwxoaHEsAQYCiAq6oYIthcVdVHW9wnB4zt4EjtLDbmi9DM0/DZo7u2bbM6AOGjAKYGgyottw2qQlLBHjUyr5LNWo7DwcP+9qPVZdGSLFIk0RTfOtVWKS22U6AYMgCZAB51ZbHyYYj0SoYfxsfTTYyvn5mZ+SkAvcwKUQs4uUcqWhyo7coaGe2nwwKZO796x+S55533oaIsz54dVGGYgATFHSCNMFUkdCZw4j756iVOAvmjDTht8BB1uKzGGmjUCFDy3HwcAkx0cQBZglGAGRBMvK4EkDUgMiCyKRoUvbxq1X9jbm7uBZmVKVrAKFrWZ1zo37ZIRzSRSNAK++Wv2vrOqZVTb5mdG8JVLg1+YtS1rTAeVxLX8Vm4HtpyOCXnjjoPtVAE1rZM0dKgdl2UbFHCTvgy0weaCCgTSHXiTyKwltJcALI2WKk4KQ1Y5b3/MIAyA08XkGyLUNsxVkiOtAVKawZO27TpgpNOPvlDg2GVGgFjxBX17vniEp8tPamr0TiqE4Zd1odoTBxMeTWM2kYIhkhdkoGNYFHLJBT5j6mfw9Qkuyhs+LlKZ+MzqXrz3JmZmQ9mwClaLqtNqHM313Zn9ohnou/ato2+/rWvTZ19ztl/ySJTw2FVuybdr4VsnVI705zPXT4arc441zU295aH9BFEeSmjfYuPb4z2+SsHT9Yr/p5JOTOKgDTBggkCN6rzZrh6bm7uFZklalujcZZorPTVHCnr861td0288c1v+o2iLM+eG8QKu3KYOABBbT1n85slK1vUFfajz/rMT5jrmlc749yQtWYWKQePMQbGmhRxGardl1DIB+XRGBHBUkhGGhMYkiSKZZQjUSxA/5H3fl0LOEXGhSImiuzV2hb3MUcKQLHOVZx3/nmvWLN27f8yN6hCslBnBLJI+rTEeTmcJQsjaY6DEo418BB1RO8L/B5RFlVFECmQKLmsrBCrrg7RpekmaaPnlIxJfw8RGKI4awtEtGowGPw/aoVsB7G2Y0DUhRVjjoDrst/77ndXnfnc5/5+VTlUMd/jw9T2JIxCTAzWFXbJ1i4l0nwMpXvakVczSdhRC0hWp/11sDiGTO0mCbAZcabEh4I1InVXEVyUk6vEhkysr10xNzf3OjQLrrkby7mP7SDVhz2RmB70C9ff0P/p97znA0VZPm9Oe7mS9ALc2nSc1bmi24orJNOOWzmGwNNhpagZeYGa0Va8yInTUG11gACa9LfZk0WXhtwF6n/BwofHiaAzhdU6IkBkwMy/6b1fq5aozMCUf52T5q7qxSFboIZXv+6aa4utV7zq5WvXrf3FublBmLjFHo45CMa1fSVWlXPXVXeaZmKqo5Q4ywJV0katVIBWkF4T5zyET9loBA4UE4ag+vuMtEfla3JlyHJJWXQn0VqBUFgLMibWEKeGw+GvdJQ4bCsqQ6s2JjmQzEGCZiTMuGvbNvvNr39j6qyzz/6DYVVhWPnAfVzcSxomZSRBmHDDbdXJQhkzvvvo4T7dScPspGSheu1KcuLcIbrpiMAMmdo9AbV1Sr9vahAZ6nSPxkS2WUd7xhpI+CC8aTAYvKxlfWxH7QyZ+2rUzcxhAI8BYL5w/Q39X/rff/nXbVGcPTdXJamlk2CFahF8tzwjFg8Pdfj3050wHBu2j0kgtuoYLWWi8pdIno3mhUyTHzW/NsnCUMaJkCcpjQIxk4RAvYD3/jcUJCVGdUMmi866orGDzgM16iKf+dSni0tf+MLzT1xz4vvm5oYhYVjphkDv6tYUrpWEqZvCSzYAIZ7zo5M9L5TzGbE+jawzdXw/GsKPWKA8vM/JcbJKuSgtq9lSdotuzFpYY1RLFCsBcvLs7OwvtMCTqxWLjiRicmnmIK1Puj24/UG7/Qc/WHXRJRf/EbOsHFYOlU7GCFv6AB9H+2eC+FAsDUDhtP1Yjjl5Ko1U1TFqYdB0YTWhbhmkPKqKVkatkbGmCSRDDaKeCHXMF6HeHESUF2yDZbOmQGFttKzvdM5t7gCQHZOdXnIicZwE0n7zG9+YeM2Vr/3JicnJS+cGw7TczYkO200lCUkdFIk0N8AzavGPJRfWoM9UE+eWdr4O7RHyNknG0Y6mDKV8TiNkB42gtpEKQNPq5CYp3idSv2YWgMisrKrq5xEq9rnlKVrexrSz02aJlqfRvPbg9gfLxx59dM1pmzb96txgqHNsfBrqRMIpDR9q6dlAgQw88eIczdZnfNlizM9oNOIaTXqgKeHILUpWSCUatWo0UnNrVfOpTc5zEq5wNwZFUcT65FVVVT2/RZypw/o0AGWWYHnQSiiZ+++7b8Xr3vD6XzXGnlQ5r73pUQhPEDIZSRSVYcpI1VpUA32sWR+ijm9abmyE+zQq701g5Rc8l7rm4MjLFzkPyqPWCJhaPSKZFQju0FqTdNakakfn3C9nAGqT6jYXWnIUlhfazA8eeKBfDYdnrF237p1zWij1wsgixuzNZj4/roFUMFHWC350cx1aXN6nUenq/g7NJHErNI8VeZPC7hGtUCtrnXRBDUuXHrxp3XIOYkxKWGoJ6eLhcPgSLDxGL92KhT546O4NKu67976V555/3v/MLFOsi9NIEWIMpYKpIPIdrskzC5wKygRc70VJT6YdCsoBYjJOopicWo1681bFj3ThtMNUU2aJWjWuZtREHbmldikEqd6VF1+7IVubP0p9902ApW8lFLVJGFRYMEtYveD9zwL4ml77OGjJoNkuzfHJi0Wel0ZryA8feqhcuWrlBes3bHzvgZnZ0GIbZ/mJB2VjbGOZwvsQlQlqxaEIh1foOKUPYwRBlCfcRk+ZROOZSgGiOROrJ7LuwjWHueRHoyKfrPo9j+Vpgb4VoDXA1MZTiqByaxQjuxysyCx9/nstPiVpYmP9PNZYMPPFw+HwRb1e76vqbZz+Kxl44r+2WCL/wfS+afvdb39n5UWXXPz+yjk4XZjG3kPEg1hS/Jj2U3gPcLA2TguroVyh0lZoC0v6dIQ3bfRfiXVmExR24ZX5hl8nENgQyPvMVZr4v9DRYE0C5GJBtZD1mXf4YMME5ZFYi5jnRVeK17pZ3mg8R4M4twhl/pzZVW86lNr1GRh4OP3bwIcyK+TVyFTt6Eu/9sUS3BcBMA888O+9FStWnL9q9QlX7j8wC+c8XMXw8IgSQwYACZlPH6f7cKjGh0FQoZGw1v6EOnGcyhXVmNxS4hKHBSrUiG7CSxMKf2ziHxgCwYOYAgDJg5mCijfL4lprslCYxpLnpbjImiI3yxY18aWmPAPNZGPsrGjUv3IX2JXyaIdl+XOPqAKiCxW10MHAOOdC7xlwsXPu1KIoHsysEHW4MFqSBdq7dy/dc/f3VvzoZa98f+UqOO/gnAsZZ+0ojS88huqU1my7Rk87i66lVC9bNZaUoGVtTMOfhwIip/Ff0X0YMfBQjAhAYkFGIPAwMCBPEOM1/2JAxoPZhNq1fiJtUTSjoQUIdGf4Po+gfkTuOvqD9GUY2ho+WIYaZf2RTEH+uc9jvGgKhCRZ9oYbS42LAltY9QSMqqp+riiK/5qBxahFamgri0V9oPSPvvfd75YictrKVatfMTM3h6pyuq4xiN5z6SVDh0OKb0wSi33cYYJ83b4sqVdHXx9nY7wULLEx08OEn0GRovd54ZCZYFIKVAFs9J1z+HWvhUTjYbwBrChDNAFsFSdAEVlYE0oANZgW4+g76l5t15M9GLW5Toq02gnBLrx2vCC1YBBRTilaK1vA3yCI9b0TEOEyZj7RGLOnVZ33GSdyiwGQ1BX3u/qvfd2VP+eZVwyrsPfcV4E4CwRGwgsQiBJln+208Gn+sYirNyi75jqkximhtA0AgEmRGsirMsSrEk/gSet83gfrYwFhAwMHH4UHTDDiA5AcwRsGfGgNhmFYNhDjYywJMgxhC/Ee1phQR7J16NuiFfOPh29bDOqSvaJRD+t8UBoFJ7UTa10kPVrqkddEYHVKxhDYCyjww6nhcPjmiYmJa9Hd4oPFRGHp+OKNN5ofPPDAyvUbNv7HAzNzqIYVhpWDd8PswsatAlKvLvJha05YrhY28okI2Gk7s3bEB420RgappSUkJNUkgYiDZUpvx4R2aAUVJQ5FQCTqFFwZwCAj8CCQo2Bt2MKIhzeA8QRHHhATyLtlkCOwYRgyQZLrAeIChkiLkqaWUbStS85LsnPfCLUbWeo88yf6uDQa+qX82WIHaSSHONaaERGsDaG8MQxXhV49FlwF4C9a2eg8KqfFkGgBQF/5169M/NS73/UuFlkxdA5DV6GqKjgdLxIVcDHrLAoe1qmicTOxRFmHDs0Ur1t2pAZOnvM2ES2pWS7NvQNFl0wCEpNG57IIyAgAq6smfWhe9OGjZgwhfOx8wKMjiAGEDCwCoMhrJOgM2DKIgyTCioMYAnsDUxAMG1hjQ2/6EqqK1D7N1MRIPB8UqaCCCg1r0h4qjxbDbj5LnuTtvNzKt6yhmOg9q6qq88qy/HYrkVwthQPhumuupYce3D518smnvH12LlgfN3SovIP3TqdIZFO1EDboQBv92YedXd6Hn4VlKXU/mCGAqZmJNprGEvhgaShTecT53alEEjhRyDGGhKN4AMYH4mhiO7QHkYH3oU4HEwRZTAiP4R2cJRgX9cUGAg9yFrAO1ls4E8BkjIc4C5iQRDXsUZQFjJiGC6Ix2SC0w/cxVmPBGk8ea4x89KVOC0j94e56QjIGJg5lMgbQIMg598ayLL/TXcVbJIBu+Pz15Wte99pz+5MTL3jyqf2oXIWBH4YdV04TglkBMBDouCc0bNZxSrRZNwwSs0ZuFDYOdsQS9Rnibu4QyyLwdfiuxJspZFmFTbqITAwSgUlE3UPIaGYsfG0cg41BwK0HYGDIBa4EB8MWsB7iSZsjQwMgxKPSQQgWBay6hUXljKTdpTEGeILuKdAttpo+WLTwMh7KyvPN+fppJvdWAL817pkXLGVcd821ZmbmwORll1/+c9VQQ/cq5H7CnnYHo+IkZIvdoGuYwvAEhuhQSBGEddfCAJm4F7fluagDMNTIzTQmYWdJs5CUDBubJYb/Un/yKDx9KiNLLPIaAOzAZADm0ArDBCsMbwL5ZmMA40DOgK2BcQhE3FRgMSggYFiQVBBjwQIU1owASbpKH514kMxytP9Y+WFjXmd8j/UzpMqPqcuq1GUNVU8Ta3FMBO8FhnDScDg8p9frfbuLTC9ogW695cuFq9yqE9esvXxmMEDlHCpfgV0VyLFaEtGmQaTtyFrGiIOgPGtOQ8K/kXS3rI/p6IGhjrk6ndWgLAKRRDZDFpsZMCaeQM40MQQG1Ql64lQngjHwEsx/jF29JxjjQY4BHa3CYkGG4QQwFhAxsAygYDgUEGEURRFCwwUIZ+P7LH8jVAcZUDdtWr2KjXpazneo6epkwYgxkO2iKJTL+q0AvpsnEBddjX9y797+f/6//s+3G2NOqiqPqqpQZapD4SCer3ywRt57OHZwlYNjB660jEG54lA6pUiLAc9INLtQ8kpbiYjqfJOYeE+8UJw6QUh/GDCvKiaNHCsXyjE+TYh1OiHfpQy75zj3KAyRiIXmsBO+CqP8FpSONGUvcdBU/WGTOtGYEeTOIQ8d6xPHpbJMLgPJJCLM/KpWSocWVUy9cusVBsDkpk2brhxUFZyr0ihe531YiKYuCl5VtlJPWYUE+WS9oTi+STNifZYKnkM6mBGZkAjDGKPgEcCYlNQM92sijoNJCOScwRIsVwGGJ4IBw3qCwIbyDQEFCAIXclRCoIJCUOAEKApYa2sXQ6MgyrPHjUJzw4rEeEwtVYNUxb+XBpHO1Z8i0mgVanABTjz8ed771dbaJ9oZ6YUsUAlg9dq1a185jC3KzsP7KhPFc+A0qUQRpKyipCgJ6pP1eSbB02530gQlo+Zr3rXmPWcbn1lSdBm7H50P/W4sHg6hQBwtlpfQE8fOB4ukqxvC84RzGffYo2NsX35BY64s/V7WhFnvp89DVBnd0dGaO92pMsgr/qYGbVVVL0Jz2PiiJtX33/O+q18sgqnKM5yrgotyeSjOIUmoJ1jUZIewOgdObVLHisdo6fLIpQFncb+XAMW+/nSiXkHA+r6S6kDq2Ube+ZoTxn44sCYiObg9jvf5efab1a1OkiVy6mV1mLdxRTrc2AhA5zvHmQ47BBT8ko6TKMU87osATFx40QuuDHINB+fi0Cev/Vteh1+H0oKkaExGRlfl1mcs71lQRXMwwFmCzsdq12lGEVNcID6oBGN2nHTTIKvr1uw325AegFgY/Zo0AiZ4JdIhSgxJPwQ5BSysJjPzQCC8HNafU2PgVJ64rkVktQuTduVzTOlFRgi05PlabTPn52cn1S8mCisArDjp5FMuH1ZVKpqG/RThzCWJRjSpLBB9ASILm5DFui46EsAxHeCVOG63VYE3AGBTF4MxUfOdv2/Ampj/shAbSh+wqvpjAsfiL1Sz5EnXrDBiHdpCq+JCqUdOWq+0xlA+xTVGZ1k9UYe2x455aFt2HaW2lYsd1inNJaJLUGMqUcT5znTvoksuObU/0T8zRBBOk4JqeeLHj+pNOkzQYeFLvKhPF3iMTr0w1Gn5FhKRSdQqtSeqEnSedRxHo922HIqDcSFwXConORdinxbrsmelBM31VfkqzPz7tMIncqF8r4jkezrae6Ql40NdniJTOZo6FzccDp/frgfMB6D+j7z8Ry7xzqsQrB7HwpEgZ206cSRLN6tanOs6tGMenhOBs8jnXIrAnyhY4RjeRLceZztGGUsc1xd5kVdFZgRTVC3EBSrMnFqk4oVuz0qSVtgvjTapel0UpFkLa87Zlnk/spQ9tvd+cythPZZEGwD95zz3uS9xzGHFologrxwhLNSRzNTmoqeFLvXhdl2HBzjR+oTp77IgOQ1bo5GilTBBPwdS/eEK65p82gcmPgQfMQ2S9r36bFpbLP0kkp3vz6hTI6mdp+GK0VlIlWys4DgWnrYFtZSQ3vtz26ehmIf/TK7bsP7SqqrgxYWkmtdQllVa4QPfYY7uawwkF4yuDj94jFlMJwV1FychCUSj7kxG1H91SSXMJGDmUJ2X2E5pgzQFCMtRlBBDa4Ih5VJHeyCrVIA08hN4F6bRG1MnzUeFZKl03+R0lJc5kAT3XVnw+J5ZpKmCCN+ei2a3xlgXVgKYmpqaeo53oZsiliUEXnNx+oa1Ei+Yx30tYH0OzW0tHTwd03pG6syiU+FHU96jI3nRYBhBkJWWxmltjpk1MZfNQMqHa6HuVBH2yRLVVsirVZLGNnFJKR9p7Cir99fXfEnyDUBtviR1e7nkK8kRe3oEzHwCmh06Y8P48rWvf91zQbQibA729WgWn5Hn7IkDeuRptj5LAw8tAbxEtOCLIlCqU7V7+0mtimEBG4ElmxoINDyDkIdhG/5exWwcIyYb3CBEQGLV6qtcVdltaiyJ68Lz4il1RVvRwpE2xUseoyV5cFtRUs9Fp+ep9Ym3ThdGAHpbtmw5I23H026KuPBMOAiOJHstptOfLhx5HU7XNQ48tESrF0NgjI3GsosTd311LDc2qSfLpK2KlmzYkSocAEMSSis6JMqIFnMZsDCJV4VOVc6YbdDtNjr+iPIqLPKUFutrJqkL2XV1NXYIdxSpU6s6QKCpVi6oe/ImgN7m07ecE4uGcRFK8IvaNMi1ULKWsi6BPM9Trng6wdPVv5vXEsbep0Y35WJirby1NJ6EIKbWe7PUqx2Qre0MXVHZLjQtxKY1l1wXZkN051WoJ63lvFLTbRkXBEhb/DP6EamzmA1l7nA43JTng7oAZAH0+v3+KuccnOOUdUbKTmZ5BZHxH2w6EtbnIMDTuvq0mGr+mD4xahBO9R5ZRjg+Zx3taINkBJdA9eHNNeWi4u44fMvrz11c8Rnrbex1mn/UnPssLpfUaxelvXkpKec6kQ/FQe75jKbkwnMtlsqOnXOn5tArxgFo40knXaR7p1JtCOJVEaJzntVchvwPLZ48H+70z0LgOUh+lVuTETBlGd3U1hX9SRIza0U9+/usN7TeNBjLP8SwTKqmDDTBsIk9vmAYGGGN2ETDbYIDh/ajbKq9kKSifFLQ5EVVCrmYMIBcfy9rd24kMDMzxTF6mkfOYQH0hdkykU6Y96qP0adnAmmxNADKYKkj6Q7OfZkF3eI48NDCL2iE5zQGEkg3yaZWroWoBlfyFilPhrRgN3SbRMsR+9u0sUAHU4SITtdhecAKIMaAEWptMAJPHpbqqDi2bMdhFJLpo+sSSLjDmPw9SPa7yKQ3zRjTO9/YHT/WhU2tXHmGRNeFUM8xJKnJL0kLzBJL54dMnud3XUsCz2J8WZfvalunVomg7s2nhvogGKemOCxaoSgZ4faeNE0uCiTJg1OvXZSFKF+K9UrW3BJaIXq9BXG0PDIu+Z6nAYKVpUY5Y5wFKsmYyWhwg/+lRAopdjnEhWeN8cFLr4IfrgLpksFzMEdHCbt2Y7VLkwawkNxNQxSWMvmSqvyx6BkaDkKXrMR+OEL4EAPgtGvNAOR1VnTd2i0AbIrzRTtMUuddQzmd/xt3taZOYclzSgABq7MwvhNABkAZZZ3CukVZ67qJ3ctSLv3hir6Wlmk+rMDpeJx2ppokcIs80UuSg1pSZ0Uz+2s0olbYxa4VIhCs/llQUbIPrUliwu9ZC3gIyIbfI86z5DqkEyHXYiijaFBnYmrJhjFoFWU7Pi/S6N7jcQCyNRuXNAAqrZjWbDQBQXR+6NfiMFzPRVgfWqq143mnc5ChMXrjzt6H9Ak3eSZZOAAiihy1Ty4GKV4YFtq9YjiVLIhDbyQxg8ToGokAAlJOFFMLVn/IMSznKPuQ8Hu6lyOS6VzLIa14nxN5m6cW9rZ3/PhZDdxRPr+5kfw8LPxnqe5rcXWupTy3mffnATzcXXSM/iprmcndRBqAkAvA2t5QoBoqqjPGKurKByVwnNLBDCYDEsAzh/oYEwwxmMMH3JJpTjUTaWSj6yhaI0AjI+epLnuMfA5kXCaaAJgTTjxxVU38VCCG+s1RQ5T2zM82pMVMNzgEbtW2Sov9YHSeegWUoegqogDP1HUoomyKn9RWSkN9aCcesQldvWBUIigQVJDkCbAEeJ+snUmrw2v5R15Yldg6LRFTmfRYpKsXqDMPpPxHWsMhjvIRqgdtfRYHnibXMQlE1C5+pWRcJMM12TENSp33OuYgqtMAsdwQrVcsn4QBCDEqCjkh4uCCKjiUKENWxXuIIVh9fuc8bJwsQnUOiVjTC0YtURbSx2KqoNM4YRyACmY2dXgqIJmfIMsSEogjTYKHy2DQ4bM8pu4oG8N/TLcl6mQ9WcsMZXW21ouObqwxhiWG+3lDoKhcxNSaJVIBG8HAk9dBE7rZ2bBWrQIIrcknu6q2SwQmTjBJV11Sa1G4P3VoSP7mi7HZjnw6l6n73skC4jBfIeWIhu9Ljujo4BOSCUiduiBTD9VqW6HWhLI8KpPsdQu1a7amtkqtd5a6k+PjsKR0QbrsHBSNtijiNh5QGZfu1hUPa7N3ywBMKNqaWJpN1z4sQaYEZMJgbvBVfSlu7MfwLz5xzbcoG2QvYlLb8NHu0Q4uv00L3r/Q74walZblliyk1x+YRlIySzZmup4R8WBeb8sKn7G+xXG9RNjEg1DPjBsEOJvRlK0TbWiMNIHpA3jaZoKIUg6oK4xnZcdSf0qoLhgaArmWbIQEo4N9jubDHObHksU4sGYIli/PkBbXQiS1SNuYGyBVFhxTCFJXcdNDe+9DriDM/dMBFiH5S5ZgjYUYQWFDnkiYYSmkAlI8mQQDAVDxA1QURd7ENqIh9ACG0L4T0koyqcquMR3VLNGB0dFpjsbV0mgelzau4NoVG6bs7khnBOZpp5GR+6mr5kKtTouk3VEFow969tD9IXX3sNfxzLqKK/G9LHmYBIRO8mwOvHc/nK8WJtECifBs4j9Gtc+gunCajZo7thY0LTIlsMiM+cjwzfbeipy3oF51Lo1QXxZEflsIXxPoWhGZpKt6P6uawrkwB9oxwzuv8w2cfu3S7zHylevcFX3hwIEDD+cprHH2XKb3TT+U9k+lwbj1VAhj8rT58X+M7dIQGWdMOj9YMuLiqBmpdf2lLAz0hoXjIPBjnRziXZiq4nyVuFCYcaCdNt7XNTB9T86r1igFAQQAByZXrHA5I+vKRDMATwQJMyQNDExavehcyAQ7T6iLK4Jn6zFigbpyh9m4+FTElHqqRiwxZbXPbDQdGpaeMjdHrb0aLNqSLDxCtD2zlj8ElkNYzTpYM0R0BGuLENMRhZ+BIDbkJIkAV7l7TzjhBM7fqRkDoGrXzke+bXVFItmgQwEI1qRKoprjkJdeMC0ix68VGrVAHSpNabmxsY8hTUfWSvZLy4QlwZfEnJxChvIeMqRmRed0GTJziNB8mHXpvAvjmrWLNvBegZFaeA/IQxMTEz6PDbsA5AFUe/fufbSwYdC2NQaWjPIfql0YzNGdqZaD+ZPmf0v/644ojBbz0mQErAJZxDix0WePEVdssa7beAK3cXFmt/dwVdhrWw0rVINh6oRVFWsaxhWaSeXh7MWOtUAewODRXbt2WWtBJuwat0qkkaZYmSTXBMlhWEH/dB3c+k4W7aoWla1oBVDz15tlUTypyZ8lC7pqaY0g52Ja/E2Z5CgCzNePclpB6pykbUvOVVqPM0H7lWUc5uZmb2vDueuqOwCDv77uL7cZQyii9YEO19ZNN5H8yVEWiclBQWrhv/KdbSe8+BeV3WSeeEtGZjl3WcQmiEQ6NFpRg51G9uWNhJxE+aw9+nFW0dB5sPN1OiPLlM8cmPkOWqWMsRYIgJ+dmfmhsQamsCiMCa27mWDKNLebLeoTLiPfH5rFkIOEzFJAxJDxEzvm40WtqU6NpGD73/ZcRFlkbCJNmKXvJI6/UDEap7G9ccR7skosAvYxW+0w1PwQZ4tbhflRWxRPoNVZPc4CzQEY7n1i7w8Ka8J6aHVlYWU0pRG9RrszTZx0+vR6oIWRKEuzRF23+V5IA1gyhqA02rAkm28taVRdAA2PoifP72QTOubjaDkYKZYs4totCfJY4Wx6iHgtXWjikRneVzWBJoC9v2fd+nW5hmcsBxLNRg8e3L79O9YWsMagKC2sNSrmClGYVV5wtPEgWRSI+LCgeP5RMNLCkdQ5G8lGgLW3VzcsSV7RzxOJozmoWsCfDUZI6QWqR73EbZGSViuFCIy9Cvc9nGc4dmnE3WA4vO2EE07w7TM67oo7ALO3/dtX7ioKi8JaFGRhbdj4a3T7n6i4TEzLRMuRNkJj3JgcDBAWB6QaKDwWK62m1A4mnEdKuSVB56CnusYpdVt5BqS8MbA2WtksoQgoJcup8JoBNMxwDFPnmIGkX05MRyL/uQ0jZd2wcaTrGAI4cMftt+/w1XB3UVjYwurKIwujG2rCtpq44Mws7MbkMPktPlxWaClA6v4dIpqnPTif5dwEOWN0UGZuUVKRNK+2szQ6Shu/32rPyYm1UN7OGOWsEjpttCwV19944bTHJC5fYebH9uzZ/S3UVfixxdR4VABmAAwffvjhO4vCoiwsjO2BELhQbOy3MGli+jg3duhEegkZGDkUAPPY21gSzdIJnM7QSsZ8CCT236ExjL0BinxeD7dbmbmV66m3BTQ4l5YqOK5JgK7e0pGFkvbI19V4MoThcHDnunXrqtarl/lqYQxgFsDsl266+UtlWaAoggsrSgNjdeSkNepjNZynmAk98myaWZZuhQ63e5VRHiQjwk8ZGXRQa3Ck5cZaUVhmXbjdINjqcRe0GwWbQEK23JjiM3Ls0qlLUkGzpHvQNIUzOzP7hVNOPbXCaLJgfDFVI7HpL1x/w32+qvaURYFeUaCwFpYsTKFuDBYwBEsGFuEJQwKquaJ6XIvwoYdf81shmS8vc5gTTjJKeVopIP2PWzZYuMmLxgzVTFseuZ5XGbPNLPlgBW0M7CiB5CKyUGbLLFdsFDWs1QcCIDPfv/++GyYnJ7mVA1pwyOYAwFMA5nbs2HFHUVgURYHCljC20OJqAdJ948aYMNLWEKA7RhurG1sh7+FwY11WaNEgOlggyQLgEZkvpxwudF7HkqZVGgEPRluQpSG7iKULblqh/D+RZk4qe+w4LywNE7ahmTGUPg3m5mZvOeXU02bHvPN5x/w6AAcAHLj5X276Uq8sURRFINPWwBZlAJEtdDmbWiYyKA3BUiDZRneNig4qiBMklrJGe6kJwCWBaKRU0H2fsIx9EBkTkUlXaMbtqMy38jzNcSwhSmpali4rFd2TjJBqaUxsFYQ29aQnknowlsDAxmjbGJSFxezMzBdOPuXkYcvyyIIA+uItN4vyoOkvXH/DfbOzsw/1igLBlZWw1qAoDQoDFMbCFgRrgcIYkCWQWilSwMQdo2lzKI3uapeDAREvzZ3JYi1Mxy+LyCLBM8p70BgAlcnIGlym/nluXTkNokpRUQMYnrk1b4g7LVmsidWyw7iIJQy9sjZIdQKIDLz3j91/732fX7t2LXd46QVdWO7GZr/59a9d3ytLlEWJsizQswWssbC2hLUlCkOwpoApLAxZGFJZrgmb+4wmIcOk0XqZR3RtB2eR5ifU4yKzQ6FAjUkb7WhMWs9LtRXyeeY4JfR8swzRItaJ60jbAmU1rbYVyvJCeVaa07+1RYt6dlKtl6Gw+9UUFtYUOLB/+rOnbmq4r5HTthCAHIBpANOf/uSnbjMGs/1SyXSvRFGWwQpZAtkebBHcVWEtyrIAlUXTZcUXapQjaWE2zbQhOjgrtFgQyeI911hX1fUaR2Ywd0Tv3KycN6rn+RTVBhfS6a45iU6TW5ukOU8BcIs7JYlGnA3ForrnXJBmQyBkDEprYK3Brkd2/V0r+hq5zQsgdWMzAPb+8KGH9tx7zz3Xl/0SRVGitGUAkilQmhJlYVGWel9ZKhcysEKBMylQDBnE+pqxRvXWVLu3RVujgwDRAiR4odv8hFo6SXM+S6mRidaRgYKm8Gt0iHidNEwbr7OvfSyQcnOcb/o9tT7Eyeyp5dfGCFKeakO5qizDis4D+6e/ODs7e+/atWt99xtbnAuLWeknAez/s4/9yecLQ7O9fomyV6AsgyUqyxL9XonCluj1i1AzsxbWWhRlgcIWIYIrLExhwoZgClltiuQ640uyaCAtDUSyZELUnThsE+qusma0Pp6zCfNJv8MdLnbc7Ob65hOQmq4ttzgsvrmQ2Cv/IdQrSIVSe1BBhKKw6JXqUfQ67dix8xNbTt8yyKi/75BcyIIA+uItN3sA+wE88fAPf7j73nvuub7XC4DpFX2URYGyV8DYAmWvpxaoh15ZoleWAUQgkCI9rhKorZENqwJM7c5y8BwMN5ovyTgWSLJ4M0RE41WLihxG2JHRvksyKUUj5BY05m5zy/3Urg3pZ4EUSzMlILnF0twO15M+6tqutmppeaosg0cprUVVVd/atWvXHRs2btQWr5E4EotyYdkxC2APgOlP/OmfX18Ymi3LEmVp0e/3AqkuS/SKwH36vRJlr9QqfgEqLAq1NNba5tYcE0ymIRXuqzvLOgEWABGPBRFjYSAtRU+02L9hljEvi5Fv1ukCkbQtEbIEorquRp2tQZq5I1YKIGJ97hQBIwQ9tjAoihKFsVptKLBzx44/OuOM02enpqbyjw53efRFAUit0L6iLJ7YteuRPfffd98X+r0SvV4PPVuEf8sCZdFDr+jBWIvSloFo6wsrihL9Xi9U9q2F0eSjUeJmCrU+JoAoDkWKyciDAVEYmytLAsZ8/zUr5aOP6+OG6lYyMXzrm1odyZflNkP/RmTF0p3TqcuxjVpZrov2jQBCEyhaQCVr0CstCluG4KewKKxBVQ2/u/0H22967nPPGnS4LG6f9KUIeGatsXsMmem/vu6vbhDvniiKAmWvRCi2KpqtSV9bW8AWhYb+JSwFOUih99cuK0pE1I1lYX+ccr04EM1jjfjIakzGWZ1oGaRTzyyt/vZ20lDq1VGclSiijENy8VibqJtciqTmIhBn1U3Ai4T6pimC4tQW2PbNb35g06ZNB1ZMrfBjrI4siQPlVmhiYmKfLYrdux7ZuXvbN7d9ZnKih7JXwNoCxoTkE9kgwO+VBYrCoNcrw4vTUkhpArmOBLvU5GQwn2qdiBKoItHGojkRz3uRF3JtSzl8rEvxqFQVmX6oKfySxoKUfHkcS03Q832z0tqc45mbavuWoEx0h21sAmU9b0YQZh1olrm0obZZFoFIP7Fn92d2P777m+c8/5yZeQJRORgOBAA448wzZycmJvYQ6Mnrrrn2S/v3T38/voiiDGusLQUkE5kQ1tsCZb+H0gYA9Xp9lAomo2Ay0QJFUhdBFAm1sUsk1gvoe/jgwcQxwcfSmrYxUvVCl3JRxnRWpN50dJUgoivLsshRBYFWxZ8VJKi3PqWh87FFqzCwJiSEy14PZa8EEWZv/7ev/I8zzzxj39TKlT57A9JyZUvnQPH47Y98yE1NTT1VlOVjIrL/7//6b//cGjMoCovJXi9YEk0eWr0FblRiYmICvbKHojCBvGnuQahe2EYgTQGET0QTRKZRoD3YXNG8YFrELX/IcVwoVehkPs0yWpaoa2Ul19IPIHNxtcWhdqMGUarES6MpUEV/msi1ykujJXpw+/aPiMj2886/YNiyOjxfdXjJIubTzzh9tiyKx5yrHr9r27YH77n77s/1eyVAoqFgCAetJguLskCvH8DV6wWS3e+VyXwWtkBR6qehKIIFUzJdFLaO1jIQYckgOrL6JBFpCdDy9E4TAM2/iRX6PEfUzhll7qlj9103mSbtvMj6Eo1OY7UWPVui1yvQ06rC3Nzsd75w/Y3XvuDii2ZWrV7VZXnGAmnJAPrVD37Ab9i4cR973jkcDvde8+cfv3F6377tvVIjrKLQJGJwaUZLG71eiV7PouwVCqqQQ+qVmnhUnXUY5kA6y6+WioTkI6XMNZacJ+IjBCaut+8soZaG3PrkFXSgZUGQVIR12SGW2nJXSFkphVONy4aeZ70OATBlL3iFfjj3s//fl2/9lfMvvGDvBRdeWI3jOhiz3+eg2ihecPFFw4nJiSeqqtr55JNPPvGP//DJ60R4mKIDiIbm2k9mAiCsLRDyRyHB2CtDrsiQKuAo/p5J+msy1MhY13U1HEIBlg8BUKN/O39vGEbcWbP42SrQCreKtvUYl8YHpjFziLIhU5JCdoHuIVOpTakRctkrQv6u18N3v/Od39y5Y8ddl77w0rnM8vAYAPFhAdC7r34vP7Lzkf3DweDR2ZmZx+647fb7/vXWW/+ysDYT2weVYgKEpZT7sTZwI1sUKMueCtU0SitC6cOkzDRpL5pNHbERaHVfIx2yFVn8bWHLMpZYi4yJ1JolkfZohnrYZyrx17kkHbTIKosnqcf5Gthw/o1FrzQoypC76/d66Jcl9u7ZfdMXb7jxk+edf96+U087zXVkmhnzd9zJoTRy8dzc3FPMvPPJvXt3XXfNtV+67557Ptfvl6kFGlpth+iMIU0QWmM0H2RRlMESlUXQDwmNnkBS1xXmW5nUn084tJLHkeFCC0iNRDp1RKyWJ9axsnau7L3FOc5NyyNR08NxS2EYwGkMQl6uNChsmSoE/V4Pw+Hgwc9/9nO//ryzz9794pe+tJrH6sxbTz5oAGmlfjgcDh93zu146smn9nzkdz70yb1PPPHtfq8Hq7LWuLsTcRcEAcaEfE9pQ/4n5CIiqQ7JxmC1bLI8ySLFwquWPGKMKkcRiMYJz7rcGaRdGqGR/RS11a2TkqKDD9K+VqaG5ARkQCZY+V5Roj8Rgpd+2YMxNHP9Zz/3y97777/s5T8ys2bNGt+yOjwf78FiFImLBBGr3GOXMWbnvqeeeuKPfu8P/mRubnZnv1+iKEzK4cRTYcjWW5YMlAMFnmPLAoUpVY9ia2tFWclDdddWH9e0FI1H2xgiWcgHdOmViIJYsJH7CtufI8UhROAYDeVF96Yi8cdYlyx6Wtzu9TDRL3H7v/3br/77/d//xqUvfOH0884+u0ttOJ9caslyjkXVyZxzO733j9577707P/b7H/0wRAZlWaKgek12rGJr+V0tik1a69IWKHqaYDQZsa4NeLI8+RDwtKkvE6XJMQCcHDyUbRhPQ6hyN62XKz8fQgImLZISQCaUgGAteqVVl9XDZK+HiV4PkxN9fOdb3/6dGz9/w+decPFFey/berkbE6LyYk/hYWlmVxA95Zx7mL3ffe999z7yT5/+zJ+DuSrLoi6UZtOWIofJ3VVMQIYstbYIkagM1mgeSLmUNSrmp0aElvOhZwJIgmZ7ztjfGmk2zKbjU10xV1GRgkoaUZbRbIYxVj+QgLUWfY1wg06rh8l+D/3JCdz7vXv+9Lprrv3ExZdcvPvVr33NcAnuaoxa7vAOTa4APDEYDB7av2/60a/8679++8brb/i0AK60JtWzIsHL5yGHN09apa+1QqTdHgBDqEkuY++ZUE25aaGLeqRBs8iqf2I2qtGJ86Cl400Y3QppKKtJxDqFGF18Q1oMtSiLEr1+H71+DxP9PlYoePY89thNH/voH/7B6Wec/ujr33jVzPoNG1zHy+YxQKLDGsbPQ6oHAPYMBoOH9+zes+P2r3zlzi/eeOMNzDwsC5tOQl4cNVSH5WQIhdUsdlkEkXfMIRGlRVsjORGNVtKkkEVebDkMgOl6jNFuk1GiHM1w2m6YrKdOXVKpqk+TcUl7t+pLZwhBx2wpabL6vUCWJ/t9TE700J/o4/Fdu27+9V/7wP9xyqmnPPKaK6+cPvW009otOgx0Tuebdzn4IZPoMSCaBfDYzIEDD+1+fPeDX7/za1+/4frrr6+qar+1VmwS1Nd8pQEiVSxC6jlEpBPhjdZyRCO7sDbJaN6jnqi/NJHYQYkSxx7t3RmC5rDwxg6vfBZFDNeF1aZEF1W7fKMtx6G0I6n9uFcE7VW/30Ov38fExAQm+n1M9Pt4bNejN//XX/nV/7Ju/bqdb3372/e9+KUvaScL5yPJC71tKo6ARfcADjjndu1+/HHrnPODwWBm9sDME6+76g1vXLlq1frKsZVsoX09uTROAguRlhDBEoFN2CbDhgEXNvh58tAsAQxR0B5n43iE6j2lR+KYL2XQBjBlE7uT60472PJSZ/iYiEjoEJUAlPA7pn5jJigUrJYnil6Jfi8oHSb6PfTKEG199zvf+fhHfvt3/ujENWse3nrFFU+9+KUvcTg8S97kiAHoi7fcLFduvaICsI+Zzb6nnuLZmZmZPbt37961a9fj73zXT7993bp1ZzhGyd6H5lrVqcT0O6gOSb3uDRU4kNd958Q6MKmWNoQd7tSYo9x5MZcAqKXklUafB/Wanhw4kDQ2LlAZThZXspFyYZCc5rdMeDBjdIgOaV2rDM0KZa9Ev9/HRC9mmkt8/Y47f/cPPvK7f7Fq9eodl229fO9b3/42v0BOBwu4K4z64O5B44cDRHzl1iuGAJ504Rh47wff3nbX7HA4nPuxt771quc+76yLDJkegyEuLA8xQvCczy+lumgY1y5wGD0bFgELmOOIFRkd6tS5KW08oBYLGGnPckYNkPzhc65Xk/06TWjJ6NpvgHTOEoRUiRmm4oYgQrXj2nwQBHjB6pRlCNF76sKIaOb6z37uv33y7/7+82vWrnnkVa9+9b53X/1eP48laXOdhSxUY13MEQFQDO2v3HrFAKE5cSgiw/3791f33P09Pzc3V73xTW86cNElF/9Izxb9SsKAx1Du4LhvOLxCE3LyJLpajwkSQaZA0qU0YRGn1EMMaNxnirq/7uJO1DRJnVaMOuOWHDhprFOyNnFfGDTKjO9VuAZelK8UGkgYW6BnLXr9HorCot/ro98vE3mem5158NqPf+LXvnbnnd9Yt27dI2/78bdPX/XmN/EiLc6ChLnrlBwxAGWZar5y6xXTVVU5AENbWPfgD7bL5z73OfPoY49OX/HqV7+61ytWDAdhyBJJ5D1aMIUPJBsGhlh3ohPYhxxRdH1Q10YmjGozyCZhAI2Mdd6e0w6OKNdLoLU7RVp6itGgKv0gfQxEtB6YrTmI/Aa6tNIYGFZ6UxjdAR+4j1HFZpAH99CzJcq+tlWVJfr9kO959JFHvvzHH/3D33n4hw/ft3Llyl2Xbb38wBjw0BJdlrSyJPK0Aajl0mYB7PbOy+zsjH/oB9uFRMzOHTt2v+3tP37F6hNPOJ2qesNDtgMNQwxhOUwjYiEQXLgAPtBObw0MMzzVcnJvDMAuWDVN6sV9EoCuwh75SFGTu7RA0vwRdVbSgwkBLNkw0Z9slvPX+dpx02EclSwAbCw2h7mTxhIsau14r+yh1wtymJ42cvZ6JYho5pZ/uen3Pv6nf/Y5EXl40+ZNu3/q3e+eu2zr5XIIHKcNnLGu7WkBUAaiwWAw2IMBvPfeP/zDH0rlqsHvfuhD97/9He940bnnn3eV6fcmgnIOoKpu4gtz/AiWK8DYwHsozLMxHmCKdTaBNzre1oSlsvETzQjbj01WFTdE0G3sDStFY3YUUJJX1CbJ6IrtsCTO6h8zrCGNtExqKQ7L+mJWnXUqjyQRnbFhOobRnrqyKNDv91EWBr2ip8K8Er2ywL6n9t39W7/53z/wgwceeGBqamrXxOTkE6945SuHGXhoiVGXtGndQsCjPN1+5dYr8gt+RIB05dYrDIA+gNVFWWw44YQTTy2KYv3szIy98KKLNrzr6ve8Z+26dRd5zxgOK1S+QlU5DIYOVTVENQwT1Z1z8DqKVryDl7CZmAB45zTL7VUvg7pLIeZgtN2XpDUIK35NGHMem2dY4h5tqqEAAsQIyJu0454R8lpxH3wIyw0saYcoBfAV1sKWJUprUfa0WbNXW52yKAHCzJdvuvn3//Rjf3yjMeaRXq/32Kmnnbb/o3/yMXeYEuu0WIv1tAOoBaJJa+3KsizXMfM659yqoiwm3vezP/uyV1522buKXrnWOYdh5VBVFQbDCs45DIcVhsMKnuPyNIZw2EITuhc8vI6oZcSlsYAQpxIIEytHoQw0VFurMVntuIedyaRhlGJI97hrYpM0MjRhhZNQJNrB8sSnsnpnnLVEVKAsbHJXhUp+Y+OmtRbbH3jg+j/5w49d8+D27duttbtWrlq55/wLLhj86gc/wIcIGiwFOM8ogDIQWb31AZwAYCOA9QBWPves565573/6mavOPuec1wOYqJzDcOgwrCpUzmFQDeGGFSpdX+RcWKwWVhYxnNceK6q31pC6lrjrlCDaAmN0CzZBKIRBaZmeaVWKMjqZSipS52tiL1ZY7KhJP52EEQKBOMmWUCTZSuzPsqF7t6fdEgqcwlg89dST3/vEn/35R+647fZ7ydCjZdl7fOPGjdN/es3HqyUCYymAOnoBpM+Xe4MCwEoAGxRIJxpjVpy2adOqn/uFn7/qrLPPfj0ZmnTOYTCs4CuHgaswHHhUbhiA5Cu4ysFVXsN5D/b1bAzWWYBEYcwtkWjqIH6fu68x85+TFofqbFVi3rFoDJCYeowKoS7TGLU4tkgNl2UREoBlmpJRpN65p5588nu33HTz3/zdX//N7d77xwA8tm79uqdaVkdaZHecS5Jx0dRBZ+SfSQCNsUoTao3WA1gHYBWAyc1btqz+Tz//c8EiEU2GldY+WKTKoxoOMawqDLyHdw6+cmFHKIdtND5sgg27X6MlEVaSq9XueIY5X+00er7DFsFmdBv5t0m5AAWMhZLjIPIqiiAvtYYUNEWYy2O1S7cMeqgnn3zye7fcdNPf/s1f/tVXi6LYa4x5bDgcPgFgRuUz0qqU0xj+QkcCOEclgLLXUSiQViuIEpA2bd606qff+56tF1544euLsrc+EuqqcnCeMawCPwrcieH8EF4XiMT5OEij4uq9IY0VkbRAEKIBGFEdnodOFIoQqkGjEpV+qa1OpkCvr8MnCp2IURT6t5h99JFH7vzbv/qbv/3qbbc9AGAvwlSUJwAcePfV73Xvvvq9skBeZyFXRIcTREclgLLXYwFMZkBaq0CaAFD8xDt/8vyXvfxHLj9t0+ZXetbNM94pL3Kohh5DV8FXHpUPS2Ydh0W0aVATNzfEpUEWsWSVfdCFJNZSgIzXkCBYGm0mINVyxwn/pXbnFkUAVByjUqjO+8m9e+/53t13f+mfPvXprzz04EOPee+fVODsRZiUO1Slw0IXn/A0a+iOagB1AGkVgDV6W6U/623avGnl297xjhef/fxzXrxx48ZLvU4sDWsdw9rryns47+GrQMSdj5NNNWJjAYyAmQDOOh1a9IGyDLYYgg01CFVV6nxIHUQaQnKDwhRJdUkUVIMzBw48dN899375pn/+59u/dsedDzHzfoSBpk8A2AddNaHAwdEEmmMOQC0g9QFMZWA6QYHUB1BGMJ35nDPP27Bx47llr7c+DqpkXT7rPaNSUHnn4OPEL59v8dN+UMkiLq1PBcUkwrga/T4NYi8MCqPTTpU8G0MQkZmdO3Z8ffsPtn/vnz716dse3L59j7V2znu/D2GE4D61NrMA3CKAc1QcxxSAWtFbqcCJYFqdWyW931z6ohdufMUrX3nemc8587wT16w5fdWqVVviXGVIa1oYAGGPytXjdHOqSlqrKkgzyenndR4p6rqf2LPnniee2PvgIzt3br/t377y3a/feecOAENmnlOg7NPbfuiCPyXHx9RxTAKowyqVyotWaCpgpQJrQsHU0zSBBUCvfd3rzti0ZfOGLadvOX1iYnJq7do1pwPAihVT6ycmJ9Yv5nmnp6cfqobDGQDYuXPn3QDwve/effcD//7A7m987Ws7AThmHlprnfd+VkEznVmZOYQBpv5YsTbHJYDGgCmCZlJBNZW7uSyBaUNd1RgNpcwikm7CzPn8nDjB1GW3OQXJTAaWgQKmOhYtzbijwHF06IXxAObUzZkMUIV+3ddbBFnJzDa7n6y15L2X+G/raRihAyWCZqjfD3KQ6H2V3vhYtjIHZYGO04Pa1ie6Nf13MU0G7WFAuQXK5woe10f0UCRy3L/X5eMIHmb5FCwfywBaPpYBtHwsA2j5WAbQ8rF8LANo+VgG0PKxDKDlYxlAy8fysQyg5WMZQMvHMoCWj+P0+P8HAOnt8iXZ3JYjAAAAAElFTkSuQmCC",
e.isDebug=function(){return e._debug},e.checkNotNull=function(a,b){if(null==a){if(b)throw b+"can't be null";return!1}return!0},e.translateJson=function(a){if("string"==typeof a)try{a=JSON.parse(a)}catch(b){}return a},e.clone=function(a){var b;if("object"==typeof a)if(null===a)b=null;else if(a instanceof Array){b=[];for(var c=0,d=a.length;d>c;c++)b.push(e.clone(a[c]))}else{b={};for(var f in a)"function"!=typeof b[f]&&"_alarmState"!=f&&(b[f]=e.clone(a[f]))}else b=a;return b},e.getAlarmSeverityByLevel=function(a){return a?(a+="","1"==a||"INDETERMINATE"==a.toUpperCase()?d.AlarmSeverity.INDETERMINATE:"2"==a||"WARNING"==a.toUpperCase()?d.AlarmSeverity.WARNING:"3"==a||"MINOR"==a.toUpperCase()?d.AlarmSeverity.MINOR:"4"==a||"MAJOR"==a.toUpperCase()?d.AlarmSeverity.MAJOR:"5"==a||"CRITICAL"==a.toUpperCase()?d.AlarmSeverity.CRITICAL:d.AlarmSeverity.CLEARED):d.AlarmSeverity.CLEARED},e.getComputedStyle=function(b){return b.currentStyle?b.currentStyle:a.getComputedStyle(b,null)},e.updateEmptyBillboardContent=function(a,b,c){var c=this.ext({contentX:0,contentY:0,contentWidth:a.args.width,contentHeight:a.args.height-a.args.arrowHeight},c);c=this.ext(a.args,c);var d=this.getBillboardContent(c),e=d.getContext("2d");e.drawImage(b,c.contentX,c.contentY,c.contentWidth,c.contentHeight),a.s({"m.texture.image":d})},e.updateTextBillboardText=function(a,b,c){b=b||"";var e=d.Util.getTextBillboardContent(b,c);this.updateTextBillboardContent(a,e)},e.updateTextBillboardContent=function(a,b){a.s({"m.texture.image":b}),a.contentWidth=b.width,a.contentHeight=b.height,a.setScale(b.width/2,b.height/2,1)},e.updateTitleBillboardContent=function(a,b){var c=a.contentWidth,e=a.contentHeight,f=a.title,g=d.Util.getTitleBillboardContent(f,b,c,e,a.content);a.s({"m.texture.image":g})},e.createEmptyBillboardForNode=function(a,b){var c=this.createEmptyBillboard(b),d=a.getBoundingBox();return c.setParent(a),c.p(0,d.max.y,0),c},e.createEmptyBillboard=function(a){a=d.Util.ext({width:256,height:128,radius:16,arrowWidth:16,arrowHeight:16,bgColor:"#5B85B5"},a);var b=this.getBillboardContent(a),c=new mono.Billboard;return c.s({"m.texture.image":b,"m.transparent":!0,"m.alignment":mono.BillboardAlignment.bottomCenter,"m.vertical":!1}),c.args=a,c.setScale(a.width,a.height,1),c.setSelectable(!1),c.contentWidth=a.width,c.contentHeight=a.height,c.isEmptyBillboard=!0,c},e.createTitleBillboardForNode=function(a,b){var c=this.createTitleBillboard(b),d=a.getBoundingBox();return c.setParent(a),c.p(0,d.max.y,0),c},e.getTitleBillboardContent=function(a,b,c,d,e){var f=document.createElement("canvas");f.width=c,f.height=d;var g=f.getContext("2d");return g.save(),g.drawImage(a,Math.max(0,(f.width-a.width)/2),0,a.width,a.height),g.translate(0,a.height),e&&g.drawImage(e,Math.max(0,(f.width-e.width)/2),0,e.width,e.height,0,0,c,d-a.height),g.drawImage(b,Math.max(0,(f.width-b.width)/2),0,b.width,b.height,0,0,c,d),f},e.createTitleBillboard=function(a){a=d.Util.ext({title:"标题",titleColor:"#FFFFFF",titleFont:"24px LEDFont,sans-serif",titleBgColor:"#4a74a4",titleWidth:256,titleHeight:32,titleRadius:16,width:256,height:128,radius:0,arrowWidth:0,arrowHeight:0,bgColor:"#5B85B5"},a);var b=this.getBillboardTitle(a),c=this.getBillboardContent(a),e=Math.max(b.width,c.width),f=b.height+c.height,g=d.Util.getTitleBillboardContent(b,c,e,f),h=new mono.Billboard;return h.title=b,h.content=c,h.s({"m.texture.image":g,"m.transparent":!0,"m.alignment":mono.BillboardAlignment.bottomCenter,"m.vertical":!1}),h.args=a,h.setScale(g.width,g.height,1),h.setSelectable(!1),h.contentWidth=e,h.contentHeight=f,h.isTitleBillboard=!0,h},e.createTextBillboard=function(a,b){var c=this.getTextBillboardContent(a,b),d=new mono.Billboard;return d.s({"m.texture.image":c,"m.transparent":!0,"m.alignment":mono.BillboardAlignment.bottomCenter,"m.vertical":!1}),d.setScale(c.width/2,c.height/2,1),d.setSelectable(!1),d.contentWidth=c.width,d.contentHeight=c.height,d.isTextBillboard=!0,d},e.createTextBillboardForNode=function(a,b,c){b=b||"";var d=this.createTextBillboard(b,c),e=a.getBoundingBox();return d.setParent(a),d.p(0,e.max.y,0),d},e.createSpecailTextBillboard=function(a,b,c){var d=this.getSpecialTextBillboard(a,null,null,b,c),e=new mono.Billboard;return e.s({"m.texture.image":d,"m.transparent":!0,"m.alignment":mono.BillboardAlignment.bottomCenter,"m.vertical":!1}),e.setScale(d.width/2,d.height/2,1),e.setSelectable(!1),e.contentWidth=d.width,e.contentHeight=d.height,e.isTextBillboard=!0,e},e.getSpecialTextBillboard=function(a,b,c,d,e){var f,g,h=document.createElement("canvas"),i=h.getContext("2d");e?(f=318,g=442):(f=512,g=256);var j=g/4,k=f/4;if(h.height=g+j,h.width=f,this.getBillboardContent({width:f,height:g+j,radius:f/16,arrowWidth:k,arrowHeight:j,bgColor:d,canvas:h,isHumOrTemp:e}),e){a=parseInt(a)+"",g+=j,i.drawImage(this.dropImg,30,10,288,432);var l="#888888";if(a){var m=80;i.font=m+'px "Microsoft Yahei" ',i.strokeStyle=l,i.textAlign="left",i.textBaseline="middle",i.lineWidth=8,2==a.length?i.strokeText(a,2*g/10-10,2*g/3-50):a.length<2?i.strokeText(a,2*g/10+10,2*g/3-50):i.strokeText(a,2*g/10-30,2*g/3-50)}if(c){var n=50;i.font=n+'px "Microsoft Yahei" ',i.fillStyle=l,i.textAlign="right",i.textBaseline="middle",i.fillText(c,f-g/10,g/2+50)}}else{var l="white";if(b){var o=50;i.font=o+'px "Microsoft Yahei" ',i.fillStyle=l,i.textAlign="left",i.textBaseline="middle",i.fillText(b,g/10,g/5)}if(a){var m=120;i.font=m+'px "Microsoft Yahei" ',i.fillStyle=l,i.textAlign="left",i.textBaseline="middle",i.fillText(a,2*g/10,2*g/3),i.strokeStyle=l,i.lineWidth=4,i.strokeText(a,2*g/10,2*g/3)}if(c){var n=60;i.font=n+'px "Microsoft Yahei" ',i.fillStyle=l,i.textAlign="right",i.textBaseline="middle",i.fillText(c,f-g/10,g/2+20)}}return h},e.getTextBillboardContent=function(a,b,c){c=c||{};var e=document.createElement("canvas"),f=e.getContext("2d");f.font="120px LEDFont,sans-serif";var g=[];g=a.indexOf("\n")?a.split("\n"):[a];for(var h=0,i=0;i<g.length;i++)h=0==i?f.measureText(g[i]).width:Math.max(f.measureText(g[i]).width,h);var j=mono.Utils.getMaxTextSize(g,f.font),k=mono.Utils.nextPowerOfTwo(h),l=j.height,m=mono.Utils.nextPowerOfTwo(l),n=m/4,o=k/4;e.height=m+n,e.width=k;var p=m/g.length;l/g.length;c=d.Util.ext({labelColor:"white",width:k,height:m,radius:k/16,arrowWidth:o,arrowHeight:n,bgColor:b,canvas:e},c),c.height+=c.arrowHeight,this.getBillboardContent(c),f.fillStyle=c.labelColor,f.textBaseline="middle",f.font="120px LEDFont,sans-serif";for(var i=0;i<g.length;i++){var q=g[i];h=f.measureText(q).width,f.fillText(q,(k-h)/2,p*(i+.5))}return e},e.getBillboardTitle=function(a){var b=a.titleWidth=mono.Utils.nextPowerOfTwo(a.titleWidth)||192,c=a.titleHeight=mono.Utils.nextPowerOfTwo(a.titleHeight)||64,d=a.titleRadius||8,e=a.canvas;e||(e=document.createElement("canvas"),e.width=b,e.height=c);var f=e.getContext("2d");f.globalAlpha=a.globalAlpha||.8,f.fillStyle=a.titleBgColor||"#5B85B5",f.font=a.titleFont||"120px LEDFont,sans-serif";var g=a.titleSizeWidth=f.measureText(a.title).width;a.titleSizeHeight=mono.Utils.getMaxTextSize(a.title,a.titleFont);return f.beginPath(),f.moveTo(0,c),f.lineTo(0,d),f.arcTo(0,0,d,0,d),f.lineTo(b-d,0),f.arcTo(b,0,b,d,d),f.lineTo(b,c),f.closePath(),f.fill(),f.textBaseline="top",f.fillStyle=a.titleColor||"#A5855B",f.fillText(a.title,(b-g)/2,2),f.restore(),f.restore(),e},e.getBillboardContent=function(a){a=d.Util.ext({width:256,height:128,radius:20,arrowWidth:50,arrowHeight:30},a);var b=a.width,c=a.height,e=a.radius,f=a.arrowWidth,g=a.arrowHeight,h=a.canvas;if(h||(h=document.createElement("canvas"),h.width=b,h.height=c),!a.isHumOrTemp){var i=h.getContext("2d");i.globalAlpha=a.globalAlpha||.8,i.fillStyle=a.bgColor||"#5B85B5",i.save(),i.beginPath(),i.moveTo(e,0),i.lineTo(b-e,0),i.arcTo(b,0,b,e,e),i.lineTo(b,c-g-e),i.arcTo(b,c-g,b-e,c-g,e),i.lineTo(b/2+f/2,c-g),i.lineTo(b/2,c),i.lineTo(b/2-f/2,c-g),i.lineTo(e,c-g),i.arcTo(0,c-g,0,c-g-e,e),i.lineTo(0,e),i.arcTo(0,0,e,0,e),i.closePath(),i.fill(),i.restore()}return h},e.getNodeCenterPosition=function(a){if(!a)return null;var b=a.getBoundingBox(),c=(b.max.x+b.min.x)/2*a.getScaleX(),d=(b.max.y+b.min.y)/2*a.getScaleY(),e=(b.max.z+b.min.z)/2*a.getScaleZ(),f=a.getWorldPosition();return f.setX(f.x+c),f.setY(f.y+d),f.setZ(f.z+e),f},e.formatDate=function(a,b){if(!a||!b)return null;var c={"M+":a.getMonth()+1,"d+":a.getDate(),"h+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"q+":Math.floor((a.getMonth()+3)/3),S:a.getMilliseconds()};/(y+)/.test(b)&&(b=b.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length)));for(var d in c)new RegExp("("+d+")").test(b)&&(b=b.replace(RegExp.$1,1==RegExp.$1.length?c[d]:("00"+c[d]).substr((""+c[d]).length)));return b},e.ext=function(){var a,c,d,e,f,g,h=arguments[0]||{},i=1,j=arguments.length,k=!1;for("boolean"==typeof h&&(k=h,h=arguments[1]||{},i=2),"object"==typeof h||jQuery.isFunction(h)||(h={}),j===i&&(h=this,--i);j>i;i++)if(null!=(a=arguments[i]))for(c in a)d=h[c],e=a[c],h!==e&&(k&&e&&(jQuery.isPlainObject(e)||(f=jQuery.isArray(e)))?(f?(f=!1,g=d&&jQuery.isArray(d)?d:[]):g=d&&jQuery.isPlainObject(d)?d:{},h[c]=jQuery.extend(k,g,e)):e!==b&&(h[c]=e));return h},e.jsonUtil={object2String:function(a){try{var b=JSON.stringify(a);return b}catch(c){if(e.isDebug())throw c;console.error("json对象转字符串失败",a)}},string2Object:function(a){try{var b=JSON.parse(a);return b}catch(c){if(Util.isDebug())throw c;console.error("字符串转json对象失败",a)}}},e.o2s=function(a){return e.jsonUtil.object2String(a)},e.s2o=function(a){return e.jsonUtil.string2Object(a)},e.toJsonArray=function(a){if(!a)return[];var b=a;"string"==typeof a&&(b=e.s2o(a));var c;return c=b instanceof Array?b:[b]},e.findFirstObjectByMouse=function(a,b,c){c||(c=function(a){return!(a instanceof mono.Billboard)});var d=a.getElementsByMouseEvent(b);if(d.length)for(var e=0;e<d.length;e++){var f=d[e],g=f.element;if(c(g))return f}return null};var f=a.jsonUtil=e.jsonUtil,g=function(){mono.PropertyChangeDispatcher.call(this)};d.Base=g,mono.extend(g,mono.PropertyChangeDispatcher,{onPropertyChange:function(a,b,c){}});var h=function(a){g.call(this),a=a||{},"string"==typeof a&&(a={id:a}),this._id=a.id,this._description=a.description,this._selectable=!0,this._stopAlarmPropagationable=!1,this._lazyLoad=!1,this._lazyLoadScene="",this._rotationExp={},this._positionExp={},this.handleDoubleClick=null,this.handleClick=null};d.Category=h,mono.extend(h,g,{___accessor:["description","stopAlarmPropagationable"],getId:function(){return this._id},setId:function(a){if(this._id!==b)throw"Can not set id";this._id=a},fromJson:function(a){this._id=a.id,this._description=a.description}});var i=function(a){g.call(this),a=a||{},"string"==typeof a&&(a={id:a}),this._id=a.id,this._description=a.description,this._position=a.position||new mono.Vec3,this._position2d=a.position2d||new mono.Vec2,this._rotation=a.rotation,this._location=null,this._userDataMap={},this._parentId=a.parentId,this._hostId="",this._dataTypeId=a.dataTypeId,this._childList=new mono.List,this._alarmState=new d.AlarmState(this),this._powerParentId="",this._allLinks={},this._power="",this._weight=0};d.Data=i,mono.extend(i,g,{___accessor:["rotation","parentId","hostId","dataTypeId","alarmState","description","power","weight"],IT_Data:!0,getId:function(){return this._id},getLocation:function(){return this._location},setLocation:function(a){if(a){var b=new d.Location(a);if(this._location&&b.x==this._location.x&&b.y==this._location.y&&b.z==this._location.z)return;var c=this._location;this._location=b,this.firePropertyChange("location",c,b)}},setPosition:function(a,b,c){var d;if(3===arguments.length?d=new mono.Vec3(a,b,c):1===arguments.length&&(d=mono.Utils.isArray(a)?new mono.Vec3(a[0],a[1],a[2]):new mono.Vec3(a.x||0,a.y||0,a.z||0)),!this._position||d.x!=this._position.x||d.y!=this._position.y||d.z!=this._position.z){var e=this._position;this._position=d,this.firePropertyChange("position",e,d)}},setPosition2d:function(a,b){this._position2d=new mono.Vec2(a,b)},getValue:function(a){return a?this["_"+a]?this["_"+a]:this.getUserData(a):null},getPosition:function(){return this._position||new mono.Vec3},getPosition2d:function(){return this._position2d||new mono.Vec2},u:function(a){if(a)for(var b in a)this.setUserData(b,a[b])},addLink:function(a){a&&a instanceof d.Link&&a.getId()&&!this._allLinks[a.getId()]&&(this._allLinks[a.getId()]=a)},removeLink:function(a){a&&a.getId()&&delete this._allLinks[a.getId()]},getAllLinks:function(){return this._allLinks},getPosition2d:function(){return this._position2d},setUserData:function(a,b){null==b?delete this._userDataMap[a]:this._userDataMap[a]=b},getUserData:function(a){return this._userDataMap[a]},fromJson:function(a){"string"==typeof a&&(a=JSON.parse(a)),this._id=a.id,this._description=a.description,!a.position||a.position.x===b&&a.position.y===b&&a.position.z===b?mono.Utils.isArray(a.position)&&(this._position=new mono.Vec3(a.position[0]||0,a.position[1]||0,a.position[2]||0)):this._position=new mono.Vec3(a.position.x||0,a.position.y||0,a.position.z||0),!a.position2d||a.position2d.x===b&&a.position2d.y===b?mono.Utils.isArray(a.position2d)&&(this._position2d=new mono.Vec2(a.position2d[0]||0,a.position2d[1]||0)):this._position2d=new mono.Vec2(a.position2d.x||0,a.position2d.y||0),a.rotation&&(a.rotation.x!==b&&""!=a.rotation.x||a.rotation.y!==b&&""!=a.rotation.y||a.rotation.z!==b&&""!=a.rotation.z)&&(this._rotation=new mono.Vec3(a.rotation.x,a.rotation.y,a.rotation.z)),this.setLocation(a.location),this._parentId=a.parentId,this._dataTypeId=a.dataTypeId,this._hostId=a.hostId||a.groupId,this._power=a.power,this._weight=a.weight},onAlarmChange:function(){},addChild:function(a){a&&this._childList.add(a)},addChildren:function(a){if(a&&!(a.length<1))for(var b=0;b<a.length;b++){var c=a[b];this.addChild(c)}},removeChild:function(a){this._childList.remove(a)},removeChildren:function(a){if(a&&!(a.length<1))for(var b=0;b<a.length;b++){var c=a[b];this.removeChild(c)}},getChildren:function(){return this._childList},clone:function(a,b){var c=new i(a);c.setDataTypeId(this.getDataTypeId());var d=this.getPosition(),e=this.getLocation();return c.setPosition(d.clone()),e&&c.setLocation(new J(e.x,e.y,e.z)),b&&c.setParentId(this.getParentId()),c}});var j=function(a){g.call(this),a=a||{},"string"==typeof a&&(a={id:a}),this._id=a.id,this._categoryId="",this._description="",this._size=null,this._childrenSize=new d.Size,this._model2d="",this._model2dParameters=null,this._parameters=null,this._model="",this._modelParameters=null,this._simpleModel="",this._simpleModelParameters=null,this._prefabAble=a.prefabAble==b?!0:a.prefabAble,this._simplePrefabAble=a.simplePrefabAble==b?!0:a.simplePrefabAble,this._selectable=!0,this._stopAlarmPropagationable=!1,this._batchable=!1,this._lazyable=!1,this.handleDoubleClick=null,this.handleClick=null,this._rotationExp={},this._positionExp={},this._visible=!0,this._weightRating=0,this._powerRating=0,this._subType="server",this._templateDatas=a.templateDatas||[],this._templateDataMap={}};mono.extend(j,g,{___accessor:["categoryId","description","rotationExp","positionExp","size","childrenSize","parameters","model2d","model2dParameters","model","modelParameters","simpleModel","simpleModelParameters","batchable","lazyable","selectable","stopAlarmPropagationable","prefabAble","simplePrefabAble","weightRating","powerRating","subType"],getId:function(){return this._id},setId:function(a){if(this._id!==b)throw"Can't change id";this._id=a},getTemplateDatas:function(){return this._templateDatas},setTemplateDatas:function(a){this._templateDatas.length=0;var b=this;a&&a.length>0&&a.forEach(function(a){b.addTemplateData(a)})},addTemplateData:function(a){if(a instanceof d.Data)this._templateDatas.push(a),this._templateDataMap[a.getId()]=a;else{var b=new d.Data;b.fromJson(a),this._templateDataMap[b.getId()]=b,this._templateDatas.push(b)}},getTemplateDataById:function(a){return this._templateDataMap[a]},fromJson:function(a){"string"==typeof a&&(a=JSON.parse(a)),this._id=a.id,this._categoryId=a.categoryId,this._description=a.description,this._size=new I(a.size),this._childrenSize=new I(a.childrenSize),this._model2d=a.model2d,this._model2dParameters=e.translateJson(a.model2dParameters),this._model=a.model,this._modelParameters=e.translateJson(a.modelParameters),this._simpleModel=a.simpleModel,this._simpleModelParameters=a.simpleModelParameters,this._selectable=a.selectable===b?!0:a.selectable,this._stopAlarmPropagationable=!!a.stopAlarmPropagationable,this._batchable=!!a.batchable,this._rotationExp=a.rotationExp||{},this._positionExp=a.positionExp||{},this._lazyable=a.lazyable,this._weightRating=a.weightRating,this._powerRating=a.powerRating,this._subType=a.subType}}),d.DataType=j;var k=function(){this.defaultCategory=new d.Category(""),this._categories=[],this._categoryMap={},this._dataTypes=[],this._dataTypeMap={},this._datas=[],this._dataMap={},this._roots=[],this._rootMap={},this._links=[],this._linkMap={},this._dataTypeDatas={},this._categoryDatas={},this._scenes=[],this._sceneMap={},this._rootScene=null,this._categorySceneMap={},this._temperatureFields={},this._collectors={},this._typeCollectors={},this._dataManagerChangeDispatcher=new mono.EventDispatcher,this._dataPropertyChangeDispatcher=new mono.EventDispatcher};mono.extend(k,mono.PropertyChangeDispatcher,{addScene:function(a){if(!(a instanceof d.Scene))return!1;var b=a.getId();if(this._sceneMap[b])throw"Scene with id '"+b+"' already exists";var c=a.getCategoryId();if(!this._categoryMap[c]&&!a.isRoot())throw"Scene Category with category id '"+c+"' does not exist";if(this._categorySceneMap[c])throw"Scene with category id '"+c+"' already exists";if(a.isRoot()){if(null!=this._rootScene)throw"Only support one root scene";this._rootScene=a}this._scenes.push(a),this._sceneMap[b]=a,this._categorySceneMap[c]=a},addSceneFromJson:function(a){for(var b=0,c=a.length;c>b;b++){var e=new d.Scene;e.fromJson(a[b]),this.addScene(e)}},getSceneByCategory:function(a){if(!a)return null;var b=a.getId?a.getId():a;return this._categorySceneMap[b]},getSceneByData:function(a){var b=this.getCategoryForData(a);return this.getSceneByCategory(b)},getRootScene:function(){return this._rootScene},getChildrenScene:function(a){},addCategory:function(a){var b=a.getId();if(!(a instanceof d.Category))throw"Can only add it.Category";if(this._categoryMap[b])throw"Category for id '"+b+"' already exists";this._categories.push(a),this._categoryMap[b]=a},removeCategory:function(a){if(!a)return!1;var b=a.getId();if(!this._categoryMap[b])return!1;var c=this._categories.indexOf(a);return-1==c?!1:(delete this._categoryMap[b],this._categories.splice(c,1),!0)},removeCategoryById:function(a){var b=this._categoryMap[a];b&&this.removeCategory(b)},addCategories:function(a){if(mono.Utils.isArray(a))for(var b=0;b<a.length;b++){var c=a[b];this.addCategory(c)}},addCategoryFromJson:function(a){var b=a;"string"==typeof a&&(b=JSON.parse(a));for(var c=0,e=b.length;e>c;c++){var f=b[c],g=new d.Category;g.fromJson(f),this.addCategory(g)}},addDataType:function(a){if(a){if(!(a instanceof d.DataType))throw"Can only add 'it.DataType'";var b=a.getId();if(this._dataTypeMap[b])throw"DataType for id '"+b+"' already exists";var c=a.getCategoryId();if(c&&!this._categoryMap[c])throw"Category for '"+c+"' does not exist";this._dataTypes.push(a),this._dataTypeMap[b]=a}},addTemplateData:function(a){var b=a.parentDataTypeId||"";if(!b)return!1;var c=this._dataTypeMap[b];if(!c)return!1;var e=new d.Data;if(a.position){var f=a.position;f instanceof Array&&f.length>=2&&(a.position2d={x:f[0],y:f[1]})}e.fromJson(a),c.addTemplateData(e)},addTemplateDataFromJson:function(a){var b=a;"string"==typeof a&&(b=JSON.parse(a));for(var c=0,d=b.length;d>c;c++){var e=b[c];this.addTemplateData(e)}},removeDataType:function(a){if(!a)return!1;var b=a.getId();if(!this._dataTypeMap[b])return!1;var c=this._dataTypes.indexOf(a);return-1===c?!1:this._dataTypeDatas[b]?!1:(delete this._dataTypeMap[b],void this._dataTypes.splice(c,1))},removeDataTypeById:function(a){this.removeDataType[this._dataTypeMap[a]]},getCategoryForDataType:function(a){var b=a;if("string"==typeof a&&(b=this._dataTypeMap[a]),!b)return null;var c=b.getCategoryId();return this._categoryMap[c]},getCategoryForData:function(a){var b=this.getDataTypeForData(a);if(b){var c=b.getCategoryId();return this._categoryMap[c]}return null},getDataTypeForData:function(a){if(a){var b=a;if("string"==typeof b&&(b=this._dataMap[b]),b&&(b instanceof d.Data||b instanceof d.Link)){b.getDataTypeId||console.log("data.getDataTypeId");var c=b.getDataTypeId();return this._dataTypeMap[c]}}},getDataTypeById:function(a){return a?this._dataTypeMap[a]:null},addDataTypeFromJson:function(a){for(var b=0,c=a.length;c>b;b++){var e=new d.DataType;e.fromJson(a[b]),this.addDataType(e)}},setParentAndChildren:function(a){if(!a)return null;var b=a.getParentId();if(b){var c=this._dataMap[b];c&&c.addChild(a)}var d=this.getChildren(a);a.addChildren(d)},setAllParentAndChildren:function(){for(var a in this._dataMap){var b=this._dataMap[a];if(b&&b.getParentId()){var c=this._dataMap[b.getParentId()];c&&c.addChild(b)}}},addData:function(a,c,d){if(a){c===b&&(c=!0),d===b&&(d=!0);var e=a.getId(),f=a.getDataTypeId();if(this._dataMap[e])throw"Data for '"+e+"' already exists";var g=this.getDataTypeForData(a);if(!g)throw"DataType '"+f+"' does not exist";this._datas.push(a),this._dataMap[e]=a;var h=a.getParentId();h||(this._roots.push(a),this._rootMap[e]=a),d&&this.setParentAndChildren(a);var i=this._dataTypeDatas[f];null==i&&(i={},this._dataTypeDatas[f]=i),i[e]=a;var j=this.getCategoryForData(a);if(j){var k=this._categoryDatas[j.getId()];null==k&&(k={},this._categoryDatas[j.getId()]=k),k[e]=a}a.addPropertyChangeListener(this.handleDataPropertyChange,this),c&&this._dataManagerChangeDispatcher.fire({kind:"add",data:a,source:this})}},addDataFromJson:function(a){var b=a;"string"==typeof a&&(b=JSON.parse(a));for(var c=0,e=b.length;e>c;c++){a.id,a.dataTypeId}for(c=0;e>c;c++){var f=b[c],g=new d.Data;g.fromJson(f),this.addData(g,!0,!1)}this.setAllParentAndChildren()},removeData:function(a,b){if(!a)return!1;var c=a.getId();if(!this._dataMap[c])return!1;var d=this._datas.indexOf(a);if(-1===d)return!1;if(a.getParentId()){var e=this._dataMap[a.getParentId()];e&&e.remove(a)}var f=a.getChildren();if(f&&f.size()&&!b)return!1;if(f&&f.size())for(var g=0;g<f.size();g++)this.removeData(f.get(g),b);delete this._dataMap[c],this._datas.splice(d,1);var h=a.getDataTypeId(),i=this._dataTypeDatas[h];null!=i&&delete i[c];var j=this.getCategoryForData(a);if(j){var k=this._categoryDatas[j.getId()];null!=k&&delete k[c]}return a.removePropertyChangeListener(this.handleDataPropertyChange,this),this._dataManagerChangeDispatcher.fire({kind:"remove",data:a,source:this}),!0},addLink:function(a){var b=a.getId();if(!this._linkMap[b]){var c=a.getFromId(),d=a.getToId();return this._dataMap[c]?this._dataMap[d]?(this._linkMap[b]=a,this._links.push(a),this._dataMap[c].addLink(a),this._dataMap[d].addLink(a),this._dataManagerChangeDispatcher.fire({kind:"add",data:a,source:this}),!0):void console.log("To Id does not exist"):void console.log("From Id does not exist")}},removeLink:function(a){var b=a.getId();if(this._linkMap[b]){var c=this._links.indexOf(a);this._links.splice(c,1),delete this._linkMap[b]}var d=a.getFromId(),e=a.getToId();this._dataMap[d].removeLink(a),this._dataMap[e].removeLink(a),this._dataManagerChangeDispatcher.fire({kind:"remove",data:a,source:this})},addTemperatureField:function(a){if(a){if(this._temperatureFields&&this._temperatureFields[a.getId()])throw"Temparature Field for '"+a.getId()+"' already exists";if(this._temperatureFields[a.getId()]=a,this._collectors)for(var b in this._collectors){var c=this._collectors[b];c.getType()==n.Type.temperature&&c.getParentId()==a.getId()&&a.addCollector(c)}}},addTemperatureFieldFromJson:function(a){var b=a;"string"==typeof a&&(b=JSON.parse(a));for(var c=0,d=b.length;d>c;c++){var e=b[c],f=new o;f.fromJson(e),this.addTemperatureField(f)}},removeTemparatureField:function(a){if(a){var b=a.getCollectors();if(b&&b.size()>0){var c=this;b.forEach(function(a){a&&delete c._collectors[a.getId()]})}delete this._temperatureFields[a.getId()]}},addCollector:function(a){if(a){if(this._collectors&&this._collectors[a.getId()])throw"Collector for '"+a.getId()+"' already exists";if(this._collectors[a.getId()]=a,"temperature"==a.getType()){var b=this._temperatureFields[a.getParentId()];b&&b.addCollector(a)}var c=a.getType(),d=this._typeCollectors[c];null==d&&(d={},this._typeCollectors[c]=d),d[a.getId()]=a}},addCollectorFromJson:function(a){var b=a;"string"==typeof a&&(b=JSON.parse(a));for(var c=0,d=b.length;d>c;c++){var e=b[c],f=new n;f.fromJson(e),this.addCollector(f)}},removeCollector:function(a){if(a){if(delete this._collectors[a.getId()],"temperature"==a.getType()){var b=this._temperatureFields[a.getParentId()];b&&b.removeCollector(a)}var c=a.getType(),d=this._typeCollectors[c];d&&delete d[a.getId()]}},getParent:function(a){if(!a)return null;var b=a.getParentId();return this._dataMap[b]},getChildren:function(a,b){var c=[];if(!a)return c;var d=a.getId();for(var e in this._dataMap){var a=this._dataMap[e];b&&a.getDataTypeId()!=b||a.getParentId()===d&&c.push(a)}return c},isAncestor:function(a,b,c){if(!b||!a)return!1;if(b.getId()===a||b.getParentId()===a)return!0;var c=c||this;if(b.getParentId()){var d=this._dataMap[b.getParentId()];if(d)return c.isAncestor(a,d,c)}return!1},getDescendants:function(a,b,c){var d=b||[],c=c||this;if(!a)return d;var e=a.getChildren();return e&&e.size()>0&&e.forEach(function(a){d.push(a),c.getDescendants(a,d,c)}),d},getDataMap:function(){return this._dataMap},getLinkMap:function(){return this._linkMap},getLinkById:function(a){return a?this._linkMap[a]:null},getFromLinks:function(a){},getToLinks:function(a){},getDataMapByCategory:function(a){var b=a;return b instanceof d.Category&&(d=b.getId()),this._categoryDatas[b]},getDataById:function(a){if(!a)return null;var b=this._dataMap[a];if(!b&&"string"==typeof a&&a.indexOf("@")>0){var c=a.split("@"),d=c[0],e=c[1],f=this.getDataById(e);if(f)return null;var g=this.getDataTypeForData(f),h=g.getTemplateDataById(d);if(h){var i=this.getDataTypeForData(h);if(!i)return null;var j=h.clone(a);return j.setParentId(e),this.addData(j),j}}return b},getCollectorById:function(a){return this._collectors[a]},getDatas:function(){return this._datas},getLinks:function(){return this._links},getAncestors:function(a,b){b=b||[];var c=this.getDataById(a.getParentId());return c&&(b.push(c),this.getAncestors(c,b)),b},getAncestor:function(a,b){var c=this.getDataTypeForData(a),d=this.getCategoryForData(a);if(b(a,c,d))return a;var e=this.getParent(a);return null==e?null:this.getAncestor(e,b)},getRootMap:function(){return this._rootMap},getRoots:function(){return this._roots},getTemperatureFields:function(){return this._temperatureFields},isLazyable:function(a){if(!a)return!1;var b=this.getDataTypeForData(a);if(b.isLazyable())return!0;var c=this.getParent(a);return this.isLazyable(c)?!0:!1},fromJson:function(a){a=e.translateJson(a);for(var b=a.categories||[],c=a.dataTypes||[],d=a.datas||[],f={},g={},h=0;h<b.length;h++){var i=b[h];f[i.id]=i}for(h=0;h<c.length;h++){var j=c[h];if(j.categoryId&&!f[j.categoryId]&&!this._categoryMap[j.categoryId])throw"Category for '"+j.categoryId+"' does not exist";g[j.id]=j}for(h=0;h<d.length;h++){var k=d[h],l=k.dataTypeId;if(!g[l]&&!this._dataTypeMap[l])throw"DataType '"+l+"' does not exist"}b&&b.length&&this.addCategoryFromJson(b),c&&c.length&&this.addDataTypeFromJson(c),d&&d.length&&this.addDataFromJson(d)},handleDataPropertyChange:function(a){var b=a.source;if("parentId"===a.property){var c=a.oldValue,d=a.newValue;if(null==d)this._roots.push(b),this._rootMap[b.getId()]=b;else if(null==c){delete this._rootMap[b.getId()];var e=this._roots.indexOf(b);-1!=e&&this._roots.splice(e,1)}}this.onDataPropertyChanged(b,a),this._dataPropertyChangeDispatcher.fire(a)},onDataPropertyChanged:function(a,b){},addDataPropertyChangeListener:function(a,b,c){this._dataPropertyChangeDispatcher.add(a,b,c)},removeDataPropertyChangeListener:function(a,b){this._dataPropertyChangeDispatcher.remove(a,b)},addDataManagerChangeListener:function(a,b,c){this._dataManagerChangeDispatcher.add(a,b,c)},addDataBoxChangeListener:function(a,b,c){this._dataManagerChangeDispatcher.add(a,b,c)},removeDataManagerChangeListener:function(a,b){this._dataManagerChangeDispatcher.remove(a,b)},isStopAlarmPropagation:function(a){if(!a)return!1;var b=this.getDataTypeForData(a);if(!b)return!1;if(b.isStopAlarmPropagationable())return!0;var c=this.getCategoryForData(a);return c&&c.isStopAlarmPropagationable()?!0:!1}}),d.DataManager=k;var l=function(a){a=a||{},"string"==typeof a&&(a={id:a}),this._id=a.id,this._categoryId=a.categoryId,this._root=!1||a.root,this._sceneType=a.sceneType||"ShowSelf",this._twod=a.twod||!1,this._withGis=a.withGis||!1,this.zoomLevel=a.zoomLevel||5,this.center=a.center,this._description="",this.lights=[],this.networkParameters={},this.cameraParameters={},this.animateParameters={},this.showStaticInfo=a.showStaticInfo};mono.extend(l,Object,{___accessor:["categoryId","sceneType","root","twod","withGis","description"],getId:function(){return this._id},isRoot:function(){return this._root},isShowStaticInfo:function(){return this.showStaticInfo},fromJson:function(a){"string"==typeof a&&(a=JSON.parse(a)),this._id=a.id,this._categoryId=a.categoryId,this._root=!1||a.root,this._sceneType=a.sceneType||"ShowSelf",this._twod=a.twod||!1,this._withGis=a.withGis||!1,this.zoomLevel=a.zoomLevel||5,this.center=a.center,this._description=a.description,this.networkParameters=a.networkParameters,this.cameraParameters=a.cameraParameters,this.showStaticInfo=a.showStaticInfo}}),d.Scene=l;var m=function(a){a=a||{},"string"==typeof a&&(a={id:a}),this._id=a.id,this._name=a.name||"",this._dataTypeId=a.dataTypeId||"",this._type=a.type||"",this._fromId=a.fromId,this._toId=a.toId,this._userDataMap={},this._fromControls=a.fromControls||null,this._toControls=a.toControls||null,this._radius=2,this._alarmState=new d.AlarmState(this)};mono.extend(m,Object,{___accessor:["name","type","dataTypeId","fromId","toId","fromControls","toControls","radius","alarmState"],IT_Data:!0,getId:function(){return this._id},setId:function(a){if(this._id!==b)throw"Can't change id";this._id=a},setUserData:function(a,b){null==b?delete this._userDataMap[a]:this._userDataMap[a]=b},getUserData:function(a){return this._userDataMap[a]}}),d.Link=m;var n=function(a){g.call(this),a=a||{},this._parentId=a.parentId||"",this._id=a.id||"",this._position=a.position||new mono.Vec3,this._location=a.location||"",this._value=a.value||"0",this._width=a.width||0,this._height=a.height||0,this._depth=a.depth||0,this._description=a.description,this._type=a.type||"temperature"};n.Type={},n.Type.humidity="humidity",n.Type.temperature="temperature",mono.extend(n,g,{___accessor:["id","parentId","value","width","height","depth","type","position","location"],fromJson:function(a){"string"==typeof a&&(a=JSON.parse(a)),this._id=a.id,this._parentId=a.parentId,this._description=a.description,this._width=a.width,this._height=a.height,this._depth=a.depth,this._type=a.type,this._value=a.value,!a.position||a.position.x===b&&a.position.y===b&&a.position.z===b?mono.Utils.isArray(a.position)&&(this._position=new mono.Vec3(a.position[0]||0,a.position[1]||0,a.position[2]||0)):this._position=new mono.Vec3(a.position.x||0,a.position.y||0,a.position.z||0),this._location=a.location}}),d.Collector=n;var o=function(a){g.call(this),a=a||{},this._parentDataId=a.parentDataId,this._id=a.id||"",this._width=a.width||null,this._height=a.height||null,this._position=a.position||new mono.Vec3,this._description=a.description||"",this._minValue=a.minValue||null,this._maxValue=a.maxValue||null,this.collectors=new mono.List};mono.extend(o,g,{___accessor:["id","parentDataId","width","height","position","minValue","maxValue"],fromJson:function(a){"string"==typeof a&&(a=JSON.parse(a)),this._id=a.id,this._parentDataId=a.parentDataId,this._description=a.description,
this._width=a.width,this._height=a.height,!a.position||a.position.x===b&&a.position.y===b&&a.position.z===b?mono.Utils.isArray(a.position)&&(this._position=new mono.Vec3(a.position[0]||0,a.position[1]||0,a.position[2]||0)):this._position=new mono.Vec3(a.position.x||0,a.position.y||0,a.position.z||0)},addCollector:function(a){a&&this.collectors.add(a)},removeCollector:function(a){a&&this.collectors.remove(a)},getCollectors:function(){return this.collectors}}),d.TemperatureField=o;var p=function(a){var a=a||{};this._id=a.id||"",this._description=a.description,this._sceneId=a.sceneId,this._type=a.type,this._color=a.color||"PointLight",this._intensity=a.intensity,this._distance=a.distance,this._position=a.position||new mono.Vec3};mono.extend(p,g,{___accessor:["id","sceneId","type","color","intensity","distance","position"],fromJson:function(a){"string"==typeof a&&(a=JSON.parse(a)),this._id=a.id,this._description=a.description,!a.position||a.position.x===b&&a.position.y===b&&a.position.z===b?mono.Utils.isArray(a.position)&&(this._position=new mono.Vec3(a.position[0]||0,a.position[1]||0,a.position[2]||0)):this._position=new mono.Vec3(a.position.x||0,a.position.y||0,a.position.z||0),this._sceneId=a.sceneId,this._type=a.type,this._color=a.color,this._intensity=a.intensity,this._distance=a.distance}}),d.Light=p;var q=function(a){this.sceneManager=a,this.dataManager=this.sceneManager.dataManager,this.isVirtualElementFunction=function(){return!0},this.virtualFilter=new d.VirtualManager(this.sceneManager),this.oldOpacityValue=this.virtualFilter.opacityValue,this.virtualFilter.opacityValue=.2,this.sceneManager.viewManager3d.addMaterialFilter(this.virtualFilter),this.fields=null,this.dataBox=this.sceneManager.network3d.getDataBox(),this.heatMaps={},this.tempBoards={},this._minValue=null,this._maxValue=null,this.isAnimate=!0,this.deltaY=0};mono.extend(q,Object,{show:function(){if(this.fields=this.dataManager.getTemperatureFields(),this.fields&&!this.intervalId){var b=0;for(var c in this.fields){var d=this.fields[c];if(d&&this.sceneManager.isCurrentSceneInstance(d.getParentDataId())){this.createTempFieldByField(d);b++}}if(!(1>b)){this.virtualAllElement(),this.sceneManager.network3d.dirtyNetwork();var e=this;this.intervalId=a.setInterval(function(){e.beforeRefresh(),e.refresh(function(){for(var a in e.heatMaps){var b=e.heatMaps[a],c=e.tempBoards[a];if(e.isAnimate){var d=parseFloat(c.orgPositionY)+parseFloat(e.deltaY);c.setPositionY(d)}c&&(c.setStyle("m.texture.image",b.getImage()),b.heatMapCanvas.parentNode&&document.body.removeChild(b.heatMapCanvas))}e.deltaY>80?e.deltaY=0:e.deltaY+=30})},2e3)}}},beforeRefresh:function(){},refresh:function(b){var c=a.requestAnimationFrame||a.mozRequestAnimationFrame||a.webkitRequestAnimationFrame||a.msRequestAnimationFrame,d=this,e=function(){for(var a in d.heatMaps){var c=d.heatMaps[a];if(d.isAnimate&&d.deltaY>0){if(c.datas&&c.datas.length>0)for(var e=0;e<c.datas.length;e++){var f=c.datas[e];f&&3==f.length&&(f[2]=f[2]+.05)}}else c.clear(),d.setDataByField(d.fields[a],c);document.body.appendChild(c.getCanvas()),b&&b()}};c(e)},hide:function(){if(this.intervalId){if(a.clearInterval(this.intervalId),delete this.intervalId,this.virtualFilter.clearAll(),this.sceneManager.network3d.setSelectTransparencyThreshold(this.oldOpacityValue+.1),this.tempBoards)for(var b in this.tempBoards){var c=this.tempBoards[b];this.dataBox.remove(c),delete this.heatMaps[b],delete this.tempBoards[b]}if(this.tempBillbords){for(var d in this.tempBillbords)if(d){var e=this.tempBillbords[d];e&&(e.setParent(null),this.dataBox.remove(e))}delete this.tempBillbords}this.sceneManager.network3d.dirtyNetwork()}},isShowing:function(){return this.intervalId?!0:!1},virtualAllElement:function(){if(this.sceneManager.network3d.setSelectTransparencyThreshold(this.virtualFilter.opacityValue+.01),this.isVirtualElementFunction&&this.isVirtualElementFunction()){this.virtualFilter.addAll();var a=this.dataManager.getDataMapByCategory("floor");if(a)for(var b in a){var c=a[b];c&&this.virtualFilter.remove(c)}}},createTempFieldByField:function(a){if(!a)return null;var b=this.sceneManager.getNodeByDataOrId(a.getParentDataId());if(!b)return null;var c=a.getPosition(),e=d.Util.getNodeCenterPosition(b),f=e.x+c.x,g=e.z+c.y,h=new d.HeatMap({width:a.getWidth(),height:a.getHeight(),positionX:f,positionY:g});this.setDataByField(a,h),this.heatMaps[a.getId()]=h;var i=h.getTemperatureBoard();this.tempBoards[a.getId()]=i;var j=b.getWorldPosition().y+50;return i.setPositionY(j),i.orgPositionY=j,i.setRotationZ(-1*b.getRotationY()),this.dataBox.add(i),h},setDataByField:function(a,b){if(a&&a.collectors&&!(a.collectors.length<1)){this.dataBox.startBatch();for(var c=0;c<a.collectors.size();c++){var d=a.collectors.get(c);d&&this.createHeatPoint(d,b,a)}this.dataBox.endBatch()}},format:function(a){return"温度:\n"+a.toFixed(1)+"°C"},showBillboard:function(a){return!0},createBillboard:function(a,b){if(a){var c=a.getId();this.tempBillbords||(this.tempBillbords={});var e=this.tempBillbords[c];if(!e){var f,g,h,i=this.sceneManager.getNodeByDataOrId(b.getParentDataId()),j=a.getPosition(),k=a.getLocation(),l=d.Util.getNodeCenterPosition(i);if(k&&"string"==typeof k&&this.dataManager.getDataById(k)){var m=this.sceneManager.getNodeByDataOrId(k);if(m){var l=d.Util.getNodeCenterPosition(m);f=l.x,g=l.z}}else f=l.x+j.x,g=l.z+j.z;var h=l.y+j.y,n=i.getBoundingBox();if(n){var o=(n.max.y-n.min.y)/2;10>o&&(o=100),h+=o}else h+=100;e=d.Util.createSpecailTextBillboard("text",null,!0),e.setPositionX(f),e.setPositionY(h),e.setPositionZ(g),this.tempBillbords[c]=e,this.dataBox.add(e)}var p=parseFloat(a.getValue()||0),q=null;this._minValue&&p<this._minValue&&(q="#5B8505"),this._maxValue&&p>this._maxValue&&(q="#5B8505"),e.setStyle("m.texture.image",this.createCanvas(p.toFixed(2),"温度:","°C",q)),e.setStyle("m.transparent",!1),e.setStyle("m.alphaTest",.5)}},createCanvas:function(a,b,c,e){return d.Util.getSpecialTextBillboard(a,b,c,e,!0)},getRelativePosition:function(a,b){var c,d;c=(new mono.Mat4).getInverse(a.worldMatrix.clone()),d=(new mono.Mat4).multiplyMatrices(c,b.worldMatrix.clone());var e=(new mono.Vec3).getPositionFromMatrix(d);return e},createHeatPoint:function(a,c,e){if(a&&c){var f,g,h=this.sceneManager.getNodeByDataOrId(e.getParentDataId()),i=h.getPosition(),j=a.getPosition(),k=a.getLocation();if(k&&"string"==typeof k&&this.dataManager.getDataById(k)){var l=this.sceneManager.getNodeByDataOrId(k),m=this.getRelativePosition(h,l);if(l){var n=d.Util.getNodeCenterPosition(l);n.x=m.x,n.z=m.z,n.x=n.x+i.x,n.z=n.z+i.z,f=n.x,g=n.z}}else{var n=d.Util.getNodeCenterPosition(h);n.x=n.x,n.z=n.z,f=n.x+j.x,g=n.z+j.z}var o=a.getValue();if(o&&(o=parseFloat(o/70)),f!=b&&g!=b){var p={x:f||0,y:g||0,w:a.getWidth()||0,l:a.getDepth()||0,value:o||0};c.addPointWithArea(p)}this.showBillboard(a)&&this.createBillboard(a,e)}},getCurrentSceneFields:function(){var a=[];for(var b in this.fields){var c=this.fields[b];c&&this.sceneManager.isCurrentSceneInstance(c.getParentDataId())&&a.push(c)}return a}}),d.TemperatureFieldManager=q;var r=function(a){this.sceneManager=a,this.dataManager=this.sceneManager.dataManager,this.dataBox=this.sceneManager.network3d.getDataBox(),this.humCollectors=null,this.tempBillbords={},this._minValue=null,this._maxValue=null};mono.extend(r,Object,{show:function(){if(this.humCollectors=this.sceneManager.dataManager._typeCollectors[n.Type.humidity],!this.humCollectors)return 0;if(this.intervalIndex)return 0;var b=0;for(var c in this.humCollectors){var d=this.humCollectors[c];d&&this.sceneManager.isCurrentSceneInstance(d.getParentId())&&(this.createBillboard(d),b++)}if(1>b)return 0;var e=this;return this.intervalIndex=a.setInterval(function(){e.update()},5e3),b},update:function(){if(this.tempBillbords)for(var a in this.tempBillbords){var b=this.dataManager._collectors[a];this.createBillboard(b)}},hide:function(){if(this.intervalIndex&&(a.clearInterval(this.intervalIndex),delete this.intervalIndex),this.tempBillbords)for(var b in this.tempBillbords){var c=this.tempBillbords[b];c&&this.dataBox.remove(c),delete this.tempBillbords[b]}},isShowing:function(){return this.intervalIndex?!0:!1},format:function(a){return"湿度:\n"+a.toFixed(1)+"°"},createBillboard:function(a){if(!a)return null;var b=a.getId(),c=this.tempBillbords[b];if(!c){var e=this.sceneManager.getNodeByDataOrId(a.getParentId());if(!e)return console.log("parent does not exists!"),null;var f=a.getPosition(),g=d.Util.getNodeCenterPosition(e),h=g.x+f.x,i=g.z+f.z,j=g.y+f.y,k=e.getBoundingBox();k&&(j+=(k.max.y-k.min.y)/2),c=d.Util.createSpecailTextBillboard("text",null,!0),c.setPositionX(h),c.setPositionY(j),c.setPositionZ(i),this.tempBillbords[b]=c,this.dataBox.add(c)}var l=parseFloat(a.getValue()||0),m=null;return this._minValue&&l<this._minValue&&(m="#5B8505"),this._maxValue&&l>this._maxValue&&(m="#5B8505"),c.setStyle("m.texture.image",this.createCanvas(l.toFixed(2),"湿度:","%",m)),c.setStyle("m.transparent",!1),c.setStyle("m.alphaTest",.5),c},createCanvas:function(a,b,c,e){return d.Util.getSpecialTextBillboard(a,b,c,e,!0)}}),d.HumidityManager=r;var s=function(){};mono.extend(s,Object,{getQueue:function(){return 1e3},shouldHandleDoubleClickElement:function(a,b,c,d){return!1},shouldHandleMouseUpElement:function(a,b,c,d){return!1},shouldPropogateDoubleClickElement:function(a,b,c,d){return!1},shouldHandleDoubleClickBackground:function(a,b){return!1},shouldHandleMouseUpBackground:function(a,b){return!1},shouldPropogateDoubleClickBackground:function(a){return!1},shouldHandleClickElement:function(a,b,c,d){return!1},shouldPropogateClickElement:function(a,b,c,d){return!1},shouldHandleClickBackground:function(a){return!1},shouldPropogateClickBackground:function(a){return!1},handleDoubleClickBackground:function(a){},handleClickBackground:function(a){},handleDoubleClickElement:function(a,b,c,d){},handleClickElement:function(a,b,c,d){},handleMouseMoveElement:function(a,b,c,d,e){},handleMouseMoveBackground:function(a){},handleMouseUpElement:function(a,b,c,d,e){},handleMouseUpBackground:function(a){}}),d.EventHandler=s;var t=function(a,b,c){mono.PropertyChangeDispatcher.call(this),this.sceneManager=a,this.network=b||this.initView(),this.network.getRootView().style.position="absolute",this._for2d=c,this._defaultNode=new mono.List,this.initResource(),this.configView(),this.networkParameters={},this.cameraParameters={},this.enableClick=!1,this.enableMousemove=!1,this.enableMouseup=!1};mono.extend(t,mono.PropertyChangeDispatcher,{initView:function(){return new mono.Network3D},initResource:function(){this._eventHandlers=[],this._materialFilters=[],this._visibleFilters=[],this._selectableFilters=[],this._renderCallbacks=[],this._focusNode=null},initDefault:function(){this.defaultEventHandler=new d.DefaultEventHandler(this.sceneManager),this._eventHandlers.push(this.defaultEventHandler),this.defaultMaterialFilter=new d.VirtualManager(this.sceneManager),this._materialFilters.push(this.defaultMaterialFilter),this.defaultSelectableFilter=new d.SelectableManager(this.defaultMaterialFilter),this._selectableFilters.push(this.defaultSelectableFilter);var a=this;this.addPropertyChangeListener(function(b){if("focusNode"==b.property){var c=b.newValue;if(a.defaultMaterialFilter)if(c){if(a.defaultMaterialFilter.isVirtualOther(a.getDataByNode(c))&&(a.defaultMaterialFilter.addAll(),a.defaultMaterialFilter.removeByDescendant(c),a.sceneManager.isLink(c))){var d=c.getFromNode(),e=c.getToNode();a.defaultMaterialFilter.removeByDescendant(d),a.defaultMaterialFilter.removeByDescendant(e)}}else a.defaultMaterialFilter.clear();a.resetCameraDistance(c)}}),this.tooltipManager=new d.TooltipManager(this.sceneManager),this.addEventHandler(this.tooltipManager),this.addRenderCallback(this.tooltipManager),this.addDefaultYRestrict(),this.addCameraDistanceRestrict(),this.setDefaultCamera()},getSetMethod:function(a){var b="set"+a.charAt(0).toUpperCase()+a.slice(1);return b},setNetworkValue:function(a,b){if(a){var c=this.getSetMethod(a);this.network[c]&&"function"==typeof this.network[c]?this.network[c](b):this.network[a]=b,this.networkParameters[a]=b}},resetNetwork:function(){if(this.networkParameters)for(var a in this.networkParameters)this.setNetworkValue(a,this.networkParameters[a])},setCameraValue:function(a,b){if(a){var c=this.network.getCamera(),d=this.getSetMethod(a);c[d]&&"function"==typeof c[d]?c[d](b):c[a]=b,this.cameraParameters[a]=b}},resetCamera:function(){if(this.cameraParameters)for(var a in this.cameraParameters)this.setCameraValue(a,this.cameraParameters[a])},clear:function(){var a=this.network.getDataBox();a.clear(),this._defaultNode.size()>0&&this._defaultNode.forEach(function(b){b instanceof mono.Light||a.add(b)})},addDefaultNode:function(a){if(a){var b=this.network.getDataBox();a instanceof mono.Light||this._defaultNode.add(a),b.add(a)}},initLights:function(){var a=new mono.AmbientLight(16777215);this.addDefaultNode(a);var b=new mono.PointLight(16777215,.05);b.setPosition(1e4,1e4,1e4),this.addDefaultNode(b),b=new mono.PointLight(16777215,.05),b.setPosition(-1e4,1e4,-1e4),this.addDefaultNode(b);var b=new mono.PointLight(16777215,.05);b.setPosition(1e4,1e4,-1e4),this.addDefaultNode(b),b=new mono.PointLight(16777215,.05),b.setPosition(-1e4,1e4,1e4),this.addDefaultNode(b),b=new mono.PointLight(16777215,.05),b.setPosition(0,0,1e4),this.addDefaultNode(b),b=new mono.PointLight(16777215,.05),b.setPosition(0,0,-1e4),this.addDefaultNode(b),b=new mono.PointLight(16777215,.05),b.setPosition(1e4,0,0),this.addDefaultNode(b),b=new mono.PointLight(16777215,.05),b.setPosition(0,0,-1e4),this.addDefaultNode(b)},addDefaultYRestrict:function(){var a=this.getDefaultInteraction();a.yRistrict=!0,a.yLowerLimitAngle=0,a.yUpLimitAngle=Math.PI/4,a.minDistance=200,a.maxDistance=1e4},removeDefaultYRestrict:function(){var a=this.getDefaultInteraction();a.yRistrict=!0,a.yLowerLimitAngle=-Math.PI/2,a.yUpLimitAngle=Math.PI/2,a.minDistance=0,a.maxDistance=1/0},setDistance:function(a,b){var c=this.getDefaultInteraction();(a||0==a)&&(c.minDistance=0),b&&(c.maxDistance=1/0)},configView:function(){var a=this,b=!1,c=!1;this.network.getRootView().addEventListener("dblclick",function(b){var c=a.filterDoubleClickElement(b);c?a.handleDoubleClick(c):a.handleDoubleClickBackground()}),this.network.getRootView().addEventListener("click",function(b){if(a.enableClick){var c=a.filterClickElement(b);c?a.handleClick(c):a.handleClickBackground()}}),this.network.getRootView().addEventListener("mousedown",function(a){b=!0,c=!1}),this.network.getRootView().addEventListener("mouseup",function(d){if(b=!1,a.enableMouseup){d._mousemove=c,c=!1;var e=a.filterMouseMoveElement(d);if(e){e.element;a.handleMouseUpElement(e,d)}else a.handleMouseUpBackground(d)}}),this.network.getRootView().addEventListener("mousemove",function(d){if(c=!0,a.enableMousemove&&(d._mousedown=b,!b)){var e=a.filterMouseMoveElement(d);if(e){e.element;a.handleMouseMoveElement(e,d)}else a.handleMouseMoveBackground(d)}}),this.setOverLoadMaterial(),this.setVisibleFunction(),this.setSelectableFunction(),this.setNetworkRenderCallback()},getDataByNode:function(a){if(!a)return null;var b=this.sceneManager.getNodeData(a);if(null==b&&a.getParent()){var c=a.getParent();b=this.sceneManager.getNodeData(c),null==b&&c.getParent()&&(b=this.sceneManager.getNodeData(c.getParent()))}return b},setFocusNode:function(a){if(this._focusNode!=a){var b=this.getDataByNode(a),c=this.sceneManager.dataManager.getCategoryForData(b);if(!(c&&c.getId().indexOf("earth")>=0)){var d=this._focusNode;this._focusNode=a,this.firePropertyChange("focusNode",d,a)}}},getFocusNode:function(){return this._focusNode},getDefaultEventHandler:function(){return this.defaultEventHandler},removeDefaultEventHandler:function(){this.defaultEventHandler&&(this.removeEventHandler(this.defaultEventHandler),this.defaultEventHandler=null)},getDefaultVirtualMaterialFilter:function(){return this.defaultMaterialFilter},removeDefaultMaterialFilter:function(){this.defaultMaterialFilter&&(this.removeMaterialFilter(this.defaultMaterialFilter),this.defaultMaterialFilter=null)},getDefaultInteraction:function(){return this.network.getDefaultInteraction()},addMaterialFilter:function(a){this.includeMaterialFilter(a)||this._materialFilters.push(a)},removeMaterialFilter:function(a){var b=this._materialFilters.indexOf(a);-1!==b&&(a.destoryBillboard&&a.destoryBillboard(),this._materialFilters.splice(b,1))},includeMaterialFilter:function(a){var b=this._materialFilters.indexOf(a);return-1!==b?!0:!1},addVisibleFilter:function(a){this.includeVisibleFilter(a)||this._visibleFilters.push(a)},removeVisibleFilter:function(a){var b=this._visibleFilters.indexOf(a);-1!==b&&this._visibleFilters.splice(b,1)},includeVisibleFilter:function(a){var b=this._visibleFilters.indexOf(a);return-1!==b?!0:!1},addSelectableFilter:function(a){this._selectableFilters.push(a)},removeSelectableFilter:function(a){var b=this._selectableFilters.indexOf(a);-1!==b&&this._selectableFilters.splice(b)},addEventHandler:function(a,c){return a instanceof d.EventHandler?c===b?this._eventHandlers.push(a):this._eventHandlers.splice(c,0,a):void 0},removeEventHandler:function(a){var b=this._eventHandlers.indexOf(a);-1!==b&&this._eventHandlers.splice(b,1)},addRenderCallback:function(a,c){return a.onRenderCallback?c===b?this._renderCallbacks.push(a):this._renderCallbacks.splice(c,0,a):void 0},removeRenderCallback:function(a){var b=this._renderCallbacks.indexOf(eventHandler);-1!==b&&this._renderCallbacks.splice(b,1)},filterMouseMoveElement:function(a){return this.network.getFirstElementByMouseEvent(a,!1)},handleMouseMoveElement:function(a,b){for(var c,d=a.element,e=this.getDataByNode(d),f=0;f<this._eventHandlers.length;f++)c=this._eventHandlers[f],c.handleMouseMoveElement(d,this.network,e,a,b)},handleMouseMoveBackground:function(a){for(var b,c=0;c<this._eventHandlers.length;c++)b=this._eventHandlers[c],b.handleMouseMoveBackground(this.network,a)},handleMouseUpElement:function(a,b){for(var c,d=a.element,e=this.getDataByNode(d),f=0;f<this._eventHandlers.length;f++)if(c=this._eventHandlers[f],c.shouldHandleMouseUpElement(d,this.network,e,a,b))return void c.handleMouseUpElement(d,this.network,e,a,b)},handleMouseUpBackground:function(a){for(var b,c=0;c<this._eventHandlers.length;c++)if(b=this._eventHandlers[c],b.shouldHandleMouseUpBackground(this.network,a))return void b.handleMouseUpBackground(this.network,a)},filterDoubleClickElement:function(a){var b=null;return this.network.getFirstElementByMouseEvent(a,!1,b)},getAnimation:function(a){var b=a.element?a.element:a,c=b.getClient("animation");return c},playAnimation:function(a,b){b=b||this.getAnimation(a),b&&make.Default.playAnimation(a.element||a,b)},filterClickElement:function(a){return this.network.getFirstElementByMouseEvent(a,!1)},handleDoubleClick:function(a){for(var b,c=a.element,d=0;d<this._eventHandlers.length;d++){b=this._eventHandlers[d];var e=this.getDataByNode(c);if(b.shouldHandleDoubleClickElement(c,this.network,e,a))return void b.handleDoubleClickElement(c,this.network,e,a)}var f=this.getAnimation(c);f&&this.playAnimation(c,f)},handleClick:function(a){for(var b,c=a.element,d=0;d<this._eventHandlers.length;d++){b=this._eventHandlers[d];var e=this.getDataByNode(c);if(b.shouldHandleClickElement(c,this.network,e,a))return void b.handleClickElement(c,this.network,e,a)}},handleDoubleClickBackground:function(){for(var a,b=0;b<this._eventHandlers.length;b++)if(a=this._eventHandlers[b],a.shouldHandleDoubleClickBackground(this.network))return void a.handleDoubleClickBackground(this.network)},handleClickBackground:function(){for(var a,b=0;b<this._eventHandlers.length;b++)if(a=this._eventHandlers[b],a.shouldHandleClickBackground(this.network))return void a.handleClickBackground(this.network)},setOverLoadMaterial:function(){var a=this.network;a.sortOpaqueOrderByMaterial=!1;var b=this._materialFilters;a.getOverLoadMaterial=function(a,c){for(var d=null,e=0;e<b.length;e++){var f=b[e];d=f.filterMaterial(c,d,a)}return d}},setVisibleFunction:function(){var a=this.network,b=this;a.isVisible=function(c){if(c){if(c instanceof TGL.Link||c instanceof TGL.PathLink){if(!c.isVisible())return!1;if(!this.isVisible(c._fromNode))return!1;if(!this.isVisible(c._toNode))return!1}if(!c.isVisible())return!1;for(var d=b._visibleFilters,e=0;e<d.length;e++){var f=d[e];if(!f.isVisible(c,b.getDataByNode(c),a))return!1}}return!0}},setSelectableFunction:function(){var a=this;this.network.selectableFunction=function(b){if(b){var c=a._selectableFilters;if(!c||c.length<1)return!0;for(var d=0;d<c.length;d++){var e=c[d];if(!e.isSelectable(b,a.network))return!1}}return!0}},setNetworkRenderCallback:function(){var a=this,b=this._renderCallbacks;this.network.renderCallback=function(){for(var c=0;c<b.length;c++){var d=b[c];d.onRenderCallback(a.network)}}},resetCameraDistance:function(a){if(this.cameraDistanceRestrict&&a){var b=this.network.getCamera().getFov()||70,c=this.getDefaultInteraction(),d=this.sceneManager.getNodeData(a),e=this.sceneManager.dataManager.getCategoryForData(d);a=a.getClient("complexNode")||a;var f=a.getBoundingBox();if(!e)return c.minDistance=200,void(c.maxDistance=1e4);var g=e.getId().toLowerCase();if(g.indexOf("datacenter")>=0){var h=1500;f&&f.size().x&&(h=f.size().x*Math.atan(Math.PI*(90-b/2)/360)),c.minDistance=300,c.maxDistance=h}else if(g.indexOf("building")>=0){var i=this.sceneManager.getCurrentScene();if(i&&i.getCategoryId().toLowerCase().indexOf("building")>=0)c.minDistance=100,c.maxDistance=1e4;else{var j=this.sceneManager.getCurrentRootNode();j=j.getClient("complexNode")||j;var f=j?j.getBoundingBox():null,h=1500;f&&f.size().x&&(h=f.size().x*Math.atan(Math.PI*(90-b/2)/360)),c.minDistance=200,c.maxDistance=h}}else g.indexOf("floor")>=0||g.indexOf("channel")>=0||g.indexOf("area")>=0||g.indexOf("room")>=0?(c.minDistance=100,c.maxDistance=1e4):g.indexOf("rack")>=0||g.indexOf("equipment")>=0||g.indexOf("card")>=0?(c.minDistance=50,c.maxDistance=1e3):(c.minDistance=200,c.maxDistance=1e4)}},setCameraDistance:function(a,c){var d=this.getDefaultInteraction();null!=a&&a!=b&&parseInt(a)&&(d.minDistance=parseInt(a)),null!=c&&c!=b&&parseInt(c)&&(d.maxDistance=parseInt(c))},setSelectedStype:function(a,b){if(a&&!(a instanceof Array&&a.length<1)){this.defaultInteractions=this.network.getInteractions();var c=new mono.DefaultInteraction(this.network);c.maxDistance=3e3,c.minDistance=800,this.network.setInteractions([c]);var b=b||"#0431B4",d=this.network.getDataBox().getSelectionModel();if(a instanceof Array)for(var e=0;e<a.length;e++){var f=a[e];f.s({"m.type":"phong","select.style":"outline.glow","select.color":b}),d.appendSelection(f)}else a.s({"m.type":"phong","select.style":"outline.glow","select.color":b}),d.appendSelection(a)}},addCameraDistanceRestrict:function(){this.cameraDistanceRestrict=!0},removeCameraDistanceRestrict:function(){delete this.cameraDistanceRestrict},lookAt:function(a){this.defaultEventHandler&&this.defaultEventHandler.lookAt&&this.defaultEventHandler.lookAt(a)},setDefaultCamera:function(){var a=this.network.getCamera();a.setNear(50),a.fov=70},isVisible:function(a){if(!a)return!1;var b=null;if(a instanceof d.Data?b=a:a instanceof mono.Element?b=this.sceneManager.getNodeData(a):"string"==typeof a&&(b=this.sceneManager.dataManager.getDataById(a)),!b)return!1;var c=this.sceneManager.getNodeByDataOrId(b);if(!c)return!1;if(!this._visibleFilters||this._visibleFilters.length<1)return c.isVisible();for(var e=0;e<this._visibleFilters.length;e++){var f=this._visibleFilters[e];if(f&&!f.isVisible(c,b,this.network))return!1}return!0},isVirtual:function(a){for(var b=0;b<this._materialFilters.length;b++){var c=this._materialFilters[b];if(c&&c.isVirtual&&c.isVirtual(a))return!1}return!0}}),d.ViewManager=t;var u=function(b,c){mono.PropertyChangeDispatcher.call(this),this.sceneManager=b,this.map=null,this.network=c,c||(a.BMap?(this.network=new twaver.canvas.Network,this.network.setRectSelectEnabled(!1)):this.network=new twaver.vector.Network),this.container=document.createElement("div"),this.container.style.position="absolute",this.mapView=null,this._visibleFilters=[],this._selectableFilters=[],this._eventHandlers=[];var d=this;this.dbClickHandle=function(a){if(a){var b=d.network.getElementAt(a);b?d.handleDoubleClick({element:b}):d.handleDoubleClickBackground()}},this.network.adjustBounds({x:0,y:0,width:1,height:1}),this.left=1,this.top=0,this.width=document.documentElement.clientWidth,this.height=document.documentElement.clientHeight,this.adapter=null,this.isCreateMap=!1,this.focusData=null,this.isGis=null;var e=this.network.getElementBox();this.tree=new twaver.controls.Tree(e),this.table=new twaver.controls.Table(e),this.tableRule={},this.treeRule={},this.addTableAndTree()};mono.extend(u,mono.PropertyChangeDispatcher,{createMap:function(){if(this.registerNormalImage("./images/building1.png","b1"),this.registerNormalImage("./images/building2.png","b2"),this.registerNormalImage("./images/building3.png","b3"),a.BMap){var b;document.getElementById("mainView")?b=document.getElementById("mainView"):(b=document.createElement("div"),b.id="mainView",b.style.height="100%",document.body.appendChild(b)),b.appendChild(this.container),this.container.style.height="100%",this.container.style.width="100%",this.mapView=document.createElement("div"),this.mapView.id="MapView",this.mapView.style.height="100%",this.container.appendChild(this.mapView),this.map=new BMap.Map("MapView");var c=this.map,d=new BMap.Point(108.95,34.27);c.centerAndZoom(d,7),c.addControl(new BMap.NavigationControl),c.enableScrollWheelZoom();var e=this.network.getView();document.getElementsByClassName("BMap_mask")[0].appendChild(e),this.network.adjustBounds({x:0,y:0,width:document.documentElement.clientWidth,height:document.documentElement.clientHeight});var f=this.network,g=this;f.addInteractionListener(function(a){if(a.kind="liveMoveBetween"){c.disableDragging();var b=f.getSelectionModel().getSelection();b.forEach(function(a){var b=new BMap.Pixel(a.getX(),a.getY());c.pixelToPoint(b)})}}),f.getView().addEventListener("dbclick",function(a){f.getElementAt(a)?(c.disableDoubleClickZoom(),a.preventDefault()):c.enableDoubleClickZoom()}),f.getView().addEventListener("mousedown",function(a){f.getElementAt(a)?c.disableDragging():c.enableDragging()}),f.getView().addEventListener("mousedown",function(a){clickPoint=f.getLogicalPoint(a)}),f.getView().addEventListener("mouseup",function(a){clickPoint=null}),c.addEventListener("movestart",function(){e.style.opacity=0}),c.addEventListener("moveend",function(){e.style.opacity=1,g.changePostionWithMap()}),c.addEventListener("dragstart",function(){e.style.opacity=0,g.changePostionWithMap()}),c.addEventListener("dragend",function(){e.style.opacity=1,g.changePostionWithMap()}),c.addEventListener("zoomstart",function(){e.style.opacity=0,g.changePostionWithMap()}),c.addEventListener("zoomend",function(){e.style.opacity=1,g.changePostionWithMap()}),this.isCreateMap=!0}else{this.mapView=document.createElement("div");var c=this.map=new twaver.gis.Map(this.mapView,"MapView");c.setSize({width:document.documentElement.clientWidth,height:document.documentElement.clientHeight}),c.setEnableDoubleZoom(!1),c.addLayer("BINGMAP",GISConsts.EXECUTOR_TYPE_BINGMAP),c.setZoomLevel(5),c.setCenter(new twaver.gis.geometry.GeoCoordinate(31.41,121.48)),this.adapter=new twaver.gis.Adapter,this.isCreateMap=!0}},changePostionWithMap:function(){if(a.BMap){var b=this;this.network.getElementBox().forEach(function(a){if(a instanceof twaver.Node){var c=a.getClient("coordinate"),d=b.map.pointToPixel(c);a.setCenterLocation(d.x,d.y)}})}},clearContainer:function(){var a=this.container.childNodes;if(a&&a.length>0)for(var b=0;b<a.length;b++)this.container.removeChild(a[b])},bindGIS:function(){null!=this.isGis&&this.isGis||(this.isCreateMap||this.createMap(),this.adapter&&this.map&&this.adapter.bindNetworkAndMap(this.network,this.map),this.clearContainer(),this.container.appendChild(this.mapView),this.network.getView().removeEventListener("dblclick",this.dbClickHandle),a.BMap?this.map.addEventListener("dblclick",this.dbClickHandle):this.map.getView().addEventListener("dblclick",this.dbClickHandle),this.adjustViewBounds(),this.isGis=!0)},unbindGIS:function(){(null==this.isGis||this.isGis)&&(this.adapter&&this.adapter.unbindNetworkAndMap(),this.clearContainer(),this.container.appendChild(this.network.getView()),this.container.parentNode&&this.adjustViewBounds(),this.map&&(a.BMap?this.map.removeEventListener("dblclick",this.dbClickHandle):this.map.getView().removeEventListener("dblclick",this.dbClickHandle)),this.network.getView().addEventListener("dblclick",this.dbClickHandle),this.isGis=!1)},getContainer:function(){return this.container},removeGis:function(){this.unbindGIS(),this.hideNavigator(),this.hideOverView()},addGis:function(a,b){this.bindGIS(),a&&this.showNavigator(),b&&this.showOverView()},adjustViewBounds:function(b,c,d,e){arguments.length<1?(this.flag?this.flag++:this.flag=1,this.width=this.width+Math.pow(-1,parseInt(this.flag))):this.flag=0,this.left=d||this.left,this.top=e||this.top,this.width=b||this.width,this.height=c||this.height,this.network.adjustBounds({x:this.left,y:this.top,width:this.width,height:this.height}),this.isCreateMap&&this.map&&(a.BMap||(this.map.setSize({width:this.width,height:this.height}),this.map.content.style.left=this.left+"px",this.map.content.style.top=this.top+"px"))},setZoomLevel:function(b){b&&this.isCreateMap&&this.map&&(a.BMap||this.map.setZoomLevel(5))},setCenter:function(b){if(this.isCreateMap&&this.map&&b&&b.x&&b.y)if(a.BMap){var c=new BMap.Point(b.y,b.x);this.map.centerAndZoom(c,7)}else this.map.setCenter(new twaver.gis.geometry.GeoCoordinate(b.x,b.y))},showNavigator:function(b,c){if(this.isCreateMap&&!a.BMap){var d=document.getElementById("navigator_id");if(d)d.style.display="block";else{var e=new twaver.gis.gadget.Navigator("navigator_id",this.map);b||(b=20),c||(c=50),this.map.installGadget(e,{x:b,y:c})}}},hideNavigator:function(){if(this.isCreateMap){var a=document.getElementById("navigator_id");a&&(a.style.display="none")}},showOverView:function(c,d,e,f){if(this.isCreateMap&&!a.BMap)if(this.overview&&this.overview.getView())this.overview.getView().style.display="block";else{var g=this.overview=new twaver.gis.gadget.Overview("overview_id",this.map);(null==e||e==b||0>e)&&(e=150),(null==f||f==b||0>f)&&(f=150),g.setSize({width:e,height:f}),g.map.addLayer("BINGMAP",GISConsts.EXECUTOR_TYPE_BINGMAP),g.setBorder("1px solid red"),c=c?c-e+5:e+5,d=d?d-f+5:f+5,this.map.installGadget(g,{right:c,bottom:d})}},hideOverView:function(){this.overview&&this.overview.getView()&&(this.overview.getView().style.display="none")},registerNormalImage:function(a,b){var c=this,d=new Image;d.src=a,d.onload=function(){twaver.Util.registerImage(b,d,d.width/2,d.height/2),d.onload=null,c.network.invalidateElementUIs()}},setPosition:function(b,c,d){if(b)if(this.container.contains(this.mapView)){if(a.BMap){var e=new BMap.Point(d,c);b.setClient("coordinate",e);var f=this.map.pointToPixel(e);b.setCenterLocation(f.x,f.y)}else{var g=new twaver.gis.geometry.GeoCoordinate(parseInt(c)||0,parseInt(d)||0);b.setClient(GISSettings.GEOCOORDINATE,g)}this.setDefaultImage(b)}else b.setLocation(parseInt(c)||0,parseInt(d)||0)},setDefaultImage:function(a,b){if(a)if(1==b)a.setImage("b1");else if(2==b)a.setImage("b2");else if(3==b)a.setImage("b3");else{var c=parseInt(3*Math.random()+1);a.setImage("b"+c)}},getDataByNode:function(a){return a?this.sceneManager.getNodeData(a):null},handleDoubleClick:function(a){for(var b,c=a.element,d=0;d<this._eventHandlers.length;d++){b=this._eventHandlers[d];var e=this.getDataByNode(c);if(b.shouldHandleDoubleClickElement(c,this.network,e,a))return b.handleDoubleClickElement(c,this.network,e,a),void(this.focusData=e)}},handleDoubleClickBackground:function(){if(this.focusData&&this.focusData.getParentId()){var a=this.sceneManager.dataNodeMap[this.focusData.getParentId()];a&&this.sceneManager.viewManager3d.setFocusNode(a)}for(var b,c=0;c<this._eventHandlers.length;c++)if(b=this._eventHandlers[c],
b.shouldHandleDoubleClickBackground(this.network))return void b.handleDoubleClickBackground(this.network)},addEventHandler:function(a,c){return a instanceof d.EventHandler?c===b?this._eventHandlers.push(a):this._eventHandlers.splice(c,0,a):void 0},removeEventHandler:function(a){var b=this._eventHandlers.indexOf(a);-1!==b&&this._eventHandlers.splice(b,1)},createColumn:function(a,b,c,d,e,f){var g=new twaver.Column(b);return g.setName(b),g.setPropertyName(c),g.setPropertyType(d),e&&g.setValueType(e),f?g.setWidth(f):g.setClient("pack",!0),g.renderHeader=function(a){var b=document.createElement("span");b.style.whiteSpace="nowrap",b.style.verticalAlign="middle",b.style.padding="1px 2px 1px 2px",b.innerHTML=g.getName()?g.getName():g.getPropertyName(),b.setAttribute("title",b.innerHTML),b.style.font="bold 12px Helvetica",a.style.textAlign="center",a.appendChild(b)},a.getColumnBox().add(g),g},addTableAndTree:function(){var a=this.network.getView(),b=new twaver.controls.TablePane(this.table),c=b.getTableHeader().getView();c.style.backgroundColor="rgba(255,255,255,0.1)";var d=b.getView();d.style.position="absolute",d.style.bottom="30px",d.style.left="400px",d.style.width="500px",d.style.height="120px",a.appendChild(d);var e=this.tree.getView();e.style.position="absolute",e.style.top="30px",e.style.left="30px",e.style.width="160px",e.style.height="250px",a.appendChild(e),this.tree.getToggleImage=function(a){return a.getChildrenSize()>0?this.isExpanded(a)?"../images/collapse_icon.png":"../images/expand_icon.png":null},this.tree.getIcon=function(a){return null}},initTable:function(a){this.table.setEditable(!0),this.createColumn(this.table,"编号","toolTip","accessor","string").setWidth(80);var b=this.createColumn(this.table,"端口接入","toId","client","string",!0);b.setWidth(150),this.createColumn(this.table,"当前流量","flow","client","string",!0).setWidth(120);var c=this.createColumn(this.table,"启用日期","raisedTime","client","Date");c.setWidth(150),c.setHorizontalAlign("center"),c.renderCell=function(a){var b=document.createElement("span");b.innerHTML=d.Util.formatDate(a.value,"yyyy-MM-dd hh:mm:ss"),b.style.whiteSpace="nowrap",a.div.appendChild(b)}},refreshTable:function(){var a=this.network.getView(),b=new twaver.controls.TablePane(this.table),c=(b.getTableHeader().getView(),b.getView());c.style.position="absolute",c.style.bottom="30px",c.style.left="400px",c.style.width="500px",c.style.height="120px",a.appendChild(c)},showTable:function(a){this.table.getColumnBox().clear(),this.table.getView().style.display="block",this.table.setVisibleFunction(function(a){return a.getName()?!1:a.getName()||a.getToolTip()?a.getClient("group_id")?!1:!0:!1}),this.initTable(a),this.refreshTable()},showTree:function(a){this.tree.getView().style.display="block",this.tree.setLineType("dotted"),this.tree.setLineColor("#000000"),this.tree.setLineAlpha(1),this.tree.setLineThickness(.5),this.tree.setLineDash([1,1]),this.tree.setVisibleFunction(function(a){return a.getName()||a.getToolTip()?!0:!1}),this.tree.getLabel=function(a){return a.getToolTip()||a.getName()},this.tree.expandAll()}}),d.ViewManager2D=u,d.DefaultEarthScene=function(a,b){if(this.sceneManager=a,this.dataManager=this.sceneManager.dataManager,this.network=this.sceneManager.network3d,this.box=this.network.getDataBox(),this.camera=this.network.getCamera(),this.animates=[],this.defaultInteractions=null,this.scene=b,!this.scene)throw"scene can not be null '";this.earthDataMap=this.dataManager.getDataMapByCategory(this.scene.getCategoryId()),this.lightMaps=[],this.interactions=[],this.PIN_ICON_WIDTH=60,this.PIN_ICON_HEIGHT=40,this.rootData=null,this.init()},mono.extend(d.DefaultEarthScene,Object,{init:function(){this.initNetwork(),this.initDataBox()},initNetwork:function(){this.defaultInteractions=this.network.getInteractions();var a=new mono.DefaultInteraction(this.network);a.maxDistance=3e3,a.minDistance=600,this.interactions.push(a),this.network.setInteractions(this.interactions),this.network.orgIsSelectable=this.network.isSelectable,this.filterDoubleClickElement=this.sceneManager.viewManager3d.filterDoubleClickElement,this.box.clear(!0),this.box.add(new mono.AmbientLight(16777215)),this.resetCamera(),this.resetNetwork()},initDataBox:function(){for(var a in this.earthDataMap){var b=this.earthDataMap[a];b&&(this.rootData=b)}var f,g=this.dataManager.getDataTypeForData(this.rootData),h=g.getModel(),i=g.getModelParameters(),j=this.sceneManager.loadModel(h,i);if(j instanceof Array&&j.length>0)for(var k=0;k<j.length;k++)j[k].setClient("notLookAt",!0),"earth"==j[k].getClient("type")&&(f=j[k]),this.box.addByDescendant(j[k]);else f=j,f.setClient("notLookAt",!0),this.box.addByDescendant(j);f.setClient(d.SceneManager.CLIENT_IT_DATA,this.rootData),f.setClient(d.SceneManager.CLIENT_IT_DATA_ID,this.rootData.getId()),this.sceneManager.dataNodeMap[a]=f;var l=new c;f.s({"m.texture.image":l.getCanvas()});var m=function(){setTimeout(function(){l._loaded?f.s({"m.texture.image":l.getCanvas()}):m()},500)};m(),l.network.addViewListener(function(a){"validateEnd"===a.kind&&f.invalidateTexture()});var n=$("<div></div>").appendTo($(document.body)),o=10;n[0].style.cssText="position:absolute;display:none;border-style:solid;white-space:nowrap;z-index:9999999;transition:left 0.4s cubic-bezier(0.23, 1, 0.32, 1),top 0.4s cubic-bezier(0.23, 1, 0.32, 1);-webkit-transition:left 0.4s cubic-bezier(0.23, 1, 0.32, 1),top 0.4s cubic-bezier(0.23, 1, 0.32, 1);-moz-transition:left 0.4s cubic-bezier(0.23, 1, 0.32, 1),top 0.4s cubic-bezier(0.23, 1, 0.32, 1);-o-transition:left 0.4s cubic-bezier(0.23, 1, 0.32, 1),top 0.4s cubic-bezier(0.23, 1, 0.32, 1);background-Color:rgba(50,50,50,0.7);border-width:0px;border-color:#333;border-radius:4px;color:#fff;font:normal normal 14px sans-serif;line-height:21px;padding:5px 5px 5px 5px;;left:0px;top:0px;";var p=this;this.network.getRootView().addEventListener("mousemove",function(a){if(!a.which){var b=e.findFirstObjectByMouse(p.network,a);if(b){var c=l.overNode(b.uv);if(c){var d=a.clientY+o+"px",f=a.clientX+o+"px";c.text?n.css({top:d,left:f,display:"block"}).text(c.text):c.move&&n.css({top:d,left:f})}else n.css({display:"none"})}}}),this.createDataCenters()},resetCamera:function(){this.camera.look(0,0,0),this.camera.setPosition(0,2500,2600),this.camera.setFov(30);var a=this;this.camera.addPropertyChangeListener(function(b){if("position"===b.property){var c=a.camera.getPosition().length();c>1e3&&a.network.showingDataCenter&&(a.hideInfo(),a.network.showingDataCenter.swingAnimate.stop(!0),a.network.showingDataCenter=null),a.updateLocations(a.box,a.camera)}})},resetNetwork:function(){mono.addEventListener("mousemove","handleMouseMove",this.network.getRootView(),this),mono.addEventListener("click","handleClick",this.network.getRootView(),this),mono.addEventListener("mousedown","handleMouseDown",this.network.getRootView(),this);var a=this;this.sceneManager.viewManager3d.filterDoubleClickElement=function(b){return a.getFirstElement(b)},this.network.isSelectable=function(a){return!1}},refresh:function(){this.interactions&&this.network.setInteractions(this.interactions),this.resetNetwork(),this.resetCamera(),this.initDataBox(),this.sceneManager.viewManager3d.defaultMaterialFilter.removeByDescendant(this.rootData)},createDataCenters:function(){var a=this.rootData.getChildren();if(a&&a.size()>0){var b=this;a.forEach(function(a){b.createDataCenter(a)})}},transplate:function(a,b){b=parseFloat(b)-32,-180>=b&&(b=360+b),a=parseFloat(a),a>=0&&(a=90-a),0>a&&(a=-90-a);var c=Math.cos(a*Math.PI/180)*this.radius,d=Math.sin(a*Math.PI/180)*this.radius,e=Math.cos(b*Math.PI/180)*d,f=Math.sin(b*Math.PI/180)*d;return{x:f,y:c,z:e}},createDataCenter:function(a){if(a){var b=a.getPosition()||{x:0,y:0,z:0},c=b.x,e=b.y,f=b.z,g=this.dataManager.getDataTypeForData(a),h=g.getSimpleModel(),i=g.getSimpleModelParameters(),j=this.sceneManager.loadModel(h,i);j.p(c,e,f),j.setClient("name",a.getDescription()),j.setClient(d.SceneManager.CLIENT_IT_DATA,a),j.setClient(d.SceneManager.CLIENT_IT_DATA_ID,a.getId()),this.box.add(j);var k=this,l=new twaver.Animate({from:0,to:1,delay:1e3,dur:1500,easing:"elasticOut",onUpdate:function(a){var b=k.camera.getPosition().length(),c=b/2e3;j.setScale(a*k.PIN_ICON_WIDTH*c,a*k.PIN_ICON_HEIGHT*c,1)}}).play();this.animates.push(l),j.swingAnimate=new twaver.Animate({from:.5,to:1,dur:1500,interval:500,easing:"elasticOut",repeat:Number.POSITIVE_INFINITY,reverse:!1,onUpdate:function(a){var b=k.camera.getPosition().length(),c=b/2e3;j.setScale(a*k.PIN_ICON_WIDTH*c,a*k.PIN_ICON_HEIGHT*c,1)}}),this.animates.push(j.swingAnimate);var k=this;j.doubliClick=function(a,b,c,d){k.stopCurrentAnimates();var e=b.lastDataCenter.getClient("name");k.hideInfo(),b.showingDataCenter&&b.showingDataCenter.swingAnimate&&b.showingDataCenter.swingAnimate.stop(!0),b.showingDataCenter=null;var f=b.lastDataCenter.getClient("it_data_id")?b.lastDataCenter.getClient("it_data_id"):c.getId();k.showMap(e,f)}}},stopCurrentAnimates:function(){for(var a=this.animates.length-1;a>=0;a--){var b=this.animates[a];b&&b.stop()}},doPlay:function(){var a=make.Default.animateCameraPosition(this.camera,new mono.Vec3(400,1e3,1200),4e3);a.play(),this.animates.push(a)},clear:function(){if(this.animates&&this.animates.length>0)for(var a=0;a<this.animates.length;a++){var b=this.animates[a];b.stop()}this.animates=[],this.defaultInteractions&&this.network.setInteractions(this.defaultInteractions),this.clearNetwork()},clearNetwork:function(){mono.removeEventListener("mousemove",this.network.getRootView(),this),mono.removeEventListener("click",this.network.getRootView(),this),mono.removeEventListener("mousedown",this.network.getRootView(),this),this.filterDoubleClickElement&&(this.sceneManager.viewManager3d.filterDoubleClickElement=this.filterDoubleClickElement),this.orgIsSelectable&&(this.network.isSelectable=this.orgIsSelectable)},updateLocations:function(a,b){var c=this,d=b.getPosition().length(),e=d/2e3;a.forEach(function(a){"datacenter"===a.getClient("type")&&a.setScale(c.PIN_ICON_WIDTH*e,c.PIN_ICON_HEIGHT*e,1)})},getFirstElement:function(a){var b=function(a){return"datacenter"==a.getClient("type")?!0:!1};return this.network.getFirstElementByMouseEvent(a,!1,b)},handleMouseMove:function(a){var b=this.network,c=this.getFirstElement(a),d=this.camera.getPosition().length(),e=d/2e3;if(c){var f=c.element;if("datacenter"===f.getClient("type")){if(b.lastDataCenter===f)return;return b.lastDataCenter&&b.lastDataCenter.setScale(this.PIN_ICON_WIDTH*e,this.PIN_ICON_HEIGHT*e,1),f.setScale((this.PIN_ICON_WIDTH+5)*e,(this.PIN_ICON_HEIGHT+5)*e,1),b.lastDataCenter=f,void(b.getRootView().style.cursor="pointer")}}b.lastDataCenter&&b.lastDataCenter.setScale(this.PIN_ICON_WIDTH*e,this.PIN_ICON_HEIGHT*e,1),b.lastDataCenter=null,b.getRootView().style.cursor="default"},handleClick:function(a){var b=this,c=this.network,e=this.camera,f=this.getFirstElement(a);if(f){var g=f.element;if(c.lastDataCenter=g,c.lastDataCenter){if(c.lastDataCenter===c.showingDataCenter)return;c.getRootView().style.cursor="default",twaver.Util.stopAllAnimates(!0);var h=c.lastDataCenter,i=c.lastDataCenter.getClient("name"),j=c.lastDataCenter.getPosition().clone(),k=c.lastDataCenter.getClient(d.SceneManager.CLIENT_IT_DATA).getId(),l=1.3;c.lastSelectData=h;var m=make.Default.animateCameraPosition(e,new mono.Vec3(j.x*l,j.y*l,j.z*l),1e3,function(){b.showInfo(c,i,k),c.showingDataCenter=h,c.showingDataCenter.swingAnimate.play()});m.play(),this.animates.push(m)}}},handleMouseDown:function(a){var b=this.network;b.lastDataCenter!==b.showingDataCenter&&b.showingDataCenter&&(this.hideInfo(),b.showingDataCenter.swingAnimate.stop(!0),b.showingDataCenter=null)},showInfo:function(a,b,c){if(!document.getElementById("info")){var d=document.createElement("div");d.setAttribute("id","info"),d.style.position="absolute",d.style.zIndex="100",d.style.left="900px",d.style.top="250px",d.style.width="350px",d.style.height="250px",d.style.padding="10px",d.style.background="rgba(120,120,120,0.8)",d.style["border-radius"]="15px",d.style.border="1px",d.style["border-style"]="solid",d.style["border-color"]="rgba(200,200,200,0.8)",d.style["-webkit-user-select"]="none",d.style.display="none",document.body.appendChild(d);var e=document.createElement("h1");e.setAttribute("id","info_title"),e.setAttribute("align","center"),e.style["font-family"]="Microsoft Yahei",e.style["font-weight"]="normal",e.style["font-size"]="36px",e.style.margin="0px",e.style.color="white",d.appendChild(e),d.appendChild(document.createElement("hr"));var f=document.createElement("a");f.setAttribute("href","#"),d.appendChild(f);var g=document.createElement("img");g.setAttribute("src","images/map/"+c+"/icon.jpg"),g.setAttribute("id","img_city"),g.style.width="110px",g.style.position="absolute",g.style.border="3px solid rgb(220, 221, 219)",f.appendChild(g);var h=document.createElement("div");h.setAttribute("align","right"),h.innerHTML='<br>机柜总数：1,200<br>服务器：54,000<br>PUE：<font style="font-size:30px;color:#D0F5A9"><b id="pue"></b></font>',h.style["margin-top"]="40px",h.style["font-family"]="Microsoft Yahei",h.style["font-size"]="25px",h.style.color="white",d.appendChild(h)}var i=document.getElementById("info");i.style.transform="scaleY(0)",i.style.left=document.body.clientWidth/2+50+"px",i.style.display="block";var j=document.getElementById("info_title");j.innerHTML=b;var k=document.getElementById("pue");k.innerHTML=parseInt(100+200*Math.random())/100;var l=this,g=document.getElementById("img_city");g.setAttribute("src","images/map/"+c+"/icon.jpg"),g.onclick=function(){l.hideInfo(),a.getRootView().style.cursor="default",a.showingDataCenter.swingAnimate.stop(!0),a.showingDataCenter=null,l.clearNetwork(),l.showMap(b,c)};var m=new twaver.Animate({from:0,to:1,dur:1200,easing:"elasticOut",onUpdate:function(a){i.style.transform="scaleY("+a+")"}});m.play(),this.animates.push(m)},hideInfo:function(){var a=document.getElementById("info");if(a){var b=new twaver.Animate({from:0,to:1,dur:200,easing:"easeOutStrong",onUpdate:function(b){a.style.transform="scaleY("+(1-b)+")"},onDone:function(){a.style.display="none",a.style.cursor="default"}});b.play(),this.animates.push(b)}},showMap:function(a,b){var c=this,e=document.getElementById("map"),f=this.dataManager.getDataById(b);if(f||(f=this.network.lastSelectData.getClient(d.SceneManager.CLIENT_IT_DATA)),!f||!f.getChildren()||f.getChildren().size()<1)return void(this.network.lastSelectData=null);if(this.clearNetwork(),e)c.playMap(e);else{e=document.createElement("canvas"),e.setAttribute("id","map"),e.style.zIndex=10,e.style.position="absolute",e.style.left="60px",e.style.top="60px",e.addEventListener("click",function(){e.style.display="none"}),document.body.appendChild(e),b||(b="default");for(var g=[],h=0;12>=h;h++)g.push("images/map/"+b+"/"+h+".jpg");e.images=[],e.images.finished=0;for(var h=0;h<g.length;h++){var i=g[h],j=new Image;e.images.push(j),j.src=i,j.onload=function(){e.images.finished++,e.images.finished==e.images.length&&c.playMap(e)}}}},playMap:function(a){this.hideInfo();var b=this,c=this.network,e=c.getRootView().clientWidth,f=c.getRootView().clientHeight;a.width=e,a.height=f,a.style.display="block";var g=a.images,h=new twaver.Animate({from:0,to:g.length,dur:300*g.length,ease:"easeNone",onUpdate:function(b){var c=Math.floor(b);if(b<g.length){var d=g[c],h=a.getContext("2d"),i=b-c,j=-e*i/2,k=-f*i/2,l=e*(1+i),m=f*(1+i);h.drawImage(d,j,k,l,m)}},onDone:function(){c.earthCamera={p:b.camera.p(),t:b.camera.t()},b.gotoDownScene(c.lastSelectData.getClient(d.SceneManager.CLIENT_IT_DATA)),a.style.display="none",c.lastSelectData=null}});h.play(),this.animates.push(h)},gotoDownScene:function(a){this.clear();var b=this.dataManager.getCategoryForData(a),c=this.dataManager.getSceneByCategory(b);this.sceneManager._currentScene!=c&&(this.sceneManager.toScene(c,a),a&&this.sceneManager.viewManager3d.setFocusNode(this.sceneManager.dataNodeMap[a.getId()]))},adjustCameraPositionAndTarget:function(a){var b,c,d=main.sceneManager._currentScene._id;if(localStorage){var e,g="camera",h=localStorage.getItem(g);if(h&&""!=h&&(e=f.string2Object(h),e[d]))return b=e[d].position,c=e[d].target,a.lookAt(new mono.Vec3(c.x,c.y,c.z)),void a.setPosition(new mono.Vec3(b.x,b.y,b.z))}ServerUtil.api("camera","search",{id:d},function(d){d.length>0&&(b=f.string2Object(d[0].position),c=f.string2Object(d[0].target),a.lookAt(new mono.Vec3(c.x,c.y,c.z)),a.setPosition(new mono.Vec3(b.x,b.y,b.z)))})}});var v=c.prototype;v.getWidth=function(){return this._w},v.getHeight=function(){return this._h},v.init=function(){var a=this,b=this.box=new twaver.ElementBox,c=this.network=new twaver.vector.Network(b);document.body.appendChild(c.getView()),c.adjustBounds({x:0,y:0,width:a._w,height:a._h}),b.setStyle("background.type","vector").setStyle("background.vector.fill",!0).setStyle("background.vector.fill.color","#021428").setStyle("background.vector.stretch","fill").setStyle("background.outline.width",0).setStyle("background.outline.color","#021428");var d=new twaver.Layer("country"),e=new twaver.Layer("province"),f=new twaver.Layer("city"),g=b.getLayerBox();g.add(d),g.add(e),g.add(f),c.setMinZoom(1e-8),$(c.getView()).css({visibility:"hidden",marginTop:"-"+this._h+"px"});var a=this,h=a.decode(w);a.loadData(h,d.getId()),h=a.decode(x),a.loadData(h,e.getId()),_twaver.callLater(function(){c.zoomOverview(),a._loaded=!0})},v.getImage=function(){var a=this.network.getUnionBounds(),b=this.network.getZoom(),c=this.network.toCanvas(this._w,this._h,null,b,a.x,a.y);return c.toDataURL("image/png")},v.getCanvas=function(){return this.network.getRootCanvas()},v.getNode=function(a){var b=this.network,c=b.getViewRect(),d=b.getZoom(),e=c.width/d*a.x+c.x/d,f=c.height/d*(1-a.y)+c.y/d;if(null!=b.visibleList)for(var g=b.visibleList.size(),h=g-1;h>=0;h--){var i=b.visibleList.get(h),j=b.getElementUI(i);if(j&&j.hit(e,f))return i}},v.overNode=function(a){var b=this.getNode(a);return b===this._lastN?{move:!0}:(this._lastN&&b!==this._lastN&&"province"===this._lastN.getLayerId()&&this._lastN.setStyle("vector.fill.color",this._lastNoldColor),b&&b.getLayerId()&&"province"===b.getLayerId()&&(this._lastNoldColor=b.getStyle("vector.fill.color"),b.setStyle("vector.fill.color","orange")),this._lastN=b,b?{text:b.getToolTip()}:void 0)},v.loadData=function(a,b){var c=this;a.features.forEach(function(a){var d=new twaver.ShapeNode(a.id);d.setLayerId(b),d.setStyle("vector.fill",!0).setStyle("vector.fill.color","#474753").setStyle("vector.outline.color","#9ab0e6").setStyle("select.color","#FFFFFF").setStyle("vector.outline.width",3),"province"===b&&d.setStyle("vector.outline.color","orange").setStyle("vector.outline.width",3),d.setToolTip(a.properties.name);var e=new twaver.List,f=new twaver.List;"MultiPolygon"===a.geometry.type?a.geometry.coordinates.forEach(function(a){a.forEach(function(a){e.add("moveto"),a.forEach(function(a,b){0!==b&&e.add("lineto"),f.add(c.convertPoint(a))})})}):"Polygon"===a.geometry.type?a.geometry.coordinates.forEach(function(a){e.add("moveto"),a.forEach(function(a,b){0!==b&&e.add("lineto"),f.add(c.convertPoint(a))})}):console.log(a.geometry.type),d.setSegments(e),d.setPoints(f),c.box.add(d)})},v.convertPoint=function(a){return{x:100*(a[0]-117),y:100*(-a[1]+31.7)}},v.decode=function(a){var b=this;if(!a.UTF8Encoding)return a;for(var c=a.features,d=0;d<c.length;d++)for(var e=c[d],f=e.geometry,g=f.coordinates,h=f.encodeOffsets,i=0;i<g.length;i++){var j=g[i];if("Polygon"===f.type)g[i]=b.decodePolygon(j,h[i]);else if("MultiPolygon"===f.type)for(var k=0;k<j.length;k++){var l=j[k];j[k]=b.decodePolygon(l,h[i][k])}}return a.UTF8Encoding=!1,a},v.decodePolygon=function(a,b){for(var c=[],d=b[0],e=b[1],f=0;f<a.length;f+=2){var g=a.charCodeAt(f)-64,h=a.charCodeAt(f+1)-64;g=g>>1^-(1&g),h=h>>1^-(1&h),g+=d,h+=e,d=g,e=h,c.push([g/1024,h/1024])}return c};var w={type:"FeatureCollection",features:[{geometry:{type:"Polygon",coordinates:[[[74.54140625000002,37.02216796875],[74.00185546875002,36.823095703125],[73.769140625,36.888476562499996],[72.62285156250002,36.82958984375],[71.62050781250002,36.436474609375],[71.18505859375,36.04208984375],[71.42753906250002,35.833740234375],[71.62050781250002,35.183007812499994],[70.96562500000002,34.53037109375],[71.05156250000002,34.049707031249994],[69.86806640625002,33.89765625],[70.2841796875,33.369042968749994],[69.92011718750001,33.1125],[69.5015625,33.020068359374996],[69.24140625000001,32.433544921875],[69.279296875,31.936816406249996],[68.86894531250002,31.634228515624997],[68.21396484375,31.807373046875],[67.57822265625,31.506494140624994],[67.28730468750001,31.217822265624996],[66.92431640625,31.305615234374997],[66.39716796875001,30.91220703125],[66.17705078125002,29.835595703124994],[65.09550781250002,29.559472656249994],[64.52109375,29.564501953124996],[64.09873046875,29.391943359375],[63.56757812500001,29.497998046874997],[62.4765625,29.408349609374994],[62.37343750000002,29.425390625],[61.22441406250002,29.749414062499994],[60.843359375000006,29.858691406249996],[61.104101562500006,30.12841796875],[61.55947265625002,30.599365234375],[61.7841796875,30.831933593749994],[61.81083984375002,30.913281249999997],[61.81425781250002,31.072558593749996],[61.75507812500001,31.285302734374994],[61.66015625,31.382421875],[61.34648437500002,31.421630859375],[61.11074218750002,31.451123046874997],[60.854101562500006,31.483251953125],[60.82929687500001,32.249414062499994],[60.71044921875,32.599999999999994],[60.57656250000002,32.994873046875],[60.560546875,33.137841796874994],[60.9169921875,33.505224609375],[60.485937500000006,33.7119140625],[60.48574218750002,34.094775390624996],[60.72626953125001,34.51826171875],[60.802343750000006,34.554638671875],[60.91474609375001,34.633984375],[60.951171875,34.653857421874996],[61.080078125,34.855615234374994],[61.18925781250002,35.31201171875],[61.3447265625,35.6294921875],[61.54277343750002,35.457861328125],[62.61054687500001,35.233154296875],[62.688085937500006,35.255322265625],[62.72265625,35.271337890625],[62.858007812500006,35.349658203124996],[62.98027343750002,35.4091796875],[63.056640625,35.44580078125],[63.08417968750001,35.56806640625],[63.16972656250002,35.678124999999994],[63.15078125000002,35.728271484375],[63.129980468750006,35.766748046874994],[63.10859375000001,35.818701171875],[63.129980468750006,35.84619140625],[63.17890625000001,35.858447265624996],[63.30166015625002,35.8583984375],[63.86250000000001,36.012353515624994],[64.18437500000002,36.14892578125],[64.51103515625002,36.340673828125],[64.6025390625,36.554541015625],[64.75312500000001,36.964794921875],[64.78242187500001,37.05927734375],[64.81630859375002,37.132080078125],[64.95156250000002,37.1935546875],[65.08964843750002,37.237939453124994],[65.30361328125002,37.24677734375],[65.55498046875002,37.251171875],[65.76503906250002,37.569140624999996],[66.1083984375,37.41474609375],[66.35029296875001,37.3681640625],[66.47187500000001,37.3447265625],[66.52226562500002,37.348486328125],[66.827734375,37.3712890625],[67.06884765625,37.334814453125],[67.19550781250001,37.235205078125],[67.31972656250002,37.2095703125],[67.44169921875002,37.2580078125],[67.51728515625001,37.266650390624996],[67.546484375,37.235644531249996],[67.607421875,37.222509765625],[67.70000000000002,37.22724609375],[67.7529296875,37.1998046875],[67.75898437500001,37.172216796875],[67.76601562500002,37.14013671875],[67.83447265625,37.064208984375],[67.9580078125,36.972021484375],[68.06777343750002,36.9498046875],[68.21210937500001,37.021533203124996],[68.38691406250001,37.137499999999996],[68.66914062500001,37.2583984375],[68.96044921875,37.325048828125],[69.18017578125,37.15830078125],[69.26484375000001,37.1083984375],[69.30390625000001,37.116943359375],[69.35380859375002,37.150048828124994],[69.41445312500002,37.207763671875],[69.4296875,37.290869140625],[69.39921875000002,37.399316406249994],[69.42011718750001,37.486718749999994],[69.49208984375002,37.553076171875],[69.62578125000002,37.594042968749996],[69.8208984375,37.6095703125],[69.9849609375,37.566162109375],[70.25146484375,37.66416015625],[70.41777343750002,38.075439453125],[70.87890625,38.456396484375],[71.255859375,38.306982421875],[71.33271484375001,38.170263671875],[71.2828125,38.00791015625],[71.27851562500001,37.918408203125],[71.319921875,37.90185546875],[71.3896484375,37.906298828124996],[71.48779296875,37.931884765625],[71.55195312500001,37.933154296874996],[71.58222656250001,37.910107421875],[71.58037109375002,37.8642578125],[71.50507812500001,37.602929687499994],[71.43291015625002,37.1275390625],[71.530859375,36.845117187499994],[71.665625,36.696923828124994],[72.65742187500001,37.029052734375],[72.8955078125,37.267529296875],[73.21113281250001,37.408496093749996],[73.38291015625,37.462255859375],[73.48134765625002,37.4716796875],[73.60468750000001,37.446044921875],[73.63261718750002,37.43720703125],[73.65712890625002,37.430468749999996],[73.72060546875002,37.418749999999996],[73.71728515625,37.329443359375],[73.749609375,37.231787109375],[74.16708984375,37.329443359375],[74.20351562500002,37.372460937499994],[74.25966796875002,37.415429687499994],[74.65937500000001,37.394482421875],[74.37216796875,37.15771484375],[74.37617187500001,37.137353515624994],[74.49794921875002,37.0572265625],[74.52646484375,37.030664062499994],[74.54140625000002,37.02216796875]]]},properties:{name:"Afghanistan",childNum:1}},{geometry:{type:"MultiPolygon",coordinates:[[[[17.57958984375,-8.099023437500009],[17.643359375000017,-8.090722656250009],[18.00878906250003,-8.107617187499983],[18.56269531250001,-7.9359375000000085],[18.89833984375008,-7.998144531249977],[18.944433593750063,-8.001464843750028],[19.142675781250034,-8.001464843750028],[19.34082031249997,-7.966601562500031],[19.369921875000045,-7.706542968749986],[19.371679687500063,-7.655078124999989],[19.527636718750017,-7.144433593749952],[19.87519531250004,-6.986328124999986],[19.99746093750008,-6.976464843750023],[20.190039062500063,-6.9462890625],[20.482226562500074,-6.915820312500017],[20.59003906250001,-6.919921874999957],[20.598730468750006,-6.935156249999949],[20.536914062500045,-7.1217773437499545],[20.558398437500045,-7.244433593749989],[20.60781250000008,-7.277734375000023],[20.910937500000017,-7.281445312499983],[21.190332031250023,-7.284960937499989],[21.751074218750034,-7.305468749999989],[21.905371093750034,-8.693359374999943],[21.813183593750068,-9.46875],[22.19775390625,-10.040624999999977],[22.274511718750006,-10.259082031249974],[22.30244140625001,-10.39667968750004],[22.203515625000023,-10.829492187500009],[22.226171875000006,-11.121972656250009],[23.156738281250057,-11.074804687499991],[23.400195312500017,-10.976464843750023],[23.55996093750005,-10.97861328125002],[23.696386718750034,-11.007617187499974],[23.83388671875008,-11.013671874999972],[23.96650390625001,-10.871777343750011],[24.046679687500074,-11.405371093750006],[23.991308593750006,-12.422167968750031],[23.90937500000001,-12.636132812500009],[23.843164062500023,-13.0009765625],[22.209570312500006,-13.0009765625],[21.97890625000008,-13.0009765625],[21.979101562500034,-13.477734374999969],[21.979101562500034,-13.798730468749994],[21.979296875000074,-14.11962890625],[21.979394531249994,-14.440527343750006],[21.97949218750003,-14.761425781250011],[21.979589843750034,-15.082324218750017],[21.979687500000068,-15.403222656250023],[21.97978515624999,-15.724121093750028],[21.97978515624999,-15.955566406250014],[22.15068359374999,-16.597167968749986],[22.193945312500006,-16.628124999999983],[22.305078125000023,-16.689550781249977],[22.955859375000074,-17.28574218750002],[23.181640625000057,-17.474414062500003],[23.380664062500017,-17.64062500000003],[23.06826171875005,-17.698828124999977],[22.624023437500057,-17.78164062499998],[22.32421875,-17.83749999999999],[21.96083984375005,-17.90517578125001],[21.41689453125008,-18.00068359375001],[20.625097656250063,-17.99667968749999],[20.507617187500017,-17.95253906249998],[20.392968750000023,-17.887402343750026],[19.076464843750045,-17.81767578125003],[18.825976562500074,-17.766308593750054],[18.718066406250045,-17.70322265624999],[18.39638671875005,-17.3994140625],[17.83535156250005,-17.392773437499983],[17.296289062500023,-17.391992187499994],[16.913671875000034,-17.39140624999996],[16.531054687500074,-17.390820312500026],[16.14843750000003,-17.39023437499999],[15.765820312500068,-17.389648437499957],[13.93798828125,-17.388769531249963],[13.403710937500051,-17.00781249999997],[13.101171875000063,-16.967675781249966],[12.548144531250017,-17.212695312499974],[12.35927734375008,-17.205859375000003],[12.318457031250006,-17.21337890625003],[12.213378906250028,-17.209960937500043],[12.013964843750074,-17.168554687500034],[11.902539062500011,-17.226562499999957],[11.743066406250023,-17.24921875000004],[11.780078125000017,-16.87128906249997],[11.818945312500034,-16.704101562500014],[11.750878906250023,-15.831933593749966],[11.967871093750006,-15.63398437500004],[12.280468750000011,-14.637499999999989],[12.55048828125004,-13.437792968750003],[12.983203124999989,-12.775683593750017],[13.4169921875,-12.52041015624998],[13.785351562499983,-11.81279296874996],[13.847460937500045,-11.054394531249997],[13.20937500000008,-9.703222656249977],[12.99853515625,-9.048046874999997],[13.358984375000006,-8.687207031250026],[13.378515625000063,-8.369726562500006],[12.862304687500057,-7.231835937499994],[12.82343750000004,-6.9547851562499545],[12.521289062500045,-6.590332031249957],[12.302539062500074,-6.092578124999989],[13.346484375000017,-5.863378906250006],[13.978515625,-5.857226562500003],[14.398632812500068,-5.89267578125002],[15.726953125000051,-5.86386718750002],[16.060156250000063,-5.864941406249969],[16.315234375000074,-5.865625000000023],[16.431445312500045,-5.90019531249996],[16.53710937499997,-5.9658203125],[16.63955078125008,-6.114550781250017],[16.697265625,-6.164257812500026],[16.71777343750003,-6.241406250000011],[16.70937500000008,-6.471679687499943],[16.74296874999999,-6.618457031250003],[16.813085937500063,-6.772558593749963],[16.919433593750057,-6.93398437499998],[16.98476562500005,-7.257421874999977],[17.57958984375,-8.099023437500009]]],[[[12.255273437500023,-5.746484374999994],[12.018359375000074,-5.004296874999966],[12.384570312500074,-4.619140625000014],[12.829687499999977,-4.73662109374996],[12.573535156250017,-4.996582031249986],[12.502734375000074,-5.036914062500031],[12.451464843750017,-5.071484374999969],[12.453222656250034,-5.09062499999996],[12.52236328125008,-5.148925781250028],[12.518945312499994,-5.424609374999974],[12.503710937500017,-5.695800781249972],[12.255273437500023,-5.746484374999994]]]]},properties:{name:"Angola",childNum:2}},{geometry:{type:"Polygon",coordinates:[[[20.06396484375,42.547265624999994],[20.485449218750006,42.223388671875],[20.566210937500017,41.873681640624994],[20.48896484375001,41.272607421874994],[20.964257812500023,40.849902343749996],[20.95576171875001,40.775292968749994],[20.881640625000017,40.467919921874994],[20.4560546875,40.065576171874994],[20.382421875000006,39.802636718749994],[20.001269531250017,39.709423828125],[19.851855468750017,40.0435546875],[19.39814453125001,40.28486328125],[19.44062500000001,41.424755859375],[19.342382812500006,41.869091796875],[19.280664062500023,42.17255859375],[19.65449218750001,42.628564453124994],[20.06396484375,42.547265624999994]]]},properties:{name:"Albania",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[56.29785156250003,25.650683593750045],[56.38798828125002,24.97919921875004],[56.06386718750005,24.73876953125],[55.795703125000074,24.868115234374955],[55.76083984375006,24.24267578125],[55.1999023437501,23.034765625000034],[55.185839843750074,22.7041015625],[55.104296875000074,22.621484375000023],[52.55507812500005,22.932812499999955],[51.592578125000074,24.07885742187503],[51.56835937500003,24.286181640625074],[51.906054687500074,23.98535156249997],[52.64824218750002,24.154638671875006],[53.89335937500002,24.077050781249994],[54.39707031250006,24.278173828125034],[54.74677734375004,24.810449218750023],[55.09814453124997,25.041601562500034],[55.522851562499994,25.498144531249977],[55.94121093750002,25.793994140625017],[56.080468749999994,26.06264648437505],[56.29785156250003,25.650683593750045]]]
},properties:{name:"United Arab Emirates",childNum:1}},{geometry:{type:"MultiPolygon",coordinates:[[[[-68.65322265624994,-54.85361328124999],[-68.62993164062499,-52.65263671875004],[-68.27822265625002,-52.98398437500004],[-68.00849609374995,-53.5640625],[-67.29423828125002,-54.049804687500014],[-65.34599609374993,-54.87792968749997],[-66.5111328125,-55.032128906249945],[-66.93046874999999,-54.92490234375004],[-68.65322265624994,-54.85361328124999]]],[[[-61.084716796875,-23.65644531250001],[-60.83984375000003,-23.85810546874997],[-59.89248046874994,-24.093554687499974],[-59.60859375000001,-24.26679687500001],[-59.372949218749966,-24.45390625000003],[-58.72402343750002,-24.786621093749957],[-58.519628906250034,-24.84287109375005],[-58.422802734374926,-24.894140625000006],[-58.365380859374966,-24.95927734374996],[-57.82167968749994,-25.136425781249983],[-57.58715820312494,-25.405078125000003],[-57.943115234375,-26.05292968750001],[-58.19130859375002,-26.629980468749977],[-58.31767578125002,-26.79589843750003],[-58.33466796875001,-26.824902343749983],[-58.32255859374993,-26.857617187499983],[-58.64174804687494,-27.196093750000017],[-58.60483398437498,-27.314355468750037],[-58.16826171874993,-27.27343749999997],[-57.11181640625,-27.47011718749998],[-56.437158203124966,-27.553808593749977],[-56.16406250000003,-27.321484374999983],[-55.789990234374926,-27.416406249999966],[-55.426660156249994,-27.00927734374997],[-54.934472656249994,-26.70253906250001],[-54.677734375,-26.308789062499997],[-54.631933593750006,-26.005761718749994],[-54.615869140624994,-25.576074218750023],[-54.15458984374999,-25.523046874999963],[-53.89116210937499,-25.66884765625001],[-53.67128906249994,-26.22509765625],[-53.83818359375002,-27.121093750000014],[-54.32700195312495,-27.423535156249997],[-54.82910156250003,-27.55058593750003],[-55.10151367187501,-27.866796874999963],[-55.72548828125002,-28.20410156250003],[-56.938623046874994,-29.594824218750034],[-57.60888671875003,-30.187792968750045],[-57.87250976562501,-30.591015625000026],[-57.81059570312499,-30.85859375000001],[-58.18901367187499,-31.924218750000037],[-58.12304687499997,-32.32187499999996],[-58.201171875,-32.471679687500014],[-58.219970703125,-32.563964843749986],[-58.17099609374998,-32.95927734374996],[-58.424462890624994,-33.11152343749998],[-58.54721679687498,-33.66347656249998],[-58.28334960937494,-34.68349609375005],[-57.303662109374926,-35.188476562499986],[-57.15888671875001,-35.505957031250006],[-57.35390624999994,-35.72031249999998],[-57.26499023437495,-36.14414062499999],[-56.698095703125006,-36.42646484375004],[-56.67202148437494,-36.85126953124998],[-57.39575195312494,-37.74462890625],[-57.546972656250034,-38.085644531250026],[-58.17919921874994,-38.435839843750045],[-59.82832031250001,-38.83818359375003],[-61.112207031249994,-38.99296875000003],[-62.06689453125,-38.91914062500001],[-62.33808593749998,-39.1505859375],[-62.053662109374955,-39.373828125],[-62.28691406249996,-39.89531250000002],[-62.39501953124997,-40.89082031249997],[-62.95903320312493,-41.10966796875006],[-63.77299804687493,-41.150000000000006],[-64.85297851562495,-40.81376953124999],[-65.13339843749998,-40.88066406250003],[-65.05908203125003,-41.96992187499998],[-64.42041015625003,-42.43378906249998],[-63.59589843750001,-42.40654296875003],[-63.69248046874998,-42.80527343749999],[-64.13066406249996,-42.86142578124998],[-64.65048828125,-42.53144531249998],[-65.02690429687496,-42.75888671874996],[-64.43222656250003,-43.059179687500034],[-64.98554687499995,-43.29355468749999],[-65.28359375000002,-43.62998046874996],[-65.36127929687495,-44.47734375000002],[-65.64760742187502,-44.661425781250045],[-65.63876953125,-45.0078125],[-66.19013671874995,-44.96474609375002],[-66.94140625,-45.25732421875003],[-67.556640625,-45.97011718750002],[-67.56337890624997,-46.34541015625001],[-66.77685546874994,-47.005859375],[-65.99853515625,-47.09374999999997],[-65.73808593749999,-47.34492187499998],[-65.81005859374997,-47.941113281250026],[-67.03310546875002,-48.627734375000024],[-67.68486328125002,-49.2466796875],[-67.78349609374996,-49.85888671875002],[-68.939453125,-50.382324218749986],[-69.23515625000002,-50.95058593750003],[-69.03251953124993,-51.63623046875],[-68.443359375,-52.35664062500004],[-69.96025390624993,-52.00820312500002],[-71.91865234374995,-51.98955078125004],[-72.40766601562501,-51.54082031250002],[-72.27631835937498,-50.910253906249984],[-72.50981445312496,-50.607519531250034],[-73.15292968749998,-50.73828125000003],[-73.50126953124996,-50.125292968750024],[-73.57626953124998,-49.582910156250016],[-72.61440429687494,-48.79287109375],[-72.35473632812497,-48.36582031250005],[-72.517919921875,-47.87636718749998],[-72.34594726562497,-47.49267578124997],[-71.90498046875001,-47.201660156250014],[-71.94023437499999,-46.831250000000054],[-71.69521484375,-46.57841796875006],[-71.87568359374998,-46.16054687500001],[-71.77265624999995,-45.724414062499974],[-71.35375976562497,-45.23046874999997],[-71.5962890625,-44.97919921875004],[-71.26113281250002,-44.763085937499966],[-71.21259765624998,-44.44121093750003],[-71.82001953124993,-44.38310546875],[-71.68007812500002,-43.92958984374998],[-71.90498046875001,-43.44013671875001],[-71.781494140625,-43.16679687500002],[-72.14643554687498,-42.990039062499974],[-72.12460937499998,-42.298339843750014],[-71.76093749999998,-42.101464843749966],[-71.91127929687497,-41.650390624999986],[-71.93212890624994,-40.69169921874999],[-71.69531250000003,-40.33525390625003],[-71.71992187499995,-39.63525390624997],[-71.53945312499997,-39.60244140624995],[-71.42558593749996,-38.98564453125006],[-70.95161132812493,-38.73847656249997],[-71.028173828125,-38.041210937500026],[-71.16757812499998,-37.76230468749996],[-71.05551757812498,-36.52373046874996],[-70.40478515625,-36.06171874999998],[-70.47041015624995,-35.32617187499997],[-70.28994140624997,-34.732812499999966],[-69.85244140625,-34.224316406250026],[-69.79775390624997,-33.398632812500026],[-70.01982421874999,-33.27148437499997],[-70.16962890624995,-32.471679687500014],[-70.585205078125,-31.569433593749963],[-70.51958007812493,-31.1484375],[-70.16142578124999,-30.44023437499996],[-69.95634765624996,-30.35820312500003],[-69.92763671874997,-29.76914062500002],[-70.02680664062501,-29.324023437500017],[-69.82788085937497,-29.10322265624997],[-69.65693359374995,-28.413574218749986],[-69.17441406249998,-27.924707031250037],[-68.84633789062494,-27.153710937499994],[-68.34599609374996,-27.02792968750005],[-68.58115234375,-26.518359374999974],[-68.41450195312498,-26.153710937500023],[-68.60029296874998,-25.48564453124999],[-68.38422851562495,-25.091894531249977],[-68.56201171875,-24.83769531249996],[-68.25029296875002,-24.391992187500023],[-67.35620117187503,-24.033789062499963],[-67.00878906249994,-23.00136718750005],[-67.19487304687493,-22.821679687500037],[-66.99111328125,-22.509863281250006],[-66.71171874999999,-22.216308593749986],[-66.36518554687501,-22.113769531249957],[-66.32246093750001,-22.053125000000037],[-66.28212890624997,-21.94746093750001],[-66.24760742187496,-21.83046874999998],[-66.22016601562495,-21.802539062499974],[-66.174658203125,-21.805664062499986],[-66.09858398437495,-21.83505859375002],[-66.05859375,-21.87949218750002],[-65.86015624999999,-22.019726562499983],[-65.77104492187493,-22.099609375000014],[-65.68618164062497,-22.11025390625005],[-65.05781249999995,-22.102734375000026],[-64.60551757812499,-22.228808593750045],[-64.52363281250001,-22.37158203125],[-64.47773437499998,-22.485351562499986],[-64.44550781249998,-22.585351562500023],[-64.37397460937498,-22.761035156250017],[-64.32529296875,-22.82763671875],[-64.30791015624993,-22.795312499999994],[-64.26640625000002,-22.60332031249996],[-63.97612304687502,-22.072558593750003],[-63.92167968749993,-22.028613281250017],[-63.81865234374999,-22.00546875000002],[-62.843359375000006,-21.997265625000026],[-62.62597656250003,-22.29042968749998],[-62.54155273437496,-22.349609374999957],[-62.37250976562498,-22.439160156249997],[-61.798535156249955,-23.182031249999994],[-61.084716796875,-23.65644531250001]]]]},properties:{name:"Argentina",childNum:2}},{geometry:{type:"Polygon",coordinates:[[[46.490624999999994,38.90668945312498],[46.1144531250001,38.877783203125034],[45.76630859375004,39.37846679687499],[45.03164062500005,39.76513671874997],[44.76826171875004,39.70351562500005],[44.28925781250004,40.040380859375006],[43.79169921875004,40.07026367187498],[43.56933593750003,40.48237304687498],[43.72265624999997,40.71953124999999],[43.43945312500003,41.10712890625001],[44.077246093750006,41.182519531249994],[44.227343750000074,41.213330078124955],[44.473046874999994,41.191015625000034],[44.56484375000005,41.20820312499998],[44.841406250000006,41.21137695312501],[44.84853515625005,41.22016601562501],[44.810937499999994,41.248583984375045],[44.81132812500002,41.259375000000006],[44.97587890625002,41.277490234374966],[45.001367187499994,41.29096679687498],[45.58750000000006,40.846923828125],[45.37617187500004,40.63808593750002],[45.96464843750002,40.233789062499966],[45.789648437500006,39.88110351562497],[46.5500000000001,39.20141601562497],[46.490624999999994,38.90668945312498]]]},properties:{name:"Armenia",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[69.18486328125002,-49.10957031250004],[69.915625,-49.348535156249966],[69.612890625,-49.65097656250003],[68.87207031249997,-49.44433593750003],[69.18486328125002,-49.10957031250004]]]},properties:{name:"France",childNum:1}},{geometry:{type:"MultiPolygon",coordinates:[[[[145.04296875000003,-40.78671874999999],[145.28300781250002,-40.76992187500002],[146.31748046875006,-41.16347656250001],[146.98984375000006,-40.99238281249997],[147.45478515625004,-41.00166015624998],[147.96875000000003,-40.779589843750045],[148.29287109375,-40.947070312499974],[148.30146484375004,-42.03994140624995],[147.92441406250006,-42.5724609375],[147.980859375,-43.157031249999974],[147.40800781250002,-42.89384765625],[146.87392578125,-43.61250000000004],[146.04316406250004,-43.547167968749974],[145.26816406250006,-42.54433593749995],[145.23818359375,-42.01962890624999],[144.77792968750012,-41.41884765624998],[144.64609375000006,-40.98085937500001],[145.04296875000003,-40.78671874999999]]],[[[137.59648437500007,-35.73867187499998],[137.44843750000004,-36.07480468749999],[136.7550781250001,-36.03310546875002],[136.63867187499997,-35.74882812500002],[137.33408203125006,-35.59248046875004],[137.59648437500007,-35.73867187499998]]],[[[136.71464843750002,-13.803906249999983],[136.89433593750002,-14.293066406249977],[136.36328125000003,-14.228906249999966],[136.42470703125,-13.864843749999963],[136.71464843750002,-13.803906249999983]]],[[[130.6188476562501,-11.376074218749991],[131.26826171875004,-11.18984374999998],[131.53857421874997,-11.436914062500037],[130.95097656250007,-11.926464843750026],[130.644921875,-11.742382812500011],[130.6188476562501,-11.376074218749991]]],[[[143.17890625000004,-11.954492187499966],[143.11025390625,-12.303515625000017],[143.40156250000004,-12.639941406249989],[143.5866210937501,-13.443652343750031],[143.54843750000012,-13.74101562499996],[143.75634765625003,-14.348828124999969],[143.96181640625005,-14.462890625000028],[144.473046875,-14.231835937500023],[144.64804687500006,-14.492480468750017],[145.28769531250006,-14.943164062499989],[145.27158203125006,-15.476660156249963],[145.45800781250003,-16.05644531249996],[145.42607421875002,-16.406152343749966],[145.90195312500006,-17.070214843749994],[146.12587890625005,-17.63525390625],[146.03222656249997,-18.272851562500037],[146.3332031250001,-18.55371093749997],[146.48115234375004,-19.07871093749999],[147.13876953125006,-19.39316406250002],[147.41855468750012,-19.37812499999997],[147.91562500000006,-19.86923828125002],[148.75937500000006,-20.28955078125003],[148.68369140625012,-20.58017578124999],[149.20488281250007,-21.125097656249977],[149.70390625000002,-22.440527343750006],[150.07617187500003,-22.16445312499998],[150.54130859375002,-22.55908203125],[150.76386718750004,-22.576171875000014],[150.84316406250005,-23.4580078125],[151.50078125000002,-24.01240234374997],[151.902734375,-24.200976562500017],[152.12988281250003,-24.59755859374998],[152.45634765625007,-24.802441406249983],[152.91347656250005,-25.432128906250014],[153.16494140625,-25.964160156250045],[153.0841796875001,-26.303808593749963],[153.11679687500006,-27.194433593750034],[153.57568359375003,-28.24052734374999],[153.60458984375006,-28.854492187500014],[153.348046875,-29.29042968750001],[153.27236328125005,-29.89248046875001],[153.03056640625002,-30.563378906249994],[152.94394531250012,-31.43486328124999],[152.5592773437501,-32.045703125],[152.4704101562501,-32.439062500000034],[151.812890625,-32.90107421875001],[151.4837890625,-33.3474609375],[151.23154296875006,-34.02968749999998],[150.96035156250005,-34.29707031250001],[150.69033203125,-35.177734375000014],[150.19531249999997,-35.83359374999996],[149.96025390625002,-36.845507812499974],[149.93271484375012,-37.528515625000026],[149.29843750000012,-37.802148437499994],[148.26250000000002,-37.830664062500034],[147.39560546875006,-38.21914062499995],[146.8568359375,-38.663476562499966],[145.93535156250002,-38.90175781250002],[145.79082031250007,-38.66699218749997],[144.6652343750001,-38.20996093750003],[143.53896484375005,-38.82089843749998],[142.61210937500007,-38.451660156249986],[141.725,-38.27138671875002],[141.42421875,-38.36347656250004],[141.0109375000001,-38.07695312500003],[140.62724609375007,-38.02841796874999],[139.78427734375012,-37.24580078124998],[139.85732421875,-36.662109375],[139.54873046875,-36.0966796875],[139.03769531250006,-35.68925781249996],[138.18437500000002,-35.612695312499994],[138.5111328125,-35.02441406249996],[138.48994140625004,-34.76357421875002],[138.0892578125,-34.16982421875002],[137.69169921875002,-35.14296875000004],[136.88359375000007,-35.23974609375004],[137.01425781250012,-34.91582031250003],[137.39101562500005,-34.91328124999997],[137.49384765625004,-34.16113281250003],[137.9318359375001,-33.57910156250003],[137.85234375000007,-33.20078124999996],[137.44228515625,-33.1935546875],[137.23730468750003,-33.62949218749999],[136.43066406249997,-34.02998046875004],[135.64755859375006,-34.93964843750001],[135.18544921875005,-33.906738281249986],[134.79101562499997,-33.32832031250001],[134.30126953124997,-33.16503906249996],[134.10039062500007,-32.748632812500034],[134.23417968750007,-32.54853515625004],[133.55136718750012,-32.182910156249974],[133.21210937500004,-32.18378906249998],[132.75742187500012,-31.956249999999983],[132.21464843750002,-32.00712890624996],[131.72119140625003,-31.696289062499957],[131.14365234375006,-31.49570312500005],[130.78300781250002,-31.604003906249986],[130.12978515625,-31.579101562499986],[128.94619140625,-31.702636718750014],[128.06767578125002,-32.06650390624998],[127.31982421874997,-32.264062499999994],[125.91718750000004,-32.296972656250034],[124.75878906250003,-32.882714843749994],[124.12607421875006,-33.129394531249986],[123.65039062499997,-33.83632812500002],[123.20761718750012,-33.988281249999986],[122.7775390625001,-33.890820312500026],[121.40507812500007,-33.826757812500034],[119.85410156250012,-33.97470703124998],[119.45058593750005,-34.368261718750034],[118.89531250000007,-34.47988281250004],[118.13554687500002,-34.98662109374999],[117.58193359375005,-35.09775390624998],[116.51718750000012,-34.98789062499998],[115.98671875000005,-34.795019531250034],[115.7262695312501,-34.52607421875004],[115.00878906250003,-34.25585937499997],[115.18164062499997,-33.643457031249994],[115.5153320312501,-33.53134765624998],[115.68300781250005,-33.19287109375003],[115.6984375000001,-31.694531250000054],[115.17685546875006,-30.80800781250001],[114.99453125000005,-30.216210937499966],[114.95898437499997,-29.433593749999957],[114.53740234375007,-28.542871093750037],[114.16513671875012,-28.08066406250002],[114.02812500000007,-27.34726562499999],[113.58164062500006,-26.558105468749986],[113.85283203125007,-26.33212890625005],[113.58906250000004,-26.098632812499986],[113.539453125,-25.625195312499997],[114.21572265625,-26.289453124999966],[114.2142578125,-25.851562500000014],[113.67080078125,-24.97705078125003],[113.41767578125004,-24.435644531250034],[113.5529296875001,-23.732812500000023],[113.7570312500001,-23.418164062500054],[113.68281250000004,-22.637792968749963],[113.9583984375,-21.93916015625001],[114.16386718750002,-22.32333984375002],[114.37773437500007,-22.341503906249997],[114.85908203125004,-21.73593749999999],[115.45615234375012,-21.49169921874997],[116.0109375000001,-21.030371093749963],[116.7067382812501,-20.653808593749986],[117.40625000000003,-20.72119140625003],[118.19921875000003,-20.37519531249997],[118.75146484374997,-20.261914062499983],[119.10449218749997,-19.995312500000026],[119.58593750000003,-20.038281249999997],[120.87841796874997,-19.665039062499986],[121.49355468750005,-19.106445312499957],[121.83378906250002,-18.477050781249986],[122.23740234375006,-17.968554687500045],[122.16025390625006,-17.313671875000026],[122.72041015625004,-16.78769531249999],[122.97070312499997,-16.436816406250003],[123.52519531250007,-17.485742187499994],[123.77812500000007,-16.867773437499963],[123.4904296875001,-16.49072265624997],[124.5768554687501,-16.11367187499998],[124.38164062500002,-15.758203125000037],[124.83906250000004,-15.160742187500006],[125.24326171875006,-14.944531250000011],[125.17871093749997,-14.714746093749994],[125.68125000000012,-14.38798828124996],[126.0207031250001,-14.494531249999994],[126.11132812499997,-14.114062500000017],[126.5697265625,-14.160937499999974],[126.90322265625,-13.744140624999972],[127.67285156249997,-14.195117187500003],[128.19941406250004,-14.751757812499989],[129.45898437499997,-14.933203125000006],[129.75351562500006,-14.789550781249957],[129.37871093750002,-14.39248046874998],[129.70986328125,-13.979980468749972],[129.83886718749997,-13.572949218749997],[130.25976562500003,-13.30224609375],[130.1681640625001,-12.957421875000009],[130.67236328124997,-12.40693359375004],[131.43828125000002,-12.27695312500002],[132.37207031250003,-12.239160156249966],[132.58378906250002,-12.110253906249994],[132.6828125000001,-11.505566406249997],[133.02490234374997,-11.452832031249997],[133.18525390625004,-11.705664062499991],[133.90419921875,-11.832031249999972],[134.23710937500002,-12.00771484374998],[134.73027343750002,-11.984375000000014],[135.2179687500001,-12.221679687499957],[135.7884765625,-11.907031249999974],[136.08183593750007,-12.422460937500006],[136.5402343750001,-11.957617187499977],[136.94746093750004,-12.34990234374996],[136.53701171875,-12.784277343749991],[136.59433593750012,-13.003808593750051],[135.92734375000012,-13.304296874999977],[135.98955078125002,-13.810156250000006],[135.88339843750006,-14.153124999999974],[135.40517578125005,-14.758203124999966],[135.53076171874997,-15.000390625000023],[136.20537109375002,-15.403417968749963],[136.78466796874997,-15.89423828125004],[137.00214843750004,-15.878320312499994],[137.70371093750006,-16.233007812499963],[138.24501953125005,-16.718359374999977],[139.00986328125006,-16.899316406249994],[139.2484375,-17.328613281249957],[140.03583984375004,-17.702636718749957],[140.51113281250005,-17.62451171875003],[140.83046875,-17.414453125000037],[141.21914062500005,-16.646191406250026],[141.41191406250007,-16.069531250000054],[141.45156250000005,-15.605273437499974],[141.62548828124997,-15.056640625000014],[141.52294921875003,-14.470117187499994],[141.59433593750006,-14.152832031250014],[141.47255859375,-13.797558593750011],[141.64541015625,-13.259082031250003],[141.67773437500003,-12.491406250000011],[141.95156250000005,-11.896191406249997],[142.168359375,-10.946582031249974],[142.45644531250005,-10.707324218749989],[142.83681640625,-11.306933593750031],[142.87255859374997,-11.821386718750034],[143.17890625000004,-11.954492187499966]]]]},properties:{name:"Australia",childNum:5}},{geometry:{type:"Polygon",coordinates:[[[16.953125,48.598828125],[17.147363281250023,48.00595703125],[16.434375000000017,47.367431640625],[16.453417968750017,47.006787109375],[16.093066406250017,46.86328125],[15.957617187500006,46.677636718749994],[15.000683593750011,46.6259765625],[14.503515625000006,46.417041015624996],[13.700000000000017,46.520263671875],[13.490039062500017,46.555566406249994],[13.3515625,46.557910156249996],[13.168750000000017,46.572656249999994],[12.388281250000006,46.70263671875],[11.775683593750017,46.986083984375],[11.025097656250011,46.79697265625],[10.993261718750006,46.777001953124994],[10.927343750000006,46.769482421875],[10.828906250000017,46.775244140625],[10.759765625,46.793310546875],[10.689257812500017,46.84638671875],[10.579785156250011,46.8537109375],[10.479394531250023,46.855126953124994],[10.452832031250011,46.86494140625],[10.45458984375,46.8994140625],[10.414941406250023,46.964404296874996],[10.349414062500017,46.984765624999994],[9.996875000000017,46.8853515625],[9.580273437500011,47.057373046875],[9.527539062500011,47.270751953125],[9.524023437500006,47.524218749999996],[9.748925781250023,47.575537109375],[10.034082031250023,47.473583984375],[10.07421875,47.428515624999996],[10.066308593750023,47.393359374999996],[10.096484375000017,47.37958984375],[10.200292968750006,47.363427734374994],[10.312792968750017,47.313427734375],[10.403906250000006,47.4169921875],[10.430371093750011,47.541064453124996],[10.439453125,47.551562499999996],[10.482812500000023,47.541796874999996],[10.65869140625,47.547216796875],[10.873046875,47.52021484375],[11.297949218750006,47.42490234375],[11.716796875,47.58349609375],[12.685839843750017,47.669335937499994],[13.014355468750011,47.478076171874996],[12.953515625000023,47.890625],[13.215234375000023,48.301904296874994],[13.322851562500006,48.33125],[13.374609375000006,48.361376953124996],[13.409375000000011,48.394140625],[13.459863281250023,48.56455078125],[13.4716796875,48.571826171874996],[13.486621093750017,48.581835937499996],[13.675195312500023,48.523046875],[13.785351562500011,48.587451171874996],[13.798828125,48.6216796875],[13.802929687500011,48.747509765625],[13.814746093750017,48.766943359375],[14.049121093750017,48.602490234375],[14.691308593750023,48.59921875],[14.97216796875,48.983935546874996],[16.057226562500006,48.754785156249994],[16.477929687500023,48.800097656249996],[16.953125,48.598828125]]]},properties:{name:"Austria",childNum:1}},{geometry:{type:"MultiPolygon",coordinates:[[[[46.1144531250001,38.877783203125034],[45.4796875000001,39.006249999999994],[44.81718750000002,39.65043945312496],[44.76826171875004,39.70351562500005],[45.03164062500005,39.76513671874997],[45.76630859375004,39.37846679687499],[46.1144531250001,38.877783203125034]]],[[[48.572851562500006,41.84448242187503],[49.10664062500004,41.30170898437504],[49.22646484375005,41.026220703125034],[49.77597656250006,40.583984375],[49.3244140625001,39.60834960937501],[49.36279296875003,39.349560546874955],[49.013476562500074,39.13398437500001],[48.86875000000006,38.43549804687498],[48.59267578125005,38.41108398437498],[48.02324218750002,38.81904296874998],[48.24199218750002,38.978955078124955],[47.995898437500074,39.683935546875034],[47.772851562499994,39.64858398437505],[46.490624999999994,38.90668945312498],[46.5500000000001,39.20141601562497],[45.789648437500006,39.88110351562497],[45.96464843750002,40.233789062499966],[45.37617187500004,40.63808593750002],[45.58750000000006,40.846923828125],[45.001367187499994,41.29096679687498],[45.217187499999994,41.423193359375006],[45.28095703125004,41.449560546875034],[46.086523437500006,41.183837890625],[46.43095703125002,41.077050781249994],[46.30546875000002,41.507714843749994],[46.42988281250004,41.890966796875006],[46.74931640625002,41.812597656250006],[47.26113281250005,41.315087890624994],[47.861132812500074,41.212744140625034],[48.572851562500006,41.84448242187503]]]]},properties:{name:"Azerbaijan",childNum:2}},{geometry:{type:"Polygon",coordinates:[[[30.553613281250023,-2.4000976562500114],[30.53369140625,-2.42626953125],[30.441992187500006,-2.6134765625000114],[30.424218750000023,-2.6416015625],[30.42402343750001,-2.824023437500003],[30.433496093750023,-2.87451171875],[30.515039062500023,-2.9175781250000057],[30.811132812500006,-3.1164062500000114],[30.400000000000006,-3.6539062500000057],[30.14716796875001,-4.0853515625000085],[29.947265625,-4.307324218750011],[29.7177734375,-4.455859375000003],[29.403222656250023,-4.449316406250006],[29.223242187500006,-3.9108398437500114],[29.224414062500017,-3.053515625000003],[29.01435546875001,-2.72021484375],[29.390234375000006,-2.80859375],[29.8681640625,-2.7164062500000057],[29.93017578125,-2.3395507812500114],[30.553613281250023,-2.4000976562500114]]]},properties:{name:"Burundi",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[5.693554687500011,50.774755859375006],[5.993945312500017,50.75043945312504],[6.364453125000011,50.31616210937503],[6.1165039062500455,50.120996093749966],[6.110058593750068,50.123779296875],[6.08906250000004,50.15458984374996],[5.976269531250068,50.167187499999955],[5.866894531250068,50.08281250000002],[5.817382812500028,50.01269531250003],[5.7880859375,49.96123046875002],[5.744042968749994,49.91962890624998],[5.73525390625008,49.875634765624994],[5.7408203125000625,49.85717773437506],[5.725781250000011,49.83334960937498],[5.725000000000023,49.80830078125004],[5.78798828125008,49.758886718750006],[5.8037109375,49.73217773437497],[5.880371093749972,49.64477539062503],[5.789746093749983,49.53828125000001],[4.867578125000051,49.78813476562502],[4.174609375000017,50.24648437500005],[2.8397460937500227,50.71176757812498],[2.52490234375,51.097119140624955],[3.35009765625,51.37768554687503],[3.9020507812500114,51.20766601562502],[4.226171875000034,51.38647460937503],[4.503417968750028,51.47470703124998],[5.827148437500057,51.125634765624994],[5.693554687500011,50.774755859375006]]]},properties:{name:"Belgium",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[3.5954101562500114,11.6962890625],[3.5539062500000114,11.631884765624989],[3.490527343750017,11.499218749999997],[3.48779296875,11.395410156249994],[3.6388671875000114,11.176855468749991],[3.7164062500000057,11.07958984375],[3.7568359375,10.768749999999997],[3.83447265625,10.607421875],[3.6465820312500057,10.408984374999989],[3.5572265625000057,9.907324218749991],[3.3251953125,9.778466796874994],[3.044921875,9.083837890624991],[2.7748046875000227,9.048535156249997],[2.703125,8.371826171875],[2.68603515625,7.873730468749997],[2.75048828125,7.395068359374989],[2.7213867187500114,6.980273437499989],[2.731738281250017,6.852832031249989],[2.7529296875,6.771630859374994],[2.7746093750000114,6.711718749999989],[2.753710937500017,6.661767578124994],[2.735644531250017,6.595703125],[2.7064453125000227,6.3692382812499915],[1.6226562500000057,6.216796875],[1.6001953125000057,9.050048828125],[1.42431640625,9.285009765624991],[1.330078125,9.996972656249994],[.7799804687500114,10.359570312499997],[.9004882812500057,10.993261718749991],[1.4267578125,11.447119140624991],[1.9803710937500227,11.418408203124997],[2.38916015625,11.897070312499991],[2.366015625000017,12.221923828125],[2.8781250000000114,12.367724609374989],[3.3599609375000057,11.880468749999991],[3.4498046875000057,11.851953124999994],[3.5954101562500114,11.6962890625]]]},properties:{name:"Benin",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[.21748046875001137,14.911474609374991],[.16386718750001705,14.497216796874994],[.6181640625,13.703417968750003],[.9777343750000114,13.551953124999997],[.9873046875,13.041894531249994],[1.56494140625,12.635400390624994],[2.0738281250000057,12.713964843749991],[2.0914062500000057,12.277978515624994],[2.38916015625,11.897070312499991],[1.9803710937500227,11.418408203124997],[1.4267578125,11.447119140624991],[.9004882812500057,10.993261718749991],[-.068603515625,11.115624999999994],[-.701416015625,10.988964843749997],[-2.8299316406249773,10.998388671874991],[-2.9148925781249773,10.592333984374989],[-2.78662109375,10.401904296874989],[-2.6958496093749886,9.481347656249994],[-2.7666015625,9.424707031249994],[-2.8167480468749773,9.425830078124989],[-3.2235351562499943,9.895458984374997],[-3.5811523437499773,9.92431640625],[-3.7906249999999773,9.917187499999997],[-4.18115234375,9.78173828125],[-4.267187499999977,9.743261718749991],[-4.332226562499983,9.645703124999997],[-4.406201171874983,9.647998046874989],[-4.526611328125,9.723486328124991],[-4.625830078124977,9.713574218749997],[-4.721777343749977,9.756542968749997],[-4.969921874999983,9.930078124999994],[-5.262304687499977,10.319677734374991],[-5.523535156249977,10.426025390625],[-5.457080078124989,10.771386718749994],[-5.490478515625,11.042382812499994],[-5.299853515624989,11.205957031249994],[-5.288134765624989,11.827929687499989],[-4.797949218749977,12.032128906249994],[-4.4287109375,12.337597656249997],[-4.480615234374994,12.672216796874991],[-4.227099609374989,12.793701171875],[-4.328710937499977,13.119042968749994],[-4.051171874999994,13.382421874999991],[-3.5757812499999773,13.194189453124991],[-3.3017578125,13.28076171875],[-3.198437499999983,13.6728515625],[-2.457226562499983,14.274121093749997],[-2.113232421874983,14.16845703125],[-1.767773437499983,14.486035156249997],[-1.049560546875,14.819531249999997],[-.760449218749983,15.047753906249994],[-.23588867187498863,15.059423828124991],[.21748046875001137,14.911474609374991]]]},properties:{name:"Burkina Faso",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[88.94072265625002,26.24536132812497],[88.97041015625004,26.250878906250023],[88.95195312500002,26.412109375],[89.01865234375012,26.410253906249977],[89.10830078125005,26.202246093749977],[89.57275390625003,26.13232421875003],[89.8229492187501,25.94140625000003],[89.82490234375004,25.560156250000006],[89.80087890625012,25.33613281250001],[89.81406250000006,25.305371093749955],[89.86630859375012,25.293164062499955],[90.11962890625003,25.21997070312497],[90.61308593750002,25.16772460937497],[92.04970703125005,25.16948242187499],[92.38496093750004,24.848779296875023],[92.22666015625012,24.77099609374997],[92.11748046875002,24.493945312500017],[92.06416015625004,24.374365234375006],[91.72656250000003,24.20507812499997],[91.35019531250012,24.06049804687501],[91.16044921875007,23.66064453125],[91.35937500000003,23.06835937500003],[91.43623046875004,23.19990234375001],[91.75097656250003,23.053515625000017],[91.75419921875007,23.287304687499955],[91.79003906249997,23.361035156249983],[91.937890625,23.504687500000017],[91.92949218750007,23.598242187499977],[91.92958984375,23.68598632812501],[91.97851562500003,23.691992187499977],[92.04404296875006,23.677783203125017],[92.33378906250002,23.242382812499955],[92.36162109375002,22.929003906250074],[92.46445312500006,22.734423828125045],[92.49140625000004,22.685400390625006],[92.5612304687501,22.04804687500001],[92.57490234375004,21.978076171875045],[92.5934570312501,21.46733398437499],[92.17958984375005,21.293115234375023],[92.32412109375,20.791845703125063],[92.0560546875,21.1748046875],[92.0080078125001,21.684765624999983],[91.69296875000012,22.504785156249966],[91.48212890625004,22.79741210937499],[90.94560546875002,22.597021484375034],[90.63359375000002,23.09423828124997],[90.43505859374997,22.751904296874955],[90.58945312500012,22.258447265624966],[90.15878906250012,21.816845703124983],[89.81191406250005,21.983496093750006],[89.56855468750004,21.767431640625034],[89.09394531250004,21.872753906249983],[89.0500000000001,22.274609374999983],[88.92070312500002,22.632031249999955],[88.89970703125002,22.843505859375057],[88.72441406250002,23.254980468750034],[88.69765625,23.493017578125034],[88.56738281249997,23.674414062500034],[88.69980468750006,24.002539062500006],[88.71376953125,24.069628906250017],[88.72656250000003,24.186230468749955],[88.7335937500001,24.23090820312501],[88.72353515625,24.27490234375],[88.64228515625004,24.325976562500017],[88.49853515625003,24.34663085937504],[88.33750000000006,24.45385742187503],[88.22500000000005,24.460644531249983],[88.14550781250003,24.485791015624955],[88.07910156249997,24.549902343750063],[88.02343750000003,24.62783203125005],[88.03027343749997,24.66445312500005],[88.0451171875001,24.713037109374994],[88.1498046875,24.914648437500034],[88.57382812500006,25.187890624999994],[88.92978515625012,25.222998046875063],[88.94414062500002,25.290771484375],[88.85478515625002,25.333544921875017],[88.76914062500006,25.490478515625],[88.14746093749997,25.811425781250023],[88.1066406250001,25.841113281250045],[88.33398437499997,26.257519531249955],[88.44042968749997,26.369482421875034],[88.38623046875003,26.471533203125034],[88.35146484375005,26.482568359374966],[88.36992187500002,26.564111328124994],[88.41816406250004,26.57153320312497],[88.51826171875004,26.517773437499955],[88.68066406249997,26.352978515624955],[88.68281250000004,26.291699218749983],[88.94072265625002,26.24536132812497]]]
},properties:{name:"Bangladesh",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[28.585351562500023,43.742236328124996],[28.465429687500006,43.389306640624994],[27.92890625000001,43.1861328125],[27.88886718750001,42.74970703125],[27.484765625000023,42.468066406249996],[27.982714843750017,42.047412109374996],[28.014453125000017,41.969042968749996],[27.879199218750017,41.986621093749996],[27.801660156250023,41.95654296875],[27.53486328125001,41.920800781249994],[27.47480468750001,41.946875],[27.362890625000006,42.025048828124994],[27.294921875,42.079541015625],[27.24433593750001,42.09326171875],[27.193359375,42.077099609375],[27.01171875,42.058642578124996],[26.96875,42.02685546875],[26.884863281250006,41.991845703124994],[26.800390625000006,41.975146484374996],[26.615332031250006,41.964892578124996],[26.549707031250023,41.896728515625],[26.066015625000006,41.673242187499994],[26.155175781250023,41.434863281249996],[25.92333984375,41.311914062499994],[25.784960937500017,41.330419921875],[25.723925781250017,41.3150390625],[25.52705078125001,41.2998046875],[25.381933593750006,41.26435546875],[25.25117187500001,41.243554687499994],[25.133398437500006,41.315771484375],[24.993554687500023,41.364990234375],[24.84687500000001,41.39423828125],[24.595996093750017,41.442724609375],[24.056054687500023,41.527246093749994],[24.03291015625001,41.469091796875],[24.011328125000006,41.46005859375],[23.973535156250023,41.452294921874994],[23.880859375,41.455957031249994],[23.635156250000023,41.386767578124996],[23.53583984375001,41.386035156249996],[23.433398437500017,41.398730468749996],[23.3720703125,41.3896484375],[23.239843750000006,41.3849609375],[23.15595703125001,41.322070312499996],[23.02558593750001,41.325634765625],[22.916015625,41.336279296875],[22.9296875,41.356103515624994],[22.951464843750017,41.605615234374994],[23.005664062500017,41.716943359374994],[22.836816406250023,41.993603515625],[22.344042968750017,42.31396484375],[22.42207031250001,42.328857421875],[22.445703125000023,42.359130859375],[22.523535156250006,42.440966796874996],[22.524218750000017,42.50390625],[22.43623046875001,42.6291015625],[22.463281250000023,42.70947265625],[22.465625000000017,42.750781249999996],[22.466796875,42.84248046875],[22.799902343750006,42.985742187499994],[22.976855468750017,43.18798828125],[22.85957031250001,43.252343749999994],[22.819726562500023,43.300732421875],[22.767578125,43.354150390624994],[22.554589843750023,43.454492187499994],[22.394824218750017,43.706640625],[22.38691406250001,43.740136718749994],[22.36962890625,43.781298828124996],[22.36542968750001,43.862109374999996],[22.399023437500006,43.969531249999996],[22.420800781250023,44.007421875],[22.469042968750017,44.018017578125],[22.597460937500017,44.07529296875],[22.705078125,44.23779296875],[23.224609375,43.873876953125],[25.4970703125,43.670800781249994],[26.2158203125,44.007275390625],[27.0869140625,44.167382812499994],[28.585351562500023,43.742236328124996]]]},properties:{name:"Bulgaria",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[-77.74384765625001,24.707421874999994],[-78.04492187499997,24.287451171875063],[-78.298828125,24.753906250000057],[-78.03330078125,25.143115234375045],[-77.74384765625001,24.707421874999994]]]},properties:{name:"The Bahamas",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[19.007128906250045,44.86918945312502],[19.35683593750005,44.858544921874994],[19.15185546875003,44.302539062500045],[19.583789062500017,44.04345703125003],[19.19433593749997,43.533300781250006],[18.94023437499999,43.49672851562502],[18.85107421875003,43.34633789062502],[18.749218750000068,43.283544921875006],[18.67421875000008,43.230810546875006],[18.46601562500001,42.777246093749994],[18.436328125000017,42.559716796874994],[17.667578125000063,42.897119140624994],[17.585156250000068,42.93837890625005],[17.624804687500074,43.04277343749999],[16.214257812500023,44.21513671874999],[15.736621093750045,44.76582031250001],[15.788085937500057,45.17895507812497],[16.29335937500005,45.00883789062496],[16.53066406250008,45.21669921875002],[17.812792968750074,45.07812500000006],[18.66259765625,45.07744140624999],[19.007128906250045,44.86918945312502]]]},properties:{name:"Bosnia and Herzegovina",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[28.14794921875,56.142919921875],[28.284277343750006,56.055908203125],[29.375,55.938720703125],[29.39794921875,55.8810546875],[29.373144531250006,55.834716796875],[29.353417968750023,55.784375],[29.412988281250023,55.724853515625],[29.482226562500017,55.6845703125],[29.63007812500001,55.751171875],[29.6845703125,55.7697265625],[29.744140625,55.77041015625],[29.82392578125001,55.7951171875],[29.881640625000017,55.832324218749996],[29.93701171875,55.845263671874996],[30.04267578125001,55.83642578125],[30.23359375000001,55.84521484375],[30.625585937500006,55.666259765625],[30.906835937500006,55.57001953125],[31.12128906250001,54.648486328124996],[31.754199218750017,53.81044921875],[32.45097656250002,53.6533203125],[32.70429687500001,53.336328125],[31.849707031250006,53.106201171875],[31.668261718750017,53.200927734375],[31.417871093750023,53.196044921875],[31.38837890625001,53.184814453125],[31.364550781250017,53.138964843749996],[31.30292968750001,53.060888671875],[31.2587890625,53.01669921875],[31.585546875000006,52.532470703125],[31.57734375000001,52.312304687499996],[31.69062500000001,52.220654296875],[31.758593750000017,52.125830078125],[31.76337890625001,52.10107421875],[31.57373046875,52.10810546875],[31.345996093750017,52.10537109375],[30.98066406250001,52.046191406249996],[30.533007812500017,51.596337890624994],[30.449511718750017,51.274316406249994],[30.160742187500006,51.477880859375],[29.346484375000017,51.382568359375],[29.298828125,51.413037109375],[29.23046875,51.497021484375],[29.174218750000023,51.580615234374996],[29.135644531250023,51.61728515625],[29.10205078125,51.6275390625],[29.06074218750001,51.625439453125],[29.013085937500023,51.598925781249996],[28.97773437500001,51.57177734375],[28.793261718750017,51.5103515625],[28.731250000000017,51.433398437499996],[28.690234375000017,51.438867187499994],[28.647753906250017,51.45654296875],[28.599023437500023,51.542626953124994],[27.689746093750017,51.572412109374994],[27.141992187500023,51.75205078125],[25.785742187500006,51.923828125],[24.361914062500006,51.867529296875],[23.61376953125,51.525390625],[23.605273437500017,51.517919921875],[23.652441406250006,52.040380859375],[23.19697265625001,52.25693359375],[23.8447265625,52.664208984375],[23.887109375000023,53.0275390625],[23.484667968750017,53.939794921875],[24.191308593750023,53.950439453125],[24.236621093750017,53.919970703124996],[24.317968750000006,53.89296875],[24.768164062500006,53.974658203124996],[25.573046875000017,54.139892578125],[25.859277343750023,54.919287109375],[25.964453125000006,54.94716796875],[26.09296875000001,54.9623046875],[26.175195312500023,55.003271484375],[26.291796875000017,55.139599609375],[26.601171875000006,55.130175781249996],[26.775683593750017,55.273095703125],[26.681250000000006,55.306445312499996],[26.49531250000001,55.318017578125],[26.457617187500006,55.34248046875],[26.469531250000017,55.371923828125],[26.51923828125001,55.44814453125],[26.56660156250001,55.546484375],[26.5908203125,55.62265625],[26.593554687500017,55.667529296874996],[26.620214843750006,55.679638671875],[26.82246093750001,55.709228515625],[27.052539062500017,55.83056640625],[27.576757812500006,55.798779296875],[28.14794921875,56.142919921875]]]},properties:{name:"Belarus",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[-89.2328125,15.888671875],[-89.16147460937503,17.814843749999994],[-88.80634765624998,17.965527343749983],[-88.52299804687499,18.445898437500063],[-88.29565429687494,18.47241210937503],[-88.09721679687502,18.121630859375074],[-88.27172851562494,17.60986328125],[-88.31342773437501,16.632763671874983],[-88.89404296875,15.890625000000028],[-89.2328125,15.888671875]]]},properties:{name:"Belize",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[-58.15976562499999,-20.164648437500006],[-58.18017578125,-19.81787109375],[-59.09052734375,-19.286230468750006],[-60.00737304687499,-19.29755859375001],[-61.7568359375,-19.645312500000003],[-61.916943359375,-20.05537109375001],[-62.276318359375,-20.5625],[-62.27666015624999,-21.066015625000006],[-62.65097656249999,-22.233691406250003],[-62.84335937499999,-21.99726562500001],[-63.81865234374999,-22.005468750000006],[-63.92167968749999,-22.028613281250003],[-63.97612304687499,-22.072558593750003],[-64.26640624999999,-22.603320312500003],[-64.30791015624999,-22.79531250000001],[-64.32529296874999,-22.82763671875],[-64.373974609375,-22.761035156250003],[-64.4455078125,-22.58535156250001],[-64.477734375,-22.4853515625],[-64.5236328125,-22.37158203125],[-64.60551757812499,-22.228808593750003],[-65.0578125,-22.10273437500001],[-65.48486328125,-22.09814453125],[-65.686181640625,-22.11025390625001],[-65.77104492187499,-22.099609375],[-65.86015624999999,-22.01972656250001],[-66.05859375,-21.879492187500006],[-66.098583984375,-21.835058593750006],[-66.17465820312499,-21.8056640625],[-66.220166015625,-21.802539062500003],[-66.24760742187499,-21.83046875000001],[-66.28212890625,-21.94746093750001],[-66.3224609375,-22.05312500000001],[-66.365185546875,-22.11376953125],[-66.71171874999999,-22.21630859375],[-66.99111328125,-22.509863281250006],[-67.19487304687499,-22.82167968750001],[-67.362255859375,-22.85517578125001],[-67.57993164062499,-22.891699218750006],[-67.79443359375,-22.879492187500006],[-67.87944335937499,-22.82294921875001],[-67.88173828125,-22.49335937500001],[-67.950390625,-22.33369140625001],[-67.95390624999999,-22.20400390625001],[-67.98837890624999,-22.05712890625],[-68.07675781249999,-21.98281250000001],[-68.11215820312499,-21.753027343750006],[-68.18642578125,-21.61855468750001],[-68.197021484375,-21.30029296875],[-68.74516601562499,-20.458593750000006],[-68.75932617187499,-20.115527343750003],[-68.69829101562499,-19.72109375000001],[-68.462890625,-19.43281250000001],[-68.470166015625,-19.409960937500003],[-68.49199218749999,-19.381933593750006],[-68.85795898437499,-19.093359375000006],[-68.96831054687499,-18.96796875000001],[-68.97885742187499,-18.81298828125],[-69.026806640625,-18.65625],[-69.09228515625,-18.28242187500001],[-69.0939453125,-18.05048828125001],[-69.28232421874999,-17.96484375],[-69.31337890625,-17.943164062500003],[-69.35800781249999,-17.77167968750001],[-69.49501953125,-17.61953125000001],[-69.5109375,-17.50605468750001],[-69.62485351562499,-17.2001953125],[-69.020703125,-16.642187500000006],[-68.9134765625,-16.26191406250001],[-69.21757812499999,-16.14912109375001],[-69.41850585937499,-15.603417968750009],[-69.17246093749999,-15.236621093750003],[-69.37470703125,-14.962988281250006],[-69.23491210937499,-14.597070312500009],[-68.880322265625,-14.198828125000006],[-69.07412109375,-13.682812500000011],[-68.97861328124999,-12.880078125000011],[-68.68525390625,-12.501953125],[-69.57861328125,-10.951757812500006],[-68.84833984375,-11.011132812500009],[-68.678369140625,-11.11279296875],[-68.0716796875,-10.703125],[-67.99169921875,-10.674414062500006],[-67.83500976562499,-10.662792968750011],[-67.72177734374999,-10.68310546875],[-67.582421875,-10.505957031250006],[-67.416943359375,-10.389843750000011],[-67.33271484375,-10.35791015625],[-67.28046875,-10.317285156250009],[-67.1115234375,-10.268945312500009],[-66.72998046875,-9.975488281250009],[-66.575341796875,-9.89990234375],[-66.26357421875,-9.826074218750009],[-65.396142578125,-9.71240234375],[-65.31308593749999,-10.253027343750006],[-65.395458984375,-10.392285156250011],[-65.4369140625,-10.449023437500003],[-65.33403320312499,-10.892773437500011],[-65.32377929687499,-11.024804687500009],[-65.389892578125,-11.246289062500011],[-64.99252929687499,-11.975195312500006],[-64.513427734375,-12.2509765625],[-64.42050781249999,-12.439746093750003],[-63.93857421874999,-12.529687500000009],[-63.7880859375,-12.469433593750011],[-63.68857421874999,-12.47802734375],[-63.58564453125,-12.518945312500009],[-63.3466796875,-12.680078125000009],[-63.06748046874999,-12.669140625000011],[-62.76547851562499,-12.997265625000011],[-62.17607421874999,-13.133691406250009],[-62.11801757812499,-13.159765625000006],[-62.09477539062499,-13.241992187500003],[-61.944726562499994,-13.40625],[-61.87412109374999,-13.470410156250011],[-61.789941406249994,-13.525585937500011],[-61.57568359375,-13.524804687500009],[-61.51157226562499,-13.541210937500011],[-61.41606445312499,-13.526562500000011],[-61.129150390625,-13.49853515625],[-61.07700195312499,-13.48974609375],[-60.914501953125,-13.561425781250009],[-60.506591796875,-13.789843750000003],[-60.372705078124994,-14.418750000000003],[-60.17558593749999,-16.269335937500003],[-58.53793945312499,-16.328222656250006],[-58.49658203125,-16.32666015625],[-58.42368164062499,-16.307910156250003],[-58.345605468749994,-16.28437500000001],[-58.35039062499999,-16.490820312500006],[-58.470605468749994,-16.650195312500003],[-58.47812499999999,-16.70068359375],[-58.45981445312499,-16.910742187500006],[-58.417382812499994,-17.08056640625],[-58.39599609375,-17.23427734375001],[-57.832470703125,-17.51210937500001],[-57.780175781249994,-17.67177734375001],[-57.66166992187499,-17.947363281250006],[-57.58647460937499,-18.12226562500001],[-57.57402343749999,-18.279296875],[-57.80039062499999,-19.08095703125001],[-58.131494140624994,-19.74453125000001],[-58.15976562499999,-20.164648437500006]]]},properties:{name:"Bolivia",childNum:1}},{geometry:{type:"MultiPolygon",coordinates:[[[[-51.83251953124997,-1.4337890624999687],[-51.546044921874966,-.6496093749999972],[-51.16074218749998,-.6666992187500114],[-51.27631835937498,-1.0217773437499602],[-51.83251953124997,-1.4337890624999687]]],[[[-49.62866210937497,-.22919921874996874],[-49.11699218749999,-.1635742187500142],[-48.37968749999999,-.35283203125001705],[-48.539697265624994,-.8009765625000114],[-48.928906249999955,-1.4823242187499943],[-49.587890625,-1.7124023437499716],[-50.50761718749999,-1.7879882812500085],[-50.759765625,-1.2402343749999716],[-50.771386718749966,-.6454101562500227],[-50.6455078125,-.2728515624999801],[-50.24824218749998,-.11640624999999716],[-49.62866210937497,-.22919921874996874]]],[[[-59.69970703125,4.353515625],[-59.551123046875034,3.9335449218749687],[-59.854394531249994,3.5874999999999915],[-59.99433593749998,2.6899902343750313],[-59.75522460937495,2.27412109375004],[-59.74350585937498,2.12163085937496],[-59.75175781249996,1.9624023437500284],[-59.75620117187498,1.9006347656249716],[-59.666601562500006,1.7462890624999687],[-59.59663085937498,1.7180175781249858],[-59.53569335937499,1.7000000000000455],[-59.23120117187494,1.3760253906250313],[-58.968505859375,1.3045898437500512],[-58.91660156249998,1.2488769531249773],[-58.86249999999998,1.2036132812499858],[-58.511865234374966,1.2846679687499858],[-58.506054687499926,1.4386718750000114],[-58.39580078124993,1.4817382812499886],[-58.38037109375,1.5302246093750114],[-58.34067382812498,1.5875488281250512],[-58.03466796875,1.5202636718750142],[-57.982812499999994,1.6484375000000142],[-57.79565429687497,1.7000000000000455],[-57.691748046875034,1.7047851562500398],[-57.59443359375001,1.7041015624999858],[-57.500439453124955,1.77382812499998],[-57.412695312500034,1.9089355468749716],[-57.366796875000006,1.9401367187500256],[-57.31748046874998,1.9634765624999915],[-57.11889648437494,2.0139648437499744],[-57.03759765625,1.9364746093749972],[-56.96953124999999,1.9164062499999943],[-56.48281249999994,1.9421386718749858],[-56.019921874999966,1.842236328124983],[-56.12939453124997,2.2995117187499687],[-56.08779296875002,2.3413085937500426],[-56.02036132812498,2.392773437500054],[-55.935937499999994,2.516601562500057],[-55.730566406250006,2.4061523437500227],[-55.385351562500006,2.4406250000000256],[-55.34399414062503,2.4887695312499716],[-55.28603515625002,2.49965820312498],[-55.18769531249998,2.547509765625037],[-55.114111328125006,2.539208984375037],[-55.07031249999994,2.5483398437500284],[-55.005810546874955,2.592968749999983],[-54.97866210937502,2.5976562500000426],[-54.968408203124966,2.5483398437500284],[-54.92656249999999,2.4973632812500455],[-54.876074218750006,2.4503906249999687],[-54.851660156250006,2.4395507812499915],[-54.76684570312503,2.454736328124966],[-54.72221679687499,2.4416503906249716],[-54.69741210937502,2.359814453124997],[-54.66186523437497,2.3275390624999943],[-54.61625976562499,2.3267578125000057],[-54.59194335937502,2.3137695312500313],[-54.55048828125001,2.2930664062499915],[-54.51508789062498,2.245458984374963],[-54.13007812499998,2.1210449218750256],[-53.76777343749998,2.3548339843750483],[-52.96484375,2.1835449218749687],[-52.70063476562501,2.36367187499998],[-51.99062499999994,3.702001953124963],[-51.65253906249998,4.061279296874972],[-51.46152343749998,4.313769531249989],[-51.219921874999955,4.0936035156249915],[-51.05239257812502,3.2818359374999915],[-50.65893554687497,2.1309570312500057],[-50.458886718749994,1.8295898437499716],[-49.957128906250006,1.6598632812500398],[-49.898876953124955,1.16298828124998],[-50.29443359374997,.8357421875000028],[-50.81635742187498,.17255859374999716],[-51.28291015625001,-.08520507812502842],[-51.70263671874997,-.7623046874999488],[-51.94755859374996,-1.586718749999946],[-51.29736328125003,-1.223535156250037],[-50.917871093749966,-1.115234375],[-50.690039062500006,-1.7617187499999858],[-50.40322265625002,-2.0155273437500085],[-49.999218749999955,-1.8318359374999744],[-49.71953125000002,-1.926367187499963],[-49.31367187500001,-1.7317382812500028],[-48.99130859374998,-1.8297851562499972],[-48.11508789062498,-.7374999999999545],[-47.39809570312502,-.6266601562500256],[-46.81123046875001,-.7796875000000227],[-46.61723632812502,-.9706054687500227],[-46.219140624999994,-1.0312500000000284],[-45.64477539062497,-1.3478515624999545],[-45.07636718749998,-1.4664062499999488],[-44.651269531249966,-1.7458007812500256],[-44.30815429687496,-2.53515625],[-43.93291015624999,-2.583496093749986],[-42.93671874999998,-2.4650390625000114],[-42.24960937499998,-2.7919921875],[-41.876171874999926,-2.746582031249986],[-41.318212890625034,-2.936230468749997],[-40.474560546874926,-2.7956054687500256],[-39.96469726562498,-2.8615234374999545],[-38.475781249999955,-3.717480468749997],[-38.04882812500003,-4.216406250000034],[-37.174658203125006,-4.912402343749974],[-36.590722656249966,-5.097558593749952],[-35.979882812499966,-5.05439453125004],[-35.549414062500006,-5.129394531249957],[-35.235449218750006,-5.56669921874996],[-34.988183593749994,-6.393749999999969],[-34.80546874999999,-7.288378906249974],[-34.83466796874998,-7.97148437499996],[-35.15776367187499,-8.930566406249952],[-35.34086914062499,-9.230664062499983],[-36.39833984374994,-10.484082031249983],[-36.93779296874999,-10.820410156250034],[-37.41181640625001,-11.497265624999983],[-37.68872070312503,-12.100000000000037],[-38.23974609375003,-12.844238281249957],[-38.787988281249966,-12.782714843750028],[-38.835302734375034,-13.147167968750026],[-39.08935546875,-13.588183593749989],[-38.94233398437498,-14.030664062499994],[-39.05957031249997,-14.654785156249957],[-38.88061523437503,-15.864257812499972],[-39.215234374999966,-17.315820312500023],[-39.154003906249926,-17.70390625000003],[-39.486767578124955,-17.990136718749994],[-39.73979492187499,-18.639843750000026],[-39.69985351562502,-19.27783203124997],[-40.001367187499994,-19.74199218750003],[-40.39594726562501,-20.56943359375002],[-40.78925781250001,-20.90605468750003],[-41.047265624999994,-21.505664062499974],[-41.122509765624955,-22.08437500000001],[-41.70551757812498,-22.30966796874999],[-41.980419921874955,-22.580664062499963],[-42.042382812499966,-22.947070312500003],[-42.95830078124996,-22.96708984374999],[-43.532812500000006,-23.046386718749986],[-43.86616210937498,-22.910546875000023],[-44.63725585937496,-23.05546874999996],[-45.423291015624955,-23.68535156250003],[-45.97207031250002,-23.795507812500006],[-46.86728515624998,-24.236328125000014],[-47.87656249999998,-24.99746093750001],[-48.54516601562503,-25.815917968750043],[-48.67773437499994,-26.702929687500003],[-48.55415039062498,-27.195996093749997],[-48.62080078124998,-28.075585937499966],[-48.799658203125006,-28.575292968749977],[-49.27128906249999,-28.87119140625005],[-49.745996093749966,-29.363183593749994],[-50.299511718749955,-30.42578125000003],[-51.15727539062499,-30.364257812500014],[-51.46367187499996,-31.052636718750023],[-51.97246093749999,-31.383789062499986],[-52.19355468749998,-31.885546874999974],[-52.12739257812501,-32.1677734375],[-52.652246093749994,-33.137792968750006],[-53.37060546874997,-33.74218750000003],[-53.39755859374995,-33.737304687500014],[-53.46357421875001,-33.70986328125002],[-53.51884765624999,-33.67724609375004],[-53.531347656250034,-33.65546875000004],[-53.53764648437499,-33.622851562499974],[-53.531347656250034,-33.1708984375],[-53.39521484375001,-33.01035156249998],[-53.21406249999998,-32.82109374999996],[-53.12558593749998,-32.73671875000001],[-53.601708984374994,-32.40302734374997],[-53.76171875,-32.05683593749997],[-53.920605468749926,-31.952343749999997],[-54.220556640625034,-31.855175781249997],[-54.58764648437503,-31.48515625000003],[-54.89599609374997,-31.391210937499977],[-55.036035156249994,-31.27900390625004],[-55.091162109375034,-31.31396484374997],[-55.173535156249926,-31.279589843749974],[-55.25463867187503,-31.225585937499986],[-55.36606445312498,-31.04619140625003],[-55.449560546875034,-30.96445312499999],[-55.557324218749955,-30.8759765625],[-55.62714843749998,-30.858105468749997],[-55.650488281250034,-30.89208984375],[-55.66523437500001,-30.92490234375002],[-55.705957031249966,-30.94658203124999],[-55.75634765625,-30.98710937499999],[-55.807763671874994,-31.036718749999977],[-55.87368164062502,-31.069628906250017],[-55.95200195312498,-31.08085937499999],[-56.00468749999996,-31.079199218750006],[-56.015527343749966,-31.059667968750034],[-56.01845703125002,-30.991894531249983],[-55.998974609374955,-30.837207031250003],[-56.4072265625,-30.44746093750001],[-56.83271484374998,-30.107226562499974],[-57.21445312499995,-30.283398437499983],[-57.60888671875003,-30.187792968750045],[-56.938623046874994,-29.594824218750034],[-55.72548828125002,-28.20410156250003],[-55.10151367187501,-27.866796874999963],[-54.82910156250003,-27.55058593750003],[-54.32700195312495,-27.423535156249997],[-53.83818359375002,-27.121093750000014],[-53.67128906249994,-26.22509765625],[-53.89116210937499,-25.66884765625001],[-54.15458984374999,-25.523046874999963],[-54.615869140624994,-25.576074218750023],[-54.47314453124997,-25.22021484375],[-54.281005859375,-24.30605468750001],[-54.31826171874994,-24.128124999999997],[-54.26689453124996,-24.06582031250001],[-54.241796875000006,-24.047265624999966],[-54.44023437500002,-23.90175781249998],[-54.62548828125,-23.8125],[-54.98266601562494,-23.974511718749966],[-55.081884765625006,-23.997656249999977],[-55.1943359375,-24.017480468750023],[-55.28691406249993,-24.004296874999994],[-55.366308593750034,-23.99101562499996],[-55.41591796875002,-23.95136718749997],[-55.4423828125,-23.86533203125002],[-55.4423828125,-23.792578125000034],[-55.458886718749966,-23.686718750000054],[-55.65405273437494,-22.81035156250003],[-55.627587890624966,-22.74091796875001],[-55.61767578125,-22.67148437499999],[-55.64741210937501,-22.621875000000003],[-55.70366210937502,-22.592089843749974],[-55.74663085937499,-22.51269531249997],[-55.753271484375006,-22.410156250000043],[-55.84916992187499,-22.307617187500014],[-56.18984374999994,-22.28115234375005],[-56.35185546874999,-22.178613281250023],[-56.52382812499994,-22.102539062499986],[-56.63300781249998,-22.23486328125003],[-56.77519531249999,-22.261328125000006],[-57.23823242187501,-22.195214843750037],[-57.56894531249998,-22.18193359374999],[-57.721093749999966,-22.09921875000002],[-57.76406250000002,-22.109179687500003],[-57.82031250000003,-22.142285156249997],[-57.94267578124999,-21.79833984375],[-57.830224609374994,-20.99794921875001],[-58.15976562499998,-20.164648437499977],[-58.131494140624994,-19.74453125000001],[-57.80039062499995,-19.08095703125001],[-57.57402343749993,-18.279296875000014],[-57.58647460937499,-18.122265624999997],[-57.66166992187493,-17.94736328124999],[-57.78017578125002,-17.67177734374998],[-57.83247070312501,-17.512109375000037],[-58.39599609374997,-17.234277343750023],[-58.417382812499994,-17.08056640624997],[-58.459814453125006,-16.910742187500006],[-58.478125000000006,-16.70068359375003],[-58.470605468749994,-16.650195312500045],[-58.35039062500002,-16.49082031249999],[-58.34560546875002,-16.284375000000026],[-58.423681640625034,-16.30791015625003],[-58.49658203124994,-16.32666015625003],[-58.537939453125034,-16.32822265624999],[-60.17558593749996,-16.26933593749999],[-60.372705078124994,-14.418750000000003],[-60.506591796875,-13.78984374999996],[-60.914501953124955,-13.561425781249966],[-61.077001953125034,-13.489746093750014],[-61.129150390625,-13.498535156250028],[-61.41606445312502,-13.526562499999969],[-61.511572265625006,-13.541210937500011],[-61.789941406249966,-13.525585937500026],[-61.87412109374998,-13.470410156249983],[-61.944726562499966,-13.406249999999972],[-62.09477539062499,-13.241992187499989],[-62.118017578125006,-13.15976562500002],[-62.17607421874993,-13.133691406250037],[-62.35283203124999,-13.132421874999963],[-62.765478515625034,-12.99726562500004],[-63.01518554687502,-12.80556640624998],[-63.067480468750006,-12.669140624999983],[-63.34667968749994,-12.680078124999994],[-63.585644531249955,-12.518945312500037],[-63.68857421874998,-12.478027343749957],[-63.7880859375,-12.469433593749983],[-63.938574218750006,-12.529687499999994],[-64.42050781249995,-12.439746093749974],[-64.51342773437497,-12.250976562499972],[-64.99252929687498,-11.975195312500006],[-65.389892578125,-11.246289062500011],[-65.33403320312499,-10.892773437500026],[-65.43999023437499,-10.586230468750017],[-65.4369140625,-10.449023437499946],[-65.39545898437498,-10.392285156250026],[-65.31308593749998,-10.253027343749991],[-65.39614257812494,-9.712402343749986],[-66.26357421875,-9.826074218749966],[-66.57534179687502,-9.899902343749986],[-66.72998046875,-9.975488281250023],[-67.11152343750001,-10.268945312500037],[-67.28046874999995,-10.317285156250023],[-67.33271484374995,-10.357910156249957],[-67.41694335937495,-10.389843749999969],[-67.58242187500002,-10.505957031250006],[-67.72177734374998,-10.683105468749943],[-67.83500976562496,-10.662792968749983],[-67.99169921875,-10.674414062499949],[-68.07167968749994,-10.703125000000028],[-68.678369140625,-11.11279296875],[-68.84833984374998,-11.01113281249998],[-69.228515625,-10.955664062499963],[-69.96035156249997,-10.92988281250004],[-70.642333984375,-11.010253906249986],[-70.59916992187499,-9.620507812500009],[-71.11528320312499,-9.852441406250009],[-71.237939453125,-9.966015624999955],[-72.18159179687495,-10.003710937500003],[-72.37905273437497,-9.510156249999994],[-73.20942382812493,-9.411425781249946],[-73.08984375,-9.26572265625002],[-72.970361328125,-9.120117187500028],[-72.97402343750002,-8.9931640625],[-73.07050781249995,-8.8828125],[-73.20312499999997,-8.719335937499991],[-73.30244140624995,-8.654003906250011],[-73.36040039062496,-8.479296875000031],[-73.39814453125001,-8.458984374999986],[-73.43588867187498,-8.42705078124996],[-73.54912109374993,-8.34580078125002],[-73.77558593749998,-7.9364257812500085],[-73.72041015624993,-7.782519531250017],[-73.76689453124999,-7.753515624999963],[-73.82207031249996,-7.738964843750026],[-73.89462890624998,-7.654785156250014],[-73.94687499999998,-7.611230468750023],[-73.98173828124996,-7.58505859375002],[-74.00205078125003,-7.556054687499966],[-73.98173828124996,-7.535742187500006],[-73.95849609374994,-7.506640625000031],[-73.96430664062498,-7.378906250000028],[-73.74946289062498,-7.335351562500037],[-73.79301757812499,-7.135058593750003],[-73.75810546874999,-6.90576171875],[-73.137353515625,-6.4658203125],[-73.23554687500001,-6.098437500000017],[-73.209375,-6.028710937500023],[-73.16289062499996,-5.933398437499974],[-72.97988281249997,-5.6348632812499915],[-72.88706054687498,-5.122753906250026],[-72.83193359374994,-5.093749999999972],[-72.69873046874997,-5.067187499999989],[-72.60834960937495,-5.009570312499974],[-72.46899414062497,-4.901269531250023],[-72.35283203124993,-4.786035156249994],[-72.25678710937501,-4.74892578124998],[-71.8447265625,-4.504394531249986],[-70.97368164062499,-4.350488281249994],[-70.86601562499999,-4.229589843749963],[-70.79951171874995,-4.173339843749957],[-70.72158203124997,-4.15888671875004],[-70.53066406249997,-4.167578125000034],[-70.40463867187498,-4.150097656250026],[-69.96591796875003,-4.235937500000006],[-69.66904296875003,-2.667675781249997],[-69.40024414062498,-1.1949218749999773],[-69.66748046874997,-.48242187499995737],[-70.07050781249993,-.1388671875000398],[-70.05390624999993,.5786132812500284],[-69.16323242187502,.8640625000000028],[-69.36137695312496,1.0640136718749744],[-69.85214843750003,1.0595214843750398],[-69.84858398437493,1.7087402343750426],[-68.17656249999999,1.7198242187499915],[-67.815087890625,1.790087890625017],[-67.35195312499997,2.085839843750051],[-66.87602539062499,1.223046875000037],[-66.42924804687502,.8216796874999801],[-66.06005859375003,.7853515625000398],[-65.68144531249999,.9834472656249886],[-65.36083984374994,.8686523437500568],[-65.10375976562497,1.108105468749983],[-64.11484375000003,1.619287109375037],[-64.03544921874993,1.904443359375037],[-63.393945312499994,2.2225097656250057],[-63.389257812500006,2.4119140625000455],[-63.924169921875006,2.4524414062500313],[-64.21884765625,3.2046874999999915],[-64.22109375000002,3.5874023437499716],[-64.56791992187496,3.8998046875000227],[-64.25566406249996,4.140332031249997],[-64.02148437500003,3.929101562500051],[-63.29472656249993,3.92226562499998],[-62.96865234374994,3.593945312499983],[-62.71210937499998,4.01791992187502],[-62.15312499999996,4.098388671874986],[-61.00283203125002,4.5352539062499915],[-60.60449218749994,4.99458007812504],[-60.671972656250034,5.164355468749989],[-60.71196289062499,5.191552734375023],[-60.742138671874926,5.202050781250037],[-60.6513671875,5.221142578125011],[-60.576416015625,5.192480468750034],[-60.45952148437499,5.188085937500034],[-60.40878906249998,5.210156249999997],[-60.33520507812497,5.199316406250006],[-60.14204101562498,5.238818359374974],[-59.990673828124955,5.0828613281249915],[-60.03178710937499,4.740527343749974],[-60.12456054687496,4.59765625],[-60.14863281249998,4.533251953125031],[-60.11113281249999,4.511181640624969],[-59.69970703125,4.353515625]]]]},properties:{name:"Brazil",childNum:3}},{geometry:{type:"Polygon",coordinates:[[[115.02675781250005,4.899707031249989],[114.74667968750006,4.718066406250017],[114.84023437500005,4.3932128906250085],[114.60830078125005,4.023974609375017],[114.0638671875,4.592675781249966],[114.29941406250012,4.607177734374986],[115.02675781250005,4.899707031249989]]]},properties:{name:"Brunei",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[91.63193359375003,27.759960937499997],[91.5947265625,27.557666015624996],[91.74306640625002,27.442529296874994],[91.85126953125001,27.438623046874994],[91.95097656249999,27.458300781249996],[91.99082031250003,27.4501953125],[92.044921875,27.364697265624997],[92.08339843750002,27.290625],[92.03115234375002,27.214306640624997],[91.99228515625003,27.099902343749996],[92.07343750000001,26.914843749999996],[92.04970703125002,26.874853515625],[91.99833984374999,26.85498046875],[91.84208984374999,26.852978515624997],[91.67158203125001,26.802001953125],[90.73964843750002,26.771679687499997],[90.34589843750001,26.890332031249997],[90.2060546875,26.847509765625],[90.12294921875002,26.754589843749997],[89.94316406249999,26.723925781249996],[89.76386718750001,26.701562499999994],[89.60996093750003,26.719433593749997],[89.33212890625003,26.8486328125],[89.14824218749999,26.816162109375],[88.85761718750001,26.961474609374996],[88.73876953125,27.175585937499996],[88.76035156250003,27.218115234375],[88.88164062499999,27.2974609375],[88.89140624999999,27.316064453124994],[88.94755859374999,27.464013671874994],[89.53691406249999,28.107421875],[89.65273437500002,28.15830078125],[89.74980468749999,28.188183593749997],[89.81689453125,28.256298828124997],[89.89785156250002,28.294140624999997],[89.98105468750003,28.311181640624994],[90.35273437500001,28.080224609374994],[90.47734374999999,28.070849609374996],[90.71572265625002,28.071728515624997],[91.07773437500003,27.974462890625],[91.22587890624999,28.071240234374997],[91.27304687500003,28.078369140625],[91.60556640625003,27.951708984374996],[91.64189453124999,27.923242187499994],[91.63193359375003,27.759960937499997]]]
},properties:{name:"Bhutan",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[25.2587890625,-17.793554687500006],[25.224023437500023,-17.91523437500001],[25.76123046875,-18.649218750000003],[26.168066406250006,-19.53828125000001],[26.67822265625,-19.89277343750001],[27.221484375000017,-20.145800781250003],[27.28076171875,-20.47871093750001],[27.699609375000023,-20.53066406250001],[27.66943359375,-21.064257812500003],[28.04560546875001,-21.573046875000003],[29.03730468750001,-21.811328125000003],[29.106835937500023,-22.065722656250003],[29.237207031250023,-22.07949218750001],[29.315234375000017,-22.15771484375],[29.364843750000006,-22.193945312500006],[29.1298828125,-22.21328125000001],[29.013476562500017,-22.278417968750006],[28.94580078125,-22.395117187500006],[28.83984375,-22.48085937500001],[28.21015625000001,-22.693652343750003],[27.812597656250006,-23.108007812500006],[27.7685546875,-23.14892578125],[27.146386718750023,-23.5244140625],[27.085546875000006,-23.577929687500003],[26.98701171875001,-23.70458984375],[26.835058593750006,-24.240820312500006],[26.617773437500006,-24.3955078125],[26.501562500000006,-24.513281250000006],[26.451757812500006,-24.58271484375001],[26.39716796875001,-24.613574218750003],[25.912109375,-24.74746093750001],[25.518164062500006,-25.66279296875001],[24.748144531250006,-25.8173828125],[24.33056640625,-25.74287109375001],[24.192968750000006,-25.632910156250006],[23.969531250000017,-25.626074218750006],[23.89375000000001,-25.600878906250003],[23.670703125000017,-25.43398437500001],[23.521484375,-25.34443359375001],[23.148730468750017,-25.288671875000006],[22.878808593750023,-25.45791015625001],[22.79609375000001,-25.67910156250001],[22.72900390625,-25.85732421875001],[22.640234375000006,-26.07119140625001],[22.217578125000017,-26.38886718750001],[22.090917968750006,-26.580175781250006],[22.01093750000001,-26.635839843750006],[21.91455078125,-26.661914062500003],[21.83320312500001,-26.678320312500006],[21.78828125000001,-26.710058593750006],[21.738085937500017,-26.80683593750001],[21.694726562500023,-26.840917968750006],[21.646289062500017,-26.85419921875001],[20.739843750000006,-26.84882812500001],[20.641406250000017,-26.7421875],[20.79316406250001,-25.915625000000006],[20.34521484375,-25.029882812500006],[19.98046875,-24.77675781250001],[19.977343750000017,-22.00019531250001],[20.970996093750017,-22.00019531250001],[20.976171875000006,-19.74433593750001],[20.97412109375,-18.31884765625],[23.298632812500017,-18.02734375],[23.58056640625,-18.452929687500003],[24.358984375000006,-17.97822265625001],[25.2587890625,-17.793554687500006]]]},properties:{name:"Botswana",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[22.86005859375001,10.919677734375],[23.312304687500017,10.387939453125],[23.646289062500017,9.822900390624994],[23.53730468750001,8.815820312499994],[24.147363281250023,8.665624999999991],[24.291406250000023,8.291406249999994],[24.853320312500017,8.137548828124991],[25.247363281250017,7.724560546874997],[25.380664062500017,7.333398437499994],[25.888964843750017,7.06494140625],[26.36181640625,6.635302734374989],[26.514257812500006,6.069238281249994],[27.083398437500023,5.77685546875],[27.4033203125,5.109179687499989],[27.11494140625001,5.1978515624999915],[26.822070312500017,5.062402343749994],[25.52509765625001,5.3121093749999915],[25.249316406250017,5.024560546874994],[24.765527343750023,4.930078124999994],[24.31982421875,4.994140625],[23.41718750000001,4.663134765624989],[22.755761718750023,4.646679687499997],[22.422167968750017,4.134960937499997],[21.53759765625,4.244824218749997],[20.55810546875,4.462695312499989],[20.226367187500017,4.829638671874989],[19.806542968750023,5.089306640624997],[19.5009765625,5.127490234374989],[19.06855468750001,4.891406249999989],[18.567480468750006,4.257568359375],[18.6103515625,3.4784179687499943],[18.160937500000017,3.4998046874999886],[17.43798828125,3.6846191406249886],[16.67333984375,3.5352050781249886],[16.468554687500017,2.831738281249997],[16.183398437500017,2.2700683593749886],[16.0634765625,2.9085937499999943],[15.775000000000006,3.127197265625],[15.128710937500017,3.826904296875],[15.022753906250017,4.358544921874994],[14.708984375,4.665576171874989],[14.616894531250011,5.865136718749994],[14.7392578125,6.27978515625],[15.245898437500017,7.263574218749994],[15.480078125000006,7.5237792968749915],[15.845019531250017,7.475292968749997],[16.37890625,7.683544921874997],[16.784765625000006,7.550976562499997],[17.6494140625,7.983593749999997],[18.455078125,8.032031249999989],[19.108691406250017,8.656152343749994],[19.1455078125,9.015966796874991],[20.342089843750017,9.127099609374994],[20.773242187500017,9.405664062499994],[21.26386718750001,9.974609375],[21.72578125000001,10.366552734374991],[21.70654296875,10.574804687499991],[22.49384765625001,10.996240234374994],[22.86005859375001,10.919677734375]]]},properties:{name:"Central African Republic",childNum:1}},{geometry:{type:"MultiPolygon",coordinates:[[[[-61.10517578124998,45.94472656250002],[-60.80610351562498,45.73808593750002],[-60.50493164062502,46.20385742187497],[-59.86503906249993,46.159521484375006],[-60.38608398437495,45.65463867187498],[-61.28369140624994,45.573876953124966],[-61.49531249999998,45.94145507812499],[-60.87016601562499,46.796777343749966],[-60.33173828124998,46.76782226562503],[-60.57685546875001,46.17216796874999],[-61.10517578124998,45.94472656250002]]],[[[-63.811279296875,46.46870117187501],[-63.12939453125,46.422216796875034],[-62.16357421874997,46.487207031249966],[-62.878369140624926,46.00136718750002],[-63.641015624999966,46.23046874999997],[-63.811279296875,46.46870117187501]]],[[[-74.70888671874997,45.0038574218751],[-73.55810546875,45.425097656250045],[-73.1595703125,46.01005859375002],[-71.90092773437499,46.63193359375006],[-71.26118164062495,46.756249999999966],[-70.51948242187501,47.032519531250045],[-68.987060546875,48.275000000000034],[-67.56088867187498,48.85595703125],[-66.17817382812493,49.21313476562503],[-64.83632812499994,49.191748046875006],[-64.26181640624995,48.921875],[-64.253759765625,48.550390625000006],[-65.259423828125,48.02124023437503],[-65.92670898437495,48.188867187499994],[-65.66645507812495,47.69614257812506],[-65.22817382812502,47.81127929687497],[-64.70322265625,47.72485351562503],[-64.91220703125003,47.36865234375003],[-65.31889648437502,47.101220703124994],[-64.90576171874997,46.88793945312497],[-64.54150390625,46.240332031250034],[-63.29277343749999,45.751953125],[-62.483056640624966,45.62182617187506],[-61.955517578124955,45.86816406249997],[-61.49228515624998,45.68701171875],[-61.28378906249998,45.23549804687505],[-63.761132812499994,44.486425781250034],[-64.28608398437493,44.55034179687499],[-64.86235351562499,43.867871093749955],[-65.73813476562498,43.56074218750001],[-66.125732421875,43.813818359375034],[-66.09956054687498,44.367480468750045],[-65.65673828125,44.760302734375045],[-64.44882812499995,45.256054687499955],[-64.89790039062495,45.6259765625],[-65.88447265624995,45.22290039062506],[-66.87246093749997,45.067285156249966],[-67.12485351562498,45.16943359375],[-67.47255859375002,45.27587890625],[-67.43266601562496,45.60312499999998],[-67.78466796875,45.70170898437499],[-67.806787109375,47.08281249999999],[-68.310888671875,47.3544921875],[-68.82871093749998,47.20332031250001],[-69.24287109374998,47.46298828124998],[-70.00771484375002,46.70893554687501],[-70.296240234375,45.90610351562506],[-70.89799804687493,45.26245117187503],[-71.327294921875,45.29008789062496],[-71.51752929687495,45.00756835937497],[-74.663232421875,45.00390625000003],[-74.70888671874997,45.0038574218751]]],[[[-61.801123046875034,49.093896484374966],[-62.21953124999999,49.07910156249997],[-63.565869140624926,49.39931640625002],[-64.13144531249995,49.94165039062503],[-62.858544921874966,49.70546875000005],[-61.817138671875,49.28354492187498],[-61.801123046875034,49.093896484374966]]],[[[-127.19731445312495,50.640380859375],[-125.48208007812501,50.316796874999966],[-124.64287109375002,49.428662109374955],[-123.99580078125,49.22402343750002],[-123.49702148437498,48.58208007812499],[-123.59462890624998,48.33354492187496],[-124.689404296875,48.597314453124966],[-125.82851562499998,49.09184570312499],[-125.83544921874997,49.27666015624999],[-126.54853515625003,49.41894531250003],[-126.68310546875,49.87646484374997],[-127.114306640625,49.879736328125034],[-128.267431640625,50.609277343749966],[-127.91806640624998,50.86054687500001],[-127.19731445312495,50.640380859375]]],[[[-55.45874023437494,51.53652343750005],[-55.87138671874999,50.90737304687502],[-56.693994140624966,50.059667968750006],[-55.764746093750034,49.96044921875003],[-55.892041015624926,49.58027343750004],[-55.02617187500002,49.30537109374998],[-54.579052734374955,49.490820312500006],[-53.957714843749955,49.44184570312498],[-53.57343750000001,49.141210937500034],[-53.852880859375006,48.81132812499996],[-53.53120117187501,48.231884765624955],[-52.95498046874994,48.02929687499997],[-53.17553710937503,47.652978515624966],[-52.653662109375034,47.549414062500006],[-53.06977539062498,46.68125000000006],[-53.61635742187494,46.680273437500034],[-54.173730468749994,46.88037109375003],[-53.86909179687501,47.38701171874996],[-54.856640624999955,47.385009765625],[-56.22128906249995,47.67138671874997],[-56.95249023437498,47.57446289062506],[-58.33320312499998,47.676855468750034],[-59.11694335937494,47.570703124999994],[-59.36240234374995,47.865673828124955],[-58.71059570312494,48.325048828125006],[-58.716455078124994,48.59804687500002],[-58.01582031249998,49.54248046874997],[-57.29799804687502,50.69873046874997],[-56.75019531249998,51.27490234375003],[-56.025585937499955,51.56835937500006],[-55.45874023437494,51.53652343750005]]],[[[-80.73168945312494,52.74726562499998],[-81.83906249999995,52.957910156249994],[-81.84731445312494,53.18627929687497],[-81.135595703125,53.20581054687503],[-80.73168945312494,52.74726562499998]]],[[[-131.7537109375,53.195556640625],[-131.727294921875,52.75639648437496],[-132.16508789062493,52.783300781250034],[-132.34541015625,53.136083984375034],[-131.7537109375,53.195556640625]]],[[[-132.65551757812503,54.12749023437496],[-131.70253906250002,53.98637695312499],[-132.01132812499998,53.26518554687496],[-132.747509765625,53.310498046874955],[-133.05224609375003,53.77812500000002],[-132.65551757812503,54.12749023437496]]],[[[-78.93559570312496,56.26606445312498],[-79.17548828124998,55.88505859374999],[-80.00078124999999,55.93208007812498],[-79.59633789062502,56.244482421875034],[-78.93559570312496,56.26606445312498]]],[[[-79.54531250000002,62.41171875000006],[-79.32392578124995,62.02607421875001],[-79.71425781249997,61.61254882812503],[-80.27617187499996,61.85859374999998],[-80.23466796874996,62.152685546875034],[-79.54531250000002,62.41171875000006]]],[[[-82.00048828124997,62.95419921874998],[-82.11372070312495,62.65224609375002],[-83.01582031249998,62.20991210937498],[-83.69887695312497,62.16025390624998],[-83.899267578125,62.476464843749994],[-83.37641601562498,62.904931640624994],[-82.00048828124997,62.95419921874998]]],[[[-84.91962890624995,65.26108398437503],[-83.40712890625002,65.10390625],[-82.04999999999995,64.64428710937506],[-81.71611328124996,64.021875],[-80.82895507812495,64.08994140625],[-80.30205078124999,63.76220703125003],[-81.04638671875003,63.461572265624966],[-82.37812500000001,63.706787109375],[-82.46708984375002,63.92695312500001],[-83.49433593749993,64.09921875000003],[-83.728271484375,63.813378906249966],[-84.63291015625,63.30922851562502],[-85.49550781249997,63.13911132812501],[-85.71416015625002,63.657958984375],[-87.18891601562498,63.672265624999994],[-86.252099609375,64.13686523437497],[-86.37426757812503,64.56582031249997],[-85.96166992187497,65.704248046875],[-85.24111328125,65.7955078125],[-84.91962890624995,65.26108398437503]]],[[[-75.67587890624998,68.32250976562506],[-75.15380859375,68.23403320312497],[-75.12729492187503,67.53730468749995],[-75.78007812499996,67.28354492187503],[-77.0048828125,67.26694335937503],[-77.30590820312497,67.70610351562505],[-76.740234375,68.23125000000002],[-75.67587890624998,68.32250976562506]]],[[[-97.439453125,69.64267578125006],[-96.29995117187494,69.34438476562505],[-95.68564453125003,68.73583984375006],[-96.40156249999995,68.47070312500003],[-97.47202148437498,68.543701171875],[-99.25400390625002,68.86318359374997],[-99.56406249999995,69.03413085937498],[-97.439453125,69.64267578125006]]],[[[-74.70888671874997,45.0038574218751],[-74.76245117187494,44.99907226562502],[-74.99614257812496,44.970117187499966],[-75.40126953124997,44.77226562499999],[-75.81933593749997,44.468017578125],[-76.18579101562503,44.24223632812502],[-76.819970703125,43.62880859375011],[-77.87924804687489,43.62954101562508],[-78.45825195312497,43.63149414062511],[-78.72041015624993,43.62495117187501],[-78.84555664062492,43.58334960937506],[-79.17187499999997,43.466552734375085],[-79.0830566406249,43.33139648437509],[-79.05922851562494,43.27807617187506],[-79.066064453125,43.10610351562502],[-79.02617187499996,43.01733398437506],[-78.98076171874993,42.98061523437502],[-78.91508789062496,42.90913085937504],[-79.17373046875,42.74853515625],[-80.24755859374991,42.366015625000045],[-81.02822265624997,42.247167968750006],[-81.50732421874997,42.10346679687504],[-81.97416992187496,41.88872070312499],[-82.69003906249995,41.675195312499994],[-83.141943359375,41.97587890624996],[-83.10952148437497,42.25068359375001],[-82.54531249999997,42.62470703124998],[-82.19038085937495,43.47407226562501],[-82.137841796875,43.570898437500034],[-82.48505859374993,45.08374023437503],[-82.91933593749994,45.51796875000002],[-83.59267578125,45.81713867187506],[-83.61596679687503,46.116845703124994],[-83.97778320312494,46.08491210937507],[-84.12319335937497,46.50292968749997],[-84.44047851562496,46.49814453125006],[-84.66577148437503,46.54326171875002],[-84.87597656249994,46.89990234375003],[-85.07006835937497,46.97993164062498],[-85.65224609375,47.21997070312503],[-86.67216796874996,47.636425781249955],[-87.20800781249997,47.848486328125006],[-87.74389648437497,48.06054687500003],[-88.37817382812497,48.30307617187506],[-89.45566406249992,47.99624023437508],[-90.79731445312495,48.13105468750001],[-91.38720703124997,48.05854492187498],[-92.00517578125002,48.301855468750006],[-92.34843749999996,48.276611328125],[-92.41459960937493,48.276611328125],[-92.50058593749995,48.43535156250002],[-92.83671874999996,48.567773437499994],[-93.25795898437497,48.62885742187501],[-93.37788085937498,48.61655273437498],[-93.85161132812496,48.607275390625034],[-94.71279296874997,48.863427734374994],[-94.80346679687497,49.0029296875],[-94.86040039062493,49.258593750000045],[-94.85434570312495,49.304589843749994],[-95.16206054687493,48.991748046875045],[-95.39790039062493,48.99316406249997],[-96.25068359374993,48.99316406249997],[-96.67705078124993,48.99316406249997],[-97.52983398437493,48.99316406249997],[-98.80898437499995,48.99316406249997],[-102.64643554687497,48.993115234375125],[-105.63110351562497,48.993115234375125],[-107.76298828124989,48.993115234375125],[-109.4685546874999,48.993066406250136],[-112.45322265625,48.993066406250136],[-115.86425781249993,48.993066406250136],[-117.99619140624993,48.993066406250136],[-118.84892578124993,48.993066406250136],[-119.27534179687494,48.993066406250136],[-119.70170898437495,48.99301757812495],[-120.98085937499995,48.99301757812495],[-122.78876953124994,48.99301757812495],[-122.82670898437495,49.028417968750034],[-122.9241699218749,49.07465820312504],[-123.04921874999998,48.993017578125034],[-123.33564453124997,49.45917968750004],[-123.85893554687492,49.48286132812507],[-124.14160156249994,49.792675781250125],[-124.78237304687492,50.02011718749992],[-125.05668945312495,50.418652343750125],[-126.4044921875,50.529882812500034],[-126.397119140625,50.80708007812504],[-127.057568359375,50.86752929687509],[-127.70810546875,51.15117187499996],[-127.644873046875,51.47846679687504],[-128.3576171875,52.1588867187501],[-128.1087890624999,52.85805664062508],[-128.6523437499999,53.24384765624998],[-129.28427734374995,53.393164062500006],[-129.56372070312506,53.251464843750114],[-130.33525390625002,53.723925781250074],[-130.04331054687495,54.13354492187503],[-130.4302734375,54.42099609374998],[-129.89013671874994,55.16464843749995],[-130.01406249999997,55.950537109375006],[-130.09785156249995,56.10927734375002],[-130.47709960937496,56.230566406250034],[-130.649072265625,56.26367187500003],[-131.86616210937495,56.792822265625006],[-132.062890625,56.95336914062503],[-133.00141601562495,57.948974609375],[-133.27529296875,58.22285156250004],[-133.54638671874997,58.50346679687499],[-134.21850585937503,58.849902343750045],[-134.32963867187505,58.93969726562506],[-134.39306640625,59.009179687499994],[-134.67724609374997,59.19926757812499],[-134.94375,59.28828125000001],[-135.36787109374998,59.743310546874994],[-135.70258789062504,59.72875976562506],[-136.46635742187493,59.459082031250006],[-136.81328125000002,59.15004882812511],[-137.59331054687493,59.22626953124998],[-138.317626953125,59.611132812500074],[-138.70546874999997,59.90131835937504],[-139.23476562499997,60.339746093749994],[-139.67631835937505,60.32832031249998],[-139.97329101562497,60.183154296875074],[-140.45283203125004,60.29970703125002],[-141.00214843750004,60.300244140625125],[-141.00214843750004,60.884667968749994],[-141.00214843750004,61.761279296875045],[-141.00214843750004,63.22226562499998],[-141.00214843750004,64.09887695312506],[-141.00214843750004,65.55991210937498],[-141.00214843750004,66.43652343750006],[-141.00214843750004,67.89755859374998],[-141.00214843750004,68.77416992187506],[-141.00214843750004,69.65078125000011],[-139.18154296874997,69.51552734375008],[-138.12836914062495,69.15195312500009],[-136.71733398437493,68.88916015625003],[-135.876318359375,68.9169921875],[-135.6914550781249,69.31118164062502],[-135.1408203124999,69.46782226562496],[-133.16313476562496,69.43388671874999],[-130.49843749999997,70.14316406250006],[-128.9714355468749,69.71240234375006],[-127.76494140624995,70.2218750000001],[-127.13847656249996,70.23935546874995],[-126.06381835937495,69.46708984374999],[-124.767919921875,69.99003906249996],[-123.60913085937491,69.37744140625003],[-123.02578125,69.81000976562504],[-120.96245117187502,69.66040039062511],[-120.29252929687496,69.42055664062511],[-118.86870117187496,69.25717773437503],[-118.09521484374994,69.0429199218751],[-116.06523437500002,68.85541992187507],[-115.63115234374995,68.97255859375014],[-114.41386718749993,68.65957031250014],[-115.42685546874989,67.92353515625013],[-113.89321289062501,67.70688476562503],[-112.43515624999988,67.68476562499998],[-110.9900390624999,67.79082031250007],[-110.04248046874994,67.97719726562505],[-109.63037109374991,67.73271484374996],[-108.59291992187495,67.59086914062502],[-107.15649414062497,66.88173828124997],[-108.26103515625002,68.14990234375006],[-108.31347656249996,68.61079101562498],[-106.16445312499992,68.91987304687507],[-105.42861328124994,68.458251953125],[-104.19355468749994,68.03120117187504],[-103.47412109374993,68.11503906250005],[-102.69199218749992,67.81157226562505],[-101.55498046874992,67.69316406250007],[-100.45610351562496,67.83945312500003],[-99.14687499999995,67.72363281250009],[-98.41713867187497,67.82646484375007],[-98.21855468750002,68.31743164062507],[-97.2659179687499,68.45292968749996],[-96.03603515625,68.15776367187505],[-96.37138671875002,67.55385742187514],[-95.78251953124996,67.19379882812513],[-95.25874023437493,67.26254882812492],[-95.65048828124986,67.73745117187505],[-93.65170898437489,68.54311523437505],[-93.68144531249993,68.88725585937499],[-94.2708007812499,69.45512695312505],[-96.11909179687504,69.87187500000005],[-96.54560546874998,70.32724609375009],[-96.4056640625,71.27363281249998],[-95.20122070312493,71.90371093750008],[-94.30834960937491,71.76489257812506],[-92.94868164062493,71.26210937500011],[-92.98144531249994,70.8522460937501],[-91.56406249999995,70.1782714843751],[-92.75092773437498,69.71391601562502],[-90.82211914062495,69.29047851562507],[-90.468359375,68.86376953125],[-89.05673828124992,69.26611328125009],[-88.041357421875,68.81171875000007],[-87.81030273437491,68.40415039062498],[-88.34697265624993,68.28828125000001],[-88.19589843749986,67.76582031249995],[-87.26625976562494,67.18383789062506],[-86.53642578125002,67.51616210937507],[-85.9525878906249,68.0724609375001],[-85.73383789062493,68.630126953125],[-84.86220703125,69.07397460937503],[-85.38676757812493,69.23188476562504],[-85.50737304687487,69.84526367187493],[-82.61835937499993,69.69106445312514],[-82.64204101562495,69.4583984375],[-81.3286621093749,69.11992187499996],[-81.28154296874987,68.65722656250003],[-82.55268554687504,68.44648437500007],[-81.97646484374997,67.86201171875001],[-81.27011718749995,67.45991210937498],[-81.46757812499996,67.0698730468751],[-82.64150390624991,66.58750000000006],[-84.47841796875005,66.17929687500003],[-85.44223632812495,66.53735351562497],[-86.63320312499991,66.53134765625],[-86.04287109375,66.02255859375009],[-87.2914550781249,65.35483398437495],[-87.28051757812491,64.82617187500006],[-88.10561523437497,64.18330078125001],[-88.65302734374993,64.00937499999992],[-90.14189453125002,63.981982421875045],[-90.01342773437497,63.80429687500006],[-91.33007812499997,63.50683593750006],[-90.74658203124994,63.35156250000003],[-90.87119140625,62.945947265624994],[-91.44897460937503,62.804052734375034],[-92.3612792968749,62.81938476562496],[-93.42060546874998,61.705810546875114],[-94.06074218749993,61.317822265625125],[-94.64677734374993,60.416406249999994],[-94.78579101562494,59.953320312499955],[-94.71337890624991,58.903320312500114],[-94.28706054687493,58.716015625000125],[-93.2781249999999,58.75639648437502],[-92.24902343749994,57.00898437500001],[-91.11127929687498,57.24121093750006],[-90.59218749999991,57.224462890625034],[-89.7908203124999,56.98134765625005],[-88.94848632812489,56.85131835937503],[-88.07509765624997,56.46728515624994],[-87.560888671875,56.05634765625007],[-85.67666015625,55.60107421875006],[-85.06093749999997,55.285644531250085],[-83.91059570312493,55.314648437499955],[-82.57744140625002,55.1487304687501],[-82.219384765625,54.8134765625],[-82.41806640624986,54.355810546875034],[-82.14145507812492,53.81762695312497],[-82.26044921874993,52.9611328125001],[-81.5994140624999,52.432617187500085],[-81.66123046874986,52.29389648437507],[-80.65795898437503,51.75834960937502],[-80.36796875000002,51.32988281249996],[-79.83623046874996,51.17333984375003],[-79.49755859374997,51.569921875000006],[-78.97773437499993,51.733789062499994],[-78.49165039062495,52.25209960937508],[-78.723779296875,52.627734375000045],[-79.241796875,54.098876953125085],[-79.66552734374991,54.69746093749998],[-77.89111328124989,55.236425781250006],[-77.32495117187494,55.555517578125006],[-76.65048828124992,56.10722656249996],[-76.5728515625,57.1812011718751],[-77.15678710937496,58.018896484375034],[-78.51508789062493,58.68237304687503],[-77.76069335937498,59.38002929687505],[-77.31181640624993,60.042382812499994],[-77.8715332031249,60.7858398437501],[-77.73618164062495,61.43735351562498],[-78.13715820312493,62.10737304687504],[-78.06811523437489,62.355419921875125],[-77.372412109375,62.572509765625114],[-74.68989257812493,62.18344726562509],[-73.62998046874989,62.454199218750006],[-72.0814453125,61.728271484375085],[-71.42270507812489,61.158935546875085],[-70.27929687499991,61.06865234374999],[-69.64047851562489,60.68979492187509],[-69.75590820312496,60.38852539062498],[-69.68188476562489,59.34174804687507],[-69.17348632812497,58.896630859374994],[-68.69819335937495,58.904541015625],[-67.5696289062499,58.21347656250006],[-66.60791015624991,58.548925781250034],[-65.60624999999993,59.11074218750008],[-65.4333984374999,59.776513671874994],[-64.93125,60.252001953125074],[-64.49941406250005,60.26826171875001],[-63.18535156249993,58.85776367187506],[-62.593847656249864,58.47402343750005],[-62.30566406249997,57.97226562499995],[-61.899072265624994,57.861328125000085],[-61.851074218749886,57.38129882812501],[-61.33374023437494,57.01059570312498],[-61.514599609374926,56.3903320312501],[-59.93032226562491,55.25942382812508],[-58.99711914062496,55.149462890625074],[-58.780175781249994,54.838378906250114],[-58.195263671874926,54.86591796875004],[-57.40444335937494,54.570410156250034],[-58.15136718749997,54.350439453125006],[-57.4160644531249,54.162744140625136],[-57.14897460937493,53.847705078125074],[-56.46499023437505,53.76503906250011],[-55.79794921874995,53.211962890625045],[-55.83364257812494,52.31040039062506],[-55.695214843749994,52.13779296875006],[-56.97597656250005,51.45766601562505],[-58.510351562500006,51.295068359375136],[-59.16538085937495,50.779882812500006],[-60.08017578124989,50.2545898437501],[-61.289746093749926,50.20195312500002],[-62.71542968749995,50.30166015625008],[-64.86787109374998,50.27548828125009],[-65.2686035156249,50.3200195312501],[-66.49550781249991,50.2118652343751],[-66.94116210937503,49.993701171875045],[-67.37202148437495,49.348437500000045],[-68.28193359374998,49.197167968750136],[-68.929052734375,48.82895507812509],[-69.77499999999995,48.09809570312504],[-69.9055664062499,47.83222656250007],[-70.70585937499996,47.13979492187505],[-71.26777343749995,46.79594726562499],[-71.87958984374998,46.68681640624996],[-72.98100585937493,46.209716796875085],[-73.97382812499995,45.345117187499994],[-74.70888671874997,45.0038574218751]]],[[[-114.52153320312502,72.592919921875],[-113.50004882812502,72.69443359375006],[-112.75361328125001,72.98603515624995],[-111.26972656249994,72.71372070312498],[-108.69829101562502,72.499267578125],[-108.23823242187498,73.10581054687503],[-107.72001953125002,73.32905273437504],[-106.48212890624998,73.19619140624997],[-105.41513671874995,72.788330078125],[-104.34956054687501,71.43398437500005],[-104.56958007812499,71.10405273437507],[-103.10498046874994,70.51025390624997],[-101.14853515624998,70.147607421875],[-100.93510742187493,69.71533203125003],[-102.18212890624997,69.845947265625],[-101.85712890625001,69.02397460937505],[-103.46821289062497,68.80854492187504],[-105.019580078125,69.08124999999998],[-106.140869140625,69.16201171875002],[-106.65908203124997,69.439599609375],[-107.43989257812497,69.00214843749995],[-108.9458984375,68.75981445312505],[-111.3109375,68.54204101562502],[-113.12773437500002,68.49414062500003],[-113.69414062499995,69.19501953124998],[-116.51347656249993,69.42460937500005],[-117.13544921875,70.10014648437499],[-114.59233398437497,70.31245117187498],[-112.63789062499997,70.225244140625],[-112.11416015624994,70.44687500000003],[-113.75727539062503,70.69072265625005],[-115.99091796874997,70.586279296875],[-117.58706054687498,70.62954101562502],[-118.26406249999998,70.888330078125],[-117.81406249999996,71.15844726562503],[-118.868408203125,71.68676757812503],[-118.94462890624997,71.98554687499995],[-118.21347656249998,72.26289062499998],[-118.37451171875,72.53388671875004],[-116.57324218749994,73.05493164062506],[-114.63823242187499,73.37265625000003],[-114.05170898437497,73.07099609375004],[-114.52153320312502,72.592919921875]]],[[[-105.28891601562499,72.919921875],[-106.92153320312497,73.479833984375],[-105.51230468750002,73.765771484375],[-104.58286132812493,73.35390625000002],[-105.28891601562499,72.919921875]]],[[[-79.53730468749998,73.65449218749998],[-78.2865234375,73.66582031250007],[-77.20654296874997,73.49956054687505],[-76.28955078125003,73.08100585937504],[-76.400537109375,72.820654296875],[-77.83593750000003,72.89682617187498],[-79.50053710937496,72.75595703124998],[-80.82416992187495,73.38066406250007],[-80.84887695312503,73.72124023437499],[-79.53730468749998,73.65449218749998]]],[[[-86.58935546874997,71.01079101562507],[-84.78959960937493,71.09326171875],[-84.65996093749999,71.58613281249995],[-85.91162109375,71.98652343749998],[-85.34111328124993,72.42153320312497],[-85.64453125000003,72.77446289062502],[-85.018408203125,73.33549804687502],[-82.65961914062498,73.72958984375],[-81.40615234374997,73.634521484375],[-80.27470703124993,72.74555664062498],[-80.94121093750002,72.21015624999998],[-79.000244140625,72.27202148437507],[-78.00102539062499,72.68759765625],[-76.89350585937495,72.72065429687498],[-75.18579101562494,72.434228515625],[-74.31572265624999,71.84267578125],[-71.45991210937493,71.46372070312498],[-70.56093750000002,70.73828124999997],[-69.16870117187497,70.76416015625],[-67.36367187499994,70.03442382812503],[-68.51303710937498,69.57729492187497],[-66.77084960937498,69.33666992187497],[-67.75170898437494,69.038671875],[-68.037939453125,68.55073242187501],[-67.032958984375,68.32607421874997],[-66.2251953125,67.958740234375],[-64.52753906250001,67.81269531250001],[-64.00795898437502,67.34731445312497],[-61.96855468749993,67.01904296874997],[-61.29970703125002,66.64873046875002],[-61.99160156250002,66.03530273437502],[-62.65888671874998,65.63994140625002],[-63.36425781249997,65.54321289062503],[-63.40180664062498,65.11845703125002],[-64.66533203125002,65.1689453125],[-65.401611328125,65.764013671875],[-65.30537109374993,66.00844726562497],[-66.47695312499997,66.27973632812498],[-67.18320312499995,66.03442382812503],[-68.2568359375,65.93862304687505],[-67.30341796874993,65.48291015625],[-66.86064453124996,65.09160156250005],[-65.2748046875,64.63154296875004],[-64.67846679687503,64.027978515625],[-64.51435546874998,63.263964843750045],[-65.06894531249998,63.26347656250002],[-65.26582031249995,62.71508789062503],[-65.978857421875,63.000683593749955],[-67.67597656249998,63.093554687500045],[-66.28124999999997,62.302685546874955],[-66.25668945312503,61.868261718750006],[-67.44013671874998,62.15126953125002],[-69.08232421874996,62.405175781249966],[-69.54516601562503,62.74458007812501],[-70.23613281250002,62.76337890625001],[-71.25371093749993,63.042529296875045],[-73.44365234374996,64.423486328125],[-74.512451171875,64.670166015625],[-75.0673828125,64.45668945312502],[-76.72382812499995,64.24204101562498],[-77.79116210937497,64.36708984374997],[-78.09560546875,64.93925781250002],[-77.44746093749993,65.16157226562501],[-77.32670898437493,65.45312499999997],[-75.82832031249993,65.22705078125003],[-73.56074218750001,65.54291992187498],[-74.433935546875,66.139013671875],[-72.22001953124999,67.25429687500002],[-73.32822265624998,68.26674804687497],[-74.64794921874997,68.70751953124997],[-74.91728515624996,68.98286132812501],[-76.40341796874995,68.69233398437498],[-75.78715820312499,69.31865234375005],[-77.12880859374994,69.65273437499997],[-78.809814453125,70.17856445312498],[-79.61591796875001,69.89472656249998],[-81.09829101562494,70.09116210937503],[-82.13872070312499,69.8412109375],[-86.32202148437503,70.14541015625],[-86.62431640624999,70.40126953124997],[-87.90068359374996,70.25190429687501],[-88.84843749999993,70.52290039062498],[-89.36552734374996,71.06718750000002],[-87.84492187499995,70.94438476562505],[-87.87246093749997,71.20854492187505],[-89.079345703125,71.28793945312503],[-89.84575195312499,71.49228515625],[-90.02519531249996,71.94877929687502],[-89.26323242187499,73.068994140625],[-87.71977539062496,73.72290039062497],[-86.76875000000001,73.83398437500006],[-84.97451171874997,73.69477539062501],[-86.62934570312493,72.87080078125001],[-86.03613281249997,71.77094726562504],[-85.02338867187495,71.35322265625001],[-86.58935546874997,71.01079101562507]]],[[[-100.00190429687497,73.9458984375],[-99.15795898437499,73.73159179687497],[-97.58183593749996,73.88754882812503],[-97.001708984375,73.66650390625003],[-97.79589843749997,73.285302734375],[-97.05180664062499,72.63681640625003],[-96.61342773437494,71.83383789062506],[-98.66289062499993,71.302099609375],[-99.167138671875,71.36718750000003],[-100.594482421875,72.15234375000003],[-101.72392578124996,72.31489257812501],[-102.71367187499999,72.78291015624995],[-100.48476562500002,72.77294921874997],[-100.28266601562497,73.12031249999995],[-101.45087890625003,73.43095703125002],[-100.91513671874995,73.80537109374998],[-100.00190429687497,73.9458984375]]],[[[-93.17084960937498,74.16098632812506],[-92.22270507812502,73.97236328124998],[-90.35458984375,73.86865234375],[-92.11791992187497,72.75380859375],[-93.34062499999993,72.80185546875],[-94.03754882812498,72.02875976562498],[-95.19296875,72.02744140624998],[-95.54760742187497,72.78154296875005],[-95.63291015625003,73.69545898437497],[-95.03984374999999,74.02387695312501],[-93.17084960937498,74.16098632812506]]],[[[-119.73632812499997,74.11264648437498],[-117.96586914062497,74.26606445312495],[-117.19882812500003,74.171142578125],[-115.51069335937501,73.61874999999998],[-115.44687499999998,73.43886718750002],[-118.96157226562497,72.68413085937499],[-120.17988281250001,72.21264648437506],[-120.61933593750001,71.50576171875002],[-123.210595703125,71.12343750000002],[-124.00776367187494,71.67744140624998],[-125.76259765624997,72.13750000000002],[-124.98710937499997,72.58798828125003],[-124.83642578125001,73.07626953125003],[-123.79726562499997,73.76816406250003],[-124.69624023437497,74.34819335937499],[-121.31523437499995,74.52998046874998],[-119.73632812499997,74.11264648437498]]],[[[-93.54257812499995,75.0279296875],[-93.54716796875002,74.69106445312505],[-94.697265625,74.64218750000003],[-96.565771484375,75.09873046875003],[-95.67080078125002,75.52866210937498],[-94.42724609374997,75.593359375],[-93.54257812499995,75.0279296875]]],[[[-102.22734374999995,76.014892578125],[-103.31474609374996,75.76420898437499],[-104.35063476562497,76.18232421875001],[-102.58408203124996,76.281640625],[-102.22734374999995,76.014892578125]]],[[[-97.70092773437497,76.46650390624998],[-97.40961914062495,75.55209960937503],[-97.79936523437496,75.11665039062495],[-100.234375,75.00771484374997],[-100.71191406250003,75.40634765625],[-102.54140624999998,75.51362304687501],[-101.43134765624995,75.99199218750005],[-102.13774414062499,76.28486328125001],[-100.38793945312501,76.61357421875002],[-97.70092773437497,76.46650390624998]]],[[[-108.29238281250001,76.05712890625],[-105.48090820312503,75.74565429687505],[-105.86259765624997,75.19155273437505],[-107.15341796874996,74.9271484375],[-108.83129882812501,75.06489257812498],[-110.94086914062501,74.63872070312505],[-112.51933593749997,74.41684570312503],[-113.51406249999994,74.430078125],[-114.45175781250002,75.08789062499997],[-115.72885742187496,74.968115234375],[-117.60009765624997,75.27167968750001],[-116.60976562500001,76.07373046875],[-115.58066406249996,76.43750000000003],[-114.19394531249999,76.45146484375005],[-112.69760742187496,76.20170898437505],[-111.05268554687495,75.54853515625001],[-109.08637695312503,75.506494140625],[-109.79604492187501,75.86303710937497],[-109.48681640624999,76.14467773437497],[-110.27001953125003,76.41699218750003],[-108.62763671875001,76.58671875000005],[-108.29238281250001,76.05712890625]]],[[[-94.29497070312493,76.91245117187498],[-92.71625976562493,76.60297851562498],[-91.305029296875,76.68076171875003],[-90.25136718749994,76.05346679687503],[-88.201318359375,75.51201171875005],[-86.06874999999994,75.50224609375002],[-83.931982421875,75.81894531250003],[-82.153662109375,75.83105468750003],[-79.66020507812499,75.44951171875002],[-79.50795898437497,74.880126953125],[-80.27773437500002,74.58159179687502],[-81.80883789062503,74.47661132812505],[-88.42304687499995,74.49414062499997],[-89.844384765625,74.54858398437497],[-91.96157226562502,74.79321289062497],[-92.427099609375,75.34638671874995],[-92.18510742187499,75.84653320312498],[-93.09174804687495,76.35400390624997],[-95.27387695312498,76.26440429687503],[-96.63969726562496,76.70292968750002],[-95.63823242187496,77.06376953124999],[-94.29497070312493,76.91245117187498]]],[[[-115.55126953125001,77.36328125],[-116.22045898437501,76.61108398437506],[-119.36791992187497,76.22177734375003],[-119.91289062499997,75.85883789062501],[-121.90820312499996,76.03476562500006],[-121.61376953125001,76.44145507812505],[-119.09018554687496,77.30507812500002],[-115.55126953125001,77.36328125]]],[[[-95.48437499999997,77.79199218750003],[-93.30097656249995,77.73979492187505],[-93.51958007812499,77.47441406250007],[-95.98706054687497,77.484130859375],[-95.48437499999997,77.79199218750003]]],[[[-110.45805664062496,78.10322265625001],[-109.77177734374995,77.95742187499997],[-110.19848632812501,77.52451171874998],[-111.95195312500002,77.34418945312501],[-113.16435546875002,77.5302734375],[-113.21518554687498,77.90351562500001],[-110.45805664062496,78.10322265625001]]],[[[-109.81596679687499,78.65039062500003],[-109.39052734375,78.33666992187506],[-113.14995117187502,78.40839843750001],[-110.40781249999995,78.75664062499999],[-109.81596679687499,78.65039062500003]]],[[[-96.20449218749994,78.53129882812499],[-94.88715820312498,78.34521484375003],[-95.08701171875,77.99262695312495],[-96.98964843749994,77.80600585937503],[-98.25493164062496,78.42924804687499],[-96.20449218749994,78.53129882812499]]],[[[-103.42602539062499,79.31562500000001],[-99.60942382812495,78.58305664062507],[-99.16640625000002,77.85693359375003],[-100.58603515624996,77.89179687500001],[-101.07412109375001,78.19384765625],[-102.73134765624995,78.37104492187495],[-103.51835937499996,78.76914062500006],[-105.53564453124999,79.03251953125007],[-105.38769531249994,79.32358398437503],[-103.42602539062499,79.31562500000001]]],[[[-91.88554687499999,81.13286132812505],[-90.64301757812498,80.59370117187498],[-87.67499999999998,80.37211914062505],[-87.14423828124993,79.66264648437502],[-85.5013671875,79.53032226562505],[-85.28984374999999,79.208349609375],[-87.016455078125,78.89868164062497],[-88.79101562499997,78.19243164062507],[-90.614404296875,78.14985351562501],[-92.67827148437502,78.38911132812498],[-95.10317382812502,79.289892578125],[-95.29697265624998,79.653076171875],[-96.77324218749999,80.13579101562502],[-95.61445312499998,80.39624023437497],[-96.1328125,80.69140624999997],[-95.26977539062503,81.00078125000005],[-91.88554687499999,81.13286132812505]]],[[[-69.4888671875,83.01679687499998],[-64.77675781249997,82.87646484374997],[-61.392480468749994,82.44189453125],[-62.17670898437498,82.04340820312498],[-64.57402343749996,81.73374023437506],[-65.48398437499998,81.28476562499998],[-70.14350585937498,80.39765625000001],[-71.387841796875,79.76176757812505],[-75.25947265624995,79.421044921875],[-76.255859375,79.00683593749997],[-74.43310546875,78.72412109375003],[-75.86596679687497,78.00981445312499],[-78.01259765624997,77.94604492187506],[-78.07617187500003,77.51904296875],[-79.34086914062493,77.15839843749998],[-78.28886718750002,76.97797851562501],[-78.284326171875,76.57124023437501],[-80.69028320312495,76.17646484374995],[-81.17070312499996,76.51274414062499],[-83.88569335937501,76.45312500000003],[-85.141259765625,76.30458984375005],[-89.57006835937497,76.49194335937503],[-89.49975585937503,76.82680664062502],[-88.39814453124995,77.10395507812501],[-86.873779296875,77.20029296875],[-88.09467773437495,77.71918945312501],[-87.01796874999997,77.89223632812502],[-87.5517578125,78.17661132812503],[-86.80791015624999,78.77436523437495],[-84.31611328124993,78.97529296874995],[-85.08979492187498,79.61215820312503],[-86.42075195312498,79.84521484374997],[-86.30717773437493,80.31933593750003],[-83.72363281250003,80.22895507812501],[-80.05107421874993,80.52856445312503],[-83.40141601562502,80.71396484375003],[-85.30742187500002,80.52597656250003],[-88.92143554687499,80.80561523437498],[-89.94731445312499,81.17265625000005],[-88.97836914062503,81.54150390624997],[-90.49018554687501,81.87724609374999],[-86.58061523437496,82.18720703124998],[-82.12250976562498,82.60175781249998],[-79.88632812500003,82.93852539062502],[-69.96992187499995,83.11611328125005],[-69.4888671875,83.01679687499998]]]]
},properties:{name:"Canada",childNum:36}},{geometry:{type:"Polygon",coordinates:[[[9.524023437500006,47.524218749999996],[9.527539062500011,47.270751953125],[9.580273437500011,47.057373046875],[9.996875000000017,46.8853515625],[10.349414062500017,46.984765624999994],[10.414941406250023,46.964404296874996],[10.45458984375,46.8994140625],[10.452832031250011,46.86494140625],[10.406054687500017,46.73486328125],[10.39794921875,46.6650390625],[10.4306640625,46.550048828125],[10.363085937500017,46.5470703125],[10.272265625000017,46.564843749999994],[10.195507812500011,46.62109375],[10.137500000000017,46.61435546875],[10.087011718750006,46.599902343749996],[9.939257812500017,46.36181640625],[9.203417968750017,46.21923828125],[8.826757812500006,46.06103515625],[8.818554687500011,46.0771484375],[8.458398437500023,46.245898437499996],[8.370703125000006,46.445117187499996],[8.08154296875,46.256005859374994],[7.787890625000017,45.921826171875],[7.327929687500017,45.912353515625],[6.772070312500006,46.16513671875],[6.758105468750017,46.415771484375],[6.428906250000011,46.430517578125],[6.27294921875,46.252246093749996],[6.199414062500011,46.19306640625],[6.086621093750011,46.147021484374996],[6.006640625000017,46.142333984375],[5.971484375000017,46.151220703125],[5.970019531250017,46.214697265625],[6.060253906250011,46.428173828125],[6.429003906250017,46.832275390625],[7.000585937500006,47.322509765625],[7.615625000000023,47.592724609375],[8.414746093750011,47.589599609375],[8.572656250000023,47.775634765625],[9.524023437500006,47.524218749999996]]]},properties:{name:"Switzerland",childNum:1}},{geometry:{type:"MultiPolygon",coordinates:[[[[-67.07993164062498,-55.15380859374996],[-68.07001953124995,-55.22109374999999],[-68.10693359375003,-54.929394531249976],[-67.245263671875,-54.977636718750034],[-67.07993164062498,-55.15380859374996]]],[[[-69.70297851562503,-54.91904296875],[-68.90078125000002,-55.01777343750004],[-68.28266601562495,-55.25517578125],[-68.293359375,-55.521386718749966],[-69.41181640624995,-55.44423828124997],[-69.97978515625002,-55.14746093749999],[-69.70297851562503,-54.91904296875]]],[[[-72.92324218749997,-53.481640625],[-72.20541992187503,-53.80742187500002],[-73.30473632812499,-53.943945312500034],[-73.68652343749997,-53.42685546875003],[-72.92324218749997,-53.481640625]]],[[[-68.62993164062499,-52.65263671875004],[-68.65322265624994,-54.85361328124999],[-69.48627929687493,-54.85888671875],[-69.72343750000002,-54.71210937500003],[-70.49716796875,-54.80957031249999],[-71.44091796874997,-54.61962890625002],[-70.89824218749999,-54.337890625],[-70.86772460937499,-53.88417968750002],[-70.09038085937499,-53.41816406250003],[-70.39067382812496,-53.02646484374999],[-69.76357421875002,-52.731347656249994],[-68.62993164062499,-52.65263671875004]]],[[[-74.47617187499998,-49.14785156250002],[-74.59472656249997,-50.00664062500001],[-75.30009765624996,-49.8474609375],[-75.184228515625,-49.08359374999999],[-74.79345703124997,-48.70507812499997],[-74.47617187499998,-49.14785156250002]]],[[[-74.56728515625,-48.591992187500026],[-74.92304687499998,-48.62646484375003],[-75.21289062499997,-48.141699218750034],[-74.72929687499996,-48.12587890625001],[-74.56728515625,-48.591992187500026]]],[[[-72.98613281249999,-44.780078124999974],[-73.44506835937497,-44.641015624999966],[-73.20771484374993,-44.33496093749997],[-72.76406249999997,-44.54902343749997],[-72.98613281249999,-44.780078124999974]]],[[[-73.73535156249997,-44.39453125000003],[-73.98330078125002,-44.494824218750026],[-73.72714843749998,-45.11904296875001],[-74.09907226562498,-45.32539062500004],[-74.61777343749998,-44.64794921874996],[-74.50180664062498,-44.47353515624995],[-73.73535156249997,-44.39453125000003]]],[[[-73.77338867187498,-43.3458984375],[-74.35493164062498,-43.26357421875001],[-74.20947265625,-42.87871093750003],[-74.03666992187496,-41.79550781249998],[-73.52783203124997,-41.89628906249999],[-73.47080078124998,-42.46630859375004],[-73.78925781249993,-42.58574218750003],[-73.43632812499996,-42.9365234375],[-73.77338867187498,-43.3458984375]]],[[[-67.19487304687493,-22.821679687500037],[-67.00878906249994,-23.00136718750005],[-67.35620117187503,-24.033789062499963],[-68.25029296875002,-24.391992187500023],[-68.56201171875,-24.83769531249996],[-68.38422851562495,-25.091894531249977],[-68.60029296874998,-25.48564453124999],[-68.41450195312498,-26.153710937500023],[-68.58115234375,-26.518359374999974],[-68.34599609374996,-27.02792968750005],[-68.84633789062494,-27.153710937499994],[-69.17441406249998,-27.924707031250037],[-69.65693359374995,-28.413574218749986],[-69.82788085937497,-29.10322265624997],[-70.02680664062501,-29.324023437500017],[-69.92763671874997,-29.76914062500002],[-69.95634765624996,-30.35820312500003],[-70.16142578124999,-30.44023437499996],[-70.51958007812493,-31.1484375],[-70.585205078125,-31.569433593749963],[-70.16962890624995,-32.471679687500014],[-70.01982421874999,-33.27148437499997],[-69.79775390624997,-33.398632812500026],[-69.85244140625,-34.224316406250026],[-70.28994140624997,-34.732812499999966],[-70.47041015624995,-35.32617187499997],[-70.40478515625,-36.06171874999998],[-71.05551757812498,-36.52373046874996],[-71.16757812499998,-37.76230468749996],[-71.028173828125,-38.041210937500026],[-70.95161132812493,-38.73847656249997],[-71.42558593749996,-38.98564453125006],[-71.53945312499997,-39.60244140624995],[-71.71992187499995,-39.63525390624997],[-71.69531250000003,-40.33525390625003],[-71.93212890624994,-40.69169921874999],[-71.91127929687497,-41.650390624999986],[-71.76093749999998,-42.101464843749966],[-72.12460937499998,-42.298339843750014],[-72.14643554687498,-42.990039062499974],[-71.781494140625,-43.16679687500002],[-71.90498046875001,-43.44013671875001],[-71.68007812500002,-43.92958984374998],[-71.82001953124993,-44.38310546875],[-71.21259765624998,-44.44121093750003],[-71.26113281250002,-44.763085937499966],[-71.5962890625,-44.97919921875004],[-71.35375976562497,-45.23046874999997],[-71.77265624999995,-45.724414062499974],[-71.87568359374998,-46.16054687500001],[-71.69521484375,-46.57841796875006],[-71.94023437499999,-46.831250000000054],[-71.90498046875001,-47.201660156250014],[-72.34594726562497,-47.49267578124997],[-72.517919921875,-47.87636718749998],[-72.35473632812497,-48.36582031250005],[-72.61440429687494,-48.79287109375],[-73.57626953124998,-49.582910156250016],[-73.50126953124996,-50.125292968750024],[-73.15292968749998,-50.73828125000003],[-72.50981445312496,-50.607519531250034],[-72.27631835937498,-50.910253906249984],[-72.40766601562501,-51.54082031250002],[-71.91865234374995,-51.98955078125004],[-69.96025390624993,-52.00820312500002],[-68.443359375,-52.35664062500004],[-69.24101562499996,-52.20546874999997],[-69.56059570312496,-52.42158203125004],[-70.79511718749995,-52.768749999999976],[-70.99584960937497,-53.77929687499997],[-71.29775390625002,-53.88339843750004],[-72.1744140625,-53.632324218749964],[-71.85273437499993,-53.28574218749996],[-71.40034179687495,-53.10703124999997],[-71.38774414062496,-52.76425781250004],[-72.45830078124993,-53.25449218749999],[-73.05273437499997,-53.24345703125005],[-74.01445312499999,-52.63935546875],[-73.51816406250003,-52.04101562499996],[-73.9732421875,-51.78447265625],[-73.8958984375,-51.331445312499994],[-74.81474609374996,-51.062890624999994],[-75.09467773437495,-50.681249999999956],[-74.333740234375,-49.97460937499997],[-74.34101562499998,-48.59570312499998],[-74.57719726562496,-48.274414062499986],[-74.654931640625,-47.702246093750034],[-74.15839843749998,-47.18251953125002],[-74.15190429687499,-46.97441406249999],[-75.65678710937499,-46.610351562499986],[-74.924462890625,-46.159667968750014],[-75.06669921874993,-45.874902343749994],[-74.15786132812497,-45.76718749999999],[-74.03754882812498,-45.41767578125001],[-73.54990234375,-45.48378906249998],[-73.36245117187502,-44.97822265625001],[-72.73896484375001,-44.73417968750003],[-72.66386718749999,-44.43642578124995],[-73.26508789062498,-44.16865234375001],[-72.99658203125,-43.63154296875001],[-72.78515625,-42.301269531249986],[-72.49941406249997,-41.980859374999994],[-72.66977539062503,-41.65937500000004],[-73.014990234375,-41.54384765624995],[-73.52128906249996,-41.797070312500026],[-73.96586914062493,-41.118261718750034],[-73.66943359375003,-40.08232421875002],[-73.41040039062503,-39.78916015624998],[-73.22646484375002,-39.22441406250003],[-73.53256835937503,-38.366796875000006],[-73.46479492187498,-38.04033203125003],[-73.66181640624998,-37.69853515625003],[-73.60166015624998,-37.18847656250003],[-73.21596679687502,-37.16689453124998],[-73.11806640624997,-36.68837890625002],[-72.87456054687502,-36.39042968749999],[-72.62392578125002,-35.5857421875],[-72.22377929687494,-35.096191406250014],[-72.00283203124997,-34.16533203125],[-71.66435546875002,-33.65263671875],[-71.74296874999996,-33.09511718750001],[-71.45224609374998,-32.65957031250001],[-71.52587890624997,-31.805859374999997],[-71.66196289062498,-31.169531250000034],[-71.66948242187499,-30.33037109374996],[-71.40039062499997,-30.142968749999966],[-71.31572265624996,-29.649707031250017],[-71.51923828124993,-28.926464843750026],[-71.18642578125,-28.37783203124998],[-71.05263671875,-27.727343749999974],[-70.64658203124998,-26.329394531250017],[-70.71372070312498,-25.78417968749997],[-70.44536132812502,-25.17265624999999],[-70.57412109374994,-24.644335937500003],[-70.48779296874994,-23.781738281249957],[-70.56318359374995,-23.057031250000023],[-70.33168945312494,-22.848632812500014],[-70.08754882812494,-21.49306640624998],[-70.19702148437494,-20.725390625000003],[-70.14814453124995,-19.805078124999994],[-70.27578125000002,-19.267578125000014],[-70.33486328124997,-18.82753906249998],[-70.33608398437494,-18.595214843749986],[-70.36162109374999,-18.398046874999963],[-70.41826171874999,-18.345605468750023],[-70.37749023437496,-18.333593749999977],[-70.18378906250001,-18.325195312499957],[-70.05908203125,-18.28349609374999],[-69.92636718749998,-18.206054687500014],[-69.85209960937493,-17.70380859375001],[-69.49501953125002,-17.619531249999994],[-69.3580078125,-17.771679687499983],[-69.31337890624997,-17.943164062500017],[-69.28232421875003,-17.96484375],[-69.09394531249993,-18.05048828125004],[-69.09228515624994,-18.28242187500004],[-69.02680664062493,-18.656249999999986],[-68.97885742187503,-18.81298828125003],[-68.96831054687502,-18.967968749999983],[-68.85795898437499,-19.09335937500005],[-68.62055664062495,-19.29667968749999],[-68.54785156249997,-19.341113281249974],[-68.49199218749996,-19.381933593750034],[-68.47016601562495,-19.409960937499974],[-68.46289062499997,-19.43281250000001],[-68.69829101562499,-19.721093750000037],[-68.75932617187499,-20.115527343750003],[-68.74516601562493,-20.458593750000006],[-68.197021484375,-21.30029296874997],[-68.18642578124997,-21.618554687499966],[-68.11215820312503,-21.753027343750006],[-68.0767578125,-21.982812500000023],[-67.98837890625003,-22.05712890624997],[-67.95390624999993,-22.204003906249966],[-67.95039062499993,-22.333691406249997],[-67.88173828124997,-22.493359375000026],[-67.87944335937496,-22.822949218750026],[-67.57993164062495,-22.89169921874999],[-67.36225585937493,-22.85517578125001],[-67.19487304687493,-22.821679687500037]]]]},properties:{name:"Chile",childNum:10}},{geometry:{type:"MultiPolygon",coordinates:[[[[110.88876953125006,19.99194335937497],[111.01367187500003,19.65546875000001],[110.57216796875005,19.17187499999997],[110.45126953125012,18.747949218750023],[109.51933593750007,18.21826171875003],[108.7015625,18.535253906250034],[108.69355468750004,19.33828125000005],[109.17910156250005,19.674121093750074],[109.21894531250004,19.842822265625074],[110.1715820312501,20.053710937500057],[110.88876953125006,19.99194335937497]]],[[[130.52695312500012,42.535400390625],[130.24033203125006,42.891796874999955],[129.89824218750002,42.998144531250034],[129.71972656249997,42.47500000000005],[129.3136718750001,42.41357421874997],[128.92343750000006,42.038232421874966],[128.04521484375007,41.98750000000004],[128.29091796875,41.56279296875002],[128.11123046875,41.389257812500006],[127.17968750000003,41.531347656250006],[126.9035156250001,41.78105468749999],[125.98906250000002,40.904638671875034],[124.8893554687501,40.459814453125006],[124.36210937500002,40.004052734374994],[124.10576171875002,39.84101562499998],[123.34814453124997,39.76293945312497],[122.33486328125005,39.36611328125005],[121.64990234375003,38.865087890625034],[121.78544921875002,39.40083007812501],[121.51757812499997,39.638964843750045],[122.27500000000012,40.541845703125034],[121.85878906250005,40.84208984375002],[121.1745117187501,40.901269531249994],[120.47910156250006,40.23095703125003],[119.59111328125007,39.90263671875002],[118.9123046875001,39.16640625000005],[118.29785156249997,39.067089843749955],[117.78466796875003,39.13447265625001],[117.5578125000001,38.625146484374994],[118.01494140625007,38.18339843749996],[118.94003906250006,38.04277343750002],[119.08916015625007,37.70073242187496],[118.95263671875003,37.33115234374998],[119.4499023437501,37.12475585937503],[120.37011718749997,37.701025390625006],[120.75000000000003,37.83393554687501],[121.64023437500012,37.46035156250002],[122.60234375000002,37.42641601562502],[122.51972656250004,36.94682617187502],[121.93271484375006,36.95947265625003],[120.98994140625004,36.59794921874999],[120.39306640625003,36.053857421874994],[120.05468750000003,35.86113281249999],[119.21582031250003,35.01176757812496],[119.58291015625,34.58222656250004],[120.20146484375007,34.32568359375],[120.87109374999997,33.016503906249994],[120.8532226562501,32.66137695312503],[121.40097656250012,32.371923828125034],[121.351953125,31.85878906250005],[121.05537109375004,31.719433593749983],[121.66064453124997,31.319726562499994],[121.87792968750003,30.91699218750003],[120.99765625000012,30.558251953125023],[121.1593750000001,30.3017578125],[121.94433593749997,29.89409179687499],[121.71748046875004,29.25634765625],[121.60205078124997,28.366601562500023],[121.09843750000002,28.29052734374997],[120.2787109375,27.097070312500023],[119.64824218750002,25.91870117187503],[119.53945312500005,25.59125976562504],[119.02460937500004,25.223437500000045],[118.56035156250007,24.580371093750045],[118.0871093750001,24.627001953125045],[118.0560546875,24.24609374999997],[116.53828125000004,23.17968749999997],[116.47070312499997,22.945898437500034],[115.49833984375002,22.718847656250063],[115.19580078125003,22.81728515625005],[114.85380859375007,22.616796875000063],[114.26601562500005,22.540966796874983],[114.01542968750007,22.51191406250001],[113.61962890624997,22.861425781249977],[113.54912109375002,22.225195312500034],[112.30498046875002,21.74169921875003],[111.94394531250012,21.84965820312499],[111.60273437500004,21.55908203125003],[110.77109375000006,21.386523437500045],[110.1935546875001,21.037646484375045],[110.51152343750007,20.51826171875001],[110.12314453125006,20.263720703125017],[109.66259765625003,20.91689453125005],[109.93076171875012,21.480566406250034],[109.54404296875012,21.537939453125006],[109.14863281250004,21.425537109375],[109.03056640625007,21.626513671875017],[108.32480468750006,21.693505859374994],[107.97265624999997,21.507958984375023],[107.35117187500012,21.60888671874997],[106.72949218749997,22.000341796875063],[106.53632812500004,22.395410156249994],[106.78027343749997,22.778906250000034],[106.14843749999997,22.970068359375006],[105.8429687500001,22.922802734374955],[105.27539062500003,23.34521484375003],[104.86474609375003,23.136376953125023],[104.79570312500007,22.91113281249997],[104.37177734375004,22.704052734374983],[103.35605468750006,22.75468749999999],[103.00537109375003,22.452978515624977],[102.51718750000012,22.741015625000045],[102.42792968750004,22.732812499999966],[102.2370117187501,22.466015624999983],[102.1759765625001,22.414648437500006],[102.12744140624997,22.379199218750045],[102.02441406250003,22.43920898437503],[101.84179687500003,22.38847656249999],[101.75996093750004,22.490332031250034],[101.73876953124997,22.495263671874994],[101.70751953125003,22.486572265625],[101.67148437500006,22.462304687500023],[101.64619140625004,22.405419921874966],[101.61992187500002,22.32744140624999],[101.56787109374997,22.27636718749997],[101.52451171875006,22.25366210937497],[101.7365234375001,21.826513671874977],[101.74394531250007,21.77797851562505],[101.74726562500004,21.605761718750045],[101.72294921875007,21.31494140625003],[101.7630859375,21.278906249999977],[101.80205078125002,21.235986328125023],[101.80058593750007,21.212597656249983],[101.78349609375007,21.204150390625017],[101.7047851562501,21.15014648437503],[101.54238281250005,21.23427734375005],[101.2814453125001,21.184130859375045],[101.24785156250007,21.197314453125045],[101.22441406250002,21.223730468750034],[101.1388671875001,21.567480468749977],[100.83515625000004,21.655175781249994],[100.21474609375,21.462988281250006],[99.9176757812501,22.02802734375001],[99.19296875000006,22.12597656249997],[99.33769531250002,22.49804687500003],[99.34082031249997,23.095898437499955],[98.86376953125003,23.191259765625034],[98.76435546875004,24.116064453125063],[98.21250000000006,24.110644531250017],[97.68603515624997,23.898095703124966],[97.53144531250004,24.49169921875003],[97.8195312500001,25.251855468749994],[98.01074218749997,25.292529296875017],[98.6546875,25.917773437500017],[98.7318359375,26.583398437499994],[98.65117187500007,27.572460937499983],[98.29882812499997,27.550097656250045],[98.09892578125002,28.142285156249983],[97.53789062500002,28.510205078124983],[97.43144531250002,28.353906250000023],[97.35644531249997,28.254492187500006],[97.3224609375001,28.21796875000004],[97.28945312500005,28.236816406250057],[97.14511718750012,28.34033203125],[97.07539062500004,28.36894531249996],[96.65283203125003,28.44975585937499],[96.3890625,28.36791992187503],[96.32988281250002,28.496826171875],[96.58085937500007,28.763671875],[96.14140625000007,28.963476562500034],[96.18085937500004,29.11767578125],[96.23496093750006,29.245800781249983],[96.12851562500012,29.38139648437499],[96.07958984375003,29.42412109374999],[96.03535156250004,29.447167968749994],[95.88505859375007,29.39091796874999],[95.7103515625,29.313818359375006],[95.5158203125001,29.206347656250045],[95.49375000000012,29.137011718750045],[95.42021484375007,29.054296875000063],[95.27910156250002,29.04956054687497],[94.99882812500002,29.14916992187503],[94.46806640625007,29.216210937499994],[94.01328125000006,28.90751953124999],[93.76074218750003,28.729785156250017],[93.36054687500004,28.654052734375057],[92.70185546875004,28.147119140624994],[92.65253906250004,28.093359375000034],[92.41484375000002,27.824609374999994],[91.63193359375012,27.759960937499983],[91.64189453125002,27.923242187500023],[91.60556640625006,27.95170898437496],[91.22587890625007,28.071240234374983],[91.07773437500012,27.974462890624977],[91.02080078125002,27.970068359374977],[90.71572265625,28.071728515624983],[90.47734375000007,28.07084960937499],[90.3527343750001,28.080224609375023],[89.98105468750006,28.311181640625023],[89.8978515625,28.29414062500001],[89.81689453125003,28.25629882812501],[89.74980468750002,28.18818359375001],[89.65273437500005,28.158300781250034],[89.53691406250007,28.10742187499997],[88.94755859375002,27.464013671874994],[88.89140625000002,27.316064453124966],[88.83251953125003,27.36284179687499],[88.7648437500001,27.429882812499983],[88.74902343749997,27.521874999999966],[88.82988281250002,27.76738281249999],[88.84882812500004,27.86865234375],[88.80371093750003,28.006933593750034],[88.57792968750002,28.093359375000034],[87.68271484375006,27.821386718750063],[87.29072265625004,27.821923828124994],[87.14140625000002,27.838330078124955],[87.02011718750006,27.928662109374983],[86.9337890625001,27.96845703125001],[86.750390625,28.022070312500006],[86.55449218750007,28.08520507812497],[86.40869140625003,27.928662109374983],[86.07871093750006,28.083593750000006],[85.67832031250012,28.277441406249977],[85.41064453125003,28.27602539062505],[85.21210937500004,28.292626953124966],[85.1224609375,28.315966796875017],[85.08857421875004,28.37226562500001],[85.121484375,28.484277343750023],[85.15908203125,28.592236328124983],[85.1263671875,28.602636718750063],[85.06914062500007,28.60966796874999],[84.85507812500006,28.553613281250023],[84.7142578125,28.595556640625034],[84.2287109375001,28.911767578124966],[84.17558593750002,29.036376953125057],[84.12783203125005,29.15629882812496],[84.10136718750002,29.21997070312497],[84.02197265624997,29.25385742187504],[83.93593750000005,29.27949218750001],[83.58349609375003,29.18359375000003],[83.15546875000004,29.612646484375034],[83.01396484375007,29.618066406249994],[82.85429687500002,29.68339843749996],[82.6408203125001,29.831201171874966],[82.4865234375001,29.941503906249977],[82.15898437500007,30.11518554687501],[82.04335937500005,30.326757812500034],[81.8548828125,30.362402343750006],[81.64189453125007,30.38749999999999],[81.4171875000001,30.33759765625001],[81.25507812500004,30.09331054687499],[81.17714843750005,30.039892578125034],[81.11035156250003,30.03681640625004],[80.98544921875006,30.23710937499999],[80.87353515625003,30.290576171875045],[80.19121093750002,30.56840820312496],[80.20712890625006,30.683740234375023],[79.92451171875004,30.888769531250034],[79.66425781250004,30.965234374999994],[79.10712890625004,31.402636718750017],[78.74355468750005,31.323779296875017],[78.7550781250001,31.55029296875],[78.69345703125006,31.740380859374994],[78.49589843750002,32.21577148437504],[78.4552734375001,32.30034179687502],[78.41748046874997,32.466699218749994],[78.38964843749997,32.51987304687498],[78.73671875,32.55839843750002],[78.75351562500012,32.49926757812506],[79.16992187500003,32.497216796874994],[79.14550781250003,33.00146484375006],[79.10283203125007,33.05253906249996],[79.13515625000005,33.17192382812496],[79.11250000000004,33.22626953125001],[78.94843750000004,33.346533203125006],[78.86503906250002,33.43110351562501],[78.78378906250006,33.80878906250004],[78.72666015625006,34.013378906249955],[78.93642578125,34.35195312500002],[78.86484375000006,34.39033203125001],[78.32695312500007,34.60639648437498],[78.15849609375002,34.94648437499998],[78.07578125000006,35.13491210937502],[77.79941406250006,35.49589843750002],[77.44648437500004,35.47558593750006],[76.25166015625004,35.810937499999994],[76.07089843750006,35.983007812500034],[76.01044921875004,35.996337890625],[75.94511718750002,36.01757812499997],[75.840234375,36.64970703124999],[75.34667968749997,36.913476562499966],[75.05390625000004,36.98715820312498],[74.94912109375,36.96835937500006],[74.88925781250006,36.95244140625002],[74.69218750000007,37.035742187500006],[74.60058593749997,37.03666992187502],[74.54140625,37.02216796875001],[74.52646484375006,37.03066406250005],[74.49794921875,37.057226562500034],[74.37617187500004,37.13735351562502],[74.37216796875006,37.15771484375],[74.72666015625006,37.29072265625001],[74.89130859375004,37.231640624999955],[74.74501953125,38.51000976562497],[74.27744140625,38.659765625000034],[73.80166015625,38.60688476562501],[73.7956054687501,39.00214843749998],[73.60732421875,39.229199218749955],[73.63632812500006,39.396679687499955],[73.63164062500007,39.44887695312502],[73.82294921875004,39.48896484375004],[73.8727539062501,39.533300781250006],[73.9146484375,39.60649414062499],[73.8353515625,39.800146484375006],[73.85625000000002,39.828662109375045],[73.88457031250002,39.87792968750006],[73.93876953125002,39.97880859374999],[73.99160156250005,40.04311523437502],[74.02050781249997,40.05937499999996],[74.0851562500001,40.074316406250006],[74.24267578124997,40.09204101562506],[74.41191406250007,40.13720703125003],[75.0044921875,40.44951171874996],[75.58349609375003,40.605322265625006],[75.65595703125004,40.329248046874966],[75.87197265625,40.30322265625],[76.06230468750002,40.387548828125034],[76.25830078124997,40.43076171875006],[76.3185546875001,40.352246093749955],[76.39638671875005,40.389794921874966],[76.4801757812501,40.44951171874996],[76.82402343750002,40.982324218749966],[76.90771484374997,41.02416992187497],[76.98662109375002,41.039160156250006],[77.58173828125004,40.99277343750006],[77.71933593750012,41.024316406249994],[77.81523437500002,41.05561523437498],[77.9564453125,41.05068359375005],[78.1234375,41.07563476562498],[78.34628906250012,41.28144531249998],[78.36240234375012,41.37163085937496],[79.29355468750006,41.78281249999998],[79.76611328124997,41.89887695312501],[79.84042968750012,41.99575195312502],[79.90966796875003,42.014990234375034],[80.21621093750005,42.03242187500004],[80.23515625000007,42.04345703124997],[80.24619140625012,42.05981445312503],[80.20937500000005,42.190039062500006],[80.16503906249997,42.66552734375006],[80.78574218750006,43.16157226562504],[80.35527343750002,44.09726562500006],[80.45546875,44.74609375],[80.05917968750012,45.006445312500006],[81.60205078125003,45.31083984375002],[82.4787109375001,45.12358398437499],[82.32666015625003,45.519921874999994],[83.0041015625001,47.03349609374996],[83.19306640625004,47.18657226562499],[84.78613281249997,46.83071289062505],[85.65664062500005,47.254638671875],[85.52597656250006,47.915625000000006],[85.7494140625,48.38505859374999],[86.54941406250012,48.52861328125002],[86.75312500000004,49.00883789062496],[87.32285156250012,49.085791015625006],[87.41669921875004,49.07661132812501],[87.5158203125001,49.122412109375006],[87.76250000000007,49.16582031249996],[87.81425781250002,49.162304687499955],[87.82519531249997,49.116308593750006],[87.81630859375,49.080273437499955],[87.83466796875004,49.031933593749955],[87.87216796875012,49.000146484374966],[87.85986328125003,48.96552734375001],[87.74316406250003,48.88164062499999],[87.9796875000001,48.55512695312498],[88.30996093750005,48.47207031250002],[88.41396484375,48.403417968750006],[88.51708984374997,48.384472656249955],[88.56679687500005,48.31743164062496],[88.57597656250007,48.220166015624955],[88.68183593750004,48.170556640624994],[88.83828125000005,48.101708984374994],[88.91777343750007,48.089013671874966],[89.04765625000007,48.002539062500034],[89.11562500000005,47.98769531250002],[89.19628906249997,47.98090820312498],[89.32988281250007,48.024853515624955],[89.5609375,48.00395507812496],[89.63847656250007,47.909082031249994],[89.69316406250002,47.87915039062503],[89.72558593749997,47.85249023437501],[89.77812500000002,47.82700195312498],[89.91044921875007,47.844335937500034],[89.95869140625004,47.88632812499998],[90.02792968750012,47.877685546875],[90.31328125000007,47.676171874999994],[90.49619140625012,47.28515625],[90.86992187500002,46.95449218750005],[91.03388671875004,46.529003906249955],[91.00175781250007,46.03579101562502],[90.6618164062501,45.525244140625006],[90.87724609375002,45.19609375000002],[90.95361328125003,45.21591796875006],[91.05000000000004,45.217431640624994],[91.31210937500006,45.11811523437501],[91.44101562500012,45.12475585937503],[91.51005859375007,45.09824218750006],[91.584375,45.07651367187498],[92.42382812499997,45.008935546874994],[92.57890625000002,45.01098632812506],[92.78789062500007,45.035742187500034],[93.6564453125001,44.900976562500006],[94.71201171875012,44.35083007812503],[95.35029296875004,44.27807617187503],[95.35644531250003,44.005957031250006],[95.52558593750004,43.953955078125006],[95.8419921875001,43.383691406249994],[95.9125,43.20649414062504],[96.29951171875004,42.92871093750003],[96.38544921875004,42.72036132812502],[97.20566406250012,42.78979492187506],[99.46787109375012,42.568212890625034],[99.98378906250005,42.67734375000006],[101.71386718749997,42.46582031250006],[101.97294921875002,42.21586914062502],[103.07285156250006,42.00595703125006],[103.7111328125001,41.75131835937506],[103.99726562500004,41.796972656250034],[104.30517578124997,41.84614257812501],[104.49824218750004,41.87700195312499],[104.49824218750004,41.65869140625],[105.19707031250002,41.738037109375],[105.31435546875005,41.77089843750005],[105.86757812500005,41.993994140625034],[106.77001953125003,42.28872070312502],[108.17119140625002,42.44731445312502],[108.68730468750002,42.416113281250034],[109.13164062500002,42.440576171874966],[109.33984374999997,42.43837890625005],[109.44316406250002,42.455957031249994],[110.40039062499997,42.77368164062497],[111.00722656250005,43.34140624999998],[111.18681640625002,43.391992187499994],[111.45107421875005,43.47490234375002],[111.50351562500006,43.492773437500006],[111.54736328124997,43.49628906250001],[111.6408203125001,43.563183593749955],[111.71972656249997,43.62114257812496],[111.77109375000006,43.66459960937502],[111.8781250000001,43.68017578125],[111.93320312500006,43.71142578125006],[111.94287109374997,43.75244140624997],[111.93173828125012,43.81494140625],[111.83691406249997,43.93466796875006],[111.40224609375005,44.367285156250006],[111.89804687500006,45.064062500000034],[112.03261718750005,45.08164062500006],[112.11289062500006,45.06293945312498],[112.41132812500004,45.05820312499998],[112.59677734375006,44.917675781249955],[112.7067382812501,44.883447265624994],[113.04941406250006,44.81035156250002],[113.3009765625001,44.79165039062502],[113.58701171875006,44.745703125000006],[113.65263671875002,44.76347656249999],[113.87705078125012,44.89619140625001],[114.03027343749997,44.942578124999955],[114.41914062500004,45.20258789062501],[114.48730468750003,45.27172851562506],[114.50224609375002,45.316308593749994],[114.51718750000006,45.36459960937506],[114.56015625000012,45.38999023437498],[114.64433593750002,45.41328125000001],[114.73876953124997,45.41962890624998],[114.91923828125007,45.378271484375006],[115.16259765624997,45.390234375000034],[115.6810546875,45.45825195312503],[116.240625,45.795996093750006],[116.22910156250012,45.84575195312502],[116.21298828125012,45.88691406249998],[116.56259765625012,46.28979492187497],[116.6888671875,46.321972656249955],[116.78701171875,46.37666015625001],[116.85908203125004,46.387939453125],[117.3333984375,46.36201171875004],[117.6710937500001,46.52207031250006],[117.81347656249997,46.537695312500034],[117.91044921875007,46.61933593749998],[118.30869140625012,46.71704101562497],[118.72294921875007,46.69189453125],[118.8439453125001,46.76020507812498],[118.95712890625006,46.73486328124997],[119.16210937499997,46.638671875],[119.33183593750002,46.61381835937499],[119.47402343750005,46.626660156249955],[119.62021484375006,46.60395507812504],[119.70664062500006,46.60600585937502],[119.74746093750005,46.62719726562497],[119.86718750000003,46.67216796874999],[119.89785156250005,46.857812499999966],[119.71113281250004,47.14999999999998],[118.49843750000005,47.98398437499998],[117.76835937500002,47.98789062499998],[117.67666015625005,47.908300781250034],[117.55537109375004,47.80468750000006],[117.45507812500003,47.74135742187502],[117.38398437500004,47.67573242187498],[117.3507812500001,47.65219726562498],[117.28593750000002,47.666357421875034],[117.19707031250007,47.74028320312499],[117.06972656250005,47.80639648437506],[116.95166015624997,47.836572265624966],[116.90117187500007,47.85307617187496],[116.76054687500002,47.869775390624994],[116.65195312500012,47.86450195312497],[116.51347656250007,47.839550781249955],[116.37822265625002,47.84404296874999],[116.31718750000002,47.85986328125],[116.2311523437501,47.85820312500002],[116.07480468750012,47.78955078125],[115.99384765625004,47.71132812500005],[115.89824218750002,47.68691406250005],[115.71171875000002,47.798925781250034],[115.6164062500001,47.874804687500045],[115.55761718750003,47.945019531249955],[115.52509765625004,48.13085937499997],[115.63945312500007,48.18623046874998],[115.785546875,48.24824218750001],[115.7965820312501,48.346337890624994],[115.7916992187501,48.455712890624994],[115.8205078125001,48.57724609375006],[115.9538085937501,48.689355468749994],[116.6833007812501,49.82377929687499],[117.8734375,49.51347656250002],[118.4515625,49.84448242187503],[119.25986328125012,50.06640625000003],[119.19189453125003,50.37983398437504],[120.06689453125003,51.60068359375006],[120.74980468750007,52.096533203125006],[120.65615234375,52.56665039062503],[120.09453125000007,52.787207031250034],[120.70410156249997,53.171826171874955],[122.33779296875,53.485009765624994],[123.6078125,53.546533203124994],[124.81230468750002,53.133837890625045],[125.64902343750012,53.042285156250045],[126.312890625,52.39975585937506],[126.92480468749997,51.10014648437496],[127.590234375,50.20898437500003],[127.50244140624997,49.873437499999994],[127.99960937500006,49.56860351562506],[128.70400390625,49.60014648437499],[129.12011718750003,49.36206054687497],[129.49814453125012,49.38881835937502],[130.80429687500012,48.34150390624998],[130.7121093750001,48.12763671875004],[131.00273437500002,47.69145507812499],[132.5619140625,47.768505859374955],[133.14404296875003,48.10566406249998],[133.46835937500006,48.09716796875003],[134.29335937500005,48.37343750000002],[134.56357421875012,48.321728515624955],[134.75234375,47.71542968749998],[134.1676757812501,47.30219726562501],[133.86132812500003,46.24775390625004],[133.18603515625003,45.49482421875004],[132.93603515624997,45.029931640624994],[131.97753906250003,45.243994140625006],[131.08232421875002,44.91000976562498],[131.2552734375,44.07158203124999],[131.26181640625006,43.43305664062501],[131.06855468750004,42.90224609375005],[130.57724609375006,42.81162109375006],[130.52695312500012,42.535400390625]]],[[[121.00878906249997,22.62036132812497],[120.5812500000001,22.35639648437504],[120.32558593750005,22.54243164062501],[120.0724609375001,23.149755859375006],[120.15898437500002,23.70903320312499],[121.04062500000006,25.032812500000034],[121.59365234375,25.275341796874983],[121.92900390625002,24.973730468749977],[121.29589843750003,22.96660156249999],[121.00878906249997,22.62036132812497]]]]
},properties:{name:"China",childNum:2}},{geometry:{type:"Polygon",coordinates:[[[-5.262304687499977,10.319677734374991],[-4.969921874999926,9.930078125000023],[-4.814453124999972,9.841162109375034],[-4.72177734374992,9.756542968750026],[-4.625830078125006,9.713574218749969],[-4.526611328124943,9.723486328125034],[-4.406201171874926,9.647998046875031],[-4.3322265624999545,9.645703124999997],[-4.18115234375,9.78173828125],[-3.7906249999999204,9.917187499999983],[-3.5811523437499773,9.924316406250014],[-3.2235351562499375,9.895458984374997],[-2.9882812499999716,9.687353515624963],[-2.900878906249943,9.534619140625026],[-2.8751464843749375,9.500927734374997],[-2.816748046874949,9.425830078124974],[-2.705761718749983,9.351367187499989],[-2.5058593750000284,8.208740234375],[-2.6133789062499773,8.046679687500017],[-2.6688476562499943,8.022216796875014],[-2.7897460937499545,7.931933593750003],[-2.9590820312499773,7.454541015624997],[-3.2271484374999773,6.7491210937499915],[-3.200585937499966,6.348242187500034],[-2.9622558593749204,5.643017578124983],[-2.7549804687499773,5.432519531249994],[-2.815673828125,5.153027343749997],[-3.3475585937499943,5.13066406249996],[-4.037207031249977,5.23012695312498],[-5.56474609374996,5.089453125000006],[-6.8451660156249545,4.671484375000034],[-7.544970703124989,4.351318359375],[-7.574658203124983,4.572314453124989],[-7.585058593749977,4.916748046875],[-7.39990234375,5.550585937499989],[-7.636132812499994,5.90771484375],[-7.730371093749994,5.9190429687499915],[-7.800927734374994,6.0389160156249915],[-7.833251953125,6.076367187499983],[-7.855517578125017,6.150146484375],[-7.888623046875011,6.234863281250028],[-7.9815917968749375,6.2861328125],[-8.203857421875,6.29072265625004],[-8.587890625,6.490527343749989],[-8.324511718749989,6.9200195312499915],[-8.408740234374989,7.411816406249997],[-8.429980468749989,7.601855468749989],[-8.231884765624955,7.556738281250034],[-8.205957031249994,7.590234375000023],[-8.115429687499926,7.760742187500028],[-8.016748046874994,8.144921874999966],[-7.953125,8.477734374999997],[-7.823583984374977,8.467675781249994],[-7.950976562499989,8.786816406249997],[-7.8961914062499545,9.415869140624991],[-8.136962890624972,9.495703124999991],[-8.14584960937492,9.881738281250037],[-8.155175781249937,9.973193359375017],[-8.136621093749994,10.022070312500034],[-7.990624999999994,10.162500000000037],[-7.9609375,10.163476562499966],[-7.88408203124996,10.185742187499983],[-7.814208984374943,10.236572265625028],[-7.749072265624989,10.342285156249986],[-7.661132812500028,10.427441406250011],[-7.385058593749989,10.340136718749989],[-6.950341796874994,10.342333984374989],[-6.482617187499983,10.561230468749997],[-6.261132812499994,10.724072265625054],[-6.0345703124999375,10.194824218750057],[-5.843847656249977,10.389550781250023],[-5.694287109374983,10.433203125000034],[-5.556591796874983,10.439941406249986],[-5.382275390625011,10.314013671875003],[-5.262304687499977,10.319677734374991]]]},properties:{name:"Ivory Coast",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[15.480078125000006,7.5237792968749915],[15.245898437500017,7.263574218749994],[14.7392578125,6.27978515625],[14.616894531250011,5.865136718749994],[14.708984375,4.665576171874989],[15.022753906250017,4.358544921874994],[15.128710937500017,3.826904296875],[15.775000000000006,3.127197265625],[16.0634765625,2.9085937499999943],[16.183398437500017,2.2700683593749886],[16.059375000000017,1.6762207031249972],[15.741601562500023,1.9149902343749972],[14.902441406250006,2.0123046874999915],[14.484082031250011,2.154736328124997],[13.293554687500006,2.161572265624997],[13.220312500000006,2.2564453124999915],[11.348437500000017,2.2997070312499943],[11.328710937500006,2.167431640624997],[11.096582031250023,2.16748046875],[10.790917968750023,2.1675781249999915],[9.979882812500023,2.1677734374999886],[9.8701171875,2.2132812499999943],[9.80078125,2.304443359375],[9.876171875000011,3.309765624999997],[9.42529296875,3.922314453124997],[9.000097656250006,4.091601562499989],[8.90283203125,4.4351562499999915],[8.532812500000006,4.605859374999994],[8.800976562500011,5.197460937499997],[8.997167968750006,5.917724609375],[9.490234375,6.418652343749997],[9.779882812500006,6.760156249999994],[9.820703125000023,6.783935546875],[9.874218750000011,6.803271484374989],[10.038867187500017,6.92138671875],[10.1435546875,6.9964355468749915],[10.167773437500017,6.959179687499997],[10.185546875,6.912792968749997],[10.205468750000023,6.8916015625],[10.482324218750023,6.891259765624994],[10.606250000000017,7.0630859374999915],[10.954199218750006,6.776562499999997],[11.032519531250017,6.697900390624994],[11.079687500000006,6.505517578124994],[11.1533203125,6.437939453124997],[11.2373046875,6.4505371093749915],[11.324609375000023,6.484667968749989],[11.551660156250023,6.697265625],[11.767382812500017,7.272265624999989],[11.809179687500006,7.3450683593749915],[12.016015625000023,7.589746093749994],[12.2333984375,8.282324218749991],[12.403515625000011,8.595556640624991],[12.582714843750011,8.624121093749991],[12.651562500000011,8.667773437499989],[12.929492187500017,9.42626953125],[13.175488281250011,9.539648437499991],[13.269921875000023,10.036181640624989],[13.535351562500011,10.605078124999991],[13.89208984375,11.140087890624997],[14.559765625000011,11.492285156249991],[14.627148437500011,12.108691406249989],[14.272851562500023,12.356494140624989],[14.184863281250017,12.447216796874997],[14.06396484375,13.078515624999994],[14.244824218750011,13.077343749999997],[14.516210937500006,12.979736328125],[14.76123046875,12.655615234374991],[15.081250000000011,11.845507812499989],[15.029882812500006,11.113671874999994],[15.276074218750011,10.357373046874997],[15.540917968750023,9.960302734374991],[14.243261718750006,9.979736328125],[13.977246093750011,9.691552734374994],[14.332324218750017,9.203515624999994],[15.1162109375,8.557324218749997],[15.442968750000006,7.851855468749989],[15.480078125000006,7.5237792968749915]]]},properties:{name:"Cameroon",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[27.4033203125,5.109179687499989],[27.7880859375,4.644677734374994],[28.19208984375001,4.350244140624994],[28.72705078125,4.5049804687499915],[29.151464843750006,4.38818359375],[29.676855468750006,4.5869140625],[30.194921875000006,3.98193359375],[30.50830078125,3.835693359375],[30.83857421875001,3.49072265625],[30.728613281250006,2.4553710937499886],[31.176367187500006,2.2700683593749886],[31.252734375000017,2.0445800781249943],[30.94257812500001,1.6828124999999972],[29.94287109375,.8192382812499943],[29.934472656250023,.4990234375],[29.717675781250023,.09833984374999716],[29.561914062500023,-.9773437500000028],[29.576953125000017,-1.3878906250000114],[29.12939453125,-1.8602539062500085],[29.1064453125,-2.233203125000003],[28.876367187500023,-2.4002929687500085],[29.01435546875001,-2.72021484375],[29.224414062500017,-3.053515625000003],[29.223242187500006,-3.9108398437500114],[29.403222656250023,-4.449316406250006],[29.404199218750023,-4.496679687500006],[29.32568359375,-4.835644531250011],[29.3427734375,-4.983105468750011],[29.42011718750001,-5.1761718750000085],[29.476464843750023,-5.316601562500011],[29.594140625000023,-5.6507812500000085],[29.59638671875001,-5.775976562500006],[29.490820312500006,-5.965429687500006],[29.480078125000006,-6.025000000000006],[29.506250000000023,-6.172070312500011],[29.540820312500017,-6.3138671875000085],[29.590625000000017,-6.3944335937500085],[29.70966796875001,-6.616894531250011],[29.798144531250017,-6.69189453125],[29.961816406250023,-6.8031250000000085],[30.106250000000017,-6.9150390625],[30.212695312500017,-7.037890625000003],[30.31318359375001,-7.203710937500006],[30.40673828125,-7.460644531250011],[30.75117187500001,-8.193652343750003],[28.972265625000006,-8.464941406250006],[28.917773437500017,-8.700585937500009],[28.400683593750017,-9.224804687500011],[28.63007812500001,-9.831250000000011],[28.63886718750001,-10.669238281250003],[28.357226562500017,-11.483007812500006],[28.482519531250006,-11.812109375000006],[29.064355468750023,-12.348828125000011],[29.427539062500017,-12.431250000000006],[29.79511718750001,-12.155468750000011],[29.795312500000023,-13.392773437500011],[29.55419921875,-13.248925781250009],[29.014257812500006,-13.368847656250011],[28.357714843750017,-12.482031250000006],[27.53339843750001,-12.1953125],[27.04609375000001,-11.615917968750011],[26.949609375000023,-11.898828125000009],[26.59638671875001,-11.972070312500009],[26.025976562500006,-11.89013671875],[25.349414062500017,-11.623046875],[25.184863281250017,-11.242968750000003],[24.5185546875,-11.4384765625],[24.319921875000006,-11.07177734375],[23.96650390625001,-10.871777343750011],[23.901171875000017,-10.983203125000003],[23.833886718750023,-11.013671875],[23.696386718750006,-11.007617187500003],[23.559960937500023,-10.978613281250006],[23.400195312500017,-10.976464843750009],[22.226171875000006,-11.121972656250009],[22.203515625000023,-10.829492187500009],[22.307031250000023,-10.691308593750009],[22.30244140625001,-10.396679687500011],[22.274511718750006,-10.259082031250003],[22.19775390625,-10.040625000000006],[21.81318359375001,-9.46875],[21.905371093750006,-8.693359375],[21.751074218750006,-7.305468750000003],[21.190332031250023,-7.284960937500003],[20.910937500000017,-7.281445312500011],[20.607812500000023,-7.2777343750000085],[20.558398437500017,-7.244433593750003],[20.536914062500017,-7.121777343750011],[20.598730468750006,-6.935156250000006],[20.59003906250001,-6.919921875],[20.482226562500017,-6.915820312500003],[20.190039062500006,-6.9462890625],[19.997460937500023,-6.9764648437500085],[19.87519531250001,-6.986328125],[19.527636718750017,-7.1444335937500085],[19.3408203125,-7.966601562500003],[19.142675781250006,-8.00146484375],[18.944433593750006,-8.00146484375],[18.898339843750023,-7.998144531250006],[18.56269531250001,-7.9359375000000085],[18.0087890625,-8.107617187500011],[17.643359375000017,-8.090722656250009],[17.57958984375,-8.099023437500009],[16.984765625000023,-7.257421875000006],[16.91943359375,-6.9339843750000085],[16.813085937500006,-6.772558593750006],[16.742968750000017,-6.618457031250003],[16.709375000000023,-6.4716796875],[16.7177734375,-6.241406250000011],[16.697265625,-6.164257812500011],[16.537109375,-5.9658203125],[16.431445312500017,-5.900195312500003],[16.315234375000017,-5.8656250000000085],[15.726953125000023,-5.863867187500006],[14.398632812500011,-5.892675781250006],[13.978515625,-5.857226562500003],[13.346484375000017,-5.863378906250006],[13.003320312500023,-5.836132812500011],[12.411718750000006,-5.986328125],[12.503710937500017,-5.69580078125],[12.518945312500023,-5.424609375000003],[12.522363281250023,-5.14892578125],[12.453222656250006,-5.090625000000003],[12.451464843750017,-5.071484375000011],[12.502734375000017,-5.036914062500003],[12.573535156250017,-4.99658203125],[12.829687500000006,-4.736621093750003],[13.07275390625,-4.634765625],[13.414941406250023,-4.83740234375],[14.358300781250023,-4.299414062500006],[14.410742187500006,-4.831250000000011],[14.707910156250023,-4.8817382812500085],[15.60009765625,-4.030957031250011],[15.872460937500023,-3.9342773437500114],[16.146777343750017,-3.464160156250003],[16.217382812500006,-3.0302734375],[16.21533203125,-2.1778320312500057],[16.54072265625001,-1.8401367187500028],[16.8798828125,-1.2258789062500028],[17.27880859375,-.9996093750000057],[17.752832031250023,-.5490234375000114],[17.72412109375,-.27753906250001137],[17.8876953125,.234130859375],[17.902441406250006,1.1180664062499943],[18.05781250000001,1.5348632812499972],[18.072167968750023,2.0132812499999915],[18.49091796875001,2.9244140624999915],[18.6103515625,3.4784179687499943],[18.567480468750006,4.257568359375],[19.06855468750001,4.891406249999989],[19.5009765625,5.127490234374989],[19.806542968750023,5.089306640624997],[20.226367187500017,4.829638671874989],[20.55810546875,4.462695312499989],[21.53759765625,4.244824218749997],[22.422167968750017,4.134960937499997],[22.755761718750023,4.646679687499997],[23.41718750000001,4.663134765624989],[24.31982421875,4.994140625],[24.765527343750023,4.930078124999994],[25.249316406250017,5.024560546874994],[25.52509765625001,5.3121093749999915],[26.822070312500017,5.062402343749994],[27.11494140625001,5.1978515624999915],[27.4033203125,5.109179687499989]]]},properties:{name:"Democratic Republic of the Congo",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[18.6103515625,3.4784179687499943],[18.49091796875001,2.9244140624999915],[18.072167968750023,2.0132812499999915],[18.05781250000001,1.5348632812499972],[17.902441406250006,1.1180664062499943],[17.8876953125,.234130859375],[17.72412109375,-.27753906250001137],[17.752832031250023,-.5490234375000114],[17.27880859375,-.9996093750000057],[16.8798828125,-1.2258789062500028],[16.54072265625001,-1.8401367187500028],[16.21533203125,-2.1778320312500057],[16.217382812500006,-3.0302734375],[16.146777343750017,-3.464160156250003],[15.872460937500023,-3.9342773437500114],[15.60009765625,-4.030957031250011],[14.707910156250023,-4.8817382812500085],[14.410742187500006,-4.831250000000011],[14.358300781250023,-4.299414062500006],[13.414941406250023,-4.83740234375],[13.07275390625,-4.634765625],[12.881054687500011,-4.445117187500003],[12.384570312500017,-4.619140625],[12.018359375000017,-5.0042968750000085],[11.777539062500011,-4.5658203125000085],[11.130175781250017,-3.916308593750003],[11.504296875000023,-3.520312500000003],[11.685742187500011,-3.6820312500000085],[11.934179687500006,-3.3185546875000114],[11.537792968750011,-2.836718750000003],[11.5751953125,-2.3970703125000057],[12.446386718750006,-2.3299804687500085],[12.43212890625,-1.9289062500000114],[12.793554687500006,-1.9318359375000114],[12.991992187500017,-2.3133789062500085],[13.464941406250006,-2.3954101562500085],[13.784375000000011,-2.1637695312500114],[14.08740234375,-2.4668945312500057],[14.383984375000011,-1.8900390625000085],[14.480566406250006,-.6183593750000114],[13.860058593750011,-.20332031250001137],[13.884570312500017,.19082031249999432],[14.087500000000006,.5365722656249972],[14.434472656250023,.8114746093749972],[14.180859375000011,1.3702148437499915],[13.851367187500017,1.4187499999999886],[13.274121093750011,1.2410156249999886],[13.162695312500006,1.6480957031249943],[13.293554687500006,2.161572265624997],[14.484082031250011,2.154736328124997],[14.902441406250006,2.0123046874999915],[15.741601562500023,1.9149902343749972],[16.059375000000017,1.6762207031249972],[16.183398437500017,2.2700683593749886],[16.468554687500017,2.831738281249997],[16.67333984375,3.5352050781249886],[17.43798828125,3.6846191406249886],[18.160937500000017,3.4998046874999886],[18.6103515625,3.4784179687499943]]]},properties:{name:"Republic of the Congo",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[-71.31972656249997,11.861914062500048],[-71.95810546875,11.666406250000009],[-72.24848632812501,11.196435546875009],[-72.690087890625,10.835839843749994],[-72.86933593750001,10.49125976562496],[-73.00654296874998,9.789160156250006],[-73.35634765625002,9.226855468750031],[-72.79638671874997,9.108984374999991],[-72.66542968749994,8.62758789062498],[-72.41655273437496,8.381982421875037],[-72.44296875,7.454882812499989],[-72.08427734374993,7.096874999999969],[-71.01328124999998,6.994433593749974],[-70.65507812500002,7.082763671875028],[-70.09501953124996,6.937939453125011],[-69.43925781249993,6.1349121093750085],[-68.47177734375,6.156542968749974],[-67.85917968749999,6.289892578124963],[-67.43935546875,6.025537109375023],[-67.82490234374995,5.270458984375026],[-67.85527343750002,4.506884765624989],[-67.66162109375,3.864257812499986],[-67.3111328125,3.41586914062502],[-67.83476562499999,2.8928222656250426],[-67.21083984375,2.3901367187500426],[-66.87602539062499,1.223046875000037],[-67.35195312499997,2.085839843750051],[-67.815087890625,1.790087890625017],[-68.17656249999999,1.7198242187499915],[-69.84858398437493,1.7087402343750426],[-69.85214843750003,1.0595214843750398],[-69.36137695312496,1.0640136718749744],[-69.16323242187502,.8640625000000028],[-70.05390624999993,.5786132812500284],[-70.07050781249993,-.1388671875000398],[-69.66748046874997,-.48242187499995737],[-69.40024414062498,-1.1949218749999773],[-69.66904296875003,-2.667675781249997],[-69.96591796875003,-4.235937500000006],[-70.16752929687499,-4.0501953125000085],[-70.24028320312496,-3.8827148437499943],[-70.2984375,-3.8442382812499716],[-70.33950195312502,-3.8143554687500085],[-70.73510742187497,-3.7815429687499886],[-70.07402343749993,-2.7501953125000114],[-70.09584960937494,-2.658203125000014],[-70.91455078125003,-2.2185546874999744],[-71.39697265625,-2.3340820312499773],[-71.55947265624997,-2.2242187499999773],[-71.75253906249995,-2.15273437499998],[-71.80273437499997,-2.1663085937499886],[-71.86728515624998,-2.227734374999983],[-71.932470703125,-2.288671874999963],[-71.98427734375,-2.3265624999999517],[-72.13681640624998,-2.38066406249996],[-72.21845703125001,-2.4004882812500057],[-72.30073242187498,-2.40927734375002],[-72.39560546874995,-2.4289062500000256],[-72.62534179687495,-2.3516601562500057],[-72.88715820312501,-2.408496093749946],[-73.15449218749993,-2.278222656249966],[-73.19697265624995,-1.8302734375000114],[-73.49628906249993,-1.6930664062500398],[-73.66430664062497,-1.248828124999946],[-73.86318359374997,-1.19667968749998],[-73.92695312500001,-1.125195312499983],[-74.05439453124995,-1.0286132812500313],[-74.18076171875,-.9977539062499545],[-74.24638671874999,-.9706054687500227],[-74.28388671874998,-.9278320312500057],[-74.33442382812498,-.8508789062499602],[-74.41787109375,-.5806640624999773],[-74.80175781249997,-.20009765624999432],[-75.13837890624998,-.050488281249968736],[-75.18408203124997,-.04174804687497158],[-75.22460937499997,-.04174804687497158],[-75.28447265624999,-.1065429687500199],[-75.46396484374995,-.038427734375005684],[-75.61733398437494,.06289062500003695],[-75.87978515624994,.1509765625000341],[-76.31103515624997,.4484863281249858],[-76.49462890624997,.2354492187500199],[-77.42275390624997,.4248535156249602],[-77.46767578124997,.636523437500017],[-78.31210937499995,1.046093750000054],[-78.85966796874996,1.4553710937500313],[-78.576904296875,1.7737792968749773],[-78.617041015625,2.3067871093750227],[-78.12001953125,2.488183593750037],[-77.67001953124998,2.87885742187504],[-77.24277343749998,3.5853515625000085],[-77.1666015625,3.8622558593750114],[-77.42729492187499,4.06044921874998],[-77.28632812499995,4.72172851562496],[-77.40175781249994,5.416162109375037],[-77.24926757812497,5.780175781250037],[-77.46943359374995,6.176757812500014],[-77.35986328125003,6.5044921874999915],[-77.90117187499999,7.229345703125048],[-77.74389648437503,7.536962890625006],[-77.35078124999995,7.7058593750000455],[-77.2123046875,8.033886718749997],[-77.37421874999993,8.65830078125002],[-76.85185546875002,8.09047851562498],[-76.88798828124999,8.619873046875],[-76.27685546875,8.989111328124991],[-76.135498046875,9.265625000000014],[-75.63935546874998,9.450439453125014],[-75.67089843750003,10.196337890625003],[-75.44599609374995,10.610888671874989],[-74.84458007812498,11.109716796875006],[-74.45424804687497,10.989062500000031],[-74.05913085937502,11.340624999999974],[-73.31337890624997,11.295751953124991],[-72.72182617187497,11.712158203125],[-72.27499999999998,11.88925781250002],[-72.13574218749994,12.188574218749977],[-71.71455078124993,12.41997070312496],[-71.26210937499997,12.335302734375034],[-71.31972656249997,11.861914062500048]]]},properties:{name:"Colombia",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[-83.6419921875,10.917236328125],[-83.4482421875,10.465917968749991],[-82.77841796874999,9.669531249999991],[-82.93984375,9.449169921874997],[-82.94033203125,9.060107421874989],[-82.741162109375,8.951708984374989],[-82.72783203124999,8.916064453124989],[-82.739990234375,8.898583984374994],[-82.91704101562499,8.740332031249991],[-82.855712890625,8.635302734374989],[-82.86162109374999,8.453515624999994],[-83.02734375,8.337744140624991],[-83.16240234374999,8.588183593749989],[-83.73408203125,8.614453124999997],[-83.63725585937499,9.035351562499997],[-83.89555664062499,9.276416015624989],[-84.65888671875,9.646679687499997],[-85.114501953125,9.581787109375],[-85.62485351562499,9.902441406249991],[-85.83061523437499,10.398144531249997],[-85.667236328125,10.745019531249994],[-85.7443359375,11.062109374999991],[-85.62138671874999,11.184472656249994],[-84.9091796875,10.9453125],[-84.348291015625,10.979882812499994],[-84.168359375,10.780371093749991],[-83.6419921875,10.917236328125]]]},properties:{name:"Costa Rica",childNum:1}},{geometry:{type:"MultiPolygon",coordinates:[[[[-82.56176757812503,21.571679687500023],[-82.85317382812497,21.443896484375017],[-83.08251953124997,21.791406250000023],[-82.71455078124998,21.890283203125023],[-82.56176757812503,21.571679687500023]]],[[[-81.83745117187499,23.163037109374955],[-81.17861328124997,23.059667968750034],[-80.65014648437494,23.10307617187499],[-79.67666015624997,22.743066406250023],[-79.27568359374999,22.407617187499994],[-78.68647460937493,22.366845703125023],[-77.86503906250002,21.900585937499983],[-77.49726562499995,21.871630859375045],[-76.64741210937501,21.284521484375063],[-75.72294921874996,21.111035156249983],[-75.64277343749998,20.733496093749977],[-74.882568359375,20.65063476562497],[-74.25283203124997,20.079687500000006],[-75.11640624999995,19.901416015625017],[-76.15844726562497,19.98974609374997],[-77.715087890625,19.85546874999997],[-77.21337890625003,20.300390625000034],[-77.22958984374995,20.643749999999983],[-77.99731445312494,20.715380859375017],[-78.49077148437493,21.05371093750003],[-78.63647460937497,21.51552734375005],[-79.27441406249997,21.562646484374966],[-80.23134765625,21.872167968750063],[-80.49907226562499,22.063525390625045],[-80.96191406249997,22.052880859375023],[-81.81621093750002,22.2001953125],[-81.90341796875,22.679003906250017],[-82.73803710937497,22.689257812500074],[-83.37963867187503,22.222998046875034],[-84.32636718749998,22.074316406250034],[-84.36127929687498,22.37890625],[-84.04492187500003,22.666015625000057],[-83.25781249999997,22.967578125000017],[-82.10136718750002,23.19042968750003],[-81.83745117187499,23.163037109374955]]]]},properties:{name:"Cuba",childNum:2}},{geometry:{type:"Polygon",coordinates:[[[34.004492187500006,35.065234374999996],[32.71269531250002,35.171044921874994],[32.94160156250001,35.390429687499996],[33.941992187500006,35.292041015624996],[34.004492187500006,35.065234374999996]]]},properties:{name:"Northern Cyprus",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[32.71269531250002,35.171044921874994],[34.004492187500006,35.065234374999996],[32.94179687500002,34.57587890625],[32.44902343750002,34.729443359375],[32.31718750000002,34.9533203125],[32.71269531250002,35.171044921874994]]]},properties:{name:"Cyprus",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[14.809375000000017,50.858984375],[16.007226562500023,50.611621093749996],[16.679101562500023,50.097460937499996],[17.151953125000006,50.378320312499994],[17.874804687500017,49.972265625],[18.562402343750023,49.879345703125],[18.83222656250001,49.510791015624996],[18.160937500000017,49.257373046874996],[17.75849609375001,48.888134765625],[17.1884765625,48.8609375],[16.953125,48.598828125],[16.477929687500023,48.800097656249996],[16.057226562500006,48.754785156249994],[14.97216796875,48.983935546874996],[14.691308593750023,48.59921875],[14.049121093750017,48.602490234375],[13.814746093750017,48.766943359375],[13.769921875000023,48.815966796874996],[13.547656250000017,48.95966796875],[13.140527343750023,49.158349609374994],[12.632031250000011,49.461230468749996],[12.512500000000017,49.87744140625],[12.3056640625,50.205712890624994],[13.016406250000017,50.490380859374994],[13.18115234375,50.510498046875],[14.369042968750023,50.898730468749996],[14.809375000000017,50.858984375]]]},properties:{name:"Czech Republic",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[9.739746093750028,54.82553710937498],[10.360449218750006,54.43833007812506],[11.39960937500004,53.94462890625002],[12.111328125,54.168310546875006],[12.57539062500004,54.467382812500006],[13.028613281250017,54.411035156249994],[13.865527343750074,53.85336914062498],[14.250000000000057,53.73188476562501],[14.298730468750051,53.55644531249999],[14.41455078125,53.28349609374996],[14.412304687500011,53.216748046874955],[14.410937500000074,53.19902343749999],[14.368554687500051,53.105566406250034],[14.293164062500068,53.026757812499966],[14.193652343750045,52.982324218749994],[14.138867187500068,52.93286132812503],[14.128613281250011,52.87822265625002],[14.253710937500017,52.78251953124996],[14.514062500000023,52.645605468750034],[14.619433593750017,52.52851562499998],[14.569726562499994,52.431103515624955],[14.554589843750023,52.35966796874996],[14.573925781250068,52.31416015625001],[14.615625000000023,52.277636718750045],[14.679882812500068,52.25],[14.705371093750017,52.207470703124955],[14.752539062500034,52.08183593750002],[14.601660156250034,51.832373046875006],[14.9638671875,51.095117187499994],[13.18115234375,50.510498046875],[13.016406250000017,50.490380859374994],[12.3056640625,50.205712890624994],[12.512500000000017,49.87744140625],[12.63203125000004,49.46123046875002],[13.14052734375008,49.15834960937505],[13.547656250000074,48.95966796874998],[13.769921875000051,48.81596679687502],[13.814746093750017,48.76694335937498],[13.802929687500011,48.74750976562501],[13.785351562499983,48.58745117187502],[13.486621093750074,48.58183593750002],[13.471679687500028,48.57182617187502],[13.459863281250023,48.564550781250034],[13.40937500000004,48.39414062500006],[13.374609375000063,48.361376953125045],[13.322851562500006,48.33125000000004],[13.215234375000023,48.301904296874994],[12.685839843750074,47.66933593750002],[11.716796875,47.58349609375003],[11.297949218750034,47.424902343750034],[10.873046874999972,47.52021484375001],[10.65869140625,47.547216796875006],[10.482812500000051,47.54179687499996],[10.43037109375004,47.54106445312499],[10.403906250000063,47.41699218750003],[10.312792968750074,47.31342773437498],[10.18300781250008,47.27880859375003],[10.096484375000045,47.379589843749955],[10.066308593750023,47.39335937500002],[10.074218750000028,47.42851562499999],[10.034082031250023,47.47358398437501],[9.748925781250023,47.575537109375006],[8.572656250000023,47.775634765625],[8.414746093750011,47.58959960937503],[7.615624999999994,47.59272460937504],[7.584179687499983,48.064306640625006],[8.134863281250006,48.97358398437498],[7.450585937500051,49.152197265625034],[6.735449218750006,49.16059570312498],[6.344335937500006,49.45273437499998],[6.4873046875,49.798486328124994],[6.1165039062500455,50.120996093749966],[6.364453125000011,50.31616210937503],[5.993945312500017,50.75043945312504],[5.894726562500068,50.98422851562506],[6.193261718750051,51.48891601562502],[5.948535156250017,51.762402343749955],[6.7417968750000625,51.91088867187503],[7.035156250000057,52.38022460937498],[7.197265625000028,53.28227539062499],[7.285253906250034,53.68134765625001],[8.00927734375,53.69072265624999],[8.53847656250008,53.55688476562497],[8.897753906250074,53.83569335937503],[8.95722656250004,54.538330078125],[8.670312500000023,54.903417968750034],[9.739746093750028,54.82553710937498]]]},properties:{name:"Germany",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[43.24599609375002,11.499804687499989],[42.92275390625002,10.999316406249989],[42.557714843750006,11.080761718749997],[41.79824218750002,10.98046875],[41.76650390625002,11.589111328125],[42.378515625000006,12.466406249999991],[42.67011718750001,12.376562499999991],[42.703710937500006,12.380322265624997],[42.76748046875002,12.4228515625],[42.88330078125,12.621289062499997],[43.00566406250002,12.662304687499997],[43.11669921875,12.708593749999991],[43.409765625000006,12.18994140625],[43.272070312500006,11.969531249999989],[42.79902343750001,11.739404296874994],[43.24599609375002,11.499804687499989]]]},properties:{name:"Djibouti",childNum:1}},{geometry:{type:"MultiPolygon",coordinates:[[[[10.645117187500006,55.60981445312498],[10.785253906250034,55.13339843749998],[9.988769531250028,55.163183593750006],[9.860644531250045,55.515478515625034],[10.645117187500006,55.60981445312498]]],[[[12.568750000000023,55.785058593749966],[11.653808593750057,55.186914062499966],[11.286328125000068,55.20444335937498],[10.978906250000051,55.721533203125006],[12.218945312499983,56.11865234374997],[12.568750000000023,55.785058593749966]]],[[[9.739746093750028,54.82553710937498],[8.670312500000023,54.903417968750034],[8.61591796875004,55.41821289062503],[8.132128906250074,55.59980468749998],[8.16396484375008,56.60688476562498],[8.618554687500051,57.11127929687498],[9.554296874999977,57.23247070312496],[9.96230468750008,57.580957031249994],[10.537109375000028,57.44853515625002],[10.282714843750057,56.620507812499994],[10.18300781250008,55.86518554687504],[9.591113281250017,55.49321289062502],[9.739746093750028,54.82553710937498]]]]},properties:{name:"Denmark",childNum:3}},{geometry:{type:"Polygon",coordinates:[[[-71.647216796875,19.195947265624994],[-71.75742187499999,19.688183593749997],[-71.557763671875,19.89536132812499],[-70.95415039062499,19.913964843749994],[-70.12944335937499,19.636132812499994],[-69.739404296875,19.299218749999994],[-68.684765625,18.90478515625],[-68.35927734375,18.5380859375],[-68.658837890625,18.22202148437499],[-68.9349609375,18.408007812500003],[-69.770654296875,18.443554687499997],[-70.18310546875,18.251757812500003],[-71.02783203125,18.273193359375],[-71.395703125,17.64609374999999],[-71.63173828125,17.773632812499997],[-71.7619140625,18.34130859375],[-71.647216796875,19.195947265624994]]]},properties:{name:"Dominican Republic",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[8.207617187500006,36.518945312499994],[8.348730468750006,36.367968749999996],[8.318066406250011,35.654931640624994],[8.31640625,35.403124999999996],[8.35986328125,35.299609374999996],[8.394238281250011,35.203857421875],[8.312109375000006,35.084619140624994],[8.27685546875,34.9794921875],[8.24560546875,34.73408203125],[7.513867187500011,34.080517578125],[7.49560546875,33.976513671875],[7.500195312500011,33.832470703125],[7.534375000000011,33.717919921874994],[7.7626953125,33.23310546875],[7.877246093750017,33.172119140625],[8.2109375,32.926708984375],[8.333398437500023,32.543603515624994],[9.044042968750006,32.07236328125],[9.160253906250006,31.621337890625],[9.224023437500023,31.373681640624994],[9.36328125,30.832910156249994],[9.518750000000011,30.229394531249994],[9.310253906250011,30.115234375],[9.672656250000017,29.5669921875],[9.842578125000017,28.966992187499997],[9.916015625,27.785693359374996],[9.74755859375,27.330859374999996],[9.859375,26.551953124999997],[9.491406250000011,26.333740234375],[9.4482421875,26.067138671875],[10.000683593750011,25.332080078125003],[10.255859375,24.591015624999997],[10.686132812500006,24.55136718749999],[11.536914062500017,24.290820312500003],[11.967871093750006,23.517871093750003],[9.378710937500017,21.991406249999997],[7.481738281250017,20.873095703125003],[5.836621093750011,19.479150390624994],[4.227636718750006,19.142773437499997],[3.40087890625,18.988427734374994],[3.1060546875000057,19.150097656249997],[3.255859375,19.410937500000003],[3.2037109375000057,19.789697265624994],[2.4061523437500227,20.063867187499994],[2.2193359375000057,20.247802734375],[1.6854492187500227,20.378369140624997],[1.1657226562500114,20.817431640625003],[1.1455078125,21.102246093749997],[-1.29296875,22.696533203125],[-3.2578613281249886,23.981250000000003],[-4.822607421874977,24.99560546875],[-6.238671874999994,25.848193359375003],[-8.683349609375,27.285937499999996],[-8.683349609375,27.656445312499997],[-8.683349609375,27.900390625],[-8.659912109375,28.718603515625],[-8.265185546874989,28.980517578124996],[-7.998925781249994,29.132421875],[-7.685156249999977,29.349511718749994],[-7.485742187499994,29.392236328124994],[-7.094921874999983,29.625195312499997],[-6.855566406249977,29.601611328124996],[-6.755126953125,29.583837890625],[-6.635351562499977,29.568798828124997],[-6.520556640624989,29.659863281249997],[-6.510693359374983,29.726025390624997],[-6.507910156249977,29.7837890625],[-6.500878906249994,29.809130859374996],[-5.774999999999977,29.869042968749994],[-5.448779296874989,29.956933593749994],[-5.293652343749983,30.058642578124996],[-5.180126953124983,30.166162109374994],[-4.96826171875,30.465380859374996],[-4.778515624999983,30.552392578124994],[-4.529150390624977,30.625537109374996],[-4.322851562499977,30.698876953124994],[-4.148779296874977,30.8095703125],[-3.7020019531249773,30.944482421874994],[-3.6667968749999886,30.964013671874994],[-3.626904296874983,31.000927734374997],[-3.6725097656249943,31.111376953124996],[-3.8333984374999943,31.197802734374996],[-3.837109374999983,31.512353515624994],[-3.8267578124999773,31.661914062499996],[-3.4397949218749773,31.704541015624997],[-3.0173828124999886,31.834277343749996],[-2.988232421874983,31.874218749999997],[-2.930859374999983,32.042529296874996],[-2.8634277343749943,32.07470703125],[-2.5232421874999886,32.12568359375],[-2.4483886718749943,32.12998046875],[-2.0728027343749886,32.115039062499996],[-1.8169921874999773,32.104785156249996],[-1.275341796874983,32.089013671874994],[-1.16259765625,32.399169921875],[-1.510009765625,32.87763671875],[-1.550732421874983,33.073583984375],[-1.67919921875,33.318652343749996],[-1.7069335937499943,34.176074218749996],[-1.8496582031249886,34.607324218749994],[-1.792187499999983,34.723193359374996],[-1.795605468749983,34.751904296875],[-1.9208984375,34.835546875],[-2.131787109374983,34.970849609374994],[-2.1907714843749773,35.02978515625],[-2.2196289062499943,35.10419921875],[-1.3358398437499943,35.3642578125],[-.42612304687497726,35.8615234375],[.047949218750005684,35.900537109374994],[.514941406250017,36.26181640625],[1.2572265625000227,36.519580078124996],[2.5933593750000057,36.60068359375],[2.9728515625000114,36.784472656249996],[3.7790039062500114,36.89619140625],[4.758105468750017,36.896337890625],[5.195605468750017,36.676806640624996],[6.064746093750017,36.8642578125],[6.486523437500011,37.085742187499996],[6.927539062500017,36.91943359375],[7.607714843750017,36.999755859375],[7.910449218750017,36.856347656249994],[8.127148437500011,36.9103515625],[8.576562500000023,36.93720703125],[8.207617187500006,36.518945312499994]]]
},properties:{name:"Algeria",childNum:1}},{geometry:{type:"MultiPolygon",coordinates:[[[[-91.27216796874998,.02514648437498579],[-90.799658203125,-.7520507812499915],[-90.90551757812497,-.9405273437500199],[-91.36918945312493,-.28720703124997726],[-91.27216796874998,.02514648437498579]]],[[[-75.28447265624999,-.1065429687500199],[-75.34047851562494,-.14218750000000568],[-75.47597656250002,-.15712890625002274],[-75.26323242187502,-.555371093749983],[-75.25937500000003,-.5901367187499602],[-75.27871093749997,-.6539062499999773],[-75.28359375,-.7071289062499915],[-75.24960937499998,-.9518554687500256],[-75.570556640625,-1.5312500000000142],[-75.64165039062502,-1.60732421874998],[-76.08979492187501,-2.1331054687499744],[-76.6791015625,-2.5625976562499915],[-77.860595703125,-2.9816406250000114],[-78.240380859375,-3.4725585937500085],[-78.64799804687499,-4.248144531250006],[-78.68603515625003,-4.562402343749994],[-78.86152343749998,-4.665039062499943],[-78.97539062499999,-4.873242187499997],[-78.99526367187497,-4.908007812499974],[-79.03330078124998,-4.969140624999994],[-79.07626953125003,-4.990625000000023],[-79.18666992187497,-4.958203124999983],[-79.26811523437493,-4.957617187499949],[-79.33095703124997,-4.92783203125002],[-79.39941406249997,-4.840039062499983],[-79.45576171874998,-4.766210937499949],[-79.50190429687495,-4.670605468750011],[-79.51616210937493,-4.539160156249963],[-79.57768554687496,-4.50058593750002],[-79.638525390625,-4.454882812500031],[-79.79726562500002,-4.47636718749996],[-79.962890625,-4.390332031250026],[-80.06352539062499,-4.327539062500023],[-80.13955078125002,-4.296093750000011],[-80.19746093750001,-4.311035156249943],[-80.293359375,-4.416796875000003],[-80.48847656249995,-4.3936523437499915],[-80.35288085937495,-4.208496093750014],[-80.453759765625,-4.205175781249963],[-80.48847656249995,-4.165527343749972],[-80.49345703124999,-4.119140625000014],[-80.510009765625,-4.06953125000004],[-80.49013671874994,-4.010058593750003],[-80.43720703125001,-3.9786132812499915],[-80.30327148437499,-4.005078124999969],[-80.26689453124993,-3.948828124999963],[-80.17924804687493,-3.87773437499996],[-80.21757812500002,-3.7876953124999915],[-80.22060546875002,-3.613183593749966],[-80.24375000000003,-3.5767578125000057],[-80.24541015625002,-3.522167968749997],[-80.26523437499995,-3.4924804687499886],[-80.27353515624995,-3.424609375000017],[-80.30312499999994,-3.3748046874999886],[-79.92158203124993,-3.0901367187499886],[-79.72988281249997,-2.5791015624999716],[-80.45009765624997,-2.6259765625000284],[-80.96279296874997,-2.18925781249996],[-80.770361328125,-2.0766601562500284],[-80.80141601562494,-1.3833984375000057],[-80.90239257812499,-1.0789062499999744],[-80.55390624999998,-.8479492187499886],[-80.48227539062503,-.36826171874996305],[-80.1333984375,-.006054687499982947],[-80.02499999999995,.4101562499999858],[-80.08828124999997,.7847656250000199],[-79.74121093749997,.9797851562500455],[-78.89965820312503,1.2062499999999972],[-78.85966796874996,1.4553710937500313],[-78.31210937499995,1.046093750000054],[-77.46767578124997,.636523437500017],[-77.42275390624997,.4248535156249602],[-76.49462890624997,.2354492187500199],[-76.31103515624997,.4484863281249858],[-75.87978515624994,.1509765625000341],[-75.61733398437494,.06289062500003695],[-75.46396484374995,-.038427734375005684],[-75.28447265624999,-.1065429687500199]]]]},properties:{name:"Ecuador",childNum:2}},{geometry:{type:"Polygon",coordinates:[[[34.24531250000001,31.208300781249996],[34.904296875,29.477343749999996],[34.736425781250006,29.27060546875],[34.39970703125002,28.016015624999994],[34.22011718750002,27.764306640624994],[33.76025390625,28.047656249999996],[33.24775390625001,28.567724609375],[33.075781250000006,29.073046874999996],[32.72148437500002,29.521777343749996],[32.6318359375,28.992236328124996],[32.89824218750002,28.565234374999996],[33.54707031250001,27.898144531249997],[33.5498046875,27.607373046874997],[33.89306640625,27.049462890624994],[33.959082031250006,26.6490234375],[34.56513671875001,25.691162109375],[35.19414062500002,24.475146484375003],[35.62470703125001,24.06601562499999],[35.52275390625002,23.442529296874994],[35.697851562500006,22.946191406249994],[36.22968750000001,22.628808593749994],[36.87138671875002,21.996728515624994],[33.91845703125,21.996240234374994],[31.434472656250023,21.995849609375],[29.564550781250006,21.9951171875],[28.036425781250017,21.995361328125],[24.980273437500017,21.995849609375],[24.980273437500017,24.466064453125],[24.980273437500017,26.487109374999996],[24.980273437500017,29.181884765625],[24.726464843750023,30.2505859375],[24.973925781250017,30.776562499999997],[24.85273437500001,31.334814453125],[25.150488281250006,31.654980468749997],[25.382226562500023,31.51279296875],[25.89326171875001,31.620898437499996],[27.248046875,31.377880859374997],[27.967578125000017,31.097412109375],[28.51484375000001,31.050439453124994],[29.072070312500017,30.830273437499997],[29.591601562500017,31.011523437499996],[30.395117187500006,31.4576171875],[30.700488281250017,31.403857421874996],[31.193945312500006,31.587597656249997],[32.10175781250001,31.092822265624996],[34.24531250000001,31.208300781249996]]]},properties:{name:"Egypt",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[40.938574218750006,13.983105468749997],[40.82011718750002,14.111669921874991],[40.22148437500002,14.431152343749972],[39.531835937500006,14.536718749999991],[38.43144531250002,14.428613281249994],[38.221484375000074,14.649658203124986],[38.002539062500006,14.737109375000045],[37.94345703125006,14.810546875],[37.884179687499994,14.852294921874972],[37.82031250000003,14.708496093749986],[37.70839843750005,14.45722656250004],[37.64843750000003,14.32255859375006],[37.571191406249994,14.149072265624966],[37.546777343749994,14.143847656249974],[37.507226562499994,14.156396484375037],[37.257226562499994,14.453759765625051],[37.024511718750006,14.271972656250057],[36.81191406250005,14.315039062500034],[36.67910156250005,14.307568359375026],[36.542382812499994,14.258203124999994],[36.52431640625005,14.256835937499986],[36.492285156250006,14.544335937500023],[36.470800781250006,14.736474609375009],[36.448144531249994,14.940087890625009],[36.42675781249997,15.132080078125043],[36.566015625000006,15.362109375000003],[36.9137695312501,16.296191406250045],[36.887792968750006,16.624658203124994],[36.9787109375001,16.800585937500045],[36.9757812500001,16.866552734375006],[36.99521484375006,17.020556640625017],[37.00898437500004,17.058886718750017],[37.06152343749997,17.061279296875057],[37.16953125000006,17.041406249999994],[37.41103515625005,17.061718749999955],[37.452929687500074,17.108691406250017],[37.510156249999994,17.28813476562499],[37.78242187500004,17.458007812500057],[38.253515625000006,17.584765625000017],[38.26728515625004,17.616699218750057],[38.28984375000002,17.637011718750017],[38.34736328125004,17.68359375],[38.37373046875004,17.717333984375045],[38.42246093750006,17.823925781249983],[38.60947265625006,18.00507812500004],[38.91171875000006,17.427148437499994],[39.14257812500003,16.729150390624966],[39.298925781250006,15.921093750000011],[39.5065429687501,15.532128906249994],[39.86376953124997,15.470312500000034],[40.20410156250003,15.014111328124983],[41.17646484375004,14.620312500000054],[41.65820312499997,13.983056640624994],[42.24511718749997,13.587646484374986],[42.796191406250074,12.864257812500057],[43.08291015625005,12.824609374999966],[43.11669921874997,12.708593749999963],[43.00566406250002,12.66230468750004],[42.88330078124997,12.621289062500026],[42.767480468749994,12.422851562500014],[42.70371093750006,12.380322265625054],[42.67011718750004,12.376562499999991],[42.479394531249994,12.513623046875026],[42.37851562500006,12.466406250000006],[41.76503906250005,13.183935546874991],[41.362890625000006,13.499804687500031],[40.938574218750006,13.983105468749997]]]},properties:{name:"Eritrea",childNum:1}},{geometry:{type:"MultiPolygon",coordinates:[[[[-16.33447265624997,28.37993164062499],[-16.65800781249999,28.007177734374977],[-16.905322265625017,28.33959960937503],[-16.33447265624997,28.37993164062499]]],[[[3.145312500000017,39.79008789062499],[3.4618164062500227,39.69775390625003],[3.0728515625000057,39.30126953124997],[2.371289062500068,39.61308593749999],[2.7849609375000455,39.854833984375034],[3.145312500000017,39.79008789062499]]],[[[-1.7940429687499488,43.407324218750006],[-1.2854492187499886,43.05961914062496],[-.041162109374994316,42.689111328124966],[1.4283203124999773,42.59589843749998],[1.7060546875,42.50332031250005],[2.0327148437500284,42.353515625],[3.21142578125,42.43115234375],[3.248046875,41.94423828125002],[2.0826171875000625,41.287402343750045],[1.0329101562500682,41.06206054687496],[-.32700195312494884,39.519873046875006],[-.20493164062494884,39.062597656250034],[.20156250000007958,38.75917968750002],[-.3812499999999943,38.435644531250034],[-.6467773437499886,38.15185546875003],[-.8221679687499375,37.58076171875004],[-1.3275390624999375,37.561132812500034],[-1.7976074218749716,37.23286132812504],[-2.111523437499983,36.77666015624999],[-4.366845703124994,36.71811523437506],[-4.67412109374996,36.506445312500006],[-5.171484374999949,36.423779296874955],[-5.62548828125,36.02592773437499],[-6.0406738281249375,36.18842773437498],[-6.492431640624943,36.95463867187502],[-6.88461914062492,37.194238281249966],[-7.4061523437499375,37.17944335937497],[-7.503515624999977,37.58549804687502],[-7.185449218749994,38.00634765625006],[-7.343017578124943,38.45742187500002],[-7.0460449218749375,38.907031250000045],[-7.44511718749996,39.53618164062496],[-7.036718750000006,39.713964843750034],[-6.81015624999992,40.343115234375034],[-6.928466796874972,41.009130859375006],[-6.212499999999949,41.53203124999996],[-6.61826171874992,41.9423828125],[-7.40361328124996,41.833691406249955],[-7.920849609374983,41.883642578125006],[-8.213085937499926,42.133691406249966],[-8.777148437500017,41.941064453124994],[-8.690917968749943,42.274169921875],[-9.235205078124977,42.97690429687498],[-8.873681640624966,43.33442382812498],[-7.698144531249994,43.76455078125005],[-7.261962890624972,43.594628906249966],[-5.66582031249996,43.58247070312498],[-4.52304687499992,43.41572265625004],[-3.604638671874966,43.51948242187504],[-3.045605468749926,43.37158203125],[-2.337109374999926,43.32802734375002],[-1.7940429687499488,43.407324218750006]]]]},properties:{name:"Spain",childNum:3}},{geometry:{type:"MultiPolygon",coordinates:[[[[22.61738281250004,58.62124023437502],[23.29287109375008,58.483496093750006],[22.152929687500006,58.11533203124998],[22.081347656250074,58.47812499999998],[22.61738281250004,58.62124023437502]]],[[[28.012500000000045,59.484277343749966],[27.464453125000034,58.84130859375],[27.48779296875,58.270068359375045],[27.75283203125008,57.841015624999955],[27.542089843750063,57.799414062500006],[27.400000000000063,57.66679687499999],[27.35195312500005,57.52812499999999],[27.187109375000034,57.53833007812503],[27.033398437500068,57.578759765624994],[26.96601562500001,57.60913085937506],[26.899804687500023,57.608789062499994],[26.29804687500001,57.60107421875],[25.66015625,57.920166015625],[25.11103515625004,58.06342773437498],[24.91132812500001,58.00458984374998],[24.83906250000004,57.98872070312504],[24.775781250000023,57.98525390625002],[24.45888671875005,57.907861328124994],[24.529101562500045,58.35424804687497],[23.767578125000057,58.36083984374997],[23.50927734375003,58.65854492187498],[23.494433593750017,59.19565429687498],[24.38037109375003,59.47265625],[25.50927734374997,59.63901367187506],[26.974707031250006,59.450634765624955],[28.012500000000045,59.484277343749966]]]]},properties:{name:"Estonia",childNum:2}},{geometry:{type:"Polygon",coordinates:[[[38.43144531250002,14.428613281249994],[39.531835937500006,14.536718749999991],[40.22148437500002,14.43115234375],[40.82011718750002,14.111669921874991],[40.938574218750006,13.983105468749997],[41.362890625000006,13.499804687500003],[41.76503906250002,13.183935546874991],[42.378515625000006,12.466406249999991],[41.76650390625002,11.589111328125],[41.79824218750002,10.98046875],[42.557714843750006,11.080761718749997],[42.92275390625002,10.999316406249989],[42.65957031250002,10.621386718749989],[42.84160156250002,10.203076171874997],[43.181640625,9.879980468749991],[43.482519531250006,9.379492187499991],[44.02285156250002,8.986035156249997],[46.97822265625001,7.9970703125],[47.97822265625001,7.9970703125],[45.93496093750002,5.997216796874994],[44.940527343750006,4.912011718749994],[44.02812500000002,4.950976562499989],[43.53828125000001,4.84033203125],[43.01601562500002,4.5633300781249915],[42.791601562500006,4.2919921875],[42.02412109375001,4.137939453125],[41.91533203125002,4.031298828124989],[41.88398437500001,3.977734374999997],[41.73769531250002,3.9790527343749886],[41.48193359375,3.9632812499999943],[41.22089843750001,3.943554687499997],[41.02080078125002,4.0574707031249915],[40.765234375000006,4.2730468749999915],[39.84218750000002,3.8514648437499943],[39.79033203125002,3.7542480468749915],[39.65751953125002,3.577832031249997],[39.49443359375002,3.4561035156249886],[38.608007812500006,3.60009765625],[38.45156250000002,3.6048339843749915],[38.22529296875001,3.6189941406249915],[38.08613281250001,3.6488281249999943],[37.15458984375002,4.254541015624994],[36.90556640625002,4.4114746093749915],[36.08193359375002,4.44970703125],[36.02197265625,4.4681152343749915],[35.97871093750001,4.503808593749994],[35.76308593750002,4.808007812499994],[35.75615234375002,4.950488281249989],[35.779296875,5.1055664062499915],[35.80029296875,5.156933593749997],[35.74501953125002,5.343994140625],[35.325292968750006,5.364892578124994],[35.2646484375,5.412060546874997],[35.26386718750001,5.457910156249994],[35.26835937500002,5.4922851562499915],[35.08193359375002,5.673144531249989],[34.71064453125001,6.660302734374994],[34.06425781250002,7.225732421874994],[33.666113281250006,7.6709960937499915],[33.22597656250002,7.760644531249994],[33.01259765625002,7.9515136718749915],[33.23427734375002,8.396386718749994],[33.95332031250001,8.443505859374994],[34.09453125000002,8.582226562499997],[34.078125,9.461523437499991],[34.29150390625,10.124755859375],[34.27568359375002,10.528124999999989],[34.571875000000006,10.880175781249989],[34.93144531250002,10.864794921874989],[35.1123046875,11.816552734374994],[35.59609375000002,12.537304687499997],[36.107519531250006,12.726464843749994],[36.21220703125002,13.271093749999991],[36.390625,13.626074218749991],[36.52431640625002,14.2568359375],[36.54238281250002,14.258203124999994],[36.67910156250002,14.307568359374997],[36.81191406250002,14.315039062499991],[37.024511718750006,14.27197265625],[37.25722656250002,14.453759765624994],[37.50722656250002,14.156396484374994],[37.54677734375002,14.143847656250003],[37.57119140625002,14.149072265624994],[37.6484375,14.322558593750003],[37.70839843750002,14.457226562499997],[37.8203125,14.70849609375],[37.88417968750002,14.852294921875],[37.943457031250006,14.810546875],[38.002539062500006,14.737109375000003],[38.22148437500002,14.649658203125],[38.43144531250002,14.428613281249994]]]},properties:{name:"Ethiopia",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[28.96582031250003,69.02197265625],[28.470703125000057,68.48837890625],[29.343847656250006,68.06186523437506],[29.941210937500074,67.54746093749998],[29.087011718750034,66.97094726562503],[29.903417968750006,66.091064453125],[29.60419921875004,64.968408203125],[30.072851562500063,64.76503906250005],[30.10810546875004,64.36611328125005],[30.50390625000003,64.02060546875],[30.05537109375004,63.689013671875045],[31.180859375000097,63.208300781250074],[31.533984375000017,62.885400390624994],[31.28564453125003,62.567822265624955],[29.69013671875004,61.54609375000001],[27.797656250000074,60.53613281250003],[25.65644531250004,60.33320312499998],[23.721777343750063,59.965673828125006],[22.79345703125003,60.076806640624994],[22.57587890625001,60.35908203125004],[21.436035156250057,60.596386718749955],[21.36054687500004,60.96748046874998],[21.605957031250057,61.59155273437503],[21.255957031250063,61.98964843750005],[21.103613281250034,62.622949218749994],[22.243261718750034,63.437939453124955],[23.248730468750068,63.89614257812505],[24.557910156250045,64.801025390625],[25.372656250000034,65.00947265625001],[25.34785156250004,65.47924804687497],[24.15546875000004,65.80527343750006],[23.70117187500003,66.48076171874999],[23.988574218750045,66.81054687500003],[23.468066406250074,67.449951171875],[23.63886718750004,67.95439453125002],[22.78242187500001,68.39101562499997],[21.99746093750005,68.52060546874998],[20.622167968750006,69.036865234375],[21.621777343750068,69.27070312499995],[22.410937500000074,68.719873046875],[23.85400390625,68.80590820312503],[24.94140625000003,68.59326171875006],[25.748339843750017,68.99013671875],[26.011523437500074,69.65263671875005],[26.525390625000057,69.91503906250003],[27.889941406250045,70.06166992187497],[29.14160156250003,69.67143554687505],[28.96582031250003,69.02197265625]]]},properties:{name:"Finland",childNum:1}},{geometry:{type:"MultiPolygon",coordinates:[[[[178.28017578124994,-17.37197265625001],[178.59160156249996,-17.651464843750006],[178.66767578125004,-18.080859375000003],[177.8470703125,-18.254882812500014],[177.32138671875,-18.077539062500037],[177.26396484375007,-17.86347656250004],[177.61796875000007,-17.461035156250034],[178.28017578124994,-17.37197265625001]]],[[[179.99921875000004,-16.168554687499977],[179.74814453125006,-16.44628906249997],[179.9279296875001,-16.74443359374996],[179.00683593750003,-16.90019531249999],[178.80507812499994,-16.631445312500034],[179.55175781250003,-16.249902343750023],[180.00000000000003,-16.15292968749999],[179.99921875000004,-16.168554687499977]]]]},properties:{name:"Fiji",childNum:2}},{geometry:{type:"MultiPolygon",coordinates:[[[[-60.28623046874995,-51.461914062500014],[-59.26806640625,-51.42753906250003],[-59.92138671874997,-51.969531250000045],[-60.28623046874995,-51.461914062500014]]],[[[-58.85019531249995,-51.26992187499998],[-58.473730468750006,-51.50908203125003],[-57.976513671874955,-51.38437500000003],[-57.83818359374993,-51.70917968750003],[-58.68349609375002,-51.93623046875001],[-59.06801757812502,-52.17304687500003],[-59.57080078124994,-51.92539062500003],[-59.05952148437498,-51.685449218749994],[-58.85019531249995,-51.26992187499998]]]]},properties:{name:"United Kingdom",childNum:2}},{geometry:{type:"MultiPolygon",coordinates:[[[[55.79736328125003,-21.33935546875003],[55.36269531250005,-21.27363281250004],[55.311328125000074,-20.90410156249999],[55.661914062500074,-20.906249999999986],[55.79736328125003,-21.33935546875003]]],[[[-51.65253906249998,4.061279296874972],[-51.99062499999994,3.702001953124963],[-52.70063476562501,2.36367187499998],[-52.96484375,2.1835449218749687],[-53.76777343749998,2.3548339843750483],[-54.13007812499998,2.1210449218750256],[-54.51508789062498,2.245458984374963],[-54.55048828125001,2.2930664062499915],[-54.59194335937502,2.3137695312500313],[-54.61625976562499,2.3267578125000057],[-54.60473632812497,2.3357910156249915],[-54.56840820312502,2.3425781250000313],[-54.53593749999999,2.343310546875003],[-54.48554687500001,2.4161132812500057],[-54.402001953124966,2.46152343750002],[-54.25673828125002,2.7137207031249773],[-54.19550781249998,2.817871093750057],[-54.03422851562499,3.62939453125],[-54.350732421874994,4.054101562500023],[-54.45219726562496,5.013476562499989],[-54.085302734375006,5.41181640625004],[-53.84716796875,5.782226562500014],[-53.454443359375006,5.563476562500028],[-52.899316406249966,5.425048828124986],[-52.29052734375003,4.942187500000031],[-51.91958007812494,4.52431640624998],[-51.65253906249998,4.061279296874972]]],[[[9.480371093750023,42.80541992187503],[9.550683593750051,42.12973632812506],[9.186132812500034,41.38491210937502],[8.80751953125008,41.58837890625],[8.71308593750004,42.54975585937501],[9.480371093750023,42.80541992187503]]],[[[5.789746093749983,49.53828125000001],[5.823437500000011,49.50507812499998],[5.9013671875,49.48974609374997],[5.928906250000011,49.47753906249997],[5.959472656250028,49.45463867187502],[6.074121093750023,49.45463867187502],[6.119921875000017,49.485205078125034],[6.242187500000057,49.49433593750001],[6.277343750000028,49.47753906249997],[6.344335937500006,49.45273437499998],[6.735449218750006,49.16059570312498],[7.450585937500051,49.152197265625034],[8.134863281250006,48.97358398437498],[7.584179687499983,48.064306640625006],[7.615624999999994,47.59272460937504],[7.000585937500034,47.32250976562506],[6.429003906250017,46.832275390625],[6.06025390625004,46.42817382812501],[6.095898437500011,46.279394531250006],[5.9700195312500455,46.214697265625034],[5.971484375000074,46.151220703125006],[6.0066406250000455,46.14233398437506],[6.086621093750068,46.14702148437502],[6.758105468750017,46.41577148437497],[6.772070312500006,46.16513671874998],[7.021093750000034,45.92578124999997],[7.153417968749977,45.40092773437499],[6.627734375000017,45.11796874999999],[7.030664062500023,44.71669921875005],[6.96728515625,44.280029296875],[7.651464843750034,44.03364257812498],[7.4931640625,43.767138671875045],[6.494042968750023,43.169287109375006],[6.115917968750011,43.07236328124998],[5.406542968750074,43.228515625],[5.05976562500004,43.44453125000004],[4.628710937500074,43.387109374999966],[4.052636718750023,43.59306640625002],[3.2588867187500625,43.193212890625006],[3.051757812500057,42.915136718750006],[3.21142578125,42.43115234375],[2.0327148437500284,42.353515625],[1.7060546875,42.50332031250005],[1.4283203124999773,42.59589843749998],[-.041162109374994316,42.689111328124966],[-1.2854492187499886,43.05961914062496],[-1.7940429687499488,43.407324218750006],[-1.4848632812499432,43.56376953124999],[-1.2455078124999375,44.55986328124999],[-1.0660156249999488,45.80566406250003],[-1.1462890624999602,46.311376953125034],[-1.7865234374999375,46.51484375000001],[-2.0188964843749204,47.03764648437502],[-3.1588378906249943,47.694677734375034],[-4.312109374999949,47.82290039062502],[-4.62919921874996,48.085791015625034],[-4.39316406249992,48.36762695312498],[-4.72075195312496,48.539892578125006],[-3.2314453124999716,48.84082031250003],[-2.692333984374983,48.53681640624998],[-2.4461914062499375,48.64829101562506],[-1.4376464843749943,48.64140624999999],[-1.8564453124999716,49.68378906249998],[-1.2586425781249488,49.68017578125006],[-1.1385253906249773,49.38789062500001],[-.16347656249993747,49.296777343749994],[.18671874999998295,49.703027343749994],[1.2455078125000512,49.99824218750001],[1.5515625000000455,50.29394531250003],[1.5794921875000512,50.73925781249997],[1.9125000000000512,50.99062500000002],[2.52490234375,51.097119140624955],[2.8397460937500227,50.71176757812498],[4.174609375000017,50.24648437500005],[4.867578125000051,49.78813476562502],[5.789746093749983,49.53828125000001]]]]},properties:{name:"France",childNum:4}},{geometry:{type:"Polygon",coordinates:[[[13.293554687500006,2.161572265624997],[13.162695312500006,1.6480957031249943],[13.274121093750011,1.2410156249999886],[13.851367187500017,1.4187499999999886],[14.180859375000011,1.3702148437499915],[14.434472656250023,.8114746093749972],[14.087500000000006,.5365722656249972],[13.884570312500017,.19082031249999432],[13.860058593750011,-.20332031250001137],[14.480566406250006,-.6183593750000114],[14.383984375000011,-1.8900390625000085],[14.08740234375,-2.4668945312500057],[13.784375000000011,-2.1637695312500114],[13.464941406250006,-2.3954101562500085],[12.991992187500017,-2.3133789062500085],[12.793554687500006,-1.9318359375000114],[12.43212890625,-1.9289062500000114],[12.446386718750006,-2.3299804687500085],[11.5751953125,-2.3970703125000057],[11.537792968750011,-2.836718750000003],[11.934179687500006,-3.3185546875000114],[11.685742187500011,-3.6820312500000085],[11.504296875000023,-3.520312500000003],[11.130175781250017,-3.916308593750003],[10.34765625,-3.0130859375000085],[9.759472656250011,-2.5185546875],[9.265625,-1.8250976562500085],[9.330664062500006,-1.5345703125000085],[9.064648437500011,-1.29833984375],[8.821386718750006,-.7083984375000085],[9.296679687500017,-.35126953125001137],[9.470117187500023,.3619140624999915],[9.329980468750023,.61083984375],[9.625878906250023,.7794433593749943],[9.676464843750011,1.07470703125],[10.028515625000011,1.0040039062499915],[11.335351562500023,.9997070312499972],[11.332324218750017,1.5283691406249886],[11.328710937500006,2.167431640624997],[11.348437500000017,2.2997070312499943],[13.220312500000006,2.2564453124999915],[13.293554687500006,2.161572265624997]]]},properties:{name:"Gabon",childNum:1}},{geometry:{type:"MultiPolygon",coordinates:[[[[-6.218017578125,54.08872070312506],[-7.3551757812499545,54.12124023437502],[-8.118261718749977,54.41425781250004],[-7.2186523437499375,55.09199218749998],[-6.129150390625028,55.217382812500034],[-5.470410156249926,54.500195312499955],[-5.60678710937492,54.272558593750034],[-6.218017578125,54.08872070312506]]],[[[-3.109667968749932,58.515478515625034],[-3.212353515624983,58.32124023437501],[-3.99003906249996,57.95903320312502],[-3.4027832031249545,57.708251953125],[-2.0740722656249773,57.70239257812506],[-1.7779296874999488,57.493750000000006],[-2.6527343750000227,56.318261718749966],[-3.178222656249943,56.080126953125045],[-2.1470703124999204,55.90297851562502],[-1.6553710937499488,55.57036132812502],[-1.2917480468749432,54.77387695312501],[-.6713867187499432,54.50390625],[-.20556640625,54.021728515625],[.5587890625000398,52.96694335937505],[1.6567382812499716,52.753710937500045],[1.5589843750000512,52.08686523437498],[.9550781250000284,51.80781249999998],[.6865234375000284,51.38657226562506],[1.4149414062500227,51.36328125],[.9601562500000114,50.92587890624998],[.205078125,50.763037109375034],[-1.5167480468749375,50.747460937499966],[-2.5477539062499375,50.61630859374998],[-3.40458984374996,50.63242187499998],[-3.7933593749999375,50.229248046875],[-4.172558593749926,50.390820312499955],[-5.342285156249943,50.24614257812496],[-4.582910156249966,50.7763671875],[-4.188183593749926,51.18852539062502],[-3.1359863281249716,51.20502929687501],[-4.38627929687496,51.74106445312506],[-4.902294921874926,51.626269531250045],[-5.088085937499926,51.99589843750002],[-4.383154296874949,52.19731445312502],[-3.980322265624949,52.54174804687503],[-4.111035156249926,53.218945312499955],[-3.064746093749932,53.426855468750034],[-2.9250976562499886,53.732763671875006],[-3.9579101562499943,54.780957031249955],[-5.135498046875,54.857519531250006],[-4.7211425781249545,55.42099609375006],[-5.245605468749972,55.929248046875045],[-5.6095703124999545,56.055273437500034],[-5.39194335937492,56.51479492187505],[-5.936767578125,56.605712890625],[-5.561914062499994,57.23271484375002],[-5.8180664062499545,57.43608398437496],[-5.338281250000023,58.23872070312498],[-4.715429687499949,58.510009765625],[-3.109667968749932,58.515478515625034]]]]},properties:{name:"United Kingdom",childNum:2}},{geometry:{type:"Polygon",coordinates:[[[46.30546875000002,41.507714843749994],[46.43095703125002,41.077050781249994],[46.086523437500006,41.183837890625],[45.28095703125001,41.449560546875],[45.21718750000002,41.423193359375],[45.00136718750002,41.290966796875],[44.97587890625002,41.277490234374994],[44.81132812500002,41.259375],[44.81093750000002,41.248583984374996],[44.84853515625002,41.220166015625],[44.841406250000006,41.211376953125],[44.47304687500002,41.191015625],[44.077246093750006,41.182519531249994],[43.43339843750002,41.155517578125],[42.78789062500002,41.563720703125],[42.466406250000006,41.439843749999994],[41.92578125,41.495654296874996],[41.82353515625002,41.432373046875],[41.779394531250006,41.44052734375],[41.701757812500006,41.471582031249994],[41.57656250000002,41.497314453125],[41.51005859375002,41.517480468749994],[41.76298828125002,41.970019531249996],[41.48876953125,42.659326171874994],[40.83662109375001,43.0634765625],[40.524023437500006,43.121044921875],[40.02373046875002,43.48486328125],[40.648046875000006,43.53388671875],[41.083105468750006,43.374462890625],[41.35820312500002,43.333398437499994],[41.46074218750002,43.276318359375],[41.58056640625,43.21923828125],[42.05000000000001,43.19013671875],[42.27968750000002,43.228076171874996],[42.419042968750006,43.22421875],[42.566015625000006,43.155126953125],[42.660253906250006,43.159082031249994],[42.76064453125002,43.169580078124994],[42.99160156250002,43.09150390625],[43.78261718750002,42.747021484375],[43.79873046875002,42.727783203125],[43.79541015625,42.702978515625],[43.74990234375002,42.657519531249996],[43.738378906250006,42.616992187499996],[43.759863281250006,42.59384765625],[43.82597656250002,42.571533203125],[43.95742187500002,42.566552734374994],[44.00468750000002,42.595605468749994],[44.10273437500001,42.616357421874994],[44.32949218750002,42.703515624999994],[44.505859375,42.7486328125],[44.64433593750002,42.734716796875],[44.771093750000006,42.616796875],[44.85048828125002,42.746826171875],[44.87099609375002,42.756396484374996],[44.943359375,42.730273437499996],[45.07158203125002,42.694140624999996],[45.20820312500001,42.648242187499996],[45.34375,42.52978515625],[45.56289062500002,42.5357421875],[45.7275390625,42.475048828125],[45.63427734375,42.234716796875],[45.63857421875002,42.205078125],[46.21269531250002,41.989892578124994],[46.30546875000002,41.507714843749994]]]},properties:{name:"Georgia",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[-.068603515625,11.115624999999994],[-.05771484374997726,10.630615234375],[.36269531250002274,10.236474609374994],[.26191406250001137,9.49560546875],[.5290039062500114,9.358300781249994],[.41533203125001705,8.652734374999994],[.6880859375000057,8.304248046874989],[.5835937500000057,8.145800781249989],[.634765625,7.353662109374994],[.5255859375000114,6.8509277343749915],[.7369140625000057,6.452587890624997],[1.1872070312500114,6.089404296874989],[.94970703125,5.810253906249997],[.25966796875002274,5.75732421875],[-.7977050781249773,5.226708984374994],[-1.6384765624999886,4.980859374999994],[-2.0018554687499943,4.762451171875],[-2.7230468749999943,5.013720703124989],[-2.815673828125,5.153027343749997],[-2.7549804687499773,5.432519531249994],[-2.9622558593749773,5.643017578124997],[-3.2005859374999943,6.3482421874999915],[-3.2271484374999773,6.7491210937499915],[-2.9590820312499773,7.454541015624997],[-2.789746093749983,7.931933593749989],[-2.6688476562499943,8.022216796875],[-2.6133789062499773,8.046679687499989],[-2.505859375,8.208740234375],[-2.705761718749983,9.351367187499989],[-2.6958496093749886,9.481347656249994],[-2.78662109375,10.401904296874989],[-2.9148925781249773,10.592333984374989],[-2.8299316406249773,10.998388671874991],[-.701416015625,10.988964843749997],[-.068603515625,11.115624999999994]]]},properties:{name:"Ghana",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[-11.389404296875,12.404394531249991],[-11.30517578125,12.015429687499989],[-10.933203124999977,12.205175781249991],[-10.677343749999977,11.8994140625],[-10.274853515624983,12.212646484375],[-9.820703124999994,12.04248046875],[-9.043066406249977,12.40234375],[-8.822021484375,11.673242187499994],[-8.407470703125,11.386279296874989],[-8.231494140624989,10.43798828125],[-8.007275390624983,10.321874999999991],[-7.974462890624977,10.229541015624989],[-7.990624999999994,10.162499999999994],[-8.136621093749994,10.022070312499991],[-8.155175781249994,9.973193359374989],[-8.145849609374977,9.881738281249994],[-8.136962890625,9.495703124999991],[-7.896191406249983,9.415869140624991],[-7.950976562499989,8.786816406249997],[-7.823583984374977,8.467675781249994],[-7.953125,8.477734374999997],[-8.236962890624994,8.455664062499991],[-8.256103515625,8.253710937499989],[-8.016748046874994,8.144921874999994],[-8.126855468749994,7.867724609374989],[-8.115429687499983,7.7607421875],[-8.205957031249994,7.590234374999994],[-8.231884765624983,7.5567382812499915],[-8.429980468749989,7.601855468749989],[-8.486425781249977,7.558496093749994],[-8.708300781249989,7.658886718749997],[-8.8896484375,7.2626953125],[-9.117578124999994,7.2159179687499915],[-9.459765624999989,7.442529296874994],[-9.368945312499989,7.639550781249994],[-9.518261718749983,8.346093749999994],[-9.768261718749983,8.534570312499994],[-10.283203125,8.485156249999989],[-10.677343749999977,8.400585937499997],[-10.500537109374989,8.687548828124989],[-10.758593749999989,9.385351562499991],[-11.047460937499977,9.786328124999997],[-11.115673828124983,9.843164062499994],[-11.180859374999983,9.925341796874989],[-11.205664062499977,9.977734374999997],[-11.273632812499983,9.996533203124997],[-11.911083984374983,9.993017578124991],[-12.142333984375,9.875390624999994],[-12.557861328125,9.704980468749994],[-12.958789062499989,9.263330078124994],[-12.998632812499977,9.146923828124997],[-13.028027343749983,9.103564453124989],[-13.077294921874994,9.069628906249989],[-13.1298828125,9.047558593749997],[-13.178369140624994,9.060888671874991],[-13.234228515624977,9.070117187499989],[-13.302636718749994,9.078369140625],[-13.269482421874983,9.170556640624994],[-13.568261718749994,9.543408203124997],[-13.700488281249989,9.851269531249997],[-14.426904296874994,10.248339843749989],[-14.775927734374989,10.931640625],[-15.043017578124989,10.940136718749997],[-14.9990234375,10.9921875],[-14.944433593749977,11.072167968749994],[-14.779296875,11.405517578125],[-14.720263671874989,11.48193359375],[-14.682958984374977,11.508496093749997],[-13.953222656249977,11.664599609374989],[-13.732763671874977,11.736035156249997],[-13.759765625,12.262353515624994],[-13.673535156249983,12.478515625],[-13.732617187499983,12.592822265624989],[-13.729248046875,12.673925781249991],[-13.40576171875,12.662255859374994],[-13.082910156249994,12.633544921875],[-12.291210937499983,12.328027343749994],[-11.389404296875,12.404394531249991]]]
},properties:{name:"Guinea",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[-16.763330078124994,13.064160156249997],[-16.824804687499977,13.341064453125],[-16.56230468749999,13.587304687499994],[-15.509667968749994,13.586230468750003],[-15.834277343749989,13.156445312499997],[-16.648779296874977,13.154150390624991],[-16.763330078124994,13.064160156249997]]]},properties:{name:"Gambia",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[-13.759765625,12.262353515624994],[-13.73276367187492,11.736035156249983],[-13.953222656249977,11.664599609374989],[-14.682958984374949,11.508496093749983],[-14.720263671875017,11.481933593749986],[-14.779296874999972,11.405517578125057],[-14.944433593749949,11.072167968749994],[-14.999023437499972,10.992187500000043],[-15.04301757812496,10.940136718750011],[-15.093749999999972,11.011035156249974],[-15.181054687499994,11.034228515625003],[-15.216699218749994,11.156249999999986],[-15.39311523437496,11.217236328124983],[-15.501904296875011,11.723779296874966],[-16.138427734375,11.917285156250045],[-16.43681640624996,12.204150390625045],[-16.711816406249937,12.354833984375006],[-16.656933593749955,12.364355468749991],[-16.52133789062495,12.348632812499986],[-16.41630859374996,12.367675781250057],[-16.144189453124937,12.457421875000037],[-15.839550781249955,12.437890624999966],[-15.57480468749992,12.490380859375009],[-15.19609374999996,12.679931640624986],[-14.34921874999992,12.67641601562498],[-14.064843749999966,12.675292968750014],[-13.729248046875,12.673925781250006],[-13.732617187499983,12.592822265625003],[-13.673535156249926,12.478515624999986],[-13.759765625,12.262353515624994]]]},properties:{name:"Guinea Bissau",childNum:1}},{geometry:{type:"MultiPolygon",coordinates:[[[[11.332324218750017,1.5283691406249886],[11.335351562500023,.9997070312500114],[10.028515625000068,1.0040039062500057],[9.385937500000068,1.13925781250002],[9.494238281250006,1.4353027343750284],[9.632128906250045,1.5655273437500057],[9.807031250000051,1.9274902343750284],[9.77968750000008,2.0682128906250057],[9.870117187500028,2.21328124999998],[9.979882812499994,2.1677734375000455],[10.790917968750023,2.1675781250000057],[11.096582031250051,2.167480468749986],[11.328710937500006,2.1674316406249687],[11.332324218750017,1.5283691406249886]]],[[[8.735742187500023,3.7583007812499716],[8.946093750000074,3.6275390624999773],[8.704003906250051,3.2236328125000284],[8.474902343749989,3.2646484375000426],[8.735742187500023,3.7583007812499716]]]]},properties:{name:"Equatorial Guinea",childNum:2}},{geometry:{type:"MultiPolygon",coordinates:[[[[23.852246093749983,35.53544921874999],[24.31289062500005,35.36381835937502],[24.721289062500034,35.4248046875],[25.475683593750063,35.30620117187502],[25.74501953125005,35.142724609374994],[24.79980468750003,34.93447265625002],[24.463671875000045,35.160351562499955],[23.561621093750034,35.29516601562497],[23.852246093749983,35.53544921874999]]],[[[23.41542968750008,38.958642578124994],[24.09902343750008,38.670996093750006],[23.758789062500057,38.401220703125034],[23.25214843750004,38.80122070312498],[23.41542968750008,38.958642578124994]]],[[[26.03896484375008,40.726757812499955],[25.10449218750003,40.994726562500006],[24.38378906250003,40.91274414062502],[23.87890625,40.54438476562501],[23.66455078125003,40.22382812499998],[23.31201171874997,40.216455078124994],[22.629492187500034,40.49555664062501],[22.59218750000005,40.03691406250002],[22.919042968750034,39.62890625000003],[22.96552734375001,39.030908203124966],[23.25292968750003,38.66123046875006],[23.96699218750001,38.27499999999998],[23.58046875000005,38.01054687500002],[23.193652343750017,37.95903320312499],[23.16152343750005,37.333837890625006],[22.765039062500023,37.39331054687503],[23.073535156250074,36.77495117187499],[22.6083984375,36.77973632812501],[22.08046875000008,37.028955078124966],[21.58291015625005,37.080957031249994],[21.5712890625,37.54101562500003],[21.14501953125003,37.91928710937498],[21.40371093750005,38.19667968750002],[21.82470703125003,38.32812500000006],[22.799609375000045,37.981201171875],[22.421679687500045,38.43852539062499],[21.47255859375005,38.321386718750006],[21.113183593750023,38.38466796875002],[20.779687500000023,39.00854492187503],[20.300781250000057,39.32709960937501],[20.099414062500074,39.641259765624966],[20.382421875000006,39.802636718749994],[20.4560546875,40.065576171874994],[20.881640625000017,40.467919921874994],[20.95576171875001,40.775292968749994],[21.575781250000034,40.86894531249996],[21.929492187500045,41.10742187499997],[21.99335937500001,41.13095703125006],[22.23769531250005,41.15517578125002],[22.49355468750005,41.118505859375006],[22.75507812500004,41.31274414062506],[22.91601562500003,41.33627929687506],[23.025585937500068,41.32563476562501],[23.155957031250068,41.32207031249999],[23.239843750000034,41.38496093750001],[23.372070312500057,41.3896484375],[23.433398437500017,41.39873046874999],[23.53583984375001,41.38603515624999],[23.63515625000008,41.386767578125045],[23.880859375000057,41.45595703125002],[23.973535156250023,41.452294921874966],[24.011328124999977,41.460058593750034],[24.03291015625004,41.469091796875034],[24.05605468750005,41.527246093749966],[24.595996093750074,41.44272460937498],[24.773730468750045,41.356103515624994],[24.84687500000004,41.394238281249955],[24.99355468750008,41.36499023437503],[25.133398437500063,41.31577148437506],[25.251171875000068,41.243554687499994],[25.381933593750063,41.264355468749955],[25.52705078125004,41.2998046875],[25.723925781250017,41.31503906249998],[25.784960937500017,41.330419921875006],[25.923339843750057,41.311914062499966],[26.155175781250023,41.43486328124999],[26.320898437500034,41.716552734375],[26.62490234375008,41.401757812499994],[26.03896484375008,40.726757812499955]]]]},properties:{name:"Greece",childNum:3}},{geometry:{type:"MultiPolygon",coordinates:[[[[-52.73115234375001,69.94472656250005],[-52.045312499999994,69.8072265625],[-52.11259765625002,69.48911132812503],[-53.57841796874996,69.25664062500002],[-53.78305664062498,69.50629882812498],[-54.804101562499994,69.63051757812497],[-54.83046875000002,70.16108398437498],[-53.37514648437502,70.22128906249998],[-52.73115234375001,69.94472656250005]]],[[[-25.43232421875001,70.92133789062495],[-25.402246093749994,70.65268554687503],[-27.89799804687496,70.45400390624997],[-27.70893554687501,70.897119140625],[-25.43232421875001,70.92133789062495]]],[[[-29.952880859375,83.56484374999997],[-25.947412109374966,83.28964843750003],[-24.47031249999995,82.87739257812498],[-21.520654296874966,82.59541015625001],[-25.148828124999966,82.001123046875],[-21.337988281249977,82.068701171875],[-21.14658203124995,81.695166015625],[-17.226220703125023,81.430419921875],[-15.555517578125006,81.83359374999998],[-12.19287109375,81.64912109374995],[-11.528808593749972,81.42402343750001],[-14.503564453124994,80.76328125000006],[-16.76059570312492,80.573388671875],[-16.868408203124943,80.19824218750006],[-19.429199218749943,80.25771484375],[-20.138476562499932,79.803369140625],[-19.283593749999937,79.68315429687502],[-19.07495117187497,79.15234375000006],[-20.955664062499977,78.55502929687503],[-20.862597656249932,77.91186523437503],[-20.23193359374997,77.36840820312497],[-18.339013671874966,77.21528320312504],[-18.51030273437496,76.77817382812498],[-20.942089843749955,76.88701171875005],[-21.877343749999966,76.57348632812503],[-21.56909179687497,76.29370117187506],[-20.10361328124992,76.21909179687503],[-19.508984374999926,75.75751953124995],[-19.425976562499983,75.22983398437503],[-20.484960937500006,75.31425781249999],[-19.22509765625,74.4794921875],[-19.36914062499997,74.28403320312498],[-21.129443359374932,74.11088867187505],[-20.36728515624992,73.8482421875],[-20.509667968749966,73.49287109375001],[-22.18505859374997,73.26987304687506],[-22.036328124999955,72.91845703125006],[-22.29321289062497,72.11953125],[-24.06904296875001,72.49873046874998],[-24.66684570312492,72.437353515625],[-22.013330078124966,71.688818359375],[-21.75224609374999,71.47832031250002],[-21.522656249999926,70.52622070312503],[-23.327832031249983,70.45097656250007],[-23.791796875000017,70.55517578124997],[-24.377001953124932,71.14638671875],[-25.74223632812499,71.18359375],[-26.717919921874994,70.95048828125005],[-27.68876953124999,70.99345703124999],[-28.540917968749937,70.476904296875],[-28.015039062500023,70.40224609375],[-26.747265624999926,70.47553710937501],[-23.173242187499937,70.114599609375],[-23.08823242187492,69.882958984375],[-26.34140624999992,68.70214843750003],[-29.24951171874997,68.29877929687501],[-29.86850585937495,68.31157226562505],[-30.97856445312499,68.06132812500005],[-32.13725585937496,68.38491210937497],[-32.274804687499994,67.92285156249997],[-33.15698242187497,67.62670898437506],[-34.101660156250034,66.72592773437503],[-34.63281249999997,66.43476562499995],[-36.37919921874996,65.830810546875],[-37.75419921874996,65.59306640624999],[-39.96093750000003,65.55620117187502],[-39.57792968749996,65.34077148437501],[-40.655468749999926,64.91533203125002],[-40.18222656249998,64.47993164062495],[-40.78173828125,64.22177734375003],[-40.550390625000034,63.72524414062505],[-42.15297851562502,62.568457031250006],[-42.32148437499998,62.15273437500005],[-42.110205078125006,61.857226562500074],[-42.41874999999999,61.53701171875002],[-42.717041015625,60.767480468749994],[-43.32011718749993,59.928124999999994],[-44.06547851562499,59.92480468750003],[-45.37924804687495,60.20292968750002],[-46.04663085937503,60.61572265625],[-46.01171875000003,61.09682617187505],[-46.87446289062501,60.81640625000003],[-47.79624023437495,60.828857421875],[-48.92207031249998,61.27744140624998],[-49.28906249999997,61.58994140625006],[-49.553466796875,62.23271484374999],[-50.319238281249966,62.473193359375045],[-50.338330078124955,62.82875976562502],[-51.46884765624995,63.64228515625001],[-51.451074218749994,63.90478515625003],[-52.09340820312502,64.41591796874997],[-52.259033203125,65.154931640625],[-53.634716796874955,66.413671875],[-53.038281249999955,66.82680664062497],[-53.88442382812502,67.13554687499999],[-53.418798828125034,67.57456054687498],[-53.577978515625034,67.83681640625005],[-53.03945312500002,68.61088867187499],[-51.24941406250002,68.73994140625001],[-50.50000000000003,69.935791015625],[-52.254638671875,70.05893554687503],[-54.01445312499996,70.42167968750005],[-54.16582031249999,70.82011718750005],[-52.405224609374955,70.68676757812506],[-51.52446289062502,70.43945312500003],[-51.130078124999955,70.97172851562502],[-53.117041015625006,71.31289062499997],[-53.476025390624955,71.64018554687505],[-54.689062500000006,71.36723632812505],[-55.59404296874999,71.55351562500005],[-55.315576171874994,72.11069335937498],[-55.60170898437494,72.453466796875],[-54.737939453124994,72.87250976562501],[-56.10405273437496,73.55815429687499],[-55.92949218750002,73.89541015625002],[-56.70634765625002,74.21918945312501],[-56.80131835937499,74.67167968749999],[-58.603466796874955,75.38530273437499],[-58.51621093749995,75.68906250000006],[-61.18823242187494,76.157861328125],[-63.438867187499994,76.33945312500003],[-66.82617187499997,75.96879882812502],[-69.372900390625,76.331884765625],[-69.25205078125,76.68613281250006],[-70.792822265625,76.86909179687504],[-70.86284179687496,77.175439453125],[-69.35136718749999,77.467138671875],[-72.81806640624995,78.1943359375],[-72.39560546874995,78.50434570312501],[-68.99345703124999,78.857421875],[-67.48222656249993,79.11689453125001],[-65.96787109374998,79.13237304687507],[-64.79228515624993,80.00063476562502],[-66.84365234374997,80.07622070312507],[-66.99589843749999,80.41298828125002],[-62.99326171874998,81.20698242187504],[-61.43598632812498,81.13359375000002],[-61.20292968750002,81.74687500000007],[-58.717382812500006,82.09306640624999],[-54.72587890624996,82.35136718750002],[-52.77558593749998,82.32172851562504],[-50.894433593749994,81.89521484375001],[-48.861181640625006,82.40541992187502],[-45.29106445312502,81.82880859374998],[-44.23886718749998,82.3681640625],[-46.47817382812502,82.95190429687497],[-43.19458007812503,83.25512695312503],[-32.98442382812499,83.59960937500006],[-29.952880859375,83.56484374999997]]]]},properties:{name:"Denmark",childNum:3}},{geometry:{type:"Polygon",coordinates:[[[-89.2328125,15.888671875],[-88.53623046874999,15.849609375],[-88.22832031249999,15.72900390625],[-88.97641601562499,15.142675781249991],[-89.142578125,15.072314453125003],[-89.22236328125,14.866064453124991],[-89.16220703124999,14.669238281250003],[-89.17177734375,14.606884765624997],[-89.28671874999999,14.529980468749997],[-89.36259765624999,14.416015625],[-89.872705078125,14.045605468749997],[-90.09521484375,13.736523437499997],[-90.60693359375,13.929003906250003],[-91.14604492187499,13.925585937500003],[-91.819091796875,14.228222656249997],[-92.23515624999999,14.54541015625],[-92.20903320312499,14.570996093749997],[-92.18706054687499,14.630078124999997],[-92.159912109375,14.691015624999991],[-92.17646484375,14.761328124999991],[-92.18637695312499,14.818359375],[-92.07480468749999,15.07421875],[-92.187158203125,15.320898437499991],[-92.08212890624999,15.495556640624997],[-91.9572265625,15.703222656249991],[-91.736572265625,16.07016601562499],[-91.433984375,16.070458984374994],[-90.97958984374999,16.07080078125],[-90.70322265624999,16.071044921875],[-90.52197265625,16.071191406249994],[-90.44716796875,16.072705078124997],[-90.45986328125,16.162353515625],[-90.450146484375,16.261376953124994],[-90.4169921875,16.351318359375],[-90.4169921875,16.391015624999994],[-90.710693359375,16.70810546874999],[-90.975830078125,16.867822265624994],[-90.98916015625,17.81640625],[-89.16147460937499,17.814843749999994],[-89.2328125,15.888671875]]]},properties:{name:"Guatemala",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[-57.194775390625,5.5484374999999915],[-57.331005859375,5.020166015624994],[-57.711083984374994,4.9910644531249915],[-58.05449218749999,4.171923828124989],[-57.832666015624994,3.675976562499997],[-57.54960937499999,3.3528320312499886],[-57.303662109375,3.3770996093749943],[-57.20981445312499,2.8828125],[-56.704345703125,2.0364746093749915],[-56.482812499999994,1.942138671875],[-56.96953124999999,1.9164062499999943],[-57.03759765625,1.9364746093749972],[-57.41269531249999,1.908935546875],[-57.500439453125,1.7738281249999943],[-57.59443359375,1.7041015625],[-57.69174804687499,1.7047851562499972],[-57.795654296875,1.6999999999999886],[-57.982812499999994,1.6484375],[-58.03466796875,1.520263671875],[-58.34067382812499,1.5875488281249943],[-58.38037109375,1.5302246093749972],[-58.39580078124999,1.4817382812499886],[-58.5060546875,1.4386718749999972],[-58.511865234374994,1.28466796875],[-58.8625,1.20361328125],[-58.91660156249999,1.2488769531249915],[-58.968505859375,1.3045898437499943],[-59.231201171875,1.3760253906249886],[-59.53569335937499,1.6999999999999886],[-59.596630859375,1.718017578125],[-59.66660156249999,1.7462890624999972],[-59.66850585937499,1.8423339843749886],[-59.74072265625,1.8741699218749943],[-59.75620117187499,1.900634765625],[-59.75522460937499,2.274121093749997],[-59.9943359375,2.6899902343749886],[-59.854394531249994,3.5874999999999915],[-59.55112304687499,3.933544921874997],[-59.69970703125,4.353515625],[-59.83334960937499,4.4759277343749915],[-60.11113281249999,4.511181640624997],[-60.1486328125,4.533251953124989],[-60.14091796874999,4.569628906249989],[-60.12456054687499,4.59765625],[-60.03178710937499,4.740527343749989],[-59.990673828125,5.0828613281249915],[-60.142041015625,5.238818359374989],[-60.241650390625,5.257958984374994],[-60.335205078125,5.1993164062499915],[-60.40878906249999,5.210156249999997],[-60.45952148437499,5.1880859374999915],[-60.576416015625,5.1924804687499915],[-60.6513671875,5.221142578124997],[-60.742138671875,5.202050781249994],[-61.37680664062499,5.906982421875],[-61.3908203125,5.938769531249989],[-61.303124999999994,6.049511718749997],[-61.22495117187499,6.129199218749989],[-61.15947265624999,6.1744140624999915],[-61.12871093749999,6.214306640624997],[-61.152294921875,6.3851074218749915],[-61.151025390624994,6.446533203125],[-61.20361328125,6.58837890625],[-61.14560546874999,6.694531249999997],[-60.717919921874994,6.768310546875],[-60.586083984374994,6.857080078124994],[-60.39501953125,6.945361328124989],[-60.35209960937499,7.002880859374997],[-60.32207031249999,7.092041015625],[-60.32548828124999,7.133984374999997],[-60.34506835937499,7.1499999999999915],[-60.39238281249999,7.16455078125],[-60.46494140624999,7.166552734374989],[-60.523193359375,7.143701171874994],[-60.71923828125,7.498681640624994],[-60.513623046875,7.813183593749997],[-60.032421875,8.053564453124991],[-59.99072265625,8.162011718749994],[-59.96484375,8.191601562499997],[-59.849072265625,8.248681640624994],[-59.83164062499999,8.305957031249989],[-60.017529296875,8.54931640625],[-59.980615234374994,8.532617187499994],[-59.83652343749999,8.373828124999989],[-59.66611328124999,8.362597656249989],[-59.20024414062499,8.074609374999994],[-58.626611328124994,7.5458984375],[-58.48056640624999,7.038134765624989],[-57.982568359374994,6.785888671875],[-57.19023437499999,6.097314453124994],[-57.194775390625,5.5484374999999915]]]},properties:{name:"Guyana",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[-83.635498046875,14.876416015624997],[-84.64594726562498,14.661083984375011],[-84.72978515625002,14.71337890625],[-84.78916015625003,14.790380859374977],[-84.98515624999999,14.752441406249972],[-85.17949218749996,14.343310546875017],[-85.28417968749997,14.29165039062498],[-85.37377929687503,14.223876953125028],[-85.47705078125003,14.108691406250003],[-85.68193359375002,13.98256835937498],[-85.731201171875,13.93183593750004],[-85.72773437499993,13.876074218750048],[-85.73393554687496,13.85869140625006],[-85.75341796875,13.852050781250028],[-85.78671874999995,13.844433593749997],[-85.98378906249997,13.965673828125006],[-86.04038085937503,14.050146484374977],[-86.15122070312495,13.994580078125026],[-86.23823242187501,13.899462890625017],[-86.33173828124995,13.770068359375031],[-86.37695312500003,13.755664062500031],[-86.61025390624997,13.774853515625026],[-86.73364257812494,13.763476562500017],[-86.75898437499995,13.746142578125045],[-86.77060546875003,13.698730468749972],[-86.72958984375,13.4072265625],[-86.710693359375,13.31337890624998],[-86.918212890625,13.223583984374983],[-86.92880859375,13.17939453125004],[-86.93315429687502,13.117529296874963],[-86.95888671875002,13.053710937500014],[-87.0591796875,12.991455078125028],[-87.337255859375,12.979248046875028],[-87.49838867187498,13.274902343750043],[-87.781884765625,13.521386718749994],[-87.71533203125003,13.812695312500011],[-87.99101562499996,13.879638671874972],[-88.15102539062497,13.987353515624974],[-88.44912109374994,13.850976562499994],[-88.48266601562503,13.854248046875043],[-88.49765624999998,13.904541015624986],[-88.50434570312501,13.964208984374963],[-88.51254882812498,13.97895507812504],[-89.05712890625,14.329150390624974],[-89.36259765624996,14.416015625],[-89.17177734375,14.606884765624983],[-89.16220703125,14.669238281249989],[-89.22236328125001,14.86606445312502],[-89.142578125,15.072314453125031],[-88.97641601562498,15.142675781249977],[-88.22832031249999,15.729003906249972],[-87.61816406249994,15.909863281249955],[-86.90722656249997,15.762353515625023],[-86.35664062499998,15.783203125],[-85.78398437500002,16.002832031249966],[-85.48369140624996,15.899511718749977],[-84.97373046874998,15.989892578124994],[-84.26142578124998,15.822607421875034],[-83.76044921874998,15.220361328124994],[-83.635498046875,14.876416015624997]]]},properties:{name:"Honduras",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[18.905371093750006,45.931738281250034],[19.055078125000023,45.527246093749966],[19.007128906250045,44.86918945312502],[18.66259765625,45.07744140624999],[17.812792968750074,45.07812500000006],[16.53066406250008,45.21669921875002],[16.29335937500005,45.00883789062496],[15.788085937500057,45.17895507812497],[15.736621093750045,44.76582031250001],[16.214257812500023,44.21513671874999],[17.624804687500074,43.04277343749999],[17.585156250000068,42.93837890625005],[16.903125000000017,43.392431640625006],[15.941503906250063,43.656640624999994],[15.122949218749994,44.256787109374955],[14.854589843750034,45.08100585937501],[14.38613281250008,45.342138671875006],[13.9658203125,44.83564453125004],[13.62929687500008,45.108203125000045],[13.878710937500017,45.428369140624994],[14.95458984375,45.499902343749994],[15.624804687500017,45.834033203125045],[15.652148437500074,45.86215820312498],[15.668066406250034,45.904443359374994],[15.666210937500011,46.04848632812502],[15.596875000000011,46.10922851562506],[15.592578125000017,46.139990234375006],[15.608984374999977,46.171923828125045],[15.635937500000068,46.200732421875045],[16.1064453125,46.382226562499994],[16.23671875000008,46.48383789062498],[16.32119140625005,46.53461914062504],[16.42763671875005,46.5244140625],[16.516210937499977,46.499902343749966],[16.569921875000006,46.48500976562505],[16.748046875000057,46.41640625000002],[17.310644531250006,45.99614257812502],[17.96386718750003,45.770263671875],[18.437304687500045,45.76733398437503],[18.533593750000023,45.79614257812503],[18.56464843750004,45.81328124999999],[18.666015625,45.90747070312497],[18.905371093750006,45.931738281250034]]]},properties:{name:"Croatia",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[-71.647216796875,19.195947265624994],[-71.74321289062502,18.73291015625],[-72.000390625,18.59790039062503],[-72.05986328124993,18.228564453125017],[-72.87666015624998,18.151757812499994],[-73.38515625000002,18.251171874999983],[-73.88496093749998,18.041894531249994],[-74.41904296874998,18.34619140625],[-74.22773437499998,18.662695312499977],[-72.78935546874996,18.434814453125],[-72.34765624999994,18.674951171874994],[-72.81108398437496,19.071582031250074],[-72.70322265625,19.441064453125023],[-73.05273437499997,19.61074218750005],[-73.1177734375,19.90380859374997],[-72.63701171875002,19.90087890625],[-71.75742187499998,19.68818359375001],[-71.647216796875,19.195947265624994]]]},properties:{name:"Haiti",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[22.1318359375,48.405322265624996],[22.253710937500017,48.407373046874994],[22.582421875000023,48.134033203125],[22.87666015625001,47.947265625],[22.290625000000006,47.727832031249996],[21.151953125000006,46.304345703124994],[20.613671875000023,46.13349609375],[20.508105468750017,46.166943359375],[20.28095703125001,46.1330078125],[20.241796875000006,46.10859375],[20.21015625000001,46.126025390624996],[20.161425781250017,46.141894531249996],[19.61347656250001,46.169189453125],[19.421289062500023,46.064453125],[18.666015625,45.907470703125],[18.56464843750001,45.813281249999996],[18.533593750000023,45.796142578125],[18.437304687500017,45.767333984375],[17.9638671875,45.770263671875],[17.310644531250006,45.996142578124996],[16.748046875,46.416406249999994],[16.569921875000006,46.485009765624994],[16.516210937500006,46.499902343749994],[16.093066406250017,46.86328125],[16.453417968750017,47.006787109375],[16.434375000000017,47.367431640625],[17.147363281250023,48.00595703125],[17.76191406250001,47.770166015624994],[18.724218750000006,47.787158203124996],[18.914160156250006,48.050830078124996],[19.89863281250001,48.13134765625],[20.490039062500017,48.526904296874996],[21.45136718750001,48.55224609375],[22.1318359375,48.405322265624996]]]},properties:{name:"Hungary",childNum:1}},{geometry:{type:"MultiPolygon",coordinates:[[[[120.01250000000002,-9.374707031250026],[120.50371093750002,-9.674023437499983],[120.83261718750006,-10.037499999999952],[120.4391601562501,-10.294042968749991],[120.14482421875002,-10.200097656249952],[119.60107421874997,-9.773535156250006],[119.08544921875003,-9.706933593750023],[119.18564453125006,-9.384472656249969],[120.01250000000002,-9.374707031250026]]],[[[125.06816406250002,-9.511914062499997],[124.42753906250002,-10.14863281250004],[123.85761718750004,-10.34355468749996],[123.5892578125,-9.966796875000028],[123.709375,-9.614843750000006],[124.0363281250001,-9.341601562500031],[124.44443359375012,-9.190332031250023],[124.92226562500005,-8.942480468749977],[125.06816406250002,-9.511914062499997]]],[[[116.64082031250004,-8.613867187500006],[116.37724609375002,-8.929003906249989],[116.07646484375002,-8.744921874999974],[116.06113281250006,-8.437402343750023],[116.4015625000001,-8.204199218750034],[116.73408203125004,-8.38691406250004],[116.64082031250004,-8.613867187500006]]],[[[122.7829101562501,-8.611718750000009],[121.65136718749997,-8.898730468749946],[121.03525390625012,-8.935449218749966],[119.80791015625002,-8.697656250000023],[119.91826171875002,-8.445117187500003],[120.61025390625005,-8.24042968750004],[121.44453125000004,-8.57783203125004],[121.96650390625004,-8.455175781250006],[122.2630859375,-8.624902343750037],[122.60351562499997,-8.402441406250006],[122.7829101562501,-8.611718750000009]]],[[[118.24238281250004,-8.317773437499994],[118.98779296875003,-8.33769531249996],[119.00625000000005,-8.749609375000034],[118.18994140624997,-8.840527343749997],[117.06132812500002,-9.099023437499994],[116.78847656250005,-9.006347656250028],[116.83505859375012,-8.532421875000026],[117.16484375000007,-8.367187500000014],[117.56708984375004,-8.426367187499991],[118.11748046875007,-8.12226562500004],[118.24238281250004,-8.317773437499994]]],[[[115.44785156250012,-8.155175781249994],[115.70429687500004,-8.40712890624998],[115.23613281250007,-8.79755859375004],[114.47529296875004,-8.119433593749989],[115.44785156250012,-8.155175781249994]]],[[[126.80097656250004,-7.6678710937500085],[126.4720703125,-7.950390625000011],[125.84316406250005,-7.81669921874996],[126.60957031250004,-7.571777343749972],[126.80097656250004,-7.6678710937500085]]],[[[138.53535156250004,-8.273632812499969],[138.2962890625,-8.405175781250037],[137.68515625000012,-8.262207031249943],[138.00751953125004,-7.641601562499986],[138.29550781250012,-7.4384765625],[138.76982421875002,-7.390429687499974],[138.98906250000002,-7.696093749999989],[138.53535156250004,-8.273632812499969]]],[[[131.3255859375,-7.999511718749986],[131.08681640625005,-7.865039062499946],[131.26005859375007,-7.470507812499946],[131.69111328125004,-7.438867187499994],[131.3255859375,-7.999511718749986]]],[[[113.84453125000007,-7.105371093749994],[113.47070312500003,-7.218457031250026],[112.76376953125006,-7.139648437499957],[112.86806640625,-6.899902343749972],[113.97470703125012,-6.873046875],[113.84453125000007,-7.105371093749994]]],[[[134.53681640625004,-6.442285156249994],[134.35595703124997,-6.814843749999952],[134.05917968750012,-6.769335937500017],[134.16806640625006,-6.176269531249986],[134.53681640625004,-6.442285156249994]]],[[[107.37392578125005,-6.007617187499989],[107.66679687500002,-6.215820312499957],[108.29501953125012,-6.265039062500037],[108.67783203125006,-6.790527343749972],[110.42626953124997,-6.947265625000028],[110.73691406250006,-6.472363281249997],[111.15439453125012,-6.669042968750006],[111.54033203125002,-6.648242187500031],[112.0873046875,-6.89335937499996],[112.53925781250004,-6.9264648437499545],[112.79453125000012,-7.55244140625004],[113.24843750000005,-7.718164062499952],[114.07070312500005,-7.633007812500011],[114.44423828125,-7.895605468749963],[114.38691406250004,-8.405175781250037],[114.58378906250002,-8.769628906250034],[113.25332031250005,-8.286718749999963],[112.67880859375006,-8.409179687499957],[111.50996093750004,-8.30507812499998],[110.60722656250002,-8.149414062499972],[110.03867187500006,-7.890527343749994],[109.28164062500005,-7.704882812500003],[108.74121093749997,-7.667089843750034],[108.45175781250006,-7.79697265625002],[107.91748046875003,-7.724121093750014],[107.28496093750007,-7.471679687500014],[106.63144531250006,-7.415527343750028],[106.51972656250004,-7.053710937499943],[105.48369140625007,-6.781542968750017],[105.86826171875006,-6.11640625000004],[106.07500000000002,-5.914160156249963],[106.82519531249997,-6.098242187499977],[107.0462890625,-5.90419921874998],[107.37392578125005,-6.007617187499989]]],[[[134.74697265625,-5.707031249999957],[134.75585937500003,-6.170605468749983],[134.44111328125004,-6.334863281249966],[134.34130859375003,-5.712890624999986],[134.74697265625,-5.707031249999957]]],[[[122.64511718750012,-5.26943359374998],[122.39628906250002,-5.069824218749986],[122.36894531250007,-4.767187499999977],[122.70195312500002,-4.61865234375],[122.64511718750012,-5.26943359374998]]],[[[126.86113281250007,-3.087890624999986],[127.22734375000007,-3.3910156250000085],[127.22958984375006,-3.6330078125000114],[126.68632812500007,-3.823632812500037],[126.21455078125004,-3.6051757812500256],[126.02646484375012,-3.17050781250002],[126.86113281250007,-3.087890624999986]]],[[[129.75468750000007,-2.865820312500034],[130.3791015625001,-2.9893554687499773],[130.85996093750006,-3.5703125000000284],[130.805078125,-3.85771484374996],[129.844140625,-3.3271484374999574],[129.46767578125005,-3.4532226562499773],[128.9674804687501,-3.3260742187500085],[128.41923828125002,-3.416015624999943],[128.08212890625012,-3.184082031249943],[128.19853515625002,-2.8659179687499687],[129.42734375000006,-2.7907226562500114],[129.75468750000007,-2.865820312500034]]],[[[108.2072265625001,-2.9976562499999773],[107.61445312500004,-3.209375000000037],[107.66630859375002,-2.566308593750037],[108.07441406250004,-2.5969726562499744],[108.2072265625001,-2.9976562499999773]]],[[[124.96953125000007,-1.70546874999998],[124.83447265624997,-1.8944335937500227],[124.41777343750002,-2.0051757812500313],[124.38085937499997,-1.6874999999999716],[124.96953125000007,-1.70546874999998]]],[[[135.47421875000006,-1.5917968750000142],[136.20156250000005,-1.6549804687499972],[136.19257812500004,-1.859179687499946],[135.47421875000006,-1.5917968750000142]]],[[[106.04570312500002,-1.6694335937500142],[106.36591796875004,-2.4648437499999716],[106.67880859375012,-2.7040039062500227],[106.54677734375005,-3.055566406249966],[105.99873046875004,-2.8249023437499545],[105.7858398437501,-2.18134765625004],[105.13339843750012,-2.0425781250000057],[105.58544921875003,-1.5267578124999943],[106.04570312500002,-1.6694335937500142]]],[[[128.1530273437501,-1.66054687499998],[127.56162109375012,-1.7285156249999716],[127.74296875000002,-1.3602539062499943],[128.1530273437501,-1.66054687499998]]],[[[99.16386718750007,-1.7779296875000057],[98.87431640625007,-1.6636718749999915],[98.60175781250004,-1.1978515624999488],[98.86904296875005,-.9156250000000057],[99.2672851562501,-1.6277343749999602],[99.16386718750007,-1.7779296875000057]]],[[[135.38300781250004,-.6513671875],[135.89355468749997,-.7257812499999687],[135.83876953125,-1.1194335937499602],[135.38300781250004,-.6513671875]]],[[[140.97343750000007,-2.6097656250000085],[140.97353515625,-2.8034179687500256],[140.97441406250002,-4.836328125000023],[140.97519531250006,-6.90537109375002],[140.97617187500012,-9.118750000000006],[139.93476562500004,-8.101171875000006],[139.38564453125,-8.189062499999963],[138.85615234375004,-8.145117187499991],[139.08798828125012,-7.587207031250017],[138.74794921875,-7.25146484375],[138.86455078125007,-6.858398437499943],[138.43867187500004,-6.343359375000006],[138.2521484375001,-5.688183593750026],[137.75908203125007,-5.256152343750017],[137.08925781250005,-4.924414062500034],[136.61884765625004,-4.818749999999994],[135.97968750000004,-4.530859374999963],[135.19560546875007,-4.450683593749972],[134.14707031250006,-3.79677734374998],[133.97382812500004,-3.817968750000034],[133.65312500000007,-3.3643554687499915],[133.24873046875004,-4.062304687499989],[132.96855468750007,-4.094921874999969],[132.75390625000003,-3.703613281250014],[132.75136718750005,-3.294628906249997],[132.34824218750006,-2.97509765625],[133.19101562500006,-2.43779296874996],[133.60869140625007,-2.54716796874996],[133.90488281250012,-2.390917968750003],[133.92158203125004,-2.1020507812499574],[132.96279296875005,-2.272558593749963],[132.30761718749997,-2.24228515625002],[132.02343749999997,-1.99033203125002],[131.93037109375004,-1.559667968750034],[131.29375000000002,-1.3934570312500085],[131.2572265625,-.8554687500000142],[131.80429687500006,-.7038085937500256],[132.12841796874997,-.45410156249995737],[132.62509765625006,-.3588867187500142],[133.47265624999997,-.726171874999963],[133.97451171875,-.7443359375000256],[134.25957031250007,-1.3629882812500256],[134.105859375,-1.720996093749946],[134.15566406250005,-2.1952148437500227],[135.03740234375002,-3.33310546875002],[135.48662109375002,-3.34511718749998],[136.24326171875006,-2.5831054687499915],[136.38994140625002,-2.273339843750037],[136.84326171875003,-2.19765624999998],[137.1234375,-1.840917968749963],[137.80625000000012,-1.4832031250000028],[138.6498046875,-1.79111328125002],[139.78955078125003,-2.34824218750002],[140.62255859374997,-2.44580078125],[140.97343750000007,-2.6097656250000085]]],[[[97.48154296875006,1.4650878906249716],[97.93193359375002,.9739257812500028],[97.87646484374997,.6283203125000227],[97.40537109375012,.9469726562500256],[97.24423828125006,1.4236328124999602],[97.48154296875006,1.4650878906249716]]],[[[124.88886718750004,.9953125000000114],[124.42753906250002,.47060546875005116],[123.75380859375,.3055175781249915],[123.26542968750007,.3266113281250256],[123.08251953125003,.48583984375004263],[121.8419921875001,.4365722656250455],[121.42578125000003,.49482421875001137],[120.34902343750005,.44921875000004263],[120.01328125000012,-.19619140624999432],[120.09746093750002,-.6499023437499716],[120.51757812499997,-1.0394531250000085],[120.66738281250005,-1.3701171874999716],[121.03369140624997,-1.406542968750017],[121.51933593750007,-.8555664062500341],[121.96962890625005,-.9333007812499687],[122.27998046875004,-.7570312500000256],[122.88876953125006,-.7551757812500028],[122.50664062500002,-1.3478515624999545],[121.71875000000003,-1.8627929687499716],[121.34882812500004,-1.9459960937499545],[121.84824218750012,-2.331542968749986],[122.39902343750006,-3.200878906249997],[122.25292968749997,-3.620410156250017],[122.87734375,-4.109082031250011],[122.89736328125005,-4.349121093749972],[122.20712890625012,-4.49638671874996],[121.91699218749997,-4.847949218749989],[121.48652343750004,-4.581054687499972],[121.61806640625,-4.092675781249952],[120.9142578125001,-3.5557617187499915],[121.05429687500012,-3.167089843749949],[121.0521484375,-2.7516601562499545],[120.65361328125002,-2.6675781249999773],[120.25410156250004,-3.052832031250034],[120.43662109375012,-3.70732421874996],[120.36250000000004,-4.08574218749996],[120.42011718750004,-4.617382812500011],[120.27929687499997,-5.146093749999977],[120.31162109375006,-5.541601562500006],[119.71728515625003,-5.693359375000014],[119.3761718750001,-5.424804687500014],[119.61171875,-4.42353515625004],[119.62363281250006,-4.034374999999983],[119.41982421875,-3.47539062499996],[118.99462890624997,-3.5375976562500284],[118.81249999999997,-3.1566406249999517],[118.78369140624997,-2.764746093749963],[119.09218750000005,-2.482910156250014],[119.32187500000012,-1.9296875000000142],[119.308984375,-1.408203125],[119.7716796875001,-.48359375000001137],[119.80927734375004,.23867187500005116],[120.26953125000003,.9708007812499915],[120.51660156249997,.8175292968750227],[120.91210937499997,1.288964843749966],[121.44003906250006,1.2144042968749744],[121.59179687499997,1.0679687499999773],[122.43662109375006,1.0180664062500284],[122.89248046875005,.8499999999999801],[123.27812500000002,.9280761718749915],[123.84667968750003,.8381835937499744],[124.27363281250004,1.0222656249999886],[124.98925781249997,1.7010253906249915],[125.2337890625,1.5022949218750057],[124.88886718750004,.9953125000000114]]],[[[127.73271484375007,.8481445312500426],[128.16074218750006,1.1578124999999915],[128.42412109375007,1.5175292968749972],[128.68837890625,1.572558593750017],[128.70263671874997,1.1063964843749972],[128.29882812500003,.8768066406250199],[128.69160156250004,.3603515624999716],[127.9831054687501,.4718750000000398],[127.88740234375004,.29833984375004263],[128.04638671875003,-.7060546874999432],[127.69160156250004,-.24189453124998295],[127.70869140625004,.2880859374999858],[127.5553710937501,.48964843750002274],[127.4203125,1.2519531249999858],[127.63173828125,1.8437011718750114],[128.0109375000001,1.7012207031250313],[128.01171874999997,1.331738281249983],[127.65283203124997,1.0138671874999687],[127.73271484375007,.8481445312500426]]],[[[96.46367187500002,2.360009765625037],[95.80859374999997,2.655615234375034],[95.80625000000012,2.9160156249999716],[96.41728515625007,2.5151855468750313],[96.46367187500002,2.360009765625037]]],[[[117.5744140625001,4.17060546875004],[117.62988281250003,3.6363281249999915],[117.16640625,3.5919921875000256],[117.61064453125002,3.0643554687499943],[118.0666015625001,2.3178222656249687],[117.8646484375,1.9684082031250085],[118.08037109375007,1.701855468749983],[118.98496093750006,.982128906249983],[118.53476562500006,.813525390625017],[118.19609375000002,.8743652343749773],[117.74511718749997,.7296386718749801],[117.52216796875004,.23588867187501705],[117.46289062500003,-.32373046874995737],[117.56249999999997,-.7708984375000085],[116.55449218750007,-1.4739257812499744],[116.42353515625004,-2.0525390624999886],[116.56542968749997,-2.2997070312499943],[116.33066406250012,-2.9021484374999744],[115.95615234375012,-3.595019531250003],[114.6935546875001,-4.169726562500017],[114.53613281249997,-3.4944335937500313],[114.0822265625001,-3.2789062499999915],[113.79580078125,-3.4562499999999687],[113.52597656250006,-3.184082031249943],[112.97148437500002,-3.187109375000034],[112.60029296875004,-3.4004882812499773],[112.28496093750002,-3.32099609375004],[111.82207031250007,-3.5325195312499744],[111.82304687500007,-3.057226562499949],[111.367578125,-2.9336914062500057],[111.04433593750005,-3.0557617187500057],[110.57402343750007,-2.891406250000003],[110.2326171875001,-2.9250976562500313],[110.01923828125004,-1.3988281249999517],[109.78740234375007,-1.011328124999963],[109.45380859375004,-.868749999999963],[109.160546875,-.49492187500001705],[109.2575195312501,.03115234375005116],[108.94453125000004,.35566406249999716],[108.90585937500006,.7939453125000142],[109.07587890625004,1.4958984375000313],[109.37851562500006,1.922705078125034],[109.62890625000003,2.027539062499983],[109.65400390625004,1.6148925781250227],[110.50576171875005,.8619628906250227],[110.93808593750006,1.0173339843750568],[111.76972656250004,.9994628906249687],[112.078515625,1.1433593749999744],[112.1857421875001,1.4390624999999915],[112.47617187500006,1.5590820312500284],[113.6222656250001,1.2359375000000057],[113.90234375000003,1.4342773437499972],[114.54589843750003,1.467138671875034],[114.83056640625003,1.9800292968749886],[114.78642578125002,2.250488281250014],[115.1791015625,2.5231933593749716],[115.086328125,2.8411132812499886],[115.45439453125002,3.0343261718750085],[115.56845703125006,3.9387695312499744],[115.89619140625004,4.348681640624989],[117.10058593750003,4.337060546875023],[117.5744140625001,4.17060546875004]]],[[[96.49257812500005,5.2293457031249915],[97.54716796875002,5.205859375000003],[98.2484375,4.41455078125],[98.3073242187501,4.09287109375002],[99.73232421875005,3.1830566406250256],[100.45703124999997,2.2574218750000057],[100.68525390625004,2.120068359374997],[101.04619140625002,2.2574707031250227],[101.47666015625006,1.693066406250054],[101.78476562500012,1.621386718750017],[102.15722656249997,1.2588867187499773],[102.46923828124997,.7792968750000568],[102.84941406250002,.7154785156250227],[103.06650390625012,.4919921874999602],[103.47890625000005,.4801757812500398],[103.78671875000012,.046972656249991473],[103.42851562500007,-.1917968749999801],[103.43115234374997,-.5335937499999801],[103.72109375,-.8867187499999858],[104.36054687500004,-1.0383789062499744],[104.56875,-1.9217773437499943],[104.84521484375003,-2.0929687499999687],[104.66845703124997,-2.3855468749999744],[105.39697265624997,-2.380175781249946],[105.58203124999997,-2.4919921874999886],[106.0443359375,-3.1062499999999886],[105.84374999999997,-3.61367187499998],[105.88720703124997,-5.009570312499974],[105.81611328125004,-5.67656249999996],[105.6185546875,-5.799609374999989],[105.34941406250007,-5.549511718750011],[105.08134765625002,-5.74550781249998],[104.63955078125005,-5.520410156250037],[104.60156249999997,-5.90458984374996],[103.8314453125,-5.079589843750028],[102.91894531249997,-4.470703124999972],[102.53769531250006,-4.152148437499989],[102.12753906250006,-3.599218749999963],[101.57861328124997,-3.166992187500014],[100.848046875,-2.143945312499966],[100.85527343750002,-1.9341796874999488],[100.48652343750004,-1.2991210937499744],[100.30820312500006,-.82666015625],[99.59765624999997,.10244140625000853],[99.15917968749997,.35175781249999716],[98.79638671874997,1.4946289062500426],[98.56425781250002,1.902148437500017],[97.70078125000006,2.3585449218750085],[97.59082031249997,2.846582031250037],[97.3913085937501,2.9752929687499687],[96.9689453125001,3.5751464843749687],[96.44472656250005,3.81630859374998],[95.49472656250006,4.761376953125051],[95.20664062500006,5.284033203125034],[95.39609375000012,5.628808593750023],[95.84130859374997,5.514501953125006],[96.13330078125003,5.2942871093749915],[96.49257812500005,5.2293457031249915]]]]
},properties:{name:"Indonesia",childNum:30}},{geometry:{type:"Polygon",coordinates:[[[78.71972656250009,31.887646484374983],[78.69345703125006,31.740380859374994],[78.7550781250001,31.55029296875],[78.74355468750005,31.323779296875017],[79.10712890625004,31.402636718750102],[79.66425781250004,30.965234374999994],[79.92451171875004,30.888769531250034],[80.20712890625006,30.683740234375023],[80.19121093750002,30.56840820312496],[80.87353515625003,30.290576171875045],[80.98544921875006,30.23710937499999],[80.54902343750015,29.899804687499994],[80.40185546875003,29.730273437500102],[80.31689453125014,29.572070312500017],[80.25488281250009,29.423339843750114],[80.25595703125006,29.318017578125136],[80.23300781250006,29.194628906250045],[80.16953125000012,29.124316406250102],[80.13046875000006,29.100390625000045],[80.08457031249995,28.994189453125074],[80.05166015625,28.870312500000068],[80.07070312500005,28.830175781250063],[80.58701171875006,28.64960937500004],[81.85263671875018,27.867089843750136],[81.89687500000011,27.87446289062504],[81.94521484375005,27.89926757812495],[81.98769531250016,27.91376953125004],[82.03701171875,27.90058593750004],[82.11191406250006,27.86494140625004],[82.28769531250018,27.756542968749983],[82.45136718750004,27.671826171874955],[82.62988281249997,27.687060546875045],[82.67734375000006,27.67343749999995],[82.71083984375005,27.596679687500114],[82.73339843750003,27.518994140625097],[83.28974609375004,27.370996093750136],[84.09101562499993,27.491357421875136],[84.22978515625007,27.427832031250006],[84.48085937500005,27.348193359375102],[84.61015625000002,27.298681640624977],[84.64072265625012,27.249853515624977],[84.65478515625014,27.20366210937499],[84.68535156250013,27.041015625000057],[85.29296875000009,26.741015625000045],[86.36611328125,26.57441406250004],[86.70136718750015,26.435058593750057],[87.01640625000002,26.555419921875085],[87.2874023437499,26.360302734375125],[87.41357421875014,26.42294921875009],[87.63339843750006,26.39912109375004],[87.84921875000006,26.43691406250008],[87.99511718750014,26.38237304687499],[88.02695312500023,26.395019531250085],[88.05488281250004,26.43002929687492],[88.11152343750004,26.58642578125],[88.1615234375,26.724804687500125],[88.15722656250009,26.807324218750068],[88.1110351562501,26.928466796875057],[87.99316406250009,27.086083984374994],[87.98437499999997,27.133935546874994],[88.02412109375015,27.40888671875004],[88.14697265625014,27.749218750000097],[88.10898437499995,27.93300781250005],[88.57792968750002,28.093359375000034],[88.80371093750003,28.006933593750034],[88.74902343749997,27.521875000000136],[88.7648437500001,27.429882812500068],[88.83251953125003,27.362841796875074],[88.89140625000002,27.316064453125136],[88.88164062500007,27.29746093750009],[88.76035156250006,27.21811523437509],[88.73876953125009,27.175585937499932],[88.85761718750015,26.961474609375017],[89.14824218750002,26.816162109375085],[89.33212890625018,26.848632812500114],[89.60917968750013,26.762207031250114],[89.60996093750012,26.719433593750097],[89.71093750000009,26.713916015625045],[89.76386718750004,26.701562499999994],[89.94316406250013,26.723925781249932],[90.12294921875011,26.754589843749983],[90.20605468749997,26.847509765625063],[90.34589843750004,26.890332031250097],[90.73964843750005,26.771679687500068],[91.67158203124993,26.80200195312503],[91.84208984375013,26.852978515625125],[91.94375000000005,26.860839843750114],[91.99833984375013,26.85498046875],[92.04970703125016,26.87485351562495],[92.07343750000015,26.914843750000102],[91.99228515625018,27.09990234374999],[92.0833984375,27.29062499999992],[92.04492187499997,27.364697265625097],[91.99082031249995,27.450195312500114],[91.59472656250009,27.55766601562499],[91.63193359375012,27.759960937499983],[92.41484375000002,27.824609374999994],[92.65253906250004,28.093359375000034],[92.70185546875004,28.147119140624994],[93.36054687500004,28.654052734375057],[93.76074218750003,28.729785156250017],[94.01328125000006,28.90751953124999],[94.46806640625007,29.216210937499994],[94.99882812500002,29.14916992187503],[95.27910156250002,29.04956054687497],[95.42021484375007,29.054296875000063],[95.49375000000012,29.137011718750045],[95.51582031250015,29.20634765624996],[95.71035156250011,29.313818359375006],[95.88505859375007,29.390917968750074],[96.03535156250015,29.447167968749994],[96.07958984375009,29.424121093750074],[96.12851562500012,29.381396484375074],[96.23496093750006,29.245800781249983],[96.18085937500004,29.11767578125],[96.14140625000007,28.963476562500034],[96.58085937500007,28.763671875],[96.32988281250002,28.496826171875],[96.3890625,28.36791992187503],[96.65283203125003,28.44975585937499],[97.07539062500004,28.368945312500045],[97.14511718750012,28.340332031250085],[97.28945312500005,28.23681640624997],[97.32246093750015,28.21796875000004],[97.30273437499997,28.08598632812496],[97.34355468750002,27.982324218749994],[97.04970703125005,27.760009765625],[96.96279296875,27.698291015625017],[96.79785156249997,27.29619140624999],[96.19082031250005,27.26127929687499],[95.20146484375007,26.641406250000017],[95.05976562500015,26.473974609375006],[95.06894531250006,26.191113281250097],[95.10839843750014,26.091406250000034],[95.12929687500011,26.070410156250034],[95.13242187500006,26.041259765624943],[94.99199218750002,25.77045898437504],[94.66777343750007,25.458886718749966],[94.70371093750012,25.097851562499955],[94.49316406250003,24.637646484374983],[94.37724609375002,24.473730468750006],[94.07480468750006,23.8720703125],[93.68339843750007,24.00654296875004],[93.45214843750003,23.987402343750034],[93.32626953125006,24.064208984375057],[93.41494140625011,23.68208007812501],[93.36601562500007,23.132519531249955],[93.34941406250007,23.08496093750003],[93.20390625000002,23.03701171875005],[93.07871093750018,22.718212890625097],[93.16201171875,22.360205078125006],[93.07060546875002,22.20942382812501],[92.77138671875,22.104785156250017],[92.5612304687501,22.04804687500001],[92.49140625000004,22.685400390625006],[92.46445312500006,22.734423828125045],[92.36162109375002,22.929003906250074],[92.33378906250002,23.242382812499955],[92.04404296875006,23.677783203125017],[91.97851562500003,23.691992187500063],[91.92958984375011,23.685986328125097],[91.92949218750019,23.598242187499977],[91.93789062500011,23.504687500000102],[91.75419921875013,23.28730468750004],[91.75097656250003,23.053515625000017],[91.43623046875004,23.19990234375001],[91.35937500000003,23.06835937500003],[91.16044921875019,23.660644531250085],[91.35019531250012,24.06049804687501],[91.72656250000003,24.20507812499997],[92.06416015625004,24.374365234375006],[92.11748046875002,24.493945312500017],[92.22666015625012,24.77099609374997],[92.38496093750004,24.848779296875023],[92.04970703125016,25.16948242187499],[90.61308593750002,25.16772460937497],[90.11962890625003,25.21997070312497],[89.86630859375012,25.293164062499955],[89.81406250000006,25.305371093749955],[89.80087890625012,25.33613281250001],[89.82490234375004,25.560156250000006],[89.82294921875015,25.94140625000003],[89.57275390625003,26.13232421875003],[89.10830078125005,26.202246093750063],[89.01865234375012,26.410253906249977],[88.95195312500002,26.412109375],[88.97041015625004,26.250878906250023],[88.94072265625002,26.24536132812497],[88.68281250000004,26.291699218749983],[88.68066406250009,26.35297851562504],[88.51826171875004,26.51777343750004],[88.41816406250015,26.57153320312497],[88.36992187500002,26.56411132812508],[88.35146484375005,26.482568359374966],[88.38623046875003,26.471533203125034],[88.44042968749997,26.369482421875034],[88.33398437499997,26.257519531249955],[88.1066406250001,25.841113281250045],[88.14746093749997,25.811425781250023],[88.76914062500006,25.490478515625],[88.85478515625002,25.333544921875017],[88.94414062500002,25.290771484375],[88.92978515625012,25.222998046875063],[88.57382812500006,25.187890624999994],[88.31337890625011,24.8818359375],[88.14980468750011,24.91464843749995],[88.04511718750015,24.71303710937508],[88.03027343750009,24.664453125000136],[88.02343750000003,24.627832031250136],[88.07910156250009,24.549902343750063],[88.14550781250003,24.485791015624955],[88.22500000000005,24.460644531249983],[88.33750000000006,24.45385742187503],[88.49853515625003,24.34663085937504],[88.64228515625015,24.325976562500102],[88.72353515625011,24.27490234375],[88.7335937500001,24.230908203125097],[88.72656250000009,24.18623046875004],[88.71376953125016,24.069628906250102],[88.69980468750006,24.00253906249992],[88.56738281250009,23.674414062500034],[88.69765625,23.493017578125034],[88.72441406250002,23.254980468750034],[88.89970703125002,22.843505859375057],[88.92070312500002,22.632031249999955],[89.0500000000001,22.274609374999983],[89.05166015625,21.654101562500045],[88.25371093750002,21.622314453124943],[87.94843749999993,21.825439453124943],[87.10068359375006,21.500781250000074],[86.85957031250004,21.23671875000008],[86.97548828125005,20.70014648437501],[86.75039062500011,20.313232421875057],[86.27949218750021,19.919433593749943],[85.57500000000002,19.69291992187499],[84.77099609375009,19.125390625000023],[84.10410156250018,18.29267578125001],[83.65429687499997,18.069873046875102],[83.19833984375006,17.608984374999977],[82.35957031250004,17.09619140624997],[82.25878906250014,16.55986328124996],[81.76191406250015,16.32949218750008],[81.23857421875013,16.263964843750074],[80.97871093750004,15.758349609375074],[80.64658203125006,15.895019531250028],[80.29345703125014,15.710742187499989],[80.0534179687501,15.074023437499932],[80.16542968750016,14.577832031250097],[80.11171875000005,14.212207031250045],[80.34238281250006,13.361328125000071],[80.22910156250018,12.690332031249966],[79.85849609375018,11.988769531250043],[79.75410156250004,11.575292968750006],[79.84863281250009,11.196875000000006],[79.83818359375002,10.322558593750045],[79.39052734375005,10.305957031250045],[78.99628906249993,9.683105468749986],[78.97958984375018,9.268554687500085],[78.42148437500006,9.105029296874989],[78.19248046874995,8.890869140625057],[78.06015625000006,8.384570312499932],[77.51757812500003,8.078320312500068],[76.96689453125012,8.407275390624946],[76.5534179687501,8.902783203124997],[76.32460937500016,9.452099609374997],[76.34648437500002,9.922119140625],[75.92255859375015,10.784082031250108],[75.72382812500015,11.361767578125026],[75.1966796875,12.057519531250009],[74.77050781250009,13.077343750000125],[74.67089843749997,13.667626953125122],[74.38222656250005,14.494726562500048],[73.94921875000014,15.074755859375088],[73.93193359375013,15.39697265625],[73.47607421875003,16.05424804687496],[73.33759765625004,16.459863281249994],[73.15605468750019,17.62192382812495],[72.87089843750019,18.683056640624955],[72.66777343750019,19.83095703125005],[72.88115234375013,20.56318359375001],[72.81386718750011,21.117187500000085],[72.54306640625,21.69658203124999],[72.59013671875019,22.27812499999999],[72.33261718750012,22.270214843749955],[72.03720703125006,21.82304687499999],[72.25400390625006,21.531005859375],[72.01523437500012,21.155712890625097],[71.0246093750001,20.73886718750009],[70.71933593750006,20.740429687500068],[70.12734375,21.094677734375097],[69.00878906250009,22.196777343750114],[70.17724609375014,22.57275390624997],[70.2511718750001,22.970898437500068],[69.66464843750006,22.759082031250074],[69.23593749999995,22.848535156250023],[68.64072265625006,23.189941406250114],[68.16503906250009,23.857324218749994],[68.28251953125013,23.927978515625],[68.38125000000016,23.950878906250068],[68.48867187500011,23.96723632812501],[68.5866210937501,23.966601562500074],[68.72412109375003,23.964697265625034],[68.72812500000012,24.265625000000057],[68.73964843750016,24.291992187500085],[68.75898437499993,24.307226562500006],[68.78115234375011,24.313720703125085],[68.80000000000004,24.30908203125003],[68.82832031250004,24.26401367187509],[68.86347656250015,24.26650390625005],[68.90078125000011,24.29243164062501],[68.98457031250015,24.273095703124966],[69.11953125000011,24.26865234374995],[69.23505859374993,24.268261718750068],[69.44345703124995,24.275390625000085],[69.55917968750006,24.273095703124966],[69.63417968750016,24.225195312499977],[69.71621093750016,24.172607421875114],[70.54677734375,24.418310546875063],[70.71630859375009,24.237988281250097],[70.7672851562501,24.245410156250017],[70.80507812500011,24.26196289062503],[70.88623046875014,24.34374999999997],[70.92812500000016,24.362353515625045],[70.98281250000011,24.361035156250125],[71.04404296875006,24.400097656250097],[71.04531250000005,24.42998046874996],[71.00625,24.444335937500057],[70.97324218750012,24.48740234374995],[70.97636718750013,24.618750000000063],[71.00234375000016,24.65390624999992],[71.04785156250003,24.687744140625085],[71.02070312500021,24.75766601562492],[70.95087890625015,24.89160156250003],[70.87773437500019,25.06298828124997],[70.65205078125004,25.422900390625102],[70.10019531250006,25.91005859375005],[70.14921875000002,26.347558593749994],[70.05937500000002,26.578759765625023],[69.47001953125002,26.804443359375],[69.56796875,27.174609375000102],[69.89628906250007,27.473632812500085],[70.04980468750009,27.694726562500023],[70.14453125000003,27.849023437499994],[70.19394531250006,27.89487304687492],[70.24433593750004,27.934130859375102],[70.4037109375,28.025048828124994],[70.48857421875013,28.023144531250125],[70.62910156250015,27.937451171875068],[70.64912109375015,27.83535156250005],[70.73740234374995,27.729003906250057],[70.79794921875012,27.709619140625023],[70.87490234375016,27.71445312499995],[71.54296875000003,27.869873046875],[71.71669921875005,27.91508789062496],[71.8703125000001,27.962500000000034],[71.88886718750004,28.04746093749992],[71.94804687500002,28.177294921875102],[72.34189453125006,28.751904296875097],[72.90332031250003,29.02875976562501],[73.38164062500013,29.934374999999932],[73.46748046875004,29.971679687500085],[73.8091796875,30.093359375000006],[73.89931640625,30.435351562500045],[74.00898437500004,30.519677734374994],[74.21562500000013,30.768994140624983],[74.33935546875003,30.893554687499943],[74.38037109375003,30.89340820312509],[74.50976562500009,30.959667968750097],[74.63281250000014,31.034667968750114],[74.62578125000002,31.068750000000108],[74.61035156250009,31.112841796875045],[74.51767578125012,31.185595703124932],[74.53496093750007,31.261376953125108],[74.59394531249993,31.465380859375102],[74.58183593750013,31.523925781250114],[74.50996093750015,31.712939453125074],[74.73945312500015,31.948828125000006],[75.07148437500015,32.08935546875003],[75.13876953125,32.10478515624999],[75.25410156250004,32.140332031250125],[75.33349609374997,32.279199218749994],[74.98730468749997,32.46220703124996],[74.78886718750013,32.45781249999996],[74.6857421875001,32.493798828124994],[74.65781250000006,32.518945312499966],[74.66328125000004,32.75766601562495],[74.35458984375012,32.76870117187505],[74.30361328125005,32.991796875000034],[73.99423828125006,33.24218750000006],[74.15,33.506982421874994],[73.96123046875007,34.653466796874994],[74.05585937500015,34.68066406250003],[74.17197265624995,34.72089843750004],[74.30039062500006,34.76538085937506],[75.70917968750004,34.50307617187508],[76.04101562500014,34.66992187499997],[76.4567382812501,34.756103515625114],[76.5944335937501,34.73583984375006],[76.69628906249997,34.78691406249999],[76.74902343750014,34.84755859375008],[76.7829101562501,34.90019531249999],[77.00087890625011,34.99199218750002],[77.04863281250007,35.109912109375074],[77.79941406250006,35.49589843750002],[78.07578125000006,35.13491210937502],[78.15849609375002,34.94648437499998],[78.32695312500007,34.60639648437498],[78.86484375000006,34.39033203125001],[78.93642578125,34.35195312500002],[78.72666015625006,34.013378906249955],[78.78378906250006,33.80878906250004],[78.86503906250002,33.43110351562501],[78.94843750000004,33.346533203125006],[79.11250000000004,33.22626953125001],[79.13515625000005,33.17192382812496],[79.10283203125007,33.05253906249996],[79.14550781250003,33.00146484375006],[79.16992187500003,32.497216796874994],[78.75351562500012,32.49926757812506],[78.73671875,32.55839843750002],[78.38964843749997,32.51987304687498],[78.41748046874997,32.466699218749994],[78.4552734375001,32.30034179687502],[78.49589843750002,32.21577148437504],[78.71972656250009,31.887646484374983]]]},properties:{name:"India",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[-6.218017578125,54.08872070312506],[-6.027392578124989,52.927099609375006],[-6.561083984374989,52.18881835937498],[-7.527294921874926,52.09887695312503],[-8.813427734374926,51.584912109374955],[-10.37871093749996,51.86875000000006],[-9.955810546874972,52.13666992187501],[-9.299218749999966,53.09755859375002],[-9.795410156249972,53.39497070312504],[-9.995947265624977,54.27602539062502],[-8.623144531249977,54.34687499999998],[-8.763916015624972,54.68120117187496],[-8.274609374999955,55.146289062500045],[-7.246679687499949,55.35302734374997],[-7.2186523437499375,55.09199218749998],[-8.118261718749977,54.41425781250004],[-7.3551757812499545,54.12124023437502],[-6.218017578125,54.08872070312506]]]},properties:{name:"Ireland",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[46.1144531250001,38.877783203125034],[46.490624999999994,38.90668945312498],[47.772851562499994,39.64858398437505],[47.995898437500074,39.683935546875034],[48.24199218750002,38.978955078124955],[48.02324218750002,38.81904296874998],[48.59267578125005,38.41108398437498],[48.86875000000006,38.43549804687498],[49.08095703125005,37.667578125000034],[49.470117187499994,37.496679687500034],[50.130468750000006,37.407128906249994],[50.53320312499997,37.01367187500006],[51.11855468750005,36.742578124999966],[52.19013671875004,36.62172851562505],[54.017187500000006,36.952490234375034],[53.91416015625006,37.34355468750002],[54.745214843750006,37.501904296874955],[55.075585937499994,37.90249023437502],[55.57841796875002,38.099755859374994],[56.22880859375002,38.07338867187502],[56.4406250000001,38.249414062499994],[57.1935546875001,38.216406250000034],[57.42382812500003,37.94770507812501],[58.4357421875001,37.63852539062498],[58.81542968750003,37.683496093749994],[59.240820312500006,37.52075195312497],[59.5622070312501,37.178906249999955],[60.06279296875002,36.962890625],[60.34130859375003,36.63764648437501],[61.11962890625003,36.64257812500003],[61.26201171875002,35.61958007812498],[61.08007812499997,34.85561523437505],[60.95117187499997,34.65385742187499],[60.91474609375004,34.63398437500001],[60.80234375000006,34.55463867187501],[60.7262695312501,34.51826171874998],[60.48574218750005,34.09477539062502],[60.485937500000006,33.7119140625],[60.91699218749997,33.505224609375006],[60.56054687499997,33.13784179687502],[60.576562499999994,32.99487304687503],[60.71044921874997,32.599999999999966],[60.82929687500004,32.24941406250005],[60.854101562500006,31.483251953125006],[61.110742187499994,31.45112304687504],[61.346484375000074,31.42163085937497],[61.66015625000003,31.382421874999977],[61.7550781250001,31.285302734374994],[61.814257812500074,31.072558593750017],[61.810839843750074,30.913281249999983],[61.78417968749997,30.831933593750023],[61.55947265625005,30.59936523437497],[61.10410156250006,30.12841796875003],[60.84335937500006,29.85869140624999],[61.03417968750003,29.663427734374977],[61.15214843750002,29.542724609375],[61.62304687500003,28.791601562500006],[61.8898437500001,28.546533203124994],[62.762500000000074,28.202050781249994],[62.782324218750006,27.800537109375],[62.75273437500002,27.265625],[63.16679687500002,27.25249023437499],[63.168066406250006,26.66557617187496],[62.31230468750002,26.490869140624994],[61.8698242187501,26.242431640625],[61.66865234375004,25.76899414062501],[61.61542968750004,25.28613281250003],[61.58789062499997,25.20234375000001],[61.533105468749994,25.195507812499955],[61.41220703125006,25.102099609375017],[60.66386718750002,25.28222656250003],[59.45605468749997,25.481494140625045],[59.0460937500001,25.417285156250017],[58.79785156249997,25.554589843750023],[57.7960937500001,25.65302734375001],[57.334570312500006,25.791552734375074],[56.98222656250002,26.905468749999983],[56.3561523437501,27.20024414062499],[55.650292968749994,26.9775390625],[54.89580078125002,26.55668945312499],[53.70576171875004,26.72558593750003],[53.45498046875005,26.94326171875005],[52.69160156250004,27.323388671875023],[52.475878906250074,27.61650390624999],[51.666308593750074,27.84497070312497],[51.278906250000006,28.13134765624997],[51.06201171874997,28.72612304687499],[50.67519531250005,29.146582031250034],[50.64960937500004,29.420068359374966],[49.9831054687501,30.209375000000023],[49.55488281250004,30.028955078125023],[48.91914062500004,30.120898437500017],[48.54648437500006,29.962353515624955],[48.47851562499997,30.003808593749966],[48.43457031249997,30.03759765625],[48.40136718749997,30.188330078124977],[48.33105468749997,30.28544921874996],[48.01494140625002,30.46562499999999],[48.01347656250002,30.656445312499955],[48.012011718750074,30.823632812500023],[48.01064453125005,30.989794921875017],[47.679492187500074,31.00239257812501],[47.679492187500074,31.400585937499955],[47.75390624999997,31.601367187500017],[47.829980468749994,31.79443359375],[47.71455078125004,31.936425781249966],[47.5915039062501,32.087988281250034],[47.51191406250004,32.15083007812504],[47.3712890625001,32.42373046875002],[47.3297851562501,32.45551757812501],[47.28515625000003,32.474023437499966],[47.121386718750074,32.46660156249996],[46.569921875000006,32.83393554687501],[46.37705078125006,32.92924804687499],[45.39707031250006,33.970849609374994],[45.43759765625006,34.415136718750006],[45.63750000000002,34.573828125000006],[45.661523437499994,34.61269531250002],[45.660058593749994,34.74877929687503],[45.67812500000005,34.798437500000034],[45.92089843750003,35.02851562500001],[46.04179687500002,35.08017578125006],[46.13378906249997,35.127636718749955],[46.15468750000005,35.19672851562498],[46.112109375000074,35.32167968750005],[45.97109375000005,35.524169921875],[46.03740234375002,35.67314453124999],[46.180957031250074,35.71137695312504],[46.262500000000074,35.74414062500006],[46.27343749999997,35.77324218750002],[46.16748046874997,35.820556640625],[45.72343750000002,35.83666992187497],[45.36162109375002,36.015332031249955],[45.241113281249994,36.35595703125],[45.20654296874997,36.397167968749955],[45.15527343749997,36.407373046874994],[45.11240234375006,36.409277343750034],[45.03105468750002,36.52607421875001],[44.76513671875003,37.142431640625006],[44.56123046875004,37.74462890625003],[44.211328124999994,37.908056640625006],[44.43085937500004,38.356787109375034],[44.02324218750002,39.37744140625006],[44.81718750000002,39.65043945312496],[45.4796875000001,39.006249999999994],[46.1144531250001,38.877783203125034]]]},properties:{name:"Iran",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[47.14824218750002,30.0009765625],[46.905859375000006,29.537499999999994],[46.53144531250001,29.096240234374996],[46.3564453125,29.063671874999997],[44.69082031250002,29.202343749999997],[42.85771484375002,30.49521484375],[42.07441406250001,31.080371093749996],[40.36933593750001,31.93896484375],[40.02783203125,31.995019531249994],[39.7041015625,32.042529296874996],[39.14541015625002,32.12451171875],[38.773535156250006,33.372216796874994],[40.689453125,34.33203125],[40.98701171875001,34.429052734375],[41.19472656250002,34.768994140625],[41.354101562500006,35.640429687499996],[41.24560546875,36.073388671874994],[41.41679687500002,36.5146484375],[41.78857421875,36.59716796875],[42.358984375000006,37.10859375],[42.77460937500001,37.371874999999996],[43.51582031250001,37.244531249999994],[43.83642578125,37.223535156249994],[44.01318359375,37.313525390624996],[44.11445312500001,37.30185546875],[44.15625,37.282958984375],[44.19179687500002,37.249853515625],[44.20839843750002,37.20263671875],[44.20166015625,37.051806640624996],[44.281835937500006,36.97802734375],[44.32558593750002,37.0107421875],[44.401953125000006,37.058496093749994],[44.49599609375002,37.110546875],[44.566015625000006,37.158251953124996],[44.60595703125,37.176025390625],[44.66933593750002,37.173583984375],[44.73095703125,37.165283203125],[44.798437500000006,37.063867187499994],[44.880859375,36.79931640625],[45.03105468750002,36.52607421875],[45.112402343750006,36.40927734375],[45.1552734375,36.407373046874994],[45.20654296875,36.39716796875],[45.24111328125002,36.35595703125],[45.36162109375002,36.01533203125],[45.72343750000002,35.836669921875],[46.16748046875,35.820556640625],[46.2734375,35.773242187499996],[46.26250000000002,35.744140625],[46.18095703125002,35.711376953125],[46.03740234375002,35.673144531249996],[45.97109375000002,35.524169921875],[46.11210937500002,35.321679687499994],[46.15468750000002,35.196728515625],[46.1337890625,35.12763671875],[46.04179687500002,35.08017578125],[45.9208984375,35.028515625],[45.67812500000002,34.7984375],[45.437597656250006,34.41513671875],[45.397070312500006,33.970849609374994],[46.377050781250006,32.929248046874996],[46.569921875000006,32.833935546875],[47.12138671875002,32.466601562499996],[47.28515625,32.474023437499994],[47.32978515625001,32.455517578125],[47.37128906250001,32.423730468749994],[47.51191406250001,32.150830078125],[47.59150390625001,32.08798828125],[47.71455078125001,31.936425781249994],[47.82998046875002,31.79443359375],[47.75390625,31.601367187499996],[47.67949218750002,31.400585937499997],[47.67949218750002,31.002392578124997],[48.01064453125002,30.989794921874996],[48.01201171875002,30.823632812499994],[48.01347656250002,30.656445312499997],[48.01494140625002,30.465624999999996],[48.3310546875,30.285449218749996],[48.4013671875,30.188330078125],[48.4345703125,30.03759765625],[48.546484375000006,29.962353515624997],[48.454199218750006,29.9384765625],[48.141699218750006,30.040917968749994],[48.07275390625,30.043212890625],[47.982519531250006,30.011328125],[47.97871093750001,29.982812499999994],[47.67275390625002,30.095605468749994],[47.14824218750002,30.0009765625]]]},properties:{name:"Iraq",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[-15.543115234374994,66.228515625],[-14.740429687499983,66.050830078125],[-14.757519531249983,65.7556640625],[-13.616015624999989,65.487158203125],[-13.569677734374977,65.068115234375],[-14.547070312499983,64.445947265625],[-16.060449218749994,64.11123046875],[-16.640332031249983,63.865478515625],[-17.81572265624999,63.71298828125],[-18.65361328124999,63.406689453125],[-20.198144531249994,63.555810546874994],[-21.832763671875,64.205419921875],[-21.950341796874994,64.514990234375],[-22.683984374999994,65.0263671875],[-22.005761718749994,65.49345703125],[-22.902490234374994,65.58046875],[-24.223974609374977,65.48720703125],[-23.527929687499977,66.164404296875],[-22.426123046874977,66.430126953125],[-21.303466796875,65.87646484375],[-21.22998046875,65.42060546875],[-20.356640624999983,65.71904296875],[-20.356591796874994,66.033251953125],[-18.777539062499983,66.168798828125],[-16.748437499999994,66.131640625],[-15.985400390624989,66.5146484375],[-15.543115234374994,66.228515625]]]},properties:{name:"Iceland",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[35.78730468750001,32.734912109374996],[35.572851562500006,32.640869140625],[35.56904296875001,32.619873046875],[35.55146484375001,32.3955078125],[35.484375,32.401660156249996],[35.40263671875002,32.450634765625],[35.38671875,32.493017578125],[35.303808593750006,32.512939453125],[35.19326171875002,32.534423828125],[35.065039062500006,32.46044921875],[35.01054687500002,32.338183593749996],[34.95595703125002,32.160937499999996],[34.98974609375,31.913281249999997],[34.880468750000006,31.3681640625],[35.45058593750002,31.479296874999996],[35.43925781250002,31.132421875],[35.17402343750001,30.52392578125],[34.97343750000002,29.555029296875],[34.904296875,29.477343749999996],[34.24531250000001,31.208300781249996],[34.52558593750001,31.525634765625],[35.10859375000001,33.08369140625],[35.411230468750006,33.07568359375],[35.869140625,33.43173828125],[35.78730468750001,32.734912109374996]]]},properties:{name:"Israel",childNum:1}},{geometry:{type:"MultiPolygon",coordinates:[[[[15.576562500000051,38.220312500000034],[15.099511718750023,37.458593750000006],[15.294531250000063,37.01328125000006],[15.112597656250017,36.687841796875006],[14.501855468750023,36.798681640625034],[12.435546874999972,37.819775390624955],[13.351660156250006,38.180517578125006],[13.68154296875008,38.00073242187497],[14.505957031250063,38.045507812500034],[14.84589843750004,38.17167968749999],[15.576562500000051,38.220312500000034]]],[[[9.632031250000011,40.88203124999998],[9.805273437500063,40.499560546875045],[9.562500000000057,39.16601562500006],[9.056347656250068,39.23916015625002],[8.881347656250028,38.91289062499999],[8.418164062500068,39.205712890624966],[8.471289062500063,40.29267578124998],[8.189941406250028,40.651611328125],[9.283007812500045,41.20166015624997],[9.632031250000011,40.88203124999998]]],[[[13.420996093750006,46.212304687499994],[13.663476562500023,45.7919921875],[13.831152343750006,45.680419921875],[13.206347656250074,45.771386718749966],[12.27431640625008,45.44604492187503],[12.523437500000028,44.96796874999998],[12.248339843750045,44.72250976562498],[12.396289062500074,44.223876953125],[13.56416015625004,43.57128906250003],[14.010449218750011,42.68955078125006],[14.86611328125008,42.05253906249996],[15.168750000000017,41.93403320312498],[15.96406250000004,41.939453125],[16.01259765625005,41.435400390625006],[17.10341796875008,41.062158203124994],[17.954980468749994,40.65517578125002],[18.485839843750057,40.104833984375006],[18.077929687500017,39.93696289062498],[17.865039062500074,40.28017578125002],[16.92822265625,40.45805664062502],[16.52998046875004,39.85966796874996],[16.597753906249977,39.63891601562503],[17.114550781250017,39.38061523437497],[17.174609375000017,38.998095703125045],[16.55898437500008,38.714794921874955],[16.54560546875001,38.40908203125002],[16.05683593750001,37.941845703124955],[15.72451171875008,37.93911132812502],[15.97236328125004,38.712597656249955],[16.19677734375,38.759228515624955],[16.02363281250001,39.35361328124998],[15.692773437499994,39.99018554687501],[14.95087890625004,40.23901367187497],[14.765722656250063,40.66840820312498],[14.102343749999989,40.82714843749997],[13.733398437500057,41.23564453124999],[13.088671875000074,41.243847656249955],[12.630859374999972,41.469677734374955],[11.637304687500063,42.287548828124955],[10.708398437500023,42.93632812499999],[10.047656250000045,44.01997070312504],[8.76582031250004,44.42231445312501],[8.081640625000006,43.91894531250006],[7.4931640625,43.767138671875045],[7.651464843750034,44.03364257812498],[6.96728515625,44.280029296875],[7.030664062500023,44.71669921875005],[6.627734375000017,45.11796874999999],[7.153417968749977,45.40092773437499],[7.021093750000034,45.92578124999997],[7.327929687500017,45.912353515625],[7.787890625000017,45.92182617187498],[7.9931640625,46.01591796874996],[8.081542968750057,46.25600585937502],[8.818554687500011,46.0771484375],[8.826757812500006,46.06103515625],[9.203417968750017,46.21923828125],[9.939257812500074,46.36181640625],[10.041015625000028,46.23808593750002],[10.14521484375004,46.25351562500006],[10.038281250000011,46.483203125000045],[10.061230468750068,46.54677734375002],[10.087011718750063,46.59990234375002],[10.137500000000045,46.614355468750034],[10.195507812500068,46.62109374999997],[10.272265625000074,46.564843749999966],[10.363085937500017,46.54707031249998],[10.4306640625,46.55004882812497],[10.438281250000045,46.618847656249955],[10.39794921875,46.66503906250006],[10.406054687500045,46.73486328124997],[10.452832031249983,46.86494140625001],[10.47939453125008,46.85512695312505],[10.579785156250011,46.85371093750001],[10.689257812500017,46.846386718749955],[10.759765625,46.79331054687498],[10.828906250000045,46.775244140625034],[10.927343750000034,46.76948242187501],[10.993261718750034,46.77700195312502],[11.02509765625004,46.796972656250006],[11.775683593750017,46.986083984375],[12.388281250000034,46.70263671874997],[13.168750000000045,46.572656249999966],[13.3515625,46.55791015624999],[13.490039062500045,46.55556640625002],[13.700000000000017,46.52026367187503],[13.679687500000057,46.46289062499997],[13.420996093750006,46.212304687499994]]]]
},properties:{name:"Italy",childNum:3}},{geometry:{type:"Polygon",coordinates:[[[-77.261474609375,18.457421874999994],[-76.349853515625,18.15185546875],[-76.524609375,17.8662109375],[-76.85322265625,17.97373046874999],[-77.36142578124999,17.833691406249997],[-77.76816406249999,17.877392578124997],[-78.21669921875,18.44809570312499],[-77.8734375,18.522216796875],[-77.261474609375,18.457421874999994]]]},properties:{name:"Jamaica",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[39.14541015625002,32.12451171875],[38.9970703125,32.007470703124994],[38.96230468750002,31.994921874999996],[37.77382812500002,31.696337890624996],[37.49335937500001,31.625878906249994],[37.21562500000002,31.556103515624997],[36.958593750000006,31.491503906249996],[37.980078125000006,30.5],[37.862890625000006,30.442626953125],[37.66972656250002,30.34814453125],[37.64990234375,30.330957031249994],[37.63359375000002,30.313281249999996],[37.55361328125002,30.144580078124996],[37.49072265625,30.01171875],[37.46923828125,29.995068359374997],[36.75527343750002,29.866015624999996],[36.70390625000002,29.831640625],[36.591796875,29.66611328125],[36.47607421875,29.4951171875],[36.282812500000006,29.355371093749994],[36.068457031250006,29.200537109375],[36.01542968750002,29.190478515624996],[34.950781250000006,29.353515625],[34.97343750000002,29.555029296875],[35.17402343750001,30.52392578125],[35.43925781250002,31.132421875],[35.45058593750002,31.479296874999996],[35.49941406250002,31.67236328125],[35.55898437500002,31.765527343749994],[35.55146484375001,32.3955078125],[35.56904296875001,32.619873046875],[35.572851562500006,32.640869140625],[35.78730468750001,32.734912109374996],[36.3720703125,32.3869140625],[36.818359375,32.317285156249994],[38.773535156250006,33.372216796874994],[39.14541015625002,32.12451171875]]]},properties:{name:"Jordan",childNum:1}},{geometry:{type:"MultiPolygon",coordinates:[[[[131.17460937500007,33.602587890625045],[131.58300781249997,33.65239257812496],[131.89658203125006,33.25458984375001],[131.97666015625012,32.84394531250001],[131.73212890625004,32.59282226562502],[131.33720703125007,31.404687499999994],[130.58876953125,31.178515625000017],[130.20068359374997,31.291894531250023],[130.3219726562501,31.601464843750023],[130.19443359375012,32.090771484374955],[130.64052734375005,32.61923828124998],[129.58007812500003,33.23627929687501],[130.36503906250007,33.634472656249955],[130.4837890625,33.834619140624966],[130.95312499999997,33.87202148437504],[131.17460937500007,33.602587890625045]]],[[[134.35742187500003,34.25634765625],[134.63750000000007,34.22661132812499],[134.73886718750012,33.82050781250001],[134.37705078125012,33.60839843749997],[134.18164062500003,33.24721679687502],[133.63203125000004,33.51098632812503],[133.28593750000007,33.35996093749998],[132.97724609375004,32.84199218749998],[132.49511718749997,32.91660156249998],[132.36591796875004,33.51245117187506],[132.78427734375006,33.99243164062506],[133.58203124999997,34.01713867187502],[134.07587890625004,34.3583984375],[134.35742187500003,34.25634765625]]],[[[141.22929687500007,41.372656250000006],[141.46279296875005,40.61113281250002],[141.7970703125001,40.29116210937502],[141.97783203125007,39.84443359374998],[141.90078125,39.111328125],[141.65859375000005,38.974853515625],[141.4674804687501,38.404150390625006],[141.10839843750003,38.33793945312502],[140.92792968750004,37.94960937500002],[141.0363281250001,37.46723632812498],[140.96835937500012,37.002050781250006],[140.62734375,36.50278320312498],[140.62197265625005,36.05922851562502],[140.87402343749997,35.72495117187506],[140.457421875,35.51025390625],[140.41650390625003,35.26699218750002],[139.79921875000005,34.956933593749994],[139.65000000000012,35.40913085937501],[139.24941406250005,35.27802734375004],[138.98261718750004,34.698388671874994],[138.57714843750003,35.08647460937502],[138.18906250000012,34.596337890624994],[136.88457031250002,34.80585937500004],[136.53300781250007,34.678369140624994],[136.8537109375001,34.324072265625034],[136.32988281250007,34.17685546875006],[135.91621093750004,33.561718749999955],[135.4528320312501,33.55336914062505],[135.17539062500006,33.898046875000006],[135.10009765624997,34.288378906250045],[135.38476562499997,34.50043945312498],[134.74003906250007,34.765234375000006],[134.20830078125002,34.69765625000002],[133.96826171874997,34.52729492187504],[133.14238281250002,34.30244140624998],[132.23808593750002,34.227001953124955],[132.090234375,33.85546875000003],[131.74052734375007,34.05205078125002],[130.91884765625,33.97573242187502],[131.00419921875007,34.39257812500003],[131.35439453125,34.41318359375006],[132.92294921875006,35.511279296875045],[133.37646484375003,35.458837890625006],[134.21406250000004,35.539257812499955],[135.17431640625003,35.74707031250003],[135.68027343750006,35.50312499999998],[136.09531250000006,35.767626953125045],[136.00625000000005,35.99057617187498],[136.69814453125005,36.742041015625034],[137.34257812500002,36.770361328125034],[137.5140625,36.95156250000002],[138.31992187500012,37.21840820312502],[138.88505859375007,37.84394531250001],[139.40097656250006,38.142578125],[140.04814453125002,39.463720703125034],[139.90800781250002,40.02172851562503],[139.92285156250003,40.59843750000002],[140.28125000000003,40.84609375000002],[141.1185546875,40.88227539062501],[141.22929687500007,41.372656250000006]]],[[[143.82431640625012,44.11699218749999],[144.79853515625004,43.940234375000045],[145.10107421874997,43.76455078125005],[145.34746093750007,43.17670898437501],[144.63076171875,42.946923828124994],[143.96933593750006,42.88139648437499],[143.42949218750002,42.41889648437498],[143.2365234375001,42.000195312499955],[141.85136718750007,42.57905273437501],[140.98613281250002,42.34213867187498],[140.70976562500002,42.555615234374955],[140.31523437500002,42.33427734374999],[140.65986328125004,41.815576171874994],[140.3849609375001,41.51928710937503],[139.99531250000004,41.57641601562503],[140.10839843749997,41.912939453125034],[139.82089843750012,42.387597656249994],[139.89111328125003,42.64921875000002],[140.78066406250005,43.214990234374994],[141.29628906250005,43.19965820312498],[141.64472656250004,44.01943359375002],[141.78222656249997,44.71635742187496],[141.58300781250003,45.15595703125001],[141.93769531250004,45.509521484375],[142.70410156249997,44.81918945312506],[143.82431640625012,44.11699218749999]]]]},properties:{name:"Japan",childNum:4}},{geometry:{type:"Polygon",coordinates:[[[77.04863281249999,35.109912109374996],[76.76689453124999,35.66171875],[77.44648437500001,35.4755859375],[77.04863281249999,35.109912109374996]]]},properties:{name:"Kashmir",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[87.32285156250012,49.085791015625006],[86.75312500000004,49.00883789062496],[86.54941406250012,48.52861328125002],[85.7494140625,48.38505859374999],[85.52597656250006,47.915625000000006],[85.65664062500005,47.254638671875],[84.78613281249997,46.83071289062505],[83.19306640625004,47.18657226562499],[83.0041015625001,47.03349609374996],[82.32666015625003,45.519921874999994],[82.4787109375001,45.12358398437499],[81.60205078125003,45.31083984375002],[80.05917968750012,45.006445312500006],[80.45546875,44.74609375],[80.35527343750002,44.09726562500006],[80.78574218750006,43.16157226562504],[80.16503906249997,42.66552734375006],[80.20937500000005,42.190039062500006],[80.07128906249997,42.302978515625],[79.92109375000004,42.41313476562496],[79.49013671875,42.45756835937496],[79.20302734375005,42.66601562499997],[79.16484375000007,42.759033203125],[78.52421875000002,42.86464843750002],[77.23554687500004,42.912646484375045],[77.05732421875004,42.970654296874955],[76.50917968750005,42.91889648437498],[75.9322265625,42.92851562499999],[75.84033203125003,42.93750000000003],[75.78955078124997,42.93291015624999],[75.68173828125,42.830468749999994],[75.04765625000007,42.904394531250034],[74.20908203125006,43.24038085937502],[73.88603515625002,43.132568359375],[73.55625,43.002783203125006],[73.42187499999997,42.59350585937503],[73.2829101562501,42.50410156250004],[72.85507812500006,42.561132812500006],[72.75292968750003,42.63789062500001],[72.54316406250004,42.67773437500006],[72.27578125,42.757666015625006],[72.16181640625004,42.76069335937498],[71.816796875,42.822167968749994],[71.76054687500002,42.82148437500004],[71.734765625,42.818896484375045],[71.5142578125,42.766943359375006],[71.42207031250004,42.78315429687504],[71.25664062500002,42.733544921874966],[71.02275390625007,42.53544921875002],[70.89287109375007,42.339990234374994],[70.94677734374997,42.24868164062505],[70.41601562500003,42.07856445312501],[70.09560546875,41.82050781250004],[69.06494140625003,41.366943359375],[68.29189453125,40.656103515625034],[67.9357421875001,41.19658203125002],[66.81425781250002,41.14238281249999],[66.66865234375004,41.27075195312503],[66.49863281250006,41.99487304687503],[66.00957031250007,42.00488281250003],[66.1002929687501,42.99082031249998],[65.80302734375002,42.87695312500006],[65.49619140625,43.310546875],[64.9054687500001,43.714697265625006],[64.44316406250007,43.551171874999994],[63.20703125000003,43.62797851562502],[61.99023437500003,43.492138671874955],[61.16074218750006,44.16860351562502],[61.007910156250006,44.39379882812497],[58.555273437500006,45.55537109375001],[55.97568359375006,44.99492187499996],[55.9767578125001,42.69951171874996],[55.97744140625005,41.32221679687504],[55.54521484375002,41.26274414062499],[54.90371093750005,41.91909179687505],[54.120996093749994,42.335205078125],[53.25009765625006,42.20585937500002],[52.4938476562501,41.780371093750034],[52.59658203125005,42.760156249999966],[51.84414062500005,42.910449218750045],[51.30175781249997,43.48237304687501],[50.8307617187501,44.192773437499966],[50.331152343750006,44.32548828125002],[50.409472656250074,44.6240234375],[50.86035156250003,44.62875976562498],[51.4157226562501,45.35786132812501],[52.53105468750002,45.39863281249998],[52.773828124999994,45.57275390625],[53.13525390625003,46.19165039062497],[53.17021484375002,46.66904296875006],[52.91601562500003,46.95439453125002],[52.18876953125002,46.839501953124966],[51.178027343750074,47.110156250000045],[50.41933593750005,46.879492187500034],[49.99980468750002,46.63427734375],[49.347460937500074,46.51914062499998],[49.232226562500074,46.33715820312503],[48.610156250000074,46.566455078125045],[48.95937500000005,46.77460937499998],[48.109960937500006,47.74541015624996],[47.09326171875003,47.947705078124955],[47.004296874999994,48.28447265625002],[46.660937500000074,48.41225585937502],[46.70263671875003,48.80556640625002],[47.014257812500006,49.09833984374998],[46.80205078125002,49.36708984375002],[47.32646484375002,50.273535156250034],[47.7057617187501,50.37797851562502],[48.43427734375004,49.828515624999966],[48.84326171875003,50.01313476562501],[48.80839843750002,50.60131835937503],[49.49804687500003,51.08359375000006],[50.246875000000074,51.28950195312498],[50.79394531249997,51.729199218749955],[51.60908203125004,51.483984375000006],[52.33105468749997,51.681298828124966],[52.57119140625005,51.481640624999955],[53.33808593750004,51.48237304687504],[54.04150390624997,51.11518554687501],[54.42148437500006,50.78032226562499],[54.72714843750006,50.998095703125045],[55.54228515625002,50.60180664062506],[55.79765625000002,50.60205078125],[56.49140625000004,51.01953124999997],[57.01171874999997,51.06518554687503],[57.44218750000002,50.88886718749998],[57.83886718750003,51.091650390625006],[58.359179687500074,51.063818359375034],[58.88369140625005,50.694433593750006],[59.812402343749994,50.58203125],[59.95517578125006,50.79926757812504],[60.637988281250074,50.66372070312505],[61.38945312500002,50.86103515625001],[61.585058593750006,51.22968749999998],[61.363085937500074,51.44189453125003],[60.464746093749994,51.651171875000045],[60.06552734375006,51.976464843749966],[60.937597656250006,52.28056640625002],[60.80234375000006,52.74472656249998],[61.047460937500006,52.97246093750002],[61.97421875000006,52.94375000000002],[62.01464843750003,53.10786132812498],[61.19921874999997,53.28715820312502],[60.97949218749997,53.62172851562505],[61.33369140625004,54.04926757812501],[61.92871093750003,53.94648437500004],[63.0739257812501,54.10522460937506],[64.46123046875002,54.38417968750002],[65.1578125,54.364404296874994],[65.476953125,54.62329101562497],[66.22265624999997,54.667382812499994],[68.07382812500006,54.959570312500006],[68.20625000000004,55.16093750000002],[68.9772460937501,55.389599609374955],[70.18242187500002,55.162451171875034],[70.73808593750007,55.30517578125],[71.18554687500003,54.59931640624998],[71.09316406250005,54.21220703124999],[72.91406249999997,54.10732421875002],[73.39941406250003,53.81147460937498],[73.28574218750006,53.598388671875],[74.45195312500007,53.64726562500002],[76.26660156249997,54.31196289062498],[76.57568359374997,53.94252929687502],[77.70439453125007,53.379150390625],[78.47548828125005,52.638427734375],[79.46884765625012,51.49311523437498],[79.98623046875,50.774560546874966],[80.87734375,51.28144531250004],[81.46591796875006,50.739843750000006],[82.49394531250007,50.72758789062499],[83.35732421875005,50.99458007812504],[83.94511718750007,50.774658203125],[84.25781249999997,50.28823242187502],[84.9894531250001,50.061425781249994],[85.21015625000004,49.66484375000002],[86.1808593750001,49.49931640624996],[86.61425781249997,49.60971679687498],[87.32285156250012,49.085791015625006]]]},properties:{name:"Kazakhstan",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[35.325292968750006,5.364892578124994],[35.745019531249994,5.343994140625],[35.80029296874997,5.156933593749983],[35.77929687499997,5.105566406250006],[35.756152343750074,4.950488281250031],[35.76308593750005,4.808007812500051],[35.9787109375001,4.50380859374998],[36.02197265625003,4.4681152343749915],[36.081933593749994,4.449707031249972],[36.90556640625002,4.4114746093749915],[37.15458984375002,4.254541015624994],[37.944921875000006,3.7467285156250227],[38.0861328125001,3.648828124999966],[38.22529296875004,3.61899414062502],[38.45156250000005,3.6048339843749773],[38.608007812500006,3.600097656249986],[39.49443359375002,3.45610351562496],[39.65751953125002,3.577832031249983],[39.79033203125002,3.754248046875034],[39.842187499999994,3.851464843750037],[40.765234375000006,4.273046875000034],[41.02080078125002,4.0574707031249915],[41.22089843750004,3.9435546874999687],[41.372460937499994,3.94619140624998],[41.48193359375003,3.9632812499999943],[41.737695312499994,3.979052734375003],[41.88398437500004,3.9777343750000114],[41.6134765625001,3.59047851562498],[41.34179687499997,3.20166015625],[40.964453125000006,2.8146484375000256],[40.97001953125002,1.3781738281250284],[40.9787109375001,-.8703125000000114],[41.249804687500074,-1.220507812499946],[41.4269531250001,-1.4495117187499744],[41.521874999999994,-1.5722656250000284],[41.38691406250004,-1.8669921875000313],[40.99550781250005,-1.9505859375000085],[40.64414062500006,-2.53945312499998],[40.22246093750002,-2.688378906250037],[40.1154296875001,-3.2505859374999915],[39.49091796875004,-4.478417968750023],[39.221777343750006,-4.692382812500014],[37.79726562500005,-3.6744140625000057],[37.608691406250074,-3.4602539062499886],[37.643847656250074,-3.0454101562500284],[35.83691406249997,-2.036621093749943],[33.979394531249994,-1.002050781250034],[33.90322265625005,-1.002050781250034],[33.94316406250002,.17377929687496874],[34.160937500000074,.6051757812500256],[34.4108398437501,.8672851562500341],[34.48173828125002,1.0421386718750512],[34.535253906250006,1.1015624999999858],[34.64912109375004,1.1853027343749858],[34.78759765625003,1.230712890625],[34.96523437500005,1.6433593749999602],[34.9640625000001,2.06240234374998],[34.742480468750074,2.818115234375014],[34.44785156250006,3.163476562500037],[34.392871093750074,3.6915039062500483],[34.16503906250003,3.812988281250014],[34.18574218750004,3.869775390625037],[34.13203125000004,3.889160156249986],[33.97607421874997,4.220214843750028],[34.176855468750006,4.419091796875037],[34.38017578125002,4.620654296874974],[34.6398437500001,4.875488281250028],[34.878320312499994,5.109570312500026],[35.08447265624997,5.31186523437502],[35.268359375000074,5.492285156250006],[35.325292968750006,5.364892578124994]]]},properties:{name:"Kenya",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[72.63994140625002,39.385986328125],[71.73222656250002,39.422998046874994],[71.404296875,39.5978515625],[71.32851562500002,39.568701171875],[71.27285156250002,39.535302734374994],[71.11806640625002,39.513574218749994],[71.0650390625,39.493408203125],[71.0048828125,39.411865234375],[70.79931640625,39.3947265625],[70.73310546875001,39.41328125],[70.67861328125002,39.4712890625],[70.60781250000002,39.564404296875],[70.24482421875001,39.542626953124994],[70.20927734375002,39.574999999999996],[70.17109375000001,39.5841796875],[70.13681640625,39.557568359375],[69.7720703125,39.55673828125],[69.59882812500001,39.573779296874996],[69.47099609375002,39.990624999999994],[69.966796875,40.20224609375],[70.59921875,39.974511718749994],[70.9580078125,40.2388671875],[71.69248046875,40.15234375],[72.3892578125,40.427392578124994],[73.13212890625002,40.828515624999994],[72.36406250000002,41.04345703125],[71.60625000000002,41.367431640625],[71.4208984375,41.34189453125],[71.40839843750001,41.136035156249996],[71.39306640625,41.123388671875],[71.298828125,41.152490234374994],[71.11074218750002,41.152636718749996],[70.78242187500001,41.262499999999996],[70.18095703125002,41.571435546874994],[70.45498046875002,41.725048828125],[70.84189453125,42.01962890625],[71.0322265625,42.077783203124994],[71.228515625,42.162890624999996],[71.23232421875002,42.186279296875],[71.21269531250002,42.206445312499994],[71.12998046875,42.25],[71.03603515625002,42.28466796875],[70.97900390625,42.266552734375],[70.94677734375,42.248681640624994],[70.89287109375002,42.339990234374994],[71.02275390625002,42.535449218749996],[71.25664062500002,42.733544921874994],[71.42207031250001,42.783154296875],[71.5142578125,42.766943359375],[71.73476562500002,42.818896484374996],[71.76054687500002,42.821484375],[71.81679687500002,42.822167968749994],[72.16181640625001,42.760693359375],[72.27578125000002,42.757666015625],[72.54316406250001,42.677734375],[72.7529296875,42.637890625],[72.855078125,42.5611328125],[73.28291015625001,42.5041015625],[73.49296875000002,42.409033203125],[73.421875,42.593505859375],[73.55625,43.002783203125],[73.88603515625002,43.132568359375],[74.20908203125,43.240380859374994],[75.04765625000002,42.90439453125],[75.68173828125,42.830468749999994],[75.78955078125,42.932910156249996],[75.84033203125,42.9375],[75.9322265625,42.928515624999996],[76.50917968750002,42.918896484375],[77.05732421875001,42.970654296875],[77.23554687500001,42.912646484374996],[78.52421874999999,42.864648437499994],[79.16484374999999,42.759033203125],[79.20302734375002,42.666015625],[79.29550781250003,42.604833984375],[79.36777343750003,42.547216796875],[79.49013671875002,42.457568359374996],[79.92109375000001,42.413134765624996],[80.0712890625,42.302978515625],[80.20937500000002,42.1900390625],[80.24619140625003,42.059814453125],[80.23515624999999,42.04345703125],[80.21621093750002,42.032421875],[79.90966796875,42.014990234375],[79.84042968750003,41.995751953124994],[79.29355468750003,41.7828125],[78.36240234375003,41.371630859374996],[78.34628906250003,41.2814453125],[78.12343750000002,41.075634765625],[77.95644531250002,41.050683593749994],[77.81523437499999,41.055615234375],[77.71933593750003,41.024316406249994],[77.58173828125001,40.9927734375],[76.98662109374999,41.03916015625],[76.90771484375,41.024169921875],[76.82402343749999,40.982324218749994],[76.48017578125001,40.449511718749996],[76.39638671875002,40.389794921874994],[76.31855468750001,40.35224609375],[76.25830078125,40.43076171875],[75.87197265625002,40.30322265625],[75.67714843750002,40.305810546874994],[75.65595703125001,40.329248046874994],[75.58349609375,40.605322265625],[75.0044921875,40.449511718749996],[74.41191406250002,40.13720703125],[74.24267578125,40.092041015625],[74.08515625000001,40.07431640625],[74.0205078125,40.059374999999996],[73.99160156250002,40.043115234374994],[73.93876953125002,39.978808593749996],[73.88457031250002,39.8779296875],[73.85625000000002,39.828662109374996],[73.83535156250002,39.800146484375],[73.9146484375,39.606494140624996],[73.87275390625001,39.53330078125],[73.82294921875001,39.48896484375],[73.71572265625002,39.462255859375],[73.63164062500002,39.448876953124994],[73.47041015625001,39.460595703124994],[73.38740234375001,39.442724609375],[73.33613281250001,39.412353515625],[73.2349609375,39.374560546874996],[72.63994140625002,39.385986328125]]]},properties:{name:"Kyrgyzstan",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[104.42636718750006,10.411230468749991],[104.26240234375004,10.541259765625014],[103.53222656249997,10.604638671874966],[103.72187500000004,10.890136718750043],[103.5324218750001,11.146679687499997],[103.15283203124997,10.913720703125051],[103.12548828124997,11.460644531250011],[102.93388671875002,11.706689453125037],[102.73662109375007,12.089794921875011],[102.75566406250002,12.42626953125],[102.49960937500012,12.669970703125003],[102.31972656250005,13.539990234375054],[102.72890625,13.841894531250006],[103.19941406250004,14.332617187499977],[104.77900390625004,14.427832031250006],[104.96972656249997,14.366113281250051],[105.07412109375005,14.227441406250037],[105.12597656250003,14.280957031250011],[105.16914062500004,14.336083984374966],[105.1833007812501,14.346240234374989],[105.18554687500003,14.319091796874972],[105.20703125000003,14.259374999999977],[105.24570312500006,14.200537109374977],[105.35019531250006,14.109570312500011],[105.9044921875001,13.924511718750054],[106.12470703125004,14.049121093750031],[106.09667968749997,14.127099609375023],[106.00410156250004,14.262890624999983],[105.97890625,14.343017578125043],[106.00839843750012,14.357177734375],[106.1652343750001,14.372363281249989],[106.35498046875003,14.454785156249997],[106.44697265625004,14.515039062500009],[106.50146484375003,14.578222656250006],[106.53115234375005,14.549414062499991],[106.5636718750001,14.505078125000026],[106.81992187500006,14.314697265625057],[107.10937499999997,14.416699218750054],[107.29267578125004,14.592382812500048],[107.37988281250003,14.555322265625051],[107.41474609375004,14.562890624999994],[107.51943359375005,14.705078125],[107.3314453125,14.126611328125009],[107.60546874999997,13.437792968750017],[107.47539062500002,13.030371093749963],[107.50644531250006,12.364550781250031],[106.93066406249997,12.077490234374991],[106.41386718750002,11.948437499999997],[106.33984374999997,11.68183593750004],[105.85146484375005,11.635009765625],[105.85605468750006,11.294287109375048],[106.16796874999997,11.012304687499977],[105.38652343750002,10.940087890625009],[104.85058593749997,10.534472656249974],[104.42636718750006,10.411230468749991]]]},properties:{name:"Cambodia",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[128.37460937500012,38.623437499999994],[128.61884765625004,38.17607421874999],[129.33515625000004,37.274560546874994],[129.47343750000007,36.74189453125001],[129.40351562500004,36.052148437499994],[129.5617187500001,35.94765625000002],[129.21416015625007,35.18183593749998],[128.5109375000001,35.10097656250002],[128.44394531250012,34.87036132812503],[127.71484374999997,34.95468749999998],[126.50830078125003,34.35063476562502],[126.29111328125012,35.154150390625034],[126.71738281250006,35.76884765625002],[126.5482421875,36.477636718750006],[126.21718750000005,36.870947265625006],[126.74638671875002,37.19355468750001],[126.63388671875012,37.78183593750006],[127.16953125000006,38.304541015625034],[128.03896484375,38.30854492187498],[128.37460937500012,38.623437499999994]]]},properties:{name:"South Korea",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[21.5625,42.247509765625],[21.560839843750017,42.24765625],[21.389550781250023,42.21982421875],[21.25634765625,42.099511718749994],[21.05976562500001,42.171289062499994],[20.566210937500017,41.873681640624994],[20.485449218750006,42.223388671875],[20.06396484375,42.547265624999994],[20.344335937500006,42.827929687499996],[21.057031250000023,43.091699218749994],[21.390625,42.751416015625],[21.52998046875001,42.349999999999994],[21.5625,42.247509765625]]]},properties:{name:"Kosovo",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[48.442480468750006,28.542919921874983],[47.671289062499994,28.53315429687504],[47.433203125000006,28.989550781250017],[46.53144531250004,29.09624023437499],[46.90585937500006,29.537499999999994],[47.14824218750002,30.0009765625],[47.67275390625005,30.095605468750023],[47.75390624999997,30.076611328124955],[47.97871093750004,29.98281250000005],[48.00566406250002,29.835791015625034],[48.13613281250005,29.618115234374983],[47.96962890625005,29.61669921874997],[48.18378906250004,28.979394531249994],[48.442480468750006,28.542919921874983]]]},properties:{name:"Kuwait",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[102.12744140625011,22.37919921874999],[102.94863281250008,21.569775390625068],[102.85117187500009,21.26591796874999],[102.8837890625,21.202587890625068],[103.1044921875,20.89165039062499],[103.21074218749999,20.840625000000045],[103.46357421874995,20.779833984375102],[103.6350585937501,20.697070312500102],[104.05205078124999,20.941210937500102],[104.1953125,20.91396484375008],[104.349609375,20.82109374999999],[104.58320312500001,20.646679687499955],[104.61884765624995,20.374511718750114],[104.92792968750007,20.01811523437499],[104.81513671875001,19.90400390625001],[104.80175781250011,19.836132812500068],[104.74316406250006,19.754736328124977],[104.58789062500006,19.618749999999977],[104.54628906250014,19.610546875000068],[104.25986328125003,19.685498046875068],[104.06279296875005,19.678417968750068],[104.03203124999999,19.67514648437492],[103.89638671875002,19.339990234375023],[103.91835937500008,19.268505859375068],[104.10859375000013,19.195556640625114],[104.44580078125006,18.983837890625125],[104.61328125000006,18.860644531250102],[104.71650390624995,18.803417968749955],[104.9931640625,18.728320312499932],[105.11513671875002,18.678857421875023],[105.146484375,18.650976562499977],[105.14541015625014,18.616796874999977],[105.08583984375008,18.450097656250136],[105.11455078125005,18.405273437500057],[105.16328125000007,18.338720703124977],[105.27324218750005,18.235351562500057],[105.33349609375006,18.18964843750001],[105.45820312500007,18.154296875000057],[105.51855468750011,18.077441406250045],[105.58847656250015,17.983691406249932],[105.69140625,17.737841796874932],[106.50224609374999,16.9541015625],[106.69609375000005,16.458984375],[106.93066406250006,16.35312499999992],[107.21738281250003,16.136328124999977],[107.29648437500015,16.08403320312499],[107.39638671875008,16.04301757812499],[107.36064453125005,15.921728515624977],[107.18886718750008,15.838623046875114],[107.16591796875002,15.802490234375],[107.18955078125003,15.747265624999955],[107.27939453125003,15.618701171875045],[107.33876953125002,15.560498046875125],[107.56425781249999,15.3916015625],[107.62167968750015,15.309863281250045],[107.65312499999999,15.255224609375091],[107.63369140625008,15.18984375000008],[107.58964843749999,15.118457031250102],[107.55527343750009,15.057031250000023],[107.48037109375014,14.979882812500136],[107.5046875000001,14.91591796875008],[107.52451171875003,14.871826171874943],[107.51376953124998,14.817382812500057],[107.51943359375008,14.705078125000114],[107.46513671875005,14.664990234375125],[107.41474609375007,14.56289062500008],[107.37988281250006,14.555322265625136],[107.29267578125007,14.592382812500034],[107.10937500000006,14.416699218749955],[106.81992187500003,14.314697265624943],[106.56367187500007,14.505078125000011],[106.53115234375002,14.549414062499977],[106.50146484375,14.578222656250034],[106.35498046875,14.454785156250068],[106.22539062500005,14.476220703125023],[106.16523437500007,14.372363281249989],[106.00839843750009,14.357177734375114],[105.97890625000014,14.343017578125057],[106.00410156250013,14.262890625000068],[106.09667968750011,14.127099609375136],[106.12470703124995,14.049121093750045],[105.90449218750007,13.924511718750068],[105.5315429687501,14.156152343750023],[105.35019531250009,14.109570312500125],[105.24570312500015,14.200537109374977],[105.20703125000006,14.259375000000091],[105.18554687499994,14.319091796875],[105.18330078125001,14.346240234374989],[105.24365234375006,14.367871093749955],[105.34218750000008,14.416699218749955],[105.47558593750006,14.530126953124977],[105.51318359375011,15.360888671874932],[105.61562500000002,15.488281249999943],[105.62207031250006,15.699951171875114],[105.46201171875015,15.780419921875136],[105.39892578125011,15.829882812500102],[105.37324218750001,15.889697265625045],[105.40625,15.987451171875023],[105.33066406250003,16.037890625000045],[105.1487304687501,16.09355468749999],[105.04716796874999,16.16025390625009],[104.81933593749994,16.466064453125057],[104.75058593750015,16.647558593750034],[104.75898437500013,17.0771484375],[104.81601562499998,17.30029296875],[104.42812500000002,17.698974609375057],[104.19619140625002,17.988378906250034],[104.04873046875002,18.216699218749966],[103.94960937500008,18.318994140625023],[103.89882812500002,18.295312500000023],[103.79228515624999,18.31650390625009],[103.62968750000005,18.382568359375057],[103.36699218750005,18.42333984375],[103.05136718750003,18.02851562500001],[102.71757812500005,17.892236328125136],[102.35185546874999,18.045947265625045],[102.23164062500001,18.148974609375045],[102.14824218750005,18.203857421875057],[102.10146484375014,18.21064453125001],[102.03457031250002,18.169824218750023],[101.94746093750001,18.081494140624955],[101.87548828125011,18.046435546874932],[101.81865234375005,18.064648437500125],[101.77480468750002,18.033398437500125],[101.10517578125001,17.479541015625102],[100.9084960937501,17.583886718750023],[101.11328125000006,18.033544921874977],[101.0505859375001,18.407031250000045],[101.06044921875014,18.479003906249943],[101.10634765625008,18.533544921875034],[101.16552734375006,18.61831054687508],[101.28632812499995,18.977148437500034],[101.19755859374999,19.327929687500045],[101.22080078125015,19.486621093750045],[101.15468750000014,19.57919921875009],[100.62548828125,19.49985351562509],[100.39765625000013,19.756103515625057],[100.51455078125014,19.996337890625],[100.54306640625009,20.08867187499999],[100.53994140625014,20.13237304687499],[100.51953125000006,20.177929687500068],[100.31796875000003,20.385888671875136],[100.2493164062501,20.730273437499932],[100.56513671875013,20.82509765625008],[100.5222656250001,20.921923828125102],[100.53613281250006,20.992382812500068],[100.56660156250007,21.038183593749977],[100.61367187500008,21.059326171875],[100.65917968750011,21.130371093750114],[100.703125,21.25136718750008],[100.75664062500005,21.312646484375136],[100.81953125000007,21.314208984375057],[100.92753906250005,21.3662109375],[101.17539062500009,21.407519531250102],[101.22441406249999,21.22373046874992],[101.24785156249993,21.197314453125045],[101.28144531250007,21.184130859375045],[101.44355468750001,21.230810546874977],[101.54238281250008,21.234277343750136],[101.70478515625013,21.150146484375057],[101.78349609374999,21.204150390625045],[101.8005859375001,21.212597656249955],[101.80205078125005,21.235986328125136],[101.76308593750014,21.278906249999977],[101.7229492187501,21.314941406250057],[101.74726562500007,21.60576171874999],[101.7439453125001,21.77797851562508],[101.73652343750001,21.826513671874977],[101.52451171874998,22.253662109375],[101.56787109375011,22.2763671875],[101.6199218750001,22.327441406250102],[101.67148437500009,22.462304687500023],[101.70751953125,22.486572265625],[101.73876953125011,22.495263671874966],[101.75996093750001,22.490332031250034],[101.841796875,22.388476562500102],[102.02441406250006,22.439208984375114],[102.09150390625007,22.412255859375136],[102.12744140625011,22.37919921874999]]]
},properties:{name:"Laos",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[35.869140625,33.43173828125],[35.411230468750006,33.07568359375],[35.10859375000001,33.08369140625],[35.97626953125001,34.629199218749996],[36.43300781250002,34.6134765625],[36.5849609375,34.221240234374996],[35.9423828125,33.667578125],[35.869140625,33.43173828125]]]},properties:{name:"Lebanon",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[-8.486425781249977,7.558496093749994],[-8.408740234374989,7.411816406249997],[-8.324511718749989,6.9200195312499915],[-8.587890625,6.490527343749989],[-8.203857421875,6.290722656249997],[-7.981591796874994,6.2861328125],[-7.888623046874983,6.23486328125],[-7.800927734374994,6.0389160156249915],[-7.730371093749994,5.9190429687499915],[-7.636132812499994,5.90771484375],[-7.39990234375,5.550585937499989],[-7.585058593749977,4.916748046875],[-7.574658203124983,4.572314453124989],[-7.544970703124989,4.351318359375],[-8.259033203125,4.589990234374994],[-9.132177734374977,5.054638671874997],[-10.2763671875,6.07763671875],[-10.785595703124983,6.3101562499999915],[-10.849023437499994,6.465087890625],[-11.507519531249983,6.906542968749989],[-11.267675781249977,7.232617187499997],[-10.878076171874994,7.538232421874994],[-10.389550781249994,8.157617187499994],[-10.283203125,8.485156249999989],[-9.768261718749983,8.534570312499994],[-9.518261718749983,8.346093749999994],[-9.368945312499989,7.639550781249994],[-9.459765624999989,7.442529296874994],[-9.117578124999994,7.2159179687499915],[-8.8896484375,7.2626953125],[-8.708300781249989,7.658886718749997],[-8.486425781249977,7.558496093749994]]]},properties:{name:"Liberia",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[25.150488281250006,31.654980468749997],[24.85273437500001,31.334814453125],[24.973925781250017,30.776562499999997],[24.726464843750023,30.2505859375],[24.980273437500017,29.181884765625],[24.980273437500017,26.487109374999996],[24.980273437500017,24.466064453125],[24.980273437500017,21.995849609375],[24.9794921875,20.002587890624994],[23.980273437500017,19.99594726562499],[23.980273437500017,19.496630859375003],[21.5849609375,20.679492187500003],[19.668554687500006,21.62583007812499],[18.231347656250023,22.33554687499999],[15.984082031250011,23.445214843749994],[14.97900390625,22.99619140624999],[14.230761718750017,22.618457031250003],[13.481250000000017,23.18017578125],[11.967871093750006,23.517871093750003],[11.536914062500017,24.290820312500003],[10.686132812500006,24.55136718749999],[10.255859375,24.591015624999997],[10.000683593750011,25.332080078125003],[9.4482421875,26.067138671875],[9.491406250000011,26.333740234375],[9.859375,26.551953124999997],[9.74755859375,27.330859374999996],[9.916015625,27.785693359374996],[9.842578125000017,28.966992187499997],[9.672656250000017,29.5669921875],[9.310253906250011,30.115234375],[9.518750000000011,30.229394531249994],[9.637988281250017,30.28232421875],[9.807421875000017,30.342236328124997],[9.89501953125,30.3873046875],[9.932519531250023,30.425341796874996],[10.059765625000011,30.580078125],[10.216406250000006,30.783203125],[10.114941406250011,31.463769531249994],[10.274609375000011,31.684960937499994],[10.475781250000011,31.736035156249997],[10.60888671875,31.929541015625],[10.826367187500011,32.0806640625],[11.005175781250017,32.172705078125],[11.168261718750017,32.256738281249994],[11.358007812500006,32.34521484375],[11.504980468750006,32.413671875],[11.535937500000017,32.47333984375],[11.533789062500006,32.524951171874996],[11.453906250000017,32.642578125],[11.453906250000017,32.781689453125],[11.467187500000023,32.965722656249994],[11.504589843750011,33.181933593749996],[11.657128906250023,33.118896484375],[11.8134765625,33.093701171875],[12.279882812500006,32.858544921874994],[12.753515625000006,32.801074218749996],[13.283496093750017,32.9146484375],[14.237109375000017,32.68125],[14.513378906250011,32.511083984375],[15.176562500000017,32.391162109374996],[15.496386718750017,31.656787109374996],[16.123046875,31.264453124999996],[17.349218750000006,31.081494140624997],[18.1904296875,30.777294921874997],[18.936425781250023,30.290429687499994],[19.29169921875001,30.2880859375],[19.713281250000023,30.48837890625],[20.150976562500006,31.07861328125],[19.926367187500006,31.817529296874994],[20.121484375000023,32.21875],[20.62109375,32.58017578125],[21.63593750000001,32.937304687499996],[22.187402343750023,32.918261718749996],[23.090625000000017,32.61875],[23.28632812500001,32.213818359375],[24.129687500000017,32.009228515625],[24.683886718750017,32.015966796875],[25.150488281250006,31.654980468749997]]]},properties:{name:"Libya",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[79.98232421875,9.812695312500011],[80.25283203125005,9.796337890625054],[80.71113281250004,9.366357421875023],[81.37285156250002,8.431445312499989],[81.4359375,8.118896484374986],[81.87412109375012,7.288330078124986],[81.86142578125012,6.901269531249994],[81.63740234375004,6.4251464843749915],[80.72412109375003,5.97905273437496],[80.09531250000012,6.153173828125006],[79.85937499999997,6.829296874999983],[79.79208984375006,7.585205078124972],[79.92890625000004,8.899218749999974],[80.1183593750001,9.326855468749969],[79.98232421875,9.812695312500011]]]},properties:{name:"Sri Lanka",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[28.128710937500017,-30.52509765625001],[28.05683593750001,-30.63105468750001],[27.75312500000001,-30.60000000000001],[27.364062500000017,-30.27919921875001],[27.19355468750001,-29.94130859375001],[27.294531250000006,-29.519335937500003],[27.73554687500001,-28.940039062500006],[28.625781250000017,-28.58173828125001],[29.301367187500006,-29.08984375],[29.370898437500017,-29.21845703125001],[29.390722656250006,-29.26972656250001],[29.38671875,-29.31972656250001],[29.34882812500001,-29.441992187500006],[29.293554687500006,-29.56689453125],[29.142187500000006,-29.700976562500003],[29.098046875000023,-29.919042968750006],[28.39208984375,-30.147558593750006],[28.128710937500017,-30.52509765625001]]]},properties:{name:"Lesotho",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[25.573046875000017,54.139892578125],[24.768164062499977,53.97465820312499],[24.317968750000006,53.892968749999966],[24.236621093750045,53.91997070312496],[24.19130859375005,53.95043945312503],[23.484667968750074,53.939794921875006],[23.453613281250057,54.14345703125002],[23.01552734375005,54.34833984375001],[22.766210937499977,54.356787109375034],[22.83125000000001,54.838476562500034],[21.235742187500023,55.26411132812498],[21.06191406250005,55.81342773437498],[21.053808593750006,56.02294921875003],[21.04609375000004,56.07006835937503],[21.31464843750004,56.18813476562502],[21.65351562500004,56.314550781250006],[22.084570312500034,56.40673828125006],[22.96826171875003,56.38041992187502],[23.042968750000057,56.324072265625006],[23.119824218749983,56.330664062500006],[23.195898437500034,56.36713867187498],[23.81269531250001,56.329248046874994],[24.120703125000063,56.26425781249998],[24.90302734375001,56.398193359375],[25.069921875000006,56.20039062500004],[25.585742187500017,56.13017578125002],[26.281250000000057,55.75043945312501],[26.40107421875004,55.70380859375001],[26.54287109375005,55.67241210937502],[26.593554687500074,55.66752929687502],[26.590820312500057,55.622656250000006],[26.56660156250001,55.546484375000034],[26.51923828125004,55.448144531249994],[26.469531250000045,55.371923828125006],[26.457617187500006,55.342480468749955],[26.175195312500023,55.003271484375034],[26.092968750000068,54.96230468750005],[25.964453124999977,54.947167968749966],[25.85927734375005,54.91928710937498],[25.573046875000017,54.139892578125]]]},properties:{name:"Lithuania",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[6.4873046875,49.798486328124994],[6.348437500000017,49.5126953125],[6.344335937500006,49.452734375],[6.27734375,49.4775390625],[6.2421875,49.4943359375],[6.119921875000017,49.485205078125],[6.074121093750023,49.454638671874996],[5.95947265625,49.454638671874996],[5.928906250000011,49.4775390625],[5.9013671875,49.48974609375],[5.823437500000011,49.505078125],[5.789746093750011,49.53828125],[5.88037109375,49.644775390625],[5.8037109375,49.732177734375],[5.787988281250023,49.75888671875],[5.725000000000023,49.80830078125],[5.725781250000011,49.833349609375],[5.740820312500006,49.857177734375],[5.735253906250023,49.875634765624994],[5.744042968750023,49.91962890625],[5.7880859375,49.961230468749996],[5.8173828125,50.0126953125],[5.866894531250011,50.082812499999996],[5.976269531250011,50.1671875],[6.089062500000011,50.154589843749996],[6.116503906250017,50.120996093749994],[6.108300781250023,50.09423828125],[6.109765625000023,50.034375],[6.13818359375,49.97431640625],[6.256054687500011,49.87216796875],[6.4873046875,49.798486328124994]]]},properties:{name:"Luxembourg",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[28.14794921875,56.142919921875],[27.576757812500006,55.798779296875],[27.052539062500017,55.83056640625],[26.82246093750001,55.709228515625],[26.620214843750006,55.679638671875],[26.593554687500017,55.667529296874996],[26.542871093750023,55.672412109374996],[26.40107421875001,55.70380859375],[26.28125,55.750439453125],[25.585742187500017,56.130175781249996],[25.069921875000006,56.200390625],[24.90302734375001,56.398193359375],[24.120703125000006,56.2642578125],[23.81269531250001,56.329248046875],[23.195898437500006,56.367138671875],[23.11982421875001,56.3306640625],[23.04296875,56.324072265625],[22.96826171875,56.380419921874996],[22.084570312500006,56.40673828125],[21.730566406250006,56.325976562499996],[21.65351562500001,56.31455078125],[21.31464843750001,56.188134765625],[21.04609375000001,56.070068359375],[21.0712890625,56.82373046875],[21.72871093750001,57.57099609375],[22.554589843750023,57.724267578125],[23.647753906250017,56.971044921875],[24.403222656250023,57.324999999999996],[24.322558593750017,57.87060546875],[24.775781250000023,57.98525390625],[24.83906250000001,57.988720703125],[24.91132812500001,58.00458984375],[25.11103515625001,58.063427734375],[25.66015625,57.920166015625],[26.29804687500001,57.60107421875],[26.899804687500023,57.6087890625],[26.96601562500001,57.609130859375],[27.03339843750001,57.578759765625],[27.187109375000006,57.538330078125],[27.326562500000023,57.52548828125],[27.4697265625,57.5240234375],[27.511132812500023,57.508154296875],[27.538671875000006,57.42978515625],[27.796875,57.316943359374996],[27.814550781250006,57.16689453125],[27.639453125000017,56.845654296875],[27.806054687500023,56.86708984375],[28.14794921875,56.142919921875]]]},properties:{name:"Latvia",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[-1.16259765625,32.399169921875],[-1.275341796874983,32.089013671874966],[-1.8169921874999204,32.10478515624999],[-2.0728027343749886,32.11503906250002],[-2.4483886718749375,32.12998046875006],[-2.523242187500017,32.12568359374998],[-2.8634277343749375,32.07470703124997],[-2.930859374999926,32.04252929687499],[-2.988232421874983,31.874218749999983],[-3.01738281249996,31.834277343750017],[-3.439794921874949,31.704541015624983],[-3.8267578124999204,31.66191406249999],[-3.837109374999983,31.512353515624994],[-3.8333984374999375,31.197802734375045],[-3.6725097656249375,31.111376953125017],[-3.6269042968749545,31.000927734374983],[-3.666796874999932,30.964013671875023],[-3.7020019531249773,30.944482421875023],[-3.9853515624999716,30.91352539062504],[-4.148779296874977,30.8095703125],[-4.322851562500006,30.698876953124994],[-4.52915039062492,30.62553710937499],[-4.778515624999926,30.552392578124994],[-4.968261718749943,30.465380859375045],[-5.0619140624999375,30.326416015625057],[-5.1801269531249545,30.166162109374994],[-5.293652343749983,30.058642578125045],[-5.44877929687496,29.956933593750023],[-5.774999999999977,29.86904296875005],[-6.500878906249994,29.809130859375017],[-6.507910156250006,29.783789062500006],[-6.5106933593749545,29.726025390624955],[-6.520556640624989,29.659863281249983],[-6.635351562499949,29.568798828124983],[-6.755126953125,29.583837890625034],[-6.855566406249949,29.601611328125017],[-7.0949218749999545,29.62519531250001],[-7.23491210937496,29.574902343749983],[-7.485742187499994,29.392236328124994],[-7.685156249999949,29.349511718749994],[-7.998925781249994,29.132421874999977],[-8.265185546874989,28.980517578125045],[-8.659912109375,28.718603515625063],[-8.683349609375,27.900390625],[-8.817822265624955,27.65644531250004],[-8.817773437499937,27.655908203125023],[-8.813916015624955,27.613867187500063],[-8.784570312499994,27.530859375000034],[-8.774365234374983,27.460546875000006],[-8.753857421874955,27.191015624999977],[-8.753857421874955,27.150976562500006],[-8.794873046874983,27.120703125000034],[-9.001904296874955,27.090429687500006],[-9.413037109374955,27.088476562500063],[-9.7353515625,26.860937500000063],[-10.251464843749972,26.860937500000063],[-10.922802734374983,27.010351562500034],[-11.392578125000028,26.883398437500006],[-11.361279296874955,26.793554687500006],[-11.316845703124955,26.744726562500006],[-11.337890624999972,26.633398437499977],[-11.718212890624926,26.104101562500063],[-11.754882812499943,26.086523437500034],[-11.880859375000028,26.070898437500034],[-12.03076171875,26.030859375000063],[-12.310986328124983,25.110937500000063],[-12.360839843750028,24.970312500000006],[-12.40087890625,24.880468750000006],[-12.431152343749943,24.830664062500063],[-12.500976562499972,24.770117187499977],[-12.630810546874955,24.680273437499977],[-12.710937500000028,24.630468750000034],[-12.991162109375011,24.470312500000006],[-13.061035156249943,24.400976562500006],[-13.310986328124955,23.981054687499977],[-13.391113281249943,23.941015625000006],[-13.5810546875,23.870703124999977],[-13.661083984374955,23.830664062500006],[-13.770947265624955,23.790625000000006],[-13.840771484374983,23.750585937500034],[-13.891113281250028,23.691015625000063],[-14.020996093750028,23.410742187499977],[-14.10107421875,23.100195312500034],[-14.121093749999972,22.960546875000006],[-14.1708984375,22.760351562499977],[-14.221191406249943,22.310156250000034],[-14.52099609375,21.990869140624994],[-14.670849609374983,21.600195312499977],[-14.750976562499972,21.500585937500034],[-14.840820312499972,21.450781250000006],[-14.971142578124955,21.441015625000063],[-15.15087890625,21.441015625000063],[-15.4609375,21.450781250000006],[-15.610791015624983,21.470312499999977],[-15.750927734374926,21.490820312499977],[-16.73095703125003,21.470312499999977],[-16.951123046874926,21.430273437500006],[-17.003076171874937,21.420703125000017],[-16.930859374999983,21.900000000000034],[-16.514404296874943,22.33349609374997],[-16.21025390624999,23.097900390625],[-15.586328124999966,24.07275390625003],[-15.038867187499989,24.54882812500003],[-14.856054687499977,24.871582031250057],[-14.794921874999943,25.404150390625006],[-14.413867187499932,26.25371093749999],[-13.575781250000006,26.735107421875],[-13.175976562499983,27.655712890624983],[-12.948925781249926,27.914160156250034],[-11.986083984374972,28.129296874999994],[-11.430175781249943,28.382031249999983],[-11.080957031249937,28.713769531249966],[-10.486474609374994,29.06494140625],[-9.667089843749949,30.10927734375005],[-9.652929687499977,30.447558593750045],[-9.875488281249943,30.717919921874966],[-9.80869140624992,31.42460937499996],[-9.347460937499932,32.086376953124955],[-9.245849609375,32.572460937499955],[-8.301171874999937,33.37436523437498],[-7.562353515624977,33.640283203124994],[-6.900976562499949,33.96904296874999],[-6.353125000000006,34.77607421875001],[-5.924804687499943,35.78579101562502],[-5.397363281249966,35.929882812499955],[-5.105371093749994,35.46777343749997],[-4.3299804687499375,35.161474609375006],[-3.6932617187499943,35.27998046874998],[-2.839941406249949,35.127832031249994],[-2.4237304687499943,35.12348632812498],[-2.219628906249966,35.10419921874998],[-2.131787109374926,34.970849609374994],[-1.9208984374999432,34.835546875000034],[-1.795605468749926,34.751904296874955],[-1.706933593749966,34.17607421874999],[-1.67919921875,33.31865234375002],[-1.5507324218749545,33.073583984375006],[-1.510009765625,32.877636718749955],[-1.16259765625,32.399169921875]]]},properties:{name:"Morocco",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[28.212500000000006,45.450439453125],[28.099707031250006,45.972607421875],[28.24433593750001,46.45126953125],[28.07177734375,46.978417968749994],[27.3369140625,47.63974609375],[26.980761718750017,48.155029296875],[26.618945312500017,48.25986328125],[27.549218750000023,48.477734375],[28.34052734375001,48.144433593749994],[28.53046875000001,48.150292968749994],[28.601660156250006,48.144384765625],[28.773828125000023,48.119580078125],[28.865820312500006,47.995654296874996],[28.97333984375001,47.933007812499994],[29.19482421875,47.882421875],[29.21113281250001,47.775],[29.210742187500017,47.73154296875],[29.18603515625,47.658593749999994],[29.122949218750023,47.53037109375],[29.159765625000006,47.4556640625],[29.455664062500006,47.292626953124994],[29.57197265625001,46.964013671874994],[29.877832031250023,46.828906249999996],[29.942480468750006,46.723779296874994],[29.93476562500001,46.625],[29.92431640625,46.538867187499996],[29.837890625,46.350537109375],[29.458789062500017,46.453759765624994],[29.146289062500017,46.526904296874996],[28.92744140625001,46.424121093749996],[28.930566406250023,46.362255859375],[28.943750000000023,46.288427734375],[29.006250000000023,46.17646484375],[28.97187500000001,46.12763671875],[28.94775390625,46.049951171874994],[28.849511718750023,45.978662109374994],[28.73876953125,45.937158203124994],[28.491601562500023,45.665771484375],[28.513769531250006,45.572412109374994],[28.4990234375,45.517724609374994],[28.47138671875001,45.507177734375],[28.310351562500017,45.498583984374996],[28.26484375000001,45.48388671875],[28.212500000000006,45.450439453125]]]},properties:{name:"Moldova",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[49.53828125000004,-12.432128906250014],[49.93750000000003,-13.072265624999957],[50.17382812500003,-14.040234374999983],[50.23535156249997,-14.732031249999963],[50.482714843750074,-15.385644531249994],[50.20898437499997,-15.960449218750028],[49.89257812500003,-15.457714843750011],[49.64990234374997,-15.566992187499991],[49.83105468750003,-16.255859375],[49.76718750000006,-16.815136718749983],[49.43710937500006,-17.3466796875],[49.477832031250074,-17.89853515624999],[48.60703125000006,-20.457519531249957],[48.35078125000004,-21.349023437500037],[47.9083984375001,-22.465820312500014],[47.55800781250005,-23.874609374999963],[47.177343750000006,-24.787207031249977],[46.72851562499997,-25.14990234374997],[46.15869140624997,-25.230371093750023],[45.5080078125001,-25.56318359374997],[45.11523437500003,-25.543066406249963],[44.81289062500005,-25.33417968750004],[44.34589843750004,-25.226074218749957],[44.0353515625001,-24.995703125000006],[43.68750000000003,-24.357910156250014],[43.722265625000006,-23.529687500000037],[43.397851562499994,-22.886328124999963],[43.26660156249997,-22.04931640624997],[43.50185546875005,-21.356445312499957],[43.800195312499994,-21.179199218749986],[44.239648437499994,-20.379687500000003],[44.40468750000005,-19.922070312500026],[44.44882812500006,-19.42871093749997],[44.23876953124997,-19.075195312499986],[44.23310546875004,-18.740625000000037],[44.04003906249997,-18.288476562500023],[43.979394531249994,-17.3916015625],[44.42138671874997,-16.70263671874997],[44.476171875000006,-16.217285156249957],[44.90917968749997,-16.174511718750026],[45.16679687500002,-15.982812499999966],[45.598242187500006,-15.992578125000009],[45.70019531249997,-15.813769531249989],[46.331445312499994,-15.713671875000031],[46.47509765625003,-15.513476562500003],[47.81152343749997,-14.544824218750023],[47.995507812499994,-13.960449218749986],[48.796484375000006,-13.267480468750023],[48.89960937500004,-12.458496093749972],[49.20703124999997,-12.079589843749957],[49.53828125000004,-12.432128906250014]]]},properties:{name:"Madagascar",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[-97.14624023437494,25.961474609375045],[-97.50708007812503,25.01455078125005],[-97.66767578124995,24.389990234374977],[-97.85781249999997,22.62451171875003],[-97.63754882812495,21.603662109374966],[-97.12143554687498,20.614990234375],[-96.45605468749994,19.869775390624966],[-96.28955078124994,19.34375],[-95.82109374999999,18.75463867187497],[-95.18183593749995,18.700732421875017],[-94.79814453124996,18.51459960937501],[-94.54619140624996,18.17485351562499],[-94.18901367187493,18.195263671874983],[-93.55234375,18.430468750000017],[-92.88476562499997,18.468652343749966],[-92.710107421875,18.611669921874977],[-91.97377929687502,18.715869140625074],[-91.80297851562503,18.470605468750023],[-91.27524414062498,18.62446289062501],[-91.34306640624996,18.900585937499955],[-90.73925781249994,19.352246093749955],[-90.507080078125,19.911865234375],[-90.48413085937503,20.55634765625004],[-90.35312499999998,21.009423828124966],[-89.81977539062495,21.274609374999983],[-88.87871093749999,21.41411132812499],[-88.13164062500002,21.615869140624966],[-86.824072265625,21.421679687500017],[-86.86469726562501,20.885058593750045],[-87.4671875,20.102148437500063],[-87.42475585937498,19.583349609375063],[-87.76181640624998,18.446142578125006],[-88.19677734374997,18.719677734374955],[-88.29565429687494,18.47241210937503],[-88.52299804687499,18.445898437500063],[-88.80634765624998,17.965527343749983],[-89.16147460937503,17.814843749999994],[-90.98916015624997,17.81640624999997],[-90.975830078125,16.867822265624994],[-90.41699218750003,16.391015625000023],[-90.41699218750003,16.351318359375],[-90.45014648437493,16.261376953124994],[-90.45986328124997,16.16235351562497],[-90.44716796874994,16.07270507812501],[-90.52197265625,16.07119140625005],[-90.70322265624998,16.07104492187503],[-90.97958984374998,16.07080078124997],[-91.433984375,16.070458984374994],[-91.736572265625,16.070166015625006],[-91.95722656250001,15.703222656250034],[-92.08212890624998,15.495556640625011],[-92.18715820312497,15.320898437499963],[-92.07480468749998,15.074218749999972],[-92.18637695312498,14.818359374999986],[-92.17646484375001,14.761328125000006],[-92.159912109375,14.691015624999977],[-92.18706054687493,14.630078124999997],[-92.20903320312499,14.57099609375004],[-92.26455078125,14.567773437500009],[-92.80893554687498,15.138574218750037],[-93.91606445312493,16.053564453125006],[-94.374169921875,16.284765625000034],[-94.66152343750002,16.20190429687503],[-94.90043945312502,16.41748046875],[-95.46440429687499,15.974707031250034],[-96.51083984375,15.651904296875074],[-97.18466796874998,15.909277343750006],[-97.75478515624994,15.966845703125017],[-98.52031249999993,16.30483398437505],[-98.76220703125,16.534765624999977],[-99.69067382812499,16.719628906249994],[-100.02451171874996,16.920507812500063],[-100.847802734375,17.20048828124999],[-101.60029296875,17.651562499999955],[-101.84707031250001,17.92226562500005],[-102.69956054687495,18.062841796875006],[-103.44160156249995,18.32539062500001],[-103.91245117187496,18.828466796875006],[-104.9384765625,19.309375000000017],[-105.482080078125,19.97607421875003],[-105.66943359374997,20.385595703124977],[-105.23706054687499,21.119189453125045],[-105.20869140624998,21.490820312499977],[-105.64912109375001,21.988085937500045],[-105.79179687500003,22.627490234375017],[-106.40224609374997,23.195605468750017],[-106.93549804687497,23.881249999999994],[-107.95117187499994,24.614892578124966],[-108.37368164062497,25.1943359375],[-109.38496093750001,25.727148437500006],[-109.42563476562495,26.032568359375063],[-109.19970703125003,26.30522460937499],[-109.48286132812498,26.710351562500023],[-109.75478515624995,26.702929687500017],[-109.94399414062495,27.079345703125057],[-110.47778320312499,27.322656249999966],[-110.52988281249995,27.864208984374983],[-111.12138671875002,27.966992187499983],[-111.68007812499997,28.470556640624977],[-112.16176757812495,29.018896484375034],[-112.223486328125,29.26948242187501],[-112.73837890625,29.985449218750034],[-113.11044921874996,30.793310546875063],[-113.04672851562495,31.17924804687499],[-114.14931640624995,31.507373046875045],[-114.83950195312497,31.79853515625004],[-114.88188476562499,31.156396484375023],[-114.63330078124997,30.50688476562496],[-114.64975585937495,30.238134765625006],[-114.37260742187497,29.83022460937505],[-113.75546875,29.367480468750017],[-113.49970703124995,28.92670898437501],[-112.870849609375,28.42421875000005],[-112.73403320312501,27.825976562500017],[-112.32919921874996,27.52343750000003],[-112.00908203125003,26.967089843750017],[-111.56967773437495,26.707617187500006],[-111.29160156249996,25.78979492187497],[-111.03442382812497,25.526953124999977],[-110.67724609374994,24.78852539062501],[-110.54697265624996,24.214160156250045],[-110.02280273437502,24.17460937499999],[-109.42084960937495,23.480126953124994],[-109.45805664062499,23.214746093750023],[-109.92343749999993,22.885888671874994],[-110.08603515624993,23.005468750000006],[-110.3626953125,23.60493164062501],[-111.41933593749997,24.329003906249994],[-112.07255859374999,24.84003906250001],[-112.05576171874995,25.48823242187501],[-112.37724609374997,26.21391601562496],[-113.02075195312499,26.58325195312497],[-113.20576171875001,26.85698242187496],[-113.59853515625001,26.721289062500034],[-113.84096679687502,26.966503906249983],[-114.44526367187503,27.218164062499994],[-114.99350585937499,27.736035156249983],[-114.30058593749995,27.87299804687501],[-114.04848632812502,28.426171874999994],[-114.14550781249997,28.60541992187501],[-114.99350585937499,29.384423828124994],[-115.67382812500003,29.756396484375017],[-116.06215820312501,30.80415039062504],[-116.66215820312495,31.56489257812504],[-117.12827148437495,32.533349609374994],[-114.72475585937495,32.71533203125003],[-114.83593749999994,32.50830078125003],[-112.93896484375001,31.91625976562503],[-111.0419921875,31.32421875000003],[-108.21445312499993,31.329443359375034],[-108.21181640625002,31.779345703125017],[-106.45322265624995,31.770166015625023],[-106.25571289062495,31.544677734375],[-104.97880859374996,30.645947265624955],[-104.40063476562503,29.57373046875],[-103.25771484374998,29.001123046874966],[-102.8919921875,29.216406250000034],[-102.73417968749999,29.643945312500023],[-102.26894531249998,29.871191406250034],[-101.44038085937503,29.77685546875],[-100.65864257812501,29.06855468750004],[-100.29604492187495,28.32768554687499],[-99.50532226562497,27.54833984375003],[-99.4435546875,27.03666992187499],[-99.10776367187498,26.446923828124994],[-98.08281249999999,26.06445312499997],[-97.35815429687497,25.870507812499994],[-97.14624023437494,25.961474609375045]]]},properties:{name:"Mexico",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[22.344042968750017,42.31396484375],[22.836816406250023,41.993603515625],[23.005664062500017,41.716943359374994],[22.951464843750017,41.605615234374994],[22.9296875,41.356103515624994],[22.916015625,41.336279296875],[22.75507812500001,41.312744140625],[22.72480468750001,41.178515624999996],[22.603613281250006,41.140185546874996],[22.493554687500023,41.118505859375],[22.237695312500023,41.155175781249994],[21.99335937500001,41.13095703125],[21.929492187500017,41.107421875],[21.575781250000006,40.868945312499996],[20.964257812500023,40.849902343749996],[20.48896484375001,41.272607421874994],[20.566210937500017,41.873681640624994],[21.05976562500001,42.171289062499994],[21.25634765625,42.099511718749994],[21.389550781250023,42.21982421875],[21.560839843750017,42.24765625],[21.5625,42.247509765625],[21.904101562500017,42.322070312499996],[22.052050781250017,42.304638671875],[22.14667968750001,42.324999999999996],[22.23974609375,42.358154296875],[22.344042968750017,42.31396484375]]]},properties:{name:"Macedonia",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[4.227636718750006,19.142773437499997],[4.234667968750017,16.996386718750003],[4.121289062500011,16.357714843750003],[3.876953125,15.755273437499994],[3.5042968750000227,15.356347656249994],[1.3001953125000227,15.272265625000003],[.9600585937500057,14.986914062499991],[.21748046875001137,14.911474609374991],[-.23588867187498863,15.059423828124991],[-.760449218749983,15.047753906249994],[-1.049560546875,14.819531249999997],[-1.767773437499983,14.486035156249997],[-2.113232421874983,14.16845703125],[-2.457226562499983,14.274121093749997],[-3.198437499999983,13.6728515625],[-3.3017578125,13.28076171875],[-3.5757812499999773,13.194189453124991],[-4.051171874999994,13.382421874999991],[-4.328710937499977,13.119042968749994],[-4.227099609374989,12.793701171875],[-4.480615234374994,12.672216796874991],[-4.4287109375,12.337597656249997],[-4.797949218749977,12.032128906249994],[-5.288134765624989,11.827929687499989],[-5.299853515624989,11.205957031249994],[-5.490478515625,11.042382812499994],[-5.457080078124989,10.771386718749994],[-5.523535156249977,10.426025390625],[-5.556591796874983,10.43994140625],[-5.694287109374983,10.433203124999991],[-5.843847656249977,10.389550781249994],[-5.907568359374977,10.307226562499991],[-6.034570312499994,10.19482421875],[-6.482617187499983,10.561230468749997],[-6.950341796874994,10.342333984374989],[-7.385058593749989,10.340136718749989],[-7.6611328125,10.427441406249997],[-7.749072265624989,10.34228515625],[-7.814208984375,10.236572265625],[-7.884082031249989,10.185742187499997],[-7.9609375,10.163476562499994],[-7.990624999999994,10.162499999999994],[-7.974462890624977,10.229541015624989],[-8.007275390624983,10.321874999999991],[-8.231494140624989,10.43798828125],[-8.407470703125,11.386279296874989],[-8.822021484375,11.673242187499994],[-9.043066406249977,12.40234375],[-9.820703124999994,12.04248046875],[-10.274853515624983,12.212646484375],[-10.677343749999977,11.8994140625],[-10.933203124999977,12.205175781249991],[-11.30517578125,12.015429687499989],[-11.389404296875,12.404394531249991],[-11.390380859375,12.941992187499991],[-11.634960937499983,13.369873046875],[-12.05419921875,13.633056640625],[-12.019189453124994,14.206494140624997],[-12.280615234374977,14.809033203124997],[-12.104687499999983,14.745361328125],[-11.872851562499989,14.995166015625003],[-11.842236328124983,15.12939453125],[-11.828759765624994,15.244873046875],[-11.760156249999994,15.425537109375],[-11.675878906249977,15.512060546874991],[-11.502685546875,15.636816406249991],[-11.455224609374994,15.625390624999994],[-10.895605468749977,15.150488281249991],[-10.815087890624994,15.28173828125],[-10.696582031249989,15.422656250000003],[-9.94140625,15.373779296875],[-9.293701171875,15.502832031249994],[-8.171240234374977,15.496142578125003],[-6.335742187499989,15.496191406249991],[-6.131787109374983,15.496240234374994],[-5.723876953125,15.496289062499997],[-5.512499999999989,15.496289062499997],[-5.359912109374989,16.282861328124994],[-5.509619140624977,16.442041015624994],[-5.628662109375,16.568652343750003],[-5.65625,16.8095703125],[-5.684765624999983,17.058251953124994],[-5.713183593749989,17.306884765625],[-5.74169921875,17.555566406249994],[-5.827099609374983,18.301562500000003],[-5.855566406249977,18.550244140624997],[-5.884082031249989,18.798876953125003],[-5.941015624999977,19.296191406250003],[-5.969482421875,19.544873046874997],[-5.997949218749994,19.793505859375003],[-6.083398437499994,20.539501953124997],[-6.396582031249977,23.274804687499994],[-6.482031249999977,24.020800781250003],[-6.538964843749994,24.51816406249999],[-6.5673828125,24.766796874999997],[-6.594091796874977,24.99462890625],[-6.287207031249977,24.994824218749997],[-5.959814453124977,24.99497070312499],[-5.172900390624989,24.995410156250003],[-4.822607421874977,24.99560546875],[-3.2578613281249886,23.981250000000003],[-1.29296875,22.696533203125],[1.1455078125,21.102246093749997],[1.1657226562500114,20.817431640625003],[1.6854492187500227,20.378369140624997],[2.2193359375000057,20.247802734375],[2.4061523437500227,20.063867187499994],[3.2037109375000057,19.789697265624994],[3.255859375,19.410937500000003],[3.1060546875000057,19.150097656249997],[3.40087890625,18.988427734374994],[4.227636718750006,19.142773437499997]]]
},properties:{name:"Mali",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[101.1388671875001,21.567480468749977],[100.92753906250002,21.3662109375],[100.81953125000004,21.31420898437497],[100.75664062500002,21.312646484375023],[100.70312500000003,21.251367187499966],[100.65917968749997,21.13037109375],[100.613671875,21.059326171875],[100.56660156250004,21.038183593750063],[100.53613281250003,20.992382812499955],[100.24931640625002,20.730273437500045],[100.12246093750005,20.316650390625057],[99.8903320312501,20.424414062499977],[99.33789062499997,20.078906250000017],[99.02070312500004,20.041796875000017],[98.9166992187501,19.77290039062504],[98.23906250000002,19.69067382812497],[97.816796875,19.459960937500057],[97.75400390625006,18.620800781249983],[97.48496093750006,18.494238281250034],[97.79296875000003,17.681250000000063],[98.4388671875,16.975683593750034],[98.68925781250002,16.30541992187497],[98.56523437500007,15.403564453125014],[98.19101562500012,15.204101562499972],[98.24599609375005,14.814746093750045],[99.13681640625006,13.716699218749994],[99.21982421875012,12.73974609375],[99.40507812500002,12.547900390625003],[99.61474609374997,11.781201171875026],[99.1901367187501,11.105273437499989],[98.7572265625,10.660937499999974],[98.70253906250005,10.19038085937504],[98.46494140625006,10.675830078124989],[98.67558593750007,10.986914062500034],[98.74140625000004,11.591699218749966],[98.57597656250002,13.161914062500031],[98.24541015625002,13.733496093750034],[97.81230468750007,14.858935546874989],[97.7103515625,15.875537109375074],[97.58427734375007,16.019580078125017],[97.61962890624997,16.537207031250034],[97.37587890625005,16.52294921874997],[97.17832031250012,17.06201171875003],[96.62246093750005,16.563916015624983],[95.76328125000006,16.169042968750006],[95.38955078125005,15.722753906250034],[94.9425781250001,15.818261718750023],[94.58750000000006,16.28881835937497],[94.21425781250005,16.126611328124966],[94.58896484375006,17.5693359375],[94.43076171875012,18.20166015625003],[94.07001953125004,18.893408203125006],[93.70546875000005,19.026904296875017],[93.99814453125006,19.440869140624983],[93.36230468750003,20.05830078125001],[93.00195312499997,20.074853515624994],[92.73564453125007,20.56269531250001],[92.32412109375,20.791845703125063],[92.17958984375005,21.293115234375023],[92.5934570312501,21.46733398437499],[92.57490234375004,21.978076171875045],[92.77138671875,22.104785156250017],[93.07060546875002,22.20942382812501],[93.16201171875,22.360205078125006],[93.07871093750006,22.71821289062501],[93.20390625000002,23.03701171875005],[93.34941406250007,23.08496093750003],[93.36601562500007,23.132519531249955],[93.41494140625,23.68208007812501],[93.32626953125006,24.064208984375057],[93.45214843750003,23.987402343750034],[93.68339843750007,24.00654296875004],[94.07480468750006,23.8720703125],[94.37724609375002,24.473730468750006],[94.49316406250003,24.637646484374983],[94.70371093750012,25.097851562499955],[94.66777343750007,25.458886718749966],[94.99199218750002,25.77045898437504],[95.01523437500006,25.912939453125006],[95.0929687500001,25.98730468749997],[95.13242187500006,26.041259765625057],[95.12929687500005,26.070410156250034],[95.10839843749997,26.091406250000034],[95.06894531250006,26.19111328125001],[95.0597656250001,26.473974609375006],[95.20146484375007,26.641406250000017],[96.19082031250005,27.26127929687499],[96.79785156249997,27.29619140624999],[96.96279296875,27.698291015625017],[97.04970703125005,27.760009765625],[97.34355468750002,27.982324218749994],[97.30273437499997,28.08598632812496],[97.3224609375001,28.21796875000004],[97.35644531249997,28.254492187500006],[97.43144531250002,28.353906250000023],[97.53789062500002,28.510205078124983],[98.09892578125002,28.142285156249983],[98.29882812499997,27.550097656250045],[98.65117187500007,27.572460937499983],[98.7318359375,26.583398437499994],[98.6546875,25.917773437500017],[98.01074218749997,25.292529296875017],[97.8195312500001,25.251855468749994],[97.53144531250004,24.49169921875003],[97.68603515624997,23.898095703124966],[98.21250000000006,24.110644531250017],[98.76435546875004,24.116064453125063],[98.86376953125003,23.191259765625034],[99.34082031249997,23.095898437499955],[99.33769531250002,22.49804687500003],[99.19296875000006,22.12597656249997],[99.9176757812501,22.02802734375001],[100.21474609375,21.462988281250006],[100.83515625000004,21.655175781249994],[101.1388671875001,21.567480468749977]]]},properties:{name:"Myanmar",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[19.670996093750006,43.163964843749994],[20.344335937500006,42.827929687499996],[20.06396484375,42.547265624999994],[19.65449218750001,42.628564453124994],[19.280664062500023,42.17255859375],[19.342382812500006,41.869091796875],[18.436328125000017,42.559716796874994],[18.46601562500001,42.777246093749994],[18.674218750000023,43.230810546875],[18.74921875000001,43.283544921875],[18.85107421875,43.346337890624994],[19.036718750000006,43.357324218749994],[18.940234375000017,43.496728515624994],[19.21875,43.449951171875],[19.670996093750006,43.163964843749994]]]},properties:{name:"Montenegro",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[116.68330078125001,49.823779296874996],[115.95380859375001,48.689355468749994],[115.82050781250001,48.57724609375],[115.79169921875001,48.455712890624994],[115.79658203125001,48.346337890624994],[115.78554687500002,48.2482421875],[115.63945312499999,48.18623046875],[115.52509765625001,48.130859375],[115.5576171875,47.94501953125],[115.61640625000001,47.874804687499996],[115.71171874999999,47.79892578125],[115.89824218749999,47.686914062499994],[115.99384765625001,47.711328124999994],[116.07480468750003,47.78955078125],[116.23115234375001,47.858203124999996],[116.31718749999999,47.85986328125],[116.37822265624999,47.844042968749996],[116.51347656249999,47.83955078125],[116.65195312500003,47.864501953125],[116.76054687499999,47.869775390624994],[116.90117187499999,47.853076171874996],[116.95166015625,47.836572265624994],[117.06972656250002,47.806396484375],[117.19707031249999,47.740283203124996],[117.28593749999999,47.666357421875],[117.35078125000001,47.652197265625],[117.38398437500001,47.675732421875],[117.455078125,47.741357421874994],[117.55537109375001,47.8046875],[117.67666015625002,47.90830078125],[117.76835937499999,47.987890625],[118.49843750000002,47.983984375],[119.71113281250001,47.15],[119.89785156250002,46.857812499999994],[119.8671875,46.672167968749996],[119.74746093750002,46.627197265625],[119.70664062500003,46.606005859374996],[119.62021484375003,46.603955078125],[119.47402343750002,46.62666015625],[119.162109375,46.638671875],[118.95712890625003,46.73486328125],[118.84394531250001,46.760205078125],[118.30869140625003,46.717041015625],[117.91044921874999,46.6193359375],[117.8134765625,46.5376953125],[117.67109375000001,46.5220703125],[117.33339843750002,46.36201171875],[116.97880859374999,46.361767578125],[116.85908203125001,46.387939453125],[116.78701171875002,46.37666015625],[116.68886718750002,46.32197265625],[116.56259765625003,46.289794921875],[116.21298828125003,45.8869140625],[116.22910156250003,45.845751953124996],[116.24062500000002,45.79599609375],[115.68105468750002,45.458251953125],[115.16259765625,45.390234375],[114.91923828124999,45.378271484375],[114.73876953125,45.41962890625],[114.64433593749999,45.41328125],[114.56015625000003,45.389990234375],[114.51718750000003,45.364599609375],[114.41914062500001,45.202587890625],[114.0302734375,44.942578125],[113.87705078125003,44.89619140625],[113.65263671874999,44.763476562499996],[113.58701171875003,44.745703125],[113.04941406250003,44.810351562499996],[112.70673828125001,44.883447265624994],[112.59677734375003,44.91767578125],[112.49931640624999,45.0109375],[112.41132812500001,45.058203125],[112.11289062500003,45.062939453125],[112.03261718750002,45.081640625],[111.89804687500003,45.0640625],[111.40224609375002,44.36728515625],[111.8369140625,43.93466796875],[111.93173828125003,43.81494140625],[111.94287109375,43.75244140625],[111.93320312500003,43.71142578125],[111.87812500000001,43.68017578125],[111.77109375000003,43.664599609374996],[111.7197265625,43.621142578124996],[111.64082031250001,43.56318359375],[111.54736328125,43.4962890625],[111.50351562500003,43.4927734375],[111.00722656250002,43.34140625],[110.400390625,42.773681640625],[109.44316406249999,42.455957031249994],[109.33984375,42.438378906249994],[108.68730468749999,42.41611328125],[108.17119140624999,42.447314453124996],[106.77001953125,42.288720703124994],[105.86757812500002,41.993994140625],[105.31435546875002,41.770898437499994],[105.19707031249999,41.738037109375],[104.49824218750001,41.65869140625],[104.49824218750001,41.877001953124996],[104.30517578125,41.846142578125],[103.99726562500001,41.79697265625],[103.71113281250001,41.751318359375],[103.07285156250003,42.00595703125],[101.97294921874999,42.215869140624996],[101.7138671875,42.4658203125],[99.98378906250002,42.67734375],[99.46787109375003,42.568212890625],[97.20566406250003,42.789794921875],[96.38544921875001,42.720361328124994],[95.91250000000002,43.206494140625],[95.85957031250001,43.2759765625],[95.84199218750001,43.383691406249994],[95.52558593750001,43.953955078125],[95.3564453125,44.00595703125],[95.35029296875001,44.278076171875],[94.71201171875003,44.350830078125],[93.65644531250001,44.9009765625],[92.78789062499999,45.0357421875],[92.57890624999999,45.010986328125],[92.423828125,45.008935546874994],[92.17265624999999,45.03525390625],[92.02978515625,45.068505859374994],[91.58437500000002,45.076513671875],[91.51005859374999,45.0982421875],[91.44101562500003,45.124755859375],[91.31210937500003,45.118115234375],[91.05000000000001,45.217431640624994],[90.87724609374999,45.196093749999996],[90.66181640625001,45.525244140625],[91.00175781249999,46.035791015624994],[91.03388671875001,46.52900390625],[90.86992187499999,46.954492187499994],[90.49619140625003,47.28515625],[90.31328124999999,47.676171874999994],[90.10322265625001,47.745410156249996],[90.02792968750003,47.877685546875],[89.95869140625001,47.886328125],[89.77812499999999,47.827001953125],[89.7255859375,47.852490234375],[89.69316406249999,47.879150390625],[89.63847656249999,47.909082031249994],[89.56093750000002,48.003955078124996],[89.32988281249999,48.024853515625],[89.1962890625,47.980908203125],[89.11562500000002,47.987695312499994],[89.04765624999999,48.0025390625],[88.97109375000002,48.049951171874994],[88.91777343749999,48.089013671874994],[88.83828125000002,48.101708984374994],[88.68183593750001,48.170556640624994],[88.57597656249999,48.220166015625],[88.56679687500002,48.317431640624996],[88.51708984375,48.38447265625],[88.41396484375002,48.40341796875],[88.30996093750002,48.472070312499994],[87.97968750000001,48.555126953125],[87.7431640625,48.881640624999996],[87.85986328125,48.96552734375],[87.87216796875003,49.000146484374994],[87.83466796875001,49.03193359375],[87.81630859375002,49.0802734375],[87.8251953125,49.11630859375],[87.81425781249999,49.1623046875],[87.93476562500001,49.16455078125],[88.02851562500001,49.219775390624996],[88.11572265625,49.256298828125],[88.19257812500001,49.451708984374996],[88.33779296875002,49.472558593749994],[88.39335937499999,49.482861328125],[88.45244140624999,49.472705078124996],[88.54433593750002,49.482568359374994],[88.63320312500002,49.486132812499996],[88.83164062500003,49.4484375],[89.65410156249999,49.71748046875],[89.64384765624999,49.90302734375],[91.80429687500003,50.693603515625],[94.25107421875003,50.556396484375],[94.61474609375,50.023730468749996],[94.67548828125001,50.028076171875],[94.71806640624999,50.043261718749996],[94.93027343750003,50.043749999999996],[95.04433593750002,49.961572265624994],[95.52265625000001,49.91123046875],[95.56718749999999,49.94384765625],[95.70781249999999,49.966015625],[95.78935546874999,50.012499999999996],[95.85195312500002,50.012939453125],[95.8994140625,49.990576171875],[95.93574218750001,49.960009765624996],[96.06552734375003,49.99873046875],[96.31503906250003,49.901123046875],[96.98574218750002,49.8828125],[97.20859375000003,49.730810546875],[97.35976562500002,49.741455078125],[97.58935546875,49.911474609375],[98.10341796875002,50.07783203125],[98.27949218750001,50.533251953124996],[97.82529296875003,50.985253906249994],[97.94687500000003,51.348437499999996],[98.35273437500001,51.717626953125],[98.64052734375002,51.801171875],[98.8486328125,52.070068359375],[99.92167968749999,51.755517578125],[100.03457031250002,51.737109374999996],[100.23037109375002,51.729833984375],[100.46894531250001,51.72607421875],[100.53623046875003,51.7134765625],[101.22324218750003,51.51328125],[101.30449218749999,51.474755859374994],[101.38125000000002,51.45263671875],[101.57089843750003,51.467187499999994],[101.82119140625002,51.421044921874994],[102.11152343750001,51.353466796875],[102.15566406250002,51.313769531249996],[102.16005859375002,51.26083984375],[102.14238281249999,51.216064453125],[102.15195312500003,51.10751953125],[102.21503906250001,50.829443359375],[102.28837890624999,50.585107421874994],[102.68330078125001,50.387158203125],[102.85966796874999,50.333251953125],[103.03945312500002,50.300634765625],[103.16171875000003,50.29072265625],[103.23378906250002,50.2642578125],[103.30439453125001,50.20029296875],[103.63291015625003,50.138574218749994],[103.72324218750003,50.153857421874996],[103.80263671875002,50.176074218749996],[104.1796875,50.16943359375],[104.25996093750001,50.214453125],[104.35390625000002,50.275292968749994],[104.46630859375,50.30615234375],[104.97695312500002,50.38291015625],[105.0947265625,50.389941406249996],[105.38359374999999,50.47373046875],[106.21787109375003,50.304589843749994],[106.36845703124999,50.317578125],[106.57441406250001,50.32880859375],[106.71113281250001,50.31259765625],[106.94130859375002,50.196679687499994],[107.04023437500001,50.086474609374996],[107.14306640625,50.033007812499996],[107.23330078125002,49.989404296874994],[107.34707031250002,49.986669921875],[107.63095703125003,49.98310546875],[107.94785156250003,49.924707031249994],[108.03378906250003,49.593994140625],[108.40693359375001,49.396386718749994],[108.5224609375,49.34150390625],[108.61367187500002,49.322802734374996],[108.73300781250003,49.33564453125],[109.23671875000002,49.334912109375],[109.45371093750003,49.296337890625],[109.52871093750002,49.269873046875],[110.19990234375001,49.17041015625],[110.82792968749999,49.166162109374994],[111.20419921875003,49.304296875],[111.33662109375001,49.355859374999994],[113.05556640625002,49.616259765624996],[113.09208984374999,49.692529296874994],[113.16416015625003,49.797167968749996],[113.31904296875001,49.874316406249996],[113.44550781250001,49.9416015625],[113.57421875,50.00703125],[114.29707031250001,50.2744140625],[114.7431640625,50.233691406249996],[115.27451171875003,49.948876953124994],[116.13457031249999,50.010791015624996],[116.68330078125001,49.823779296874996]]]},properties:{name:"Mongolia",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[32.112890625000006,-26.839453125000006],[32.10595703125,-26.52001953125],[32.04140625000002,-26.28125],[31.9482421875,-25.957617187500006],[31.920312500000023,-25.77392578125],[31.98457031250001,-25.631933593750006],[31.98701171875001,-25.263476562500003],[31.984375,-24.844042968750003],[31.983203125000017,-24.638281250000006],[31.98583984375,-24.46064453125001],[31.858300781250023,-24.04023437500001],[31.799609375000017,-23.892187500000006],[31.54560546875001,-23.48232421875001],[31.287890625000017,-22.40205078125001],[31.429492187500017,-22.298828125],[32.37109375,-21.33486328125001],[32.477636718750006,-20.712988281250006],[33.00673828125002,-19.873828125000003],[32.71650390625001,-19.00185546875001],[32.99306640625002,-18.35957031250001],[32.94804687500002,-16.71230468750001],[32.243261718750006,-16.44873046875],[31.939843750000023,-16.428808593750006],[31.236230468750023,-16.02363281250001],[30.437792968750017,-15.995312500000011],[30.396093750000006,-15.64306640625],[30.231835937500023,-14.990332031250006],[31.728906250000023,-14.49609375],[33.201757812500006,-14.013378906250011],[33.63642578125001,-14.568164062500003],[34.33251953125,-14.408593750000009],[34.50527343750002,-14.59814453125],[34.54082031250002,-15.297265625000009],[34.24824218750001,-15.887500000000003],[34.28828125000001,-15.936132812500006],[34.3759765625,-16.023730468750003],[34.40302734375001,-16.08027343750001],[34.395117187500006,-16.130859375],[34.3955078125,-16.19921875],[34.93339843750002,-16.760351562500006],[35.11210937500002,-16.898535156250006],[35.242773437500006,-16.37539062500001],[35.358496093750006,-16.16054687500001],[35.59931640625001,-16.12587890625001],[35.70888671875002,-16.095800781250006],[35.75527343750002,-16.05830078125001],[35.79121093750001,-15.958691406250011],[35.83027343750001,-15.4189453125],[35.80537109375001,-15.265625],[35.86669921875,-14.86376953125],[35.84716796875,-14.6708984375],[35.6904296875,-14.465527343750011],[35.48847656250001,-14.201074218750009],[35.37578125000002,-14.058691406250006],[35.24746093750002,-13.896875000000009],[34.54570312500002,-13.21630859375],[34.542578125000006,-13.108691406250003],[34.36083984375,-12.210546875000006],[34.60625000000002,-11.690039062500006],[34.65957031250002,-11.588671875000003],[34.82656250000002,-11.57568359375],[34.95947265625,-11.578125],[35.1826171875,-11.574804687500006],[35.41826171875002,-11.583203125000011],[35.50439453125,-11.604785156250003],[35.56435546875002,-11.602343750000003],[35.630957031250006,-11.58203125],[35.78544921875002,-11.452929687500003],[35.91132812500001,-11.454687500000006],[36.08222656250001,-11.537304687500011],[36.17548828125001,-11.609277343750009],[36.19130859375002,-11.670703125000003],[36.3056640625,-11.706347656250003],[36.518652343750006,-11.716210937500009],[36.673828125,-11.684277343750011],[36.771093750000006,-11.6103515625],[36.872656250000006,-11.5712890625],[36.97890625000002,-11.566992187500006],[37.54169921875001,-11.675097656250003],[37.92021484375002,-11.294726562500003],[38.491796875000006,-11.413281250000011],[38.79472656250002,-11.228906250000009],[38.98750000000001,-11.167285156250003],[39.170996093750006,-11.166894531250009],[39.32158203125002,-11.12255859375],[39.5634765625,-10.978515625],[39.81708984375001,-10.912402343750003],[39.98867187500002,-10.82080078125],[40.46357421875001,-10.46435546875],[40.544531250000006,-11.065625000000011],[40.40283203125,-11.33203125],[40.58085937500002,-12.635546875000003],[40.54511718750001,-13.462890625],[40.63994140625002,-14.390039062500009],[40.83515625000001,-14.79150390625],[40.55898437500002,-15.473437500000003],[40.10878906250002,-15.979296875000003],[39.84462890625002,-16.435644531250006],[39.08437500000002,-16.97285156250001],[38.14492187500002,-17.242773437500006],[37.24453125000002,-17.73994140625001],[36.540136718750006,-18.518164062500006],[35.65126953125002,-19.163867187500003],[34.947851562500006,-19.81269531250001],[34.75576171875002,-19.82197265625001],[34.69814453125002,-20.404394531250006],[34.98232421875002,-20.806250000000006],[35.267675781250006,-21.650976562500006],[35.31572265625002,-22.39687500000001],[35.57539062500001,-22.96308593750001],[35.37041015625002,-23.79824218750001],[35.438085937500006,-24.171191406250003],[35.15595703125001,-24.54140625000001],[34.60732421875002,-24.8212890625],[33.34746093750002,-25.26093750000001],[32.79218750000001,-25.644335937500003],[32.590429687500006,-26.00410156250001],[32.93359375,-26.25234375000001],[32.88916015625,-26.83046875000001],[32.88613281250002,-26.84931640625001],[32.353515625,-26.861621093750003],[32.19960937500002,-26.83349609375],[32.112890625000006,-26.839453125000006]]]},properties:{name:"Mozambique",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[-5.359912109374989,16.282861328124994],[-5.512499999999989,15.496289062499983],[-5.723876953124972,15.496289062499983],[-6.131787109374926,15.496240234374966],[-6.335742187500017,15.496191406250063],[-8.17124023437492,15.496142578125045],[-9.293701171875,15.502832031249994],[-9.941406249999972,15.373779296874986],[-10.696582031249989,15.422656250000003],[-10.895605468749949,15.150488281249977],[-10.9482421875,15.151123046875014],[-11.007421874999977,15.222900390624986],[-11.169335937500023,15.358642578125014],[-11.455224609374994,15.625390624999994],[-11.760156249999937,15.425537109375057],[-11.828759765624966,15.244873046875014],[-11.842236328124955,15.129394531250028],[-11.872851562499989,14.995166015625031],[-12.104687499999955,14.745361328125043],[-12.40869140625,14.889013671874991],[-12.858496093749977,15.242529296874977],[-13.105273437499989,15.57177734375],[-13.40966796875,16.059179687500006],[-13.756640624999989,16.172509765624994],[-14.300097656249932,16.58027343750001],[-15.11264648437492,16.64492187500005],[-15.768212890624994,16.485107421875],[-16.168359374999966,16.54707031250001],[-16.34667968749997,16.926416015625023],[-16.07890624999996,17.54584960937501],[-16.084960937499943,18.52119140625001],[-16.213085937499926,19.003320312500023],[-16.51445312499996,19.361962890624994],[-16.283398437499955,19.787158203125017],[-16.21044921875003,20.227929687500023],[-16.42978515624995,20.652343750000057],[-17.06396484375,20.898828124999994],[-16.96455078125001,21.329248046875023],[-15.231201171875,21.331298828125],[-13.855371093749937,21.332958984374983],[-13.396728515624943,21.333544921875017],[-13.167431640624926,21.333789062500074],[-13.016210937499949,21.33393554687501],[-13.025097656249983,21.46679687499997],[-13.032226562500028,21.572070312500017],[-13.041748046875,21.71381835937504],[-13.051220703124983,21.854785156250074],[-13.094335937499977,22.49599609375005],[-13.107324218749937,22.56074218750001],[-13.155957031250011,22.689306640625006],[-13.166503906250028,22.753222656250045],[-13.153271484374983,22.820507812499983],[-13.12089843749996,22.884082031250074],[-13.031494140624943,23.000244140625],[-12.372900390624977,23.318017578124994],[-12.023437499999943,23.467578125000017],[-12.016308593749983,23.97021484375],[-12.016308593749983,24.378662109375],[-12.016308593749983,24.923242187499994],[-12.016308593749983,25.331689453124994],[-12.016308593749983,25.740136718749994],[-12.016308593749983,25.995410156250017],[-10.562451171874926,25.995458984375034],[-9.81718749999996,25.995458984375034],[-9.258203124999966,25.99550781250005],[-8.885644531249994,25.99550781250005],[-8.682226562499949,25.99550781250005],[-8.68212890625,26.109472656250006],[-8.68212890625,26.273193359375057],[-8.682324218749955,26.49770507812505],[-8.683349609375,27.285937500000045],[-6.2386718749999375,25.848193359375045],[-4.822607421874949,24.99560546875],[-5.172900390624989,24.995410156250045],[-5.959814453124977,24.994970703125063],[-6.287207031249977,24.99482421875001],[-6.594091796874977,24.99462890624997],[-6.396582031249977,23.274804687499994],[-6.0833984374999375,20.539501953124983],[-5.9979492187499375,19.793505859375045],[-5.969482421875,19.54487304687504],[-5.941015624999977,19.29619140624999],[-5.884082031250017,18.798876953125017],[-5.855566406249977,18.550244140624983],[-5.8270996093749545,18.301562500000045],[-5.741699218749943,17.555566406250023],[-5.713183593750017,17.306884765625],[-5.684765624999983,17.058251953124966],[-5.628662109375028,16.568652343750045],[-5.50961914062492,16.442041015625023],[-5.359912109374989,16.282861328124994]]]},properties:{name:"Mauritania",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[34.95947265625003,-11.578125000000028],[34.82656250000005,-11.575683593749972],[34.65957031250005,-11.58867187499996],[34.61855468750005,-11.620214843749991],[34.60625000000002,-11.690039062500006],[34.36083984375003,-12.210546874999991],[34.542578125000006,-13.108691406250003],[34.54570312500002,-13.21630859375],[35.247460937499994,-13.896874999999994],[35.37578125000002,-14.05869140625002],[35.48847656250004,-14.20107421874998],[35.69042968749997,-14.465527343750026],[35.84716796875003,-14.670898437500043],[35.86669921875003,-14.863769531249986],[35.83027343750004,-15.418945312500028],[35.7912109375001,-15.958691406250026],[35.75527343750005,-16.058300781249983],[35.708886718749994,-16.095800781249977],[35.5993164062501,-16.12587890624998],[35.35849609375006,-16.160546875000023],[35.242773437500006,-16.37539062500001],[35.11210937500002,-16.898535156250006],[34.93339843750002,-16.760351562500006],[34.39550781249997,-16.19921875],[34.39511718750006,-16.130859375000014],[34.4030273437501,-16.08027343750001],[34.37597656249997,-16.02373046874996],[34.2482421875001,-15.887500000000003],[34.54082031250002,-15.297265625000009],[34.50527343750005,-14.598144531249957],[34.33251953125003,-14.40859374999998],[33.63642578125004,-14.568164062499974],[33.148046875000006,-13.94091796875],[32.797460937500006,-13.6884765625],[32.67207031250004,-13.610351562499986],[32.851855468750074,-13.457031250000014],[32.96757812500002,-13.224999999999994],[32.99999999999997,-12.89960937500004],[32.97050781250002,-12.864746093749957],[32.945605468750074,-12.804394531250011],[33.021582031250006,-12.63046875000002],[33.24345703125002,-12.556542968749966],[33.39794921874997,-12.489843749999963],[33.43066406249997,-12.460449218750014],[33.48320312500002,-12.403417968750034],[33.4914062500001,-12.331054687499943],[33.25234375000005,-12.112597656250031],[33.226367187500074,-11.534863281250011],[33.23271484375002,-11.417675781250026],[33.26835937500002,-11.403906249999977],[33.379785156249994,-11.15791015625004],[33.338671875000074,-11.085156249999969],[33.29326171875002,-10.981152343749997],[33.27275390625002,-10.915039062499943],[33.261328125000006,-10.893359374999974],[33.29277343750002,-10.85234374999996],[33.3449218750001,-10.812695312499969],[33.464746093749994,-10.78310546874998],[33.65908203125005,-10.590527343749997],[33.528906250000006,-10.234667968749974],[33.31152343750003,-10.037988281249966],[33.3371093750001,-9.954003906249994],[33.350976562499994,-9.862207031250037],[33.148046875000006,-9.603515625],[32.91992187500003,-9.407421875000026],[34.32089843750006,-9.731542968749977],[34.524218750000074,-10.03017578124998],[34.66181640625004,-10.71005859375002],[34.59765625000003,-11.037500000000023],[34.77382812500005,-11.341699218750009],[34.93701171874997,-11.463476562500034],[34.95263671874997,-11.54374999999996],[34.95947265625003,-11.578125000000028]]]},properties:{name:"Malawi",childNum:1}},{geometry:{type:"MultiPolygon",coordinates:[[[[102.10107421874997,6.242236328125031],[102.98242187499997,5.524951171875003],[103.41582031250007,4.85029296875004],[103.46875000000003,4.393261718750011],[103.36201171875004,3.769140624999963],[103.43945312499997,2.93310546875],[103.8122070312501,2.5804687500000085],[104.28847656250005,1.4806640625000398],[103.6945312500001,1.4496582031250256],[102.72714843750012,1.855566406250034],[101.29550781250012,2.8852050781250114],[101.29990234375012,3.253271484375034],[100.71542968750006,3.966210937499966],[100.61455078125002,4.652246093750023],[100.35263671875006,5.587695312499989],[100.34326171874997,5.984179687500031],[100.11914062499997,6.441992187500048],[100.3454101562501,6.549902343750006],[101.05351562500002,6.2425781250000085],[101.2570312500001,5.7893554687500455],[101.5560546875,5.907763671875003],[101.87363281250012,5.8252929687499915],[102.10107421874997,6.242236328125031]]],[[[117.5744140625001,4.17060546875004],[117.10058593750003,4.337060546875023],[115.89619140625004,4.348681640624989],[115.56845703125006,3.9387695312499744],[115.45439453125002,3.0343261718750085],[115.086328125,2.8411132812499886],[115.1791015625,2.5231933593749716],[114.78642578125002,2.250488281250014],[114.83056640625003,1.9800292968749886],[114.54589843750003,1.467138671875034],[113.90234375000003,1.4342773437499972],[113.6222656250001,1.2359375000000057],[112.47617187500006,1.5590820312500284],[112.1857421875001,1.4390624999999915],[112.078515625,1.1433593749999744],[111.76972656250004,.9994628906249687],[110.93808593750006,1.0173339843750568],[110.50576171875005,.8619628906250227],[109.65400390625004,1.6148925781250227],[109.62890625000003,2.027539062499983],[109.9845703125001,1.7176269531249915],[110.34921875000012,1.7197265624999716],[110.93994140625003,1.5173339843750426],[111.15419921875005,1.7387695312500426],[111.24218749999997,2.4357421875000114],[111.72773437500004,2.853808593750003],[112.73730468749997,3.0704589843749943],[113.04472656250002,3.2052246093750085],[113.92392578125006,4.243212890625003],[114.0638671875,4.592675781249966],[114.60830078125005,4.023974609375017],[114.84023437500005,4.3932128906250085],[114.74667968750006,4.718066406250017],[115.02675781250005,4.899707031249989],[115.1400390625,4.8997558593749915],[115.51982421875002,5.048925781250006],[115.41904296875012,5.413183593749963],[115.79687499999997,5.536132812499972],[116.1383789062501,6.12954101562498],[116.49472656250006,6.521679687500026],[117.29404296875006,6.676904296875023],[117.64570312500004,6.473681640625017],[117.61718750000003,5.940722656249974],[118.00380859375,6.0533203124999915],[118.11582031250006,5.862500000000026],[118.59482421875006,5.592089843750003],[119.22343750000007,5.412646484375031],[119.13222656250005,5.100488281250037],[118.18535156250002,4.828515625000051],[118.49804687499997,4.362353515625031],[117.5744140625001,4.17060546875004]]]]},properties:{name:"Malaysia",childNum:2}},{geometry:{type:"Polygon",coordinates:[[[23.380664062500017,-17.640625],[24.27490234375,-17.481054687500006],[24.932421875000017,-17.54345703125],[25.2587890625,-17.793554687500006],[24.358984375000006,-17.97822265625001],[23.58056640625,-18.452929687500003],[23.298632812500017,-18.02734375],[20.97412109375,-18.31884765625],[20.976171875000006,-19.74433593750001],[20.970996093750017,-22.00019531250001],[19.977343750000017,-22.00019531250001],[19.98046875,-24.77675781250001],[19.98046875,-26.53115234375001],[19.98046875,-28.310351562500003],[19.02607421875001,-28.92792968750001],[18.310839843750017,-28.88623046875],[17.44794921875001,-28.69814453125001],[17.1884765625,-28.13251953125001],[17.1494140625,-28.08222656250001],[17.056250000000006,-28.031054687500003],[16.93330078125001,-28.069628906250003],[16.875292968750017,-28.1279296875],[16.841210937500023,-28.21894531250001],[16.810156250000006,-28.26455078125001],[16.787500000000023,-28.39472656250001],[16.755761718750023,-28.4521484375],[16.447558593750017,-28.61757812500001],[15.719042968750017,-27.9658203125],[15.341503906250011,-27.386523437500003],[14.9677734375,-26.31806640625001],[14.84521484375,-25.725683593750006],[14.837109375000011,-25.033203125],[14.501562500000006,-24.201953125000003],[14.473828125000011,-23.28115234375001],[14.525976562500006,-22.70253906250001],[14.321875000000006,-22.18994140625],[13.973242187500006,-21.767578125],[13.450585937500023,-20.91669921875001],[13.168359375000023,-20.184667968750006],[12.458203125000011,-18.9267578125],[12.095703125,-18.54091796875001],[11.77587890625,-18.001757812500003],[11.733496093750006,-17.7509765625],[11.743066406250023,-17.24921875000001],[11.902539062500011,-17.2265625],[12.013964843750017,-17.168554687500006],[12.21337890625,-17.2099609375],[12.359277343750023,-17.205859375000003],[12.548144531250017,-17.212695312500003],[13.101171875000006,-16.96767578125001],[13.403710937500023,-17.0078125],[13.93798828125,-17.388769531250006],[15.765820312500011,-17.3896484375],[16.1484375,-17.390234375000006],[16.531054687500017,-17.39082031250001],[16.913671875000006,-17.391406250000003],[17.296289062500023,-17.39199218750001],[17.835351562500023,-17.39277343750001],[18.396386718750023,-17.3994140625],[18.718066406250017,-17.703222656250006],[18.825976562500017,-17.76630859375001],[19.076464843750017,-17.817675781250003],[20.392968750000023,-17.88740234375001],[20.507617187500017,-17.95253906250001],[20.625097656250006,-17.996679687500006],[21.416894531250023,-18.00068359375001],[21.960839843750023,-17.90517578125001],[22.32421875,-17.837500000000006],[22.6240234375,-17.78164062500001],[23.068261718750023,-17.698828125000006],[23.380664062500017,-17.640625]]]
},properties:{name:"Namibia",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[164.20234375000004,-20.246093749999957],[164.4359375,-20.282226562499957],[165.191796875,-20.768847656249974],[165.66279296875004,-21.267187499999977],[166.94238281250003,-22.09013671875003],[166.77412109375004,-22.37617187500004],[166.09609375,-21.95664062500002],[165.24199218750002,-21.52548828125002],[164.45468750000012,-20.829101562499986],[164.16972656250007,-20.48017578125004],[164.20234375000004,-20.246093749999957]]]},properties:{name:"France",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[14.97900390625,22.99619140624999],[15.172265625000023,21.922070312499997],[15.181835937500011,21.523388671874997],[15.607324218750023,20.954394531250003],[15.587109375000011,20.733300781249994],[15.948828125000006,20.303173828124997],[15.735058593750011,19.904052734375],[15.474316406250011,16.908398437499997],[14.367968750000017,15.750146484374994],[13.4482421875,14.380664062500003],[13.505761718750023,14.134423828124994],[13.606347656250023,13.70458984375],[13.426953125000011,13.701757812499991],[13.323828125000006,13.670849609374997],[12.65478515625,13.326562499999994],[12.463183593750017,13.09375],[11.411914062500017,13.353613281249991],[10.958886718750023,13.371533203124997],[10.475878906250017,13.330224609374994],[10.229589843750006,13.281005859375],[10.184667968750006,13.270117187499991],[9.615917968750011,12.810644531249991],[9.201562500000023,12.821484374999997],[8.750585937500006,12.908154296874997],[8.4560546875,13.059667968749991],[8.095019531250017,13.291162109374994],[7.955761718750011,13.32275390625],[7.788671875000006,13.337890625],[7.056738281250006,13.000195312499997],[6.804296875000006,13.107666015625],[6.386328125000006,13.603613281249991],[6.2998046875,13.658789062499991],[6.184277343750011,13.663671874999991],[5.838183593750017,13.765380859375],[5.491992187500017,13.872851562500003],[5.415820312500017,13.859179687500003],[5.361621093750017,13.836865234374997],[5.241894531250011,13.757226562499994],[4.823339843750006,13.759765625],[4.147558593750006,13.457714843749997],[3.9478515625000057,12.775048828124994],[3.6466796875000114,12.529980468749997],[3.618457031250017,11.827734374999991],[3.5954101562500114,11.6962890625],[3.4498046875000057,11.851953124999994],[3.3599609375000057,11.880468749999991],[2.8781250000000114,12.367724609374989],[2.366015625000017,12.221923828125],[2.38916015625,11.897070312499991],[2.0914062500000057,12.277978515624994],[2.0738281250000057,12.713964843749991],[1.56494140625,12.635400390624994],[.9873046875,13.041894531249994],[.9777343750000114,13.551953124999997],[.6181640625,13.703417968750003],[.16386718750001705,14.497216796874994],[.21748046875001137,14.911474609374991],[.9600585937500057,14.986914062499991],[1.3001953125000227,15.272265625000003],[3.5042968750000227,15.356347656249994],[3.876953125,15.755273437499994],[4.121289062500011,16.357714843750003],[4.234667968750017,16.996386718750003],[4.227636718750006,19.142773437499997],[5.836621093750011,19.479150390624994],[7.481738281250017,20.873095703125003],[9.378710937500017,21.991406249999997],[11.967871093750006,23.517871093750003],[13.481250000000017,23.18017578125],[14.230761718750017,22.618457031250003],[14.97900390625,22.99619140624999]]]},properties:{name:"Niger",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[6.804296875000006,13.107666015625],[7.056738281250006,13.00019531250004],[7.788671875000006,13.337890625],[7.955761718750011,13.322753906250028],[8.095019531250045,13.29116210937498],[8.750585937500034,12.908154296875026],[9.20156250000008,12.82148437500004],[9.615917968750011,12.810644531249963],[10.184667968750063,13.270117187499963],[10.229589843749977,13.281005859375043],[10.475878906250074,13.330224609375037],[10.958886718750051,13.371533203125011],[11.411914062500074,13.353613281250006],[12.463183593750017,13.09375],[12.654785156250057,13.326562500000009],[13.323828125000034,13.670849609374983],[13.426953125000068,13.701757812499963],[13.606347656250023,13.704589843750014],[13.932324218750011,13.258496093749997],[14.06396484375,13.078515625000009],[14.160058593750023,12.612792968749986],[14.184863281250017,12.447216796874997],[14.272851562500023,12.356494140624989],[14.627148437500068,12.10869140624996],[14.559765625000011,11.492285156249963],[13.892089843750057,11.140087890624983],[13.53535156250004,10.605078124999963],[13.269921875000051,10.036181640624974],[13.175488281250011,9.539648437499977],[12.929492187500074,9.426269531249972],[12.651562500000011,8.667773437499989],[12.40351562500004,8.59555664062502],[12.311328125000074,8.419726562499989],[12.2333984375,8.282324218749977],[12.016015625000051,7.5897460937500085],[11.809179687500006,7.3450683593749915],[11.767382812500017,7.272265624999989],[11.551660156250023,6.697265625],[11.153320312500057,6.437939453125011],[11.079687500000063,6.505517578125023],[11.032519531250045,6.697900390625037],[10.954199218750006,6.776562499999997],[10.606250000000074,7.063085937500006],[10.143554687500057,6.99643554687502],[10.038867187500045,6.921386718750014],[9.874218750000068,6.803271484375017],[9.82070312500008,6.783935546874986],[9.779882812500034,6.760156250000023],[9.725585937499972,6.649999999999963],[9.659960937500017,6.531982421874986],[9.490234375,6.418652343749997],[8.997167968750006,5.917724609375],[8.800976562499983,5.197460937499983],[8.293066406250006,4.557617187500014],[7.15468750000008,4.514404296875],[6.757031250000068,4.343554687500017],[6.07656250000008,4.290624999999977],[5.587792968750051,4.647216796874972],[5.232421875000057,5.483789062499966],[4.861035156250068,6.026318359374997],[4.431347656250011,6.348583984375026],[4.125878906250023,6.411376953125028],[2.706445312500051,6.369238281249963],[2.7356445312500455,6.595703125],[2.7537109374999886,6.661767578124966],[2.774609374999983,6.711718750000017],[2.7529296875000284,6.771630859374966],[2.7317382812500455,6.852832031249989],[2.721386718750068,6.980273437500017],[2.750488281250057,7.39506835937496],[2.686035156250057,7.873730468750054],[2.703125,8.371826171875],[2.7748046875000227,9.048535156250026],[3.044921875,9.08383789062502],[3.3251953124999716,9.778466796875051],[3.5572265625000057,9.907324218750006],[3.6465820312500057,10.408984374999989],[3.83447265625,10.607421875],[3.7568359375,10.768749999999997],[3.7164062500000057,11.07958984375],[3.63886718750004,11.176855468750006],[3.4877929687499716,11.395410156250037],[3.490527343750017,11.499218750000054],[3.55390625000004,11.631884765624989],[3.595410156250068,11.696289062500057],[3.6184570312500455,11.827734375000006],[3.6466796875000114,12.529980468749983],[3.9478515625000057,12.775048828124994],[4.147558593750006,13.457714843749983],[4.823339843750006,13.759765624999972],[5.241894531250011,13.757226562499994],[5.361621093750074,13.836865234375054],[5.415820312500017,13.859179687499974],[5.491992187500074,13.872851562500003],[6.184277343750068,13.66367187500002],[6.2998046875,13.658789062500006],[6.386328125000034,13.603613281250048],[6.804296875000006,13.107666015625]]]},properties:{name:"Nigeria",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[-83.6419921875,10.917236328125],[-84.168359375,10.780371093749991],[-84.348291015625,10.979882812499994],[-84.9091796875,10.9453125],[-85.62138671874999,11.184472656249994],[-85.7443359375,11.062109374999991],[-86.468896484375,11.73828125],[-86.755615234375,12.156640624999994],[-87.66752929687499,12.903564453125],[-87.54331054687499,13.039697265624994],[-87.33725585937499,12.979248046875],[-87.05917968749999,12.991455078125],[-86.95888671875,13.0537109375],[-86.93315429687499,13.117529296874991],[-86.92880859374999,13.179394531249997],[-86.918212890625,13.223583984374997],[-86.87353515625,13.266503906249994],[-86.710693359375,13.313378906249994],[-86.77060546874999,13.69873046875],[-86.758984375,13.746142578125003],[-86.733642578125,13.763476562500003],[-86.61025390625,13.774853515624997],[-86.376953125,13.755664062500003],[-86.33173828125,13.770068359375003],[-86.238232421875,13.899462890625003],[-86.15122070312499,13.994580078124997],[-86.0892578125,14.037207031249991],[-86.04038085937499,14.050146484374991],[-85.9837890625,13.965673828124991],[-85.78671874999999,13.844433593749997],[-85.75341796875,13.85205078125],[-85.73393554687499,13.858691406250003],[-85.727734375,13.876074218749991],[-85.731201171875,13.931835937499997],[-85.68193359374999,13.982568359374994],[-85.47705078125,14.108691406250003],[-85.373779296875,14.223876953125],[-85.17949218749999,14.343310546875003],[-84.98515624999999,14.75244140625],[-84.78916015624999,14.790380859374991],[-84.72978515624999,14.71337890625],[-84.645947265625,14.661083984374997],[-83.635498046875,14.876416015624997],[-83.4150390625,15.008056640625],[-83.187744140625,14.340087890625],[-83.4123046875,13.996484374999994],[-83.567333984375,13.3203125],[-83.5109375,12.411816406249997],[-83.76933593749999,11.931640625],[-83.6517578125,11.642041015624997],[-83.86787109375,11.300048828125],[-83.6419921875,10.917236328125]]]},properties:{name:"Nicaragua",childNum:1}},{geometry:{type:"MultiPolygon",coordinates:[[[[4.226171875000034,51.38647460937503],[3.9020507812500114,51.20766601562502],[3.35009765625,51.37768554687503],[4.226171875000034,51.38647460937503]]],[[[4.226171875000034,51.38647460937503],[3.5869140625,51.45390624999999],[4.482812500000023,52.30917968749998],[4.6783203125000625,52.80976562500001],[6.062207031250068,53.407080078125006],[6.8162109375000455,53.44116210937503],[7.197265625000028,53.28227539062499],[7.035156250000057,52.38022460937498],[6.7417968750000625,51.91088867187503],[5.948535156250017,51.762402343749955],[6.193261718750051,51.48891601562502],[5.894726562500068,50.98422851562506],[5.993945312500017,50.75043945312504],[5.693554687500011,50.774755859375006],[5.827148437500057,51.125634765624994],[4.503417968750028,51.47470703124998],[4.226171875000034,51.38647460937503]]]]},properties:{name:"Netherlands",childNum:2}},{geometry:{type:"MultiPolygon",coordinates:[[[[30.869726562500006,69.78344726562506],[28.96582031250003,69.02197265625],[29.14160156250003,69.67143554687505],[27.889941406250045,70.06166992187497],[26.525390625000057,69.91503906250003],[26.011523437500074,69.65263671875005],[25.748339843750017,68.99013671875],[24.94140625000003,68.59326171875006],[23.85400390625,68.80590820312503],[22.410937500000074,68.719873046875],[21.621777343750068,69.27070312499995],[20.622167968750006,69.036865234375],[19.969824218750063,68.35639648437501],[18.378613281250068,68.56240234374997],[17.91669921875001,67.96489257812502],[17.324609375000023,68.10380859374999],[16.12744140625,67.42583007812507],[16.40351562500004,67.05498046875002],[15.422949218750006,66.48984374999998],[14.543261718750045,66.12934570312498],[14.47968750000004,65.30146484374998],[13.650292968750023,64.58154296874997],[14.077636718750028,64.464013671875],[13.960546875000063,64.01401367187498],[12.662500000000023,63.94047851562502],[11.999902343750051,63.29169921875001],[12.218164062500023,63.00063476562502],[12.303515625000074,62.28559570312501],[12.155371093750006,61.720751953125045],[12.88076171875008,61.35229492187506],[12.29414062500004,61.00268554687506],[12.588671874999989,60.450732421875045],[12.486132812500074,60.10678710937506],[11.680761718750034,59.59228515625003],[11.798144531250074,59.28989257812498],[11.388281250000063,59.036523437499966],[10.834472656250028,59.18393554687498],[9.618457031250017,58.946044921875],[8.166113281250063,58.145312500000045],[7.0048828125,58.024218750000074],[5.706835937500074,58.52363281250001],[5.84521484375,59.35346679687498],[5.1316406250000455,59.22646484375002],[5.244042968750023,60.569580078125],[5.049121093750017,60.70751953125006],[4.927832031249977,61.71069335937506],[5.5333007812500625,62.310888671875034],[6.352929687500051,62.61113281249999],[7.283789062499977,62.60229492187497],[7.00849609375004,62.957666015624994],[8.100585937500028,63.090966796874966],[8.398144531249983,63.53510742187504],[9.696875000000006,63.624560546875045],[9.708007812500028,63.864892578124994],[11.349902343750045,64.90590820312497],[12.15966796875,65.178955078125],[12.272851562500051,65.56816406250007],[12.976074218750057,66.01918945312502],[13.104687500000068,66.53940429687503],[14.754980468750006,67.49902343749997],[14.798925781250063,67.80932617187503],[16.064550781249977,68.19990234375001],[16.65185546875,68.62578125000002],[18.101464843749994,69.15629882812499],[18.293164062500068,69.47509765625003],[20.068945312500006,69.883447265625],[21.163085937500057,69.88950195312498],[21.400390625,70.17446289062505],[22.684570312500057,70.374755859375],[23.046484375000063,70.10185546874999],[24.420019531250034,70.70200195312503],[24.658007812500017,71.00102539062505],[25.768164062500063,70.85317382812502],[27.59707031250005,71.09130859375003],[29.102343750000045,70.86074218749997],[30.944140625000017,70.27441406249997],[29.601367187500017,69.97675781249998],[29.792089843750063,69.727880859375],[30.869726562500006,69.78344726562506]]],[[[21.60810546875004,78.59570312499997],[23.11669921874997,77.99150390624999],[24.23828125000003,77.89853515625006],[23.84121093750005,77.49775390625004],[22.056835937500068,77.50117187500001],[21.6083984375,77.91606445312499],[20.22792968750005,78.47783203125005],[21.60810546875004,78.59570312499997]]],[[[16.786718750000034,79.90673828125],[18.58144531250008,79.57158203125002],[19.089453125000034,79.15703125000002],[20.458203125000068,79.12924804687506],[21.388769531250034,78.74042968749998],[19.76875000000004,78.62270507812497],[18.439257812500074,78.025048828125],[16.700488281250045,76.57929687499995],[14.365820312500034,77.23447265625003],[14.920800781250023,77.68881835937506],[13.680566406250051,78.02812499999999],[11.77382812500008,78.71640625000006],[10.86591796875004,79.79658203125001],[12.753515625000006,79.77578124999997],[13.383593750000045,79.48076171874999],[15.816113281250011,79.68183593750001],[16.786718750000034,79.90673828125]]],[[[20.897851562500023,80.24995117187501],[22.450781250000034,80.40224609375005],[26.86083984375,80.16000976562498],[27.19863281250008,79.90659179687506],[25.641210937500034,79.40302734374995],[23.94775390625,79.19428710937498],[20.861132812500017,79.39785156249997],[18.725000000000023,79.7607421875],[18.343847656250006,80.05957031250006],[20.897851562500023,80.24995117187501]]]]},properties:{name:"Norway",childNum:4}},{geometry:{type:"Polygon",coordinates:[[[88.10976562500002,27.87060546875],[88.14697265625,27.749218749999997],[88.02412109375001,27.408886718749997],[87.984375,27.133935546874994],[87.9931640625,27.086083984374994],[88.11103515625001,26.928466796875],[88.1572265625,26.807324218749997],[88.16152343750002,26.724804687499997],[88.11152343750001,26.58642578125],[88.05488281250001,26.430029296875],[88.02695312500003,26.39501953125],[87.9951171875,26.382373046874996],[87.84921875000003,26.436914062499994],[87.63339843750003,26.399121093749997],[87.28740234374999,26.360302734374997],[87.01640624999999,26.555419921875],[86.70136718750001,26.43505859375],[86.36611328125002,26.574414062499997],[85.29296875,26.741015624999996],[84.68535156249999,27.041015625],[84.65478515625,27.203662109374996],[84.64072265625003,27.249853515625],[84.61015624999999,27.298681640625],[84.48085937500002,27.348193359374996],[84.22978515624999,27.42783203125],[84.09101562500001,27.491357421874994],[83.28974609375001,27.370996093749994],[82.7333984375,27.518994140624997],[82.71083984375002,27.5966796875],[82.67734375000003,27.6734375],[82.6298828125,27.687060546874996],[82.45136718750001,27.671826171874997],[82.28769531250003,27.756542968749997],[82.11191406250003,27.864941406249997],[82.03701171875002,27.900585937499997],[81.98769531250002,27.913769531249997],[81.94521484375002,27.899267578125],[81.89687500000002,27.874462890624997],[81.85263671875003,27.867089843749994],[80.58701171875003,28.649609374999997],[80.07070312500002,28.83017578125],[80.05166015625002,28.870312499999997],[80.08457031250003,28.994189453124996],[80.13046875000003,29.100390624999996],[80.16953125000003,29.124316406249996],[80.23300781250003,29.194628906249996],[80.25595703125003,29.318017578124994],[80.2548828125,29.42333984375],[80.31689453125,29.572070312499996],[80.40185546875,29.730273437499996],[80.90761718750002,30.171923828124996],[81.1103515625,30.036816406249997],[81.17714843750002,30.039892578125],[81.25507812500001,30.093310546874996],[81.41718750000001,30.337597656249997],[81.64189453124999,30.387499999999996],[81.85488281250002,30.36240234375],[82.04335937500002,30.3267578125],[82.15898437499999,30.115185546874997],[82.48652343750001,29.94150390625],[82.64082031250001,29.831201171874994],[82.85429687499999,29.683398437499996],[83.01396484374999,29.618066406249994],[83.15546875000001,29.612646484375],[83.58349609375,29.18359375],[83.93593750000002,29.279492187499997],[84.02197265625,29.253857421874997],[84.10136718749999,29.219970703125],[84.12783203125002,29.156298828124996],[84.17558593749999,29.036376953125],[84.22871093750001,28.911767578124994],[84.71425781250002,28.595556640625],[84.85507812500003,28.553613281249994],[85.06914062499999,28.609667968749996],[85.12636718750002,28.60263671875],[85.15908203125002,28.592236328124997],[85.16015625,28.571875],[85.12148437500002,28.484277343749994],[85.08857421875001,28.372265624999997],[85.12246093750002,28.315966796874996],[85.21210937500001,28.292626953124994],[85.41064453125,28.276025390624994],[85.67832031250003,28.27744140625],[85.75947265625001,28.220654296874997],[85.84023437500002,28.1353515625],[85.9541015625,27.92822265625],[86.40869140625,27.928662109374997],[86.55449218749999,28.085205078125],[86.69052734375003,28.094921874999997],[87.02011718750003,27.928662109374997],[87.14140624999999,27.838330078124997],[87.29072265625001,27.821923828124994],[87.68271484375003,27.82138671875],[88.10976562500002,27.87060546875]]]},properties:{name:"Nepal",childNum:1}},{geometry:{type:"MultiPolygon",coordinates:[[[[173.11533203125006,-41.27929687499997],[173.73789062500006,-40.98896484374998],[174.30253906249996,-41.019531249999986],[174.09238281250018,-41.50517578124999],[174.2831054687501,-41.740624999999994],[173.54511718750004,-42.517968749999994],[173.22119140624997,-42.976562499999986],[172.71855468750002,-43.258789062500014],[172.9206054687501,-43.89140625000002],[172.38525390624997,-43.82958984374996],[171.44257812500004,-44.13583984374999],[171.11328125000003,-45.03925781250001],[170.7005859375,-45.68427734374997],[169.68662109375006,-46.55166015625002],[168.38212890625007,-46.60537109374995],[168.1891601562501,-46.362207031249966],[167.68222656250012,-46.19296875000005],[166.73154296875006,-46.19785156249998],[166.73398437500012,-45.54355468749999],[167.19453125000004,-44.963476562500034],[167.78701171875,-44.59501953125002],[168.3666015625,-44.08203124999996],[168.80644531250002,-43.9919921875],[169.66152343750005,-43.591210937499966],[170.30283203125012,-43.10761718750004],[170.7416015625,-42.92734374999999],[171.2570312500001,-42.465332031250014],[171.48623046875,-41.7947265625],[172.01074218749997,-41.44472656250001],[172.13945312500002,-40.947265625000014],[172.64062499999997,-40.51826171875001],[172.988671875,-40.84824218749999],[173.11533203125006,-41.27929687499997]]],[[[173.26943359375,-34.93476562499998],[173.84394531250015,-35.02626953124998],[174.32031250000003,-35.246679687500034],[174.54345703125003,-35.58203124999996],[174.39101562500005,-35.77373046875002],[174.8021484375,-36.30947265625001],[174.72246093750007,-36.84121093749998],[175.29951171875004,-36.99326171874996],[175.46083984375005,-36.475683593750034],[175.8761718750001,-36.95771484375],[176.10839843749997,-37.64511718749998],[177.33593749999997,-37.99082031249998],[178.0091796875,-37.55488281249998],[178.53623046875006,-37.69208984375004],[178.26767578125006,-38.55117187500001],[177.976171875,-38.72226562500005],[177.96562500000002,-39.14248046875004],[177.40751953124996,-39.08115234374998],[176.95410156249997,-39.367578124999966],[177.10986328125009,-39.673144531250045],[176.8421875000001,-40.15781250000002],[175.98291015625003,-41.21328125000002],[175.30976562499998,-41.610644531249974],[174.63535156250012,-41.289453124999994],[175.16250000000005,-40.62158203125],[175.25410156250004,-40.28935546875],[175.00927734375009,-39.95214843749996],[173.93437500000013,-39.50908203125002],[173.84433593750006,-39.13935546875001],[174.59736328124998,-38.78505859374995],[174.92802734375002,-37.80449218750003],[174.72919921875004,-37.44873046875003],[174.78203125000013,-36.943749999999994],[174.47558593750009,-36.94189453124997],[174.44687500000006,-36.45087890625004],[173.94511718750002,-36.17587890624998],[173.11669921874997,-35.205273437500026],[173.26943359375,-34.93476562499998]]]]},properties:{name:"New Zealand",childNum:2}},{geometry:{type:"Polygon",coordinates:[[[56.38798828125002,24.97919921875004],[56.64062499999997,24.470312500000006],[57.219824218750006,23.922753906250023],[58.57802734375005,23.64345703125005],[59.80000000000004,22.21992187500001],[59.37148437500005,21.498828125000017],[58.89570312500004,21.11279296874997],[58.47421875000006,20.406884765624966],[57.86181640624997,20.24414062500003],[57.71513671875002,19.60693359374997],[57.81162109375006,19.01708984374997],[57.176562500000074,18.902587890625],[56.655078125000074,18.58735351562501],[56.55078124999997,18.165966796874955],[56.27031250000002,17.950781249999977],[55.479101562500006,17.84326171875003],[55.06416015625004,17.038916015625034],[54.06816406250002,17.005517578124966],[53.60986328124997,16.75996093750004],[53.08564453125004,16.648388671874955],[52.72919921875004,17.300390625000006],[51.977636718750006,18.996142578125074],[53.66689453125005,19.559130859375017],[54.97734375000002,19.995947265625006],[55.641015624999994,22.001855468749994],[55.185839843750074,22.7041015625],[55.1999023437501,23.034765625000034],[55.76083984375006,24.24267578125],[55.795703125000074,24.868115234374955],[56.06386718750005,24.73876953125],[56.38798828125002,24.97919921875004]]]},properties:{name:"Oman",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[76.76689453124999,35.66171875],[77.04863281249999,35.109912109374996],[77.00087890625002,34.991992187499996],[76.78291015625001,34.900195312499996],[76.7490234375,34.847558593749994],[76.6962890625,34.786914062499996],[76.59443359375001,34.73583984375],[75.70917968750001,34.503076171874994],[74.300390625,34.765380859375],[74.17197265625,34.7208984375],[74.05585937500001,34.6806640625],[73.96123046875002,34.653466796874994],[74.15,33.506982421874994],[73.99423828125,33.2421875],[74.30361328125002,32.991796875],[74.35458984375,32.768701171874994],[74.6578125,32.518945312499994],[74.68574218750001,32.493798828124994],[74.78886718750002,32.457812499999996],[74.9873046875,32.462207031249996],[75.33349609375,32.279199218749994],[75.25410156250001,32.14033203125],[75.13876953125,32.104785156249996],[75.07148437500001,32.08935546875],[74.73945312500001,31.948828125],[74.50996093750001,31.712939453124996],[74.58183593750002,31.52392578125],[74.59394531250001,31.465380859374996],[74.53496093750002,31.261376953124994],[74.51767578125,31.185595703124996],[74.6103515625,31.112841796874996],[74.62578125000002,31.068749999999994],[74.6328125,31.03466796875],[74.509765625,30.959667968749997],[74.38037109375,30.893408203125],[74.33935546875,30.8935546875],[74.21562500000002,30.768994140624997],[74.00898437500001,30.519677734374994],[73.89931640625002,30.435351562499996],[73.8091796875,30.093359375],[73.65800781250002,30.033203125],[73.46748046875001,29.9716796875],[73.38164062500002,29.934374999999996],[72.9033203125,29.028759765624997],[72.34189453125,28.751904296874997],[72.17919921875,28.421777343749994],[71.94804687500002,28.177294921874996],[71.88886718750001,28.0474609375],[71.87031250000001,27.9625],[71.71669921875002,27.915087890624996],[71.54296875,27.869873046875],[71.18476562500001,27.831640625],[70.87490234375002,27.714453125],[70.79794921875,27.709619140624994],[70.73740234375,27.72900390625],[70.69160156250001,27.768994140624997],[70.64912109375001,27.835351562499994],[70.62910156250001,27.937451171874997],[70.40371093750002,28.025048828124994],[70.24433593750001,27.934130859374996],[70.1939453125,27.894873046875],[70.14453125,27.849023437499994],[70.0498046875,27.694726562499994],[69.89628906250002,27.4736328125],[69.56796875,27.174609374999996],[69.47001953125002,26.804443359375],[70.05937500000002,26.578759765624994],[70.14921875000002,26.347558593749994],[70.1001953125,25.910058593749994],[70.65205078125001,25.422900390625003],[70.87773437500002,25.06298828125],[70.95087890625001,24.8916015625],[71.02070312500001,24.75766601562499],[71.0478515625,24.687744140625],[71.00234375000002,24.65390624999999],[70.97636718750002,24.61874999999999],[70.9732421875,24.48740234374999],[71.00625000000002,24.4443359375],[71.04531250000002,24.429980468750003],[71.04404296875,24.400097656249997],[70.98281250000002,24.361035156249997],[70.92812500000002,24.362353515625003],[70.88623046875,24.34375],[70.80507812500002,24.261962890625],[70.76728515625001,24.245410156250003],[70.71630859375,24.237988281249997],[70.54677734375002,24.41831054687499],[69.71621093750002,24.172607421875],[69.63417968750002,24.22519531249999],[69.5591796875,24.273095703124994],[69.44345703125,24.275390625],[69.23505859375001,24.268261718749997],[69.11953125000002,24.26865234374999],[69.05156250000002,24.286328124999997],[68.98457031250001,24.273095703124994],[68.90078125000002,24.292431640624997],[68.86347656250001,24.266503906249994],[68.82832031250001,24.26401367187499],[68.80000000000001,24.30908203125],[68.78115234375002,24.313720703125],[68.75898437500001,24.30722656249999],[68.73964843750002,24.2919921875],[68.728125,24.265625],[68.72412109375,23.96469726562499],[68.48867187500002,23.967236328124997],[68.38125000000002,23.950878906249997],[68.28251953125002,23.927978515625],[68.1650390625,23.857324218749994],[67.66845703125,23.810986328124997],[67.30937500000002,24.1748046875],[67.171484375,24.756103515625],[66.70302734375002,24.86093749999999],[66.69863281250002,25.226318359375],[66.42861328125002,25.575341796874994],[65.6796875,25.355273437500003],[64.77666015625002,25.307324218749997],[64.65898437500002,25.18408203125],[63.72089843750001,25.385888671874994],[63.49140625000001,25.210839843749994],[62.57246093750001,25.25473632812499],[62.31533203125002,25.134912109374994],[61.74365234375,25.13818359375],[61.56689453125,25.186328125000003],[61.587890625,25.202343749999997],[61.61542968750001,25.2861328125],[61.64013671875,25.584619140624994],[61.66865234375001,25.768994140624997],[61.86982421875001,26.242431640625],[62.31230468750002,26.490869140624994],[63.168066406250006,26.665576171874996],[63.16679687500002,27.252490234374996],[62.75273437500002,27.265625],[62.782324218750006,27.800537109375],[62.76250000000002,28.202050781249994],[61.88984375000001,28.546533203124994],[61.623046875,28.7916015625],[61.15214843750002,29.542724609375],[61.0341796875,29.663427734375],[60.843359375000006,29.858691406249996],[61.22441406250002,29.749414062499994],[62.37343750000002,29.425390625],[62.4765625,29.408349609374994],[63.56757812500001,29.497998046874997],[64.09873046875,29.391943359375],[64.52109375,29.564501953124996],[65.09550781250002,29.559472656249994],[66.17705078125002,29.835595703124994],[66.39716796875001,30.91220703125],[66.92431640625,31.305615234374997],[67.28730468750001,31.217822265624996],[67.57822265625,31.506494140624994],[68.21396484375,31.807373046875],[68.86894531250002,31.634228515624997],[69.279296875,31.936816406249996],[69.24140625000001,32.433544921875],[69.5015625,33.020068359374996],[69.92011718750001,33.1125],[70.2841796875,33.369042968749994],[69.86806640625002,33.89765625],[71.05156250000002,34.049707031249994],[70.96562500000002,34.53037109375],[71.62050781250002,35.183007812499994],[71.42753906250002,35.833740234375],[71.18505859375,36.04208984375],[71.62050781250002,36.436474609375],[72.62285156250002,36.82958984375],[73.769140625,36.888476562499996],[74.00185546875002,36.823095703125],[74.54140625000002,37.02216796875],[74.8892578125,36.952441406249996],[74.94912109375002,36.968359375],[75.05390625000001,36.987158203125],[75.3466796875,36.913476562499994],[75.84023437500002,36.649707031249996],[75.94511718750002,36.017578125],[76.01044921875001,35.996337890625],[76.07089843750003,35.9830078125],[76.25166015625001,35.810937499999994],[76.76689453124999,35.66171875]]]},properties:{name:"Pakistan",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[-77.37421874999993,8.65830078125002],[-77.2123046875,8.033886718749997],[-77.35078124999995,7.7058593750000455],[-77.74389648437503,7.536962890625006],[-77.90117187499999,7.229345703125048],[-78.17011718749998,7.543798828124977],[-78.42158203124995,8.060986328125011],[-78.11386718749998,8.379589843749983],[-79.08637695312495,8.997167968750034],[-79.44150390625,9.00600585937498],[-79.75043945312498,8.595507812500017],[-80.36870117187499,8.288769531250054],[-80.45810546875,8.077050781249994],[-80.07519531249997,7.6670410156250455],[-80.4388671875,7.274951171875003],[-80.84555664062498,7.22006835937502],[-81.03510742187495,7.711132812500054],[-81.50415039062503,7.721191406249972],[-81.72763671875,8.137548828124977],[-83.02734375,8.337744140624991],[-82.86162109374999,8.453515625000037],[-82.91704101562502,8.740332031250034],[-82.739990234375,8.898583984375023],[-82.72783203125002,8.916064453125031],[-82.74116210937498,8.951708984375017],[-82.93984374999994,9.449169921875026],[-82.801025390625,9.591796875000028],[-82.37080078124993,9.428564453124991],[-82.24418945312499,9.031494140625014],[-81.35478515624996,8.78056640624996],[-80.83867187499999,8.887207031250014],[-80.12709960937497,9.20991210937504],[-79.57729492187497,9.597851562500026],[-78.50434570312495,9.406298828124989],[-78.08276367187494,9.236279296874997],[-77.37421874999993,8.65830078125002]]]},properties:{name:"Panama",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[-73.137353515625,-6.4658203125],[-73.75810546874999,-6.90576171875],[-73.79301757812499,-7.135058593750003],[-73.749462890625,-7.3353515625000085],[-73.964306640625,-7.37890625],[-73.95849609375,-7.506640625000003],[-73.98173828124999,-7.535742187500006],[-74.00205078124999,-7.5560546875000085],[-73.98173828124999,-7.585058593750006],[-73.94687499999999,-7.6112304687500085],[-73.89462890624999,-7.65478515625],[-73.82207031249999,-7.738964843750011],[-73.76689453124999,-7.753515625000006],[-73.72041015625,-7.782519531250003],[-73.7755859375,-7.9364257812500085],[-73.54912109374999,-8.345800781250006],[-73.43588867187499,-8.427050781250003],[-73.39814453125,-8.458984375],[-73.36040039062499,-8.479296875000003],[-73.351708984375,-8.51416015625],[-73.35673828124999,-8.566992187500006],[-73.30244140625,-8.654003906250011],[-73.203125,-8.719335937500006],[-73.0705078125,-8.8828125],[-72.9740234375,-8.9931640625],[-72.970361328125,-9.1201171875],[-73.08984375,-9.265722656250006],[-73.209423828125,-9.411425781250003],[-72.379052734375,-9.510156250000009],[-72.181591796875,-10.003710937500003],[-71.60800781249999,-10.006054687500011],[-71.237939453125,-9.966015625000011],[-71.11528320312499,-9.852441406250009],[-70.59916992187499,-9.620507812500009],[-70.642333984375,-11.01025390625],[-70.22006835937499,-11.047656250000003],[-69.57861328125,-10.951757812500006],[-68.68525390625,-12.501953125],[-68.97861328124999,-12.880078125000011],[-69.07412109375,-13.682812500000011],[-68.880322265625,-14.198828125000006],[-69.23491210937499,-14.597070312500009],[-69.37470703125,-14.962988281250006],[-69.17246093749999,-15.236621093750003],[-69.41850585937499,-15.603417968750009],[-69.21757812499999,-16.14912109375001],[-68.9134765625,-16.26191406250001],[-69.020703125,-16.642187500000006],[-69.62485351562499,-17.2001953125],[-69.5109375,-17.50605468750001],[-69.85209960937499,-17.70380859375001],[-69.92636718749999,-18.2060546875],[-70.05908203125,-18.283496093750003],[-70.1837890625,-18.3251953125],[-70.37749023437499,-18.333593750000006],[-70.41826171874999,-18.34560546875001],[-71.33696289062499,-17.68251953125001],[-71.5322265625,-17.29433593750001],[-72.111279296875,-17.002539062500006],[-72.46767578125,-16.708105468750006],[-73.824951171875,-16.15283203125],[-74.14707031249999,-15.912500000000009],[-75.104248046875,-15.411914062500003],[-75.533642578125,-14.899218750000003],[-75.93388671874999,-14.633593750000003],[-76.289013671875,-14.133105468750003],[-76.18393554687499,-13.515234375000006],[-76.83212890624999,-12.348730468750006],[-77.152734375,-12.060351562500003],[-77.22031249999999,-11.663378906250003],[-77.633203125,-11.287792968750011],[-77.736083984375,-10.836718750000003],[-78.18559570312499,-10.089062500000011],[-78.76225585937499,-8.616992187500003],[-79.37724609374999,-7.835546875000006],[-79.761962890625,-7.066503906250006],[-80.11025390625,-6.649609375000011],[-80.81162109374999,-6.2822265625],[-81.18051757812499,-5.9423828125],[-80.88271484375,-5.758984375000011],[-81.10849609374999,-5.02783203125],[-81.33662109375,-4.669531250000006],[-81.283203125,-4.322265625],[-80.798583984375,-3.7310546875000057],[-80.503662109375,-3.49609375],[-80.324658203125,-3.3878906250000114],[-80.27353515624999,-3.424609375000003],[-80.26523437499999,-3.492480468750003],[-80.24541015624999,-3.5221679687500114],[-80.24374999999999,-3.5767578125000057],[-80.22060546875,-3.6131835937500085],[-80.21757812499999,-3.7876953125000057],[-80.17924804687499,-3.877734375000003],[-80.26689453124999,-3.9488281250000057],[-80.30327148437499,-4.005078125000011],[-80.43720703125,-3.9786132812500057],[-80.49013671875,-4.010058593750003],[-80.510009765625,-4.069531250000011],[-80.49345703124999,-4.119140625],[-80.4884765625,-4.16552734375],[-80.453759765625,-4.205175781250006],[-80.4884765625,-4.393652343750006],[-80.293359375,-4.416796875000003],[-80.1974609375,-4.31103515625],[-80.13955078125,-4.296093750000011],[-79.63852539062499,-4.454882812500003],[-79.57768554687499,-4.500585937500006],[-79.51616210937499,-4.539160156250006],[-79.501904296875,-4.670605468750011],[-79.45576171875,-4.766210937500006],[-79.3994140625,-4.840039062500011],[-79.33095703125,-4.927832031250006],[-79.26811523437499,-4.957617187500006],[-79.186669921875,-4.958203125000011],[-79.07626953124999,-4.9906250000000085],[-79.03330078124999,-4.9691406250000085],[-78.995263671875,-4.908007812500003],[-78.97539062499999,-4.873242187500011],[-78.8615234375,-4.6650390625],[-78.68603515625,-4.5624023437500085],[-78.64799804687499,-4.248144531250006],[-78.240380859375,-3.4725585937500085],[-77.860595703125,-2.9816406250000114],[-76.6791015625,-2.5625976562500057],[-76.089794921875,-2.133105468750003],[-75.64165039062499,-1.6073242187500085],[-75.570556640625,-1.53125],[-75.42041015625,-.9622070312500028],[-75.24960937499999,-.9518554687500114],[-75.28359375,-.7071289062500057],[-75.2787109375,-.6539062500000057],[-75.25937499999999,-.5901367187500028],[-75.26323242187499,-.5553710937500114],[-75.32524414062499,-.5065429687500114],[-75.42470703125,-.40888671875001137],[-75.49106445312499,-.24833984375000284],[-75.63203125,-.15761718750000853],[-75.4759765625,-.15712890625000853],[-75.340478515625,-.14218750000000568],[-75.28447265624999,-.10654296875000568],[-75.224609375,-.041748046875],[-75.18408203125,-.041748046875],[-75.13837890625,-.05048828125001137],[-74.8017578125,-.20009765625000853],[-74.41787109375,-.5806640625000057],[-74.334423828125,-.8508789062500028],[-74.28388671875,-.9278320312500057],[-74.24638671874999,-.9706054687500085],[-74.05439453125,-1.0286132812500028],[-73.98681640625,-1.09814453125],[-73.926953125,-1.1251953125000114],[-73.86318359375,-1.1966796875000085],[-73.664306640625,-1.2488281250000028],[-73.4962890625,-1.6930664062500114],[-73.19697265625,-1.8302734375000114],[-73.1544921875,-2.2782226562500085],[-72.887158203125,-2.408496093750003],[-72.39560546874999,-2.4289062500000114],[-72.300732421875,-2.4092773437500057],[-72.21845703125,-2.4004882812500057],[-72.13681640624999,-2.380664062500003],[-71.98427734375,-2.3265625000000085],[-71.93247070312499,-2.2886718750000057],[-71.86728515624999,-2.2277343750000114],[-71.802734375,-2.166308593750003],[-71.75253906249999,-2.1527343750000085],[-71.55947265625,-2.2242187500000057],[-71.39697265625,-2.3340820312500057],[-70.91455078125,-2.218554687500003],[-70.095849609375,-2.658203125],[-70.07402343749999,-2.7501953125000114],[-70.735107421875,-3.781542968750003],[-70.5296875,-3.8664062500000114],[-70.48583984375,-3.8693359375000114],[-70.42109375,-3.849609375],[-70.37919921874999,-3.8187500000000085],[-70.339501953125,-3.8143554687500085],[-70.29843749999999,-3.84423828125],[-70.24028320312499,-3.8827148437500085],[-70.16752929687499,-4.0501953125000085],[-70.40463867187499,-4.150097656250011],[-70.5306640625,-4.167578125000006],[-70.72158203125,-4.158886718750011],[-70.79951171875,-4.17333984375],[-70.97368164062499,-4.3504882812500085],[-71.8447265625,-4.50439453125],[-72.256787109375,-4.7489257812500085],[-72.35283203124999,-4.7860351562500085],[-72.468994140625,-4.9012695312500085],[-72.608349609375,-5.009570312500003],[-72.69873046875,-5.067187500000003],[-72.83193359375,-5.09375],[-72.88706054687499,-5.122753906250011],[-72.9798828125,-5.634863281250006],[-73.16289062499999,-5.933398437500003],[-73.209375,-6.0287109375000085],[-73.235546875,-6.098437500000003],[-73.137353515625,-6.4658203125]]]
},properties:{name:"Peru",childNum:1}},{geometry:{type:"MultiPolygon",coordinates:[[[[126.00595703125006,9.320947265625009],[126.19335937499997,9.276708984374963],[126.31953125000004,8.844726562499986],[126.43535156250002,7.832812499999974],[126.58154296875003,7.247753906249969],[126.08007812500003,6.733349609374983],[125.82441406250004,7.333300781249989],[125.40097656250012,6.7957519531249915],[125.58847656250012,6.465771484374997],[125.66796874999997,5.97866210937498],[125.45585937500002,5.664257812500054],[124.63632812500012,5.998193359375051],[124.07812500000003,6.404443359375037],[123.98525390625,6.993701171875003],[124.20664062500006,7.396435546874983],[123.96845703125004,7.6646484374999915],[123.49306640625,7.80791015624996],[123.39091796875007,7.407519531250017],[122.49794921875005,7.672753906250051],[122.17617187500005,7.004199218750003],[122.04716796875002,7.363574218750031],[122.13183593749997,7.81049804687504],[122.33710937500004,8.028417968750034],[122.91113281250003,8.156445312499997],[123.01757812500003,8.398339843749994],[123.43457031249997,8.70332031250004],[124.22578125000004,8.271386718749966],[124.45126953125006,8.606347656249994],[124.7311523437501,8.562988281250043],[124.86894531250002,8.972265625000034],[125.5333984375001,9.140917968750017],[125.52089843750005,9.75913085937502],[126.00595703125006,9.320947265625009]]],[[[124.59384765625006,9.787207031249963],[124.35986328125003,9.630224609375048],[123.93564453125012,9.623974609375011],[123.81718750000002,9.817382812499986],[124.17285156250003,10.135205078124983],[124.57714843749997,10.026708984374991],[124.59384765625006,9.787207031249963]]],[[[123.13085937500003,9.064111328124994],[122.56249999999997,9.482812500000037],[122.47148437500007,9.961523437500034],[122.85556640625006,10.0869140625],[122.81699218750012,10.503808593750023],[122.98330078125,10.886621093750037],[123.25664062500007,10.99394531249996],[123.5675781250001,10.780761718750057],[123.16201171875,9.864257812500028],[123.30839843750002,9.356982421874974],[123.13085937500003,9.064111328124994]]],[[[123.37031250000004,9.449609375000023],[123.38623046874997,9.967089843750017],[123.71142578124997,10.473681640625017],[123.95214843750003,10.316601562499997],[123.64335937500007,10.020214843750011],[123.37031250000004,9.449609375000023]]],[[[117.31113281250012,8.439599609375051],[117.34990234375002,8.713574218749997],[117.88476562499997,9.240673828124997],[118.11484375000006,9.346679687500014],[119.52666015625002,10.953173828125003],[119.68437500000007,10.551708984375011],[119.19150390625012,10.061083984374989],[118.78212890625005,9.91611328125002],[118.4349609375,9.256005859375009],[117.98955078125002,8.877099609375009],[117.31113281250012,8.439599609375051]]],[[[124.574609375,11.343066406250031],[124.92998046875002,11.372851562499974],[125.01318359374997,10.785693359374989],[125.25332031250005,10.26381835937498],[125.02656250000004,10.033105468749966],[124.78076171874997,10.16806640625002],[124.78671875000012,10.781396484375009],[124.44550781250004,10.923583984375014],[124.574609375,11.343066406250031]]],[[[122.49619140625006,11.615087890625034],[123.15830078125012,11.535546874999994],[123.01650390625,11.116503906249974],[122.76992187500005,10.823828125000034],[122.19765625,10.622900390625048],[121.96435546874997,10.871679687500006],[122.10351562499997,11.64291992187502],[122.49619140625006,11.615087890625034]]],[[[125.23955078125002,12.527880859375003],[125.53564453125003,12.191406250000028],[125.45654296874997,11.952539062500037],[125.62812500000004,11.132031250000026],[125.23339843749997,11.145068359375017],[124.88427734375003,11.77548828125002],[124.38486328125006,12.243994140624991],[124.29472656250007,12.569335937500014],[125.23955078125002,12.527880859375003]]],[[[120.70439453125002,13.479492187499986],[121.20273437500006,13.432324218749969],[121.52275390625007,13.131201171874991],[121.54062500000006,12.63818359375],[121.23671875000005,12.218798828125003],[120.92216796875002,12.51162109374998],[120.76367187499997,12.969824218749977],[120.50830078124997,13.260058593750045],[120.70439453125002,13.479492187499986]]],[[[121.10156249999997,18.615283203125017],[121.84560546875,18.29541015625003],[122.29980468749997,18.402783203124983],[122.15097656250006,17.756494140625023],[122.23681640624997,17.434863281250045],[122.51914062500012,17.124853515625034],[122.13515625000005,16.18481445312503],[121.59531250000012,15.933251953125023],[121.39228515625004,15.324414062499969],[121.69541015625006,14.7373046875],[121.80048828125004,14.113867187499991],[122.49082031250012,14.32236328125002],[122.85605468750006,14.250781250000003],[123.23144531249997,13.747363281250017],[123.43232421875004,13.966259765625026],[123.72597656250005,13.884326171875031],[123.6081054687501,13.528076171875028],[124.14277343750004,13.035791015625009],[124.0597656250001,12.567089843749997],[123.31093750000005,13.044091796875009],[123.16328125000004,13.44174804687502],[122.59521484374997,13.90761718749998],[122.40693359375004,13.49277343750002],[121.77792968750006,13.93764648437498],[121.20351562500005,13.640283203124966],[120.61679687500006,14.188037109375003],[120.9220703125001,14.493115234374983],[120.8880859375,14.715771484375054],[120.08212890625012,14.851074218749986],[119.83076171875004,16.326562500000023],[120.15976562500012,16.047656250000045],[120.38925781250006,16.221630859374955],[120.30527343750006,16.52924804687501],[120.40888671875004,16.955615234375017],[120.35839843749997,17.63818359375],[120.59970703125012,18.507861328125074],[121.10156249999997,18.615283203125017]]]]},properties:{name:"Philippines",childNum:10}},{geometry:{type:"MultiPolygon",coordinates:[[[[155.95761718750006,-6.686816406249989],[155.71933593750012,-6.862792968749957],[155.34404296875007,-6.721679687499986],[155.20214843750003,-6.3076171875],[154.78193359375004,-5.970703125000028],[154.74111328125005,-5.545312499999952],[154.99707031249997,-5.539941406250023],[155.46699218750004,-6.145117187500034],[155.82255859375002,-6.38046875000002],[155.95761718750006,-6.686816406249989]]],[[[151.91562500000006,-4.296777343749966],[152.40566406250005,-4.340722656249952],[152.40000000000006,-4.731250000000017],[152.01328125000006,-5.003808593750037],[152.14296875,-5.357031249999963],[151.86542968750004,-5.564843750000023],[151.51513671874997,-5.552343749999963],[151.22929687500002,-5.919921874999986],[150.42832031250012,-6.276171874999989],[149.65253906250004,-6.290429687499966],[149.38232421874997,-6.078124999999972],[149.12656250000012,-6.127636718750026],[148.40117187500002,-5.765039062499952],[148.34472656249997,-5.544921874999972],[148.9992187500001,-5.484570312500011],[149.24531250000004,-5.573046875000017],[150.29873046875,-5.535644531250028],[150.95292968750002,-5.423730468749966],[151.32656250000005,-4.96035156249998],[151.67119140625007,-4.88330078125],[151.55195312500004,-4.345507812499946],[151.91562500000006,-4.296777343749966]]],[[[140.97617187500012,-9.118750000000006],[140.97519531250006,-6.90537109375002],[140.97441406250002,-4.836328125000023],[140.97353515625,-2.8034179687500256],[140.97343750000007,-2.6097656250000085],[141.18564453125006,-2.6278320312499517],[142.21152343750006,-3.0834960937499716],[142.90517578125,-3.32070312499998],[143.50898437500004,-3.431152343750014],[144.01582031250004,-3.783593749999966],[144.4777343750001,-3.82529296875002],[145.08779296875,-4.349121093749972],[145.33457031250012,-4.385253906249972],[145.7669921875,-4.823046874999989],[145.85283203125002,-5.471289062499977],[146.40341796875006,-5.6166015625000085],[147.03427734375006,-5.919238281250017],[147.37666015625004,-5.950781249999963],[147.80205078125002,-6.31523437499996],[147.84550781250007,-6.662402343749989],[147.11914062499997,-6.721679687499986],[146.96074218750002,-6.9288085937499915],[147.19003906250012,-7.3781249999999545],[147.72431640625004,-7.876269531250017],[148.12675781250007,-8.103613281249963],[148.24687500000002,-8.554296875000034],[148.58310546875006,-9.051757812499957],[149.24765625000006,-9.070996093749969],[149.20302734375005,-9.406835937499991],[149.76123046874997,-9.805859375000011],[149.87441406250005,-10.012988281250031],[150.66699218749997,-10.257128906250031],[150.48242187500003,-10.63691406250004],[150.0167968750001,-10.577148437500028],[149.75410156250004,-10.353027343750028],[147.76865234375012,-10.070117187500031],[146.69658203125002,-9.025390625],[146.03320312499997,-8.076367187500011],[144.97382812500004,-7.8021484375000085],[144.50986328125006,-7.567382812499972],[143.61376953125003,-8.200390624999969],[143.0949218750001,-8.311230468749983],[143.36621093750003,-8.961035156250034],[142.6471679687501,-9.327832031249969],[142.22958984375012,-9.169921874999957],[141.13320312500005,-9.221289062500034],[140.97617187500012,-9.118750000000006]]],[[[152.96582031249997,-4.756347656249986],[152.68066406250003,-4.498437500000023],[152.59843750000007,-3.9948242187500114],[153.1242187500001,-4.25234374999998],[152.96582031249997,-4.756347656249986]]]]},properties:{name:"Papua New Guinea",childNum:4}},{geometry:{type:"Polygon",coordinates:[[[23.484667968750017,53.939794921875],[23.887109375000023,53.0275390625],[23.8447265625,52.664208984375],[23.19697265625001,52.25693359375],[23.652441406250006,52.040380859375],[23.605273437500017,51.517919921875],[23.664453125000023,51.31005859375],[24.105761718750017,50.844970703125],[23.711718750000017,50.377343749999994],[22.6494140625,49.539013671875],[22.538671875000006,49.072705078125],[21.6396484375,49.411962890625],[20.616113281250023,49.39169921875],[19.80224609375,49.192333984375],[19.44160156250001,49.597705078124996],[18.83222656250001,49.510791015624996],[18.562402343750023,49.879345703125],[17.874804687500017,49.972265625],[17.151953125000006,50.378320312499994],[16.679101562500023,50.097460937499996],[16.007226562500023,50.611621093749996],[14.809375000000017,50.858984375],[14.9638671875,51.095117187499994],[14.601660156250006,51.832373046875],[14.752539062500006,52.081835937499996],[14.70458984375,52.110205078125],[14.6923828125,52.150048828125],[14.705371093750017,52.207470703125],[14.679882812500011,52.25],[14.615625000000023,52.277636718749996],[14.573925781250011,52.31416015625],[14.554589843750023,52.359667968749996],[14.569726562500023,52.431103515625],[14.619433593750017,52.528515625],[14.514062500000023,52.64560546875],[14.253710937500017,52.782519531249996],[14.128613281250011,52.878222656249996],[14.138867187500011,52.932861328125],[14.193652343750017,52.98232421875],[14.293164062500011,53.0267578125],[14.368554687500023,53.10556640625],[14.410937500000017,53.199023437499996],[14.412304687500011,53.216748046875],[14.41455078125,53.283496093749996],[14.715722656250023,54.018310546875],[16.186328125000017,54.290380859375],[16.55976562500001,54.55380859375],[17.26191406250001,54.729541015624996],[18.32343750000001,54.838183593749996],[18.66962890625001,54.430908203125],[18.97626953125001,54.348925781249996],[19.407128906250023,54.386083984375],[19.560156250000006,54.434619140624996],[19.604394531250023,54.4591796875],[19.64423828125001,54.447070312499996],[19.92431640625,54.433984375],[20.20820312500001,54.420751953125],[22.16845703125,54.35986328125],[23.015527343750023,54.34833984375],[23.45361328125,54.14345703125],[23.484667968750017,53.939794921875]]]},properties:{name:"Poland",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[-66.12939453125003,18.444921875000034],[-65.62880859375,18.381396484375045],[-65.97080078124995,17.974365234375],[-67.19687499999998,17.994189453125045],[-67.15864257812501,18.499218749999983],[-66.12939453125003,18.444921875000034]]]},properties:{name:"United States of America",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[130.52695312500012,42.535400390625],[130.68730468750007,42.30253906249999],[130.45751953124997,42.30170898437501],[129.75634765624997,41.712255859375006],[129.70869140625004,40.857324218749994],[128.30449218750002,40.03593749999999],[127.56816406250002,39.78198242187503],[127.39453125000003,39.207910156249966],[127.78613281250003,39.084130859374966],[128.37460937500012,38.623437499999994],[128.03896484375,38.30854492187498],[127.16953125000006,38.304541015625034],[126.63388671875012,37.78183593750006],[125.94169921875007,37.87368164062502],[125.44931640625012,37.73022460937503],[125.19316406250007,38.03779296874998],[124.69091796874997,38.12919921875002],[125.06738281250003,38.556738281250006],[125.40966796875003,39.28837890625002],[125.36083984375003,39.52661132812497],[124.55742187500002,39.79057617187502],[124.36210937500002,40.004052734374994],[124.8893554687501,40.459814453125006],[125.98906250000002,40.904638671875034],[126.9035156250001,41.78105468749999],[127.17968750000003,41.531347656250006],[128.11123046875,41.389257812500006],[128.29091796875,41.56279296875002],[128.04521484375007,41.98750000000004],[128.92343750000006,42.038232421874966],[129.3136718750001,42.41357421874997],[129.71972656249997,42.47500000000005],[129.89824218750002,42.998144531250034],[130.24033203125006,42.891796874999955],[130.52695312500012,42.535400390625]]]},properties:{name:"North Korea",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[-7.4061523437499375,37.17944335937497],[-7.834130859374994,37.005712890625034],[-8.597656249999943,37.12133789062506],[-8.814160156249983,37.43081054687502],[-8.914794921874972,38.512109374999966],[-9.474121093749972,38.73085937500002],[-9.374755859374972,39.338281249999966],[-9.148291015624949,39.542578125000034],[-8.886621093750023,40.179443359375],[-8.655566406249932,41.02949218749998],[-8.777148437500017,41.941064453124994],[-8.213085937499926,42.133691406249966],[-7.920849609374983,41.883642578125006],[-7.40361328124996,41.833691406249955],[-6.61826171874992,41.9423828125],[-6.212499999999949,41.53203124999996],[-6.928466796874972,41.009130859375006],[-6.81015624999992,40.343115234375034],[-7.036718750000006,39.713964843750034],[-7.44511718749996,39.53618164062496],[-7.0460449218749375,38.907031250000045],[-7.343017578124943,38.45742187500002],[-7.185449218749994,38.00634765625006],[-7.503515624999977,37.58549804687502],[-7.4061523437499375,37.17944335937497]]]},properties:{name:"Portugal",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[-58.15976562499999,-20.164648437500006],[-57.830224609374994,-20.99794921875001],[-57.94267578124999,-21.79833984375],[-57.98569335937499,-22.04638671875],[-57.95590820312499,-22.109179687500003],[-57.8203125,-22.14228515625001],[-57.764062499999994,-22.109179687500003],[-57.721093749999994,-22.099218750000006],[-57.238232421875,-22.19521484375001],[-56.77519531249999,-22.261328125000006],[-56.523828124999994,-22.1025390625],[-56.44780273437499,-22.076171875],[-56.39487304687499,-22.09267578125001],[-56.189843749999994,-22.28115234375001],[-55.84916992187499,-22.3076171875],[-55.75327148437499,-22.41015625],[-55.74663085937499,-22.5126953125],[-55.70366210937499,-22.592089843750003],[-55.647412109375,-22.621875000000003],[-55.61767578125,-22.671484375000006],[-55.627587890624994,-22.74091796875001],[-55.654052734375,-22.810351562500003],[-55.458886718749994,-23.68671875000001],[-55.4423828125,-23.792578125000006],[-55.4423828125,-23.865332031250006],[-55.415917968749994,-23.95136718750001],[-55.36630859374999,-23.991015625000003],[-55.28691406249999,-24.00429687500001],[-55.1943359375,-24.01748046875001],[-55.08188476562499,-23.997656250000006],[-54.982666015625,-23.97451171875001],[-54.62548828125,-23.8125],[-54.44023437499999,-23.90175781250001],[-54.37080078125,-23.97119140625],[-54.24179687499999,-24.04726562500001],[-54.281005859375,-24.30605468750001],[-54.47314453125,-25.22021484375],[-54.610546875,-25.432714843750006],[-54.615869140624994,-25.57607421875001],[-54.63193359374999,-26.00576171875001],[-54.677734375,-26.30878906250001],[-54.934472656249994,-26.70253906250001],[-55.426660156249994,-27.00927734375],[-55.59726562499999,-27.207617187500006],[-55.63291015624999,-27.35712890625001],[-55.789990234375,-27.41640625000001],[-56.1640625,-27.32148437500001],[-56.437158203124994,-27.553808593750006],[-57.11181640625,-27.47011718750001],[-58.16826171874999,-27.2734375],[-58.60483398437499,-27.31435546875001],[-58.641748046874994,-27.196093750000003],[-58.32255859374999,-26.85761718750001],[-58.33466796875,-26.82490234375001],[-58.31767578124999,-26.7958984375],[-58.191308593749994,-26.629980468750006],[-57.943115234375,-26.05292968750001],[-57.587158203125,-25.405078125000003],[-57.821679687499994,-25.13642578125001],[-58.365380859374994,-24.959277343750003],[-58.422802734375,-24.894140625000006],[-58.51962890624999,-24.842871093750006],[-59.372949218749994,-24.453906250000003],[-59.60859375,-24.26679687500001],[-59.892480468749994,-24.093554687500003],[-60.83984375,-23.85810546875001],[-61.084716796875,-23.65644531250001],[-61.79853515625,-23.18203125000001],[-62.372509765625,-22.43916015625001],[-62.54155273437499,-22.349609375],[-62.6259765625,-22.29042968750001],[-62.62568359375,-22.261523437500003],[-62.65097656249999,-22.233691406250003],[-62.27666015624999,-21.066015625000006],[-62.276318359375,-20.5625],[-61.916943359375,-20.05537109375001],[-61.7568359375,-19.645312500000003],[-60.00737304687499,-19.29755859375001],[-59.09052734375,-19.286230468750006],[-58.18017578125,-19.81787109375],[-58.15976562499999,-20.164648437500006]]]},properties:{name:"Paraguay",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[34.880468750000006,31.3681640625],[34.98974609374997,31.913281249999955],[34.955957031249994,32.16093749999996],[35.01054687500002,32.33818359375002],[35.06503906250006,32.46044921875006],[35.19326171875005,32.53442382812503],[35.303808593750006,32.512939453125],[35.38671875000003,32.493017578125034],[35.402636718750074,32.45063476562501],[35.48437500000003,32.40166015624999],[35.5514648437501,32.39550781250006],[35.55898437500005,31.765527343749966],[35.499414062499994,31.67236328125],[35.450585937499994,31.479296875000017],[34.880468750000006,31.3681640625]]]},properties:{name:"Israel",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[51.26796875000002,24.607226562500003],[51.093359375000006,24.564648437499997],[51.02275390625002,24.565234375000003],[50.96601562500001,24.573925781249997],[50.928320312500006,24.595117187499994],[50.85566406250001,24.679638671874997],[50.80439453125001,24.789257812499997],[50.8359375,24.850390625000003],[50.846777343750006,24.888574218749994],[50.76289062500001,25.444726562499994],[51.00312500000001,25.9814453125],[51.262304687500006,26.153271484374997],[51.543066406250006,25.902392578125003],[51.4853515625,25.524707031250003],[51.60195312500002,25.14794921875],[51.26796875000002,24.607226562500003]]]},properties:{name:"Qatar",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[28.212500000000006,45.450439453125],[28.317675781250017,45.347119140625],[28.451269531250006,45.2921875],[28.78828125000001,45.240966796875],[29.223535156250023,45.4029296875],[29.705859375000017,45.259912109374994],[29.557519531250023,44.843408203124994],[29.048242187500023,44.757568359375],[28.645410156250023,44.295654296875],[28.585351562500023,43.742236328124996],[27.0869140625,44.167382812499994],[26.2158203125,44.007275390625],[25.4970703125,43.670800781249994],[23.224609375,43.873876953125],[22.705078125,44.23779296875],[22.687890625000023,44.248291015625],[21.384375000000006,44.870068359375],[21.431445312500017,45.192529296874994],[20.774218750000017,45.484423828124996],[20.775000000000006,45.749804687499996],[20.35859375000001,45.975488281249994],[20.241796875000006,46.10859375],[20.28095703125001,46.1330078125],[20.508105468750017,46.166943359375],[20.613671875000023,46.13349609375],[21.151953125000006,46.304345703124994],[22.290625000000006,47.727832031249996],[22.87666015625001,47.947265625],[23.628710937500017,47.995849609375],[24.578906250000017,47.931054687499994],[24.893359375000017,47.7177734375],[26.162695312500006,47.992529296875],[26.236230468750023,48.064355468749994],[26.276953125000006,48.113232421875],[26.3056640625,48.203759765624994],[26.4423828125,48.22998046875],[26.618945312500017,48.25986328125],[26.980761718750017,48.155029296875],[27.3369140625,47.63974609375],[28.07177734375,46.978417968749994],[28.24433593750001,46.45126953125],[28.099707031250006,45.972607421875],[28.212500000000006,45.450439453125]]]},properties:{name:"Romania",childNum:1}},{geometry:{type:"MultiPolygon",coordinates:[[[[148.59951171875,45.317626953125],[147.91376953125004,44.99038085937502],[147.76943359375,45.19072265624999],[148.59951171875,45.317626953125]]],[[[142.76103515625002,54.393945312499966],[142.91796875000003,53.79423828125002],[143.22363281250003,53.29604492187505],[143.32363281250005,52.61357421874999],[143.15556640625002,52.08374023437497],[143.45546875,51.47148437500002],[143.81601562500006,50.28261718750002],[144.27207031250012,49.311328125000045],[143.10498046875003,49.198828125000034],[142.57421874999997,48.07216796875002],[142.55693359375002,47.737890625000034],[143.0055664062501,47.22270507812496],[143.28232421875006,46.55898437500002],[142.57802734375005,46.700781250000034],[142.20859375000006,46.0888671875],[141.83037109375002,46.451074218749966],[142.03867187500012,47.140283203124966],[141.9640625000001,47.58745117187502],[142.18173828125012,48.01337890625001],[141.86630859375006,48.750097656250006],[142.1422851562501,49.56914062499999],[142.07109375000007,50.514990234375034],[142.20673828125004,51.22255859375002],[141.72236328125004,51.73632812499997],[141.82353515625007,53.33950195312502],[142.52617187500002,53.44746093749998],[142.76103515625002,54.393945312499966]]],[[[21.235742187500023,55.26411132812498],[22.83125000000001,54.838476562500034],[22.766210937499977,54.356787109375034],[22.168457031250057,54.35986328125006],[20.20820312500004,54.420751953125034],[19.92431640625003,54.433984374999966],[19.644238281250068,54.44707031249996],[19.604394531250023,54.45917968750004],[19.85888671875,54.63383789062499],[19.944140625000074,54.75000000000003],[19.974511718750023,54.92119140625002],[20.520312500000017,54.994873046875],[20.89980468750008,55.286669921875045],[20.957812500000074,55.27890625000006],[21.235742187500023,55.26411132812498]]],[[[163.63515625000005,58.603369140625006],[163.7609375000001,59.01503906250002],[164.61572265624997,58.885595703125034],[163.63515625000005,58.603369140625006]]],[[[-179.79853515625,68.9404296875],[-178.873876953125,68.75410156249995],[-177.40751953124996,68.24516601562502],[-175.34521484375,67.67807617187503],[-174.44760742187503,67.10312500000003],[-173.6796875,67.144775390625],[-172.64057617187504,66.92499999999998],[-171.79555664062502,66.93173828125003],[-170.191943359375,66.20126953124998],[-170.66630859375,65.62153320312501],[-172.21157226562502,65.42519531249997],[-172.21318359375,65.04814453124999],[-172.92402343750004,64.70493164062506],[-173.00913085937498,64.2974609375],[-173.72973632812497,64.36450195312497],[-174.318017578125,64.63764648437504],[-175.39511718749998,64.80239257812502],[-175.85385742187498,65.01083984375003],[-176.09326171875,65.471044921875],[-177.05624999999998,65.613623046875],[-178.31020507812502,65.48486328124997],[-178.87934570312495,65.93647460937495],[-179.7283203125,65.80380859375],[-179.352099609375,65.51674804687497],[-180,65.06723632812498],[-180,65.31196289062501],[-180,65.55678710937497],[-180,65.80156250000002],[-180,66.04628906250002],[-180,66.29106445312499],[-180,66.53583984375004],[-180,66.78056640625005],[-180,67.02534179687501],[-180,67.27011718750006],[-180,67.51484374999998],[-180,67.75961914062503],[-180,68.00439453124997],[-180,68.24912109375],[-180,68.49389648437497],[-180,68.738671875],[-179.79853515625,68.9404296875]]],[[[50.265234375000006,69.18559570312502],[49.62626953125002,68.85971679687498],[48.66699218750003,68.73315429687503],[48.27880859374997,69.04033203124999],[48.63134765625003,69.43603515624997],[49.22519531250006,69.51123046875],[50.265234375000006,69.18559570312502]]],[[[169.20078125000006,69.58046875],[167.78886718750002,69.83686523437501],[168.35791015625003,70.01567382812502],[169.37480468750007,69.88261718749999],[169.20078125000006,69.58046875]]],[[[60.450488281250074,69.93486328124999],[59.57822265625006,69.73862304687498],[58.473046874999994,70.26684570312503],[59.00527343750005,70.46518554687503],[60.450488281250074,69.93486328124999]]],[[[178.8615234375001,70.826416015625],[178.89111328125009,71.23110351562502],[180.00000000000003,71.53774414062505],[180.00000000000003,70.993017578125],[178.8615234375001,70.826416015625]]],[[[-178.87646484375,71.57705078124997],[-177.53217773437504,71.26308593750005],[-177.82177734375,71.06757812500001],[-179.50668945312498,70.92343750000003],[-179.999951171875,70.993017578125],[-179.999951171875,71.53774414062505],[-178.87646484375,71.57705078124997]]],[[[55.31982421875003,73.30830078124998],[56.42958984375005,73.201171875],[56.08378906250002,72.78940429687503],[55.35595703124997,72.46508789062506],[55.29785156249997,71.93535156250005],[57.14589843750005,70.58911132812506],[54.60117187500006,70.68007812500002],[53.7223632812501,70.81445312500003],[53.36386718750006,71.54165039062505],[51.812597656250006,71.49130859375],[51.58251953124997,72.07119140625],[52.62207031250003,72.30097656250001],[53.753222656250074,73.29326171875002],[55.31982421875003,73.30830078124998]]],[[[142.18486328125007,73.89589843750005],[143.34374999999997,73.56875000000002],[143.19326171875005,73.22075195312499],[140.66279296875004,73.45200195312503],[141.08476562500002,73.86586914062497],[142.18486328125007,73.89589843750005]]],[[[113.38720703124997,74.40043945312499],[112.78242187500004,74.09506835937503],[111.64296875,74.27294921875003],[112.08447265624997,74.54897460937505],[113.38720703124997,74.40043945312499]]],[[[146.79521484375007,75.37075195312505],[150.10390625,75.21923828125],[150.64628906250002,74.944580078125],[149.5968750000001,74.77260742187505],[148.09238281250006,74.82568359375003],[146.14853515625012,75.19829101562499],[146.79521484375007,75.37075195312505]]],[[[140.04873046875,75.82895507812503],[140.94414062500007,75.70048828124999],[142.46035156250005,75.90361328125007],[143.68583984375002,75.86367187500002],[145.25527343750005,75.58559570312502],[144.01972656250004,75.04467773437506],[141.98730468750003,74.99125976562499],[139.09912109374997,74.65654296875002],[138.09228515625003,74.79746093750003],[137.00625,75.23500976562502],[137.50117187500004,75.90966796874997],[138.81396484374997,76.19970703125],[140.04873046875,75.82895507812503]]],[[[67.7653320312501,76.23759765624999],[66.28242187500004,75.98369140625005],[61.35595703124997,75.31484375000002],[60.22246093750002,74.79658203124995],[58.53466796875003,74.49892578124997],[58.44140625000003,74.12885742187498],[56.96386718750003,73.36655273437503],[55.00683593750003,73.45385742187506],[53.7628906250001,73.76616210937499],[54.64267578125006,73.95957031250006],[57.08750000000006,75.38383789062505],[58.881249999999994,75.85478515625007],[62.97148437500002,76.23666992187498],[65.862890625,76.61333007812505],[67.53496093750007,77.00776367187504],[68.48574218750005,76.93369140625003],[68.8998046875,76.57294921875001],[67.7653320312501,76.23759765624999]]],[[[130.68730468750007,42.30253906249999],[130.52695312500012,42.535400390625],[130.57724609375006,42.81162109375006],[131.06855468750004,42.90224609375005],[131.26181640625006,43.43305664062501],[131.2552734375,44.07158203124999],[131.08232421875002,44.91000976562498],[131.97753906250003,45.243994140625006],[132.93603515624997,45.029931640624994],[133.18603515625003,45.49482421875004],[133.86132812500003,46.24775390625004],[134.1676757812501,47.30219726562501],[134.75234375,47.71542968749998],[134.56357421875012,48.321728515624955],[134.29335937500005,48.37343750000002],[133.46835937500006,48.09716796875003],[133.14404296875003,48.10566406249998],[132.5619140625,47.768505859374955],[131.00273437500002,47.69145507812499],[130.7121093750001,48.12763671875004],[130.80429687500012,48.34150390624998],[129.49814453125012,49.38881835937502],[129.12011718750003,49.36206054687497],[128.70400390625,49.60014648437499],[127.99960937500006,49.56860351562506],[127.50244140624997,49.873437499999994],[127.590234375,50.20898437500003],[126.92480468749997,51.10014648437496],[126.312890625,52.39975585937506],[125.64902343750012,53.042285156250045],[124.81230468750002,53.133837890625045],[123.6078125,53.546533203124994],[122.33779296875,53.485009765624994],[120.70410156249997,53.171826171874955],[120.09453125000007,52.787207031250034],[120.65615234375,52.56665039062503],[120.74980468750007,52.096533203125006],[120.06689453125003,51.60068359375006],[119.19189453125003,50.37983398437504],[119.25986328125012,50.06640625000003],[118.4515625,49.84448242187503],[117.8734375,49.51347656250002],[116.6833007812501,49.82377929687499],[116.13457031250002,50.01079101562499],[115.27451171875006,49.948876953124994],[114.74316406249997,50.23369140625002],[114.29707031250004,50.27441406250006],[113.57421874999997,50.00703125000001],[113.44550781250004,49.94160156250001],[113.31904296875004,49.87431640624999],[113.16416015625012,49.79716796874999],[113.09208984375007,49.692529296874994],[113.05556640625,49.61625976562499],[111.3366210937501,49.355859374999966],[111.20419921875012,49.304296875000034],[110.82792968750002,49.16616210937505],[110.19990234375004,49.17041015625003],[109.5287109375,49.269873046875034],[109.45371093750012,49.29633789062501],[109.23671875000005,49.334912109374955],[108.61367187500005,49.32280273437499],[108.52246093750003,49.34150390624998],[108.4069335937501,49.39638671875005],[108.03378906250012,49.59399414062497],[107.94785156250012,49.92470703125002],[107.63095703125012,49.98310546875004],[107.3470703125,49.986669921875034],[107.23330078125,49.989404296874994],[107.14306640625003,50.03300781249999],[107.04023437500004,50.086474609375045],[106.94130859375005,50.19667968750002],[106.71113281250004,50.312597656250006],[106.57441406250004,50.32880859375004],[106.36845703125002,50.317578124999955],[106.21787109375006,50.304589843749966],[105.38359375000002,50.47373046874998],[105.09472656249997,50.38994140624996],[104.97695312500005,50.382910156250034],[104.46630859375003,50.30615234375003],[104.35390625000005,50.27529296875005],[104.2599609375001,50.214453125000006],[104.17968749999997,50.16943359374997],[103.63291015625006,50.138574218749994],[103.49628906250004,50.16494140625005],[103.42119140625002,50.18706054687502],[103.3043945312501,50.200292968750034],[103.2337890625,50.264257812500034],[103.16171875000006,50.29072265624998],[103.03945312500005,50.30063476562506],[102.85966796875002,50.33325195312506],[102.68330078125004,50.38715820312501],[102.28837890625007,50.58510742187502],[102.31660156250004,50.71845703125001],[102.21503906250004,50.82944335937506],[102.15195312500006,51.107519531250034],[102.14238281250007,51.21606445312503],[102.16005859375005,51.260839843750006],[102.1556640625,51.31376953124996],[102.1115234375001,51.353466796874955],[101.97919921875004,51.382226562499966],[101.82119140625,51.421044921874966],[101.57089843750006,51.46718750000005],[101.38125,51.45263671875],[101.30449218750007,51.474755859374994],[101.22324218750012,51.513281250000006],[100.53623046875006,51.713476562500034],[100.46894531250004,51.72607421875003],[100.23037109375,51.729833984375006],[100.0345703125,51.73710937499996],[99.92167968750002,51.755517578124994],[99.71923828124997,51.87163085937502],[98.84863281249997,52.07006835937503],[98.64052734375005,51.80117187500005],[98.3527343750001,51.717626953125006],[97.94687500000012,51.34843750000002],[97.82529296875012,50.985253906249994],[98.2794921875001,50.53325195312502],[98.10341796875005,50.077832031249955],[97.58935546875003,49.911474609375006],[97.35976562500005,49.741455078125],[97.20859375000006,49.73081054687506],[96.98574218750005,49.88281250000003],[96.31503906250012,49.90112304687503],[96.06552734375006,49.99873046875001],[95.9357421875001,49.960009765625045],[95.89941406249997,49.990576171875034],[95.851953125,50.01293945312497],[95.78935546875002,50.01249999999999],[95.70781250000002,49.96601562500001],[95.56718750000007,49.94384765625003],[95.52265625000004,49.911230468750034],[95.04433593750005,49.961572265624994],[94.93027343750006,50.043750000000045],[94.71806640625002,50.04326171875002],[94.67548828125004,50.02807617187506],[94.61474609375003,50.02373046874996],[94.25107421875006,50.55639648437503],[91.80429687500006,50.693603515625],[89.64384765625002,49.90302734374998],[89.65410156250007,49.71748046875001],[88.83164062500012,49.44843749999998],[88.633203125,49.486132812500045],[88.5443359375,49.48256835937502],[88.45244140625002,49.47270507812496],[88.39335937500007,49.48286132812498],[88.33779296875005,49.47255859375002],[88.19257812500004,49.451708984375045],[88.13554687500002,49.38149414062502],[88.11572265624997,49.25629882812501],[88.0285156250001,49.219775390625045],[87.98808593750002,49.186914062499994],[87.9347656250001,49.16455078124997],[87.81425781250002,49.162304687499955],[87.76250000000007,49.16582031249996],[87.5158203125001,49.122412109375006],[87.41669921875004,49.07661132812501],[87.32285156250012,49.085791015625006],[86.61425781249997,49.60971679687498],[86.1808593750001,49.49931640624996],[85.21015625000004,49.66484375000002],[84.9894531250001,50.061425781249994],[84.25781249999997,50.28823242187502],[83.94511718750007,50.774658203125],[83.35732421875005,50.99458007812504],[82.49394531250007,50.72758789062499],[81.46591796875006,50.739843750000006],[80.87734375,51.28144531250004],[79.98623046875,50.774560546874966],[79.46884765625012,51.49311523437498],[78.47548828125005,52.638427734375],[77.70439453125007,53.379150390625],[76.57568359374997,53.94252929687502],[76.26660156249997,54.31196289062498],[74.45195312500007,53.64726562500002],[73.28574218750006,53.598388671875],[73.39941406250003,53.81147460937498],[72.91406249999997,54.10732421875002],[71.09316406250005,54.21220703124999],[71.18554687500003,54.59931640624998],[70.73808593750007,55.30517578125],[70.18242187500002,55.162451171875034],[68.9772460937501,55.389599609374955],[68.20625000000004,55.16093750000002],[68.07382812500006,54.959570312500006],[66.22265624999997,54.667382812499994],[65.476953125,54.62329101562497],[65.1578125,54.364404296874994],[64.46123046875002,54.38417968750002],[63.0739257812501,54.10522460937506],[61.92871093750003,53.94648437500004],[61.33369140625004,54.04926757812501],[60.97949218749997,53.62172851562505],[61.19921874999997,53.28715820312502],[62.01464843750003,53.10786132812498],[61.97421875000006,52.94375000000002],[61.047460937500006,52.97246093750002],[60.80234375000006,52.74472656249998],[60.937597656250006,52.28056640625002],[60.06552734375006,51.976464843749966],[60.464746093749994,51.651171875000045],[61.363085937500074,51.44189453125003],[61.585058593750006,51.22968749999998],[61.38945312500002,50.86103515625001],[60.637988281250074,50.66372070312505],[59.95517578125006,50.79926757812504],[59.812402343749994,50.58203125],[58.88369140625005,50.694433593750006],[58.359179687500074,51.063818359375034],[57.83886718750003,51.091650390625006],[57.44218750000002,50.88886718749998],[57.01171874999997,51.06518554687503],[56.49140625000004,51.01953124999997],[55.79765625000002,50.60205078125],[55.54228515625002,50.60180664062506],[54.72714843750006,50.998095703125045],[54.42148437500006,50.78032226562499],[54.04150390624997,51.11518554687501],[53.33808593750004,51.48237304687504],[52.57119140625005,51.481640624999955],[52.33105468749997,51.681298828124966],[51.60908203125004,51.483984375000006],[50.79394531249997,51.729199218749955],[50.246875000000074,51.28950195312498],[49.49804687500003,51.08359375000006],[48.80839843750002,50.60131835937503],[48.84326171875003,50.01313476562501],[48.43427734375004,49.828515624999966],[47.7057617187501,50.37797851562502],[47.32646484375002,50.273535156250034],[46.80205078125002,49.36708984375002],[47.014257812500006,49.09833984374998],[46.70263671875003,48.80556640625002],[46.660937500000074,48.41225585937502],[47.004296874999994,48.28447265625002],[47.09326171875003,47.947705078124955],[48.109960937500006,47.74541015624996],[48.95937500000005,46.77460937499998],[48.610156250000074,46.566455078125045],[49.232226562500074,46.33715820312503],[48.15917968750003,45.73701171874998],[47.524218750000074,45.60170898437505],[46.753027343750006,44.42065429687503],[47.22988281250005,44.19238281249997],[47.5089843750001,43.50971679687498],[47.463183593750074,43.03505859375002],[48.572851562500006,41.84448242187503],[47.861132812500074,41.212744140625034],[47.26113281250005,41.315087890624994],[46.74931640625002,41.812597656250006],[46.42988281250004,41.890966796875006],[46.21269531250002,41.989892578124994],[45.63857421875005,42.20507812500003],[45.63427734374997,42.234716796875034],[45.72753906249997,42.47504882812498],[45.562890624999994,42.53574218749998],[45.34375000000003,42.52978515625003],[45.20820312500004,42.64824218749999],[45.16025390625006,42.67500000000004],[45.07158203125002,42.69414062500002],[44.94335937499997,42.73027343750002],[44.870996093749994,42.75639648437499],[44.850488281249994,42.746826171875],[44.77109375000006,42.61679687499998],[44.691796874999994,42.709619140624966],[44.64433593750002,42.734716796875034],[44.50585937500003,42.748632812500006],[44.329492187499994,42.703515624999966],[44.10273437500004,42.616357421874994],[44.004687500000074,42.59560546875002],[43.95742187500005,42.56655273437505],[43.825976562500074,42.571533203125],[43.759863281250006,42.593847656250006],[43.738378906250006,42.61699218750002],[43.74990234375005,42.65751953125002],[43.79541015624997,42.702978515625034],[43.78261718750005,42.747021484374955],[43.62304687500003,42.80771484374998],[43.5578125000001,42.844482421875],[43.089160156250074,42.98906249999996],[42.991601562499994,43.09150390624998],[42.76064453125005,43.169580078124966],[42.660253906250006,43.159082031249966],[42.566015625000006,43.15512695312506],[42.41904296875006,43.224218750000006],[42.279687499999994,43.22807617187499],[42.05000000000004,43.19013671874998],[41.58056640624997,43.21923828124997],[41.460742187500074,43.276318359374955],[41.35820312500002,43.33339843750005],[40.64804687500006,43.53388671875004],[40.02373046875002,43.48486328125],[39.873632812500006,43.47280273437502],[38.71728515624997,44.28808593750003],[38.181250000000006,44.41967773437503],[37.851464843749994,44.698828125000034],[37.41132812500004,44.73535156250003],[36.941210937500074,45.289697265624994],[37.6471679687501,45.37719726562506],[37.93310546875003,46.001708984375],[38.18359374999997,46.09482421875006],[37.9679687500001,46.61801757812506],[39.29345703125003,47.105761718750045],[38.21435546875003,47.091455078124966],[38.287402343750074,47.559179687500034],[38.90029296875005,47.85512695312502],[39.735937500000006,47.84482421875006],[39.96103515625006,48.23793945312502],[39.68652343749997,49.007910156250034],[40.07001953125004,49.20029296874998],[39.780566406250074,49.57202148437503],[39.17480468750003,49.85595703124997],[38.258593750000074,50.052343750000006],[38.04687500000003,49.92001953125006],[37.42285156249997,50.411474609375006],[36.619433593750074,50.209228515625],[35.41162109375003,50.539697265624994],[35.31191406250005,51.043896484374955],[34.280664062499994,51.311669921874966],[34.397851562499994,51.780419921874994],[33.735253906249994,52.344775390625045],[32.507910156250006,52.30854492187504],[31.763378906250097,52.10107421875003],[31.758593750000017,52.125830078125034],[31.69062500000004,52.22065429687498],[31.57734375000004,52.31230468749999],[31.585546875000006,52.532470703125],[31.53515624999997,52.798242187499966],[31.442773437499994,52.86181640625003],[31.35302734374997,52.93344726562498],[31.295117187500097,52.98979492187499],[31.25878906249997,53.01669921875006],[31.364550781250017,53.13896484375002],[31.388378906250097,53.18481445312503],[31.41787109375005,53.196044921875],[31.849707031250006,53.106201171875],[32.70429687500004,53.336328124999994],[32.45097656250002,53.6533203125],[31.754199218750017,53.81044921875002],[31.12128906250004,54.64848632812496],[30.906835937500063,55.57001953125004],[30.625585937500006,55.666259765625],[30.23359375000004,55.84521484375006],[30.04267578125004,55.83642578125003],[29.93701171874997,55.84526367187499],[29.881640625000074,55.83232421875002],[29.82392578125004,55.79511718749998],[29.74414062499997,55.770410156249994],[29.68457031249997,55.769726562499955],[29.482226562500074,55.6845703125],[29.412988281249994,55.72485351562506],[29.35341796875005,55.78437500000001],[29.373144531250063,55.83471679687506],[29.39794921874997,55.88105468749998],[29.37499999999997,55.938720703125],[28.284277343750006,56.055908203125],[27.806054687499994,56.86708984375005],[27.639453125000074,56.84565429687504],[27.814550781250034,57.16689453125002],[27.796875,57.316943359375045],[27.538671875000063,57.429785156250034],[27.51113281250005,57.508154296875006],[27.469726562500057,57.524023437500034],[27.35195312500005,57.52812499999999],[27.400000000000063,57.66679687499999],[27.542089843750063,57.799414062500006],[27.75283203125008,57.841015624999955],[27.48779296875,58.270068359375045],[27.464453125000034,58.84130859375],[28.012500000000045,59.484277343749966],[28.013964843750074,59.72475585937502],[28.947265625000057,59.828759765624994],[29.069140625000017,60.19145507812499],[28.65058593750001,60.61098632812502],[27.797656250000074,60.53613281250003],[29.69013671875004,61.54609375000001],[31.28564453125003,62.567822265624955],[31.533984375000017,62.885400390624994],[31.180859375000097,63.208300781250074],[30.05537109375004,63.689013671875045],[30.50390625000003,64.02060546875],[30.10810546875004,64.36611328125005],[30.072851562500063,64.76503906250005],[29.60419921875004,64.968408203125],[29.903417968750006,66.091064453125],[29.087011718750034,66.97094726562503],[29.941210937500074,67.54746093749998],[29.343847656250006,68.06186523437506],[28.470703125000057,68.48837890625],[28.96582031250003,69.02197265625],[30.869726562500006,69.78344726562506],[31.98457031250004,69.95366210937499],[32.94169921875002,69.75185546875],[32.37773437500002,69.47910156250003],[33.68437500000002,69.31025390625001],[35.85791015625003,69.19174804687503],[40.38066406250002,67.831884765625],[40.96640625000006,67.71347656250003],[41.18896484375003,66.82617187500003],[40.52158203125006,66.44663085937498],[39.28906250000003,66.13203125000001],[38.39755859375006,66.064453125],[35.51347656250002,66.39580078125002],[34.824609374999994,66.61113281249999],[32.46367187500002,66.91630859374999],[33.566699218750074,66.32099609374995],[34.7863281250001,65.86455078125005],[34.40644531250004,65.39575195312503],[34.803515625000074,64.98598632812502],[34.869531249999994,64.56000976562501],[35.64707031250006,64.37832031250005],[36.3649414062501,64.00283203125002],[37.44218750000002,63.813378906249966],[38.07080078124997,64.02583007812498],[37.953710937500006,64.32011718749999],[37.183691406250006,64.40849609375007],[36.52822265625005,64.84736328125004],[36.88281249999997,65.17236328124997],[38.009375000000006,64.87875976562503],[39.7580078125001,64.57705078125002],[40.28125000000003,64.99809570312502],[39.816503906250006,65.59794921874999],[41.4757812500001,66.12343750000002],[42.21054687500006,66.51967773437502],[44.09716796874997,66.23505859375004],[44.488671874999994,66.67177734375002],[44.29179687500002,67.09965820312505],[43.7824218750001,67.25449218749998],[44.22539062500002,67.99560546874997],[44.04804687500004,68.54882812499997],[45.891992187499994,68.47968750000001],[46.69042968750003,67.84882812500001],[45.52871093750005,67.75756835937497],[44.93945312499997,67.47744140625002],[45.98603515625004,66.853125],[46.690820312499994,66.82553710937498],[47.70908203125006,67.04501953125003],[47.87470703125004,67.58417968749998],[48.87792968749997,67.73134765625005],[50.83886718749997,68.34995117187503],[52.550097656250074,68.59243164062497],[53.80195312500004,68.99589843750002],[53.967871093750006,68.22734375000002],[54.5612304687501,68.273046875],[56.04365234375004,68.64887695312501],[57.126855468749994,68.55400390625005],[58.91894531249997,69.00380859375002],[59.897363281249994,68.42192382812505],[60.93359374999997,68.98676757812501],[60.17060546875004,69.59091796875],[61.01591796875002,69.85146484374997],[63.36142578125006,69.67529296875003],[68.50419921875007,68.34843749999999],[69.14052734375005,68.95063476562501],[68.54277343750002,68.96708984374999],[68.00585937499997,69.48002929687505],[67.06445312500003,69.69370117187498],[66.92636718750006,70.0142578125],[67.28476562500006,70.73872070312498],[66.66611328125006,70.90058593750001],[66.91757812500006,71.28237304687497],[68.2692382812501,71.68281250000001],[69.03906249999997,72.66992187500003],[69.64511718750006,72.89755859375006],[71.5001953125001,72.91367187500003],[72.812109375,72.69140624999997],[72.62441406250005,72.079443359375],[71.91201171875005,71.54794921874998],[72.73164062500004,70.82285156249998],[72.52968750000005,70.172509765625],[72.52734374999997,69.08051757812501],[73.5480468750001,68.57451171875005],[73.15214843750002,67.86503906250002],[72.59433593750006,67.58696289062502],[71.551171875,66.76044921874995],[70.93945312499997,66.54814453125005],[69.8771484375001,66.84545898437506],[69.19433593749997,66.57866210937505],[70.33945312500006,66.34238281250006],[71.91699218749997,66.24672851562502],[72.4173828125,66.56079101562506],[73.79208984375,66.99531250000001],[74.07451171875007,67.41411132812499],[74.76953124999997,67.76635742187497],[74.39140625000007,68.42060546874995],[74.57958984375003,68.751220703125],[76.45917968750004,68.97827148437497],[77.2384765625001,68.46958007812498],[77.65068359375007,68.90302734375001],[76.00097656249997,69.23505859374998],[74.81484375,69.09057617187503],[73.77568359375002,69.19824218750003],[73.56015625,69.70722656249998],[74.3109375,70.65361328125005],[73.08623046875007,71.44492187500006],[73.67177734375,71.84506835937503],[75.74140625000004,72.29624023437503],[76.03242187500004,71.91040039062503],[78.4826171875001,72.39497070312498],[79.4220703125001,72.38076171875002],[80.76250000000002,72.08916015625002],[81.51123046874997,71.74614257812505],[82.98613281250007,71.74868164062502],[82.18359375000003,72.23754882812497],[80.82705078125005,72.48828124999997],[80.50966796875005,73.086083984375],[80.5832031250001,73.56845703125003],[83.54472656250002,73.66650390625003],[86.59140625000006,73.89428710937497],[86.65146484375012,74.68242187500005],[87.67138671874997,75.12958984375004],[90.18496093750005,75.59106445312497],[93.54980468750003,75.8541015625],[94.57558593750005,76.1517578125],[96.87919921875002,75.93105468749997],[100.32236328125012,76.479150390625],[100.98994140625004,76.99047851562497],[103.13144531250012,77.62646484375006],[104.01455078125,77.73041992187501],[105.89453125000003,77.4888671875],[104.91191406250002,77.17470703125002],[107.42978515625006,76.92656250000002],[108.02792968750006,76.71845703124998],[111.11484375000012,76.72304687500002],[112.61953125,76.38354492187506],[113.87099609375005,75.85600585937505],[113.61357421875007,75.29296875],[111.86826171875006,74.74003906250007],[109.84033203124997,74.32197265624998],[108.19951171875002,73.69409179687497],[107.27109375000006,73.62104492187501],[106.47792968750005,73.13940429687503],[107.750390625,73.17314453125007],[109.85527343750002,73.47246093750002],[110.2614257812501,74.01743164062503],[112.14726562500007,73.70893554687498],[114.06054687500003,73.58466796874995],[115.33769531250007,73.70258789062501],[118.45019531249997,73.58979492187504],[118.43027343750012,73.24653320312501],[119.750390625,72.97910156250006],[123.1603515625001,72.95488281250002],[123.62226562500004,73.19326171875],[123.305078125,73.53291015624998],[124.3880859375,73.75483398437498],[125.61708984375,73.52060546874998],[127.74033203125012,73.48154296875],[128.88867187500003,73.19023437499999],[129.41171875000006,72.31547851562505],[128.3587890625,72.08833007812504],[129.76191406250004,71.11953125000002],[131.15742187500004,70.74218749999997],[131.56201171875003,70.901025390625],[132.56230468750007,71.89531250000005],[134.10283203125002,71.37895507812502],[135.88476562499997,71.63056640625004],[137.31542968750003,71.35942382812505],[138.11845703125002,71.56616210937497],[139.69511718750007,71.70043945312497],[139.60117187500012,72.49609374999997],[142.06142578125005,72.72080078125],[145.4857421875,72.54208984375],[146.59414062500005,72.30244140624995],[148.40205078125004,72.31196289062504],[149.50156250000012,72.16430664062497],[150.59980468750004,71.5201171875],[151.58242187500005,71.28696289062503],[152.50878906250003,70.83447265625003],[153.79414062500004,70.87998046874998],[155.8952148437501,71.09550781250002],[158.03701171875005,71.03925781250001],[159.35068359375006,70.79072265625001],[160.00644531250006,70.30966796875006],[159.83251953125003,69.78496093749999],[161.53691406250002,69.379541015625],[162.37568359375004,69.64907226562502],[164.1595703125,69.71928710937505],[164.51328125000006,69.60913085937497],[166.82031250000003,69.49956054687505],[167.62812500000004,69.74033203125006],[168.30302734375002,69.27148437500003],[169.31064453125006,69.07954101562498],[169.60986328124997,68.78603515624997],[170.53759765624997,68.82539062500001],[170.99541015625002,69.04531250000005],[170.58222656250004,69.58334960937506],[170.48681640625003,70.107568359375],[172.55957031249997,69.96835937499998],[173.27744140625006,69.823828125],[176.10751953125018,69.86030273437498],[176.92441406250018,69.64599609375003],[178.84833984375004,69.38720703124997],[180.00000000000003,68.98344726562505],[180.00000000000003,65.06723632812498],[178.51953125000003,64.60297851562498],[177.46718750000005,64.73681640624997],[177.43291015625002,64.44448242187502],[178.65029296875005,63.96528320312501],[178.7064453125001,63.52153320312502],[179.33232421875007,63.19018554687503],[179.5705078125001,62.6875],[179.12070312500012,62.32036132812499],[177.3512695312501,62.587451171875045],[175.26787109375002,62.102392578125006],[174.51435546875015,61.823632812499966],[173.6234375,61.716064453125],[172.85654296875006,61.469189453124955],[172.39277343750004,61.061767578125],[170.60820312500007,60.434912109375034],[169.9826171875001,60.067089843749955],[169.2267578125001,60.59594726562497],[168.13750000000007,60.57392578125001],[166.9640625000001,60.307031249999994],[166.35214843750006,60.48481445312498],[165.08457031250006,60.09858398437498],[163.78007812500007,60.041113281250006],[163.40996093750007,59.8349609375],[163.27285156250005,59.302587890625006],[162.14160156249997,58.44741210937502],[161.96005859375012,58.07690429687506],[162.4669921875001,57.766210937500006],[163.21386718750003,57.68681640624999],[162.77929687500003,57.35761718749998],[162.80263671875,56.81147460937501],[163.2565429687501,56.68803710937499],[163.33554687500012,56.232519531250006],[162.52822265625005,56.260693359374955],[162.08496093749997,56.08964843750002],[161.72939453125,55.358007812500006],[162.10556640625006,54.75214843750004],[161.72568359375006,54.53295898437506],[160.77265625000004,54.54135742187498],[160.0744140625001,54.18916015625001],[159.84374999999997,53.78364257812498],[159.89765625000004,53.380761718749966],[158.6087890625,52.873632812500034],[158.46347656250006,52.30498046875002],[158.10351562500003,51.80961914062499],[156.74775390625004,50.969287109375045],[156.500390625,51.47509765625006],[156.36474609374997,52.509375000000006],[156.0988281250001,53.00649414062502],[155.62031250000004,54.86455078125002],[155.5548828125001,55.348486328125034],[155.98251953125012,56.69521484375002],[156.72841796875,57.152246093749966],[157.4503906250001,57.79926757812498],[158.21044921875003,58.02529296875002],[159.03691406250002,58.423925781250034],[159.8473632812501,59.127148437499955],[161.75351562500012,60.15229492187501],[162.0036132812501,60.42016601562503],[162.97314453124997,60.782910156249955],[163.70996093749997,60.916796875000045],[164.00546875000006,61.34379882812499],[164.25566406250007,62.69658203124999],[163.33173828125004,62.550927734374994],[163.00927734374997,61.79150390625],[162.39257812500003,61.662109375],[160.76660156249997,60.753320312499966],[159.88310546875002,61.291796875000074],[160.31738281250003,61.79335937500002],[159.55234375000012,61.71948242187497],[159.07666015625003,61.922265624999994],[158.07011718750002,61.75361328125001],[157.46933593750012,61.798925781250006],[156.68027343750006,61.480615234374994],[156.62968750000002,61.27246093750003],[155.85332031250007,60.77714843750002],[154.97080078125012,60.376660156249955],[154.29306640625006,59.833349609375034],[154.58251953124997,59.540087890625074],[155.16669921875004,59.36015624999999],[154.01093750000004,59.075537109375006],[153.36113281250002,59.214794921874955],[152.8822265625,58.939062500000006],[151.99003906250002,59.160058593749994],[151.48574218750005,59.52412109375001],[150.45722656250004,59.590722656249994],[149.64257812499997,59.770410156249994],[149.20498046875,59.488183593749966],[147.87460937500006,59.388037109375006],[147.51445312500002,59.2685546875],[146.44433593749997,59.43046875000002],[145.93164062499997,59.198388671874994],[145.55458984375,59.413525390624955],[143.19218750000002,59.3701171875],[142.02539062499997,58.99965820312502],[141.75468750000007,58.745263671874966],[140.6849609375,58.21215820312497],[140.44687500000006,57.81367187499998],[140.00234375000005,57.68750000000003],[138.66210937500003,56.96552734375004],[137.69150390625006,56.13935546875004],[136.1751953125,55.35224609374998],[135.26250000000002,54.94331054687498],[135.85156249999997,54.583935546874955],[136.797265625,54.62099609375005],[136.68300781250005,53.93129882812505],[137.15537109375012,53.82167968750002],[137.3283203125001,53.538964843749966],[138.29218750000004,53.59243164062502],[138.66074218750012,53.744775390624966],[138.695703125,54.32001953125001],[139.707421875,54.27714843749999],[140.3470703125,53.812597656250034],[141.4020507812501,53.18398437500002],[141.16982421875005,52.36840820312497],[141.48525390625,52.17851562500002],[140.68769531250004,51.23227539062506],[140.47636718750007,50.545996093750034],[140.51718750000012,49.59614257812498],[140.17060546875004,48.52368164062497],[139.37265625000006,47.88735351562502],[139.00136718750005,47.38330078125],[138.58681640625005,47.057226562500006],[138.33691406250003,46.543408203124955],[137.68544921875,45.81835937500003],[136.80351562500002,45.171142578125],[136.14228515625004,44.489111328125034],[135.87460937500012,44.37353515625003],[135.1310546875001,43.52573242187506],[133.709375,42.82993164062506],[133.15996093750007,42.69697265624998],[132.30380859375006,42.88330078125],[131.72207031250005,43.20263671875006],[131.15830078125012,42.62602539062499],[130.68730468750007,42.30253906249999]]],[[[102.88476562499997,79.25395507812505],[105.14599609375003,78.81884765625006],[105.31259765625012,78.49990234375],[103.71933593750006,78.25825195312498],[101.20410156249997,78.19194335937505],[100.28398437500002,78.67919921875003],[101.59062500000002,79.350439453125],[102.88476562499997,79.25395507812505]]],[[[97.67451171875004,80.15825195312499],[100.0612304687501,79.77709960937506],[99.43955078125012,78.834228515625],[97.55546875000002,78.82656250000002],[94.65234375000003,79.12749023437505],[93.07080078124997,79.49531250000001],[94.98730468749997,80.096826171875],[97.67451171875004,80.15825195312499]]],[[[62.167773437500074,80.83476562500005],[61.05126953124997,80.418603515625],[59.30439453125004,80.52153320312502],[59.59228515625003,80.81650390624998],[62.167773437500074,80.83476562500005]]],[[[54.71894531250004,81.11596679687497],[57.69414062500002,80.79228515625002],[55.71250000000006,80.63730468749998],[54.06660156250004,80.81362304687502],[54.71894531250004,81.11596679687497]]],[[[96.52656250000004,81.0755859375],[97.83183593750002,80.79829101562498],[97.1751953125,80.24101562500007],[94.56503906250012,80.12607421875],[93.87236328125002,80.010107421875],[91.52382812500005,80.35854492187502],[93.26250000000002,80.79125976562497],[93.06513671875004,80.98847656250001],[95.80068359375005,81.28046874999998],[96.52656250000004,81.0755859375]]]]
},properties:{name:"Russia",childNum:22}},{geometry:{type:"Polygon",coordinates:[[[30.50996093750001,-1.0672851562500085],[30.47705078125,-1.0830078125],[30.47021484375,-1.1311523437500028],[30.508105468750017,-1.2082031250000114],[30.631933593750006,-1.3674804687500028],[30.710742187500017,-1.3967773437500028],[30.76220703125,-1.4586914062500114],[30.812597656250006,-1.5630859375000057],[30.827539062500023,-1.6936523437500028],[30.806738281250006,-1.8506835937500057],[30.819140625000017,-1.9674804687500114],[30.828710937500006,-2.3384765625000057],[30.762500000000017,-2.3716796875000057],[30.71484375,-2.3634765625000114],[30.656640625000023,-2.373828125000003],[30.593359375000006,-2.396777343750003],[30.553613281250023,-2.4000976562500114],[29.93017578125,-2.3395507812500114],[29.8681640625,-2.7164062500000057],[29.390234375000006,-2.80859375],[29.01435546875001,-2.72021484375],[28.876367187500023,-2.4002929687500085],[29.1064453125,-2.233203125000003],[29.12939453125,-1.8602539062500085],[29.576953125000017,-1.3878906250000114],[30.1015625,-1.36865234375],[30.360253906250023,-1.0746093750000085],[30.41230468750001,-1.0630859375000057],[30.46992187500001,-1.0660156250000057],[30.50996093750001,-1.0672851562500085]]]},properties:{name:"Rwanda",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[-8.683349609375,27.285937499999996],[-8.682324218749983,26.497705078124994],[-8.68212890625,26.273193359375],[-8.68212890625,26.10947265625],[-8.682226562499977,25.995507812499994],[-9.258203124999994,25.995507812499994],[-9.817187499999989,25.99545898437499],[-10.376123046874994,25.99545898437499],[-12.016308593749983,25.995410156250003],[-12.016308593749983,25.740136718749994],[-12.016308593749983,25.331689453124994],[-12.016308593749983,24.923242187499994],[-12.016308593749983,24.378662109375],[-12.016308593749983,23.97021484375],[-12.0234375,23.467578125000003],[-12.372900390624977,23.318017578124994],[-13.031494140625,23.000244140625],[-13.120898437499989,22.884082031250003],[-13.16650390625,22.753222656250003],[-13.155957031249983,22.68930664062499],[-13.107324218749994,22.560742187499997],[-13.094335937499977,22.495996093749994],[-13.051220703124983,21.854785156250003],[-13.041748046875,21.713818359374997],[-13.0322265625,21.572070312500003],[-13.025097656249983,21.466796875],[-13.016210937499977,21.333935546874997],[-15.231201171875,21.331298828125],[-16.964550781249983,21.329248046874994],[-17.06396484375,20.898828124999994],[-17.003076171874994,21.420703125000003],[-16.951123046874983,21.43027343749999],[-16.73095703125,21.47031249999999],[-15.750927734374983,21.49082031249999],[-15.610791015624983,21.47031249999999],[-15.4609375,21.45078124999999],[-15.15087890625,21.44101562499999],[-14.971142578124983,21.44101562499999],[-14.8408203125,21.45078124999999],[-14.7509765625,21.50058593749999],[-14.670849609374983,21.60019531249999],[-14.52099609375,21.990869140624994],[-14.22119140625,22.31015624999999],[-14.1708984375,22.76035156249999],[-14.12109375,22.96054687499999],[-14.10107421875,23.10019531249999],[-14.02099609375,23.41074218749999],[-13.89111328125,23.69101562499999],[-13.840771484374983,23.75058593749999],[-13.770947265624983,23.79062499999999],[-13.661083984374983,23.83066406249999],[-13.5810546875,23.87070312499999],[-13.39111328125,23.94101562499999],[-13.310986328124983,23.98105468749999],[-13.06103515625,24.40097656249999],[-12.991162109374983,24.47031249999999],[-12.7109375,24.63046874999999],[-12.630810546874983,24.68027343749999],[-12.5009765625,24.77011718749999],[-12.43115234375,24.83066406249999],[-12.40087890625,24.88046874999999],[-12.36083984375,24.97031249999999],[-12.310986328124983,25.11093749999999],[-12.03076171875,26.030859375],[-11.880859375,26.0708984375],[-11.7548828125,26.0865234375],[-11.718212890624983,26.1041015625],[-11.69921875,26.1626953125],[-11.684521484374983,26.2134765625],[-11.63720703125,26.2955078125],[-11.337890625,26.6333984375],[-11.316845703124983,26.7447265625],[-11.361279296874983,26.7935546875],[-11.392578125,26.8833984375],[-10.922802734374983,27.0103515625],[-10.25146484375,26.8609375],[-9.7353515625,26.8609375],[-9.413037109374983,27.0884765625],[-9.001904296874983,27.0904296875],[-8.794873046874983,27.120703125],[-8.753857421874983,27.1509765625],[-8.753857421874983,27.191015625],[-8.802685546874983,27.3609375],[-8.817822265624983,27.656445312499997],[-8.683349609375,27.656445312499997],[-8.683349609375,27.285937499999996]]]},properties:{name:"Western Sahara",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[46.53144531250004,29.09624023437499],[47.433203125000006,28.989550781250017],[47.671289062499994,28.53315429687504],[48.442480468750006,28.542919921874983],[48.90644531250004,27.62905273437505],[49.40527343749997,27.18095703124996],[49.986132812500074,26.828906250000017],[50.21386718750003,26.30849609375005],[50.031640624999994,26.11098632812505],[50.55791015625002,25.086669921875],[50.66689453125005,24.96381835937501],[50.72558593749997,24.869384765625057],[50.80439453125004,24.789257812499983],[50.85566406250004,24.67963867187501],[50.928320312500006,24.595117187500023],[50.96601562500004,24.573925781249983],[51.56835937500003,24.286181640625074],[51.592578125000074,24.07885742187503],[52.55507812500005,22.932812499999955],[55.104296875000074,22.621484375000023],[55.185839843750074,22.7041015625],[55.641015624999994,22.001855468749994],[54.97734375000002,19.995947265625006],[53.66689453125005,19.559130859375017],[51.977636718750006,18.996142578125074],[49.04199218750003,18.58178710937503],[48.17216796875002,18.156933593749983],[47.57958984374997,17.448339843750034],[47.441796874999994,17.111865234375045],[46.97568359375006,16.953466796875034],[46.682031249999994,17.2685546875],[46.31035156250002,17.231298828125063],[45.40654296875002,17.319775390624955],[45.14804687500006,17.427441406249955],[44.1559570312501,17.398535156250006],[43.91699218749997,17.32470703124997],[43.41796875000003,17.516259765625023],[43.19091796875003,17.35937500000003],[43.16503906249997,16.689404296874955],[42.79931640624997,16.37177734375001],[42.69882812500006,16.736962890624966],[42.38330078124997,17.122460937499994],[42.29394531249997,17.434960937499966],[41.75000000000003,17.88574218749997],[41.22949218750003,18.678417968749983],[41.116015625000074,19.082177734374994],[40.75917968750005,19.755468750000034],[40.080664062500006,20.265917968750017],[39.613671874999994,20.517675781249977],[39.093554687500074,21.31035156249999],[38.98789062500006,21.88173828125005],[39.09589843750004,22.392773437499983],[38.9411132812501,22.881835937500057],[38.46416015625002,23.71186523437504],[37.91972656250002,24.185400390625063],[37.54306640625006,24.291650390625023],[37.18085937500004,24.82001953125001],[37.148828124999994,25.291113281249977],[36.76269531250003,25.751318359375034],[36.24960937500006,26.594775390625017],[35.581347656250074,27.432470703125063],[35.18046875000002,28.03486328125004],[34.61621093749997,28.148339843749966],[34.779882812500006,28.50732421875],[34.950781250000006,29.353515625],[36.01542968750002,29.190478515625017],[36.068457031250006,29.200537109375006],[36.28281250000006,29.355371093750023],[36.47607421874997,29.49511718749997],[36.59179687500003,29.666113281250006],[36.703906250000074,29.831640624999977],[36.75527343750005,29.86601562499996],[37.46923828125003,29.995068359374955],[37.49072265625003,30.01171874999997],[37.55361328125005,30.14458007812496],[37.63359375000002,30.313281250000045],[37.64990234374997,30.330957031249994],[37.669726562500074,30.34814453125003],[37.862890625000006,30.44262695312503],[37.98007812500006,30.49999999999997],[37.47900390624997,31.007763671874955],[37.10527343750002,31.35517578125004],[36.95859375000006,31.491503906250017],[37.21562500000002,31.55610351562501],[37.49335937500004,31.625878906250023],[37.773828124999994,31.69633789062499],[38.962304687499994,31.99492187499999],[39.145410156249994,32.12451171875],[39.36865234374997,32.09174804687498],[39.70410156250003,32.04252929687499],[40.02783203124997,31.995019531249994],[40.3693359375001,31.93896484375003],[42.07441406250004,31.08037109374999],[42.857714843750074,30.495214843749977],[44.69082031250005,29.20234375000001],[46.35644531250003,29.06367187500001],[46.53144531250004,29.09624023437499]]]},properties:{name:"Saudi Arabia",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[36.87138671875002,21.996728515624994],[36.92695312500001,21.58652343749999],[37.15058593750001,21.103759765625],[37.2275390625,20.55673828124999],[37.24843750000002,19.58188476562499],[37.471289062500006,18.820117187500003],[37.921875,18.555908203125],[38.609472656250006,18.005078124999997],[38.422460937500006,17.823925781249997],[38.39716796875001,17.778369140625003],[38.38554687500002,17.751269531250003],[38.37373046875001,17.717333984375003],[38.34736328125001,17.68359375],[38.28984375000002,17.637011718750003],[38.26728515625001,17.61669921875],[38.253515625000006,17.584765625000003],[37.78242187500001,17.4580078125],[37.51015625000002,17.288134765625003],[37.45292968750002,17.108691406250003],[37.41103515625002,17.061718749999997],[37.24882812500002,17.056884765625],[37.169531250000006,17.041406249999994],[37.0615234375,17.061279296875],[37.00898437500001,17.058886718750003],[36.995214843750006,17.020556640625003],[36.97578125000001,16.86655273437499],[36.97871093750001,16.800585937500003],[36.887792968750006,16.624658203124994],[36.91376953125001,16.296191406250003],[36.566015625000006,15.362109375000003],[36.4267578125,15.132080078125],[36.44814453125002,14.940087890624994],[36.470800781250006,14.736474609374994],[36.52431640625002,14.2568359375],[36.390625,13.626074218749991],[36.21220703125002,13.271093749999991],[36.107519531250006,12.726464843749994],[35.59609375000002,12.537304687499997],[35.1123046875,11.816552734374994],[34.93144531250002,10.864794921874989],[34.571875000000006,10.880175781249989],[34.27568359375002,10.528124999999989],[34.29150390625,10.124755859375],[34.078125,9.461523437499991],[33.892187500000006,10.198974609375],[33.17216796875002,10.850146484374989],[33.07304687500002,11.591503906249997],[33.199316406250006,12.21728515625],[32.73671875000002,12.009667968749994],[32.072265625,12.006738281249994],[32.33535156250002,11.716015624999997],[32.40410156250002,11.057763671874994],[31.933007812500023,10.662499999999994],[31.654882812500006,10.221142578124997],[31.224902343750017,9.799267578124997],[30.739355468750006,9.74267578125],[30.003027343750006,10.277392578124989],[29.60546875,10.065087890624994],[29.47314453125,9.768603515624989],[28.999609375000006,9.610156249999989],[28.844531250000017,9.326074218749994],[28.048925781250006,9.32861328125],[27.885839843750006,9.599658203124989],[27.07421875,9.613818359374989],[26.551367187500006,9.525830078124997],[25.891503906250023,10.202734374999991],[25.79804687500001,10.420507812499991],[25.066992187500006,10.293798828124991],[24.785253906250006,9.774658203125],[24.53193359375001,8.886914062499997],[24.147363281250023,8.665624999999991],[23.53730468750001,8.815820312499994],[23.646289062500017,9.822900390624994],[23.312304687500017,10.387939453125],[22.86005859375001,10.919677734375],[22.922656250000017,11.344873046874994],[22.55634765625001,11.669531249999991],[22.352343750000017,12.660449218749989],[21.825292968750006,12.79052734375],[22.228125000000006,13.32958984375],[22.10761718750001,13.730322265624991],[22.50996093750001,14.12744140625],[22.38154296875001,14.550488281249997],[22.6708984375,14.722460937500003],[22.93232421875001,15.162109375],[23.10517578125001,15.702539062499994],[23.9833984375,15.780175781249994],[23.982226562500017,17.266357421875],[23.980273437500017,19.496630859375003],[23.980273437500017,19.99594726562499],[24.9794921875,20.002587890624994],[24.980273437500017,21.995849609375],[28.036425781250017,21.995361328125],[29.564550781250006,21.9951171875],[31.434472656250023,21.995849609375],[33.91845703125,21.996240234374994],[36.87138671875002,21.996728515624994]]]},properties:{name:"Sudan",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[34.078125,9.461523437499991],[34.09453125000002,8.582226562499997],[33.95332031250001,8.443505859374994],[33.23427734375002,8.396386718749994],[33.01259765625002,7.9515136718749915],[33.22597656250002,7.760644531249994],[33.666113281250006,7.6709960937499915],[34.06425781250002,7.225732421874994],[34.71064453125001,6.660302734374994],[35.08193359375002,5.673144531249989],[35.26835937500002,5.4922851562499915],[35.08447265625,5.3118652343749915],[34.87832031250002,5.109570312499997],[34.63984375000001,4.87548828125],[34.38017578125002,4.620654296874989],[34.176855468750006,4.419091796874994],[33.97607421875,4.22021484375],[33.74160156250002,3.9852539062499943],[33.568457031250006,3.811718749999997],[33.489355468750006,3.755078124999997],[32.83808593750001,3.7984863281249943],[32.33574218750002,3.7062011718749943],[32.09941406250002,3.5291992187499943],[31.79804687500001,3.8026367187499943],[31.47998046875,3.6804687499999886],[31.15234375,3.785595703124997],[30.83857421875001,3.49072265625],[30.50830078125,3.835693359375],[30.194921875000006,3.98193359375],[29.676855468750006,4.5869140625],[29.151464843750006,4.38818359375],[28.72705078125,4.5049804687499915],[28.19208984375001,4.350244140624994],[27.7880859375,4.644677734374994],[27.4033203125,5.109179687499989],[27.083398437500023,5.77685546875],[26.514257812500006,6.069238281249994],[26.36181640625,6.635302734374989],[25.888964843750017,7.06494140625],[25.380664062500017,7.333398437499994],[25.247363281250017,7.724560546874997],[24.853320312500017,8.137548828124991],[24.291406250000023,8.291406249999994],[24.147363281250023,8.665624999999991],[24.53193359375001,8.886914062499997],[24.785253906250006,9.774658203125],[25.066992187500006,10.293798828124991],[25.79804687500001,10.420507812499991],[25.891503906250023,10.202734374999991],[26.551367187500006,9.525830078124997],[27.07421875,9.613818359374989],[27.885839843750006,9.599658203124989],[28.048925781250006,9.32861328125],[28.844531250000017,9.326074218749994],[28.999609375000006,9.610156249999989],[29.47314453125,9.768603515624989],[29.60546875,10.065087890624994],[30.003027343750006,10.277392578124989],[30.739355468750006,9.74267578125],[31.224902343750017,9.799267578124997],[31.654882812500006,10.221142578124997],[31.933007812500023,10.662499999999994],[32.40410156250002,11.057763671874994],[32.33535156250002,11.716015624999997],[32.072265625,12.006738281249994],[32.73671875000002,12.009667968749994],[33.199316406250006,12.21728515625],[33.07304687500002,11.591503906249997],[33.17216796875002,10.850146484374989],[33.892187500000006,10.198974609375],[34.078125,9.461523437499991]]]},properties:{name:"South Sudan",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[-12.280615234374977,14.809033203124997],[-12.019189453124994,14.206494140624997],[-12.05419921875,13.633056640625],[-11.634960937499983,13.369873046875],[-11.390380859375,12.941992187499991],[-11.389404296875,12.404394531249991],[-12.291210937499983,12.328027343749994],[-13.082910156249994,12.633544921875],[-13.40576171875,12.662255859374994],[-13.729248046875,12.673925781249991],[-14.064843749999994,12.67529296875],[-14.349218749999977,12.676416015624994],[-15.196093749999989,12.679931640625],[-15.3779296875,12.588964843749991],[-15.574804687499977,12.490380859374994],[-15.839550781249983,12.437890624999994],[-16.144189453124994,12.457421874999994],[-16.41630859374999,12.36767578125],[-16.521337890624977,12.3486328125],[-16.656933593749983,12.364355468749991],[-16.711816406249994,12.354833984374991],[-16.763330078124994,13.064160156249997],[-16.648779296874977,13.154150390624991],[-15.834277343749989,13.156445312499997],[-15.509667968749994,13.586230468750003],[-16.56230468749999,13.587304687499994],[-17.168066406249977,14.640625],[-17.147167968749983,14.922021484374994],[-16.570751953124983,15.734423828125003],[-16.441015624999977,16.204541015624997],[-16.168359374999994,16.547070312499997],[-15.768212890624994,16.485107421875],[-15.112646484374977,16.644921874999994],[-14.300097656249989,16.580273437499997],[-13.756640624999989,16.172509765624994],[-13.40966796875,16.05917968749999],[-13.105273437499989,15.57177734375],[-12.858496093749977,15.242529296874991],[-12.40869140625,14.889013671874991],[-12.280615234374977,14.809033203124997]]]},properties:{name:"Senegal",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[-37.10332031249996,-54.06562500000004],[-36.32646484374996,-54.251171875000004],[-35.79858398437497,-54.76347656250002],[-36.08549804687499,-54.86679687500001],[-37.10332031249996,-54.06562500000004]]]},properties:{name:"United Kingdom",childNum:1}},{geometry:{type:"MultiPolygon",coordinates:[[[[161.71533203124997,-10.387304687499991],[162.10537109375005,-10.45380859375004],[162.12363281250012,-10.824414062499955],[161.53789062500007,-10.566406249999972],[161.71533203124997,-10.387304687499991]]],[[[159.75039062500005,-9.272656250000011],[159.97060546875,-9.433300781249969],[160.35458984375006,-9.421582031249983],[160.62548828124997,-9.588867187499957],[160.64921875000002,-9.92861328124998],[159.85371093750004,-9.791503906250028],[159.62187500000007,-9.532128906250023],[159.75039062500005,-9.272656250000011]]],[[[160.7494140625,-8.313964843750014],[160.99765625000006,-8.612011718749983],[161.2584960937501,-9.316894531249972],[160.87343750000005,-9.156835937499949],[160.59042968750006,-8.372753906249997],[160.7494140625,-8.313964843750014]]],[[[159.8791015625001,-8.534277343749949],[158.9440429687501,-8.04072265625004],[159.10937500000003,-7.903515624999969],[159.84306640625002,-8.326953124999989],[159.8791015625001,-8.534277343749949]]]]},properties:{name:"Solomon Islands",childNum:4}},{geometry:{type:"Polygon",coordinates:[[[-10.758593749999989,9.385351562499991],[-10.500537109375017,8.687548828125017],[-10.677343749999977,8.400585937499997],[-10.570849609374932,8.071142578125034],[-10.878076171874994,7.538232421874994],[-11.267675781249977,7.232617187499997],[-11.507519531249983,6.906542968750003],[-11.733447265625017,7.088574218750054],[-12.48564453124996,7.3862792968750455],[-12.510449218749955,7.66572265625004],[-12.88095703124992,7.856640625000026],[-12.956933593749966,8.145312500000045],[-13.272753906249989,8.429736328124989],[-13.271630859374937,8.987402343750006],[-13.292675781249955,9.04921874999998],[-13.234228515624949,9.070117187499974],[-13.129882812500028,9.047558593749997],[-13.077294921874966,9.069628906249974],[-13.028027343749955,9.103564453125045],[-12.958789062499989,9.263330078124994],[-12.557861328125,9.704980468749994],[-12.142333984375,9.875390624999994],[-11.911083984374955,9.993017578124977],[-11.273632812499955,9.996533203124983],[-11.205664062499949,9.977734374999969],[-11.047460937499977,9.786328125000054],[-10.758593749999989,9.385351562499991]]]},properties:{name:"Sierra Leone",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[-89.36259765624999,14.416015625],[-88.51254882812499,13.978955078124997],[-88.504345703125,13.964208984374991],[-88.49765624999999,13.904541015625],[-88.482666015625,13.854248046875],[-88.44912109375,13.850976562499994],[-88.40849609374999,13.875390624999994],[-88.27622070312499,13.942675781250003],[-88.151025390625,13.987353515625003],[-87.99101562499999,13.879638671875],[-87.80224609375,13.889990234374991],[-87.71533203125,13.812695312499997],[-87.781884765625,13.521386718749994],[-87.930859375,13.1806640625],[-88.51201171874999,13.183935546874991],[-89.27763671874999,13.478076171875003],[-89.80419921875,13.560107421875003],[-90.09521484375,13.736523437499997],[-89.872705078125,14.045605468749997],[-89.36259765624999,14.416015625]]]},properties:{name:"El Salvador",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[48.938574218750006,11.258447265624994],[48.938085937500006,9.451757812499991],[47.97822265625001,7.9970703125],[46.97822265625001,7.9970703125],[44.02285156250002,8.986035156249997],[43.482519531250006,9.379492187499991],[43.181640625,9.879980468749991],[42.84160156250002,10.203076171874997],[42.65957031250002,10.621386718749989],[42.92275390625002,10.999316406249989],[43.24599609375002,11.499804687499989],[43.85273437500001,10.784277343749991],[44.38652343750002,10.430224609374989],[44.942968750000006,10.436718749999997],[45.81669921875002,10.835888671874997],[46.565039062500006,10.745996093749994],[47.40498046875001,11.174023437499997],[48.01923828125001,11.139355468749997],[48.674414062500006,11.322656249999994],[48.938574218750006,11.258447265624994]]]},properties:{name:"Somaliland",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[41.88398437500001,3.977734374999997],[41.91533203125002,4.031298828124989],[42.02412109375001,4.137939453125],[42.791601562500006,4.2919921875],[43.01601562500002,4.5633300781249915],[43.53828125000001,4.84033203125],[44.02812500000002,4.950976562499989],[44.940527343750006,4.912011718749994],[45.93496093750002,5.997216796874994],[47.97822265625001,7.9970703125],[48.938085937500006,9.451757812499991],[48.938574218750006,11.258447265624994],[50.11005859375001,11.529296875],[50.79228515625002,11.983691406249989],[51.2548828125,11.830712890624994],[51.08427734375002,11.335644531249997],[51.140625,10.656884765624994],[50.8984375,10.253124999999997],[50.82500000000002,9.428173828124997],[50.429785156250006,8.845263671874989],[50.10283203125002,8.199804687499991],[49.34853515625002,6.990527343749989],[49.04931640625,6.173632812499989],[48.649023437500006,5.494384765625],[47.97529296875001,4.497021484374997],[46.87880859375002,3.28564453125],[46.05117187500002,2.4751464843749886],[44.92021484375002,1.8101562499999915],[44.33271484375001,1.3909667968749915],[43.46767578125002,.6216308593749886],[41.97988281250002,-.9730468750000085],[41.73222656250002,-1.4300781250000085],[41.52187500000002,-1.572265625],[41.42695312500001,-1.4495117187500028],[41.24980468750002,-1.2205078125000028],[40.97871093750001,-.8703125000000114],[40.97001953125002,1.378173828125],[40.964453125000006,2.814648437499997],[41.341796875,3.20166015625],[41.61347656250001,3.5904785156249943],[41.88398437500001,3.977734374999997]]]},properties:{name:"Somalia",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[21.431445312500017,45.192529296874994],[21.384375000000034,44.87006835937501],[22.687890625000023,44.248291015625],[22.42080078125005,44.00742187500006],[22.399023437500063,43.96953124999996],[22.36542968750004,43.86210937500002],[22.36962890625003,43.78129882812499],[22.386914062500068,43.74013671875005],[22.39482421874999,43.70664062500006],[22.436328125000017,43.66547851562501],[22.47412109375,43.60224609375001],[22.55458984375005,43.45449218750002],[22.767578125,43.35415039062502],[22.81972656250005,43.300732421874955],[22.85957031250001,43.252343749999966],[22.97685546874999,43.18798828125],[22.799902343750006,42.985742187499994],[22.466796875,42.842480468749955],[22.465625000000045,42.75078125000002],[22.46328125000008,42.70947265625003],[22.436230468749983,42.62910156250001],[22.523535156250006,42.440966796875045],[22.44570312500005,42.35913085937497],[22.42207031250004,42.32885742187503],[22.344042968750045,42.31396484375003],[22.23974609375003,42.35815429687506],[22.146679687500068,42.325000000000045],[22.052050781250074,42.30463867187498],[21.904101562500045,42.32207031249999],[21.56249999999997,42.24750976562498],[21.541601562499977,42.28081054687502],[21.51894531250008,42.32841796875002],[21.52998046875001,42.349999999999994],[21.390625000000057,42.751416015624955],[21.057031250000023,43.09169921875002],[20.339941406250063,42.89287109375002],[19.670996093750006,43.163964843749994],[19.19433593749997,43.533300781250006],[19.583789062500017,44.04345703125003],[19.15185546875003,44.302539062500045],[19.35683593750005,44.858544921874994],[19.007128906250045,44.86918945312502],[19.055078125000023,45.527246093749966],[18.905371093750006,45.931738281250034],[19.421289062500023,46.064453125],[19.61347656250001,46.169189453125],[20.161425781250017,46.14189453124996],[20.210156250000068,46.12602539062502],[20.241796875000034,46.10859375000001],[20.35859375000004,45.975488281249994],[20.775000000000034,45.74980468750002],[20.774218750000074,45.484423828125045],[21.431445312500017,45.192529296874994]]]},properties:{name:"Republic of Serbia",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[-54.03422851562499,3.62939453125],[-54.203125,3.13818359375],[-54.17070312499999,2.993603515624997],[-54.18808593749999,2.8748535156249915],[-54.1955078125,2.81787109375],[-54.256738281249994,2.7137207031249915],[-54.402001953124994,2.4615234374999915],[-54.53593749999999,2.3433105468749886],[-54.56840820312499,2.3425781249999886],[-54.604736328125,2.3357910156249915],[-54.61625976562499,2.3267578124999915],[-54.661865234375,2.3275390624999943],[-54.697412109374994,2.359814453124997],[-54.72221679687499,2.441650390625],[-54.766845703125,2.4547363281249943],[-54.85166015624999,2.4395507812499915],[-54.87607421874999,2.450390624999997],[-54.92656249999999,2.4973632812499886],[-54.968408203124994,2.54833984375],[-54.978662109374994,2.59765625],[-55.005810546875,2.592968749999997],[-55.0703125,2.54833984375],[-55.11411132812499,2.5392089843749943],[-55.1876953125,2.5475097656249943],[-55.286035156249994,2.4996582031249943],[-55.343994140625,2.48876953125],[-55.38535156249999,2.440624999999997],[-55.73056640624999,2.4061523437499943],[-55.935937499999994,2.5166015625],[-56.02036132812499,2.392773437499997],[-56.087792968749994,2.34130859375],[-56.12939453125,2.299511718749997],[-56.019921874999994,1.8422363281249972],[-56.482812499999994,1.942138671875],[-56.704345703125,2.0364746093749915],[-57.20981445312499,2.8828125],[-57.303662109375,3.3770996093749943],[-57.54960937499999,3.3528320312499886],[-57.832666015624994,3.675976562499997],[-58.05449218749999,4.171923828124989],[-57.711083984374994,4.9910644531249915],[-57.331005859375,5.020166015624994],[-57.194775390625,5.5484374999999915],[-56.96982421874999,5.992871093749997],[-55.93955078124999,5.795458984374989],[-55.82817382812499,5.961669921875],[-54.83369140625,5.988330078124989],[-54.05419921875,5.807910156249989],[-54.15595703125,5.3589843749999915],[-54.45219726562499,5.013476562499989],[-54.350732421874994,4.054101562499994],[-54.03422851562499,3.62939453125]]]},properties:{name:"Suriname",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[22.538671875000006,49.072705078125],[22.52412109375001,49.031396484374994],[22.432031250000023,48.933544921875],[22.389453125000017,48.873486328125],[22.295214843750017,48.685839843749996],[22.142871093750017,48.568505859374994],[22.1318359375,48.405322265624996],[21.45136718750001,48.55224609375],[20.490039062500017,48.526904296874996],[19.89863281250001,48.13134765625],[18.914160156250006,48.050830078124996],[18.724218750000006,47.787158203124996],[17.76191406250001,47.770166015624994],[17.147363281250023,48.00595703125],[16.953125,48.598828125],[17.1884765625,48.8609375],[17.75849609375001,48.888134765625],[18.160937500000017,49.257373046874996],[18.83222656250001,49.510791015624996],[19.44160156250001,49.597705078124996],[19.80224609375,49.192333984375],[20.616113281250023,49.39169921875],[21.6396484375,49.411962890625],[22.538671875000006,49.072705078125]]]},properties:{name:"Slovakia",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[16.516210937500006,46.499902343749994],[16.427636718750023,46.5244140625],[16.321191406250023,46.534619140625],[16.1064453125,46.382226562499994],[16.00068359375001,46.30537109375],[15.784277343750006,46.233984375],[15.704199218750006,46.213232421875],[15.635937500000011,46.200732421874996],[15.608984375000006,46.171923828124996],[15.592578125000017,46.139990234375],[15.596875000000011,46.109228515625],[15.666210937500011,46.048486328124994],[15.668066406250006,45.904443359374994],[15.652148437500017,45.862158203125],[15.624804687500017,45.834033203124996],[14.95458984375,45.499902343749994],[13.878710937500017,45.428369140624994],[13.831152343750006,45.680419921875],[13.663476562500023,45.7919921875],[13.420996093750006,46.212304687499994],[13.399511718750006,46.317529296874994],[13.6796875,46.462890625],[13.700000000000017,46.520263671875],[14.503515625000006,46.417041015624996],[15.000683593750011,46.6259765625],[15.957617187500006,46.677636718749994],[16.093066406250017,46.86328125],[16.516210937500006,46.499902343749994]]]},properties:{name:"Slovenia",childNum:1}},{geometry:{type:"MultiPolygon",coordinates:[[[[19.076464843750045,57.8359375],[18.699902343750068,57.24272460937502],[18.136523437500045,57.55664062500003],[18.53740234374999,57.83056640625006],[19.076464843750045,57.8359375]]],[[[24.15546875000004,65.80527343750006],[23.102343750000074,65.73535156250003],[21.565527343750063,65.40810546874997],[21.138183593750057,64.80869140625006],[21.46503906250001,64.37958984375004],[20.76269531250003,63.86782226562505],[19.034374999999983,63.23774414062501],[18.46308593750004,62.895849609375006],[17.895605468749977,62.83051757812501],[17.417285156250074,61.74067382812504],[17.13076171875005,61.57573242187499],[17.25097656250003,60.700781250000006],[17.955761718750068,60.589794921874955],[18.557519531250023,60.25356445312502],[18.970507812500045,59.757226562499994],[18.285351562500068,59.10937499999997],[17.45673828125001,58.8583984375],[16.651953125000006,58.43432617187503],[16.527929687500063,57.06816406249999],[15.996679687500006,56.22260742187501],[14.782031250000017,56.16191406250002],[14.21503906250004,55.83261718749998],[14.341699218749994,55.52773437500002],[13.321386718750063,55.34638671875004],[12.592578124999989,56.13759765625002],[12.883691406250051,56.61772460937496],[12.421484375000034,56.906396484374966],[11.449316406250063,58.118359374999955],[11.14716796875004,58.98862304687498],[11.388281250000063,59.036523437499966],[11.798144531250074,59.28989257812498],[11.680761718750034,59.59228515625003],[12.486132812500074,60.10678710937506],[12.588671874999989,60.450732421875045],[12.29414062500004,61.00268554687506],[12.88076171875008,61.35229492187506],[12.155371093750006,61.720751953125045],[12.303515625000074,62.28559570312501],[12.218164062500023,63.00063476562502],[11.999902343750051,63.29169921875001],[12.662500000000023,63.94047851562502],[13.960546875000063,64.01401367187498],[14.077636718750028,64.464013671875],[13.650292968750023,64.58154296874997],[14.47968750000004,65.30146484374998],[14.543261718750045,66.12934570312498],[15.422949218750006,66.48984374999998],[16.40351562500004,67.05498046875002],[16.12744140625,67.42583007812507],[17.324609375000023,68.10380859374999],[17.91669921875001,67.96489257812502],[18.378613281250068,68.56240234374997],[19.969824218750063,68.35639648437501],[20.622167968750006,69.036865234375],[21.99746093750005,68.52060546874998],[22.78242187500001,68.39101562499997],[23.63886718750004,67.95439453125002],[23.468066406250074,67.449951171875],[23.988574218750045,66.81054687500003],[23.70117187500003,66.48076171874999],[24.15546875000004,65.80527343750006]]]]},properties:{name:"Sweden",childNum:2}},{geometry:{type:"Polygon",coordinates:[[[31.9482421875,-25.957617187500006],[32.04140625000002,-26.28125],[32.10595703125,-26.52001953125],[32.112890625000006,-26.839453125000006],[32.02480468750002,-26.811132812500006],[31.994726562500006,-26.817480468750006],[31.967187500000023,-26.96064453125001],[31.946093750000017,-27.173632812500003],[31.958398437500023,-27.30585937500001],[31.742578125000023,-27.30996093750001],[31.469531250000017,-27.295507812500006],[31.274023437500006,-27.238378906250006],[31.063378906250023,-27.1123046875],[30.794335937500023,-26.764257812500006],[30.803320312500006,-26.41347656250001],[31.207324218750017,-25.843359375000006],[31.415136718750006,-25.74658203125],[31.921679687500017,-25.96875],[31.9482421875,-25.957617187500006]]]},properties:{name:"Swaziland",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[42.358984375000006,37.10859375],[41.78857421875,36.59716796875],[41.41679687500002,36.5146484375],[41.24560546875,36.073388671874994],[41.354101562500006,35.640429687499996],[41.19472656250002,34.768994140625],[40.98701171875001,34.429052734375],[40.689453125,34.33203125],[38.773535156250006,33.372216796874994],[36.818359375,32.317285156249994],[36.3720703125,32.3869140625],[35.78730468750001,32.734912109374996],[35.869140625,33.43173828125],[35.9423828125,33.667578125],[36.5849609375,34.221240234374996],[36.43300781250002,34.6134765625],[35.97626953125001,34.629199218749996],[35.94306640625001,35.223828125],[35.76445312500002,35.571582031249996],[36.12734375000002,35.831445312499994],[36.53750000000002,36.457421874999994],[36.54667968750002,36.50634765625],[36.59687500000001,36.7013671875],[36.62841796875,36.777685546875],[36.65859375000002,36.802539062499996],[36.77656250000001,36.79267578125],[36.94179687500002,36.7583984375],[36.9853515625,36.702392578125],[37.06621093750002,36.652636718749996],[37.43632812500002,36.643310546875],[37.523535156250006,36.6783203125],[37.720312500000006,36.743701171874996],[37.90664062500002,36.79462890625],[38.19169921875002,36.9015625],[38.7666015625,36.693115234375],[39.1083984375,36.680566406249994],[39.35664062500001,36.681591796875],[39.50146484375,36.70224609375],[39.6865234375,36.738623046875],[40.01640625000002,36.826074218749994],[40.705664062500006,37.097705078124996],[41.886816406250006,37.156396484374994],[42.358984375000006,37.10859375]]]
},properties:{name:"Syria",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[23.980273437500017,19.496630859375003],[23.982226562500017,17.266357421875],[23.9833984375,15.780175781249994],[23.10517578125001,15.702539062499994],[22.93232421875001,15.162109375],[22.6708984375,14.722460937500003],[22.38154296875001,14.550488281249997],[22.50996093750001,14.12744140625],[22.10761718750001,13.730322265624991],[22.228125000000006,13.32958984375],[21.825292968750006,12.79052734375],[22.352343750000017,12.660449218749989],[22.55634765625001,11.669531249999991],[22.922656250000017,11.344873046874994],[22.86005859375001,10.919677734375],[22.49384765625001,10.996240234374994],[21.70654296875,10.574804687499991],[21.72578125000001,10.366552734374991],[21.26386718750001,9.974609375],[20.773242187500017,9.405664062499994],[20.342089843750017,9.127099609374994],[19.1455078125,9.015966796874991],[19.108691406250017,8.656152343749994],[18.455078125,8.032031249999989],[17.6494140625,7.983593749999997],[16.784765625000006,7.550976562499997],[16.37890625,7.683544921874997],[15.845019531250017,7.475292968749997],[15.480078125000006,7.5237792968749915],[15.442968750000006,7.851855468749989],[15.1162109375,8.557324218749997],[14.332324218750017,9.203515624999994],[13.977246093750011,9.691552734374994],[14.243261718750006,9.979736328125],[15.540917968750023,9.960302734374991],[15.276074218750011,10.357373046874997],[15.029882812500006,11.113671874999994],[15.081250000000011,11.845507812499989],[14.76123046875,12.655615234374991],[14.516210937500006,12.979736328125],[14.244824218750011,13.077343749999997],[14.06396484375,13.078515624999994],[13.932324218750011,13.258496093749997],[13.606347656250023,13.70458984375],[13.505761718750023,14.134423828124994],[13.4482421875,14.380664062500003],[14.367968750000017,15.750146484374994],[15.474316406250011,16.908398437499997],[15.735058593750011,19.904052734375],[15.948828125000006,20.303173828124997],[15.587109375000011,20.733300781249994],[15.607324218750023,20.954394531250003],[15.181835937500011,21.523388671874997],[15.172265625000023,21.922070312499997],[14.97900390625,22.99619140624999],[15.984082031250011,23.445214843749994],[18.231347656250023,22.33554687499999],[19.668554687500006,21.62583007812499],[21.5849609375,20.679492187500003],[23.980273437500017,19.496630859375003]]]},properties:{name:"Chad",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[.9004882812500057,10.993261718749991],[.7799804687500114,10.359570312499997],[1.330078125,9.996972656249994],[1.42431640625,9.285009765624991],[1.6001953125000057,9.050048828125],[1.6226562500000057,6.216796875],[1.1872070312500114,6.089404296874989],[.7369140625000057,6.452587890624997],[.5255859375000114,6.8509277343749915],[.634765625,7.353662109374994],[.5835937500000057,8.145800781249989],[.6880859375000057,8.304248046874989],[.41533203125001705,8.652734374999994],[.5290039062500114,9.358300781249994],[.26191406250001137,9.49560546875],[.36269531250002274,10.236474609374994],[-.05771484374997726,10.630615234375],[-.068603515625,11.115624999999994],[.9004882812500057,10.993261718749991]]]},properties:{name:"Togo",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[100.12246093750005,20.316650390625057],[100.31796875000006,20.38588867187505],[100.51953125000003,20.17792968750004],[100.53994140625,20.13237304687499],[100.54306640625012,20.088671875000074],[100.51455078125,19.996337890625],[100.39765625000004,19.756103515625],[100.62548828125003,19.499853515625006],[101.1546875,19.579199218750006],[101.22080078125006,19.486621093750074],[101.19755859375007,19.327929687500074],[101.2863281250001,18.977148437500006],[101.16552734375003,18.618310546874994],[101.10634765625005,18.533544921875063],[101.06044921875,18.479003906250057],[101.05058593750002,18.407031250000045],[101.11328125000003,18.033544921874977],[100.90849609375002,17.583886718750023],[101.10517578125004,17.47954101562499],[101.68750000000003,17.889404296875],[101.77480468750005,18.03339843750004],[101.81865234375002,18.06464843750001],[101.87548828124997,18.046435546875017],[101.94746093750004,18.081494140624983],[102.03457031250005,18.169824218750023],[102.10146484375,18.210644531249983],[102.14824218750002,18.20385742187503],[102.23164062500004,18.148974609375045],[102.35185546875002,18.045947265625017],[102.71757812500002,17.892236328124966],[103.05136718750006,18.02851562500001],[103.36699218750007,18.42333984374997],[103.62968750000002,18.38256835937503],[103.79228515625002,18.316503906249977],[103.89882812500005,18.295312500000023],[103.949609375,18.31899414062505],[104.04873046875005,18.216699218749994],[104.42812500000005,17.69897460937503],[104.81601562500012,17.30029296874997],[104.75898437500004,17.0771484375],[104.75058593750012,16.647558593750063],[104.81933593750003,16.46606445312503],[104.94990234375004,16.339941406250006],[105.02578125000005,16.23798828125001],[105.04716796875007,16.160253906249977],[105.14873046875007,16.09355468749999],[105.33066406250006,16.037890625000017],[105.40625000000003,15.987451171875051],[105.37324218750004,15.889697265625017],[105.39892578124997,15.829882812500017],[105.46201171875012,15.780419921874966],[105.62207031250003,15.699951171875],[105.51318359374997,15.360888671875031],[105.47558593750003,14.530126953124977],[105.34218750000005,14.416699218750054],[105.24365234375003,14.367871093750054],[105.1833007812501,14.346240234374989],[105.16914062500004,14.336083984374966],[105.12597656250003,14.280957031250011],[105.07412109375005,14.227441406250037],[104.96972656249997,14.366113281250051],[104.77900390625004,14.427832031250006],[103.19941406250004,14.332617187499977],[102.72890625,13.841894531250006],[102.31972656250005,13.539990234375054],[102.49960937500012,12.669970703125003],[102.75566406250002,12.42626953125],[102.73662109375007,12.089794921875011],[102.93388671875002,11.706689453125037],[102.76298828125002,12.012451171874986],[101.72363281250003,12.689355468750037],[101.44492187500006,12.618945312499989],[100.86328124999997,12.714501953125009],[100.96269531250007,13.431982421874991],[100.65605468750002,13.521289062499974],[100.01748046875,13.353173828125009],[100.08994140625006,13.045654296874972],[99.96396484375006,12.690039062500006],[99.98906250000007,12.170800781249994],[99.62734375,11.462890625000014],[99.48691406250006,10.889550781250009],[99.16503906250003,10.319824218750028],[99.16074218750006,9.734033203124966],[99.39384765625002,9.21372070312502],[99.7238281250001,9.314208984374972],[99.9046875,9.112890624999991],[99.96064453125004,8.671240234374991],[100.27939453125006,8.268505859375011],[100.453515625,7.442285156249994],[100.58623046875002,7.175976562500011],[101.01787109375002,6.860937500000034],[101.49794921875005,6.865283203125031],[102.10107421874997,6.242236328125031],[101.87363281250012,5.8252929687499915],[101.5560546875,5.907763671875003],[101.2570312500001,5.7893554687500455],[101.05351562500002,6.2425781250000085],[100.3454101562501,6.549902343750006],[100.11914062499997,6.441992187500048],[99.69599609375004,6.87666015625004],[99.72031250000012,7.106201171875],[99.05107421875002,7.887841796874994],[98.57919921875006,8.344287109374989],[98.23818359375005,8.423095703124972],[98.37138671875002,9.290527343750028],[98.70253906250005,10.19038085937504],[98.7572265625,10.660937499999974],[99.1901367187501,11.105273437499989],[99.61474609374997,11.781201171875026],[99.40507812500002,12.547900390625003],[99.21982421875012,12.73974609375],[99.13681640625006,13.716699218749994],[98.24599609375005,14.814746093750045],[98.19101562500012,15.204101562499972],[98.56523437500007,15.403564453125014],[98.68925781250002,16.30541992187497],[98.4388671875,16.975683593750034],[97.79296875000003,17.681250000000063],[97.48496093750006,18.494238281250034],[97.75400390625006,18.620800781249983],[97.816796875,19.459960937500057],[98.23906250000002,19.69067382812497],[98.9166992187501,19.77290039062504],[99.02070312500004,20.041796875000017],[99.33789062499997,20.078906250000017],[99.8903320312501,20.424414062499977],[100.12246093750005,20.316650390625057]]]},properties:{name:"Thailand",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[70.95800781250003,40.238867187500034],[70.59921875,39.974511718749994],[69.96679687499997,40.202246093750034],[69.47099609375002,39.990624999999994],[69.22910156250006,39.761083984375034],[69.29765625000007,39.52480468750005],[69.59882812500004,39.57377929687499],[69.7720703125,39.55673828124998],[70.13681640625006,39.55756835937498],[70.17109375000004,39.58417968749998],[70.20927734375007,39.57499999999996],[70.24482421875004,39.54262695312502],[70.6078125,39.56440429687504],[70.67861328125005,39.47128906249998],[70.73310546875004,39.41328124999998],[70.79931640625003,39.39472656250001],[71.00488281249997,39.41186523437503],[71.06503906250006,39.49340820312506],[71.11806640625005,39.513574218749966],[71.27285156250005,39.535302734374966],[71.328515625,39.568701171875006],[71.40429687499997,39.59785156250001],[71.73222656250002,39.422998046874994],[72.63994140625002,39.385986328125],[73.2349609375,39.37456054687499],[73.3361328125001,39.41235351562506],[73.38740234375004,39.442724609375034],[73.4704101562501,39.46059570312502],[73.63164062500007,39.44887695312502],[73.63632812500006,39.396679687499955],[73.60732421875,39.229199218749955],[73.7956054687501,39.00214843749998],[73.80166015625,38.60688476562501],[74.27744140625,38.659765625000034],[74.74501953125,38.51000976562497],[74.89130859375004,37.231640624999955],[74.65937500000004,37.39448242187501],[74.25966796875005,37.41542968750002],[74.20351562500005,37.37246093750005],[74.16708984375,37.32944335937498],[73.74960937500006,37.23178710937498],[73.6535156250001,37.239355468750034],[73.72060546875,37.41874999999999],[73.65712890625005,37.43046874999996],[73.63261718750002,37.43720703125001],[73.6046875000001,37.44604492187503],[73.48134765625,37.4716796875],[73.38291015625006,37.462255859375034],[73.21113281250004,37.40849609375002],[72.89550781250003,37.26752929687498],[72.65742187500004,37.029052734375],[71.665625,36.696923828124994],[71.530859375,36.845117187499994],[71.43291015625007,37.12753906249998],[71.5050781250001,37.60292968750002],[71.58037109375007,37.86425781250006],[71.5822265625001,37.91010742187498],[71.55195312500004,37.93315429687496],[71.48779296874997,37.93188476562497],[71.38964843750003,37.90629882812502],[71.31992187500006,37.90185546875],[71.27851562500004,37.91840820312498],[71.2828125,38.007910156250006],[71.33271484375004,38.170263671875034],[71.25585937499997,38.306982421875006],[70.87890624999997,38.45639648437498],[70.41777343750002,38.075439453125],[70.25146484374997,37.66416015625006],[69.9849609375,37.566162109375],[69.8208984375,37.60957031250004],[69.62578125000002,37.59404296874999],[69.49208984375,37.55307617187498],[69.42011718750004,37.486718749999966],[69.39921875000007,37.39931640625002],[69.42968749999997,37.290869140625034],[69.414453125,37.20776367187497],[69.35380859375007,37.15004882812502],[69.3039062500001,37.11694335937503],[69.26484375000004,37.1083984375],[69.18017578125003,37.158300781250034],[68.96044921875003,37.32504882812498],[68.6691406250001,37.258398437500006],[68.3869140625001,37.13749999999996],[68.2121093750001,37.02153320312496],[68.0677734375,36.949804687500006],[67.95800781249997,36.972021484375006],[67.83447265624997,37.06420898437506],[67.75898437500004,37.172216796875034],[67.7980468750001,37.244970703125006],[67.81435546875005,37.48701171875004],[68.29404296875006,38.032910156249955],[68.04785156250003,38.669287109375006],[68.10351562499997,38.96201171875006],[67.67656250000002,39.00849609375001],[67.34960937499997,39.242089843749994],[67.71904296875007,39.62138671875002],[68.46328125,39.53671874999998],[68.6525390625001,40.182666015625045],[69.22832031250007,40.18759765624998],[69.2062500000001,40.566552734374994],[69.71289062500003,40.65698242187503],[70.44150390625006,41.0234375],[70.75097656250003,40.739599609375006],[70.38261718750002,40.453515624999966],[70.95800781250003,40.238867187500034]]]},properties:{name:"Tajikistan",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[66.52226562500007,37.34848632812506],[66.4718750000001,37.3447265625],[66.35029296875004,37.36816406249997],[66.10839843750003,37.414746093749955],[65.7650390625,37.56914062499996],[65.55498046875002,37.25117187500004],[65.30361328125005,37.24677734375001],[65.08964843750007,37.237939453124994],[64.9515625,37.19355468750001],[64.81630859375005,37.13208007812503],[64.7824218750001,37.05927734375001],[64.75312500000004,36.964794921874955],[64.60253906250003,36.554541015625034],[64.51103515625002,36.34067382812498],[64.18437500000002,36.14892578125],[63.8625000000001,36.012353515624994],[63.30166015625005,35.85839843749997],[63.1789062500001,35.85844726562499],[63.12998046875006,35.84619140624997],[63.10859375000004,35.81870117187506],[63.12998046875006,35.76674804687505],[63.15078125000005,35.72827148437503],[63.169726562500074,35.67812500000002],[63.05664062500003,35.44580078125003],[62.98027343750002,35.40917968750003],[62.85800781250006,35.34965820312499],[62.72265625000003,35.271337890625006],[62.688085937500006,35.25532226562504],[62.6105468750001,35.23315429687506],[61.98388671874997,35.443701171875034],[61.54277343750002,35.457861328125006],[61.34472656249997,35.62949218750006],[61.26201171875002,35.61958007812498],[61.11962890625003,36.64257812500003],[60.34130859375003,36.63764648437501],[60.06279296875002,36.962890625],[59.5622070312501,37.178906249999955],[59.240820312500006,37.52075195312497],[58.81542968750003,37.683496093749994],[58.4357421875001,37.63852539062498],[57.42382812500003,37.94770507812501],[57.1935546875001,38.216406250000034],[56.4406250000001,38.249414062499994],[56.22880859375002,38.07338867187502],[55.57841796875002,38.099755859374994],[55.075585937499994,37.90249023437502],[54.745214843750006,37.501904296874955],[53.91416015625006,37.34355468750002],[53.823535156250074,37.92792968749998],[53.86865234375003,38.949267578125045],[53.61757812500005,39.21596679687502],[53.12480468750002,39.43208007812498],[53.472265625000006,39.66879882812498],[53.404199218749994,39.96035156250005],[52.98750000000004,39.98759765625002],[52.73369140625002,40.39873046875002],[53.1452148437501,40.82495117187497],[53.87001953125005,40.64868164062503],[54.710058593750006,40.89111328125006],[54.592187499999994,41.19355468750001],[54.094824218750006,41.51938476562506],[53.846484375000074,42.091162109375006],[52.97001953125002,41.97622070312505],[52.4938476562501,41.780371093750034],[53.25009765625006,42.20585937500002],[54.120996093749994,42.335205078125],[54.90371093750005,41.91909179687505],[55.54521484375002,41.26274414062499],[55.97744140625005,41.32221679687504],[57.017968749999994,41.26347656249996],[56.96406250000004,41.856542968750006],[57.38173828125005,42.15629882812496],[57.814257812500074,42.18984375000005],[58.25966796875005,42.688085937500034],[58.5890625000001,42.778466796874966],[59.451074218749994,42.29951171875001],[59.858300781249994,42.295166015625],[60.10693359374997,41.90742187499998],[60.089648437500074,41.39941406250003],[60.454980468749994,41.221630859374955],[61.32890625000002,41.19511718749999],[61.953515624999994,41.030615234375034],[62.095019531250074,40.68330078124998],[62.65068359375002,39.858496093750006],[64.16279296875004,38.95361328125003],[65.612890625,38.23857421875002],[65.8571289062501,38.26875000000004],[66.629296875,37.932031249999994],[66.52558593750004,37.785742187500034],[66.51132812500006,37.59916992187496],[66.51064453125,37.45869140625004],[66.52226562500007,37.34848632812506]]]},properties:{name:"Turkmenistan",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[125.06816406250002,-9.511914062499997],[124.92226562500005,-8.942480468749977],[125.17802734375002,-8.647851562499994],[125.80429687500006,-8.4921875],[126.61972656250006,-8.459472656249986],[126.91523437500004,-8.715234374999966],[126.38251953125004,-8.957617187499963],[125.40800781250002,-9.275781250000023],[125.06816406250002,-9.511914062499997]]]},properties:{name:"East Timor",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[-61.012109374999966,10.134326171874989],[-61.59667968750003,10.064648437499997],[-61.464746093749966,10.538964843749994],[-61.03374023437502,10.669873046875026],[-61.012109374999966,10.134326171874989]]]},properties:{name:"Trinidad and Tobago",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[10.274609375000011,31.684960937499994],[10.114941406250068,31.46376953125005],[10.216406250000063,30.78320312500003],[10.05976562500004,30.58007812500003],[9.932519531250051,30.42534179687496],[9.895019531250028,30.387304687500034],[9.807421875000045,30.342236328124983],[9.51875000000004,30.229394531249994],[9.4580078125,30.465380859375045],[9.363281250000057,30.832910156250023],[9.224023437500023,31.373681640624994],[9.160253906250006,31.621337890625],[9.044042968750034,32.072363281250034],[8.333398437500051,32.54360351562502],[8.210937500000057,32.92670898437501],[7.877246093750017,33.172119140625],[7.762695312500028,33.23310546874998],[7.627539062500034,33.54863281249996],[7.534375000000068,33.717919921874994],[7.500195312500011,33.83247070312498],[7.495605468750057,33.97651367187501],[7.513867187500068,34.080517578124955],[8.24560546875,34.73408203124998],[8.276855468750057,34.97949218749997],[8.312109375000063,35.084619140624994],[8.394238281250011,35.20385742187503],[8.318066406250011,35.654931640624994],[8.348730468750063,36.367968750000045],[8.207617187500006,36.518945312499994],[8.444238281250051,36.76074218750003],[8.601269531250068,36.83393554687504],[8.576562500000023,36.93720703125001],[9.687988281250057,37.34038085937499],[10.196386718750063,37.205859375000045],[10.571289062500057,36.87944335937496],[11.12666015625004,36.874072265625045],[10.525683593749989,36.323339843750006],[10.590820312500028,35.88725585937499],[11.00429687500008,35.63383789062496],[11.120117187500057,35.24028320312499],[10.534863281250011,34.544726562500045],[10.200390625000068,34.34604492187506],[10.158984375000074,33.85004882812501],[10.722753906250006,33.514404296875],[11.084570312500006,33.56289062500002],[11.202636718749972,33.24921874999998],[11.50458984375004,33.181933593750045],[11.502441406250028,33.15556640624999],[11.467187500000051,32.96572265625005],[11.453906250000017,32.64257812500003],[11.533789062500034,32.52495117187496],[11.535937500000017,32.47333984375001],[11.504980468750034,32.413671875000034],[11.358007812500006,32.34521484375003],[11.168261718750074,32.25673828125002],[11.005175781250074,32.17270507812506],[10.826367187500068,32.080664062500034],[10.771582031250006,32.02119140625001],[10.60888671875,31.929541015624977],[10.47578125000004,31.736035156249983],[10.274609375000011,31.684960937499994]]]},properties:{name:"Tunisia",childNum:1}},{geometry:{type:"MultiPolygon",coordinates:[[[[43.43339843750002,41.155517578125],[43.43945312500003,41.10712890625001],[43.72265624999997,40.71953124999999],[43.56933593750003,40.48237304687498],[43.79169921875004,40.07026367187498],[44.28925781250004,40.040380859375006],[44.76826171875004,39.70351562500005],[44.81718750000002,39.65043945312496],[44.02324218750002,39.37744140625006],[44.43085937500004,38.356787109375034],[44.211328124999994,37.908056640625006],[44.56123046875004,37.74462890625003],[44.76513671875003,37.142431640625006],[44.73095703124997,37.16528320312503],[44.66933593750005,37.17358398437503],[44.60595703124997,37.176025390625],[44.566015625000006,37.15825195312502],[44.401953125000006,37.05849609375002],[44.325585937499994,37.0107421875],[44.28183593750006,36.97802734374997],[44.24570312500006,36.983300781249994],[44.20166015624997,37.05180664062502],[44.208398437499994,37.20263671875],[44.191796874999994,37.249853515625034],[44.15624999999997,37.28295898437503],[44.11445312500004,37.30185546875006],[44.01318359375003,37.313525390625045],[43.51582031250004,37.24453125000002],[42.77460937500004,37.37187500000002],[41.886816406250006,37.156396484374994],[40.70566406250006,37.09770507812502],[40.4503906250001,37.00888671875006],[40.016406250000074,36.82607421875002],[39.68652343749997,36.73862304687506],[39.50146484374997,36.702246093750034],[39.35664062500004,36.68159179687498],[39.10839843749997,36.68056640625005],[38.76660156249997,36.69311523437503],[38.19169921875002,36.90156250000004],[37.90664062500005,36.79462890625001],[37.720312500000006,36.74370117187502],[37.52353515625006,36.678320312500034],[37.436328125000074,36.643310546875],[37.327050781249994,36.64658203125006],[37.18740234375005,36.655908203124994],[37.066210937500074,36.652636718750045],[36.98535156250003,36.70239257812506],[36.941796874999994,36.758398437500006],[36.77656250000004,36.79267578124998],[36.65859375000005,36.80253906250002],[36.62841796875003,36.777685546875034],[36.5968750000001,36.70136718750001],[36.546679687500074,36.50634765625],[36.537499999999994,36.457421874999966],[36.127343749999994,35.831445312499994],[35.81093750000005,36.30986328125002],[36.18847656250003,36.65898437499999],[36.048925781250006,36.91059570312501],[35.537402343750074,36.59702148437498],[34.601367187500074,36.78447265624999],[33.694726562499994,36.18198242187498],[32.794824218749994,36.03588867187497],[32.37773437500002,36.18364257812496],[32.02197265625003,36.53530273437502],[31.35253906249997,36.80107421874999],[30.64404296874997,36.86567382812501],[30.48359375000004,36.310400390625034],[29.689062500000006,36.15668945312498],[29.14326171875001,36.39721679687506],[29.03828125000004,36.693457031250006],[28.48359375000001,36.803808593750006],[28.13369140625005,37.02949218749998],[27.348925781250045,37.01958007812502],[27.077832031250068,37.687695312499955],[27.23242187500003,37.978662109374994],[26.68281250000004,38.198339843750006],[26.763671875,38.709619140624966],[27.013671875000057,38.88686523437502],[26.68183593750004,39.292236328125],[26.113085937500074,39.46738281249998],[26.18134765625004,39.99008789062498],[26.738085937500045,40.40024414062506],[27.4755859375,40.319921875000034],[28.2890625,40.40302734374998],[29.36474609375003,40.80927734374998],[29.32226562499997,41.227734374999955],[31.25488281249997,41.10761718750001],[31.45800781249997,41.32001953125004],[32.306445312500074,41.72958984374998],[33.38134765625003,42.01757812500003],[34.75048828124997,41.95683593749999],[35.297753906249994,41.72851562500003],[36.05175781249997,41.68256835937498],[36.509667968749994,41.262500000000045],[38.38105468750004,40.92451171875001],[39.426367187500006,41.10644531250003],[40.26523437500006,40.96132812500005],[40.95947265624997,41.21162109374998],[41.41435546875002,41.42363281249999],[41.510058593750074,41.51748046875002],[41.70175781250006,41.471582031249994],[41.77939453125006,41.44052734374998],[41.823535156250074,41.432373046875],[41.92578125000003,41.49565429687502],[42.466406250000006,41.43984375000002],[42.787890625000074,41.56372070312503],[43.43339843750002,41.155517578125]]],[[[26.03896484375008,40.726757812499955],[26.62490234375008,41.401757812499994],[26.320898437500034,41.716552734375],[26.549707031250023,41.896728515625],[26.579687500000006,41.947949218749955],[26.615332031250063,41.964892578125045],[26.884863281250006,41.99184570312502],[26.96875000000003,42.02685546875006],[27.01171875,42.05864257812496],[27.193359375000057,42.07709960937498],[27.24433593750004,42.09326171875],[27.294921875000057,42.079541015624955],[27.362890625000034,42.02504882812505],[27.47480468750001,41.946875000000006],[27.53486328125001,41.92080078125002],[27.661132812500057,41.96132812500002],[27.80166015625008,41.95654296875003],[27.831933593750023,41.981298828125006],[27.879199218750074,41.98662109375002],[28.014453125000017,41.96904296874999],[28.197851562500063,41.55449218750002],[29.057226562500006,41.22973632812503],[28.780371093749977,40.97416992187499],[28.172167968750074,41.08071289062502],[27.49941406250005,40.97314453124997],[27.258007812499983,40.687353515625006],[26.10546875000003,40.61132812499997],[26.03896484375008,40.726757812499955]]]]},properties:{name:"Turkey",childNum:2}},{geometry:{type:"Polygon",coordinates:[[[33.90322265625005,-1.002050781250034],[33.979394531249994,-1.002050781250034],[35.83691406249997,-2.036621093749943],[37.643847656250074,-3.0454101562500284],[37.608691406250074,-3.4602539062499886],[37.79726562500005,-3.6744140625000057],[39.221777343750006,-4.692382812500014],[38.81923828125005,-5.877636718749983],[38.87402343750003,-6.331250000000026],[39.47236328125004,-6.878613281249983],[39.51923828125004,-7.1241210937499915],[39.288476562499994,-7.517871093750003],[39.441015625000006,-8.011523437499946],[39.304003906250074,-8.44384765625],[39.783789062500006,-9.914550781249957],[40.46357421875004,-10.464355468749972],[39.988671874999994,-10.820800781250014],[39.56347656249997,-10.978515625],[39.321582031250074,-11.122558593749943],[39.17099609375006,-11.166894531250009],[38.98750000000004,-11.167285156250003],[38.79472656250002,-11.228906250000023],[38.49179687500006,-11.413281250000026],[37.92021484375002,-11.294726562500031],[37.54169921875004,-11.675097656249974],[36.97890625000005,-11.566992187499977],[36.87265625000006,-11.571289062499972],[36.77109375000006,-11.610351562500028],[36.67382812499997,-11.684277343749983],[36.51865234375006,-11.716210937500009],[36.30566406250003,-11.706347656249946],[36.191308593749994,-11.670703124999974],[35.785449218750074,-11.452929687500017],[35.63095703125006,-11.582031250000028],[35.564355468749994,-11.602343749999989],[35.50439453125003,-11.60478515624996],[35.418261718750074,-11.583203124999997],[35.18261718750003,-11.574804687499977],[34.95947265625003,-11.578125000000028],[34.95263671874997,-11.54374999999996],[34.93701171874997,-11.463476562500034],[34.77382812500005,-11.341699218750009],[34.59765625000003,-11.037500000000023],[34.66181640625004,-10.71005859375002],[34.524218750000074,-10.03017578124998],[34.32089843750006,-9.731542968749977],[32.91992187500003,-9.407421875000026],[32.75664062500002,-9.322265625],[31.94257812500004,-9.05400390624996],[31.673632812500017,-8.908789062499963],[31.534863281250097,-8.713281250000009],[31.44921874999997,-8.653906249999991],[31.35058593750003,-8.607031250000034],[31.07636718750004,-8.611914062499963],[30.830664062500063,-8.385546875000031],[30.720898437500097,-8.104394531250037],[30.40673828125003,-7.460644531249983],[30.313183593750097,-7.203710937499949],[30.212695312500017,-7.037890625000017],[30.106250000000017,-6.915039062500028],[29.961816406249994,-6.803124999999966],[29.798144531250017,-6.691894531249957],[29.70966796875004,-6.61689453125004],[29.590625000000017,-6.394433593750023],[29.540820312500017,-6.313867187500037],[29.506249999999994,-6.172070312500011],[29.480078125000006,-6.024999999999977],[29.490820312500063,-5.96542968750002],[29.59638671875004,-5.775976562499963],[29.59414062500005,-5.650781250000037],[29.47646484375005,-5.316601562499997],[29.42011718750004,-5.17617187499998],[29.34277343749997,-4.983105468749997],[29.32568359374997,-4.835644531249969],[29.404199218749994,-4.49667968750002],[29.40322265625005,-4.449316406249963],[29.71777343750003,-4.45585937499996],[29.94726562499997,-4.307324218749983],[30.147167968750097,-4.08535156249998],[30.400000000000006,-3.6539062500000057],[30.811132812500006,-3.1164062500000114],[30.515039062499994,-2.9175781250000057],[30.433496093749994,-2.8745117187500284],[30.424023437500097,-2.82402343749996],[30.42421875000005,-2.641601562500014],[30.441992187500006,-2.6134765624999687],[30.53369140624997,-2.426269531250014],[30.55361328125005,-2.4000976562500114],[30.593359375000063,-2.39677734374996],[30.65664062500005,-2.3738281249999886],[30.71484375000003,-2.3634765625000114],[30.828710937500006,-2.3384765624999773],[30.876562500000006,-2.143359375000017],[30.819140625000017,-1.967480468749983],[30.82753906250005,-1.6936523437499744],[30.812597656250006,-1.56308593750002],[30.76220703124997,-1.458691406249983],[30.710742187500074,-1.3967773437499744],[30.631933593750006,-1.3674804687499602],[30.508105468750074,-1.2082031250000256],[30.47021484374997,-1.1311523437499602],[30.47705078124997,-1.0830078125],[30.509960937500097,-1.0672851562499943],[30.519921874999994,-1.0625],[30.741992187500017,-1.0075195312499972],[30.809179687500063,-.9949218750000028],[30.82363281250005,-.9990234374999432],[30.84472656250003,-1.002050781250034],[31.48310546875004,-1.002050781250034],[32.905175781249994,-1.002050781250034],[33.90322265625005,-1.002050781250034]]]},properties:{name:"United Republic of Tanzania",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[30.50996093750001,-1.0672851562500085],[30.46992187500001,-1.0660156250000057],[30.41230468750001,-1.0630859375000057],[30.360253906250023,-1.0746093750000085],[30.1015625,-1.36865234375],[29.576953125000017,-1.3878906250000114],[29.561914062500023,-.9773437500000028],[29.717675781250023,.09833984374999716],[29.934472656250023,.4990234375],[29.94287109375,.8192382812499943],[30.94257812500001,1.6828124999999972],[31.252734375000017,2.0445800781249943],[31.176367187500006,2.2700683593749886],[30.728613281250006,2.4553710937499886],[30.83857421875001,3.49072265625],[31.15234375,3.785595703124997],[31.47998046875,3.6804687499999886],[31.79804687500001,3.8026367187499943],[32.09941406250002,3.5291992187499943],[32.33574218750002,3.7062011718749943],[32.83808593750001,3.7984863281249943],[33.489355468750006,3.755078124999997],[33.568457031250006,3.811718749999997],[33.74160156250002,3.9852539062499943],[33.97607421875,4.22021484375],[34.13203125000001,3.88916015625],[34.18574218750001,3.8697753906249943],[34.1650390625,3.81298828125],[34.39287109375002,3.6915039062499915],[34.447851562500006,3.1634765624999943],[34.74248046875002,2.818115234375],[34.96406250000001,2.0624023437499943],[34.96523437500002,1.6433593749999886],[34.78759765625,1.230712890625],[34.64912109375001,1.185302734375],[34.535253906250006,1.1015625],[34.48173828125002,1.0421386718749943],[34.41083984375001,.8672851562499915],[34.16093750000002,.6051757812499972],[33.94316406250002,.17377929687499716],[33.90322265625002,-1.0020507812500057],[32.90517578125002,-1.0020507812500057],[31.48310546875001,-1.0020507812500057],[30.8447265625,-1.0020507812500057],[30.823632812500023,-.9990234375],[30.809179687500006,-.9949218750000028],[30.741992187500017,-1.0075195312500114],[30.672753906250023,-1.0513671875000057],[30.598730468750006,-1.0697265625000085],[30.519921875000023,-1.0625],[30.50996093750001,-1.0672851562500085]]]},properties:{name:"Uganda",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[38.21435546875003,47.091455078124966],[37.543359374999994,47.07456054687498],[37.33984375000003,46.91689453125002],[36.2794921875001,46.658593749999966],[35.82714843749997,46.62431640625002],[34.84960937500003,46.189892578124955],[35.02285156250005,45.70097656250002],[35.558007812499994,45.310888671875034],[36.170507812500006,45.453076171874955],[36.39335937500002,45.06538085937501],[35.472558593749994,45.098486328125006],[35.08769531250002,44.802636718749966],[34.716894531250006,44.80712890625],[33.909960937500074,44.387597656249966],[33.45068359374997,44.553662109374955],[33.55517578125003,45.09765625000003],[32.5080078125001,45.40380859375006],[33.664843750000074,45.94707031249996],[33.20224609375006,46.17573242187501],[32.47675781250004,46.08369140625001],[32.035742187500006,46.26098632812497],[31.974316406250097,46.70878906249999],[30.796289062499994,46.55200195312503],[30.219042968750074,45.866748046875045],[29.601660156250063,45.682519531249994],[28.78828125000001,45.240966796875],[28.451269531250006,45.292187499999955],[28.317675781250045,45.347119140624955],[28.212500000000034,45.45043945312506],[28.26484375000004,45.48388671875003],[28.310351562500074,45.49858398437499],[28.47138671875001,45.50717773437506],[28.499023437500057,45.517724609374994],[28.513769531250034,45.57241210937502],[28.49160156250005,45.66577148437503],[28.94775390624997,46.049951171874966],[28.97187500000001,46.12763671874998],[29.00625000000008,46.17646484374998],[28.94375000000005,46.28842773437506],[28.930566406250023,46.36225585937501],[28.92744140625001,46.42412109374999],[29.146289062500017,46.52690429687496],[29.458789062500017,46.453759765624994],[29.83789062499997,46.35053710937501],[29.92431640624997,46.53886718750002],[29.934765625000097,46.62499999999997],[29.942480468750063,46.72377929687502],[29.877832031249994,46.828906250000045],[29.455664062500006,47.292626953124994],[29.159765625000006,47.455664062500006],[29.12294921875005,47.530371093750034],[29.18603515625003,47.65859375000005],[29.210742187500017,47.73154296874998],[29.211132812500097,47.775000000000034],[29.194824218750057,47.88242187499998],[28.77382812500008,48.11958007812498],[28.601660156250006,48.14438476562498],[28.530468750000068,48.15029296875002],[28.34052734375001,48.144433593749994],[27.54921875000008,48.47773437500004],[26.4423828125,48.22998046875],[26.162695312500063,47.992529296875034],[25.90869140625,47.96757812500002],[25.46425781250005,47.910791015624994],[24.89335937499999,47.71777343750003],[24.578906250000074,47.93105468750005],[23.628710937500017,47.995849609375],[22.582421875000023,48.134033203125],[22.253710937500017,48.407373046874994],[22.142871093750017,48.568505859374966],[22.295214843750045,48.68583984374999],[22.432031250000023,48.93354492187498],[22.57998046875005,49.077197265625045],[22.705664062500006,49.17119140624999],[22.6494140625,49.53901367187498],[23.711718750000045,50.377343749999966],[24.105761718750045,50.84497070312503],[23.664453125000023,51.31005859375],[23.61376953125,51.525390625],[24.361914062500006,51.86752929687498],[25.785742187500006,51.923828125],[27.14199218750008,51.75205078124998],[27.689746093750017,51.572412109374994],[28.59902343750008,51.54262695312505],[28.647753906250074,51.45654296875],[28.690234375000017,51.43886718750005],[28.731250000000017,51.43339843749999],[28.793261718750045,51.510351562500034],[28.97773437500004,51.57177734375003],[29.01308593750005,51.59892578124996],[29.06074218750001,51.625439453124955],[29.102050781250057,51.627539062500034],[29.13564453125008,51.61728515624998],[29.174218750000023,51.58061523437496],[29.23046875000003,51.49702148437498],[29.29882812500003,51.41303710937501],[29.346484375000017,51.38256835937503],[30.160742187500006,51.477880859375006],[30.449511718750017,51.274316406249994],[30.533007812500017,51.596337890624966],[30.980664062500097,52.04619140624996],[31.217968750000097,52.05024414062498],[31.345996093750074,52.10537109375002],[31.57373046875003,52.108105468749955],[31.763378906250097,52.10107421875003],[32.507910156250006,52.30854492187504],[33.735253906249994,52.344775390625045],[34.397851562499994,51.780419921874994],[34.280664062499994,51.311669921874966],[35.31191406250005,51.043896484374955],[35.41162109375003,50.539697265624994],[36.619433593750074,50.209228515625],[37.42285156249997,50.411474609375006],[38.04687500000003,49.92001953125006],[38.258593750000074,50.052343750000006],[39.17480468750003,49.85595703124997],[39.780566406250074,49.57202148437503],[40.07001953125004,49.20029296874998],[39.68652343749997,49.007910156250034],[39.96103515625006,48.23793945312502],[39.735937500000006,47.84482421875006],[38.90029296875005,47.85512695312502],[38.287402343750074,47.559179687500034],[38.21435546875003,47.091455078124966]]]
},properties:{name:"Ukraine",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[-57.81059570312499,-30.85859375000001],[-57.872509765625,-30.59101562500001],[-57.55229492187499,-30.26123046875],[-57.21445312499999,-30.28339843750001],[-56.83271484375,-30.107226562500003],[-56.4072265625,-30.44746093750001],[-55.998974609375,-30.837207031250003],[-56.018457031249994,-30.99189453125001],[-56.015527343749994,-31.059667968750006],[-56.00468749999999,-31.079199218750006],[-55.95200195312499,-31.080859375000003],[-55.873681640624994,-31.069628906250003],[-55.807763671874994,-31.036718750000006],[-55.75634765625,-30.987109375000003],[-55.705957031249994,-30.946582031250003],[-55.665234375,-30.924902343750006],[-55.55732421875,-30.8759765625],[-55.44956054687499,-30.964453125000006],[-55.36606445312499,-31.046191406250003],[-55.254638671875,-31.2255859375],[-55.17353515625,-31.279589843750003],[-55.09116210937499,-31.31396484375],[-54.89599609375,-31.391210937500006],[-54.587646484375,-31.485156250000003],[-54.22055664062499,-31.85517578125001],[-53.92060546875,-31.95234375000001],[-53.76171875,-32.05683593750001],[-53.601708984374994,-32.40302734375001],[-53.12558593749999,-32.73671875000001],[-53.2140625,-32.82109375],[-53.39521484375,-33.010351562500006],[-53.53134765624999,-33.1708984375],[-53.53037109374999,-33.50029296875],[-53.53764648437499,-33.6228515625],[-53.53134765624999,-33.65546875000001],[-53.51884765624999,-33.67724609375],[-53.37060546875,-33.7421875],[-53.419580078124994,-33.77919921875001],[-53.47246093749999,-33.84931640625001],[-53.53452148437499,-34.01748046875001],[-53.785302734374994,-34.38037109375],[-54.16855468749999,-34.670703125],[-54.902294921875,-34.93281250000001],[-55.67314453124999,-34.77568359375],[-56.117919921875,-34.90791015625001],[-56.85517578125,-34.67666015625001],[-57.17070312499999,-34.45234375000001],[-57.8291015625,-34.47734375],[-58.40019531249999,-33.91240234375],[-58.35336914062499,-33.26005859375],[-58.08232421874999,-32.893652343750006],[-58.12958984375,-32.75722656250001],[-58.16220703124999,-32.566503906250006],[-58.201171875,-32.4716796875],[-58.18901367187499,-31.92421875000001],[-57.81059570312499,-30.85859375000001]]]},properties:{name:"Uruguay",childNum:1}},{geometry:{type:"MultiPolygon",coordinates:[[[[-155.58134765624996,19.012011718750017],[-155.88129882812495,19.07050781250001],[-156.04868164062498,19.749951171874983],[-155.83164062499998,20.27583007812501],[-155.198779296875,19.99438476562503],[-154.80419921875,19.524462890625045],[-155.58134765624996,19.012011718750017]]],[[[-72.50976562500003,40.98603515625001],[-73.19428710937495,40.654199218749994],[-73.573828125,40.91962890624998],[-72.50976562500003,40.98603515625001]]],[[[-94.80346679687497,49.0029296875],[-94.71279296874997,48.863427734374994],[-93.85161132812496,48.607275390625034],[-93.37788085937498,48.61655273437498],[-93.25795898437497,48.62885742187501],[-92.83671874999996,48.567773437499994],[-92.50058593749995,48.43535156250002],[-92.41459960937493,48.276611328125],[-92.34843749999996,48.276611328125],[-92.00517578125002,48.301855468750006],[-91.38720703124997,48.05854492187498],[-90.79731445312495,48.13105468750001],[-89.4556640625,47.996240234374994],[-88.37817382812497,48.30307617187498],[-87.74389648437497,48.06054687500003],[-87.20800781249997,47.848486328125006],[-86.67216796874996,47.636425781249955],[-85.65224609375,47.21997070312503],[-85.07006835937497,46.97993164062498],[-84.87597656249994,46.89990234375003],[-84.66577148437503,46.54326171875002],[-84.44047851562496,46.49814453125006],[-84.12319335937497,46.50292968749997],[-83.97778320312503,46.08491210937498],[-83.61596679687503,46.116845703124994],[-83.59267578125,45.81713867187506],[-82.91933593749994,45.51796875000002],[-82.48505859374993,45.08374023437503],[-82.137841796875,43.570898437500034],[-82.19038085937495,43.47407226562501],[-82.54531249999997,42.62470703124998],[-83.10952148437497,42.25068359375001],[-83.141943359375,41.97587890624996],[-82.69003906249995,41.675195312499994],[-81.97416992187496,41.88872070312499],[-81.50732421874997,42.10346679687504],[-81.02822265624997,42.247167968750006],[-80.24755859375,42.36601562499996],[-79.17373046875,42.74853515625],[-78.91508789062496,42.90913085937504],[-78.98076171874993,42.98061523437502],[-79.02617187499996,43.01733398437506],[-79.066064453125,43.10610351562502],[-79.17187499999997,43.466552734375],[-79.00249023437502,43.52714843749999],[-78.845556640625,43.58334960937498],[-78.72041015625001,43.62495117187501],[-78.45825195312497,43.63149414062502],[-77.87924804687498,43.629541015624994],[-76.819970703125,43.62880859375002],[-76.18579101562503,44.24223632812502],[-75.81933593749997,44.468017578125],[-75.40126953124997,44.77226562499999],[-74.99614257812496,44.970117187499966],[-74.76245117187494,44.99907226562502],[-74.663232421875,45.00390625000003],[-71.51752929687495,45.00756835937497],[-71.327294921875,45.29008789062496],[-70.89799804687493,45.26245117187503],[-70.296240234375,45.90610351562506],[-70.00771484375002,46.70893554687501],[-69.24287109374998,47.46298828124998],[-68.82871093749998,47.20332031250001],[-68.310888671875,47.3544921875],[-67.806787109375,47.08281249999999],[-67.78466796875,45.70170898437499],[-67.43266601562496,45.60312499999998],[-67.47255859375002,45.27587890625],[-67.12485351562498,45.16943359375],[-67.10673828125002,44.88505859374996],[-67.90703124999999,44.45361328125],[-68.27744140625003,44.50737304687502],[-69.79160156249995,43.80522460937499],[-70.17880859374998,43.76635742187506],[-70.82905273437493,42.82534179687502],[-71.04619140624993,42.331103515625045],[-70.73828125,42.228857421875006],[-70.4046875,41.62690429687501],[-70.65712890625,41.53422851562496],[-71.42656249999999,41.63330078125],[-71.52285156249997,41.378955078125045],[-72.84716796875003,41.265869140625],[-73.5830078125,41.02187500000005],[-74.22670898437497,40.608007812500006],[-73.95761718750003,40.32836914062497],[-74.17612304687495,39.726611328125045],[-74.42880859375,39.38720703125],[-74.89702148437502,39.14545898437504],[-75.3921875,39.09277343750006],[-75.03588867187497,38.50332031250005],[-75.65927734374995,37.953955078125034],[-76.501318359375,38.53217773437498],[-76.26425781250003,37.89355468749997],[-76.26347656249996,37.357031250000006],[-75.89042968749999,36.65703124999996],[-76.47880859374993,36.028173828125006],[-75.77221679687497,35.89990234375],[-75.77392578124997,35.64697265624997],[-76.51293945312497,35.270410156249994],[-76.74497070312498,34.94096679687502],[-77.750732421875,34.28496093749996],[-78.01333007812502,33.91181640624998],[-78.57768554687496,33.87324218750001],[-78.92031249999997,33.65869140625],[-79.27602539062497,33.135400390624966],[-80.84921875,32.113916015624966],[-81.52041015624997,30.874658203125023],[-81.24951171875003,29.793798828125006],[-80.89999999999995,29.049853515625045],[-80.52412109374995,28.48608398437503],[-80.65009765624993,28.18090820312503],[-80.22612304687499,27.207031250000057],[-80.04130859374999,26.568603515625],[-80.1263671875,25.83349609375],[-80.36694335937497,25.331249999999983],[-80.73652343749995,25.156347656249977],[-81.09765625,25.319140625000017],[-81.36494140625001,25.83105468750003],[-81.715478515625,25.98315429687503],[-81.86655273437495,26.435009765624983],[-82.44135742187501,27.059667968750034],[-82.66088867187497,27.71840820312505],[-82.84350585937494,27.845996093750017],[-82.66064453125,28.48583984374997],[-82.65146484375,28.887500000000017],[-83.29047851562498,29.45190429687497],[-83.69438476562502,29.92597656250001],[-84.04423828124996,30.10380859374999],[-84.38281250000003,29.90737304687505],[-85.31894531249995,29.680224609375045],[-85.35361328125,29.875732421875],[-86.25737304687502,30.493017578124977],[-87.79028320312503,30.291796875000017],[-88.90522460937495,30.415136718750006],[-89.58847656249998,30.165966796874955],[-90.22529296874995,30.379296874999994],[-90.41303710937501,30.140332031249983],[-89.58950195312502,29.9150390625],[-90.10136718749993,29.181787109375023],[-90.37919921874996,29.29511718750001],[-90.75102539062496,29.13085937500003],[-91.29013671875,29.288964843749994],[-91.33095703124997,29.513574218750023],[-91.8931640625,29.836035156249977],[-92.26083984374995,29.55683593750004],[-93.17568359375,29.778955078124994],[-93.69482421874997,29.769921875000023],[-94.88828125000003,29.37055664062501],[-95.27348632812499,28.96386718750003],[-95.85341796875,28.64033203125001],[-96.44873046874997,28.594482421875],[-96.56171874999998,28.367138671874955],[-97.156494140625,28.144335937500045],[-97.17143554687493,27.87958984375001],[-97.55468749999994,26.96733398437496],[-97.40234375,26.396533203125045],[-97.14624023437494,25.961474609375045],[-97.35815429687497,25.870507812499994],[-98.08281249999999,26.06445312499997],[-99.10776367187498,26.446923828124994],[-99.4435546875,27.03666992187499],[-99.50532226562497,27.54833984375003],[-100.29604492187495,28.32768554687499],[-100.65864257812501,29.06855468750004],[-101.44038085937503,29.77685546875],[-102.26894531249998,29.871191406250034],[-102.73417968749999,29.643945312500023],[-102.8919921875,29.216406250000034],[-103.25771484374998,29.001123046874966],[-104.40063476562503,29.57373046875],[-104.97880859374996,30.645947265624955],[-106.25571289062495,31.544677734375],[-106.45322265624995,31.770166015625023],[-108.21181640625002,31.779345703125017],[-108.21445312499993,31.329443359375034],[-111.0419921875,31.32421875000003],[-112.93896484375001,31.91625976562503],[-114.83593749999994,32.50830078125003],[-114.72475585937495,32.71533203125003],[-117.12827148437495,32.533349609374994],[-117.46743164062495,33.295507812500006],[-118.506201171875,34.01738281249999],[-119.14374999999995,34.11201171874998],[-119.60605468749999,34.41801757812499],[-120.48120117187503,34.47163085937498],[-120.64467773437502,34.57998046875002],[-120.63359374999999,35.07646484375002],[-120.86030273437498,35.36542968749998],[-121.87739257812498,36.33105468749997],[-121.78999023437494,36.732275390625006],[-122.394921875,37.20751953125003],[-122.46689453125,37.83818359374999],[-122.96816406249998,38.097021484375034],[-122.9865234375,38.27709960937506],[-123.701123046875,38.90727539062502],[-123.88447265624997,39.86079101562501],[-124.32402343749999,40.25195312500003],[-124.3716796875,40.49121093750003],[-124.06850585937498,41.38417968750005],[-124.53964843750003,42.812890624999966],[-124.14873046874997,43.691748046875034],[-123.92934570312495,45.57695312499996],[-124.0716796875,46.74477539062502],[-124.376025390625,47.658642578124955],[-124.62109375000001,47.90415039062498],[-124.63261718749997,48.37504882812499],[-123.97578125,48.16845703125],[-122.24199218750002,48.01074218750003],[-122.52031249999996,48.229101562500006],[-122.40854492187502,48.29389648437498],[-122.49677734374995,48.50556640625001],[-122.56201171875001,48.777978515624994],[-122.65302734375,48.76386718749998],[-122.72246093750002,48.85302734375003],[-122.78876953125003,48.993017578125034],[-119.70170898437495,48.993017578125034],[-119.27534179687494,48.99306640625005],[-118.84892578124993,48.99306640625005],[-117.99619140625002,48.99306640625005],[-116.71704101562501,48.99306640625005],[-114.58510742187501,48.99306640625005],[-112.45322265625,48.99306640625005],[-109.46855468749999,48.99306640625005],[-107.76298828124997,48.993115234374955],[-104.35195312499997,48.993115234374955],[-102.22001953124996,48.993115234374955],[-98.80898437499995,48.99316406249997],[-97.52983398437493,48.99316406249997],[-96.67705078124993,48.99316406249997],[-96.25068359374993,48.99316406249997],[-95.39790039062493,48.99316406249997],[-95.16206054687493,48.991748046875045],[-94.85434570312495,49.304589843749994],[-94.86040039062493,49.258593750000045],[-94.80346679687497,49.0029296875]]],[[[-163.476025390625,54.98071289062497],[-163.35810546874995,54.73569335937506],[-164.4634765625,54.427343750000034],[-164.887646484375,54.60781250000002],[-164.52978515625,54.88085937500006],[-163.476025390625,54.98071289062497]]],[[[-130.97915039062502,55.489160156249994],[-131.08276367187497,55.26679687499998],[-131.810986328125,55.223095703124955],[-131.62495117187504,55.831689453124966],[-131.26923828125004,55.95537109375002],[-130.97915039062502,55.489160156249994]]],[[[-133.56611328125,56.33920898437498],[-133.202978515625,56.31982421875003],[-131.97641601562498,55.208593750000034],[-131.98085937499997,54.80483398437502],[-132.78232421875,55.04848632812502],[-133.44697265624995,55.797021484374994],[-133.56611328125,56.33920898437498]]],[[[-133.36621093750006,57.003515625000034],[-132.95415039062502,56.880273437499994],[-133.212646484375,56.46459960937503],[-133.602783203125,56.46411132812503],[-133.86596679687497,57.068701171875006],[-133.36621093750006,57.003515625000034]]],[[[-134.96977539062496,57.351416015625034],[-134.62070312499998,56.71831054687502],[-135.78710937500003,57.31728515625002],[-134.96977539062496,57.351416015625034]]],[[[-152.89804687499998,57.82392578125004],[-152.21621093749997,57.577001953125006],[-153.793212890625,56.98950195312503],[-154.33896484374998,56.9208984375],[-154.70595703124997,57.335351562499966],[-154.2814453125,57.638085937499994],[-153.81835937499997,57.595605468749966],[-152.89804687499998,57.82392578125004]]],[[[-135.73037109375002,58.244238281250034],[-135.00209960937497,58.05107421875002],[-135.08486328124997,57.51103515624996],[-136.07661132812504,57.67456054687497],[-136.51230468749998,58.095996093750045],[-135.73037109375002,58.244238281250034]]],[[[-134.68027343749998,58.16166992187499],[-133.93701171874997,57.581591796875045],[-133.92529296875,57.33676757812498],[-134.43530273437497,57.056982421875006],[-134.65986328124998,57.638085937499994],[-134.68027343749998,58.16166992187499]]],[[[-166.13544921875,60.38354492187503],[-165.72968750000004,60.31420898437503],[-165.591796875,59.913134765625045],[-166.187548828125,59.773828124999994],[-167.13886718749998,60.00854492187503],[-166.13544921875,60.38354492187503]]],[[[-171.46303710937494,63.640039062499994],[-170.430419921875,63.69882812499998],[-169.77778320312498,63.09375],[-171.46303710937494,63.640039062499994]]],[[[-141.00214843750004,68.77416992187506],[-141.00214843750004,67.89755859374998],[-141.00214843750004,66.43652343750006],[-141.00214843750004,65.55991210937498],[-141.00214843750004,64.09887695312506],[-141.00214843750004,63.22226562499998],[-141.00214843750004,61.761279296875045],[-141.00214843750004,60.884667968749994],[-141.00214843750004,60.30024414062504],[-140.45283203125004,60.29970703125002],[-139.97329101562497,60.183154296875074],[-139.67631835937505,60.32832031249998],[-139.23476562499997,60.339746093749994],[-138.70546874999997,59.90131835937504],[-138.317626953125,59.611132812500074],[-137.59331054687493,59.22626953124998],[-136.81328125000002,59.150048828124994],[-136.46635742187493,59.459082031250006],[-135.70258789062504,59.72875976562506],[-135.36787109374998,59.743310546874994],[-134.94375,59.28828125000001],[-134.67724609374997,59.19926757812499],[-134.39306640625,59.009179687499994],[-134.32963867187505,58.93969726562506],[-134.21850585937503,58.849902343750045],[-133.54638671874997,58.50346679687499],[-133.27529296875,58.22285156250004],[-133.00141601562495,57.948974609375],[-132.062890625,56.95336914062503],[-131.86616210937495,56.792822265625006],[-130.649072265625,56.26367187500003],[-130.47709960937496,56.230566406250034],[-130.09785156249995,56.10927734375002],[-130.01406249999997,55.950537109375006],[-130.036572265625,55.29790039062502],[-130.2140625,55.02587890625003],[-130.57534179687497,54.769677734374966],[-131.04785156249997,55.157666015624955],[-130.9185546875,55.735986328124994],[-131.28759765624994,56.01210937500005],[-131.84384765625003,56.16010742187498],[-132.81425781249993,57.04072265624998],[-133.465869140625,57.17216796875002],[-133.55419921874997,57.69506835937497],[-134.06333007812503,58.21108398437502],[-134.77612304687506,58.45385742187503],[-135.3025390625,58.25590820312502],[-135.86171874999997,58.577050781249966],[-136.5826171875,58.24521484375006],[-137.54399414062502,58.58120117187502],[-138.35249023437498,59.08730468750002],[-140.216748046875,59.72666015624998],[-140.84316406249997,59.74887695312506],[-141.67016601562497,59.969873046874966],[-142.94565429687503,60.09697265625002],[-143.80507812499997,60.01289062500001],[-144.901318359375,60.335156249999955],[-145.898876953125,60.47817382812505],[-146.8740234375,61.00488281249997],[-148.34443359374998,60.853564453125045],[-148.197607421875,60.167773437500045],[-148.430712890625,59.98911132812498],[-149.4322265625,60.00102539062499],[-150.9607421875,59.24399414062506],[-151.73818359375002,59.18852539062502],[-151.734521484375,59.98833007812499],[-151.45146484375,60.20263671875003],[-151.32177734375,60.74291992187497],[-150.44125976562503,61.02358398437505],[-150.61225585937495,61.301123046875006],[-151.73398437499998,60.91074218749998],[-151.75048828124994,60.75488281250003],[-153.10605468749998,59.87504882812502],[-154.088330078125,59.36328125000003],[-154.129833984375,59.119873046875],[-153.33442382812495,58.85786132812498],[-154.01987304687498,58.49296874999999],[-154.247021484375,58.15942382812497],[-155.006884765625,58.01606445312501],[-156.47841796875002,57.32788085937506],[-156.475146484375,57.10517578124998],[-157.57836914062503,56.63447265625001],[-158.41440429687498,56.435839843750045],[-158.27563476562497,56.19624023437498],[-159.52324218749993,55.81000976562498],[-159.96230468749997,55.79487304687501],[-161.09951171875,55.405712890624955],[-161.74155273437498,55.39116210937502],[-162.073974609375,55.13930664062505],[-162.86503906249996,54.954541015624955],[-162.961962890625,55.18383789062506],[-162.15712890625,55.71943359375001],[-161.21562500000005,56.02143554687498],[-160.85131835937497,55.77187500000002],[-160.30205078125,56.31411132812502],[-159.28310546874997,56.688574218750006],[-158.32094726562497,57.29790039062499],[-157.60756835937502,57.601464843749994],[-157.52363281249998,58.421337890624955],[-158.50317382812494,58.85034179687497],[-159.08266601562497,58.469775390625074],[-159.67026367187498,58.9111328125],[-160.36313476562498,59.05117187500002],[-161.75546874999998,58.61201171874998],[-161.82871093749998,59.588623046875],[-162.24248046875,60.17832031249998],[-163.21938476562497,59.84560546875005],[-163.90688476562494,59.80678710937505],[-164.662255859375,60.303808593750034],[-165.35380859375002,60.54121093750001],[-164.80517578125,60.89204101562498],[-165.56586914062498,61.10234375000002],[-166.07880859375,61.803124999999966],[-165.19453125,62.47353515625002],[-164.40903320312503,63.21503906250001],[-163.358837890625,63.04575195312498],[-161.97397460937498,63.45292968749999],[-161.09970703125003,63.557910156250045],[-160.778564453125,63.818945312500034],[-160.93193359374996,64.5791015625],[-161.75937499999998,64.816259765625],[-162.80703124999997,64.37421875000001],[-163.71308593749998,64.588232421875],[-164.89951171875003,64.46064453125004],[-166.1427734375,64.58276367187503],[-167.40400390625,65.42211914062497],[-168.08837890624997,65.65776367187502],[-164.67412109375002,66.55502929687503],[-163.77548828125,66.53110351562503],[-163.69536132812502,66.08383789062503],[-161.81630859375002,66.05366210937504],[-161.5568359375,66.25053710937499],[-160.23168945312503,66.420263671875],[-160.864013671875,66.67084960937501],[-161.85668945312497,66.70034179687497],[-161.96542968750003,67.04956054687497],[-163.001708984375,67.02729492187495],[-163.720556640625,67.19555664062506],[-164.1251953125,67.60673828125007],[-166.38051757812502,68.425146484375],[-166.20908203125,68.88535156250003],[-164.30234375000003,68.93647460937498],[-163.16147460937498,69.38793945312503],[-162.95209960937504,69.75810546875005],[-161.88095703125003,70.33173828125001],[-160.9962890625,70.30458984375],[-159.31450195312496,70.87851562500003],[-157.998486328125,70.8453125],[-156.78330078124998,71.31894531250006],[-155.16684570312498,71.09921875000006],[-154.19521484375002,70.80112304687498],[-153.23291015625,70.93256835937504],[-152.23291015625,70.81035156249999],[-151.94467773437498,70.45209960937501],[-149.26943359374997,70.50078124999999],[-147.70537109375,70.21723632812495],[-145.82314453124997,70.16005859375002],[-145.19736328125003,70.00869140625002],[-143.218310546875,70.11625976562499],[-141.40791015625,69.65336914062502],[-141.00214843750004,69.65078125000002],[-141.00214843750004,68.77416992187506]]]]},properties:{name:"United States of America",childNum:14}},{geometry:{type:"Polygon",coordinates:[[[70.94677734374997,42.24868164062505],[70.97900390625003,42.26655273437504],[71.03603515625,42.28466796875],[71.12998046875006,42.25000000000003],[71.21269531250002,42.20644531250005],[71.23232421875005,42.18627929687503],[71.22851562499997,42.16289062499996],[71.03222656249997,42.07778320312505],[70.84189453125,42.019628906250006],[70.45498046875005,41.72504882812504],[70.18095703125007,41.571435546874994],[70.78242187500004,41.262500000000045],[71.11074218750005,41.152636718750045],[71.29882812500003,41.152490234374994],[71.39306640625003,41.123388671875034],[71.40839843750004,41.13603515625002],[71.60625000000002,41.367431640625],[72.36406250000002,41.04345703125],[73.13212890625002,40.828515624999994],[72.3892578125,40.427392578124994],[71.69248046875,40.15234375],[70.95800781250003,40.238867187500034],[70.38261718750002,40.453515624999966],[70.75097656250003,40.739599609375006],[70.44150390625006,41.0234375],[69.71289062500003,40.65698242187503],[69.2062500000001,40.566552734374994],[69.22832031250007,40.18759765624998],[68.6525390625001,40.182666015625045],[68.46328125,39.53671874999998],[67.71904296875007,39.62138671875002],[67.34960937499997,39.242089843749994],[67.67656250000002,39.00849609375001],[68.10351562499997,38.96201171875006],[68.04785156250003,38.669287109375006],[68.29404296875006,38.032910156249955],[67.81435546875005,37.48701171875004],[67.7980468750001,37.244970703125006],[67.75898437500004,37.172216796875034],[67.75292968749997,37.199804687500034],[67.70000000000002,37.227246093749955],[67.60742187499997,37.22250976562506],[67.5172851562501,37.26665039062499],[67.44169921875007,37.25800781250001],[67.3197265625,37.209570312500006],[67.1955078125001,37.23520507812498],[67.06884765624997,37.334814453125006],[66.82773437500006,37.37128906249998],[66.52226562500007,37.34848632812506],[66.51064453125,37.45869140625004],[66.51132812500006,37.59916992187496],[66.52558593750004,37.785742187500034],[66.629296875,37.932031249999994],[65.8571289062501,38.26875000000004],[65.612890625,38.23857421875002],[64.16279296875004,38.95361328125003],[62.65068359375002,39.858496093750006],[62.095019531250074,40.68330078124998],[61.953515624999994,41.030615234375034],[61.32890625000002,41.19511718749999],[60.454980468749994,41.221630859374955],[60.089648437500074,41.39941406250003],[60.10693359374997,41.90742187499998],[59.858300781249994,42.295166015625],[59.451074218749994,42.29951171875001],[58.5890625000001,42.778466796874966],[58.25966796875005,42.688085937500034],[57.814257812500074,42.18984375000005],[57.38173828125005,42.15629882812496],[56.96406250000004,41.856542968750006],[57.017968749999994,41.26347656249996],[55.97744140625005,41.32221679687504],[55.9767578125001,42.69951171874996],[55.97568359375006,44.99492187499996],[58.555273437500006,45.55537109375001],[61.007910156250006,44.39379882812497],[61.16074218750006,44.16860351562502],[61.99023437500003,43.492138671874955],[63.20703125000003,43.62797851562502],[64.44316406250007,43.551171874999994],[64.9054687500001,43.714697265625006],[65.49619140625,43.310546875],[65.80302734375002,42.87695312500006],[66.1002929687501,42.99082031249998],[66.00957031250007,42.00488281250003],[66.49863281250006,41.99487304687503],[66.66865234375004,41.27075195312503],[66.81425781250002,41.14238281249999],[67.9357421875001,41.19658203125002],[68.29189453125,40.656103515625034],[69.06494140625003,41.366943359375],[70.09560546875,41.82050781250004],[70.41601562500003,42.07856445312501],[70.94677734374997,42.24868164062505]]]},properties:{name:"Uzbekistan",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[-60.742138671874926,5.202050781250037],[-60.71196289062499,5.191552734375023],[-60.671972656250034,5.164355468749989],[-60.60449218749994,4.99458007812504],[-61.00283203125002,4.5352539062499915],[-62.15312499999996,4.098388671874986],[-62.71210937499998,4.01791992187502],[-62.96865234374994,3.593945312499983],[-63.29472656249993,3.92226562499998],[-64.02148437500003,3.929101562500051],[-64.25566406249996,4.140332031249997],[-64.56791992187496,3.8998046875000227],[-64.22109375000002,3.5874023437499716],[-64.21884765625,3.2046874999999915],[-63.924169921875006,2.4524414062500313],[-63.389257812500006,2.4119140625000455],[-63.393945312499994,2.2225097656250057],[-64.03544921874993,1.904443359375037],[-64.11484375000003,1.619287109375037],[-65.10375976562497,1.108105468749983],[-65.36083984374994,.8686523437500568],[-65.68144531249999,.9834472656249886],[-66.06005859375003,.7853515625000398],[-66.42924804687502,.8216796874999801],[-66.87602539062499,1.223046875000037],[-67.21083984375,2.3901367187500426],[-67.83476562499999,2.8928222656250426],[-67.3111328125,3.41586914062502],[-67.66162109375,3.864257812499986],[-67.85527343750002,4.506884765624989],[-67.82490234374995,5.270458984375026],[-67.43935546875,6.025537109375023],[-67.85917968749999,6.289892578124963],[-68.47177734375,6.156542968749974],[-69.43925781249993,6.1349121093750085],[-70.09501953124996,6.937939453125011],[-70.65507812500002,7.082763671875028],[-71.01328124999998,6.994433593749974],[-72.08427734374993,7.096874999999969],[-72.44296875,7.454882812499989],[-72.41655273437496,8.381982421875037],[-72.66542968749994,8.62758789062498],[-72.79638671874997,9.108984374999991],[-73.35634765625002,9.226855468750031],[-73.00654296874998,9.789160156250006],[-72.86933593750001,10.49125976562496],[-72.690087890625,10.835839843749994],[-72.24848632812501,11.196435546875009],[-71.95810546875,11.666406250000009],[-71.31972656249997,11.861914062500048],[-71.86865234374997,11.627343750000037],[-71.94697265624995,11.414453125000009],[-71.59433593749995,10.657373046875051],[-72.11284179687499,9.815576171874966],[-71.68671874999995,9.072509765625028],[-71.29794921874998,9.125634765625009],[-71.08583984375002,9.348242187499977],[-71.05268554687501,9.705810546874986],[-71.38662109375002,10.263769531249977],[-71.54462890624995,10.778710937499994],[-71.46953124999993,10.964160156250017],[-70.23251953124998,11.372998046874997],[-70.28652343749997,11.886035156249989],[-70.00395507812496,12.177880859375023],[-69.63159179687494,11.479931640625026],[-68.827978515625,11.431738281249977],[-68.39863281249995,11.160986328124977],[-68.23408203124998,10.569140625000017],[-67.87163085937496,10.472070312500051],[-66.98906250000002,10.610644531250031],[-66.24721679687497,10.632226562499994],[-65.85175781249995,10.257763671874997],[-65.12910156249998,10.070068359375043],[-64.85048828125,10.098095703124969],[-63.873437499999966,10.663769531250026],[-62.702343749999955,10.74980468749996],[-62.843017578125,10.417919921875026],[-62.51513671875,10.176123046874977],[-60.79248046874997,9.360742187500037],[-61.05307617187495,9.095117187500009],[-61.30400390624999,8.410400390625043],[-60.800976562499926,8.592138671875034],[-60.01752929687501,8.549316406250014],[-59.83164062499998,8.305957031250003],[-59.84907226562498,8.248681640624966],[-59.96484375000003,8.191601562499969],[-59.99072265624997,8.16201171874998],[-60.032421874999926,8.053564453125006],[-60.51362304687501,7.813183593749969],[-60.71923828124997,7.498681640625023],[-60.523193359375,7.1437011718750085],[-60.464941406250034,7.1665527343750455],[-60.39238281249999,7.164550781249986],[-60.34506835937495,7.150000000000048],[-60.32548828124996,7.133984374999983],[-60.32207031249996,7.092041015625043],[-60.35209960937496,7.002880859374997],[-60.39501953125,6.945361328125003],[-60.58608398437502,6.857080078124966],[-60.717919921874966,6.768310546875],[-61.14560546874998,6.694531249999983],[-61.12871093749999,6.214306640625026],[-61.15947265624996,6.174414062499977],[-61.22495117187498,6.129199218750003],[-61.303124999999994,6.049511718750026],[-61.39082031250001,5.938769531250017],[-61.376806640625006,5.906982421875028],[-61.167187499999926,5.674218750000037],[-60.95400390625002,5.437402343750023],[-60.742138671874926,5.202050781250037]]]},properties:{name:"Venezuela",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[107.97265624999997,21.507958984375023],[107.40996093750002,21.284814453125023],[107.35429687500007,21.055175781250057],[106.67548828125004,20.960498046875045],[106.75341796875003,20.73505859375004],[106.51796875000005,20.28886718749999],[105.98408203125004,19.939062500000034],[105.62177734375004,18.96630859375003],[105.88828125000006,18.502490234375045],[106.49902343749997,17.946435546874994],[106.47890625000005,17.719580078125063],[107.18037109375004,16.89794921875],[108.02939453125012,16.331103515625074],[108.82128906249997,15.377929687500028],[109.08486328125,14.716162109375034],[109.30332031250012,13.856445312500043],[109.271875,13.279345703124974],[109.42392578125006,12.955957031249994],[109.21894531250004,12.64580078124996],[109.1986328125,11.724853515625014],[108.82080078125003,11.3154296875],[108.2716796875001,10.934277343749969],[107.26152343750007,10.39838867187504],[106.81269531250004,10.433300781250054],[106.57246093750004,9.641113281250043],[105.50097656249997,9.093212890624983],[105.32226562499997,8.801123046874977],[104.89189453125002,8.583251953125],[104.81855468750004,8.801855468750034],[104.84521484375003,9.606152343750026],[105.02783203125003,10.067431640625031],[104.66347656250005,10.169921875000043],[104.42636718750006,10.411230468749991],[104.85058593749997,10.534472656249974],[105.38652343750002,10.940087890625009],[106.16796874999997,11.012304687499977],[105.85605468750006,11.294287109375048],[105.85146484375005,11.635009765625],[106.33984374999997,11.68183593750004],[106.41386718750002,11.948437499999997],[106.93066406249997,12.077490234374991],[107.50644531250006,12.364550781250031],[107.47539062500002,13.030371093749963],[107.60546874999997,13.437792968750017],[107.3314453125,14.126611328125009],[107.51943359375005,14.705078125],[107.51376953125012,14.817382812500057],[107.52451171875012,14.871826171875043],[107.50468750000007,14.915917968749966],[107.48037109375,14.979882812500037],[107.55527343750006,15.057031250000023],[107.58964843750002,15.118457031250017],[107.63369140625005,15.189843749999994],[107.65312500000002,15.255224609374991],[107.62167968750006,15.309863281250017],[107.56425781250002,15.391601562499972],[107.45957031250012,15.4658203125],[107.33876953125,15.560498046875011],[107.27939453125006,15.618701171875045],[107.18955078125006,15.747265624999955],[107.16591796875005,15.802490234375028],[107.1888671875,15.838623046875],[107.36064453125002,15.921728515624977],[107.39638671875,16.04301757812499],[107.29648437500006,16.08403320312499],[107.21738281250006,16.136328125000006],[106.93066406249997,16.353125000000034],[106.69609375000007,16.458984375],[106.50224609375002,16.95410156249997],[106.26953125000003,17.21679687500003],[105.69140625000003,17.737841796875045],[105.58847656250012,17.983691406250045],[105.51855468749997,18.077441406250045],[105.45820312500004,18.15429687499997],[105.33349609375003,18.189648437499983],[105.27324218750002,18.235351562500057],[105.1632812500001,18.338720703124977],[105.11455078125002,18.40527343750003],[105.08583984375005,18.450097656250023],[105.11347656250004,18.573046875000017],[105.14541015625,18.616796875000063],[105.14648437500003,18.650976562500006],[105.11513671875005,18.678857421874994],[104.99316406249997,18.728320312500045],[104.7165039062501,18.803417968749955],[104.61328125000003,18.86064453124999],[104.44580078125003,18.983837890624955],[104.10859375000004,19.195556640625],[103.91835937500005,19.26850585937504],[103.89638671875,19.339990234375023],[104.03203125000002,19.675146484375006],[104.06279296875007,19.678417968749983],[104.25986328125006,19.685498046874983],[104.5462890625,19.61054687500001],[104.58789062500003,19.618749999999977],[104.74316406250003,19.754736328124977],[104.80175781249997,19.83613281250004],[104.81513671875004,19.90400390625001],[104.9279296875001,20.01811523437499],[104.6188476562501,20.37451171875003],[104.58320312500004,20.646679687499955],[104.34960937499997,20.821093750000074],[104.19531249999997,20.913964843749966],[104.05205078125002,20.941210937500017],[103.63505859375007,20.697070312500017],[103.46357421875004,20.779833984375017],[103.21074218750002,20.840625000000045],[103.10449218749997,20.891650390625045],[102.88378906250003,21.202587890624983],[102.85117187500006,21.26591796874999],[102.9486328125,21.56977539062501],[102.69531250000003,21.66210937499997],[102.58251953125003,21.90429687500003],[102.1830078125,22.284033203125034],[102.12744140624997,22.379199218750045],[102.1759765625001,22.414648437500006],[102.2370117187501,22.466015624999983],[102.42792968750004,22.732812499999966],[102.51718750000012,22.741015625000045],[103.00537109375003,22.452978515624977],[103.35605468750006,22.75468749999999],[104.37177734375004,22.704052734374983],[104.79570312500007,22.91113281249997],[104.86474609375003,23.136376953125023],[105.27539062500003,23.34521484375003],[105.8429687500001,22.922802734374955],[106.14843749999997,22.970068359375006],[106.78027343749997,22.778906250000034],[106.53632812500004,22.395410156249994],[106.72949218749997,22.000341796875063],[107.35117187500012,21.60888671874997],[107.97265624999997,21.507958984375023]]]
},properties:{name:"Vietnam",childNum:1}},{geometry:{type:"MultiPolygon",coordinates:[[[[167.41250000000005,-16.095898437499997],[167.83662109375004,-16.449707031249957],[167.44931640625012,-16.554980468750003],[167.41250000000005,-16.095898437499997]]],[[[166.74580078125004,-14.826855468750011],[166.81015625000012,-15.15742187500004],[167.13164062500002,-15.135351562499977],[167.19960937500005,-15.485742187500037],[166.82578125000006,-15.634863281249963],[166.63105468750004,-15.406054687499974],[166.52724609375,-14.850097656249957],[166.74580078125004,-14.826855468750011]]]]},properties:{name:"Vanuatu",childNum:2}},{geometry:{type:"MultiPolygon",coordinates:[[[[53.76318359374997,12.636816406249991],[54.18740234375005,12.664013671875026],[54.12949218750006,12.360644531250045],[53.59833984375004,12.342285156250028],[53.76318359374997,12.636816406249991]]],[[[53.08564453125004,16.648388671874955],[52.327734375000006,16.293554687500063],[52.2174804687501,15.655517578125],[51.6037109375001,15.336816406250009],[50.52705078125004,15.038183593750006],[50.16689453125005,14.851025390624983],[49.34990234375002,14.637792968749977],[48.668359374999994,14.050146484374977],[47.9899414062501,14.048095703125],[47.40771484374997,13.661621093750057],[46.78886718750002,13.465576171874986],[45.65732421875006,13.338720703124991],[45.03867187500006,12.815869140624969],[44.617773437500006,12.817236328124977],[43.929785156250006,12.616503906250031],[43.47529296875004,12.83901367187498],[43.23193359375003,13.267089843750057],[43.28261718750005,13.639843749999969],[43.08906250000004,14.010986328125],[43.02109375000006,14.55488281250004],[42.71718750000005,15.654638671875006],[42.79931640624997,16.37177734375001],[43.16503906249997,16.689404296874955],[43.19091796875003,17.35937500000003],[43.41796875000003,17.516259765625023],[43.91699218749997,17.32470703124997],[44.1559570312501,17.398535156250006],[45.14804687500006,17.427441406249955],[45.40654296875002,17.319775390624955],[46.31035156250002,17.231298828125063],[46.682031249999994,17.2685546875],[46.97568359375006,16.953466796875034],[47.441796874999994,17.111865234375045],[47.57958984374997,17.448339843750034],[48.17216796875002,18.156933593749983],[49.04199218750003,18.58178710937503],[51.977636718750006,18.996142578125074],[52.72919921875004,17.300390625000006],[53.08564453125004,16.648388671874955]]]]},properties:{name:"Yemen",childNum:2}},{geometry:{type:"Polygon",coordinates:[[[31.921679687500017,-25.96875],[31.415136718750063,-25.74658203125003],[31.207324218750074,-25.843359375000034],[30.803320312500006,-26.41347656250001],[30.79433593750005,-26.764257812499977],[31.06337890625005,-27.1123046875],[31.274023437500063,-27.23837890625002],[31.469531250000017,-27.29550781250002],[31.74257812500005,-27.309960937500037],[31.95839843750005,-27.305859374999997],[31.946093750000017,-27.173632812499974],[31.96718750000005,-26.96064453125001],[31.994726562500006,-26.817480468749977],[32.024804687499994,-26.81113281250002],[32.112890625000006,-26.83945312500002],[32.199609374999994,-26.833496093749957],[32.35351562499997,-26.861621093750003],[32.7765625000001,-26.850976562499966],[32.88613281250005,-26.849316406249983],[32.53476562500006,-28.19970703125003],[32.285742187500006,-28.62148437499998],[31.778222656249994,-28.937109374999977],[31.335156250000097,-29.378125000000026],[30.288671875000063,-30.970117187499994],[28.85595703125003,-32.29423828125002],[27.860644531250017,-33.05390624999997],[27.077441406250074,-33.52119140625004],[26.429492187500045,-33.75957031250002],[25.989550781250045,-33.711328124999966],[25.63818359375003,-34.01113281250002],[25.00292968750003,-33.97363281250003],[24.8271484375,-34.16894531250003],[23.585546875000006,-33.985156249999974],[23.268164062500006,-34.08115234374999],[22.24550781250005,-34.06914062500003],[21.788964843750023,-34.37265624999996],[21.060156250000063,-34.36464843750001],[20.529882812500034,-34.4630859375],[20.020605468750006,-34.785742187500006],[19.63496093750004,-34.753320312499966],[18.80878906250004,-34.10820312499999],[18.354394531250023,-33.93906249999999],[18.43300781250005,-33.71728515625003],[17.87822265624999,-32.96152343749998],[18.25087890625008,-32.6521484375],[18.31074218750001,-32.12246093750001],[18.21083984375008,-31.74248046874996],[17.67744140625004,-31.019042968750014],[17.189062500000006,-30.09980468749997],[16.950000000000074,-29.40341796875002],[16.480761718750045,-28.641503906249966],[16.755761718750023,-28.45214843750003],[16.787500000000023,-28.39472656249997],[16.810156250000006,-28.264550781249994],[16.841210937500023,-28.21894531250004],[16.875292968750045,-28.12792968749997],[16.93330078125004,-28.06962890624999],[17.056250000000063,-28.03105468750003],[17.14941406250003,-28.082226562499983],[17.1884765625,-28.13251953125001],[17.44794921875001,-28.698144531249966],[18.310839843750017,-28.88623046875],[19.026074218750068,-28.92792968749997],[19.98046875,-28.310351562500003],[19.98046875,-26.531152343749994],[19.98046875,-24.77675781249998],[20.345214843750057,-25.029882812500034],[20.79316406250001,-25.915625000000006],[20.641406250000017,-26.7421875],[20.739843749999977,-26.84882812499997],[21.64628906249999,-26.854199218749997],[21.694726562500023,-26.840917968749963],[21.738085937500045,-26.806835937500026],[21.788281250000068,-26.710058593750034],[21.833203125000068,-26.678320312499963],[21.91455078125003,-26.66191406249999],[22.01093750000004,-26.635839843750006],[22.090917968749977,-26.580175781250034],[22.217578125000045,-26.38886718749997],[22.640234374999977,-26.071191406249994],[22.729003906250057,-25.857324218750037],[22.79609375000004,-25.679101562499966],[22.878808593750023,-25.457910156250023],[23.148730468750017,-25.288671875000006],[23.52148437500003,-25.344433593749997],[23.670703125000045,-25.433984375000037],[23.89375000000001,-25.600878906250017],[23.96953124999999,-25.62607421874999],[24.192968750000034,-25.632910156249963],[24.748144531250006,-25.817382812499986],[25.518164062500006,-25.66279296875001],[25.91210937499997,-24.747460937499966],[26.39716796875004,-24.61357421874996],[26.451757812500063,-24.582714843749983],[26.617773437500034,-24.39550781250003],[26.761132812500023,-24.297167968749974],[26.835058593750063,-24.240820312499963],[26.97060546875005,-23.76347656249996],[26.98701171875004,-23.704589843749957],[27.085546875000034,-23.577929687500003],[27.14638671875008,-23.52441406250003],[27.7685546875,-23.14892578125],[27.812597656250006,-23.108007812500006],[28.210156249999983,-22.693652343749974],[28.83984375000003,-22.480859374999966],[28.94580078125003,-22.39511718749999],[29.013476562500045,-22.27841796875002],[29.129882812500057,-22.21328124999998],[29.364843750000063,-22.19394531250005],[29.37744140625003,-22.19277343749998],[29.66308593749997,-22.146289062500017],[30.19042968750003,-22.291113281250034],[30.460156250000097,-22.329003906250023],[30.71162109375004,-22.297851562499986],[31.07343750000004,-22.30781249999997],[31.19726562499997,-22.344921874999983],[31.287890625000074,-22.402050781249983],[31.54560546875004,-23.48232421874998],[31.799609375000017,-23.89218749999999],[31.858300781249994,-24.04023437500004],[31.98583984374997,-24.460644531249983],[31.983203125000017,-24.63828125000002],[31.98437500000003,-24.844042968750017],[31.987011718750097,-25.263476562500017],[31.98457031250004,-25.631933593750034],[31.920312499999994,-25.773925781250014],[31.921679687500017,-25.96875]],[[27.19355468750001,-29.94130859375001],[27.364062500000017,-30.27919921875001],[27.753125000000068,-30.599999999999994],[28.05683593750001,-30.63105468750001],[28.128710937500017,-30.52509765625001],[28.39208984375003,-30.14755859375002],[29.09804687500005,-29.919042968750006],[29.142187500000063,-29.70097656249999],[29.293554687500006,-29.56689453125003],[29.348828125000097,-29.441992187499977],[29.38671874999997,-29.319726562500023],[29.390722656250006,-29.26972656249997],[29.370898437500017,-29.218457031249997],[29.301367187500006,-29.08984375],[28.625781250000017,-28.581738281250054],[27.73554687500004,-28.940039062500034],[27.294531250000063,-29.519335937500017],[27.19355468750001,-29.94130859375001]]]},properties:{name:"South Africa",childNum:2}},{geometry:{type:"Polygon",coordinates:[[[33.148046875000006,-9.603515625],[33.35097656250002,-9.862207031250009],[33.33710937500001,-9.954003906250009],[33.3115234375,-10.037988281250009],[33.65908203125002,-10.590527343750011],[33.46474609375002,-10.783105468750009],[33.40312500000002,-10.8017578125],[33.34492187500001,-10.812695312500011],[33.29277343750002,-10.852343750000003],[33.261328125000006,-10.893359375000003],[33.29326171875002,-10.981152343750011],[33.33867187500002,-11.085156250000011],[33.37978515625002,-11.157910156250011],[33.26835937500002,-11.403906250000006],[33.23271484375002,-11.417675781250011],[33.22636718750002,-11.534863281250011],[33.25234375000002,-12.112597656250003],[33.34013671875002,-12.308300781250011],[33.49140625000001,-12.3310546875],[33.48320312500002,-12.403417968750006],[33.4306640625,-12.46044921875],[33.39794921875,-12.489843750000006],[33.24345703125002,-12.556542968750009],[33.021582031250006,-12.630468750000006],[32.94560546875002,-12.804394531250011],[32.97050781250002,-12.86474609375],[33,-12.899609375000011],[32.96757812500002,-13.225000000000009],[32.797460937500006,-13.6884765625],[33.148046875000006,-13.94091796875],[33.201757812500006,-14.013378906250011],[31.728906250000023,-14.49609375],[30.231835937500023,-14.990332031250006],[30.396093750000006,-15.64306640625],[29.729589843750006,-15.644628906250006],[28.9130859375,-15.98779296875],[28.760644531250023,-16.53193359375001],[27.932226562500006,-16.89619140625001],[27.020800781250017,-17.95839843750001],[25.86328125,-17.951953125000003],[25.2587890625,-17.793554687500006],[24.932421875000017,-17.54345703125],[24.27490234375,-17.481054687500006],[23.380664062500017,-17.640625],[23.181640625,-17.474414062500003],[22.955859375000017,-17.285742187500006],[22.305078125000023,-16.689550781250006],[22.193945312500006,-16.62812500000001],[22.150683593750017,-16.59716796875],[21.979785156250017,-15.95556640625],[21.979785156250017,-15.72412109375],[21.97968750000001,-15.403222656250009],[21.9794921875,-14.761425781250011],[21.979394531250023,-14.440527343750006],[21.979296875000017,-14.11962890625],[21.979101562500006,-13.798730468750009],[21.979101562500006,-13.477734375000011],[21.978906250000023,-13.0009765625],[22.209570312500006,-13.0009765625],[23.843164062500023,-13.0009765625],[23.90937500000001,-12.636132812500009],[23.991308593750006,-12.422167968750003],[23.96650390625001,-10.871777343750011],[24.319921875000006,-11.07177734375],[24.5185546875,-11.4384765625],[25.184863281250017,-11.242968750000003],[25.349414062500017,-11.623046875],[26.025976562500006,-11.89013671875],[26.59638671875001,-11.972070312500009],[26.949609375000023,-11.898828125000009],[27.04609375000001,-11.615917968750011],[27.53339843750001,-12.1953125],[28.357714843750017,-12.482031250000006],[29.014257812500006,-13.368847656250011],[29.55419921875,-13.248925781250009],[29.795312500000023,-13.392773437500011],[29.79511718750001,-12.155468750000011],[29.427539062500017,-12.431250000000006],[29.064355468750023,-12.348828125000011],[28.482519531250006,-11.812109375000006],[28.357226562500017,-11.483007812500006],[28.63886718750001,-10.669238281250003],[28.63007812500001,-9.831250000000011],[28.400683593750017,-9.224804687500011],[28.917773437500017,-8.700585937500009],[28.972265625000006,-8.464941406250006],[30.75117187500001,-8.193652343750003],[30.830664062500006,-8.385546875000003],[31.07636718750001,-8.611914062500006],[31.3505859375,-8.607031250000006],[31.44921875,-8.653906250000006],[31.53486328125001,-8.713281250000009],[31.673632812500017,-8.908789062500006],[31.94257812500001,-9.054003906250003],[32.75664062500002,-9.322265625],[33.148046875000006,-9.603515625]]]},properties:{name:"Zambia",childNum:1}},{geometry:{type:"Polygon",coordinates:[[[31.287890625000017,-22.40205078125001],[31.07343750000001,-22.30781250000001],[30.71162109375001,-22.2978515625],[30.46015625000001,-22.32900390625001],[29.6630859375,-22.146289062500003],[29.37744140625,-22.19277343750001],[29.364843750000006,-22.193945312500006],[29.315234375000017,-22.15771484375],[29.237207031250023,-22.07949218750001],[29.106835937500023,-22.065722656250003],[29.03730468750001,-21.811328125000003],[28.04560546875001,-21.573046875000003],[27.66943359375,-21.064257812500003],[27.699609375000023,-20.53066406250001],[27.28076171875,-20.47871093750001],[27.221484375000017,-20.145800781250003],[26.67822265625,-19.89277343750001],[26.168066406250006,-19.53828125000001],[25.76123046875,-18.649218750000003],[25.224023437500023,-17.91523437500001],[25.2587890625,-17.793554687500006],[25.86328125,-17.951953125000003],[27.020800781250017,-17.95839843750001],[27.932226562500006,-16.89619140625001],[28.760644531250023,-16.53193359375001],[28.9130859375,-15.98779296875],[29.729589843750006,-15.644628906250006],[30.396093750000006,-15.64306640625],[30.437792968750017,-15.995312500000011],[31.236230468750023,-16.02363281250001],[31.939843750000023,-16.428808593750006],[32.243261718750006,-16.44873046875],[32.94804687500002,-16.71230468750001],[32.99306640625002,-18.35957031250001],[32.71650390625001,-19.00185546875001],[33.00673828125002,-19.873828125000003],[32.477636718750006,-20.712988281250006],[32.37109375,-21.33486328125001],[31.429492187500017,-22.298828125],[31.287890625000017,-22.40205078125001]]]},properties:{name:"Zimbabwe",childNum:1}}]},x={type:"FeatureCollection",features:[{id:"710000",geometry:{type:"MultiPolygon",coordinates:[["@@°Ü¯Û","@@ƛĴÕƊÉɼģºðʀ\\ƎsÆNŌÔĚänÜƤɊĂǀĆĴĤǊŨxĚĮǂƺòƌâÔ®ĮXŦţƸZûÐƕƑGđ¨ĭMó·ęcëƝɉlÝƯֹÅŃ^Ó·śŃǋƏďíåɛGɉ¿IċããF¥ĘWǬÏĶñÄ","@@\\p|WoYG¿¥Ij@","@@¡@V^RqBbAnTXeQr©C","@@ÆEEkWqë I"]],encodeOffsets:[[[122886,24033],[123335,22980],[122375,24193],[122518,24117],[124427,22618]]]},properties:{cp:[121.509062,25.044332],name:"台湾",childNum:5}},{id:"130000",geometry:{type:"MultiPolygon",coordinates:[["@@\\aM`Ç½ÓnUKĜēs¤­©yrý§uģcJ»eIP]ªrºc_ħ²G¼s`jÎŸnüsÂľP","@@U`Ts¿mÄ","@@FOhđ©OiÃ`ww^ÌkÑH«ƇǤŗĺtFu{Z}Ö@U´ʚLg®¯Oı°Ãw ^VbÉsmAê]]w§RRl£ŭuwNÁ`ÇFēÝčȻuT¡Ĺ¯Õ¯sŗő£YªhVƍ£ƅnëYNgq¼ś¿µı²UºÝUąąŖóxV@tƯJ]eR¾fe|rHA|h~Ėƍl§ÏjVë` ØoÅbbx³^zÃĶ¶Sj®AyÂhðk`«PËµEFÛ¬Y¨Ļrõqi¼Wi°§Ð±²°`[À|ĠO@ÆxO\\ta\\p_Zõ^û{ġȧXýĪÓjùÎRb^Î»j{íděYfíÙTymńŵōHim½éŅ­aVcř§ax¹XŻácWU£ôãºQ¨÷Ñws¥qEHÙ|šYQoŕÇyáĂ£MÃ°oťÊP¡mWO¡v{ôvîēÜISpÌhp¨ jdeŔQÖjX³àĈ[n`Yp@UcM`RKhEbpŞlNut®EtqnsÁgAiúoHqCXhfgu~ÏWP½¢G^}¯ÅīGCÑ^ãziMáļMTÃƘrMc|O_¯Ŏ´|morDkO\\mĆJfl@cĢ¬¢aĦtRıÒXòë¬WP{ŵǫƝīÛ÷ąV×qƥV¿aȉd³BqPBmaËđŻģmÅ®V¹d^KKonYg¯XhqaLdu¥Ípǅ¡KąÅkĝęěhq}HyÃ]¹ǧ£Í÷¿qágPmoei¤o^á¾ZEY^Ný{nOl±Í@Mċèk§daNaÇį¿]øRiiñEūiǱàUtėGyl}ÓM}jpEC~¡FtoQiHkk{ILgĽxqÈƋÄdeVDJj£J|ÅdzÂFt~KŨ¸IÆv|¢r}èonb}`RÎÄn°ÒdÞ²^®lnÐèĄlðÓ×]ªÆ}LiĂ±Ö`^°Ç¶p®đDcŋ`ZÔ¶êqvFÆN®ĆTH®¦O¾IbÐã´BĐɢŴÆíȦpĐÞXR·nndO¤OÀĈƒ­QgµFo|gȒęSWb©osx|hYhgŃfmÖĩnºTÌSp¢dYĤ¶UĈjlǐpäðëx³kÛfw²Xjz~ÂqbTÑěŨ@|oMzv¢ZrÃVw¬ŧĖ¸f°ÐTªqs{S¯r æÝl¼ÖĞ ǆiGĘJ¼lr}~K¨ŸƐÌWö¼Þ°nÞoĦL|C~D©|q]SvKÑcwpÏÏĿćènĪWlĄkT}¬Tp~®Hgd˒ĺBVtEÀ¢ôPĎƗè@~kü\\rÊĔÖæW_§¼F´©òDòjYÈrbĞāøŀG{ƀ|¦ðrb|ÀH`pʞkvGpuARhÞÆǶgĘTǼƹS£¨¡ù³ŘÍ]¿ÂyôEP xX¶¹ÜO¡gÚ¡IwÃé¦ÅBÏ|Ç°N«úmH¯âbęU~xĈbȒ{^xÖlD¸dɂ~"]],encodeOffsets:[[[120023,41045],[121616,39981],[122102,42307]]]},properties:{cp:[114.502461,38.045474],name:"河北",childNum:3}},{id:"140000",geometry:{type:"Polygon",coordinates:["@@ħÜ_ªlìwGkÛÃǏokćiµVZģ¡coTSË¹ĪmnÕńehZg{gtwªpXaĚThȑp{¶Eh®RćƑP¿£PmcªaJyý{ýȥoÅîɡųAďä³aÏJ½¥PG­ąSM­sWz½µÛYÓŖgxoOkĒCo­Èµ]¯_²ÕjāK~©ÅØ^ÔkïçămÏk]­±cÝ¯ÑÃmQÍ~_apm~ç¡qu{JÅŧ·Ls}EyÁÆcI{¤IiCfUcƌÃp§]ě«vD@¡SÀµMÅwuYY¡DbÑc¡h×]nkoQdaMç~eDÛtT©±@¥ù@É¡ZcW|WqOJmĩl«ħşvOÓ«IqăV¥D[mI~Ó¢cehiÍ]Ɠ~ĥqX·eƷn±}v[ěďŕ]_œ`¹§ÕōIo©b­s^}Ét±ū«³p£ÿ¥WÑxçÁ«h×u×¥ř¾dÒ{ºvĴÎêÌɊ²¶ü¨|ÞƸµȲLLúÉƎ¤ϊęĔV`_bªS^|dzY|dz¥pZbÆ£¶ÒK}tĦÔņƠPYznÍvX¶Ěn ĠÔzý¦ª÷ÑĸÙUȌ¸dòÜJð´ìúNM¬XZ´¤ŊǸ_tldI{¦ƀðĠȤ¥NehXnYGR° ƬDj¬¸|CĞKqºfƐiĺ©ª~ĆOQª ¤@ìǦɌ²æBÊTĞHƘÁĪËĖĴŞȀÆÿȄlŤĒötÎ½î¼ĨXh|ªM¤ÐzÞĩÒSrao³"],encodeOffsets:[[117016,41452]]},properties:{cp:[112.549248,37.857014],name:"山西",childNum:1}},{id:"150000",geometry:{type:"MultiPolygon",coordinates:[["@@ǪƫÌÛMĂ[`ÕCn}¶Vcês¯PqFB|S³C|kñHdiÄ¥sŉÅPóÑÑE^ÅPpy_YtShQ·aHwsOnŉÃs©iqjUSiº]ïW«gW¡ARëśĳĘů`çõh]y»ǃǛҤxÒm~zf}pf|ÜroÈzrKÈĵSƧż؜Ġu~è¬vîS¼ĂhĖMÈÄw\\fŦ°W ¢¾luŸDw\\Ŗĝ","@@GVu»Aylßí¹ãe]Eāò³C¹ð¾²iÒAdkò^P²CǜңǄ z¼g^èöŰ_Ĳĕê}gÁnUI«m]jvV¼euhwqAaW_µj»çjioQR¹ēÃßt@r³[ÛlćË^ÍÉáGOUÛOB±XkÅ¹£k|e]olkVÍ¼ÕqtaÏõjgÁ£§U^RLËnX°ÇBz^~wfvypV ¯ƫĉ˭ȫƗŷɿÿĿƑ˃ĝÿÃǃßËőó©ǐȍŒĖM×ÍEyxþp]ÉvïèvƀnÂĴÖ@V~Ĉ³MEĸÅĖtējyÄDXÄxGQuv_i¦aBçw˛wD©{tāmQ{EJ§KPśƘƿ¥@sCTÉ}ɃwƇy±gÑ}T[÷kÐç¦«SÒ¥¸ëBX½HáÅµÀğtSÝÂa[ƣ°¯¦Pï¡]£ġÒk®G²èQ°óMq}EóƐÇ\\@áügQÍu¥FTÕ¿Jû]|mvāÎYua^WoÀa·­ząÒot×¶CLƗi¯¤mƎHǊ¤îìɾŊìTdåwsRÖgĒųúÍġäÕ}Q¶¿A[¡{d×uQAMxVvMOmăl«ct[wº_ÇÊjbÂ£ĦS_éQZ_lwgOiýe`YYJq¥IÁǳ£ÙË[ÕªuƏ³ÍTs·bÁĽäė[b[ŗfãcn¥îC¿÷µ[ŏÀQ­ōĉm¿Á^£mJVmL[{Ï_£F¥Ö{ŹA}×Wu©ÅaųĳƳhB{·TQqÙIķËZđ©Yc|M¡LeVUóK_QWk_ĥ¿ãZ»X\\ĴuUèlG®ěłTĠğDŃGÆÍz]±ŭ©Å]ÅÐ}UË¥©TċïxgckfWgi\\ÏĒ¥HkµEë{»ÏetcG±ahUiñiWsɁ·cCÕk]wȑ|ća}wVaĚá G°ùnM¬¯{ÈÐÆA¥ÄêJxÙ¢hP¢ÛºµwWOóFÁz^ÀŗÎú´§¢T¤ǻƺSėǵhÝÅQgvBHouʝl_o¿Ga{ïq{¥|ſĿHĂ÷aĝÇqZñiñC³ª»E`¨åXēÕqÉû[l}ç@čƘóO¿¡FUsAʽīccocÇS}£IS~ălkĩXçmĈŀÐoÐdxÒuL^T{r@¢ÍĝKén£kQyÅõËXŷƏL§~}kq»IHėǅjĝ»ÑÞoå°qTt|r©ÏS¯·eŨĕx«È[eM¿yupN~¹ÏyN£{©għWí»Í¾səšǅ_ÃĀɗ±ąĳĉʍŌŷSÉA±åǥɋ@ë£R©ąP©}ĹªƏj¹erLDĝ·{i«ƫC½ÉshVzGS|úþXgp{ÁX¿ć{ƱȏñZáĔyoÁhA}ŅĆfdŉ_¹Y°ėǩÑ¡H¯¶oMQqð¡Ë|Ñ`ƭŁX½·óÛxğįÅcQs«tȋǅFù^it«Č¯[hAi©á¥ÇĚ×l|¹y¯Kȝqgů{ñǙµïċĹzŚȭ¶¡oŽäÕG\\ÄT¿Òõr¯LguÏYęRƩɷŌO\\İÐ¢æ^Ŋ ĲȶȆbÜGĝ¬¿ĚVĎgª^íu½jÿĕęjık@Ľ]ėl¥ËĭûÁėéV©±ćn©­ȇÍq¯½YÃÔŉÉNÑÅÝy¹NqáʅDǡËñ­ƁYÅy̱os§ȋµʽǘǏƬɱàưN¢ƔÊuľýľώȪƺɂļxZĈ}ÌŉŪĺœĭFЛĽ̅ȣͽÒŵìƩÇϋÿȮǡŏçƑůĕ~Ç¼ȳÐUfdIxÿ\\G zâɏÙOº·pqy£@qþ@Ǟ˽IBäƣzsÂZÁàĻdñ°ŕzéØűzșCìDȐĴĺf®Àľưø@ɜÖÞKĊŇƄ§͑těï͡VAġÑÑ»d³öǍÝXĉĕÖ{þĉu¸ËʅğU̎éhɹƆ̗̮ȘǊ֥ड़ࡰţાíϲäʮW¬®ҌeרūȠkɬɻ̼ãüfƠSצɩςåȈHϚÎKǳͲOðÏȆƘ¼CϚǚ࢚˼ФÔ¤ƌĞ̪Qʤ´¼mȠJˀƲÀɠmɆǄĜƠ´ǠN~ʢĜ¶ƌĆĘźʆȬ˪ĚĒ¸ĞGȖƴƀj`ĢçĶāàŃºēĢĖćYÀŎüôQÐÂŎŞǆŞêƖoˆDĤÕºÑǘÛˤ³̀gńƘĔÀ^ªƂ`ªt¾äƚêĦĀ¼ÐĔǎ¨Ȕ»͠^ˮÊȦƤøxRrŜH¤¸ÂxDÄ|ø˂˜ƮÐ¬ɚwɲFjĔ²Äw°ǆdÀÉ_ĸdîàŎjÊêTĞªŌŜWÈ|tqĢUB~´°ÎFCU¼pĀēƄN¦¾O¶łKĊOjĚj´ĜYp{¦SĚÍ\\T×ªV÷Ší¨ÅDK°ßtŇĔK¨ǵÂcḷ̌ĚǣȄĽFlġUĵŇȣFʉɁMğįʏƶɷØŭOǽ«ƽū¹Ʊő̝Ȩ§ȞʘĖiɜɶʦ}¨֪ࠜ̀ƇǬ¹ǨE˦ĥªÔêFxúQEr´Wrh¤Ɛ \\talĈDJÜ|[Pll̚¸ƎGú´P¬W¦^¦H]prRn|or¾wLVnÇIujkmon£cX^Bh`¥V¦U¤¸}xRj[^xN[~ªxQ[`ªHÆÂExx^wN¶Ê|¨ìMrdYpoRzNyÀDs~bcfÌ`L¾n|¾T°c¨È¢ar¤`[|òDŞĔöxElÖdHÀI`Ď\\Àì~ÆR¼tf¦^¢ķ¶eÐÚMptgjɡČÅyġLûŇV®ÄÈƀĎ°P|ªVVªj¬ĚÒêp¬E|ŬÂ_~¼rƐK f{ĘFĒƌXưăkÃĄ}nµo×q£ç­kX{uĩ«āíÓUŅÝVUŌ]Ť¥lyň[oi{¦LĸĦ^ôâJ¨^UZðÚĒL¿Ìf£K£ʺoqNwğc`uetOj×°KJ±qÆġmĚŗos¬qehqsuH{¸kH¡ÊRǪÇƌbȆ¢´äÜ¢NìÉʖ¦â©Ɨؗ"]],encodeOffsets:[[[128500,52752],[127089,51784]]]},properties:{cp:[111.670801,40.818311],name:"内蒙古",childNum:2}},{id:"210000",geometry:{type:"MultiPolygon",coordinates:[["@@L@@s]","@@MnNm","@@dc","@@eÀC@b","@@fXwkbrÄ`qg","@@^jtWQ","@@~ Y[c","@@I`ĖN^_¿ZÁM","@@Ïxǌ{q_×^Gigp","@@iX¶BY","@@YZ","@@L_yG`b","@@^WqCTZ","@@\\[§t|]","@@m`p[","@@@é^BntaÊU]x ¯ÄPĲ­°hʙK³VÕ@Y~|EvĹsÇ¦­L^pÃ²ŸÒG Ël]xxÄ_fT¤Ď¤cPC¨¸TVjbgH²sdÎdHt`B²¬GJję¶[ÐhjeXdlwhðSČ¦ªVÊÏÆZÆŶ®²^ÎyÅHńĚDMħĜŁH­kçvV[ĳ¼WYÀäĦ`XlR`ôLUVfK¢{NZdĒªYĸÌÚJRr¸SA|ƴgŴĴÆbvªØX~źB|¦ÕE¤Ð`\\|KUnnI]¤ÀÂĊnŎR®Ő¿¶\\ÀøíDm¦ÎbŨabaĘ\\ľãÂ¸atÎSƐ´©v\\ÖÚÌǴ¤Â¨JKrZ_ZfjþhPkx`YRIjJcVf~sCN¤ EhæmsHy¨SðÑÌ\\\\ĐRÊwS¥fqŒßýáĞÙÉÖ[^¯ǤŲê´\\¦¬ĆPM¯£»uïpùzExanµyoluqe¦W^£ÊL}ñrkqWňûPUP¡ôJoo·U}£[·¨@XĸDXm­ÛÝºGUCÁª½{íĂ^cjk¶Ã[q¤LÉö³cux«|Zd²BWÇ®Yß½ve±ÃCý£W{Ú^q^sÑ·¨ËMr¹·C¥GDrí@wÕKţÃ«V·i}xËÍ÷i©ĝɝǡ]{c±OW³Ya±_ç©HĕoƫŇqr³Lys[ñ³¯OSďOMisZ±ÅFC¥Pq{Ã[Pg}\\¿ghćOk^ĩÃXaĕËĥM­oEqqZûěŉ³F¦oĵhÕP{¯~TÍlªNßYÐ{Ps{ÃVUeĎwk±ŉVÓ½ŽJãÇÇ»Jm°dhcÀffdF~ĀeĖd`sx² ®EĦ¦dQÂd^~ăÔH¦\\LKpĄVez¤NP ǹÓRÆąJSh­a[¦´ÂghwmBÐ¨źhI|VV|p] Â¼èNä¶ÜBÖ¼L`¼bØæKVpoúNZÞÒKxpw|ÊEMnzEQIZZNBčÚFÜçmĩWĪñtÞĵÇñZ«uD±|ƏlǗw·±PmÍada CLǑkùó¡³Ï«QaċÏOÃ¥ÕđQȥċƭy³ÁA"]],encodeOffsets:[[[123686,41445],[126019,40435],[124393,40128],[126117,39963],[125322,40140],[126686,40700],[126041,40374],[125584,40168],[125509,40217],[125453,40165],[125362,40214],[125280,40291],[125774,39997],[125976,40496],[125822,39993],[122731,40949]]]},properties:{cp:[123.429096,41.796767],name:"辽宁",childNum:16}},{id:"220000",geometry:{type:"Polygon",coordinates:["@@ñr½ÉKāGÁ¤ia ÉÈ¹`\\xs¬dĆkNnuNUwNx¶c¸|\\¢GªóĄ~RãÖÎĢùđŴÕhQxtcæëSɽŉíëǉ£ƍG£nj°KƘµDsØÑpyĆ¸®¿bXp]vbÍZuĂ{n^IüÀSÖ¦EvRÎûh@â[ƏÈô~FNr¯ôçR±­HÑlĢ^¤¢OðætxsŒ]ÞÁTĠs¶¿âÆGW¾ìA¦·TÑ¬è¥ÏÐJ¨¼ÒÖ¼ƦɄxÊ~StD@Ă¼Ŵ¡jlºWvÐzƦZÐ²CH AxiukdGgetqmcÛ£Ozy¥cE}|¾cZk¿uŐã[oxGikfeäT@SUwpiÚFM©£è^Ú`@v¶eňf heP¶täOlÃUgÞzŸU`l}ÔÆUvØ_Ō¬Öi^ĉi§²ÃB~¡ĈÚEgc|DC_Ȧm²rBx¼MÔ¦ŮdĨÃâYxƘDVÇĺĿg¿cwÅ\\¹¥Yĭl¤OvLjM_a W`zļMž·\\swqÝSAqŚĳ¯°kRē°wx^ĐkǂÒ\\]nrĂ}²ĊŲÒøãh·M{yMzysěnĒġV·°G³¼XÀ¤¹i´o¤ŃÈ`ÌǲÄUĞd\\iÖmÈBĤÜɲDEh LG¾ƀÄ¾{WaYÍÈĢĘÔRîĐj}ÇccjoUb½{h§Ǿ{KƖµÎ÷GĄØŜçưÌs«lyiē«`å§H¥Ae^§GK}iã\\c]v©ģZmÃ|[M}ģTɟĵÂÂ`ÀçmFK¥ÚíÁbX³ÌQÒHof{]ept·GŋĜYünĎųVY^ydõkÅZW«WUa~U·SbwGçǑiW^qFuNĝ·EwUtW·Ýďæ©PuqEzwAVXRãQ`­©GYYhcUGorBd}ģÉb¡·µMicF«Yƅ»é\\ɹ~ǙG³mØ©BšuT§Ĥ½¢Ã_Ã½L¡ûsT\\rke\\PnwAKy}ywdSefµ]UhĿD@mÿvaÙNSkCuncÿ`lWėVâ¦÷~^fÏ~vwHCį`xqT­­lW«ï¸skmßEGqd¯R©Ý¯¯S\\cZ¹iűƏCuƍÓXoR}M^o£R}oªU­FuuXHlEÅÏ©¤ßgXþ¤D²ÄufàÀ­XXÈ±Ac{Yw¬dvõ´KÊ£\\rµÄlidā]|î©¾DÂVH¹Þ®ÜWnCķ W§@\\¸~¤Vp¸póIO¢VOŇürXql~òÉK]¤¥Xrfkvzpm¶bwyFoúvð¼¤ N°ąO¥«³[éǣű]°Õ\\ÚÊĝôîŇÔaâBYlďQ[ Ë[ïÒ¥RI|`j]P"],encodeOffsets:[[126831,44503]]},properties:{cp:[125.3245,43.886841],name:"吉林",childNum:1}},{id:"230000",geometry:{type:"MultiPolygon",coordinates:[["@@UµNÿ¥īèçHÍøƕ¶Lǽ|g¨|a¾pVidd~ÈiíďÓQġėÇZÎXb½|ſÃH½KFgɱCģÛÇAnjÕc[VĝǱÃËÇ_ £ń³pj£º¿»WH´¯U¸đĢmtĜyzzNN|g¸÷äűÑ±ĉā~mq^[ǁÑďlw]¯xQĔ¯l°řĴrBÞTxr[tŽ¸ĻN_yX`biNKuP£kZĮ¦[ºxÆÀdhĹŀUÈƗCwáZħÄŭcÓ¥»NAw±qȥnD`{ChdÙFć}¢A±Äj¨]ĊÕjŋ«×`VuÓÅ~_kŷVÝyhVkÄãPsOµfgeŇµf@u_Ù ÙcªNªÙEojVxT@ãSefjlwH\\pŏäÀvlY½d{F~¦dyz¤PÜndsrhfHcvlwjF£G±DÏƥYyÏu¹XikĿ¦ÏqƗǀOŜ¨LI|FRĂn sª|C˜zxAè¥bfudTrFWÁ¹Am|ĔĕsķÆF´N}ćUÕ@Áĳſmuçuð^ÊýowFzØÎĕNőǏȎôªÌŒǄàĀÄ˄ĞŀƒʀĀƘŸˮȬƬĊ°Uzouxe]}AyÈW¯ÌmKQ]Īºif¸ÄX|sZt|½ÚUÎ lk^p{f¤lºlÆW A²PVÜPHÊâ]ÎĈÌÜk´\\@qàsĔÄQºpRij¼èi`¶bXrBgxfv»uUi^v~J¬mVp´£´VWrnP½ì¢BX¬hðX¹^TjVriªjtŊÄmtPGx¸bgRsT`ZozÆO]ÒFôÒOÆŊvÅpcGêsx´DR{AEOr°x|íb³Wm~DVjºéNNËÜ˛ɶ­GxŷCSt}]ûōSmtuÇÃĕNāg»íT«u}ç½BĵÞʣ¥ëÊ¡MÛ³ãȅ¡ƋaǩÈÉQG¢·lG|tvgrrf«ptęŘnÅĢrI²¯LiØsPf_vĠdxM prʹL¤¤eËÀđKïÙVY§]Ióáĥ]ķK¥j|pŇ\\kzţ¦šnņäÔVĂîĪ¬|vW®l¤èØrxm¶ă~lÄƯĄ̈́öȄEÔ¤ØQĄĄ»ƢjȦOǺ¨ìSŖÆƬyQv`cwZSÌ®ü±Ǆ]ŀç¬B¬©ńzƺŷɄeeOĨSfm ĊƀP̎ēz©ĊÄÕÊmgÇsJ¥ƔŊśæÎÑqv¿íUOµªÂnĦÁ_½ä@êí£P}Ġ[@gġ}gɊ×ûÏWXá¢užƻÌsNÍ½ƎÁ§čŐAēeL³àydl¦ĘVçŁpśǆĽĺſÊQíÜçÛġÔsĕ¬Ǹ¯YßċġHµ ¡eå`ļrĉŘóƢFìĎWøxÊkƈdƬv|I|·©NqńRŀ¤éeŊŀàŀU²ŕƀBQ£Ď}L¹Îk@©ĈuǰųǨÚ§ƈnTËÇéƟÊcfčŤ^XmHĊĕË«W·ċëx³ǔķÐċJāwİ_ĸȀ^ôWr­°oú¬ĦŨK~ȰCĐ´Ƕ£fNÎèâw¢XnŮeÂÆĶ¾¾xäLĴĘlļO¤ÒĨA¢Êɚ¨®ØCÔ ŬGƠƦYĜĘÜƬDJg_ͥœ@čŅĻA¶¯@wÎqC½Ĉ»NăëKďÍQÙƫ[«ÃígßÔÇOÝáWñuZ¯ĥŕā¡ÑķJu¤E å¯°WKÉ±_d_}}vyõu¬ï¹ÓU±½@gÏ¿rÃ½DgCdµ°MFYxw¿CG£Rƛ½Õ{]L§{qqą¿BÇƻğëܭǊË|c²}Fµ}ÙRsÓpg±QNqǫŋRwŕnéÑÉK«SeYRŋ@{¤SJ}D Ûǖ֍]gr¡µŷjqWÛham³~S«Ü[","@@ƨĶTLÇyqpÇÛqe{~oyen}s`qiXGù]Ëp½©lÉÁp]Þñ´FĂ^fäîºkàz¼BUv¬D"]],encodeOffsets:[[[134456,44547],[127123,51780]]]},properties:{cp:[126.642464,45.756967],name:"黑龙江",childNum:2}},{id:"320000",geometry:{type:"Polygon",coordinates:["@@Õg^vÁbnÀ`Jnĝ¬òM¶ĘTÖŒbe¦¦{¸ZâćNp©Hp|`mjhSEb\\afv`sz^lkljÄtg¤D­¾X¿À|ĐiZȀåB·î}GL¢õcßjayBFµÏC^ĭcÙt¿sğH]j{s©HM¢QnDÀ©DaÜÞ·jgàiDbPufjDk`dPOîhw¡ĥ¥GP²ĐobºrYî¶aHŢ´ ]´rılw³r_{£DB_Ûdåuk|Ũ¯F Cºyr{XFye³Þċ¿ÂkĭB¿MvÛpm`rÚã@Ę¹hågËÖƿxnlč¶Åì½Ot¾dJlVJĂǀŞqvnO^JZż·Q}êÍÅmµÒ]ƍ¦Dq}¬R^èĂ´ŀĻĊIÔtĲyQŐĠMNtR®òLhĚs©»}OÓGZz¶A\\jĨFäOĤHYJvÞHNiÜaĎÉnFQlNM¤B´ĄNöɂtpŬdZÅglmuÇUšŞÚb¤uŃJŴu»¹ĄlȖħŴw̌ŵ²ǹǠ͛hĭłƕrçü±Yrřl¥i`ã__¢ćSÅr[Çq^ùzWmOĈaŐÝɞï²ʯʊáĘĳĒǭPħ͍ôƋÄÄÍīçÛɈǥ£­ÛmY`ó£Z«§°Ó³QafusNıǅ_k}¢m[ÝóDµ¡RLčiXyÅNïă¡¸iĔÏNÌķoıdōîåŤûHcs}~Ûwbù¹£¦ÓCtOPrE^ÒogĉIµÛÅʹK¤½phMú`mR¸¦PƚgÉLRs`£¯ãhD¨|³¤C"],encodeOffsets:[[121451,32518]]},properties:{cp:[118.767413,32.041544],name:"江苏",childNum:1}},{id:"330000",geometry:{type:"MultiPolygon",coordinates:[["@@jX^n","@@sfdM","@@qP\\xz[_i","@@o\\VzRZ}mECy","@@R¢FX}°[m]","@@Cb\\}","@@e|v\\laus","@@v~s{","@@QxÂF©}","@@¹nvÞs©m","@@rQgYIh","@@bi«ZX","@@p[}ILd","@@À¿|","@@¹dnb","@@rS}[Kl","@@g~h}","@@FlCk","@@ůTG°ĄLHm°UF","@@OdRe","@@v[u\\","@@FjâL~wyoo~sµLZ","@@¬e¹aH","@@\\nÔ¡q]L³ë\\ÿ®QÌ","@@ÊA­©]ª","@@Kxv{­","@@@hlIk_","@@pWcrxp","@@Md|_iA","@@¢X£½z\\ðpN","@@hlÜ[LykAvyfw^E ","@@fp¤MusH","@@®_ma~LÁ¬`","@@@°¡mÛGĕ¨§Ianá[ýƤjfæÐNäGp","@@iMt\\","@@Zc[b","@@X®±GrÆ°Zæĉm","@@Z~dOSo|A¿qZv","@@@`EN£p","@@|s","@@@nDi","@@na£¾uYL¯QªmĉÅdMgÇjcº«ę¬­K­´B«Âącoċ\\xK`cįŧ«®á[~ıxu·ÅKsËÉc¢Ù\\ĭƛëbf¹­ģSĜkáƉÔ­ĈZB{aMµfzŉfÓÔŹŁƋǝÊĉ{ğč±g³ne{ç­ií´S¬\\ßðK¦w\\iqªĭiAuA­µ_W¥ƣO\\lċĢttC¨£t`PZäuXßBsĻyekOđġĵHuXBµ]×­­\\°®¬F¢¾pµ¼kŘó¬Wät¸|@L¨¸µrºù³Ù~§WIZW®±Ð¨ÒÉx`²pĜrOògtÁZ{üÙ[|ûKwsPlU[}¦Rvn`hsª^nQ´ĘRWb_ rtČFIÖkĦPJ¶ÖÀÖJĈĄTĚòC ²@PúØz©Pî¢£CÈÚĒ±hŖl¬â~nm¨f©iļ«mntqÒTÜÄjL®EÌFª²iÊxØ¨IÈhhst[Ôx}dtüGæţŔïĬaĸpMËÐjē¢·ðĄÆMzjWKĎ¢Q¶À_ê_@ıi«pZgf¤Nrq]§ĂN®«H±yƳí¾×ŊďŀĐÏŴǝĂíÀBŖÕªÁŐTFqĉ¯³ËCĕģi¨hÜ·ñt»¯Ï","@@ºwZRkĕWK "]],encodeOffsets:[[[125785,31436],[125729,31431],[125513,31380],[125329,30690],[125223,30438],[125115,30114],[124815,29155],[124419,28746],[124095,28635],[124005,28609],[125e3,30713],[125111,30698],[125078,30682],[125150,30684],[124014,28103],[125008,31331],[125411,31468],[125329,31479],[125369,31139],[125626,30916],[125417,30956],[125254,30976],[125199,30997],[125095,31058],[125083,30915],[124885,31015],[125218,30798],[124867,30838],[124755,30788],[124802,30809],[125267,30657],[125218,30578],[125200,30562],[125192,30787],[124968,30474],[125167,30396],[125115,30363],[124955,29879],[124714,29781],[124762,29462],[124325,28754],[124863,30077],[125366,31477]]]},properties:{cp:[120.153576,30.287459],name:"浙江",childNum:43}},{id:"340000",geometry:{type:"MultiPolygon",coordinates:[["@@^iuLV\\","@@e©Edh","@@´CE¶zAXêeödK¡~H¸íæAȽd{ďÅÀ½W®£ChÃsikkly]_teu[bFaTign{]GqªoĈMYá|·¥f¥őaSÕėNµñĞ«Im_m¿Âa]uĜp Z_§{Cäg¤°r[_YjÆOdý[I[á·¥Q_nùgL¾mzˆDÜÆ¶ĊJhpc¹O]iŠ]¥ jtsggDÑ¡w×jÉ©±EFË­KiÛÃÕYvsm¬njĻª§emná}k«ŕgđ²ÙDÇ¤í¡ªOy×Où±@DñSęćăÕIÕ¿IµĥOlJÕÍRÍ|JìĻÒåyķrĕq§ÄĩsWÆßF¶X®¿mwRIÞfßoG³¾©uyHį{Ɓħ¯AFnuPÍÔzVdàôº^Ðæd´oG¤{S¬ćxã}ŧ×Kǥĩ«ÕOEÐ·ÖdÖsƘÑ¨[Û^Xr¢¼§xvÄÆµ`K§ tÒ´Cvlo¸fzŨð¾NY´ı~ÉĔēßúLÃÃ_ÈÏ|]ÂÏHlg`ben¾¢pUh~ƴĖ¶_r sĄ~cƈ]|r c~`¼{À{ȒiJjz`îÀT¥Û³]u}fïQl{skloNdjäËzDvčoQďHI¦rbrHĖ~BmlNRaĥTX\\{fÁKÁ®TLÂÄMtÊgĀDĄXƔvDcÎJbt[¤D@®hh~kt°ǾzÖ@¾ªdbYhüóV´ŮŒ¨Üc±r@J|àuYÇÔG·ĚąĐlŪÚpSJ¨ĸLvÞcPæķŨ®mÐálsgd×mQ¨ųÆ©Þ¤IÎs°KZpĄ|XwWdĎµmkǀwÌÕæhºgBĝâqÙĊzÖgņtÀÁĂÆáhEz|WzqD¹°Eŧl{ævÜcA`¤C`|´qxĲkq^³³GšµbíZ¹qpa±ď OH¦Ħx¢gPícOl_iCveaOjChß¸iÝbÛªCC¿mRV§¢A|tbkĜEÀtîm^g´fÄ"]],encodeOffsets:[[[121722,32278],[119475,30423],[121606,33646]]]},properties:{cp:[117.283042,31.86119],name:"安徽",childNum:3}},{id:"350000",geometry:{type:"MultiPolygon",coordinates:[["@@zht´}[","@@aj^~ĆGå","@@edHse","@@@vPGsyQ","@@sBzddW[O","@@S¨Qy","@@NVucW","@@qptB@q","@@¸[iu","@@Q\\pD[_","@@jSwUappI","@@eXª~","@@AjvFoo","@@fT_Çí\\v|ba¦jZÆy|®","@@IjLg","@@wJIx«¼AoNe{M¥","@@K±¡ÓČ~N¾","@@k¡¹Eh~c®uDqZì¡I~Māe£bN¨gZý¡a±Öcp©PhI¢QqÇGj|¥U g[Ky¬ŏv@OptÉEF\\@ åA¬V{XģĐBycpě¼³Ăp·¤¥ohqqÚ¡ŅLs^Ã¡§qlÀhH¨MCe»åÇGD¥zPO£čÙkJA¼ßėuĕeûÒiÁŧS[¡Uûŗ½ùěcÝ§SùĩąSWó«íęACµeRåǃRCÒÇZÍ¢ź±^dlstjD¸ZpuÔâÃH¾oLUêÃÔjjēò´ĄWƛ^Ñ¥Ħ@ÇòmOw¡õyJyD}¢ďÑÈġfZda©º²z£NjD°Ötj¶¬ZSÎ~¾c°¶ÐmxO¸¢Pl´SL|¥AȪĖMņĲg®áIJČĒü` QF¬h|ĂJ@zµ |ê³È ¸UÖŬŬÀCtrĸr]ðM¤ĶĲHtÏ AĬkvsq^aÎbvdfÊòSD´Z^xPsĂrvƞŀjJd×ŘÉ ®AÎ¦ĤdxĆqAZRÀMźnĊ»İÐZ YXæJyĊ²·¶q§·K@·{sXãô«lŗ¶»o½E¡­«¢±¨Y®Ø¶^AvWĶGĒĢPlzfļtàAvWYãO_¤sD§ssČġ[kƤPX¦`¶®BBvĪjv©jx[L¥àï[F¼ÍË»ğV`«Ip}ccÅĥZEãoP´B@D¸m±z«Ƴ¿å³BRØ¶Wlâþäą`]Z£Tc ĹGµ¶Hm@_©k¾xĨôȉðX«½đCIbćqK³ÁÄš¬OAwã»aLŉËĥW[ÂGIÂNxĳ¤D¢îĎÎB§°_JGs¥E@¤ućPåcuMuw¢BI¿]zG¹guĮI"]],encodeOffsets:[[[123250,27563],[122541,27268],[123020,27189],[122916,27125],[122887,26845],[122808,26762],[122568,25912],[122778,26197],[122515,26757],[122816,26587],[123388,27005],[122450,26243],[122578,25962],[121255,25103],[120987,24903],[122339,25802],[121042,25093],[122439,26024]]]},properties:{cp:[119.306239,26.075302],name:"福建",childNum:18}},{id:"360000",geometry:{type:"Polygon",coordinates:["@@ÖP¬ǦĪØLŨä~Ĉw«|TH£pc³Ïå¹]ĉđxe{ÎÓvOEm°BƂĨİ|Gvz½ª´HàpeJÝQxnÀW­EµàXÅĪt¨ÃĖrÄwÀFÎ|Ă¡WÕ¸cf¥XaęST±m[r«_gmQu~¥V\\OkxtL E¢Ú^~ýØkbēqoě±_Êw§Ñ²ÏƟė¼mĉŹ¿NQYBąrwģcÍ¥B­ŗÊcØiIƝĿuqtāwO]³YCñTeÉcaubÍ]trluīBÐGsĵıN£ï^ķqsq¿DūūVÕ·´Ç{éĈýÿOER_đûIċâJh­ŅıNȩĕB¦K{Tk³¡OP·wnµÏd¯}½TÍ«YiµÕsC¯iM¤­¦¯P|ÿUHvhe¥oFTuõ\\OSsMòđƇiaºćXĊĵà·çhƃ÷Ç{ígu^đgm[ÙxiIN¶Õ»lđÕwZSÆv©_ÈëJbVkĔVÀ¤P¾ºÈMÖxlò~ªÚàGĂ¢B±ÌKyñ`w²¹·`gsÙfIěxŕeykpudjuTfb·hh¿Jd[\\LáƔĨƐAĈepÀÂMD~ņªe^\\^§ý©j×cZØ¨zdÒa¶lÒJìõ`oz÷@¤uŞ¸´ôęöY¼HČƶajlÞƩ¥éZ[|h}^U  ¥pĄžƦO lt¸Æ Q\\aÆ|CnÂOjt­ĚĤdÈF`¶@Ðë ¦ōÒ¨SêvHĢÛ@[ÆQoxHW[ŰîÀt¦Ǆ~NĠ¢lĄtZoCƞÔºCxrpČNpj¢{f_Y`_eq®Aot`@oDXfkp¨|s¬\\DÄSfè©Hn¬^DhÆyøJhØxĢĀLÊƠPżċĄwĮ¶"],encodeOffsets:[[118923,30536]]},properties:{cp:[115.892151,28.676493],name:"江西",childNum:1}},{id:"370000",geometry:{type:"MultiPolygon",coordinates:[["@@Xjd]mE","@@itnq","@@Dl@k","@@TGw","@@K¬U","@@Wd`c","@@PtMs","@@LnXlc","@@ppVu]Qn","@@cdzAU_","@@udRhnCE","@@oIpP","@@M{ĿčwbxƨîKÎMĮ]ZF½Y]â£ph¶¨râøÀÎǨ¤^ºÄGz~grĚĜlĞÆLĆǆ¢Îo¦cvKbgr°WhmZp L]LºcUÆ­nżĤÌĒbAnrOA´ȊcÀbƦUØrĆUÜøĬƞŶǬĴóò_A̈«ªdÎÉnb²ĦhņBĖįĦåXćì@L¯´ywƕCéÃµė ƿ¸lµZæyj|BíÂKNNnoƈfÈMZwnŐNàúÄsTJULîVjǎ¾ĒØDz²XPn±ŴPè¸ŔLƔÜƺ_TüÃĤBBċÈöA´faM¨{«M`¶d¡ôÖ°mȰBÔjj´PM|c^d¤u¤Û´ä«ƢfPk¶Môl]Lb}su^ke{lCMrDÇ­]NÑFsmoõľHyGă{{çrnÓEƕZGª¹Fj¢ÿ©}ÌCǷë¡ąuhÛ¡^KxC`C\\bÅxì²ĝÝ¿_NīCȽĿåB¥¢·IŖÕy\\¹kxÃ£ČáKµË¤ÁçFQ¡KtŵƋ]CgÏAùSedcÚźuYfyMmhUWpSyGwMPqŀÁ¼zK¶G­Y§Ë@´śÇµƕBm@IogZ¯uTMx}CVKï{éƵP_K«pÛÙqċtkkù]gTğwoɁsMõ³ăAN£MRkmEÊčÛbMjÝGuIZGPģãħE[iµBEuDPÔ~ª¼ęt]ûG§¡QMsğNPŏįzs£Ug{đJĿļā³]ç«Qr~¥CƎÑ^n¶ÆéÎR~Ż¸YI] PumŝrƿIā[xeÇ³L¯v¯s¬ÁY~}ťuŁgƋpÝĄ_ņī¶ÏSR´ÁP~¿Cyċßdwk´SsX|t`Ä ÈðAªìÎT°¦Dda^lĎDĶÚY°`ĪŴǒàŠv\\ebZHŖR¬ŢƱùęOÑM­³FÛaj"]],encodeOffsets:[[[123806,39303],[123821,39266],[123742,39256],[123702,39203],[123649,39066],[123847,38933],[123580,38839],[123894,37288],[123043,36624],[123344,38676],[123522,38857],[123628,38858],[118267,36772]]]},properties:{cp:[117.000923,36.675807],name:"山东",childNum:13}},{id:"410000",geometry:{type:"MultiPolygon",coordinates:[["@@dXD}~Hgq~ÔN~zkĘHVsǲßjŬŢ`Pûàl¢\\ÀEhİgÞē X¼`khÍLùµP³swIÓzeŠĠð´E®ÚPtºIŊÊºL«šŕQGYfa[şußǑĩų_Z¯ĵÙčC]kbc¥CS¯ëÍB©ïÇÃ_{sWTt³xlàcČzÀD}ÂOQ³ÐTĬµƑÐ¿ŸghłŦv~}ÂZ«¤lPÇ£ªÝŴÅR§ØnhctâknÏ­ľŹUÓÝdKuķI§oTũÙďkęĆH¸Ó\\Ä¿PcnS{wBIvÉĽ[GqµuŇôYgûZca©@½Õǽys¯}lgg@­C\\£asIdÍuCQñ[L±ęk·ţb¨©kK»KC²òGKmĨS`UQnk}AGēsqaJ¥ĐGRĎpCuÌy ã iMcplk|tRkðev~^´¦ÜSí¿_iyjI|ȑ|¿_»d}q^{Ƈdă}tqµ`ŷé£©V¡om½ZÙÏÁRD|JOÈpÀRsI{ùÓjuµ{t}uËRivGçJFjµåkWê´MÂHewixGw½Yŷpµú³XU½ġyłåkÚwZX·l¢Á¢KzOÎÎjc¼htoDHr|­J½}JZ_¯iPq{tę½ĕ¦Zpĵø«kQĹ¤]MÛfaQpě±ǽ¾]u­Fu÷nčÄ¯ADp}AjmcEÇaª³o³ÆÍSƇĈÙDIzçñİ^KNiÞñ[aA²zzÌ÷D|[íÄ³gfÕÞd®|`Ć~oĠƑô³ŊD×°¯CsøÂ«ìUMhTº¨¸ǝêWÔDruÂÇZ£ĆPZW~ØØv¬gèÂÒw¦X¤Ā´oŬ¬²Ês~]®tªapŎJ¨Öº_ŔfŐ\\Đ\\Ĝu~m²Ƹ¸fWĦrƔ}Î^gjdfÔ¡J}\\n C¦þWxªJRÔŠu¬ĨĨmFdM{\\d\\YÊ¢ú@@¦ª²SÜsC}fNècbpRmlØ^gd¢aÒ¢CZZxvÆ¶N¿¢T@uC¬^ĊðÄn|lIlXhun[","@@hzUq"]],
encodeOffsets:[[[116744,37216],[116480,33048]]]},properties:{cp:[113.665412,34.757975],name:"河南",childNum:2}},{id:"420000",geometry:{type:"MultiPolygon",coordinates:[["@@ASd","@@ls{d","@@¾«}{ra®pîÃ\\{øCËyyB±b\\òÝjKL ]ĎĽÌJyÚCƈćÎT´Å´pb©ÈdFin~BCo°BĎÃømv®E^vǾ½Ĝ²RobÜeN^ĺ£R¬lĶ÷YoĖ¥Ě¾|sOr°jY`~I¾®I{GqpCgyl{£ÍÍyPLÂ¡¡¸kWxYlÙæŁĢz¾V´W¶ùŸo¾ZHxjwfxGNÁ³Xéæl¶EièIH ujÌQ~v|sv¶Ôi|ú¢FhQsğ¦SiŠBgÐE^ÁÐ{čnOÂÈUÎóĔÊēĲ}Z³½Mŧïeyp·uk³DsÑ¨L¶_ÅuÃ¨w»¡WqÜ]\\Ò§tƗcÕ¸ÕFÏǝĉăxŻČƟOKÉġÿ×wg÷IÅzCg]m«ªGeçÃTC«[t§{loWeC@ps_Bp­rf_``Z|ei¡oċMqow¹DƝÓDYpûsYkıǃ}s¥ç³[§cY§HK«Qy]¢wwö¸ïx¼ņ¾Xv®ÇÀµRĠÐHM±cÏdƒǍũȅȷ±DSyúĝ£ŤĀàtÖÿï[îb\\}pĭÉI±Ñy¿³x¯No|¹HÏÛmjúË~TuęjCöAwě¬Rđl¯ Ñb­ŇTĿ_[IčĄʿnM¦ğ\\É[T·k¹©oĕ@A¾wya¥Y\\¥Âaz¯ãÁ¡k¥ne£ÛwE©Êō¶˓uoj_U¡cF¹­[WvP©whuÕyBF`RqJUw\\i¡{jEPïÿ½fćQÑÀQ{°fLÔ~wXgītêÝ¾ĺHd³fJd]HJ²EoU¥HhwQsƐ»Xmg±çve]DmÍPoCc¾_hhøYrŊU¶eD°Č_N~øĹĚ·`z]Äþp¼äÌQv\\rCé¾TnkžŐÚÜa¼ÝƆĢ¶ÛodĔňÐ¢JqPb ¾|J¾fXƐîĨ_Z¯À}úƲN_ĒÄ^ĈaŐyp»CÇÄKñL³ġM²wrIÒŭxjb[n«øæà ^²­h¯ÚŐªÞ¸Y²ĒVø}Ā^İ´LÚm¥ÀJÞ{JVųÞŃx×sxxƈē ģMřÚðòIfĊŒ\\Ʈ±ŒdÊ§ĘDvČ_Àæ~Dċ´A®µ¨ØLV¦êHÒ¤"]],encodeOffsets:[[[113712,34e3],[115612,30507],[113649,34054]]]},properties:{cp:[114.298572,30.584355],name:"湖北",childNum:3}},{id:"430000",geometry:{type:"MultiPolygon",coordinates:[["@@nFZw","@@ãÆá½ÔXrCOËRïÿĩ­TooQyÓ[ŅBE¬ÎÓXaį§Ã¸G °ITxpúxÚĳ¥ÏĢ¾edÄ©ĸGàGhM¤Â_U}Ċ}¢pczfþg¤ÇôAV","@@ȴÚĖÁĐiOĜ«BxDõĚivSÌ}iùÜnÐºG{p°M°yÂÒzJ²Ì ÂcXëöüiáÿñőĞ¤ùTz²CȆȸǎŪƑÐc°dPÎğË¶[È½u¯½WM¡­ÉB·rínZÒ `¨GA¾\\pēXhÃRC­üWGġuTé§ŎÑ©êLM³}_EÇģc®ęisÁPDmÅ{b[RÅs·kPŽƥóRoOV~]{g\\êYƪ¦kÝbiċƵGZ»Ěõó·³vŝ£ø@pyö_ëIkÑµbcÑ§y×dYØªiþUjŅ³C}ÁN»hĻħƏâƓKA·³CQ±µ§¿AUƑ¹AtćOwD]JUÖgk¯b£ylZFËÑ±H­}EbóľA¡»Ku¦·³åş¥ùBD^{ÌC´­¦ŷJ£^[ª¿ğ|ƅN skóā¹¿ï]ă~÷O§­@Vm¡Qđ¦¢Ĥ{ºjÔª¥nf´~Õo×ÛąGû¥cÑ[Z¶ŨĪ²SÊǔƐƀAÚŌ¦QØ¼rŭ­«}NÏürÊ¬mjr@ĘrTW ­SsdHzƓ^ÇÂyUi¯DÅYlŹu{hT}mĉ¹¥ěDÿë©ıÓ[Oº£¥ótł¹MÕƪ`PDiÛU¾ÅâìUñBÈ£ýhedy¡oċ`pfmjP~kZaZsÐd°wj§@Ĵ®w~^kÀÅKvNmX\\¨aŃqvíó¿F¤¡@ũÑVw}S@j}¾«pĂrªg àÀ²NJ¶¶DôK|^ª°LX¾ŴäPĪ±£EXd^¶ĲÞÜ~u¸ǔMRhsRe`ÄofIÔ\\Ø  ićymnú¨cj ¢»GČìƊÿÐ¨XeĈĀ¾Oð Fi ¢|[jVxrIQ_EzAN¦zLU`cªxOTu RLÄªpUĪȴ^ŎµªÉFxÜf¤ºgĲèy°Áb[¦Zb¦z½xBĖ@ªpºjS´rVźOd©ʪiĎăJP`"]],encodeOffsets:[[[115640,30489],[112577,27316],[114113,30649]]]},properties:{cp:[112.982279,28.19409],name:"湖南",childNum:3}},{id:"440000",geometry:{type:"MultiPolygon",coordinates:[["@@QdAsa","@@lxDRm","@@sbhNLo","@@Ă ý","@@WltOY[","@@Kr]S","@@e~AS}","@@I|Mym","@@Û³LS²Q","@@nvºBë¥cÕº","@@zdÛJm","@@°³","@@a yAª¸ËJIxØ@ĀHÉÕZofoo","@@sŗÃÔėAƁZÄ ~°ČPºb","@@¶ÝÌvmĞh¹Ĺ","@@HdSjĒ¢D}waru«ZqadY{K","@@el\\LqqO","@@~rMmX","@@f^E","@@øPªoj÷ÍÝħXČx°Q¨ıXJp","@@gÇƳmxatfu","@@EÆC½","@@¸B_¶ekWvSivc}p}Ăº¾NĎyj¦Èm th_®Ä}»âUzLË²Aā¡ßH©Ùñ}wkNÕ¹ÇO½¿£ēUlaUìIÇª`uTÅxYĒÖ¼kÖµMjJÚwn\\hĒv]îh|ÈƄøèg¸Ķß ĉĈWb¹ƀdéĘNTtP[öSvrCZaGubo´ŖÒÇĐ~¡zCIözx¢PnÈñ @ĥÒ¦]ƜX³ăĔñiiÄÓVépKG½ÄÓávYoC·sitiaÀyŧÎ¡ÈYDÑům}ý|m[węõĉZÅxUO}÷N¹³ĉo_qtăqwµŁYÙǝŕ¹tïÛUÃ¯mRCºĭ|µÕÊK½Rē ó]GªęAxNqSF|ām¡diď×YïYWªŉOeÚtĐ«zđ¹TāúEáÎÁWwíHcòßÎſ¿Çdğ·ùT×Çūʄ¡XgWÀǇğ·¿ÃOj YÇ÷Sğ³kzőõmĝ[³¡VÙæÅöMÌ³¹pÁaËýý©D©ÜJŹƕģGą¤{ÙūÇO²«BƱéAÒĥ¡«BhlmtÃPµyU¯ucd·w_bŝcīímGOGBȅŹãĻFŷŽŕ@Óoo¿ē±ß}}ÓF÷tĲWÈCőâUâǙIğŉ©IĳE×Á³AĥDĈ±ÌÜÓĨ£L]ĈÙƺZǾĆĖMĸĤfÎĵlŨnÈĐtFFĤêk¶^k°f¶g}®Faf`vXŲxl¦ÔÁ²¬Ð¦pqÊÌ²iXØRDÎ}Ä@ZĠsx®AR~®ETtĄZƈfŠŠHâÒÐAµ\\S¸^wĖkRzalŜ|E¨ÈNĀňZTpBh£\\ĎƀuXĖtKL¶G|»ĺEļĞ~ÜĢÛĊrOÙîvd]n¬VÊĜ°RÖpMƀ¬HbwEÀ©\\¤]ŸI®¥D³|Ë]CúAŠ¦æ´¥¸Lv¼¢ĽBaôF~®²GÌÒEYzk¤°ahlVÕI^CxĈPsBƒºVÀB¶¨R²´D","@@OR"]],encodeOffsets:[[[117381,22988],[116552,22934],[116790,22617],[116973,22545],[116444,22536],[116931,22515],[116496,22490],[116453,22449],[113301,21439],[118726,21604],[118709,21486],[113210,20816],[115482,22082],[113171,21585],[113199,21590],[115232,22102],[115739,22373],[115134,22184],[113056,21175],[119573,21271],[119957,24020],[115859,22356],[116680,26053],[116561,22649]]]},properties:{cp:[113.280637,23.125178],name:"广东",childNum:24}},{id:"450000",geometry:{type:"MultiPolygon",coordinates:[["@@H TI¡U","@@Ɣ_LÊFZgčP­kini«qÇczÍY®¬Ů»qR×ō©DÕ§ƙǃŵTÉĩ±ıdÑnYYĲvNĆĆØÜ Öp}e³¦m©iÓ|¹ħņ|ª¦QF¢Â¬ʖovg¿em^ucäāmÇÖåB¡Õçĝ}FĻ¼Ĺ{µHKsLSđƃrč¤[AgoSŇYMÿ§Ç{FśbkylQxĕ]T·¶[BÑÏGáşşƇeăYSs­FQ}­BwtYğÃ@~CÍQ ×WjË±rÉ¥oÏ ±«ÓÂ¥kwWűue_b­E~µh¯ecl¯Ïr¯EģJğ}w³Ƈē`ãògK_ÛsUʝćğ¶höO¤Ǜn³c`¡yię[ďĵűMę§]XÎ_íÛ]éÛUćİÕBƣ±dy¹T^dûÅÑŦ·PĻþÙ`K¦¢ÍeĥR¿³£[~äu¼dltW¸oRM¢ď\\z}Æzdvň{ÎXF¶°Â_ÒÂÏL©ÖTmu¼ãlīkiqéfA·Êµ\\őDc¥ÝFyÔćcűH_hLÜêĺĐ¨c}rn`½Ì@¸¶ªVLhŒ\\Ţĺk~Ġið°|gtTĭĸ^xvKVGréAébUuMJVÃO¡qĂXËSģãlýà_juYÛÒBG^éÖ¶§EGÅzěƯ¤EkN[kdåucé¬dnYpAyČ{`]þ±X\\ÞÈk¡ĬjàhÂƄ¢Hè ŔâªLĒ^Öm¶ħĊAǦė¸zÚGn£¾rªŀÜt¬@ÖÚSx~øOŒŶÐÂæȠ\\ÈÜObĖw^oÞLf¬°bI lTØBÌF£Ć¹gñĤaYt¿¤VSñK¸¤nM¼JE±½¸ñoÜCƆæĪ^ĚQÖ¦^f´QüÜÊz¯lzUĺš@ìp¶n]sxtx¶@~ÒĂJb©gk{°~c°`Ô¬rV\\la¼¤ôá`¯¹LCÆbxEræOv[H­[~|aB£ÖsºdAĐzNÂðsÞÆĤªbab`ho¡³F«èVZs\\\\ÔRzpp®SĪº¨ÖºNĳd`a¦¤F³¢@`¢ĨĀìhYvlĆº¦Ċ~nS|gźv^kGÆÀè·"]],encodeOffsets:[[[111707,21520],[113706,26955]]]},properties:{cp:[108.320004,22.82402],name:"广西",childNum:2}},{id:"460000",geometry:{type:"Polygon",coordinates:["@@¦Ŝil¢XƦƞòïè§ŞCêɕrŧůÇąĻõ·ĉ³œ̅kÇm@ċȧŧĥĽʉ­ƅſȓÒË¦ŝE}ºƑ[ÍĜȋ gÎfǐÏĤ¨êƺ\\Ɔ¸ĠĎvʄȀÐ¾jNðĀÒRZǆzÐĊ¢DÀɘZ"],encodeOffsets:[[112750,20508]]},properties:{cp:[110.33119,20.031971],name:"海南",childNum:1}},{id:"510000",geometry:{type:"MultiPolygon",coordinates:[["@@LqSn","@@ĆOìÛÐ@ĞǔNY{¤Á§di´ezÝúØãwIþËQÇ¦ÃqÉSJ»ĂéʔõÔƁİlƞ¹§ĬqtÀƄmÀêErĒtD®ċæcQE®³^ĭ¥©l}äQtoŖÜqÆkµªÔĻĴ¡@Ċ°B²Èw^^RsºTĀ£ŚæQPJvÄz^Đ¹Æ¯fLà´GC²dt­ĀRt¼¤ĦOðğfÔðDŨŁĞƘïPÈ®âbMüÀXZ ¸£@Å»»QÉ­]dsÖ×_Í_ÌêŮPrĔĐÕGĂeZÜîĘqBhtO ¤tE[h|YÔZśÎs´xº±Uñt|OĩĠºNbgþJy^dÂY Į]Řz¦gC³R`Āz¢Aj¸CL¤RÆ»@­Ŏk\\Ç´£YW}z@Z}Ã¶oû¶]´^NÒ}èNªPÍy¹`S°´ATeVamdUĐwʄvĮÕ\\uÆŗ¨Yp¹àZÂmWh{á}WØǍÉüwga§ßAYrÅÂQĀÕ¬LŐý®Xøxª½Ű¦¦[þ`ÜUÖ´òrÙŠ°²ÄkĳnDX{U~ET{ļº¦PZcjF²Ė@pg¨B{u¨ŦyhoÚD®¯¢ WòàFÎ¤¨GDäz¦kŮPġqË¥À]eâÚ´ªKxīPÖ|æ[xÃ¤JÞĥsNÖ½I¬nĨY´®ÐƐmDŝuäđđEbee_v¡}ìęǊē}qÉåT¯µRs¡M@}ůaa­¯wvƉåZw\\Z{åû`[±oiJDÅ¦]ĕãïrG réÏ·~ąSfy×Í·ºſƽĵȁŗūmHQ¡Y¡®ÁÃ×t«­T¤JJJyJÈ`Ohß¦¡uËhIyCjmÿwZGTiSsOB²fNmsPa{M{õE^Hj}gYpaeu¯oáwHjÁ½M¡pMuåmni{fk\\oÎqCwEZ¼KĝAy{m÷LwO×SimRI¯rKõBS«sFe]fµ¢óY_ÆPRcue°Cbo×bd£ŌIHgtrnyPt¦foaXďxlBowz_{ÊéWiêEGhÜ¸ºuFĈIxf®Y½ĀǙ]¤EyF²ċw¸¿@g¢§RGv»áW`ÃĵJwi]t¥wO­½a[×]`Ãi­üL¦LabbTÀåc}ÍhÆh®BHî|îºÉk­¤Sy£ia©taį·Ɖ`ō¥UhOĝLk}©Fos´JmµlŁuønÑJWÎªYÀïAetTŅÓGË«bo{ıwodƟ½OġÜÂµxàNÖ¾P²§HKv¾]|BÆåoZ`¡Ø`ÀmºĠ~ÌÐ§nÇ¿¤]wğ@srğu~Io[é±¹ ¿ſđÓ@qg¹zƱřaí°KtÇ¤V»Ã[ĩǭƑ^ÇÓ@áťsZÏÅĭƋěpwDóÖáŻneQËq·GCœýS]x·ýq³OÕ¶Qzßti{řáÍÇWŝŭñzÇWpç¿JXĩè½cFÂLiVjx}\\NŇĖ¥GeJA¼ÄHfÈu~¸Æ«dE³ÉMA|bÒćhG¬CMõƤąAvüVéŀ_VÌ³ĐwQj´·ZeÈÁ¨X´Æ¡Qu·»ÕZ³ġqDoy`L¬gdp°şp¦ėìÅĮZ°Iähzĵf²å ĚÑKpIN|Ñz]ń·FU×é»R³MÉ»GM«kiér}Ã`¹ăÞmÈnÁîRǀ³ĜoİzŔwǶVÚ£À]ɜ»ĆlƂ²ĠþTº·àUȞÏʦ¶I«dĽĢdĬ¿»Ĕ×h\\c¬ä²GêëĤł¥ÀǿżÃÆMº}BÕĢyFVvwxBèĻĒ©Ĉt@Ğû¸£B¯¨ˋäßkķ½ªôNÔ~t¼Ŵu^s¼{TA¼ø°¢İªDè¾Ň¶ÝJ®Z´ğ~Sn|ªWÚ©òzPOȸbð¢|øĞA"]],encodeOffsets:[[[108815,30935],[100197,35028]]]},properties:{cp:[104.065735,30.659462],name:"四川",childNum:2}},{id:"520000",geometry:{type:"MultiPolygon",coordinates:[["@@G\\lY£cj","@@q|mc¯vÏV","@@hÑ£IsNgßHHªķÃh_¹¡ĝÄ§ń¦uÙùgS¯JH|sÝÅtÁïyMDč»eÕtA¤{b\\}G®u\\åPFqwÅaDK°ºâ_£ùbµmÁÛĹM[q|hlaªāI}Ñµ@swtwm^oµDéĽŠyVky°ÉûÛR³e¥]RÕěħ[ƅåÛDpJiVÂF²I»mN·£LbÒYbWsÀbpkiTZĄă¶Hq`ĥ_J¯ae«KpÝx]aĕÛPÇȟ[ÁåŵÏő÷Pw}TÙ@Õs«ĿÛq©½m¤ÙH·yǥĘĉBµĨÕnđ]K©œáGçş§ÕßgǗĦTèƤƺ{¶ÉHÎd¾ŚÊ·OÐjXWrãLyzÉAL¾ę¢bĶėy_qMĔąro¼hĊw¶øV¤w²Ĉ]ÊKx|`ź¦ÂÈdrcÈbe¸`I¼čTF´¼Óýȃr¹ÍJ©k_șl³´_pĐ`oÒh¶pa^ÓĔ}D»^Xy`d[KvJPhèhCrĂĚÂ^Êƌ wZL­Ġ£ÁbrzOIlMMĪŐžËr×ÎeŦtw|¢mKjSǘňĂStÎŦEtqFT¾Eì¬¬ôxÌO¢ K³ŀºäYPVgŎ¦ŊmŞ¼VZwVlz¤£Tl®ctĽÚó{G­AÇge~Îd¿æaSba¥KKûj®_Ä^\\Ø¾bP®¦x^sxjĶI_Ä Xâ¼Hu¨Qh¡À@Ëô}±GNìĎlT¸`V~R°tbÕĊ`¸úÛtÏFDu[MfqGH·¥yAztMFe|R_GkChZeÚ°tov`xbDnÐ{E}ZèxNEÞREn[Pv@{~rĆAB§EO¿|UZ~ìUf¨J²ĂÝÆsªB`s¶fvö¦Õ~dÔq¨¸º»uù[[§´sb¤¢zþF¢ÆÀhÂW\\ıËIÝo±ĭŠ£þÊs}¡R]ěDg´VG¢j±®èºÃmpU[Áëº°rÜbNu¸}º¼`niºÔXĄ¤¼ÔdaµÁ_ÃftQQgR·Ǔv}Ý×ĵ]µWc¤F²OĩųãW½¯K©]{LóµCIµ±Mß¿h©āq¬o½~@i~TUxð´Đhw­ÀEîôuĶb[§nWuMÆJl½]vuıµb"]],encodeOffsets:[[[112158,27383],[112105,27474],[112095,27476]]]},properties:{cp:[106.713478,26.578343],name:"贵州",childNum:3}},{id:"530000",geometry:{type:"Polygon",coordinates:["@@[ùx½}ÑRHYīĺûsÍniEoã½Ya²ė{c¬ĝgĂsAØÅwďõzFjw}«Dx¿}Uũlê@HÅ­F¨ÇoJ´Ónũuą¡Ã¢pÒÅØ TF²xa²ËXcÊlHîAßËŁkŻƑŷÉ©hW­æßUËs¡¦}teèÆ¶StÇÇ}Fd£jĈZĆÆ¤Tč\\D}O÷£U§~ŃGåŃDĝ¸Tsd¶¶Bª¤u¢ŌĎo~t¾ÍŶÒtD¦ÚiôözØX²ghįh½Û±¯ÿm·zR¦Ɵ`ªŊÃh¢rOÔ´£Ym¼èêf¯ŪĽncÚbw\\zlvWªâ ¦gmĿBĹ£¢ƹřbĥkǫßeeZkÙIKueT»sVesbaĕ  ¶®dNĄÄpªy¼³BE®lGŭCǶwêżĔÂepÍÀQƞpC¼ŲÈ­AÎô¶RäQ^Øu¬°_Èôc´¹ò¨PÎ¢hlĎ¦´ĦÆ´sâÇŲPnÊD^¯°Upv}®BPÌªjǬxSöwlfòªvqĸ|`H­viļndĜ­Ćhňem·FyÞqóSį¯³X_ĞçêtryvL¤§z¦c¦¥jnŞklD¤øz½ĜàĂŧMÅ|áƆàÊcðÂFÜáŢ¥\\\\ºİøÒÐJĴîD¦zK²ǏÎEh~CD­hMn^ÌöÄ©ČZÀaüfɭyœpį´ěFűk]Ôě¢qlÅĆÙa¶~ÄqêljN¬¼HÊNQ´ê¼VØ¸E^ŃÒyM{JLoÒęæe±Ķygã¯JYÆĭĘëo¥Šo¯hcK«z_prC´ĢÖY¼ v¸¢RÅW³Â§fÇ¸Yi³xR´ďUË`êĿUûuĆBƣöNDH«ĈgÑaB{ÊNF´¬c·Åv}eÇÃGB»If¦HňĕM~[iwjUÁKE¾dĪçWIèÀoÈXòyŞŮÈXâÎŚj|àsRyµÖPr´þ ¸^wþTDŔHr¸RÌmfżÕâCôoxĜƌÆĮÐYtâŦÔ@]ÈǮƒ\\Ī¼Ä£UsÈ¯LbîƲŚºyhr@ĒÔƀÀ²º\\êpJ}ĠvqtĠ@^xÀ£È¨mËÏğ}n¹_¿¢×Y_æpÅA^{½Lu¨GO±Õ½ßM¶wÁĢÛPƢ¼pcĲx|apÌ¬HÐŊSfsðBZ¿©XÏÒKk÷Eû¿SrEFsÕūkóVǥŉiTL¡n{uxţÏhôŝ¬ğōNNJkyPaqÂğ¤K®YxÉƋÁ]āęDqçgOgILu\\_gz]W¼~CÔē]bµogpÑ_oď`´³Țkl`IªºÎȄqÔþ»E³ĎSJ»_f·adÇqÇc¥Á_Źw{L^É±ćxU£µ÷xgĉp»ĆqNē`rĘzaĵĚ¡K½ÊBzyäKXqiWPÏÉ¸½řÍcÊG|µƕƣGË÷k°_^ý|_zċBZocmø¯hhcæ\\lMFlư£ĜÆyHF¨µêÕ]HAàÓ^it `þßäkĤÎT~Wlÿ¨ÔPzUCNVv [jâôDôď[}z¿msSh¯{jïğl}šĹ[őgK©U·µË@¾m_~q¡f¹ÅË^»f³ø}Q¡ÖË³gÍ±^Ç\\ëÃA_¿bWÏ[¶ƛé£F{īZgm@|kHǭƁć¦UĔť×ëǟeċ¼ȡȘÏíBÉ£āĘPªĳ¶ŉÿy©nď£G¹¡I±LÉĺÑdĉÜW¥}gÁ{aqÃ¥aıęÏZÁ`"],encodeOffsets:[[104636,22969]]},properties:{cp:[102.712251,25.040609],name:"云南",childNum:1}},{id:"540000",geometry:{type:"Polygon",coordinates:["@@ÂhľxŖxÒVºÅâAĪÝȆµę¯Ňa±r_w~uSÕňqOj]ɄQ£ZUDûoY»©M[L¼qãË{VÍçWVi]ë©Ä÷àyƛhÚU°adcQ~Mx¥caÛcSyFÖk­uRýq¿ÔµQĽ³aG{¿FµëªéĜÿª@¬·K·àariĕĀ«V»ŶĴūgèLǴŇƶaftèBŚ£^âǐÝ®M¦ÁǞÿ¬LhJ¾óƾÆºcxwf]Y´¦|QLn°adĊ\\¨oǀÍŎ´ĩĀd`tÊQŞŕ|¨C^©Ĉ¦¦ÎJĊ{ëĎjª²rÐl`¼Ą[t|¦Stè¾PÜK¸dƄı]s¤î_v¹ÎVòŦj£Əsc¬_Ğ´|Ł¦Av¦w`ăaÝaa­¢e¤ı²©ªSªÈMĄwÉØŔì@T¤Ę\\õª@þo´­xA sÂtŎKzó²ÇČµ¢r^nĊ­Æ¬×üG¢³ {âĊ]G~bÀgVjzlhǶfOfdªB]pjTOtĊn¤}®¦Č¥d¢¼»ddY¼t¢eȤJ¤}Ǿ¡°§¤AÐlc@ĝsªćļđAçwxUuzEÖġ~AN¹ÄÅȀŻ¦¿ģŁéì±Hãd«g[Ø¼ēÀcīľġ¬cJµÐʥVȝ¸ßS¹ý±ğkƁ¼ą^ɛ¤Ûÿb[}¬ōõÃ]ËNm®g@Bg}ÍF±ǐyL¥íCIĳÏ÷Ñį[¹¦[âšEÛïÁÉdƅß{âNÆāŨß¾ě÷yC£k­´ÓH@Â¹TZ¥¢į·ÌAÐ§®Zcv½Z­¹|ÅWZqgW|ieZÅYVÓqdqbc²R@c¥Rã»GeeƃīQ}J[ÒK¬Ə|oėjġĠÑN¡ð¯EBčnwôɍėª²CλŹġǝʅįĭạ̃ūȹ]ΓͧgšsgȽóϧµǛęgſ¶ҍć`ĘąŌJÞä¤rÅň¥ÖÁUětęuůÞiĊÄÀ\\Æs¦ÓRb|Â^řÌkÄŷ¶½÷f±iMÝ@ĥ°G¬ÃM¥n£Øąğ¯ß§aëbéüÑOčk£{\\eµª×MÉfm«Ƒ{Å×Gŏǩãy³©WÑăû··Qòı}¯ãIéÕÂZ¨īès¶ZÈsæĔTŘvgÌsN@îá¾ó@ÙwU±ÉTå»£TđWxq¹Zobs[×¯cĩvėŧ³BM|¹kªħ¥TzNYnÝßpęrñĠĉRS~½ěVVµõ«M££µBĉ¥áºae~³AuĐh`Ü³ç@BÛïĿa©|z²Ý¼D£àč²ŸIûI āóK¥}rÝ_Á´éMaň¨~ªSĈ½½KÙóĿeƃÆB·¬ën×W|Uº}LJrƳlŒµ`bÔ`QÐÓ@s¬ñIÍ@ûws¡åQÑßÁ`ŋĴ{ĪTÚÅTSÄ³Yo|Ç[Ç¾µMW¢ĭiÕØ¿@MhpÕ]jéò¿OƇĆƇpêĉâlØwěsǩĵ¸cbU¹ř¨WavquSMzeo_^gsÏ·¥Ó@~¯¿RiīB\\qTGªÇĜçPoÿfñòą¦óQīÈáPābß{ZŗĸIæÅhnszÁCËìñÏ·ąĚÝUm®ó­L·ăUÈíoù´Êj°ŁŤ_uµ^°ìÇ@tĶĒ¡ÆM³Ģ«İĨÅ®ğRāðggheÆ¢zÊ©Ô\\°ÝĎz~ź¤PnMĪÖB£kné§żćĆKĒ°¼L¶èâz¨u¦¥LDĘz¬ýÎmĘd¾ßFzhg²Fy¦ĝ¤ċņbÎ@yĄæm°NĮZRÖíJ²öLĸÒ¨Y®ƌÐVàtt_ÚÂyĠz]ŢhzĎ{ÂĢXc|ÐqfO¢¤ögÌHNPKŖUú´xx[xvĐCûĀìÖT¬¸^}Ìsòd´_KgžLĴÀBon|H@Êx¦BpŰŌ¿fµƌA¾zǈRx¶FkĄźRzŀ~¶[´HnªVƞuĒ­È¨ƎcƽÌm¸ÁÈM¦x͊ëÀxǆBú^´W£dkɾĬpw˂ØɦļĬIŚÊnŔa¸~J°îlɌxĤÊÈðhÌ®gT´øàCÀ^ªerrƘd¢İP|Ė ŸWªĦ^¶´ÂLaT±üWƜǀRÂŶUńĖ[QhlLüAÜ\\qRĄ©"],encodeOffsets:[[90849,37210]]},properties:{cp:[91.132212,29.660361],name:"西藏",childNum:1}},{id:"610000",geometry:{type:"Polygon",coordinates:["@@¸ÂW¢xR­Fq§uF@N¢XLRMº[ğȣſï|¥Jkc`sŉǷ£Y³WN«ùMëï³ÛIg÷±mTșÚÒķø©þ¥yÓğęmWµÎumZyOŅƟĥÓ~sÑL¤µaÅY¦ocyZ{y c]{Ta©`U_Ěē£ωÊƍKùK¶ȱÝƷ§{û»ÅÁȹÍéuĳ|¹cÑdìUYOuFÕÈYvÁCqÓTǢí§·S¹NgV¬ë÷Át°DØ¯C´ŉƒópģ}ąiEËFéGU¥×K§­¶³BČ}C¿åċ`wġB·¤őcƭ²ő[Å^axwQOñJÙïŚĤNĔwƇÄńwĪ­o[_KÓª³ÙnKÇěÿ]ďă_d©·©Ýŏ°Ù®g]±ß×¥¬÷m\\iaǑkěX{¢|ZKlçhLtŇîŵœè[É@ƉĄEtƇÏ³­ħZ«mJ×¾MtÝĦ£IwÄå\\Õ{OwĬ©LÙ³ÙTª¿^¦rÌĢŭO¥lãyC§HÍ£ßEñX¡­°ÙCgpťzb`wIvA|¥hoĕ@E±iYd¥OÿµÇvPW|mCĴŜǂÒW¶¸AĜh^Wx{@¬­F¸¡ķn£P|ªĴ@^ĠĈæbÔc¶lYi^MicĎ°Â[ävï¶gv@ÀĬ·lJ¸sn|¼u~a]ÆÈtŌºJpþ£KKf~¦UbyäIĺãnÔ¿^­ŵMThĠÜ¤ko¼Ŏìąǜh`[tRd²Ĳ_XPrɲlXiL§à¹H°Ȧqº®QCbAŌJ¸ĕÚ³ĺ§ `d¨YjiZvRĺ±öVKkjGȊÄePĞZmļKÀ[`ösìhïÎoĬdtKÞ{¬èÒÒBÔpĲÇĬJŊ¦±J«[©ārHµàåVKe§|P²ÇÓ·vUzgnN¾yI@oHĆÛķhxen¡QQ±ƝJǖRbzy¸ËÐl¼EºpĤ¼x¼½~Ğà@ÚüdK^mÌSjp²ȮµûGĦ}Ħðǚ¶òƄjɂz°{ºØkÈęâ¦jªBg\\ċ°s¬]jú EȌǆ¬stRÆdĠİwÜ¸ôW¾ƮłÒ_{Ìû¼jº¹¢GǪÒ¯ĘZ`ºŊecņą~BÂgzpâēòYƲȐĎ"],encodeOffsets:[[113634,40474]]},properties:{cp:[108.948024,34.263161],name:"陕西",childNum:1}},{id:"620000",geometry:{type:"MultiPolygon",coordinates:[["@@Vu_^","@@ųEĠtt~nkh`Q¦ÅÄÜdwAb×ĠąJ¤DüègĺqBqj°lI¡Ĩ¶ĖIHdjÎB°aZ¢KJO[|A£Dx}NĂ¬HUnrk kp¼Y kMJn[aGáÚÏ[½rc}aQxOgsPMnUsncZsKúvAtÞġ£®ĀYKdnFw¢JE°Latf`¼h¬we|Æbj}GA·~W`¢MC¤tL©Ĳ°qdfObÞĬ¹ttu`^ZúE`[@Æsîz®¡CƳƜG²R¢RmfwĸgÜą G@pzJM½mhVy¸uÈÔO±¨{LfæU¶ßGĂq\\ª¬²I¥IŉÈīoıÓÑAçÑ|«LÝcspīðÍgtë_õ\\ĉñLYnĝgRǡÁiHLlõUĹ²uQjYi§Z_c¨´ĹĖÙ·ŋIaBD­R¹ȥr¯GºßK¨jWkɱOqWĳ\\a­Q\\sg_ĆǛōëp»£lğÛgSŶN®À]ÓämĹãJaz¥V}Le¤Lýo¹IsŋÅÇ^bz³tmEÁ´a¹cčecÇNĊãÁ\\č¯dNj]jZµkÓdaćå]ğĳ@ ©O{¤ĸm¢E·®«|@Xwg]Aģ±¯XǁÑǳªcwQÚŝñsÕ³ÛV_ý¥\\ů¥©¾÷w©WÕÊĩhÿÖÁRo¸V¬âDb¨hûxÊ×ǌ~Zâg|XÁnßYoº§ZÅŘv[ĭÖʃuďxcVbnUSfB¯³_TzºÎO©çMÑ~M³]µ^püµÄY~y@X~¤Z³[Èōl@®Å¼£QK·Di¡ByÿQ_´D¥hŗy^ĭÁZ]cIzýah¹MĪğPs{ò²Vw¹t³ŜË[Ñ}X\\gsF£sPAgěp×ëfYHāďÖqēŭOÏëdLü\\it^c®RÊº¶¢H°mrY£B¹čIoľu¶uI]vģSQ{UŻÅ}QÂ|Ì°ƅ¤ĩŪU ęĄÌZÒ\\v²PĔ»ƢNHĂyAmƂwVm`]ÈbH`Ì¢²ILvĜH®¤Dlt_¢JJÄämèÔDëþgºƫaʎÌrêYi~ Îİ¤NpÀA¾Ĕ¼bð÷®üszMzÖĖQdȨýv§Tè|ªHÃ¾a¸|Ð ƒwKĢx¦ivr^ÿ ¸l öæfƟĴ·PJv}n\\h¹¶v·À|\\ƁĚN´ĜçèÁz]ġ¤²¨QÒŨTIlªťØ}¼˗ƦvÄùØEÂ«FïËIqōTvāÜŏíÛßÛVj³âwGăÂíNOPìyV³ŉĖýZso§HÑiYw[ß\\X¦¥c]ÔƩÜ·«jÐqvÁ¦m^ċ±R¦΋ƈťĚgÀ»IïĨʗƮ°ƝĻþÍAƉſ±tÍEÕÞāNUÍ¡\\ſčåÒʻĘm ƭÌŹöʥëQ¤µ­ÇcƕªoIýIÉ_mkl³ăƓ¦j¡YzŇi}Msßõīʋ }ÁVm_[n}eı­Uĥ¼ªI{Î§DÓƻėojqYhĹT©oūĶ£]ďxĩǑMĝq`B´ƃ˺Чç~²ņj@¥@đ´ί}ĥtPńÇ¾V¬ufÓÉCtÓ̻¹£G³]ƖƾŎĪŪĘ̖¨ʈĢƂlɘ۪üºňUðǜȢƢż̌ȦǼĤŊɲĖÂ­KqĘŉ¼ĔǲņɾªǀÞĈĂD½ĄĎÌŗĞrôñnN¼â¾ʄľԆ|Ǆ֦ज़ȗǉ̘̭ɺƅêgV̍ʆĠ·ÌĊv|ýĖÕWĊǎÞ´õ¼cÒÒBĢ͢UĜð͒s¨ňƃLĉÕÝ@ɛƯ÷¿Ľ­ĹeȏĳëCȚDŲyê×Ŗyò¯ļcÂßYtÁƤyAã˾J@ǝrý@¤rz¸oP¹ɐÚyáHĀ[JwcVeȴÏ»ÈĖ}ƒŰŐèȭǢόĀƪÈŶë;Ñ̆ȤМľĮEŔĹŊũ~ËUă{ĻƹɁύȩþĽvĽƓÉ@ēĽɲßǐƫʾǗĒpäWÐxnsÀ^ƆwW©¦cÅ¡Ji§vúF¶¨c~c¼īeXǚ\\đ¾JwÀďksãAfÕ¦L}waoZD½Ml«]eÒÅaÉ²áo½FõÛ]ĻÒ¡wYR£¢rvÓ®y®LFLzĈôe]gx}|KK}xklL]c¦£fRtív¦PŨ£","@@M T¥"]],encodeOffsets:[[[108619,36299],[108594,36341],[108600,36306]]]},properties:{cp:[103.823557,36.058039],name:"甘肃",childNum:3}},{id:"630000",geometry:{type:"MultiPolygon",coordinates:[["@@InJo","@@CÆ½OŃĦsΰ~Ē³¦@@Ņi±è}ШƄ˹A³r_ĞǒNĪĐw¤^ŬĵªpĺSZgrpiƼĘÔ¨C|ÍJ©Ħ»®VĲ~f\\m `UnÂ~ʌĬàöNt~ňjy¢ZiƔ¥Ąk´nl`JÊJþ©pdƖ®È£¶ìRʦźõƮËnʼėæÑƀĎ[¢VÎĂMÖÝÎF²sƊƀÎBļýƞ¯ʘƭðħ¼Jh¿ŦęΌƇ¥²Q]Č¥nuÂÏri¸¬ƪÛ^Ó¦d¥[Wàx\\ZjÒ¨GtpþYŊĕ´zUOëPîMĄÁxH´áiÜUàîÜŐĂÛSuŎrJðÌ¬EFÁú×uÃÎkrĒ{V}İ«O_ÌËĬ©ÓŧSRÑ±§Ģ£^ÂyèçěM³Ƃę{[¸¿uºµ[gt£¸OƤĿéYõ·kĀq]juw¥DĩƍõÇPéÄ½G©ã¤GuȧþRcÕĕNyyût­øï»a½ē¿BMoį£Íj}éZËqbʍƬh¹ìÿÓAçãnIÃ¡I`ks£CG­ěUy×Cy@¶ʡÊBnāzGơMē¼±O÷õJËĚăVĪũƆ£¯{ËL½ÌzżVR|ĠTbuvJvµhĻĖHAëáa­OÇðñęNwœľ·LmI±íĠĩPÉ×®ÿscB³±JKßĊ«`ađ»·QAmOVţéÿ¤¹SQt]]Çx±¯A@ĉĳ¢Óļ©l¶ÅÛrŕspãRk~¦ª]Į­´FRåd­ČsCqđéFn¿ÅƃmÉx{W©ºƝºįkÕƂƑ¸wWūÐ©ÈF£\\tÈ¥ÄRÈýÌJ lGr^×äùyÞ³fjc¨£ÂZ|ǓMĝÏ@ëÜőRĝ÷¡{aïȷPu°ËXÙ{©TmĠ}Y³­ÞIňµç½©C¡į÷¯B»|St»]vųs»}MÓ ÿʪƟǭA¡fs»PY¼c¡»¦cċ­¥£~msĉPSi^o©AecPeǵkgyUi¿h}aHĉ^|á´¡HØûÅ«ĉ®]m¡qċ¶±ÈyôōLÁstB®wn±ă¥HSòė£Së@×œÊăxÇN©©T±ª£Ĳ¡fb®Þbb_Ą¥xu¥B{łĝ³«`dƐt¤ťiñÍUuºí`£^tƃĲc·ÛLO½sç¥Ts{ă\\_»kÏ±q©čiìĉ|ÍI¥ć¥]ª§D{ŝŖÉR_sÿc³ĪōƿÎ§p[ĉc¯bKmR¥{³Ze^wx¹dƽÅ½ôIg §Mĕ ƹĴ¿ǣÜÍ]Ý]snåA{eƭ`ǻŊĿ\\ĳŬűYÂÿ¬jĖqßb¸L«¸©@ěĀ©ê¶ìÀEH|´bRľÓ¶rÀQþvl®ÕETzÜdb hw¤{LRdcb¯ÙVgƜßzÃôì®^jUèXÎ|UäÌ»rK\\ªN¼pZCüVY¤ɃRi^rPŇTÖ}|br°qňbĚ°ªiƶGQ¾²x¦PmlŜ[Ĥ¡ΞsĦÔÏâ\\ªÚŒU\\f¢N²§x|¤§xĔsZPòʛ²SÐqF`ªVÞŜĶƨVZÌL`¢dŐIqr\\oäõFÎ·¤»Ŷ×h¹]ClÙ\\¦ďÌį¬řtTӺƙgQÇÓHţĒ´ÃbEÄlbʔC|CŮkƮ[ʼ¬ň´KŮÈΰÌĪ¶ƶlðļATUvdTGº̼ÔsÊDÔveMg"]],encodeOffsets:[[[105308,37219],[95370,40081]]]},properties:{cp:[101.778916,36.623178],name:"青海",childNum:2}},{id:"640000",geometry:{type:"Polygon",coordinates:["@@KëÀęĞ«Oęȿȕı]ŉ¡åįÕÔ«ǴõƪĚQÐZhv K°öqÀÑS[ÃÖHƖčËnL]ûcÙß@ĝ¾}w»»oģF¹»kÌÏ·{zP§B­¢íyÅt@@á]Yv_ssģ¼ißĻL¾ġsKD£¡N_X¸}B~HaiÅf{«x»ge_bsKF¯¡IxmELcÿZ¤­ĢÝsuBLùtYdmVtNmtOPhRw~bd¾qÐ\\âÙH\\bImlNZ»loqlVmGā§~QCw¤{A\\PKNY¯bFkC¥sks_Ã\\ă«¢ħkJi¯rrAhĹûç£CUĕĊ_ÔBixÅÙĄnªÑaM~ħpOu¥sîeQ¥¤^dkKwlL~{L~hw^ófćKyE­K­zuÔ¡qQ¤xZÑ¢^ļöÜ¾Ep±âbÊÑÆ^fk¬NC¾YpxbK~¥eÖäBlt¿Đx½I[ĒǙWf»Ĭ}d§dµùEuj¨IÆ¢¥dXªƅx¿]mtÏwßRĶX¢͎vÆzƂZò®ǢÌʆCrâºMÞzÆMÒÊÓŊZÄ¾r°Î®Ȉmª²ĈUªĚîøºĮ¦ÌĘk^FłĬhĚiĀĖ¾iİbjË"],encodeOffsets:[[109366,40242]]},properties:{cp:[106.278179,38.46637],name:"宁夏",childNum:1}},{id:"650000",geometry:{type:"Polygon",coordinates:["@@QØĔ²X¨~ǘBºjʐßØvKƔX¨vĊOÃ·¢i@~cĝe_«E}QxgɪëÏÃ@sÅyXoŖ{ô«ŸuXêÎf`C¹ÂÿÐGĮÕĞXŪōŸMźÈƺQèĽôe|¿ƸJR¤ĘEjcUóº¯Ĩ_ŘÁMª÷Ð¥OéÈ¿ÖğǤǷÂFÒzÉx[]­Ĥĝœ¦EP}ûƥé¿İƷTėƫœŕƅƱB»Đ±ēO¦E}`cȺrĦáŖuÒª«ĲπdƺÏØZƴwʄ¤ĖGĐǂZĶèH¶}ÚZצʥĪï|ÇĦMŔ»İĝǈì¥Βba­¯¥ǕǚkĆŵĦɑĺƯxūД̵nơʃĽá½M»òmqóŘĝčË¾ăCćāƿÝɽ©ǱŅ»ēėŊLrÁ®ɱĕģŉǻ̋ȥơŻǛȡVï¹Ň۩ûkɗġƁ§ʇė̕ĩũƽō^ƕUv£ƁQïƵkŏ½ΉÃŭÇ³LŇʻ«ƭ\\lŭD{ʓDkaFÃÄa³ŤđÔGRÈƚhSӹŚsİ«ĐË[¥ÚDkº^Øg¼ŵ¸£EÍöůŉT¡c_ËKYƧUśĵÝU_©rETÏʜ±OñtYwē¨{£¨uM³x½şL©Ùá[ÓÐĥ Νtģ¢\\śnkOw¥±T»ƷFɯàĩÞáB¹ÆÑUwŕĽw]kE½Èå~Æ÷QyěCFmĭZīŵVÁƿQƛûXS²b½KÏ½ĉS©ŷXĕ{ĕK·¥Ɨcqq©f¿]ßDõU³h­gËÇïģÉɋwk¯í}I·œbmÉřīJɥĻˁ×xoɹīlc¤³Xù]ǅA¿w͉ì¥wÇN·ÂËnƾƍdÇ§đ®ƝvUm©³G\\}µĿQyŹlăµEwǇQ½yƋBe¶ŋÀůo¥AÉw@{Gpm¿AĳŽKLh³`ñcËtW±»ÕSëüÿďDu\\wwwù³VLŕOMËGh£õP¡erÏd{ġWÁč|yšg^ğyÁzÙs`s|ÉåªÇ}m¢Ń¨`x¥ù^}Ì¥H«YªƅAÐ¹n~ź¯f¤áÀzgÇDIÔ´AňĀÒ¶ûEYospõD[{ù°]uJqU|Soċxţ[õÔĥkŋÞŭZËºóYËüċrw ÞkrťË¿XGÉbřaDü·Ē÷AÃª[ÄäIÂ®BÕĐÞ_¢āĠpÛÄȉĖġDKwbmÄNôfƫVÉviǳHQµâFù­Âœ³¦{YGd¢ĚÜO {Ö¦ÞÍÀP^bƾl[vt×ĈÍEË¨¡Đ~´î¸ùÎhuè`¸HÕŔVºwĠââWò@{ÙNÝ´ə²ȕn{¿¥{l÷eé^eďXj©î\\ªÑòÜìc\\üqÕ[Č¡xoÂċªbØ­ø|¶ȴZdÆÂońéG\\¼C°ÌÆn´nxÊOĨŪƴĸ¢¸òTxÊǪMīĞÖŲÃɎOvʦƢ~FRěò¿ġ~åŊúN¸qĘ[Ĕ¶ÂćnÒPĒÜvúĀÊbÖ{Äî¸~Ŕünp¤ÂH¾ĄYÒ©ÊfºmÔĘcDoĬMŬS¤s²ʘÚžȂVŦ èW°ªB|ĲXŔþÈJĦÆæFĚêYĂªĂ]øªŖNÞüAfɨJ¯ÎrDDĤ`mz\\§~D¬{vJÂ«lµĂb¤pŌŰNĄ¨ĊXW|ų ¿¾ɄĦƐMTòP÷fØĶK¢ȝ˔Sô¹òEð­`Ɩ½ǒÂň×äı§ĤƝ§C~¡hlåǺŦŞkâ~}FøàĲaĞfƠ¥Ŕd®U¸źXv¢aƆúŪtŠųƠjdƺƺÅìnrh\\ĺ¯äɝĦ]èpĄ¦´LƞĬ´ƤǬ˼Ēɸ¤rºǼ²¨zÌPðŀbþ¹ļD¢¹\\ĜÑŚ¶ZƄ³âjĦoâȴLÊȮĐ­ĚăÀêZǚŐ¤qȂ\\L¢ŌİfÆs|zºeªÙæ§΢{Ā´ƐÚ¬¨Ĵà²łhʺKÞºÖTiƢ¾ªì°`öøu®Ê¾ãÖ"],encodeOffsets:[[88824,50096]]},properties:{cp:[87.617733,43.792818],name:"新疆",childNum:1}},{id:"110000",geometry:{type:"Polygon",coordinates:["@@RºaYÕQaúÍÔiþĩȨWĢü|Ėu[qb[swP@ÅğP¿{\\¯Y²·Ñ¨j¯X\\¯MSvU¯YIŕY{[fk­VÁûtŷmiÍt_H»Ĩ±d`¹­{bwYr³S]§§o¹qGtm_SŧoaFLgQN_dV@Zom_ć\\ßW´ÕiœRcfio§ËgToÛJíĔóu|wP¤XnO¢ÉŦ¯pNÄā¤zâŖÈRpŢZÚ{GrFt¦Òx§ø¹RóäV¤XdżâºWbwŚ¨Ud®bêņ¾jnŎGŃŶnzÚScîĚZen¬"],encodeOffsets:[[119421,42013]]},properties:{cp:[116.405285,39.904989],name:"北京",childNum:1}},{id:"120000",geometry:{type:"Polygon",coordinates:["@@ŬgX§Ü«E¶FÌ¬O_ïlÁgz±AXeµÄĵ{¶]gitgIj·¥ì_iU¨ÐƎk}ĕ{gBqGf{¿aU^fIư³õ{YıëNĿk©ïËZukāAīlĕĥs¡bġ«@dekąI[nlPqCnp{ō³°`{PNdƗqSÄĻNNâyj]äÒD ĬH°Æ]~¡HO¾X}ÐxgpgWrDGpù^LrzWxZ^¨´T\\|~@IzbĤjeĊªz£®ĔvěLmV¾Ô_ÈNW~zbĬvG²ZmDM~~"],encodeOffsets:[[120237,41215]]},properties:{cp:[117.190182,39.125596],name:"天津",childNum:1}},{id:"310000",geometry:{type:"MultiPolygon",coordinates:[["@@ɧư¬EpƸÁx]","@@©²","@@MA","@@QpªKWT§¨","@@bŝÕÕEȣÚƥêImɇǦèÜĠÚÄÓŴ·ʌÇ","@@Sô¤r]ìƬįǜûȬɋŭ×^sYɍDŋŽąñCG²«ªč@h_p¯A{oloY¬j@Ĳ`gQÚpptǀ^MĲvtbe´Rh@oj¨","@@ÆLH{a}Eo¦"]],encodeOffsets:[[[124702,32062],[124547,32200],[124808,31991],[124726,32110],[124903,32376],[124065,32166],[124870,31965]]]},properties:{cp:[121.472644,31.231706],name:"上海",childNum:7}},{id:"500000",geometry:{type:"Polygon",coordinates:["@@TÂÛ`Ùƅően½SêqDu[RåÍ¹÷eXÍy¸_ĺę}÷`M¯ċfCVµqŉ÷Zgg^d½pDOÎCn^uf²ènh¼WtƏxRGg¦pVFI±G^Ic´ecGĹÞ½sëÆNäÌ¤KÓe¯|R¸§LÜkPoïƭNï¶}Gywdiù©nkĈzj@Óc£»Wă¹Óf§c[µo·Ó|MvÛaq½«è\\ÂoVnÓØÍ²«bq¿ehCĜ^Q~ Évýş¤²ĮpEĶyhsŊwH½¿gÅ¡ýE¡ya£³t\\¨\\vú¹¼©·Ñr_oÒý¥et³]Et©uÖ¥±ă©KVeë]}wVPÀFA¨ąB}qTjgRemfFmQFÝMyùnÑAmÑCawu_p¯sfÛ_gI_pNysB¦zG¸rHeN\\CvEsÐñÚkcDÖĉsaQ¯}_UzÁē}^R Äd^ÍĸZ¾·¶`wećJE¹vÛ·HgéFXjÉê`|ypxkAwWĐpb¥eOsmzwqChóUQl¥F^lafanòsrEvfQdÁUVfÎvÜ^eftET¬ôA\\¢sJnQTjPØxøK|nBzĞ»LYFDxÓvr[ehľvN¢o¾NiÂxGpâ¬zbfZo~hGi]öF||NbtOMn eA±tPTLjpYQ|SHYĀxinzDJÌg¢và¥Pg_ÇzIIII£®S¬ØsÎ¼¥¨^LnGĲļĲƤjÎƀƾ¹¸ØÎezĆT¸}êÐqHðqĖä¥^CÆIj²p\\_ æüY|[YxƊæu°xb®Űb@~¢NQt°¶Sæ Ê~rǉĔëĚ¢~uf`faĔJåĊnÔ]jƎćÊ@£¾a®£Ű{ŶĕFègLk{Y|¡ĜWƔtƬJÑxq±ĢN´òKLÈÃ¼D|s`ŋć]Ã`đMùƱ¿~Y°ħ`ƏíW½eI½{aOIrÏ¡ĕŇapµÜƃġ²"],encodeOffsets:[[111728,31311]]},properties:{cp:[106.504962,29.533155],name:"重庆",childNum:1}},{id:"810000",geometry:{type:"MultiPolygon",coordinates:[["@@AlFi","@@mp","@@EpHo","@@rMUwAS¬]","@@ea¢pl¸Eõ¹hj[]ÔCÎ@lj¡uBX´AI¹[yDU]W`çwZkmcMpÅv}IoJlcafŃK°ä¬XJmÐ đhI®æÔtSHnEÒrÄc"]],encodeOffsets:[[[117111,23002],[117072,22876],[117045,22887],[116882,22747],[116975,23082]]]},properties:{cp:[114.173355,22.320048],name:"香港",childNum:5}},{id:"820000",geometry:{type:"Polygon",coordinates:["@@áw{Îr"],encodeOffsets:[[116285,22746]]},properties:{cp:[113.54909,22.198951],name:"澳门",childNum:1}}],UTF8Encoding:!0};d.SceneManager=function(a){e.checkNotNull(a,"dataManager"),s.call(this),this.dataManager=a,this.initViewManager(),this.network3d=this.viewManager3d.network,this.network2d=this.viewManager2d.network,this.prefabMap={},this.dataNodeMap={},this.dataNode2DMap={},this.linkMap={},this.categoryNodeMap={},this.assetTypeNodeMap={},this.locationManager=new d.LocationManager(this),this._sceneManagerChangeDispatcher=new mono.EventDispatcher,this._sceneChangeDispather=new mono.EventDispatcher,this._scenes=[],this._sceneMap=[],this.viewManager3d.initDefault(),this._linkTemplateMap={};var b=this.getAlarmManagerClass();this._alarmManager=new b(this.dataManager,this),this.doubleClickBackgroundGotoUpLevelScene=!1,this.linkControlsFunction=function(a,b,c){var d=b.getBoundingBox(),e=c.getBoundingBox(),f=20,g=Math.max(d.max.y,e.max.y),h=b.frontWorldPosition(d.max.z+f),i=c.frontWorldPosition(e.max.z+f),j=[];return j.push(h),j.push(h.clone().add(new mono.Vec3(0,g,0))),j.push(i.clone().add(new mono.Vec3(0,g,0))),j.push(i),j},this.gcsManager=new d.GCSManager({sceneManager:this}),this.beforeLoadSceneFunction=null,this.afterLoadSceneFunction=null,this.isBindingBuildingAndFloor=!0,this.sceneChangeWithOutAnimate=!1,this.resetCameraWhenSceneChange=!0,this._sceneVirtualChangeDispather=new mono.EventDispatcher,this._sceneVisibleChangeDispather=new mono.EventDispatcher,this.lightManager=new A(this);var c=this;a.addDataManagerChangeListener(function(a){if(c._loaded){var b=a.kind;"add"===b?c.handleDataAdd(a):"remove"===b&&c.handleDataRemove(a)}}),a.addDataPropertyChangeListener(function(a){c._loaded&&c.handleDataPropertyChange(a)}),this.removeAndAddAllChildrenWhenSetFocusFilter=null,this.viewManager3d.addPropertyChangeListener(function(a){if("focusNode"==a.property){var b=c.network3d.getDataBox(),d=a.oldValue,e=a.newValue;if(d){var f=d.getClient("simpleNode");if(f&&f.getParent()!=d&&!c.isChild(d,e)){var g=d.getClient("complexNode"),h=c.getNodeData(d);g.setParent(null),f.setParent(d),b.getDataById(d.getId())&&(b.removeByDescendant(d,!1,function(a){var b=c.getNodeData(a),d=c.dataManager.getDataTypeForData(b);return d&&!d.isLazyable()?!1:b&&h&&b.getParentId()===h.getId()?!0:!1}),b.removeByDescendant(g),b.addByDescendant(f,function(a){return!0}),c._sceneManagerChangeDispatcher.fire({kind:"change",data:d}),c.viewManager3d.getDefaultEventHandler().closeDoor(g))}}if(e){var g=e.getClient("complexNode");if(g&&g.getParent()!=e){var f=e.getClient("simpleNode");f.setParent(null),g.setParent(e),b.addByDescendant(g,function(a){return!0}),b.removeByDescendant(f),c._sceneManagerChangeDispatcher.fire({kind:"change",data:e})}c.loadLazyChildren(e),c.viewManager3d.defaultMaterialFilter&&c.viewManager3d.defaultMaterialFilter.removeByDescendant(c.getNodeData(e)),c.switchToRealNode(e,d)}}}),this.addSceneChangeListener(function(a){c.setSceneNetworkAndLight(a.data),c.bindingBuildingAndFloor(a.data)})},d.SceneManager.CLIENT_IT_DATA="it_data",d.SceneManager.CLIENT_IT_DATA_ID="it_data_id",d.SceneManager.getNodeData=function(a){return a.getClient(d.SceneManager.CLIENT_IT_DATA)},d.SceneManager.getNodeDataId=function(a){return a?a.getClient(d.SceneManager.CLIENT_IT_DATA_ID):null},mono.extend(d.SceneManager,s,{getSceneView:function(a){if(a){var b;return document.getElementById("mainView")?(b=document.getElementById("mainView"),b.appendChild(this.network3d.getRootView())):(b=document.createElement("div"),b.appendChild(this.network3d.getRootView()),b.appendChild(this.viewManager2d.getContainer())),b}return this.network3d.getRootView()},adjust2DBounds:function(a,b,c,d){this.viewManager2d.adjustViewBounds(a,b,c,d)},adjust3DBounds:function(b,c,d,e){b||(b=document.documentElement.clientWidth),c||(c=document.documentElement.clientHeight),d=d||0,e=e||0,this.network3d.adjustBounds(b-d,c-e);var f=this;a.addEventListener?a.addEventListener("resize",function(){f.network3d.adjustBounds(b-d,c-e,e,d)},!0):a.attachEvent?a.attachEvent("onresize",function(){f.network3d.adjustBounds(b-d,c-e,e,d)}):a.onresize=function(){f.network3d.adjustBounds(b-d,c-e,e,d)}},removeAndAddAllChildrenWhenSetFocus:function(a){if(this.removeAndAddAllChildrenWhenSetFocusFilter)return this.removeAndAddAllChildrenWhenSetFocusFilter(a);if(!a)return!1;var b=this.getNodeData(a);if(b){var c=this.dataManager.getCategoryForData(b);if(c&&c.getId()&&c.getId().toLowerCase().indexOf("rack")>=0)return!0}return!1},isChild:function(a,b){if(!a||!b)return!1;var c=this.getNodeData(a);if(!c)return!1;var d=this.getNodeData(b);return d&&d instanceof i&&d.getParentId()&&d.getParentId()===c.getId()?!0:!1},adjustBounds:function(a,b,c,d){this.adjust2DBounds(a,b,c,d),this.adjust3DBounds(a,b,c,d)},getDataBox:function(){return this.network3d.getDataBox()},getDataBox2d:function(){return this.network2d.getElementBox()},setDefaultInteractionSpeed:function(a,b,c){var d=this.network3d.getDefaultInteraction();d&&(d.setRotateSpeed(a),d.setPanSpeed(b),d.setZoomSpeed(c))},shouldHandleDoubleClickBackground:function(a){if(!this.doubleClickBackgroundGotoUpLevelScene)return!1;if(!this.dataManager.getRootScene())return!1;if(this._currentScene===this.dataManager.getRootScene())return!1;if(a instanceof mono.Network3D){var b=this.viewManager3d.getFocusNode();if(b&&(b=this.getMainNode(b),this._currentRootNode!==b))return!1}return!0},saveView:function(){},handleDoubleClickBackground:function(a){this.gotoUpLevelScene()},shouldHandleDoubleClickElement:function(a,b,c,d){var e=this.dataManager;if(!e.getRootScene())return!1;if(a.doubliClick)return!0;if(!c)return!1;var f=e.getCategoryForData(c);if(!f)return!1;var g=e.getSceneByCategory(f);return g&&this._currentScene!=g?!0:!1},handleDoubleClickElement:function(a,b,c,d){var e=this.dataManager,f=e.getCategoryForData(c),g=e.getSceneByCategory(f),h=this.getNodeByDataOrId(c),i=a.doubliClick||(h?h.doubliClick:null);return i?i(a,b,c,d):void(this._currentScene!=g&&(this.toScene(g,c),c&&this.viewManager3d.setFocusNode(this.dataNodeMap[c.getId()])))},clear:function(){this.animateAtBeforeChangeScene();var a=new mono.List;for(var b in this.dataNodeMap){var c=this.dataNodeMap[b];c&&(c.setParent(null),a.add(c))}this.viewManager3d.clear(),this.getDataBox2d().clear(),this._sceneManagerChangeDispatcher.fire({kind:"clear",datas:a})},getCurrentScene:function(){return this._currentScene},getParentScene:function(a){if(!a)return null;var b=this.dataManager.getParent(a);if(!b)return null;var c=this.dataManager.getCategoryForData(b);if(!c)return this.getParentScene(b,this);var d=this.dataManager.getSceneByCategory(c);return d?{scene:d,data:b}:this.getParentScene(b,this)},gotoUpLevelScene:function(){var a=this._currentScene;return a?void(a.getTwod()?(this.clear(),this.gotoUpLevelSceneFor2D()):this.gotoUpLevelSceneFor3D()):!1},toScene:function(a,b){a&&(this.clear(),this._loadOneScene(a,b))},gotoScene:function(a,b){if(a){if(a==this._currentScene){var c=this.getNodeData(this._currentRootNode);if(b&&c&&b==c)return}this.toScene(a,b),b&&!a.getTwod()&&this.viewManager3d.setFocusNode(this.dataNodeMap[b.getId()])}},gotoUpLevelSceneFor2D:function(){var a=this._currentScene;if(!a)return!1;var b=this._currentRootNode;if(!b)return!1;var c=this.getNodeData(b),d=this.getParentScene(c);if(d&&d.scene&&d.data){var e=this,f=function(){var a=e.getNodeData(b);if(a&&a.getParentId()){var c=e.dataNodeMap[a.getParentId()],d=e.network3d.getDataBox();c&&d.getDataById(c.getId())||(e.loadLazyData(a.getParentId()),c=e.dataNodeMap[a.getParentId()]),c&&e.viewManager3d.lookAt(c)}};this.toScene(d.scene,d.data),f()}},gotoUpLevelSceneFor3D:function(){var a=this._currentScene;if(!a)return!1;var b=this._currentRootNode,c=this._currentRootData;if(!b&&!c)return!1;var d=this.getNodeData(b);d||(d=c);var e=this.dataManager.getParent(d);if(!e)return!1;var f=this.getSceneAndRootByData(e);if(!f)return!1;var g=this.dataManager.getCategoryForData(e);return g&&g.getId().indexOf("building")>=0&&(this.sceneChangeWithOutAnimate=!0),this.toScene(f.scene,f.rootData),g&&g.getId().indexOf("building")>=0?(this.sceneChangeWithOutAnimate=!0,this.viewManager3d.setFocusNode(this.dataNodeMap[e.getId()]),this.sceneChangeWithOutAnimate=!1):f.rootData?this.viewManager3d.setFocusNode(this.dataNodeMap[f.rootData.getId()]):this.viewManager3d.setFocusNode(null),!0},gotoData:function(a){var b=this.dataManager,c=a;if(typeof a!==i&&(c=b.getDataById(a)),!c)return!1;var d=b.getCategoryForData(c);if(!d)return!1;var e=this.dataManager.getSceneByCategory(d);return e?(this.toScene(e,c),!0):!1},initViewManager:function(){this.viewManager3d=new d.ViewManager(this),this.viewManager3d.addEventHandler(this),this.viewManager2d=new d.ViewManager2D(this),this.viewManager2d.addEventHandler(this)},removeNodeChildren:function(a,b){var c=a;(a instanceof i||"string"==typeof a)&&(c=this.getNodeByDataOrId(a));var d=this.getDataBox(),e=c.getChildren().toList();e.forEach(function(a){(!b||b(a))&&(a.setParent(null),d.removeByDescendant(a))})},setNodeData:function(a,b,c){if(b){b.setClient(d.SceneManager.CLIENT_IT_DATA,a),b.setClient(d.SceneManager.CLIENT_IT_DATA_ID,a.getId()),c?b.setClient("modelParent",c):c=b;var e=b.getClient("complexNode");e&&this.setNodeData(a,e,c);var f=this;b.getChildren()&&b.getChildren().size()>0&&b.getChildren().forEach(function(b){f.setNodeData(a,b,c)})}},getMainNode:function(a){return a?(null==a.getClient(d.SceneManager.CLIENT_IT_DATA)&&(a=a.getParent()),this.getNodeByDataOrId(this.getNodeData(a))):void 0},getParentNode:function(a){var b=a.getParentId();return b?this.dataNodeMap[b]:null},getChildrenNodes:function(a,b){var c=a;a instanceof mono.Node&&(c=this.getNodeData(node));var d,e=0,f=[];if(c)for(d=this.dataManager.getChildren(c,b),e=0;e<d.length;e++)f.push(this.getNodeByDataOrId(d[e]));return f},getNodeData:function(a){return a&&a.getClient?a.getClient("it_data"):null},getNodeByDataOrId:function(a){if(!a)return null;var b=a.getId?a.getId():a;return this.dataNodeMap[b]},getNodeForDataOrId:function(a){if(!a)return null;var b=a.getId?a.getId():a;return this.dataNodeMap[b]},loadModel:function(a,b,c,d){var e=null;if(c&&d&&(e=this.prefabMap[d],e&&e.clonePrefab&&(e=e.clonePrefab())),
!e){b=b||{},b.type=b.type||a;var f=a||b.type;if(!f)return null;var g={};b instanceof Array?(g.data=b,g.id=f):"twaver.loader"===f?(g.id=f,g.data=b):(g=b||{},g.id=f),e=make.Default.load(g),d&&(this.prefabMap[d]=e)}return e},loadDataTypeTemplateModels:function(a,b,c){var d=a.getTemplateDatas();if(null!=d&&0!=d.length){var e=this;d.forEach(function(a){a=e._translateTemplateData(a,b);var d=e.dataNode2DMap[b.getId()],f=e.loadDataModel2D(a,c);f.setMovable(!1),f.setHost(d),f.setParent(d),f.setName("")})}},loadDataModel:function(a,b){var c=this.dataManager,d=c.getDataTypeForData(a),e=this,f=this.network3d.getDataBox(),g=a.getId(),h=function(b){var d=a.getId(),g=c.getDataTypeForData(a),h=c.getCategoryForData(a);f.addByDescendant(b),e.dataNodeMap[d]=b;var i=e.assetTypeNodeMap[g.getId()];i||(i={},e.assetTypeNodeMap[g.getId()]=i),i[d]=b,h&&(i=e.categoryNodeMap[h.getId()],i||(i={},e.categoryNodeMap[h.getId()]=i),i[d]=b),e.setNodeData(a,b),e._sceneManagerChangeDispatcher.fire({kind:"add",data:b})},i=this.dataNodeMap[g],j=d.getModelParameters(),k=j,l=d.isPrefabAble(),m=d.isSimplePrefabAble(),n=d.getSimpleModel(),o=d.getSimpleModelParameters();if(i)h(i);else{if(i=this.loadModel(d.getModel(),k,l,d.getId()),!i)return;var p;if((n||o)&&(p=this.loadModel(n,o,m,d.getId()+"_simple")),p){var q=i.getBoundingBoxWithChildren(),r=q.size(),s=new mono.Cube(r.x,r.y,r.z);s.s({"m.visible":!1}),p.setParent(s),s.setClient("simpleNode",p),s.setClient("complexNode",i),h(s)}else h(i)}},loadModel2D:function(a,b,c){if(a||mono.Utils.isArray(b)){var d={};return b instanceof Array?(b.forEach(function(a){a.scale=20}),d.data=b,d.id=a):(d=b||{},d.id=a),make.Default.load(d)}var e=new twaver.Node,f=c.getPosition2d();return f&&(b&&"panel"==b.dtype?(e.setLocation(f.x,f.y),e.setToolTip("node1"),e.setSize(400,400)):this.viewManager2d.setPosition(e,f.x,f.y)),e},_translateTemplateData:function(a,b){var c=a.getId(),d=b.getId(),e=a.getPosition2d()||new mono.Vec2,f=b.getPosition2d()||new mono.Vec2,g=c+"@"+d,h=this.dataManager.getDataById(g);if(!h){h=a.clone(g),h.setHostId(a.getHostId()),this.dataManager.addData(h,!1);var i=h.getPosition2d()||new mono.Vec2;i.x=parseInt(f.x||0)+e.x,i.y=parseInt(f.y||0)+e.y}return h.setParentId(d),h},loadDataTypeTemplateModel2Ds:function(a,b,c){var d=a.getTemplateDatas();if(null!=d&&0!=d.length){var e=this,f={};d.forEach(function(a){a=e._translateTemplateData(a,b);var d=a.getHostId(),g=e.dataNode2DMap[b.getId()],h=e.loadDataModel2D(a,c);h.setMovable(!1),d?e.setTemplatesGroup(h,d,g,f):g&&(h.setHost(g),h.setParent(g)),h.setName("");var i=a.getId(),j=b.getId();i.length>j.length+1&&(i=i.substring(0,i.length-j.length-1)),h.setToolTip(i)})}},setTemplatesGroup:function(a,b,c,d){if(!a||!b)return null;d||(d={});var e=a.getParent();if(!e||!e.getClient("group_id")||e.getClient("group_id")!=b){var f=null;if(d[b])f=d[b];else{var g=this.getDataBox2d();if(f=new twaver.Node,c){var h=this.getNodeData(c);f.setParent(c),f.setClient("parent_data",h),f.setName(""),f.setToolTip(b),f.setVisible(!1)}f.setClient("group_id",b),d[b]=f,g.add(f)}a.setHost(c),a.setParent(f)}},loadDataModel2D:function(a,b){var c=this.dataManager,d=c.getDataTypeForData(a),e=this.getDataBox2d(),f=a.getId(),g=this.dataNode2DMap[f],h=d.getModel2dParameters();if(!g){g=this.loadModel2D(d.getModel2d(),h,a);var i=g;if(g instanceof Array&&(i=g[0])){i.setMovable(!1);for(var j=1;j<g.length;j++){var k=g[j];k&&(k.setMovable(!1),this.setNodeData(a,k),i.addChild(k),k.setHost(i))}}if(i){i.setName(a.getDescription()||f),this.setNodeData(a,i),this.dataNode2DMap[f]=i;var l=a.getPosition2d();l&&this.viewManager2d.setPosition(i,l.x,l.y)}}return e.getDataById(g.getId())||e.addByDescendant(g),this.loadDataTypeTemplateModel2Ds(d,a,b),g},handleDataAdd:function(a){var b=a.data;b instanceof i?this.shouldLoadData(b)?this.loadOneData(b):this.shouldLoadData2D(b)&&this.loadDataModel2D(b):b instanceof m&&this.loadLink(b)},shouldLoadData:function(a){if(!a)return!1;var b=this.dataManager.getDataTypeForData(a);if(b&&b.isLazyable()){var c=this.viewManager3d.getFocusNode(),d=this.getNodeData(c);return d.getId()==a.getId()?!0:!1}return this.isCurrentSceneInstance(a)},shouldLoadData2D:function(a){var b=this.getCurrentScene();if(null==b)return!1;var c=this.getParentScene(a);return c.scene==this.getCurrentScene()&&b.getTwod()},handleDataRemove:function(a){var b=a.data,c=(this.dataManager,this.network3d.getDataBox());if(b instanceof i){var d=this.dataNodeMap[b.getId()];c.removeByDescendant(d)}else if(b instanceof m){var e=this.linkMap[b.getId()];c.removeByDescendant(e)}},handleDataPropertyChange:function(a){var b=a.source,c=a.property;if("parentId"===c){a.oldValue,b.getId();this.setParentRelationShip(b),this.translatePosition(b)}else("location"===c||"position"===c)&&this.translatePosition(b)},setAllParentRelationShip:function(){for(var a in this.dataNodeMap){var b=this.dataNodeMap[a],c=this.getNodeData(b);this.setParentRelationShip(c)}},isNeedSetParent:function(a,b){if(a&&this.earthScene&&this.earthScene.rootData){var c=this.dataNodeMap[a.getParentId()],d=this.getNodeByDataOrId(this.earthScene.rootData);if(c&&c==d)return this._currentScene&&this._currentScene.getCategoryId().indexOf("earth")>=0?!0:!1}return!0},setParentRelationShip:function(a){if(a){var b=this.dataNodeMap[a.getId()];if(this.isNeedSetParent(a,b)){var c=this.dataNodeMap[a.getParentId()];b&&c&&b.setParent(c)}}},translateAllPosition:function(){for(var a in this.dataNodeMap){var b=this.dataNodeMap[a],c=this.getNodeData(b);this.translatePosition(c)}},computePosition:function(a,b,c,d){this.locationManager.computePosition(a,b,c,d)},computeRotation:function(a,b,c,d){this.locationManager.computeRotation(a,b,c,d)},translatePosition:function(a){if(a){var b=this.dataManager,c=a.getId(),d=this.dataNodeMap[c];if(d){var e=a.getParentId(),f=b.getDataById(e),d=this.dataNodeMap[c],g=this.dataNodeMap[e];this.computePosition(a,f,d,g),this.computeRotation(a,f,d,g)}}},beforeLoadScene:function(a,b){return this.beforeLoadSceneFunction&&this.beforeLoadSceneFunction(a,b),this.animateAtAfterChangeScene(),!0},afterLoadScene:function(a,b,c,d){this._sceneChangeDispather.fire({kind:"changeScene",data:a,rootData:b,oldData:c,oldRootData:d}),this.afterLoadSceneFunction&&this.afterLoadSceneFunction(a,b)},loadOneData:function(a){this.loadDataModel(a),this.setParentRelationShip(a),this.translatePosition(a)},getSceneFromData:function(a){var b=this.dataManager;if(null==b.getRootScene())return null;if(!a)return null;var b=this.dataManager,c=a;a.getId||(c=b.getDataById(a));var d=b.getSceneByData(c);return null==d?this.getSceneFromData(c.getParentId()):(d.__currentRootData=c,d)},loadLazyData:function(a){if(a){var b=this.dataManager,c=a;a.getId||(c=b.getDataById(a));var d=c.getParentId(),e=this.getSceneFromData(d),f=this.getSceneFromData(c);if(null==e&&null==f||e==f){this.loadLazyData(d);var g=this.getNodeByDataOrId(c);if(g){var h=this.getDataBox();h.contains(g)||(h.addByDescendant(g),this.setParentRelationShip(c),this.translatePosition(c))}else this.loadOneData(c)}else{var g=this.getNodeByDataOrId(c);if(g){var h=this.getDataBox();h.contains(g)||(h.addByDescendant(g),this.setParentRelationShip(c),this.translatePosition(c))}else this.loadOneData(c)}}},loadLazyChildren:function(a,b){b=b||!1;var c=a,e=a;if(a instanceof mono.Data?c=this.getNodeData(a):e=this.getNodeByDataOrId(c),!(c instanceof d.Data))return null;var f=this.getSceneFromData(c),g=new mono.List;c instanceof i&&(g=c.getChildren());for(var h,j,k,l=0,m=g.size();m>l;l++)if(h=g.get(l),k=this.dataNodeMap[h.getId()]){var n=this,j=this.dataManager.getDataTypeForData(h);if(!j.isLazyable()||!b){this.network3d.getDataBox().getDataById(k.getId())||this.network3d.getDataBox().addByDescendant(k,function(a){var b=n._currentScene,c=n.getSceneFromData(n.getNodeData(a)),d=n.getNodeData(a);if(d==h)return!0;var e=k.getClient("complexNode"),f=k.getClient("simpleNode");return e&&f&&e.getParent()!=k&&f.getParent()==k?!1:null==b&&null==c||b==c?!0:!1});var o=this.getSceneFromData(h);if((null!=f||null!=o)&&f!=o)continue;this.loadLazyChildren(h,!0)}}else if(j=this.dataManager.getDataTypeForData(h),!j.isLazyable()||!b){this.loadOneData(h);var o=this.getSceneFromData(h);if((null!=f||null!=o)&&f!=o)continue;this.loadLazyChildren(h,!0)}},$P:function(a,b){},loadLinks:function(){var a=this.dataManager,b=a.getLinkMap();for(var c in b)this.loadLink(b[c])},loadLink:function(a){var b=this.dataManager,c=a.getFromId(),e=a.getToId(),f=this.dataNodeMap[c],g=this.dataNodeMap[e];if(f&&g&&!this.linkMap[a.getId()]){var h=null,i=a.getRadius()||2,j=null,k=a.getDataTypeId(),l=b._dataTypeMap[k];if(null!=l&&(j=this._linkTemplateMap[k],j||(j=this.loadModel(l.getModel(),l.getModelParameters()))),a.getType()&&"link"==a.getType()?(h=new mono.Link(f,g),j&&j instanceof mono.PathNode?h.s(j.styleMap):h.s({"m.type":"phong","m.color":"cyan","m.ambient":"cyan"})):(h=new mono.PathLink(f,g),j&&j instanceof mono.PathNode?(h.setStartCap(j.getStartCap()),h.setEndCap(j.getEndCap()),h.setRadius(j.getRadius()),h.s(j.styleMap)):h.s({"m.type":"phong","m.color":"cyan","m.ambient":"cyan","m.texture.image":"./images/pipeline/flow.jpg","m.texture.repeat":new mono.Vec2(100,1)})),!(j instanceof mono.PathNode)&&h instanceof mono.PathNode&&(h.setStartCap("plain"),h.setEndCap("plain"),h.setRadius(i),h.s({"m.specularStrength":30,"m.ambient":"#C6FEFA","m.type":"phong"})),h._adjustTimes=10,this.linkControlsFunction){f.updateWorldMatrix(),g.updateWorldMatrix();var m=this.linkControlsFunction(a,f,g);h.setLinkType("control"),h.setControls(m)}else var m=(h.getFromControls(),h.getToControls(),[]);h.setClient("id",a.getId()),h.setClient(d.SceneManager.CLIENT_IT_DATA,a),this.linkMap[a.getId()]=h,h.setVisible(!1),this.network3d.getDataBox().add(h)}},_getControlPoint:function(a,b){b=b||{};var c=this._getControlNumber(a,b.x,"x"),d=this._getControlNumber(a,b.y,"y"),e=this._getControlNumber(a,b.z,"z");return new mono.Vec3(c,d,e)},_getControlNumber:function(a,b,c){function d(a,b){if(0==a)return b;var c=i.dataManager.getParent(b);return c?d(a-1,c):b}if(!b)return 0;for(var e=a.getId?a:this.dataManager.getDataById(a),f=/\$(p|P)\d/g,g=b.match(f),h={},i=this,j=0;j<g.length;j++){var k=g[j],l=k.toLowerCase().replace("$p",""),m=i.getNodeByDataOrId(d(l,e));h[k]=i._wrapBoundingBox(m)}var n=" with (scope) {  return "+b+"}",o=new Function("scope",n);try{var p=o(h);return p}catch(q){console.error(q)}return 0},_wrapBoundingBox:function(a){var b=a.getBoundingBox();return b.front=function(b){return b=b||0,a.frontWorldPosition(this.max.z+b).z},b.top=function(b){return b=b||0,a.worldPosition(new mono.Vec3(0,1,0),this.max.y+b).y},b},isLink:function(a){return a&&a.getClient(d.SceneManager.CLIENT_IT_DATA)&&a.getClient(d.SceneManager.CLIENT_IT_DATA)instanceof m?!0:!1},getLinkNodeById:function(a){var b=a;return a instanceof d.Link&&(b=a.getId()),this.linkMap[b]},_loadRootScene:function(){var a=this.dataManager,b=a.getRootScene();this._loadOneScene(b,null),this._currentRootNode&&this.viewManager3d.setFocusNode(this._currentRootNode)},_loadOneScene:function(a,b,c){if(this.beforeLoadScene(a,b)){var e,f=this._currentScene,g=this.getNodeData(this._currentRootNode),h=this.dataManager,i=a.getCategoryId(),j=a.getSceneType(),k=a.getTwod(),l=a.getWithGis();if(e="ShowSelf"==j?0:"ShowSelfAndChildren"===j||"ShowChildren"===j?1:"ShowThird"===j?2:100,this._currentScene=a,this._currentScene.getTwod())l?this.viewManager2d.addGis(!0,!0):this.viewManager2d.removeGis(),this._currentScene.zoomLevel&&this.viewManager2d.setZoomLevel(this._currentScene.zoomLevel),this._currentScene.center&&this.viewManager2d.setCenter(this._currentScene.center),this.network3d.getRootView().style.display="none",this.viewManager2d.getContainer().style.display="block";else{if(l){this.earthScene?this.earthScene.refresh():(this.earthScene=new d.DefaultEarthScene(this,a),this.earthScene.createDCBillboard=function(a){return null},setTimeout(function(){m.earthScene.doPlay()},1e3)),this.viewManager2d.getContainer().style.display="none",this.network3d.getRootView().style.display="block",this.earthScene.rootData&&(this._currentRootNode=this.dataNodeMap[this.earthScene.rootData.getId()]),c&&c(),this.afterLoadScene(a,b,f,g);var m=this;return}this.viewManager2d.getContainer().style.display="none",this.network3d.getRootView().style.display="block"}if(null==b){var n=h.getDataMapByCategory(i);this.network3d.getDataBox().startBatch();for(var o in n)this._loadSceneData(n[o],j,e,k),this._currentRootNode=this.dataNodeMap[o]}else this.network3d.getDataBox().startBatch(),this._loadSceneData(b,j,e,k),k?this._currentRootNode=this.dataNode2DMap[b.getId()]:this._currentRootNode=this.dataNodeMap[b.getId()],this._currentRootData=b;c&&c(),this._currentScene.getTwod()&&(this.viewManager2d.showTable(this._currentScene),this.viewManager2d.showTree(this._currentScene),this.network2d.zoomOverview()),this._onLoadFinish(),this.network3d.getDataBox().endBatch(),this.afterLoadScene(a,b,f,g)}},_loadSceneData:function(a,b,c,d){var e=this.dataManager;if("ShowChildren"===b&&1===c||"ShowDescendant"===b&&100===c||(d?this.loadDataModel2D(a):e.isLazyable(a)||this.loadDataModel(a)),!(0>=c))for(var f=a.getChildren(),g=0;g<f.size();g++)this._loadSceneData(f.get(g),b,c-1,d)},_onLoadFinish:function(){this.setAllParentRelationShip(),this.translateAllPosition(),this.loadLinks(),this.resetCamera(),this._loaded=!0},getSetMethod:function(a){var b="set"+a.charAt(0).toUpperCase()+a.slice(1);return b},setNetworkValue:function(a,b){if(a){var c=this.getSetMethod(a);this.network3d[c]&&"function"==typeof this.network3d[c]?this.network3d[c](b):this.network3d[a]=b}},setCameraValue:function(a,b){if(a){var c=this.network3d.getCamera(),d=this.getSetMethod(a);c[d]&&"function"==typeof c[d]?c[d](b):c[a]=b}},setSceneNetworkAndLight:function(a){if(!a)return null;if(!a.getTwod()){var b=a.networkParameters,c=(a.lights,a.cameraParameters);a.animateParameters;if(this.viewManager3d.resetNetwork(),this.viewManager3d.resetCamera(),b)for(var d in b)this.setNetworkValue(d,b[d]);if(c)for(var d in c)this.setCameraValue(d,c[d])}},_loadDataMap:function(a){var b=this.dataManager;for(id in a){var c=a[id];b.isLazyable(c)||this.loadDataModel(a[id])}this._onLoadFinish(),this.afterLoadScene()},resetCamera:function(){this.resetCameraWhenSceneChange&&(this._currentRootNode?this.viewManager3d.getDefaultEventHandler().lookAtNodeWithOutAnimate(this._currentRootNode):this.network3d.zoomEstimateOverview(30)),this.resetCameraWhenSceneChange=!0},loadScene:function(){var a=this.dataManager,b=a.getRootScene();if(this.beforeLoadScene(b)){if(b)return this._loadRootScene();var c=a.getDataMap();this._loadDataMap(c)}},getAlarmManager:function(){return this._alarmManager},addSceneManagerChangeListener:function(a,b,c){this._sceneManagerChangeDispatcher.add(a,b,c)},removeSceneManagerChangeListener:function(a,b){this._sceneManagerChangeDispatcher.remove(a,b)},addSeneChangeListener:function(a,b,c){this._sceneChangeDispather.add(a,b,c)},addSceneChangeListener:function(a,b,c){this._sceneChangeDispather.add(a,b,c)},removeSceneChangeListener:function(a,b){this._sceneChangeDispather.remove(a,b)},addSceneVirtualChangeListener:function(a,b,c){this._sceneVirtualChangeDispather.add(a,b,c)},removeSceneVirtualChangeListener:function(a,b){this._sceneVirtualChangeDispather.remove(a,b)},addSceneVisibleChangeListener:function(a,b,c){this._sceneVisibleChangeDispather.add(a,b,c)},removeSceneVisibleChangeListener:function(a,b){this._sceneVisibleChangeDispather.remove(a,b)},removeBillboard:function(a){a.setParent(null),this.getDataBox().remove(a)},removeAllBillboardByDataId:function(a){var b=this.dataManager.getDataById(a);this.removeAllBillboardByData(b)},removeAllBillboardByData:function(a){var b=a.boards;if(b)for(var c=0;c<b.length;c++)this.removeBillboard(b[c])},createBillboardById:function(a,b){this.dataNodeMap[a];this.getDataBox().add(b);var c=this.dataManager.getDataById(a);return c.boards||(c.boards=[]),c.boards.push(b),b},createBillboard:function(a,b){return this.createTitleBillboardById(a.getId(),b)},createTextBillboard:function(a,b,c){return this.createTextBillboardById(a.getId(),b,c)},createTextBillboardById:function(a,b,c){var e=this.dataNodeMap[a],f=d.Util.createTextBillboardForNode(e,b,c);this.getDataBox().add(f);var g=this.dataManager.getDataById(a);return g.boards||(g.boards=[]),g.boards.push(f),f},createEmptyBillboardById:function(a,b){var c=this.dataNodeMap[a],e=d.Util.createEmptyBillboardForNode(c,b);this.getDataBox().add(e);var f=this.dataManager.getDataById(a);return f.boards||(f.boards=[]),f.boards.push(e),e},createEmptyBillboard:function(a,b,c){return this.createEmptyBillboardById(a.getId(),b,c)},createTitleBillboardById:function(a,b){var c=this.dataNodeMap[a],e=d.Util.createTitleBillboardForNode(c,b);this.getDataBox().add(e);var f=this.dataManager.getDataById(a);return f.boards||(f.boards=[]),f.boards.push(e),e},createTitleBillboard:function(a,b){return this.createTitleBillboardById(a.getId(),b)},margeObject:function(a,b){if(a=a||{},!b)return a;if(b instanceof Array)for(var c=0;c<b.length;c++){var d=b[c];d.getId()&&(a[d.getId()]=d)}else if(b instanceof mono.List)for(var c=0;c<b.size();c++){var d=b.get(c);d&&d.getId()&&(a[d.getId()]=d)}else for(var e in b)e&&b[e]&&(a[e]=b[e]);return a},getSceneDatas:function(){var a=this._currentScene,b=this.dataManager;if(!a)return b.getDataMap();var c=a.getCategoryId(),d=a.getSceneType()||"",e={},f=this.getNodeData(this._currentRootNode);if(f)if(e[f.getId()]=f,"ShowSelfAndChildren"===d||"ShowChildren"===d){var g=f.getChildren();this.margeObject(e,g)}else{var h=b.getDescendants(f);this.margeObject(e,h)}else{var i=b.getDataMapByCategory(c);if(!i||"ShowSelf"==d)return i;for(var j in i){var k=i[j];if(k)if(e[j]=k,"ShowSelfAndChildren"===d||"ShowChildren"===d){var g=k.getChildren();this.margeObject(e,g)}else{var h=b.getDescendants(k);this.margeObject(e,h)}}}return e},getSceneDataTypes:function(){var a={},b=this.getSceneDatas();if(b)for(var c in b){var d=b[c];if(d){var e=this.dataManager.getDataTypeForData(d);a[e.getId()]=e}}return a},getDatasByAncestorId:function(){},getCurrentRootNode:function(){return this._currentRootNode},getLinkData:function(a){if(!a)return null;var b=a.getClient(d.SceneManager.CLIENT_IT_DATA);return b&&b instanceof m?b:null},isAncestor:function(a,b,c){var d=c||this;if(!a||!b)return!1;var e=null;if(e=a instanceof i?a:this.dataManager.getDataById(a),!e)return!1;var f=this.dataManager.getDataById(b);return f?f.getParentId()&&f.getParentId()===e.getId()?!1:e.getParentId()?e.getParentId()===b?!0:d.isAncestor(e.getParentId(),b,d):!1:!1},doAnimateWhenChangeScene:function(){return!1},animateAtBeforeChangeScene:function(){if(this.doAnimateWhenChangeScene()){var a=this.network3d.getRootView(),b=this.viewManager2d.getContainer();$(a).fadeOut(1e3),$(b).fadeOut(1e3)}},animateAtAfterChangeScene:function(){if(this.doAnimateWhenChangeScene()){var a=this.network3d.getRootView(),b=this.viewManager2d.getContainer();$(a).fadeIn(1e3),$(b).fadeIn(1e3)}},getLastSceneInstance:function(a,b,c){if(!a||!b)return null;var d=c||this,e=d.dataManager.getCategoryForData(a);if(e&&b[e.getId()])return{rootData:a,scene:b[e.getId()]};if(a.getParentId()){var f=d.dataManager.getDataById(a.getParentId());return d.getLastSceneInstance(f,b,d)}return null},getSceneAndRootByData:function(a){if(!a)return null;var b=this.dataManager._categorySceneMap;return b?this.getLastSceneInstance(a,b):null},isCurrentSceneInstance:function(a){if(!a)return!1;var b=a;if(b instanceof i||(b=this.dataManager.getDataById(b)),!b)return!1;var c=this.dataManager._categorySceneMap;if(!c)return!0;var d=this._currentScene;if(!d)return!0;var e=this.getSceneAndRootByData(b);if(!e)return!0;var f=this.getNodeData(this._currentRootNode);return f||d!=e.scene?d==e.scene&&f==e.rootData?!0:!1:!0},isSceneRootData:function(a){if(!a)return!1;var b=this.dataManager._categorySceneMap;if(!b)return!1;var c=this.dataManager.getCategoryForData(a);return c&&b[c.getId()]?!0:void 0},isTheSameSceneInstance:function(a,b){var c=this.dataManager._categorySceneMap;return c?void 0:!0},bindingBuildingAndFloor:function(a){if(this.isBindingBuildingAndFloor){this.bindingBuildingAndFloorVisibleManager||(this.bindingBuildingAndFloorVisibleManager=new d.VisibleManager(this),this.viewManager3d.addVisibleFilter(this.bindingBuildingAndFloorVisibleManager));var b=this.dataManager._categoryDatas.floor;if(a&&a.getCategoryId()&&"datacenter"==a.getCategoryId().toLowerCase()){if(b)for(var c in b){var e=b[c];e&&this.bindingBuildingAndFloorVisibleManager.setVisible(e,!1)}this.moveDownFloorsAnimate&&this.moveDownFloorsAnimate.stop(),this.moveUpFloorsAnimate&&this.moveUpFloorsAnimate.stop()}else if(this.bindingBuildingAndFloorVisibleManager.clear(),this.moveDownFloorsAnimate&&this.moveDownFloorsAnimate.stop(),this.moveUpFloorsAnimate&&this.moveUpFloorsAnimate.stop(),b)for(var c in b){var e=b[c],f=this.getNodeByDataOrId(e);f&&(f.orgScale&&(f.setScale(f.orgScale),f==this._currentRootNode&&this.afterLoadFloor(f)),f.orgPosY&&f.setPositionY(f.orgPosY))}}},doubliClickFloorNode:function(a,b,c,d){if(c){var e=this.dataManager.getDataById(c.getParentId());if(e){var f=this.viewManager3d.getDefaultEventHandler(),g=this.dataManager.getCategoryForData(c),h=this.dataManager.getSceneByCategory(g);if(this._currentScene==h)return void f.moveToClickPoint(d);if(this.moveDownFloorsAnimate&&this.moveDownFloorsAnimate.stop(),this.moveUpFloorsAnimate&&this.moveUpFloorsAnimate.stop(),!this.doubleClickFloorNodeFlag){this.doubleClickFloorNodeFlag=!0;for(var i=[],j=this,k=e.getChildren(),l=this.dataNodeMap[c.getId()],m=k.size()-1;m>=0;m--){var n=k.get(m),o=this.dataManager.getCategoryForData(n);if(o&&o.getId()&&o.getId().toLowerCase().indexOf("floor")>=0){var p=this.dataNodeMap[n.getId()];p&&p.getY()>l.getY()&&i.push(p)}}var q=this.network3d.getCamera();b&&(q=b.getCamera());var r=this.viewManager3d.getFocusNode(),s=f.getElementPerfectDistance(l),t=l.worldPosition(new mono.Vec3(0,1,1),s),u=f.getNodeCenterPosition(l),v=t.sub(u),w=function(){var a=j.viewManager3d.getFocusNode();if(a!=r)return void(this.doubleClickFloorNodeFlag=!1);var b=function(){l.orgScale&&l.setScale(l.orgScale),q.fov=60,j.toScene(h,c),c&&j.viewManager3d.setFocusNode(j.dataNodeMap[c.getId()]),j.doubleClickFloorNodeFlag=!1},d=new mono.Vec3;d.x=.05*v.x,d.y=.05*v.y,d.z=.05*v.z;var e=(new mono.Vec3).addVectors(d,u);mono.Utils.playCameraAnimation(q,e,u,1e3,b)};this.doubliClickFloorNodeAnimate=new mono.Animate({from:0,to:1,dur:1e3,easing:"easeOut",onUpdate:function(a){for(var b=i.length-1;b>=0;b--){var c=i[b],d=j.getNodeData(c),e=parseFloat(d.getPosition().y/10);c.setY(e+50+200*a)}},onDone:function(){w()}}),this.doubliClickFloorNodeAnimate.play()}}}},showFloorAnimate:function(a,b,c){if(a||!(a.length<1)){var d=this,e=d.getNodeData(b),f=this.viewManager3d.getDefaultEventHandler(),g=this.getNodeData(c),h=null;if(g&&(h=this.getSceneAndRootByData(g)),h&&h.scene&&h.scene.getCategoryId().toLowerCase().indexOf("floor")>=0){for(var i=h.rootData,j=parseFloat(i.getPosition().y/10)+50,k=[],l=a.length-1;l>=0;l--){var m=a[l],e=d.getNodeData(m),n=parseFloat(e.getPosition().y/10);n>j&&(n+=200,k.push(m)),n+=50,m.setY(n)}var o=new mono.Animate({from:0,to:1,dur:2e3,easing:"easeOut",onUpdate:function(a){for(var b=k.length-1;b>=0;b--){var c=k[b],e=d.getNodeData(c),f=parseFloat(e.getPosition().y/10);c.setY(f+50+200-200*a)}}}),p=function(){o.play()},q=f.getElementPerfectDistance(b),r=c.worldPosition(new mono.Vec3(0,1,1),q),s=f.getNodeCenterPosition(c),t=f.getNodeCenterPosition(b),u=this.network3d.getCamera(),v=r.sub(s),w=new mono.Vec3;w.x=.05*v.x,w.y=.05*v.y,w.z=.05*v.z;var x=(new mono.Vec3).addVectors(w,s);u.lookAt(s),u.setPosition(x),setTimeout(function(){mono.Utils.playCameraAnimation(u,r,t,2e3,p)},10)}else{f.lookAtWithOutMoveCamera=!1,this.moveUpFloorsAnimate=new twaver.Animate({from:0,to:1,dur:3e3,delay:1e3,easing:"elasticOut",onUpdate:function(b){for(var c=a.length-1;c>=0;c--){var e=a[c],f=d.getNodeData(e),g=parseFloat(f.getPosition().y/10);e.setY(g+50*b)}}});var p=function(){if(d.sceneChangeWithOutAnimate)for(var b=a.length-1;b>=0;b--){var c=a[b],e=d.getNodeData(c),f=parseFloat(e.getPosition().y/10);c.setY(f+50)}else d.moveUpFloorsAnimate.play()};f.moveCameraForLookAtNode(b,p)}}},hideFloorAnimate:function(a,b,c){if(!a&&a.length<1)return void(c&&c());this.doubliClickFloorNodeAnimate&&this.doubliClickFloorNodeAnimate.stop(),this.viewManager3d.getDefaultEventHandler().lookAtWithOutMoveCamera=!1,b&&(b.setStyle("m.transparent",!0),b.setStyle("m.opacity",.06));var d=this;this.moveDownFloorsAnimate=new twaver.Animate({from:0,to:1,dur:1e3,easing:"easeOut",onUpdate:function(b){for(var c=a.length-1;c>=0;c--){var e=a[c],f=d.getNodeData(e),g=parseFloat(f.getPosition().y/10)+50;e.setY(g-50*b)}},onStop:function(){b&&(b.setStyle("m.transparent",!1),b.setStyle("m.opacity",null)),c&&c()}}),this.moveDownFloorsAnimate.play()},switchToBuilding:function(a,b){if(a){var c=this.getNodeData(a);if(c){var d=a.getBoundingBox(),e=(a.getWorldPosition(),a.getScale()),f=c.getChildren();if(f&&!(f.size()<1)){var g=this,h=[];if(f&&f.size()>0){for(var i=10,j=10,k=0;k<f.size();k++){var l=f.get(k),m=this.dataManager.getCategoryForData(l);if(m&&m.getId()&&m.getId().toLowerCase().indexOf("floor")>=0){this.bindingBuildingAndFloorVisibleManager&&this.bindingBuildingAndFloorVisibleManager.setVisible(l,!0);var n=this.dataNodeMap[l.getId()];if(n){n.orgScale||(n.orgScale=n.getScale()),n.orgPosY||(n.orgPosY=n.getPositionY());var o=n.getBoundingBox();if(d&&o){var p=d.size(),q=o.size(),r=.1,s=.1;p&&q&&(r=p.x/q.x,s=p.z/q.z),i>r&&(i=r),j>s&&(j=s)}n.setPositionY(l.getPosition().y/10),this.viewManager3d.defaultMaterialFilter.removeByDescendant(l),delete this.doubleClickFloorNodeFlag,n.doubliClick=function(a,b,c,d){g.doubliClickFloorNode(a,b,c,d)},h.push(n)}}}for(var k=h.length-1;k>=0;k--)h[k].setScale(i*e.x,.1,j*e.z);this.showFloorAnimate(h,a,b),this.viewManager3d.defaultMaterialFilter.clear(),this.viewManager3d.defaultMaterialFilter.add(c)}}}}},switchToRealNode:function(a,b){if(a||b){var c=this.dataManager._sceneMap;for(var d in c){var e=c[d];if(e&&e.getCategoryId()&&e.getCategoryId().toLowerCase().indexOf("building")>=0)return}var f=this,g=this.getNodeData(a),h=this.dataManager.getCategoryForData(g),i=b?this.getNodeData(b):null,j=this.dataManager.getCategoryForData(i),k=this.network3d.getDataBox();if(h&&h.getId()&&h.getId().toLowerCase().indexOf("building")>=0&&j&&j.getId()&&j.getId().toLowerCase().indexOf("building")>=0){var l=i.getChildren();if(l&&l.size()>0)for(var m=0;m<l.size();m++){var n=l.get(m),o=this.dataManager.getCategoryForData(n);if(o&&o.getId()&&o.getId().toLowerCase().indexOf("floor")>=0){var p=this.dataNodeMap[n.getId()];p&&k.getDataById(p.getId())&&k.removeByDescendant(p)}}this.switchToBuilding(a,b)}else if(h&&h.getId()&&h.getId().toLowerCase().indexOf("building")>=0)this.switchToBuilding(a,b);else if(j&&j.getId()&&j.getId().toLowerCase().indexOf("building")>=0&&h!=j&&h&&h.getId()&&h.getId().toLowerCase().indexOf("datacenter")>=0){var q=i.getChildren();if(q&&q.size()>0){for(var r=[],m=0;m<q.size();m++){var n=q.get(m),o=this.dataManager.getCategoryForData(n);if(o&&o.getId()&&o.getId().toLowerCase().indexOf("floor")>=0){var p=this.dataNodeMap[n.getId()];r.push(p)}}var s=function(){for(var a=0;a<r.length;a++){var b=r[a],c=f.getNodeData(b);g!=c&&b&&k.getDataById(b.getId())&&k.removeByDescendant(b)}};h&&h.getId().toLowerCase().indexOf("datacenter")>=0?this.hideFloorAnimate(r,b,s):s(),this.viewManager3d.defaultMaterialFilter.clearAll()}}h&&h.getId()&&h.getId().toLowerCase().indexOf("datacenter")>=0&&this.bindingBuildingAndFloor(this._currentScene)}},getAlarmManagerClass:function(){return d.AlarmManager}});var y=function(a){};d.MaterialFilter=y,mono.extend(y,Object,{filterMaterial:function(a,b,c){return a}});var z=function(a){};mono.extend(z,Object,{isVisible:function(a,b,c){return!0}}),d.VisibleFilter=z;var A=function(a){this.sceneManager=a,this.sceneLights={},this.init()};mono.extend(A,Object,{init:function(){var a=this;this.sceneManager.addSceneChangeListener(function(b){var c=b.data;a.setUpLights(c)})},getDefaultLights:function(){var a={},b=new mono.AmbientLight(16777215);a.a=b;var c=new mono.PointLight(16777215,.05);c.setPosition(1e4,1e4,1e4),a.p1=c;var c=new mono.PointLight(16777215,.05);c.setPosition(-1e4,1e4,-1e4),a.p2=c;var c=new mono.PointLight(16777215,.05);c.setPosition(1e4,1e4,-1e4),a.p3=c;var c=new mono.PointLight(16777215,.05);c.setPosition(-1e4,1e4,1e4),a.p4=c;var c=new mono.PointLight(16777215,.05);c.setPosition(0,0,1e4),a.p5=c;var c=new mono.PointLight(16777215,.05);c.setPosition(0,0,-1e4),a.p6=c;var c=new mono.PointLight(16777215,.05);c.setPosition(1e4,0,0),a.p7=c;var c=new mono.PointLight(16777215,.05);return c.setPosition(0,0,-1e4),a.p8=c,a},setUpLights:function(a){var b={},c=a;this.clearLights(),a instanceof d.Scene&&(c=a.getId()),b=c&&this.sceneLights[c]?this.sceneLights[c]:this.getDefaultLights();var e=this.sceneManager.network3d.getDataBox();for(var f in b){var g=b[f];e.add(g)}},clearLights:function(){for(var a=this.sceneManager.network3d.getDataBox(),b=[],c=0;c<a.size();c++){var d=a.getLights().get(c);d&&b.push(d)}for(var c=0;c<b.length;c++){var d=b[c];a.remove(d)}},addSceneLight:function(a){if(a){var b=a.getSceneId(),c=a.getId(),d=null;a.getType().toLowerCase().indexOf("am")>=0?d=new mono.AmbientLight(a.getColor()):(d=new mono.PointLight(a.getColor(),a.getIntensity()||1,a.getDistance()||0),d.setPosition(a.getPosition()));var e=this.sceneLights[b];e?e[c]=d:this.sceneLights[b]={lightId:d}}},removeSceneLight:function(a){if(a){var b=a.geSceneId(),c=a.getId(),d=this.sceneLights[b];d&&delete d[c]}},addLightsFromJson:function(a){var b=a;"string"==typeof a&&(b=JSON.parse(a));var c=0,d=b.length;for(c=0;d>c;c++){var e=b[c],f=new p;f.fromJson(e),this.addSceneLight(f)}}}),d.LightManager=A,d.AlarmSeverity=function(a,b,c,e,f){d.Base.call(this),this.value=a,this.name=b,this.nickName=c,this.color=e,this.displayName=f},mono.extend(d.AlarmSeverity,d.Base,{IT_Alarm_Severity:!0}),function(){var a=d.AlarmSeverity;a.severities=new mono.List,a._vm={},a._nm={},a._cp=function(a,b){if(a&&b){var c=a.value-b.value;return c>0?1:0>c?-1:0}return a&&!b?1:!a&&b?-1:0},a.forEach=function(b,c){a.severities.forEach(b,c)},a.getSortFunction=function(){return a._cp},a.setSortFunction=function(b){a._cp=b,a.severities.sort(b)},a.add=function(b,c,d,e,f){var g=new a(b,c,d,e,f);return a._vm[b]=g,a._nm[c]=g,a.severities.add(g),a.severities.sort(a._cp),g},a.remove=function(b){var c=a._nm[b];return c&&(delete a._nm[b],delete a._vm[c.value],a.severities.remove(c)),c},a.CRITICAL=a.add(500,"Critical","C","#FF0000"),a.MAJOR=a.add(400,"Major","M","#FFA000"),a.MINOR=a.add(300,"Minor","m","#FFFF00"),a.WARNING=a.add(200,"Warning","W","#00FFFF"),a.INDETERMINATE=a.add(100,"Indeterminate","N","#C800FF"),a.CLEARED=a.add(0,"Cleared","R","#00FF00"),a.isClearedAlarmSeverity=function(a){return a?0===a.value:!1},a.getByName=function(b){return a._nm[b]},a.getByValue=function(b){return a._vm[b]},a.clear=function(){a.severities.clear(),a._vm={},a._nm={}},a.compare=function(b,c){return a._cp(b,c)}}(),d.Alarm=function(a,b,c,e,f){if(d.Base.call(this),this._id=a,this._dataId=b,this._alarmSeverity=c||d.AlarmSeverity.CRITICAL,this._dateTime=f,this._description=e,!this._alarmSeverity.IT_Alarm_Severity)throw"alarmSeverity is not it.AlarmSeverity"},mono.extend(d.Alarm,d.Base,{___accessor:["alarmSeverity","alarmType","description","dateTime"],IT_Alarm:!0,getId:function(){return this._id},getDataId:function(){return this._dataId},fromJson:function(a){a=a||"","string"==typeof a&&(a=JSON.parse(a)),this._id=a.id,this._dataId=a.dataId,this._alarmSeverity=e.getAlarmSeverityByLevel(a.level),this._dateTime=a.time,this._description=a.description}}),d.AlarmState=function(a){d.Base.call(this),this._data=a,this._selfHighestAlarmSeverity=null,this._selfAlarmCount=0,this._propagateHighestAlarmSeverity=null,this._propagateAlarmCount=0,this._highestAlarmSeverity=null,this._alarmCount=0},mono.extend(d.AlarmState,d.Base,{___accessor:["selfHighestAlarmSeverity","selfAlarmCount","propagateHighestAlarmSeverity","propagateAlarmCount","highestAlarmSeverity","alarmCount"],
IT_Alarm_Status:!0,clear:function(){this._selfHighestAlarmSeverity=null,this._selfAlarmCount=0,this._propagateHighestAlarmSeverity=null,this._propagateAlarmCount=0,this._highestAlarmSeverity=null,this._alarmCount=0}}),d.AlarmManager=function(a,b){d.Base.call(this),this._dataManager=a,this._sceneManager=b,this._alarmList=new mono.List,this._alarmMap={},this._dataAlarms={},this._dirtyDataAlarmState=[],this._alarmBillboardMap={},this._alarmNodeMap={},this._alarmManagerChangeDispatcher=new mono.EventDispatcher,this._alarmPropertyChangeDispatcher=new mono.EventDispatcher,this._sceneManager.addSceneManagerChangeListener(this.handleSceneManagerChange,this,!0),this._dataManager.addDataManagerChangeListener(this.handleDataManagerChange,this,!0),this.addAlarmPropertyChangeListener(this.handleAlarmPropertyChange,this,!0),this.addAlarmManagerChangeListener(this.handleAlarmManagerChange,this,!0)},mono.extend(d.AlarmManager,d.Base,{__accessor:["removeAlarmWhenDataIsRemoved"],_name:"AlarmBox",getAlarms:function(a,b){return this._alarmList.toList(a,b)},_calculateDataPropagateAlarmState:function(){for(;this._dirtyDataAlarmState.length>0;){var a=this._dirtyDataAlarmState.pop();this.calculateDataPropagateAlarmState(a)}},_setDataAlarmStateDirty:function(a){a._alarmRenderDirty=!0},_clearDataAlarmStateDirty:function(a){delete a._alarmRenderDirty},_isDataAlarmStateDirty:function(a){return a._alarmRenderDirty},_dirtyParentDataAlarmState:function(a){var b=this._dataManager.getParent(a);b&&this._dirtyDataAlarmState.push(b),this._dirtyDataAlarmState&&this._calculateDataPropagateAlarmState()},calculateDataAlarmState:function(a){var b=this.getDataAlarmState(a),c=a.getAlarmState(),e=c.getSelfAlarmCount(),f=c.getSelfHighestAlarmSeverity();(e!=b.alarmCount||0!=d.AlarmSeverity.compare(b.highestAlarmSeverity,f))&&(c.setSelfHighestAlarmSeverity(b.highestAlarmSeverity),c.setSelfAlarmCount(b.alarmCount),this._calculateDataAlarmState(a),this._dataManager.isStopAlarmPropagation(a)||this._dirtyParentDataAlarmState(a))},calculateDataPropagateAlarmState:function(a){var b=this._dataManager.getChildren(a),c={highestAlarmSeverity:null,alarmCount:0};if(b)for(var e=0;e<b.length;e++){var f=b[e],g=f.getAlarmState();c.alarmCount+=g.getAlarmCount(),c.highestAlarmSeverity=this._getHighestAlarmSeverity(c.highestAlarmSeverity,g.getHighestAlarmSeverity())}var g=a.getAlarmState(),h=g.getPropagateAlarmCount(),i=g.getPropagateHighestAlarmSeverity();(h!=c.alarmCount||0!=d.AlarmSeverity.compare(c.highestAlarmSeverity,i))&&(g.setPropagateAlarmCount(c.alarmCount),g.setPropagateHighestAlarmSeverity(c.highestAlarmSeverity),this._calculateDataAlarmState(a),this._dataManager.isStopAlarmPropagation(a)||this._dirtyParentDataAlarmState(a))},_calculateDataAlarmState:function(a){var b=a.getAlarmState(),c={highestAlarmSeverity:null,alarmCount:0};c.alarmCount=b.getSelfAlarmCount()+b.getPropagateAlarmCount(),c.highestAlarmSeverity=this._getHighestAlarmSeverity(c.highestAlarmSeverity,b.getSelfHighestAlarmSeverity()),c.highestAlarmSeverity=this._getHighestAlarmSeverity(c.highestAlarmSeverity,b.getPropagateHighestAlarmSeverity()),b.setAlarmCount(c.alarmCount),b.setHighestAlarmSeverity(c.highestAlarmSeverity),this._setDataAlarmStateDirty(a),this.renderDataAlarm(a)},_getHighestAlarmSeverity:function(a,b){return d.AlarmSeverity.compare(a,b)>0?a:b},renderDataAlarm:function(a){if(!this._sceneManager.isCurrentSceneInstance(a))return void this._setDataAlarmStateDirty(a);var b=this._sceneManager.getNodeByDataOrId(a);b&&this._isDataAlarmStateDirty(a)?this._renderAlarm(a,b):b||this._setDataAlarmStateDirty(a)},_renderAlarm:function(a,b){this._clearDataAlarmStateDirty(a);var c=this._sceneManager.getCurrentScene();if(c&&c.renderAlarm)return void c.renderAlarm(a,b);var d=this._dataManager.getCategoryForData(a);if(d&&d.renderAlarm)return void d.renderAlarm(a,b);var e=this._dataManager.getDataTypeForData(a);return e&&e.renderAlarm?void e.renderAlarm(a,b):void this.renderAlarm(a,b)},renderAlarm:function(a,b){var c=b;b.getClient("complexNode")&&(b=b.getClient("complexNode").getParent()?b.getClient("complexNode"):b.getClient("simpleNode"));var d=a.getAlarmState();if(d.getSelfAlarmCount()>0){var e=d.getSelfHighestAlarmSeverity();this._setNodeAlarmEffect(b,e),this._alarmNodeMap[b.getId()]=b;for(var f=b.getChildren(),g=f.size(),h=0;g>h;h++){var i=f.get(h);i.getClient("modelParent")&&(this._setNodeAlarmEffect(i,e),this._alarmNodeMap[i.getId()]=i)}}else if(b.getStyle("alarm.m.ambient")){this._clearNodeAlarmEffect(b),delete this._alarmNodeMap[b.getId()];for(var f=b.getChildren(),g=f.size(),h=0;g>h;h++){var i=f.get(h);i.getClient("modelParent")&&(this._clearNodeAlarmEffect(i),delete this._alarmNodeMap[i.getId()])}}b=c;var j=this._dataManager.getParent(a);if(d.getAlarmCount()>0&&(!j||this._dataManager.isStopAlarmPropagation(a))){var e=d.getHighestAlarmSeverity(),k=e.color,l=null;b._alarmBillboard?l=b._alarmBillboard:(l=b._alarmBillboard=this._sceneManager.createBillboard(a,new mono.Billboard),this._alarmBillboardMap[l.getId()]=l),l.setStyle("m.texture.image",mono.ImageCache.AlarmBillboardImage),l.setStyle("m.color",k),l.setStyle("m.alignment",mono.BillboardAlignment.bottomCenter),this._setAlarmBillboardPositionAndSize(b,l)}else b._alarmBillboard&&(this._sceneManager.removeBillboard(b._alarmBillboard),delete b._alarmBillboard,delete this._alarmBillboardMap[l.getId()])},_setAlarmBillboardPositionAndSize:function(a,b){var c=a.getStyle("alarm.billboard.position"),d=a.getBoundingBox(),e=d.min,f=d.max,g=d.center(),h=d.size();"topLeft"===c?b._position.set(e.x,f.y,g.z+1):"topRight"===c?b._position.set(f.x,f.y,g.z+1):"topBack"===c?b._position.set(g.x,f.y,e.z-1):"topFront"===c?b._position.set(g.x,f.y,f.z+1):b._position.set(g.x,f.y,g.z+1);var i=a.getStyle("alarm.billboard.scale");i instanceof mono.Vec3?b._scale.copy(i):b._scale.set(h.x/2,h.x/2,1);var j=a.getStyle("alarm.billboard.vertical");b.setStyle("m.vertical",j)},_setNodeAlarmEffect:function(a,b){var c=a.getStyle("alarm.m.ambient")||a.getStyle("m.ambient");a.setStyle("m.ambient",b.color),a.setStyle("alarm.m.ambient",c)},_clearNodeAlarmEffect:function(a){a.setStyle("m.ambient",a.getStyle("alarm.m.ambient")),a.setStyle("alarm.m.ambient",null)},_add:function(a){this._alarmList.add(a),this._alarmMap[a.getId()]=a;var b=this._dataAlarms[a.getDataId()];b||(b=this._dataAlarms[a.getDataId()]=new mono.List),b.add(a)},_remove:function(a){this._alarmList.remove(a),delete this._alarmMap[a.getId()];var b=this._dataAlarms[a.getDataId()];b&&b.remove(a),0==b.size()&&delete this._dataAlarms[a.getDataId()]},getAlarm:function(a){if(!a)return null;var b=null;return b=a.IT_Alarm?this._alarmMap[a.getId()]:this._alarmMap[a]},add:function(a){if(!a)throw"alarm is null or undefined";if(!a.getId())throw"alarm`s id is empty";if(!a.getDataId())throw"alarm`s dataId is empty";if(!a.IT_Alarm)throw"alarm`s class is not it.Alarm";var b=this._alarmMap[a.getId()];if(b)throw"alarm`s id repeat";var c=this._dataManager.getDataById(a.getDataId());c||(a.error="data is not exist",console.warn(a.error)),this._add(a),this._alarmManagerChangeDispatcher.fire({kind:"add",data:a}),a.addPropertyChangeListener(this.handleAlarmDataPropertyChange,this)},addAlarmFromJson:function(a){for(var b=e.toJsonArray(a),c=0,f=b.length;f>c;c++){var g=b[c],h=new d.Alarm;h.fromJson(g),this.add(h)}},remove:function(a){if(!a)throw"alarmOrId is null or undefined";var b=null;return(b=a.IT_Alarm?this._alarmMap[a.getId()]:this._alarmMap[a])?(this._remove(b),b.removePropertyChangeListener(this.handleAlarmDataPropertyChange,this),this._alarmManagerChangeDispatcher.fire({kind:"remove",data:b}),b):void console.warn("alarm is not exist")},clear:function(){var a=this._alarmList.toList();return this._alarmList.clear(),this._alarmMap={},this._dataAlarms={},this._dirtyDataAlarmState=[],this._alarmManagerChangeDispatcher.fire({kind:"clear",datas:a}),a},getAlarmsByDataOrId:function(a){if(!a)return[];var b=a;return a.IT_Data&&(b=a.getId()),this._dataAlarms[b]},removeAlarmsByDataOrId:function(a){var b=this.getAlarmsByDataOrId(a);return b&&b.forEach(this.remove,this),b},getDataByAlarmOrId:function(a){var b=this.getAlarm(a);if(!b)return null;var c=b.getDataId();return this._dataManager.getDataById(c)},getDataAlarmState:function(a){var b={highestAlarmSeverity:null,alarmCount:0},c=this.getAlarmsByDataOrId(a);return c&&(b.alarmCount=c.size(),c.forEach(function(a){if(b.highestAlarmSeverity){var c=a.getAlarmSeverity();d.AlarmSeverity.compare(c,b.highestAlarmSeverity)>0&&(b.highestAlarmSeverity=c)}else b.highestAlarmSeverity=a.getAlarmSeverity()})),b},handleAlarmManagerChange:function(a){if("add"===a.kind){var b=a.data,c=this._dataManager.getDataById(b.getDataId());c&&this.calculateDataAlarmState(c)}else if("remove"===a.kind){var b=a.data,c=this._dataManager.getDataById(b.getDataId());c&&this.calculateDataAlarmState(c)}else if("clear"===a.kind){var d=a.datas;if(d&&d.size()>0){var e={};d.forEach(function(a){e[a.getDataId()]=1});for(var f in e){var c=this._dataManager.getDataById(f);c&&c.getAlarmState().clear()}for(var g in this._alarmBillboardMap)this._sceneManager.removeBillboard(this._alarmBillboardMap[g]);this._alarmBillboardMap={};for(var g in this._alarmNodeMap)this._clearNodeAlarmEffect(this._alarmNodeMap[g]);this._alarmNodeMap={}}}},handleAlarmDataPropertyChange:function(a){this._alarmPropertyChangeDispatcher.fire(a)},handleAlarmPropertyChange:function(a){var b=a.source;if("alarmSeverity"===a.property){var c=this._dataManager.getDataById(b.getDataId());c&&this.calculateDataAlarmState(c)}},handleDataManagerChange:function(a){"add"===a.kind?this.calculateDataAlarmState(a.data):"remove"===a.kind?this.removeAlarmsByDataOrId(a.data):"clear"===a.kind},handleSceneManagerChange:function(a){var b=this;if("add"===a.kind){var c=a.data,d=this._sceneManager.getNodeData(c);setTimeout(function(){b.renderDataAlarm(d)},10)}else if("change"===a.kind){var c=a.data,d=this._sceneManager.getNodeData(c);this._setDataAlarmStateDirty(d),this.renderDataAlarm(d)}},addAlarmManagerChangeListener:function(a,b,c){this._alarmManagerChangeDispatcher.add(a,b,c)},removeAlarmManagerChangeListener:function(a,b){this._alarmManagerChangeDispatcher.remove(a,b)},addAlarmPropertyChangeListener:function(a,b,c){this._alarmPropertyChangeDispatcher.add(a,b,c)},removeAlarmPropertyChangeListener:function(a,b){this._alarmPropertyChangeDispatcher.remove(a,b)}}),d.AlarmStatePropagator=function(a,b,c){this._dataManager=a,this._sceneManager=b,this._alarmManager=c,this.dataBox=c.dataBox,this.alarmBox=c.alarmBox,mono.AlarmStatePropagator.call(this,this.dataBox,"alarmState"),this.dataBox.setAlarmStatePropagator(this),this.childrenAlarms=[]},mono.extend(d.AlarmStatePropagator,mono.AlarmStatePropagator,{propagateToTop:function(a){var b=!0;for(b=this.propagateToParent(null,a);a&&a.getParent()&&b!==!1;)b=this.propagateToParent(a,a.getParent()),a=a.getParent()},propagateToParent:function(a,b){var c=null==a?null:d.SceneManager.getNodeData(a),e=null==b?null:d.SceneManager.getNodeData(b);return e?this.dataPropagateToParent(c,e,a,b):!1},dataPropagateToParent:function(a,b,c,d){return this.dataPropagateToParentForRoom(a,b,c,d)},dataPropagateToParentForRoom:function(a,b,c,e){if(this.isStop(a))return!1;if(!b.getAlarmState)return!1;e.getClient("modelParent")&&(e=e.getClient("modelParent")),b.getAlarmState().setPropagateSeverity(null),e.getAlarmState().setPropagateSeverity(null);for(var f=b.getAlarmState().getHighestOverallAlarmSeverity(),g=b.getChildren(),h=g.size(),i=0;h>i;i++){var j=g.get(i),k=j.getAlarmState().getHighestOverallAlarmSeverity();d.AlarmSeverity.compare(k,f)>0&&(f=k)}if(b.getAlarmState().setPropagateSeverity(f),e.getClient("complexNode")){var l=e.getClient("complexNode").getParent()?e.getClient("complexNode"):e.getClient("simpleNode");l.getAlarmState().setPropagateSeverity(f)}this.modelChildAlarmSyn(a,b,c,e);var m=null==b?null:this.dataManager.getDataTypeForData(b);if(!m)return!1;if(m.isStopAlarmPropagationable())return!1;var n=this.dataManager.getCategoryForData(b);return n?n.isStopAlarmPropagationable()?!1:!0:!m.isStopAlarmPropagationable()},isStop:function(a){if(a){var b=this.dataManager.getDataTypeForData(a);if(b){if(b.isStopAlarmPropagationable())return!0;var c=this.dataManager.getCategoryForData(a);if(c&&c.isStopAlarmPropagationable())return!0}}return!1},modelChildAlarmSyn:function(a,b,c,d){d.getClient("complexNode")&&(d=d.getClient("complexNode").getParent()?d.getClient("complexNode"):d.getClient("simpleNode"));for(var e=d.getChildren(),f=e.size(),g=d.getAlarmState().getPropagateSeverity(),h=0;f>h;h++){var i=e.get(h);if(i.getClient("modelParent")){var j="child_alarm_"+i.getId();if(g){var k=this.alarmBox.getDataById(j);k?k.setAlarmSeverity(g):(k=new mono.Alarm(j,i.getId(),g),this.alarmBox.add(k)),i.getAlarmState().setPropagateSeverity(g)}else this.alarmBox.removeById(j),i.getAlarmState().setPropagateSeverity(null)}}}});var B=function(a){s.call(this),this.sceneManager=a,a||console.log("sceneManager can not be null!"),this.mode="lookat",this.filterFunction=null,this.defaultPostion=null,this.defaultTarget=null,this.defaultLookAtDistance=2e3,this.lookAtDistanceFunction=null,this.isLookAtFunction=null,this.afterLookAtFunction=null,this.afterLookAtFinishedFunction=null,this.box3d=a.network3d.getDataBox(),this.withOutAnimate=!1,this.lookAtWithOutMoveCamera=!0};mono.extend(B,s,{setDefaultPositionAndTarget:function(a,b){this.defaultPostion=a,this.defaultTarget=b},getDefaultVirtual:function(){return this.sceneManager.viewManager3d.getDefaultVirtualMaterialFilter()},setMode:function(a){this.mode=a},getCamera:function(){return this.sceneManager.network3d.getCamera()},isLookAtWithAngle:function(a){if(a&&a.getBoundingBox()){var b=a.getBoundingBox();if(b.max.x-b.min.x>500||b.max.y-b.min.y>500||b.max.z-b.min.z>500)return!0}return!1},getElementPerfectDistance:function(a,b){if(!a)return 100;b=1==b?!0:!1;var c=this.sceneManager.network3d.getCamera(),d=100,e=a.getBoundingBox();if(e){var f=e.max.y-e.min.y,g=e.max.x-e.min.x;b||(f*=a.getScaleY(),g*=a.getScaleX()),d=f>g?f:g}var h=d/(2*Math.tan(c.fov*Math.PI/180/2)),i=50;return h+=i},getElementPerfectFrontPosition:function(a){if(!a)return null;var b=this.getElementPerfectDistance(a);100>b&&(b=100);var c=a.frontWorldPosition(b);return c.y=c.y+20,c},getElementPerfectFrontPositionForNodeCenterPosition:function(a,c){if(!a)return null;var d=this.getElementPerfectDistance(a);100>d&&(d=100);var e=this.getNodeCenterPosition(a),f=null;return c==b&&(c=!0),c&&(f=new mono.Vec3(0,1,2)),f?e.add(a.direction(f).multiplyScalar(d)):e.add(a.frontDirection().multiplyScalar(d))},getNodeCenterPosition:function(a){if(!a)return null;var b=a.getBoundingBox(),c=(b.max.x+b.min.x)/2*a.getScaleX(),d=(b.max.y+b.min.y)/2*a.getScaleY(),e=(b.max.z+b.min.z)/2*a.getScaleZ(),f=a.getWorldPosition();return f.setX(f.x+c),f.setY(f.y+d),f.setZ(f.z+e),f},moveCameraForLookAtNode:function(a,b,c){if(a){var d=this.sceneManager.network3d.getCamera(),e=this.getNodeCenterPosition(a);e||(e=new mono.Vec3(0,0,0));var f=new mono.Vec3(e.x,e.y,e.z),g=this.getElementPerfectFrontPosition(a);if(this.isLookAtWithAngle(a)){var h=this.getElementPerfectDistance(a);g=a.worldPosition(new mono.Vec3(0,1,1),h);var i=0;a.getRotationY()&&(i=h*Math.sin(a.getRotationY())),g.x=f.x+i}c&&(g.x+=c.x,g.y+=c.y,g.z+=c.z),mono.Utils.playCameraAnimation(d,g,f,1e3,b)}},lookAtNodeWithOutAnimate:function(a){if(a&&a instanceof mono.Element){var b=this.sceneManager.network3d.getCamera(),c=this.getNodeCenterPosition(a);c||(c=new mono.Vec3(0,0,0));var d=this.getElementPerfectFrontPosition(a);if(this.isLookAtWithAngle(a)){var e=this.getElementPerfectDistance(a);d=a.worldPosition(new mono.Vec3(0,1,1),e);var f=0,g=0;a.getRotationY()&&(f=e*Math.sin(a.getRotationY()),g=e*(1-Math.cos(a.getRotationY()))),d.x=c.x+f,d.z=d.z-g}b.setPosition(d.x,d.y,d.z),b.lookAt(c.x,c.y,c.z)}},lookAtElements:function(a,b){if(!a||a.length<1)return null;1===a.length&&this.lookAt(a[0]),this.sceneManager.viewManager3d.setCameraDistance(null,1e4);for(var c,d,e,f,g,h,i=this.sceneManager.network3d.getCamera(),j=0;j<a.length;j++){var k=a[j];if(k){var l=k.getBoundingBox()||{min:{x:0,y:0,z:0},max:{x:0,y:0,z:0}},m=k.getWorldPosition();(!c||c>m.x+l.min.x)&&(c=m.x+l.min.x),(!d||d>m.y+l.min.y)&&(d=m.y+l.min.y),(!e||e>m.z+l.min.z)&&(e=m.z+l.min.z),(!f||f<m.x+l.max.x)&&(f=m.x+l.max.x),(!g||g<m.y+l.max.y)&&(g=m.y+l.max.y),(!h||h<m.z+l.max.z)&&(h=m.z+l.max.z)}}var n=new mono.Vec3(c+(f-c)/2,d+(g-d)/2,e+(h-e)/2),o=Math.sqrt((f-c)*(f-c)+(g-d)*(g-d)),p=o/(2*Math.tan(i.fov*Math.PI/180/2)),q=50;p+=q,500>p&&(p=500);var r=50;300>g-d&&(r=500);var s=new mono.Vec3(n.x,n.y+r,n.z+p);mono.Utils.playCameraAnimation(i,s,n,1e3,b)},getCenter:function(a,b){if(a||b){if(!a&&b)return b.getWorldPosition();if(!b&&a)return a.getWorldPosition();var c=a.getWorldPosition(),d=b.getWorldPosition(),e=d.x-c.x>0?c.x+(d.x-c.x)/2:d.x+(c.x-d.x)/2,f=d.y-c.y>0?c.y+(d.y-c.y)/2:d.y+(c.y-d.y)/2,g=d.z-c.z>0?c.z+(d.z-c.z)/2:d.z+(c.z-d.z)/2;return new mono.Vec3(e,f+50,g)}return null},getPerfectDistanceForNodes:function(a,b){if(a||b){if(!a&&b)return this.getElementPerfectDistance(b);if(!b&&a)return this.getElementPerfectDistance(a);var c=this.sceneManager.network3d.getCamera(),d=a.getWorldPosition(),e=b.getWorldPosition(),f=Math.abs(e.x-d.x),g=Math.abs(e.y-d.y),h=Math.abs(e.z-d.z),i=f;g>i&&(i=g),h>i&&(i=h);var j=i/(2*Math.tan(c.fov*Math.PI/180/2)),k=50;return j+=k,500>j&&(j=500),2*j}return null},moveCameraForLookAtLink:function(a,b){if(a){var c=this.sceneManager.network3d.getCamera(),d=this.sceneManager.getLinkData(a);if(!d)return void this.moveCameraForLookAtNode(a,b);var e=this.sceneManager.getNodeByDataOrId(d.getFromId()),f=this.sceneManager.getNodeByDataOrId(d.getToId()),g=this.getCenter(e,f),h=this.getPerfectDistanceForNodes(e,f),i=0;if(e&&f){var j=e.getWorldPosition(),k=f.getWorldPosition();i=Math.abs(j.y-k.y)>100?0:h*Math.tan(Math.PI/6)}var l=new mono.Vec3(g.x,g.y+i,g.z+h);mono.Utils.playCameraAnimation(c,l,g,1e3,b)}},_isLookAt:function(a){if(null!=this.isLookAtFunction)return this.isLookAtFunction(a);var b=this.sceneManager.getNodeData(a);return b?!0:!1},isDoLookAt:function(a){return a&&a.getClient("notLookAt")?!1:!0},lookAt:function(a,b){if(!a)return void(b&&b());if(!this.isDoLookAt(a))return void(b&&b());var c=this.sceneManager.getMainNode(a);if(c){if(!c&&this.sceneManager.isLink(a))c=a;else if(!this.box3d.getDataById(c.getId())){var d=this.sceneManager.getNodeData(c);this.sceneManager.loadLazyData(d)}if(this.sceneManager.viewManager3d.setFocusNode(c),!c||!this.box3d.getDataById(c.getId()))return void this.afterLookAt(c,a);var e=this,f=function(){e.openDoor(c,b),e.afterLookAtFinished(c,a)};this.lookAtWithOutMoveCamera?this.sceneManager.isLink(a)?this.moveCameraForLookAtLink(a,f):this.withOutAnimate?(this.lookAtNodeWithOutAnimate(c),f(),this.withOutAnimate=!1):this.moveCameraForLookAtNode(c,f):(f(),this.lookAtWithOutMoveCamera=!0),this.afterLookAt(c,a)}},afterLookAt:function(a,b,c){this.afterLookAtFunction&&this.afterLookAtFunction(a,b)},afterLookAtFinished:function(a,b){this.afterLookAtFinishedFunction&&this.afterLookAtFinishedFunction(a,b)},findOidfromChildren:function(a,b){if(a.getClient("type")==b)return a;for(var c=a.getChildren(),d=0;d<c.size();d++){var e=c.get(d);if(e.getClient("it_data")==a.getClient("it_data")){var f=this.findOidfromChildren(e,b,this);if(f)return f}}},findAllOidDatafromChildren:function(a,b){var c=[];if(a.getClient("type")==b)return c.push(a),c;for(var d=a.getChildren(),e=0;e<d.size();e++){var f=d.get(e);if(f.getClient("it_data")==a.getClient("it_data")){var g=this.findOidfromChildren(f,b);g&&c.push(g)}}return c},findRackDoorElementAtRack:function(a){return a?this.findAllOidDatafromChildren(a,"rack_door"):void 0},openDoor:function(a,b){var c=this.findRackDoorElementAtRack(a),d=!1;c&&c.length>0&&c.forEach(function(a){a&&a.getClient("animation")&&!a.getClient("animated")&&(d=!0,make.Default.playAnimation(a,a.getClient("animation"),b))}),!d&&b&&b()},closeDoor:function(a,b){var c=this.findRackDoorElementAtRack(a),d=!1;c&&c.length>0&&c.forEach(function(a){a&&a.getClient("animation")&&a.getClient("animated")&&(d=!0,make.Default.playAnimation(a,a.getClient("animation"),b))}),!d&&b&&b()},isFollow:function(a){if(a&&a.getBoundingBox&&a.getBoundingBox()){var b=a.getBoundingBox();if(b.max.x-b.min.x>500||b.max.y-b.min.y>500||b.max.z-b.min.z>500)return!0}return!1},moveToClickPoint:function(a){if(a){var b=this.getCamera();if(b){var c=a.point,d=b.getPosition().sub(b.getTarget()),e=(new mono.Vec3).addVectors(d,c);mono.Utils.playCameraAnimation(b,e,c,1e3)}}},moveToClickNode:function(a,b,c){if(a){c||(c=0);var d=this.getCamera();if(d){var e=this.getNodeCenterPosition(a),f=d.getPosition().sub(d.getTarget()),g=(new mono.Vec3).addVectors(f,e),h=(new mono.Vec3).subVectors(e,d.getTarget());Math.abs(h.x)>c||Math.abs(h.y)>c||Math.abs(h.z)>c?mono.Utils.playCameraAnimation(d,g,e,1e3,b):b&&b()}}},getElementPerfectBackPosition:function(a){if(!a)return null;var b=this.getElementPerfectDistance(a),c=a.worldPosition(new mono.Vec3(0,0,-1),b);return c&&(c.y=c.y+20),c},rotateElement:function(a){if(a){!a.isVisible()&&a.simpleRack&&(a=a.simpleRack);var b=this.sceneManager.network3d.getCamera(),c=null,d=a.getWorldPosition(),e=a.getClient("rotate_flage");e?(c=this.getElementPerfectFrontPosition(a),a.setClient("rotate_flage",!1)):(c=this.getElementPerfectBackPosition(a),a.setClient("rotate_flage",!0));var f=new mono.Vec3(d.x,d.y,d.z);mono.Utils.playCameraAnimation(b,c,f,2e3)}},shouldHandleDoubleClickElement:function(a,b,c,d){var e=this.sceneManager.viewManager3d.getFocusNode(),f=this.getDefaultVirtual();if(f&&f.isVirtual(a))return!1;var g=a.getClient("modelParent")||a;return this._isLookAt(g)&&e!=g?!0:this.isFollow(a)?!0:!1},shouldPropogateDoubleClickElement:function(a,b,c,d){return!1},shouldHandleDoubleClickBackground:function(a){return!0},shouldPropogateDoubleClickBackground:function(a){return!1},handleDoubleClickBackground:function(a){var b=this.sceneManager.viewManager3d.getFocusNode();if(b){if(this.sceneManager.isLink(b)){var c=this.sceneManager.getNodeData(b);c&&(b=c.getFromId()&&this.sceneManager.isCurrentSceneInstance(c.getFromId())?this.sceneManager.getNodeByDataOrId(c.getFromId()):c.getToId()?this.sceneManager.getNodeByDataOrId(c.getToId()):b.getFromNode())}var d=this.getParentFocusNode(b);if(d)return void this.lookAt(d)}},getParentFocusNode:function(a){var b=this.sceneManager.getNodeData(a);if(b&&b.getParentId()){var c=this.sceneManager.dataManager.getDataById(b.getParentId());if(!c)return;var d=this.sceneManager.dataNodeMap[b.getParentId()];return d}},handleDoubleClickElement:function(a,b,c,d){var e=a.getClient("modelParent")||a,f=this.sceneManager.viewManager3d.getFocusNode();if(c&&d.distance>2500){var g=this.sceneManager.dataManager.getDataById(c.getParentId()),h=this.sceneManager.getNodeByDataOrId(c.getParentId());if(g&&h&&h!=f){var i=this.sceneManager.dataManager.getCategoryForData(g);i&&i.getId().indexOf("channel")>=0&&(e=h)}}this._isLookAt(e)&&f!=e?this.lookAt(e):this.isFollow(a)&&this.moveToClickPoint(d)},lookAtByData:function(a,b){if(!a)return void b();var c=this.sceneManager.getNodeByDataOrId(a);if(c)return void this.lookAt(c,b);var d=this.sceneManager.getSceneAndRootByData(a);d&&(this.sceneManager.gotoScene(d.scene,d.rootData),d.rootData!=a?(c=this.sceneManager.dataNodeMap[a.getId()],c||this.sceneManager.loadLazyData(a)):c=null),this.lookAt(c,b)}}),d.DefaultEventHandler=B;var C=function(a){y.call(this),this.sceneManager=a,this.opacityValue=.06,this.focusElement=null,this.virtualFilter=null,this.materialMap={},this.isDealWithFunction=null,this._global_tmap={},this._global_linkTmap={},this._tmap={},this._linkTmap={},this._billboard_tmap={},this._link_tmap={},this.sceneManager.network3d.setSelectTransparencyThreshold(this.opacityValue+.1),this.dealWithLinkFunction=null,this.virtualFunction=null};mono.extend(C,y,{clearGlobal:function(){this._global_tmap={},this._global_linkTmap={},this.sceneManager._sceneVirtualChangeDispather.fire({type:"clearGlobal"})},clear:function(){this._tmap={},this._linkTmap={},this.sceneManager._sceneVirtualChangeDispather.fire({type:"clear"})},clearAll:function(){this._tmap={},this._linkTmap={},this._global_tmap={},this._global_linkTmap={},this.sceneManager._sceneVirtualChangeDispather.fire({type:"clearAll"})},isDealWith:function(a){return null!=this.isDealWithFunction?this.isDealWithFunction(a):!0},isVirtualOther:function(a){return this.virtualFunction?this.virtualFunction(a):!0},isDealWithLink:function(a){return this.dealWithLinkFunction?this.dealWithLinkFunction(a):!1},getBId:function(a){return a&&this.isDealWith(a)?"string"==typeof a?a:a.getId():null},addGlobal:function(a){if(a instanceof d.Link)return void this.addGlobalLink(a);var b=this.getBId(a);b&&(this._global_tmap[b]=!0)},addGlobalLink:function(a){this.getBId(a)},addGlobalByDescendant:function(a){if(a&&(a instanceof mono.Element&&(a=this.getDataByNode(a)),a&&a.getId())){this.addGlobal(a);var b=this.sceneManager.dataNodeMap[a.getId()],c=b.getChildren();if(c&&c.size()>0)for(var d=0;d<c.size();d++){var e=c.get(d),f=this.getDataByNode(e);f&&this.getBId(f)!=this.getBId(a)&&this.addGlobalByDescendant(e,this)}}},removeGlobal:function(a){var b=this.getBId(a);b&&(a instanceof d.Link?delete this._global_linkTmap[b]:delete this._global_tmap[b])},removeGlobalByDescendant:function(a){if(a&&(a instanceof mono.Element&&(a=this.getDataByNode(a)),a&&a.getId())){this.removeGlobal(a);var b=this.sceneManager.dataNodeMap[a.getId()],c=b.getChildren();if(c&&c.size()>0)for(var d=0;d<c.size();d++){var e=c.get(d),f=this.getDataByNode(e);f&&this.getBId(f)!=this.getBId(a)&&this.removeGlobalByDescendant(e,this)}}},add:function(a){var b=this.getBId(a);b&&(a instanceof d.Link||(this._tmap[b]=!0))},addLink:function(a){if(a){this.getBId(a)}},getDataByNode:function(a){return a?a.getClient(d.SceneManager.CLIENT_IT_DATA):null},addByDescendant:function(a){if(a&&(a instanceof mono.Element&&(a=this.getDataByNode(a)),a&&a.getId())){this.add(a);var b=this.sceneManager.dataNodeMap[a.getId()],c=b.getChildren();if(c&&c.size()>0)for(var d=0;d<c.size();d++){var e=c.get(d),f=this.getDataByNode(e);f&&this.getBId(f)!=this.getBId(a)&&this.addByDescendant(e,this)}}},remove:function(a){var b=this.getBId(a);if(b)if(a instanceof d.Link)delete this._linkTmap[b];else{if(a.getAllLinks){var c=a.getAllLinks();if(c)for(var e in c)delete this._linkTmap[e]}delete this._tmap[b]}},removeByDescendant:function(a){var b=a;if(b&&(b instanceof mono.Element&&(b=this.getDataByNode(b)),b&&b.getId())){this.remove(b);var c=this.sceneManager.dataNodeMap[b.getId()];b instanceof d.Link&&(c=this.sceneManager.linkMap[b.getId()]);var e=this;!c||!c.getChildren;var f=null;if(b.getChildren&&(f=b.getChildren(),f&&f.size()>0))for(var g=0;g<f.size();g++){var h=f.get(g);h&&e.getBId(h)!=e.getBId(b)&&e.removeByDescendant(h,e)}}},addAll:function(){this.addAllData(),this.addAllLink(),this.sceneManager._sceneVirtualChangeDispather.fire({type:"addAll"})},addAllData:function(){var a=this.sceneManager.dataManager.getDataMap();if(a){for(var b in a){var c=a[b];c&&this.add(c)}this.sceneManager._sceneVirtualChangeDispather.fire({type:"addAllData"})}},addAllLink:function(){var a=this.sceneManager.dataManager.getLinkMap();if(a){for(var b in a){var c=a[b];c&&this.addLink(c)}this.sceneManager._sceneVirtualChangeDispather.fire({type:"addAllLink"})}},isDealWithBillboard:function(a){return!0},isVirtual:function(a){var b=a;if(a instanceof mono.Element&&(b=this.getDataByNode(a)),!(b instanceof d.Data||b instanceof d.Link))return!0;var c=this.getBId(b),e=!1;return c&&(a instanceof mono.Link?this._global_linkTmap[c]?e=this._global_linkTmap[c]:this._linkTmap[c]&&(e=this._linkTmap[c]):this._global_tmap[c]?e=this._global_tmap[c]:this._tmap[c]&&(e=this._tmap[c])),e},isLink:function(a){return a&&a.getClient(d.SceneManager.CLIENT_IT_DATA)&&a.getClient(d.SceneManager.CLIENT_IT_DATA)instanceof d.Link?!0:!1},isHideVirtualBillboard:function(a){if(a&&a instanceof mono.Billboard&&a.getParent()){var b=a.getParent();if(b._alarmBillboard==a)return!0}return!1},setFocusElement:function(a){},setOpacityValue:function(a){a&&(this.opacityValue=a)},destoryBillboard:function(){if(this._billboard_tmap)for(var a in this._billboard_tmap){var c=this._billboard_tmap[a];if(c.hasOwnProperty("orig_opacity")){var d=c.orig_opacity;d==b&&(d=1),c.setStyle("m.opacity",d),this.isHideVirtualBillboard(c)&&c.setVisible(!0),delete c.orig_opacity,c.renderDepth=0,delete this._billboard_tmap[c.getId()]}}},filterMaterial:function(a,c,e){if(!this.isLink(e)&&e instanceof mono.Line)return a;var f=this.materialMap,g=c?c:a,h=this.getDataByNode(e);!h&&e instanceof mono.Billboard&&e.getParent()&&(h=this.getDataByNode(e.getParent()));var i=this.opacityValue,j="",k=!1;if(h&&h instanceof d.Link&&this.isDealWithLink())return j=this.getBId(h),j&&(this._global_linkTmap[j]?k=this._global_linkTmap[j]:this._linkTmap[j]&&(k=this._linkTmap[j])),k?(this._link_tmap[e.getId()]=e.isVisible(),e.setVisible(!1)):(null!=this._link_tmap[e.getId()]||this._link_tmap[e.getId()]!==b)&&(e.setVisible(this._link_tmap[e.getId()]),delete this._link_tmap[e.getId()]),g;if(h&&h instanceof d.Data&&(j=this.getBId(h)),j&&(this._global_tmap[j]?k=this._global_tmap[j]:this._tmap[j]&&(k=this._tmap[j])),e instanceof mono.Billboard&&this.isDealWithBillboard(e)){if(k)e.renderDepth=1e4,e.hasOwnProperty("orig_opacity")||(e.orig_opacity=e.getStyle("m.opacity")),this._billboard_tmap[e.getId()]=e,e.setStyle("m.opacity",i),this.isHideVirtualBillboard(e)&&e.setVisible(!1);else if(e.hasOwnProperty("orig_opacity")&&this._billboard_tmap[e.getId()]){var l=e.orig_opacity;l==b&&(l=1),e.setStyle("m.opacity",l),this.isHideVirtualBillboard(e)&&e.setVisible(!0),delete e.orig_opacity,e.renderDepth=0,delete this._billboard_tmap[e.getId()]}return g}if(!k)return g;var m=c?c.getUniqueCode():a.getUniqueCode();if(null==f[m]){var n=c?c.clone():a.clone();return n.transparent=!0,n.opacity=this.opacityValue,f[m]=n,n}return f[m]}}),d.VirtualManager=C;var D=function(){};mono.extend(D,Object,{isSelectable:function(a,b){return!0}}),d.SelectableFilter=D;var E=function(a){this.virtualManager=a};mono.extend(E,D,{isSelectable:function(a,b){return this.virtualManager.isVirtual(a)?!1:a instanceof mono.Line?!1:!0}}),d.SelectableManager=E;var F=function(a){this.dataManager=a,this.descentdantMap={},this.ancesstorIdsMap={},this.init()};mono.extend(F,Object,{init:function(){},getGetMethod:function(a){var b="get"+a.charAt(0).toUpperCase()+a.slice(1);return b},getDatas:function(){return this.dataManager.getDatas()},getDataById:function(a){return this.dataManager.getDataById(a)},getDataByKey:function(a,b){if(!a&&!b)return null;var c=!1;a.toUpperCase().startsWith("U:")&&(c=!0,a=a.slice(2));for(var d,e=this.getGetMethod(a),f=0,g=this.getDatas();f<g.length;f++){if(d=g[f],c){var h=d.getUserData(a);if(h==b)return d}else if(null==d[e]){var h=d.getUserData(a);if(h==b)return d}if(d[e]()==b)return d;if("ancestor"===a&&this.isChild(d,b,this))return d}return null},isChild:function(a,b,c){if(!a||!b)return!1;if(a.getId()==b)return!0;if(a.getParentId()==b)return!0;if(a.getParentId()){var d=this.dataManager.getDataById(a.getParentId()),c=c||this;return c.isChild(d,b,c)}return!1},filter:function(a){return!0},find:function(a){var b=this.getDatas(),c=[];if(!a||a.length<1){for(var d=0;d<b.length;d++)this.filter(b[d])&&c.push(b[d]);return c}for(var e,d=0,f=b.length;f>d;d++)e=b[d],this.filter(e)&&this.isDataConformConditions(e,a)&&c.push(e);return c},isDataConformConditions:function(a,b){var c=!0;for(var d in b)if(!this.isDataConformCondition(a,b[d])){c=!1;break}return c},isDataConformCondition:function(a,b,c){if(""==b.value||null==b.value)return!0;var c=c||b.key,d=b.dataType||"string";if(c.indexOf(",")>0){for(var e=c.split(","),f=0;f<e.length;f++)if(this.isDataConformCondition(a,b,e[f]))return!0;return!1}var g=!1;c.toUpperCase().startsWith("U:")&&(g=!0,c=c.slice(2));var h=this.getGetMethod(c);null==a[h]&&(g=!0);var i=b.operation,j=b.value,k=null;if(g||null==a[h])k=a.getUserData(c);else{
var h=this.getGetMethod(c);k=a[h]()}if(!k&&"ancestor"===c&&this.isChild(a,b.value,this))return!0;var l=this[i];return"function"==typeof l?this[i](j,k,c):this.other(j,k,c,i,d)},equal:function(a,b,c){return a&&b?a.toLowerCase()==b.toLowerCase():b==a},like:function(a,b,c){return b+="",b.startsWith?a?b.toLowerCase().startsWith(a.toLowerCase()):b.startsWith(a):!1},between:function(a,b,c){return a[0]||a[1]?null==a[0]?b<=a[1]:null==a[1]?b>=a[0]:b>=a[0]&&b<=a[1]:!1},other:function(a,b,c,d,e){if(!d)return this.like(a,b,c);if(e=e||"string",a&&b){"number"==e?(b=parseFloat(b),a=parseFloat(a)):"number"==typeof b&&(b+="");var d=d.trim();if(">"==d)return b>a;if("<"==d)return a>b;if("<="==d)return a>=b;if(">="==d)return b>=a;if("="==d)return b.toLowerCase()==a.toLowerCase()}return this.like(a,b,c)},descentdantOf:function(a,b,c){if("id"!==c)throw"Only id support descentdantOf";var d=this.getDataById(a),e=this.getDataById(b);if(null==d||null==e)return!1;var f=this.dataManager.getAncestors(e)||[];return-1!==f.indexOf(d)}}),d.DataFinder=F,d.PowerCapacityManager=function(a){this.sceneManager=a,this.dataManager=this.sceneManager.dataManager,this.visibleManager=new G(this.sceneManager),this.sceneManager.viewManager3d.addVisibleFilter(this.visibleManager)},mono.extend(d.PowerCapacityManager,Object,{computePowerPercent:function(a){var b=this.dataManager,c=a;c.getId||(c=b.getDataById(a));var d=b.getDataTypeForData(c);if(d){var e=d.getPowerRating();if(null==e||0==e)return null;var f,g=0,h=c.getChildren();return h.forEach(function(a){f=a.getPower()||0,g+=f}),g/e}},createPowerNode:function(a){var b=this.sceneManager,c=this.dataManager,d=a,e=b.network3d.getDataBox();if(b.isCurrentSceneInstance(a)){d.getId||(d=c.getDataById(a));var f=this.computePowerPercent(a);if(null!=f){var g,h=b.getNodeByDataOrId(d),i=h.getBoundingBox(),j=i.size(),k=j.x,l=j.y,m=j.z,n=h.getClient("powerNode");f=f||.01,n||(n=new mono.Cube(k-.2,l,m-.2),g=new mono.Cube(k,l,m),g.setParent(n),n.s({"m.type":"phong"}),g.s({"m.wireframe":!0,"m.wireframeLinewidth":1,"m.color":"white"}),n.setClient("child",g));var o=this.getPowerNodeColor(f);return n.s({"m.color":o,"m.ambient":o,"m.specularStrength":30}),n.setParent(h),n.setScale(1,f,1),n.setY(l*f/2-l/2),n.setClient("powerChildNode",!0),h.setClient("powerNode",n),n.setClient("it_data","power"),e.addByDescendant(n),this.makeItDataUnvisible(d),n}}},makeItDataUnvisible:function(a){if(a){this.visibleManager.setVisible(a,!1);var b=this;a.getChildren().forEach(function(a){b.makeItDataUnvisible(a)})}},makeItDataVisible:function(a){if(a){this.visibleManager.setVisible(a,!0);var b=this;a.getChildren().forEach(function(a){b.makeItDataVisible(a)})}},removePowerNode:function(a){var b=this.sceneManager,c=this.dataManager,d=a,e=b.network3d.getDataBox();d.getId||(d=c.getDataById(a));var f=b.getNodeByDataOrId(a);if(f){var g=f.getClient("powerNode");g&&(g.setParent(null),e.removeByDescendant(g)),this.makeItDataVisible(d)}},getPowerNodeColor:function(a){if(this.powerNodeColorFunction){var b=this.powerNodeColorFunction(a);return b}var b;return b=.25>a?"green":a>=.25&&.75>=a?"orange":"red"},isPowerAvailabe:function(){}}),d.WeightCapacityManager=function(a){this.sceneManager=a,this.dataManager=this.sceneManager.dataManager,this.visibleManager=new G(this.sceneManager),this.sceneManager.viewManager3d.addVisibleFilter(this.visibleManager)},mono.extend(d.WeightCapacityManager,Object,{computeWeightPercent:function(a){var b=this.dataManager,c=a;c.getId||(c=b.getDataById(a));var d=b.getDataTypeForData(c);if(d){var e=d.getWeightRating();if(null==e||0==e)return null;var f=this.computeChildrenWeight(c);return f/e}},computeChildrenWeight:function(a){var b=this.dataManager,c=this,d=a;d.getId||(d=b.getDataById(a));var e,f=0,g=d.getChildren();return g.forEach(function(a){e=a.getWeight()||0,f+=e;var b=a.getChildren();b&&b.size()>0&&(f+=c.computeChildrenWeight(a))}),f},createWeightNode:function(a){var b=this.sceneManager,c=this.dataManager,d=a,e=b.network3d.getDataBox();if(b.isCurrentSceneInstance(a)){d.getId||(d=c.getDataById(a));var f=b.getNodeByDataOrId(d),g=this.computeWeightPercent(d);if(null!=g){d._weightPercent=g;var h,i=f.getBoundingBox(),j=i.size(),k=j.x,l=j.y,m=j.z,n=f.getClient("weightNode");g=g||.01,n||(n=new mono.Cube(k-.2,l,m-.2),h=new mono.Cube(k,l,m),h.setParent(n),n.s({"m.type":"phong"}),h.s({"m.wireframe":!0,"m.wireframeLinewidth":1,"m.color":"white"}),n.setClient("child",h));var o=this.getWeightNodeColor(g);return n.s({"m.color":o,"m.ambient":o,"m.specularStrength":30}),n.setParent(f),n.setScale(1,g,1),n.setY(l*g/2-l/2),n.setClient("weightChildNode",!0),f.setClient("weightNode",n),n.setClient("it_data","weight"),e.addByDescendant(n),this.makeItDataUnvisible(d),n}}},makeItDataUnvisible:function(a){if(a){this.visibleManager.setVisible(a,!1);var b=this;a.getChildren().forEach(function(a){b.makeItDataUnvisible(a)})}},makeItDataVisible:function(a){if(a){this.visibleManager.setVisible(a,!0);var b=this;a.getChildren().forEach(function(a){b.makeItDataVisible(a)})}},removeWeightNode:function(a){var b=this.sceneManager,c=this.dataManager,d=a,e=b.network3d.getDataBox();d.getId||(d=c.getDataById(a)),delete d._weightPercent;var f=b.getNodeByDataOrId(a);if(f){var g=f.getClient("weightNode");g&&(g.setParent(null),e.removeByDescendant(g)),this.makeItDataVisible(d)}},getWeightNodeColor:function(a){if(this.weightNodeColorFunction){var b=this.weightNodeColorFunction(a);return b}var b;return b=.25>a?"green":a>=.25&&.75>=a?"orange":"red"},isWeightAvailabe:function(){}}),d.CameraFollow=function(a){function b(b,c){var d=b.property;if(d.startsWith("position")||d.startsWith("rotation")){var e=c.p(),f=a.getDistance(),g=c.worldPosition(new mono.Vec3(-2,1,0),f);a.lookAt(e),a.setPosition(g)}}this.setHost=function(c){a._hostNode&&a._hostNode.removePropertyChangeListener(b),a._hostNode=c,c.addPropertyChangeListener(function(a){b(a,c)})}},d.InspectionManager=function(a){d.EventHandler.call(this),this.sceneManager=a,this.visibleManager=new d.VisibleManager(a),a.viewManager3d.addVisibleFilter(this.visibleManager),this.dataManager=this.sceneManager.dataManager,this.camera=this.sceneManager.network3d.getCamera(),this.box=this.sceneManager.network3d.getDataBox(),this.status=d.InspectionManager.STATUS_READY,this.host=null,this.path=[],this.animates=[],this.loop=!1,this.finalAngle=null,this.limitDistance=200,this.limitAngle=40,this.inspectDataArray=[],this.inspectDataMap={},this.currentInspectDataArray=[],this.currentInspectingDataMap={},this.inspectColor="orange",this.moveSpeed=10,this.rotateSpeed=400,this.showTrail=!0,this.trailColor="green",this.trailWidth=20,this.trailHeight=3,this.hideDataMap={},this.isCameraFollow=!0,this.cameraFollow=null},d.InspectionManager.STATUS_READY="ready",d.InspectionManager.STATUS_PLAYING="playing",d.InspectionManager.STATUS_PAUSE="pause",d.InspectionManager.STATUS_STOP="stop",mono.extend(d.InspectionManager,d.EventHandler,{renderDataHandle:function(a){},resetDataHandler:function(a){},createTrail:function(a,b,c,d){var e=new mono.Path;e.moveTo(a[0][0],a[0][1]);for(var f=1;f<a.length;f++)e.lineTo(a[f][0],a[f][1]);e=mono.PathNode.prototype.adjustPath(e,20),b=b||this.trailWidth,c=c||this.trailHeight,d=d||this.trailColor;var g=new mono.PathCube(e,b,c);return g.s({"m.type":"phong","m.specularStrength":30,"m.color":d,"m.ambient":d,"m.texture.repeat":new mono.Vec2(150,1)}),g.setRotationX(Math.PI),g.setPositionY(c/2+4),g.setClient("type","trail"),g},play:function(){return this.isPlaying()?void console.warn("it is already playing"):this.isPause()?void console.warn("status is pause, you should call resume function"):(this.startPlay(),void(this.status=d.InspectionManager.STATUS_PLAYING))},pause:function(){if(this.isPlaying()){var a=this.getCurrentAnimate();a.pause(),this.status=d.InspectionManager.STATUS_PAUSE}else console.warn("when inspection status is playing, you can pause inspection")},resume:function(){if(this.isPause()){var a=this.getCurrentAnimate();a.resume(),this.status=d.InspectionManager.STATUS_PLAYING}else console.warn("when inspection status is pause, you can resume inspection")},stop:function(a){if(this.isPlaying()||this.isPause()){if(!a){var b=this.getCurrentAnimate();b.stop()}this.resetHideData(),this.resetInspectData(),this.onFinish(),this.trail&&this.box.remove(this.trail),delete this.animates,delete this.trail,delete this.host.animate,this.status=d.InspectionManager.STATUS_STOP}else console.warn("inspection is not started")},setPath:function(a){this.path=a},setHost:function(a){this.host=a},isReady:function(){return this.status==d.InspectionManager.STATUS_READY},isPlaying:function(){return this.status==d.InspectionManager.STATUS_PLAYING},isPause:function(){return this.status==d.InspectionManager.STATUS_PAUSE},isStop:function(){return this.status==d.InspectionManager.STATUS_STOP},onFinish:function(){console.log("inspection is completed")},startPlay:function(){var a=this,b=(this.sceneManager,this.camera),c=this.box;this.initInspectData();var e=this.host;if(this.isCameraFollow){var f=this.cameraFollow||new d.CameraFollow(b);f.setHost(e)}var g=this.path;e.setPositionX(g[0][0]),e.setPositionZ(g[0][1]);var h=this.animates=this.createPathAnimates(b,e,g,this.loop,this.finalAngle);h[h.length-1].onDone=function(){a.stop(!0)},this.hideData(),this.showTrail&&(a.createTrail&&(this.trail=a.createTrail(this.path)),this.trail&&(this.trail.setParent(this.host.getParent()),c.add(this.trail))),e.animate=h[0],e.animate.play()},hideData:function(){var a=this,b=Object.keys(this.hideDataMap);b.forEach(function(b){var c=a.hideDataMap[b];a.visibleManager.setVisible(c,!1)})},resetHideData:function(){var a=this,b=Object.keys(this.hideDataMap);b.forEach(function(b){var c=a.hideDataMap[b];a.visibleManager.setVisible(c,!0)})},initInspectData:function(){this.inspectDataArray=[],this.inspectDataMap={},this.hideDataMap={},this.box.getNodes().forEach(function(a){var b=this.sceneManager.getNodeData(a);b&&!this.inspectDataMap[b.getId()]&&this.isInspect(b)&&(this.initDataPositionAndRotation(b),this.inspectDataMap[b.getId()]=b,this.inspectDataArray.push(b)),b&&!this.hideDataMap[b.getId()]&&this.isHideInInspection(b)&&(this.hideDataMap[b.getId()]=b)},this)},getCurrentAnimate:function(){return this.host?this.host.animate:null},createPathAnimates:function(a,c,d,e,f){var g=[],h=this.moveSpeed||10,i=this.rotateSpeed||400;if(d&&d.length>=2){for(var j=c.getRotationY()||0,k=1;k<d.length;k++){var l=d[k-1],m=d[k],n=l[0],o=l[1],p=m[0],q=m[1],r=Math.atan2(-(q-o),p-n)||0,s=this.createRotateAnimate(a,c,i,r,j);s&&(g.push(s),j=s.toAngle);var t=this.createMoveAnimate(a,c,h,n,o,p,q);g.push(t),n=p,o=q}if(f!=b&&j!=f){var s=this.createRotateAnimate(a,c,i,f,j);s&&g.push(s)}}for(var u,k=0;k<g.length;k++)k>0?(g[k-1].chain(g[k]),e&&k==g.length-1&&g[k].chain(u)):u=g[k];return g},createMoveAnimate:function(a,b,c,d,e,f,g){var h=this,i=new twaver.Animate({from:{x:d,y:e},to:{x:f,y:g},type:"point",dur:Math.sqrt((f-d)*(f-d)+(g-e)*(g-e))*c,easing:"easeNone",onPlay:function(){b.animate=this,h.currentInspectDataArray=h.getCurrentInspectionData(this),h.resetInspectData()},onUpdate:function(a){b.setPositionX(a.x),b.setPositionZ(a.y),h.renderInspectData()}});return i},createRotateAnimate:function(a,c,d,e,f){if(f=parseFloat(f),e=parseFloat(e),f===b||null===f||isNaN(f)||e===b||null===f||isNaN(e)||e==f)return null;e-f>Math.PI&&(e-=2*Math.PI),e-f<-Math.PI&&(e+=2*Math.PI);var g=new twaver.Animate({from:f,to:e,type:"number",dur:Math.abs(e-f)*d,easing:"easeNone",onPlay:function(){c.animate=this},onUpdate:function(a){a=a||0,c.setRotationY(a)}});return g.toAngle=e,g},renderData:function(a){if(!a._inspected){a._inspected=!0;var b=this.sceneManager.getNodeByDataOrId(a);b.getClient("complexNode")&&(b=b.getClient("complexNode").getParent()?b.getClient("complexNode"):b.getClient("simpleNode"));var c=b.getStyle("inspection.m.ambient")||b.getStyle("m.ambient");b.setStyle("m.ambient",this.inspectColor),b.setStyle("inspection.m.ambient",c),this.renderDataHandle&&this.renderDataHandle(a)}},resetData:function(a){if(a._inspected){a._inspected=!1,delete a._inspected,delete a._face2animateLine,delete a._distance2host;var b=this.sceneManager.getNodeByDataOrId(a);b.getClient("complexNode")&&(b=b.getClient("complexNode").getParent()?b.getClient("complexNode"):b.getClient("simpleNode")),b.setStyle("m.ambient",b.getStyle("inspection.m.ambient")),b.setStyle("inspection.m.ambient",null),this.resetDataHandler&&this.resetDataHandler(a)}},renderInspectData:function(){var a=!1,b=this,c=[];this.currentInspectDataArray.forEach(function(a){b.isClosed(a,b.host)&&c.push(a)});var d=this.filterInspectData(c),e={};d.forEach(function(a){e[a.getId()]=a}),d.forEach(function(c){b.currentInspectingDataMap[c.getId()]||(b.renderData(c),b.currentInspectingDataMap[c.getId()]=c,a=a||!0)});var f=Object.keys(this.currentInspectingDataMap);return f.length>0&&f.forEach(function(c){e[c]||(b.resetData(b.currentInspectingDataMap[c]),delete b.currentInspectingDataMap[c],a=a||!0)}),a},resetInspectData:function(){var a=this,b=Object.keys(this.currentInspectingDataMap);b.length>0&&b.forEach(function(b){a.resetData(a.currentInspectingDataMap[b]),delete a.currentInspectingDataMap[b]})},filterInspectData:function(a){if(a.length<=1)return a;var c=[];a.sort(function(a,b){return a._distance2host-b._distance2host});for(var d=0;d<a.length;d++){var e=a[d];e._face2animateLine!==b&&(this.haveSameDir(e,c)||c.push(e))}return c},haveSameDir:function(a,b){for(var c=a._face2animateLine,d=0;d<b.length;d++){var e=b[d]._face2animateLine;if(Math.abs(c-e)<45)return!0}return!1},isInspect:function(a){var b=this.dataManager.getDataTypeForData(a);if(!b)return!1;var c=b.getCategoryId();return"rack"==c||"headerRack"==c?!0:!1},isHideInInspection:function(a){var b=this.dataManager.getDataTypeForData(a);if(!b)return!1;var c=b.getCategoryId();return"channel"==c?!0:!1},getCurrentInspectionData:function(a){var b=[],c=a.from,d=a.to,e=this.getLine(c,d);return this.inspectDataArray.forEach(function(a){this.isFace2Line(a,c,d,e)&&b.push(a)},this),b},isFace2Line:function(a,b,c,d){var e=a._absolutePosition,f=e.x,g=e.z,h=a._absoluteRotation.y;if(0==d.b){var i=f-c.x;if(Math.abs(i)>this.limitDistance)return!1;var j;if(j=f>-d.c?270:90,Math.abs(h-j)>this.limitAngle)return!1;a._face2animateLine=j}else if(0==d.a){var k=g-c.y;if(Math.abs(k)>this.limitDistance)return!1;var j;if(j=g>-d.c?180:0,Math.abs(h-j)>this.limitAngle)return!1;a._face2animateLine=j}else{var l=Math.abs((d.a*f+d.b*g+d.c)/Math.sqrt(Math.pow(d.a,2)+Math.pow(d.b,2)));if(l>this.limitDistance)return!1;var m=1/d.k,j=Math.atan(m)/Math.PI*180,n=-(d.b*g+d.c)/d.a;f>n?j+=180:0>j&&(j+=360),j+=90,j%=360;var o=Math.abs(h-j);if(o>180&&(o=360-o),o>this.limitAngle)return!1;a._face2animateLine=j}return!0},isClosed:function(a,b){var c=a._absolutePosition,d=c.x,e=c.z,f=b.getPosition(),g=f.x,h=f.z,i=Math.sqrt(Math.pow(g-d,2)+Math.pow(h-e,2));return a._distance2host=i,i<this.limitDistance},getLine:function(a,b){if(a.x==b.x)return{a:1,b:0,c:-a.x};if(a.y==b.y)return{a:0,b:1,c:-a.y};var c=0,d=0,e=0,f=(a.y-b.y)/(a.x-b.x),e=a.y-f*a.x;return c=f,d=-1,{a:c,b:d,c:e,k:f}},initDataPositionAndRotation:function(a){if(!a._absolutePosition||!a._absoluteRotation){var b=this.sceneManager.getNodeByDataOrId(a),c=b.getPosition(),d=b.getRotation(),e={x:c.x,y:c.y,z:c.z},f={x:d.x,y:d.y,z:d.z},g=this.dataManager.getDataById(a.getParentId());this._initDataPositionAndRotation(g,e,f),f.x=f.x/Math.PI*180%360,f.y=f.y/Math.PI*180%360,f.z=f.z/Math.PI*180%360,a._absolutePosition=e,a._absoluteRotation=f}},_initDataPositionAndRotation:function(a,b,c){if(a){var d=this.dataManager.getDataTypeForData(a);if(!d)return void console.warn("dataType is null");var e=d.getCategoryId();if("floor"==e)return void console.warn("parent data type is floor, calculate position complete");var f=this.sceneManager.getNodeByDataOrId(a);if(f){var g=f.getPosition(),h=f.getRotation(),i=b.x,j=b.z,k=0,l=0,m=-h.y,n=(i-k)*Math.cos(m)-(j-l)*Math.sin(m)+k,o=(i-k)*Math.sin(m)+(j-l)*Math.cos(m)+l;b.x=n,b.z=o,b.x+=g.x,b.y+=g.y,b.z+=g.z,c.x+=h.x,c.y+=h.y,c.z+=h.z}var p=this.dataManager.getDataById(a.getParentId());p&&this._initDataPositionAndRotation(p,b,c)}}}),d.PortCapacityManager=function(a){d.EventHandler.call(this),this.sceneManager=a,this.dataManager=this.sceneManager.dataManager,this.visibleManager=new G(this.sceneManager),this.sceneManager.viewManager3d.addVisibleFilter(this.visibleManager),this.colors=["#8A0808","#088A08","#088A85","#6A0888","#B18904"],this.padding=2.5,this.portNodes=[],this.solidColor="#eaeaea"},d.PortCapacityManager.CATEGORY_EQUIPMENT="equipment",d.PortCapacityManager.CATEGORY_PORT="port",mono.extend(d.PortCapacityManager,d.EventHandler,{computePortPercent:function(a){var b=this.dataManager,c=a;c.getId||(c=b.getDataById(a));var e=b.getDataTypeForData(c);if(e&&e.getCategoryId()==d.PortCapacityManager.CATEGORY_EQUIPMENT){var f=this.computePortInfo(c);if(!f||0==f.length)return 100;for(var g=0,h=0;h<f.length;h++){var i=f[h],j=i.getAllLinks();j&&Object.keys(j).length>0&&g++}return g/f.length*100}},computePortInfo:function(a){var b=this.dataManager,c=a;c.getId||(c=b.getDataById(a));var e=[],f=b.getChildren(c);return f.forEach(function(a){var c=b.getDataTypeForData(a);c&&c.getCategoryId()==d.PortCapacityManager.CATEGORY_PORT&&e.push(a)}),e},createPortNode:function(a,b,c,d,e,f){var g=this.sceneManager,h=this.dataManager,i=a,j=g.network3d.getDataBox();if(g.isCurrentSceneInstance(a)){i.getId||(i=h.getDataById(a));var k=this.computePortPercent(i);if(null!=k){k=Math.round(100*Math.random()),i._portPercent=k;var l=i._portNode;l||(l=new mono.Cube(b,c,d),l.setPosition(0,e,0),l.s({"m.type":"phong","m.specularStrength":50,"m.transparent":!0,"m.opacity":.6}),l.setClient("it_data","port"),l.setClient("portChildNode",!0),l.setClient("data",i),i._portNode=l);var m=this.getPortNodeColor(k);return l.s({"m.color":m,"m.ambient":m}),l.setParent(f),j.addByDescendant(l),l}}},createSolidNode:function(a,b,c,d,e){var f=this.sceneManager,g=(this.dataManager,f.network3d.getDataBox()),h=h=new mono.Cube(a,b,c);return h.setPosition(0,d,0),h.s({"m.type":"phong","m.specularStrength":50,"m.color":this.solidColor,"m.ambient":this.solidColor}),h.setClient("it_data","port_solid"),h.setClient("portChildNode_solid",!0),h.setParent(e),g.addByDescendant(h),h},makeItDataUnvisible:function(a){if(a){this.visibleManager.setVisible(a,!1);var b=this;a.getChildren().forEach(function(a){b.makeItDataUnvisible(a)})}},makeItDataVisible:function(a){if(a){this.visibleManager.setVisible(a,!0);var b=this;a.getChildren().forEach(function(a){b.makeItDataVisible(a)})}},removePortNode:function(a){var b=this.sceneManager,c=this.dataManager,d=a,e=b.network3d.getDataBox();d.getId||(d=c.getDataById(a)),delete d._portPercent;var f=d._portNode;f&&(f.setParent(null),e.removeByDescendant(f)),this.makeItDataVisible(d)},getPortNodeColor:function(a){if(this.portNodeColorFunction){var b=this.portNodeColorFunction(a);return b}var c=Math.ceil(a/20);return this.colors[c-1]},isDataSupport:function(a){var b=this.dataManager,c=b.getDataTypeForData(a);return c&&c.getCategoryId()==d.PortCapacityManager.CATEGORY_EQUIPMENT&&"network"==c.getSubType()?!0:!1},calcDataHeight:function(a){var b=this.dataManager,c=b.getDataTypeForData(a),d=c.getSize();return parseInt(d.ySize||0)*make.Default.UNIT_HEIGHT},createPortNodeInRack:function(a){var b=[],c=this.sceneManager,d=this.dataManager,e=this;if(c.isCurrentSceneInstance(a)){var f=d.getDataTypeForData(a);if(!f)return void console.warn("dataType is not exist");var g=c.getNodeByDataOrId(a);if(!g)return void console.warn("rack node is not exist");var h=f.getChildrenSize(),i=g.getBoundingBox(),j=i.size(),k=j.x,l=j.y,m=j.z;this.makeItDataUnvisible(a);var n=d.getChildren(a),o={};n.forEach(function(a){e.isDataSupport(a)&&(o[a.getLocation().y]=a)});for(var p=0,q=1;q<=h.ySize;q++)if(o[q]){var r=o[q];if(0!=p){var s=q-p,t=parseInt(s)*make.Default.UNIT_HEIGHT;t-=e.padding;var u=h.yPadding[0];u+=(p-1+s/2)*make.Default.UNIT_HEIGHT,u+=e.padding/2,u-=l/2,console.log("solid: height = "+t+"  positionY = "+u);var v=e.createSolidNode(k,t,m,u,g);v&&b.push(v),p=0}var w=d.getDataTypeForData(r),s=w.getSize().ySize,t=parseInt(s||0)*make.Default.UNIT_HEIGHT;t-=e.padding;var x=r.getLocation(),u=h.yPadding[0];u+=(x.y-1+s/2)*make.Default.UNIT_HEIGHT,u+=e.padding/2,u-=l/2,console.log("port : height = "+t+"  positionY = "+u);var v=e.createPortNode(r,k,t,m,u,g);v&&b.push(v),q--,q+=s}else if(0==p){p=q;continue}if(0!=p){var s=q-p,t=parseInt(s)*make.Default.UNIT_HEIGHT;t-=e.padding;var u=h.yPadding[0];u+=(p-1+s/2)*make.Default.UNIT_HEIGHT,u+=e.padding/2,u-=l/2,console.log("solid: height = "+t+"  positionY = "+u);var v=e.createSolidNode(k,t,m,u,g);v&&b.push(v),p=0}return a.portNodeArray=b,b}},hasChild:function(a,b){},removePortNodeInRack:function(a){var b=this.sceneManager,c=(this.dataManager,b.network3d.getDataBox());if(b.isCurrentSceneInstance(a)){var d=b.getNodeByDataOrId(a);d&&(this.makeItDataVisible(a),a.portNodeArray&&a.portNodeArray.forEach(function(a){c.remove(a)}))}}});var G=function(a){d.VisibleFilter.call(this),this.sceneManager=a,this.isDealWithFunction=null,this._vmap={}};mono.extend(G,d.VisibleFilter,{clear:function(){this._vmap={},this.sceneManager._sceneVisibleChangeDispather.fire({data:null,type:"clear"})},isDealWith:function(a){return null!=this.isDealWithFunction?this.isDealWithFunction(a):!0},getBId:function(a){return a&&a instanceof d.Data&&this.isDealWith(a)?a.getId():null},setVisible:function(a,c,d){var e=this.getBId(a);if(e){var f=this._vmap[e];c?delete this._vmap[e]:this._vmap[e]=!1,(null===d||d===b)&&(d=!0),d&&f!=c&&this.sceneManager._sceneVisibleChangeDispather.fire({data:a,value:c})}},getDataByNode:function(a){return a?this.sceneManager.getNodeData(a):null},setVisibleByDescendant:function(a,c,d){if(a&&(a instanceof mono.Element&&(a=this.getDataByNode(a)),(null===d||d===b)&&(d=!0),a&&a.getId())){this.setVisible(a,c,!1);var e=this.sceneManager.dataNodeMap[a.getId()],f=e.getChildren();if(f&&f.size()>0)for(var g=0;g<f.size();g++){var h=f.get(g),i=this.getDataByNode(h);i&&this.getBId(i)!=this.getBId(a)&&this.setVisibleByDescendant(h,c,!1,this)}d&&this.sceneManager._sceneVisibleChangeDispather.fire({data:a,type:"descendtant",value:c})}},isVisible:function(a,b,c){var d=this.getBId(b);return 0!=this._vmap[d]?!0:!1}}),d.VisibleManager=G,d.SData=function(a,b,c,e,f){d.Base.call(this),this._key="",this._isClient=!1,this._value="",this._operation="",this._clientMap={},this._style="",this.placeholder=e,this.label=c,this.inputType=b,this.inputIndex=a,this._dataType=f||"string"},mono.extend(d.SData,d.Base,{___accessor:["key","isClient","value","operation","style","dataType"],setClient:function(a,b){a&&(this._clientMap[a]=b)},getClient:function(a){return this._clientMap[a]},toString:function(){if(!this._key||!this._value)return"";var a=this._key;this._isClient&&(a="u:"+a);var b={key:a},c="";this._value&&(c=this._value),b.value=c;var d="=";return this._operation&&(d=this._operation),b.operation=d,b.dataType=this._dataType,b}}),d.BasePanel=function(a){a||(a="base-search-panel"),this.mainPane=$('<div id="'+a+'" class="inputPane"> </div>'),this._ids=[],this.doClickFunction=null,this.doClearFunction=null},mono.extend(d.BasePanel,Object,{createRow:function(){return $('<div class="row"></div>')},createCol:function(a,b){return a||(a=3),b?$('<div class="without-padding col-md-'+a+" "+b+'"></div>'):$('<div class="without-padding col-md-'+a+'"></div>')},appendRow:function(a){if(a){this.mainPane.append(a);var b=this.mainPane.height();b+=27,this.mainPane.height(b)}},addQuick:function(a){if(a){var b=a.inputIndex,c=a.placeholder,d=this.createRow(),e=this.createCol(12),f=$('<input type="text" class="input-min contral-width" id="'+b+'" placeholder="'+c+'">'),g=a.getStyle()||"";g&&f.attr("style",g);var h=this;f.keypress(function(a){13===a.keyCode&&h.doClick()}),e.append(f),d.append(e),this.appendRow(d),this._ids.push(a)}},validateDatePick:function(){$(".datetime-picker").datetimepicker({language:"zh-CN",format:"yyyy-mm-dd",autoclose:!0,todayBtn:!0,startView:2,minView:2})},createInput:function(a){if(a){var b=a.inputIndex,c=null;c=a.inputType&&"date"==a.inputType.toLowerCase()?$('<input id="'+b+'" class="input-min contral-width datetime-picker">'):$('<input id="'+b+'" class="input-min contral-width">');var d=a.getStyle()||"";return d&&c.attr("style",d),c}},addRow:function(a,b){if(a||b){var c=this.createRow();if(a&&b){var d=a.inputIndex,e=a.label,f=this.createCol(3),g=$('<label for="'+d+'" class="inputpane-label label-min">'+e+"</label>");f.append(g),c.append(f);var h=this.createCol(4),i=this.createInput(a);h.append(i),c.append(h),i.keypress(function(a){13===a.keyCode&&u.doClick()}),this._ids.push(a);var j=b.inputIndex,k=b.label,l=this.createCol(1,"text-center"),m=$('<label for="'+j+'" class="inputpane-label label-min">'+k+"</label>");l.append(m),c.append(l);var n=this.createCol(4),o=this.createInput(b);n.append(o),c.append(n),o.keypress(function(a){13===a.keyCode&&u.doClick()}),this.appendRow(c),this._ids.push(b)}else{!a&&b&&(a=b);var p=a.inputIndex,q=a.label,r=this.createCol(3),s=this.createCol(9),g=$('<label for="'+p+'" class="inputpane-label label-min">'+q+"</label>");r.append(g),c.append(r);var t=this.createInput(a),u=this;t.keypress(function(a){13===a.keyCode&&u.doClick()}),s.append(t),c.append(s),this.appendRow(c),this._ids.push(a)}}},addConstantCondition:function(a){a||this._ids.push(a)},addButtonRow:function(){var a=this.createRow(),b=this.createCol(12),c=$('<span id="btn_search_it" class="base-panel-search-btn" type="submit" title="搜 索">搜 索</span>'),d=$('<span id="btn_cancel_search_it" class="base-panel-search-btn" type="cancel" title="清 除">清 除</span>');b.append(d),b.append(c);var e=this;c.click(function(){e.doClick()}),d.click(function(){e.doClear()}),a.append(b),this.appendRow(a)},getContentPane:function(){return this.mainPane},getDataValue:function(a){if(a&&a.inputIndex){var b=a.inputIndex,c=(a.inputType,$("#"+b).val());if(a.setValue(c),a.toString())return a.toString()}return""},getInputValues:function(){if(this._ids){for(var a=[],b=0;b<this._ids.length;b++){var c=this._ids[b],d=this.getDataValue(c);d&&a.push(d)}return a}},doClick:function(){var a=this.getInputValues();this.doClickFunction&&this.doClickFunction(a)},clearInput:function(){if(this._ids)for(var a=0;a<this._ids.length;a++){var b=this._ids[a];if(b&&b.inputIndex){var c=b.inputIndex;!b||!b.inputType||b.inputType.toLowerCase().indexOf("input")>=0?$("#"+c).val(""):$("#"+c).val("")}}},doClear:function(){this.clearInput(),this.doClearFunction&&this.doClearFunction()}}),d.ITSearchPanel=function(){d.BasePanel.call(this),this.init()},mono.extend(d.ITSearchPanel,d.BasePanel,{init:function(){var a=new d.SData("it_key_text",null,null,"请输入编号");a.setKey("id"),a.setStyle('background: url("./css/images/insidesearch.svg") no-repeat scroll right center;background-position-x: 98%;'),this.addQuick(a),a=new d.SData("txt_location","select","位置"),a.setKey("location"),a.setIsClient(!0);var b=["","上海数据中心","生产楼","一楼"];a.setClient("options",b),this.addRow(a),a=new d.SData("txt_type","select","设备类型"),a.setKey("userId"),a.setIsClient(!1);var b=["","机柜1","思科设备1","华为交换机"];a.setClient("options",b),this.addRow(a),a=new d.SData("txt_model","input","型号"),a.setKey("model"),a.setIsClient(!0),this.addRow(a),a=new d.SData("txt_manu","input","厂家"),a.setKey("userId"),a.setIsClient(!0),this.addRow(a),a=new d.SData("txt_Type","input","安装日期"),a.setKey("userId"),a.setIsClient(!0),this.addRow(a),this.addRow(a),this.addButtonRow()},createInput:function(a){if(a&&a.inputType){var b=a.inputType,c=a.inputIndex;if(b.toLowerCase().indexOf("select")>=0){var d=$('<select id="'+c+'" class="input-min contral-width"></select>'),e=a.getClient("options");if(e&&e.length>0)for(var f=0;f<e.length;f++){var g=e[f],h=$('<option value="'+g+'" class="input-min">'+g+"</option>");d.append(h)}return d}}return this.constructor.superClass.createInput(a)}}),d.SpaceSearchPanel=function(){d.BasePanel.call(this),this.init()},mono.extend(d.SpaceSearchPanel,d.BasePanel,{init:function(){var a=new d.SData("U_ID","input","U数");a.setKey("dyna_user_data_maxSerSpace"),a.setIsClient(!0),a.setOperation(">="),a.setDataType("number"),this.addRow(a),this.addButtonRow()},getUNumber:function(){return $("#U_ID").val()}}),function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a("object"==typeof exports?require("jquery"):jQuery)}(function(b,c){if(!b.jstree){var d,e,f=0,g=!1,h=!1,i=!1,j=[],k=b("script:last").attr("src"),l=a.document,m=l.createElement("LI");m.setAttribute("role","treeitem"),d=l.createElement("I"),d.className="jstree-icon jstree-ocl",d.setAttribute("role","presentation"),m.appendChild(d),d=l.createElement("A"),d.className="jstree-anchor",d.setAttribute("href","#"),d.setAttribute("tabindex","-1"),e=l.createElement("I"),e.className="jstree-icon jstree-themeicon",e.setAttribute("role","presentation"),d.appendChild(e),m.appendChild(d),d=e=null,b.jstree={version:"3.1.1",defaults:{plugins:[]},plugins:{},path:k&&-1!==k.indexOf("/")?k.replace(/\/[^\/]+$/,""):"",idregex:/[\\:&!^|()\[\]<>@*'+~#";.,=\- \/${}%?`]/g},b.jstree.create=function(a,c){var d=new b.jstree.core(++f),e=c;return c=b.extend(!0,{},b.jstree.defaults,c),e&&e.plugins&&(c.plugins=e.plugins),b.each(c.plugins,function(a,b){"core"!==a&&(d=d.plugin(b,c[b]))}),b(a).data("jstree",d),d.init(a,c),d},b.jstree.destroy=function(){b(".jstree:jstree").jstree("destroy"),b(l).off(".jstree")},b.jstree.core=function(a){this._id=a,this._cnt=0,this._wrk=null,this._data={core:{themes:{name:!1,dots:!1,icons:!1},selected:[],last_error:{},working:!1,worker_queue:[],focused:null}}},b.jstree.reference=function(a){var c=null,d=null;if(!a||!a.id||a.tagName&&a.nodeType||(a=a.id),!d||!d.length)try{d=b(a)}catch(e){}if(!d||!d.length)try{d=b("#"+a.replace(b.jstree.idregex,"\\$&"))}catch(e){}return d&&d.length&&(d=d.closest(".jstree")).length&&(d=d.data("jstree"))?c=d:b(".jstree").each(function(){var d=b(this).data("jstree");return d&&d._model.data[a]?(c=d,!1):void 0}),c},b.fn.jstree=function(a){var d="string"==typeof a,e=Array.prototype.slice.call(arguments,1),f=null;return a!==!0||this.length?(this.each(function(){var g=b.jstree.reference(this),h=d&&g?g[a]:null;return f=d&&h?h.apply(g,e):null,g||d||a!==c&&!b.isPlainObject(a)||b.jstree.create(this,a),(g&&!d||a===!0)&&(f=g||!1),null!==f&&f!==c?!1:void 0}),null!==f&&f!==c?f:this):!1},b.expr[":"].jstree=b.expr.createPseudo(function(a){return function(a){return b(a).hasClass("jstree")&&b(a).data("jstree")!==c}}),b.jstree.defaults.core={data:!1,strings:!1,check_callback:!1,error:b.noop,animation:200,multiple:!0,themes:{name:!1,url:!1,dir:!1,dots:!0,icons:!0,stripes:!1,variant:!1,responsive:!1},expand_selected_onload:!0,worker:!0,force_text:!1,dblclick_toggle:!0},b.jstree.core.prototype={plugin:function(a,c){var d=b.jstree.plugins[a];return d?(this._data[a]={},d.prototype=this,new d(c,this)):this},init:function(a,c){this._model={data:{"#":{id:"#",parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}}},changed:[],force_full_redraw:!1,redraw_timeout:!1,default_state:{loaded:!0,opened:!1,selected:!1,disabled:!1}},this.element=b(a).addClass("jstree jstree-"+this._id),this.settings=c,this._data.core.ready=!1,this._data.core.loaded=!1,this._data.core.rtl="rtl"===this.element.css("direction"),this.element[this._data.core.rtl?"addClass":"removeClass"]("jstree-rtl"),this.element.attr("role","tree"),this.settings.core.multiple&&this.element.attr("aria-multiselectable",!0),this.element.attr("tabindex")||this.element.attr("tabindex","0"),this.bind(),this.trigger("init"),this._data.core.original_container_html=this.element.find(" > ul > li").clone(!0),this._data.core.original_container_html.find("li").addBack().contents().filter(function(){return 3===this.nodeType&&(!this.nodeValue||/^\s+$/.test(this.nodeValue))}).remove(),this.element.html("<ul class='jstree-container-ul jstree-children' role='group'><li id='j"+this._id+"_loading' class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='tree-item'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),
this.element.attr("aria-activedescendant","j"+this._id+"_loading"),this._data.core.li_height=this.get_container_ul().children("li").first().height()||24,this.trigger("loading"),this.load_node("#")},destroy:function(b){if(this._wrk)try{a.URL.revokeObjectURL(this._wrk),this._wrk=null}catch(c){}b||this.element.empty(),this.teardown()},teardown:function(){this.unbind(),this.element.removeClass("jstree").removeData("jstree").find("[class^='jstree']").addBack().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/gi,"")}),this.element=null},bind:function(){var c="",d=null,e=0;this.element.on("dblclick.jstree",function(){if(l.selection&&l.selection.empty)l.selection.empty();else if(a.getSelection){var b=a.getSelection();try{b.removeAllRanges(),b.collapse()}catch(c){}}}).on("mousedown.jstree",b.proxy(function(a){a.target===this.element[0]&&(a.preventDefault(),e=+new Date)},this)).on("mousedown.jstree",".jstree-ocl",function(a){a.preventDefault()}).on("click.jstree",".jstree-ocl",b.proxy(function(a){this.toggle_node(a.target)},this)).on("dblclick.jstree",".jstree-anchor",b.proxy(function(a){this.settings.core.dblclick_toggle&&this.toggle_node(a.target)},this)).on("click.jstree",".jstree-anchor",b.proxy(function(a){a.preventDefault(),a.currentTarget!==l.activeElement&&b(a.currentTarget).focus(),this.activate_node(a.currentTarget,a)},this)).on("keydown.jstree",".jstree-anchor",b.proxy(function(a){if("INPUT"===a.target.tagName)return!0;if(32!==a.which&&13!==a.which&&(a.shiftKey||a.ctrlKey||a.altKey||a.metaKey))return!0;var c=null;switch(this._data.core.rtl&&(37===a.which?a.which=39:39===a.which&&(a.which=37)),a.which){case 32:a.ctrlKey&&(a.type="click",b(a.currentTarget).trigger(a));break;case 13:a.type="click",b(a.currentTarget).trigger(a);break;case 37:a.preventDefault(),this.is_open(a.currentTarget)?this.close_node(a.currentTarget):(c=this.get_parent(a.currentTarget),c&&"#"!==c.id&&this.get_node(c,!0).children(".jstree-anchor").focus());break;case 38:a.preventDefault(),c=this.get_prev_dom(a.currentTarget),c&&c.length&&c.children(".jstree-anchor").focus();break;case 39:a.preventDefault(),this.is_closed(a.currentTarget)?this.open_node(a.currentTarget,function(a){this.get_node(a,!0).children(".jstree-anchor").focus()}):this.is_open(a.currentTarget)&&(c=this.get_node(a.currentTarget,!0).children(".jstree-children")[0],c&&b(this._firstChild(c)).children(".jstree-anchor").focus());break;case 40:a.preventDefault(),c=this.get_next_dom(a.currentTarget),c&&c.length&&c.children(".jstree-anchor").focus();break;case 106:this.open_all();break;case 36:a.preventDefault(),c=this._firstChild(this.get_container_ul()[0]),c&&b(c).children(".jstree-anchor").filter(":visible").focus();break;case 35:a.preventDefault(),this.element.find(".jstree-anchor").filter(":visible").last().focus()}},this)).on("load_node.jstree",b.proxy(function(a,c){c.status&&("#"!==c.node.id||this._data.core.loaded||(this._data.core.loaded=!0,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.trigger("loaded")),this._data.core.ready||setTimeout(b.proxy(function(){if(this.element&&!this.get_container_ul().find(".jstree-loading").length){if(this._data.core.ready=!0,this._data.core.selected.length){if(this.settings.core.expand_selected_onload){var a,c,d=[];for(a=0,c=this._data.core.selected.length;c>a;a++)d=d.concat(this._model.data[this._data.core.selected[a]].parents);for(d=b.vakata.array_unique(d),a=0,c=d.length;c>a;a++)this.open_node(d[a],!1,0)}this.trigger("changed",{action:"ready",selected:this._data.core.selected})}this.trigger("ready")}},this),0))},this)).on("keypress.jstree",b.proxy(function(a){if("INPUT"===a.target.tagName)return!0;d&&clearTimeout(d),d=setTimeout(function(){c=""},500);var e=String.fromCharCode(a.which).toLowerCase(),f=this.element.find(".jstree-anchor").filter(":visible"),g=f.index(l.activeElement)||0,h=!1;if(c+=e,c.length>1){if(f.slice(g).each(b.proxy(function(a,d){return 0===b(d).text().toLowerCase().indexOf(c)?(b(d).focus(),h=!0,!1):void 0},this)),h)return;if(f.slice(0,g).each(b.proxy(function(a,d){return 0===b(d).text().toLowerCase().indexOf(c)?(b(d).focus(),h=!0,!1):void 0},this)),h)return}if(new RegExp("^"+e+"+$").test(c)){if(f.slice(g+1).each(b.proxy(function(a,c){return b(c).text().toLowerCase().charAt(0)===e?(b(c).focus(),h=!0,!1):void 0},this)),h)return;if(f.slice(0,g+1).each(b.proxy(function(a,c){return b(c).text().toLowerCase().charAt(0)===e?(b(c).focus(),h=!0,!1):void 0},this)),h)return}},this)).on("init.jstree",b.proxy(function(){var a=this.settings.core.themes;this._data.core.themes.dots=a.dots,this._data.core.themes.stripes=a.stripes,this._data.core.themes.icons=a.icons,this.set_theme(a.name||"default",a.url),this.set_theme_variant(a.variant)},this)).on("loading.jstree",b.proxy(function(){this[this._data.core.themes.dots?"show_dots":"hide_dots"](),this[this._data.core.themes.icons?"show_icons":"hide_icons"](),this[this._data.core.themes.stripes?"show_stripes":"hide_stripes"]()},this)).on("blur.jstree",".jstree-anchor",b.proxy(function(a){this._data.core.focused=null,b(a.currentTarget).filter(".jstree-hovered").mouseleave(),this.element.attr("tabindex","0")},this)).on("focus.jstree",".jstree-anchor",b.proxy(function(a){var c=this.get_node(a.currentTarget);c&&c.id&&(this._data.core.focused=c.id),this.element.find(".jstree-hovered").not(a.currentTarget).mouseleave(),b(a.currentTarget).mouseenter(),this.element.attr("tabindex","-1")},this)).on("focus.jstree",b.proxy(function(){if(+new Date-e>500&&!this._data.core.focused){e=0;var a=this.get_node(this.element.attr("aria-activedescendant"),!0);a&&a.find("> .jstree-anchor").focus()}},this)).on("mouseenter.jstree",".jstree-anchor",b.proxy(function(a){this.hover_node(a.currentTarget)},this)).on("mouseleave.jstree",".jstree-anchor",b.proxy(function(a){this.dehover_node(a.currentTarget)},this))},unbind:function(){this.element.off(".jstree"),b(l).off(".jstree-"+this._id)},trigger:function(a,b){b||(b={}),b.instance=this,this.element.triggerHandler(a.replace(".jstree","")+".jstree",b)},get_container:function(){return this.element},get_container_ul:function(){return this.element.children(".jstree-children").first()},get_string:function(a){var c=this.settings.core.strings;return b.isFunction(c)?c.call(this,a):c&&c[a]?c[a]:a},_firstChild:function(a){for(a=a?a.firstChild:null;null!==a&&1!==a.nodeType;)a=a.nextSibling;return a},_nextSibling:function(a){for(a=a?a.nextSibling:null;null!==a&&1!==a.nodeType;)a=a.nextSibling;return a},_previousSibling:function(a){for(a=a?a.previousSibling:null;null!==a&&1!==a.nodeType;)a=a.previousSibling;return a},get_node:function(a,c){a&&a.id&&(a=a.id);var d;try{if(this._model.data[a])a=this._model.data[a];else if("string"==typeof a&&this._model.data[a.replace(/^#/,"")])a=this._model.data[a.replace(/^#/,"")];else if("string"==typeof a&&(d=b("#"+a.replace(b.jstree.idregex,"\\$&"),this.element)).length&&this._model.data[d.closest(".jstree-node").attr("id")])a=this._model.data[d.closest(".jstree-node").attr("id")];else if((d=b(a,this.element)).length&&this._model.data[d.closest(".jstree-node").attr("id")])a=this._model.data[d.closest(".jstree-node").attr("id")];else{if(!(d=b(a,this.element)).length||!d.hasClass("jstree"))return!1;a=this._model.data["#"]}return c&&(a="#"===a.id?this.element:b("#"+a.id.replace(b.jstree.idregex,"\\$&"),this.element)),a}catch(e){return!1}},get_path:function(a,b,c){if(a=a.parents?a:this.get_node(a),!a||"#"===a.id||!a.parents)return!1;var d,e,f=[];for(f.push(c?a.id:a.text),d=0,e=a.parents.length;e>d;d++)f.push(c?a.parents[d]:this.get_text(a.parents[d]));return f=f.reverse().slice(1),b?f.join(b):f},get_next_dom:function(a,c){var d;if(a=this.get_node(a,!0),a[0]===this.element[0]){for(d=this._firstChild(this.get_container_ul()[0]);d&&0===d.offsetHeight;)d=this._nextSibling(d);return d?b(d):!1}if(!a||!a.length)return!1;if(c){d=a[0];do d=this._nextSibling(d);while(d&&0===d.offsetHeight);return d?b(d):!1}if(a.hasClass("jstree-open")){for(d=this._firstChild(a.children(".jstree-children")[0]);d&&0===d.offsetHeight;)d=this._nextSibling(d);if(null!==d)return b(d)}d=a[0];do d=this._nextSibling(d);while(d&&0===d.offsetHeight);return null!==d?b(d):a.parentsUntil(".jstree",".jstree-node").nextAll(".jstree-node:visible").first()},get_prev_dom:function(a,c){var d;if(a=this.get_node(a,!0),a[0]===this.element[0]){for(d=this.get_container_ul()[0].lastChild;d&&0===d.offsetHeight;)d=this._previousSibling(d);return d?b(d):!1}if(!a||!a.length)return!1;if(c){d=a[0];do d=this._previousSibling(d);while(d&&0===d.offsetHeight);return d?b(d):!1}d=a[0];do d=this._previousSibling(d);while(d&&0===d.offsetHeight);if(null!==d){for(a=b(d);a.hasClass("jstree-open");)a=a.children(".jstree-children").first().children(".jstree-node:visible:last");return a}return d=a[0].parentNode.parentNode,d&&d.className&&-1!==d.className.indexOf("jstree-node")?b(d):!1},get_parent:function(a){return a=this.get_node(a),a&&"#"!==a.id?a.parent:!1},get_children_dom:function(a){return a=this.get_node(a,!0),a[0]===this.element[0]?this.get_container_ul().children(".jstree-node"):a&&a.length?a.children(".jstree-children").children(".jstree-node"):!1},is_parent:function(a){return a=this.get_node(a),a&&(a.state.loaded===!1||a.children.length>0)},is_loaded:function(a){return a=this.get_node(a),a&&a.state.loaded},is_loading:function(a){return a=this.get_node(a),a&&a.state&&a.state.loading},is_open:function(a){return a=this.get_node(a),a&&a.state.opened},is_closed:function(a){return a=this.get_node(a),a&&this.is_parent(a)&&!a.state.opened},is_leaf:function(a){return!this.is_parent(a)},load_node:function(a,c){var d,e,f,g,h;if(b.isArray(a))return this._load_nodes(a.slice(),c),!0;if(a=this.get_node(a),!a)return c&&c.call(this,a,!1),!1;if(a.state.loaded){for(a.state.loaded=!1,d=0,e=a.children_d.length;e>d;d++){for(f=0,g=a.parents.length;g>f;f++)this._model.data[a.parents[f]].children_d=b.vakata.array_remove_item(this._model.data[a.parents[f]].children_d,a.children_d[d]);this._model.data[a.children_d[d]].state.selected&&(h=!0,this._data.core.selected=b.vakata.array_remove_item(this._data.core.selected,a.children_d[d])),delete this._model.data[a.children_d[d]]}a.children=[],a.children_d=[],h&&this.trigger("changed",{action:"load_node",node:a,selected:this._data.core.selected})}return a.state.failed=!1,a.state.loading=!0,this.get_node(a,!0).addClass("jstree-loading").attr("aria-busy",!0),this._load_node(a,b.proxy(function(b){a=this._model.data[a.id],a.state.loading=!1,a.state.loaded=b,a.state.failed=!a.state.loaded;var d=this.get_node(a,!0);a.state.loaded&&!a.children.length&&d&&d.length&&!d.hasClass("jstree-leaf")&&d.removeClass("jstree-closed jstree-open").addClass("jstree-leaf"),d.removeClass("jstree-loading").attr("aria-busy",!1),this.trigger("load_node",{node:a,status:b}),c&&c.call(this,a,b)},this)),!0},_load_nodes:function(a,b,c){var d,e,f=!0,g=function(){this._load_nodes(a,b,!0)},h=this._model.data,i=[];for(d=0,e=a.length;e>d;d++)!h[a[d]]||(h[a[d]].state.loaded||h[a[d]].state.failed)&&c||(this.is_loading(a[d])||this.load_node(a[d],g),f=!1);if(f){for(d=0,e=a.length;e>d;d++)h[a[d]]&&h[a[d]].state.loaded&&i.push(a[d]);b&&!b.done&&(b.call(this,i),b.done=!0)}},load_all:function(a,b){if(a||(a="#"),a=this.get_node(a),!a)return!1;var c,d,e=[],f=this._model.data,g=f[a.id].children_d;for(a.state&&!a.state.loaded&&e.push(a.id),c=0,d=g.length;d>c;c++)f[g[c]]&&f[g[c]].state&&!f[g[c]].state.loaded&&e.push(g[c]);e.length?this._load_nodes(e,function(){this.load_all(a,b)}):(b&&b.call(this,a),this.trigger("load_all",{node:a}))},_load_node:function(a,c){var d,e=this.settings.core.data;return e?b.isFunction(e)?e.call(this,a,b.proxy(function(d){d===!1&&c.call(this,!1),this["string"==typeof d?"_append_html_data":"_append_json_data"](a,"string"==typeof d?b(b.parseHTML(d)).filter(function(){return 3!==this.nodeType}):d,function(a){c.call(this,a)})},this)):"object"==typeof e?e.url?(e=b.extend(!0,{},e),b.isFunction(e.url)&&(e.url=e.url.call(this,a)),b.isFunction(e.data)&&(e.data=e.data.call(this,a)),b.ajax(e).done(b.proxy(function(d,e,f){var g=f.getResponseHeader("Content-Type");return g&&-1!==g.indexOf("json")||"object"==typeof d?this._append_json_data(a,d,function(a){c.call(this,a)}):g&&-1!==g.indexOf("html")||"string"==typeof d?this._append_html_data(a,b(b.parseHTML(d)).filter(function(){return 3!==this.nodeType}),function(a){c.call(this,a)}):(this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:a.id,xhr:f})},this.settings.core.error.call(this,this._data.core.last_error),c.call(this,!1))},this)).fail(b.proxy(function(b){c.call(this,!1),this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:a.id,xhr:b})},this.settings.core.error.call(this,this._data.core.last_error)},this))):(d=b.isArray(e)||b.isPlainObject(e)?JSON.parse(JSON.stringify(e)):e,"#"===a.id?this._append_json_data(a,d,function(a){c.call(this,a)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_05",reason:"Could not load node",data:JSON.stringify({id:a.id})},this.settings.core.error.call(this,this._data.core.last_error),c.call(this,!1))):"string"==typeof e?"#"===a.id?this._append_html_data(a,b(b.parseHTML(e)).filter(function(){return 3!==this.nodeType}),function(a){c.call(this,a)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_06",reason:"Could not load node",data:JSON.stringify({id:a.id})},this.settings.core.error.call(this,this._data.core.last_error),c.call(this,!1)):c.call(this,!1):"#"===a.id?this._append_html_data(a,this._data.core.original_container_html.clone(!0),function(a){c.call(this,a)}):c.call(this,!1)},_node_changed:function(a){a=this.get_node(a),a&&this._model.changed.push(a.id)},_append_html_data:function(a,c,d){a=this.get_node(a),a.children=[],a.children_d=[];var e,f,g,h=c.is("ul")?c.children():c,i=a.id,j=[],k=[],l=this._model.data,m=l[i],n=this._data.core.selected.length;for(h.each(b.proxy(function(a,c){e=this._parse_model_from_html(b(c),i,m.parents.concat()),e&&(j.push(e),k.push(e),l[e].children_d.length&&(k=k.concat(l[e].children_d)))},this)),m.children=j,m.children_d=k,f=0,g=m.parents.length;g>f;f++)l[m.parents[f]].children_d=l[m.parents[f]].children_d.concat(k);this.trigger("model",{nodes:k,parent:i}),"#"!==i?(this._node_changed(i),this.redraw()):(this.get_container_ul().children(".jstree-initial-node").remove(),this.redraw(!0)),this._data.core.selected.length!==n&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),d.call(this,!0)},_append_json_data:function(c,d,e,f){if(null!==this.element){c=this.get_node(c),c.children=[],c.children_d=[],d.d&&(d=d.d,"string"==typeof d&&(d=JSON.parse(d))),b.isArray(d)||(d=[d]);var g=null,h={df:this._model.default_state,dat:d,par:c.id,m:this._model.data,t_id:this._id,t_cnt:this._cnt,sel:this._data.core.selected},i=function(b,c){b.data&&(b=b.data);var d,e,f,g,h=b.dat,i=b.par,j=[],k=[],l=[],m=b.df,n=b.t_id,o=b.t_cnt,p=b.m,q=p[i],r=b.sel,s=function(a,b,d){d=d?d.concat():[],b&&d.unshift(b);var e,f,g,h,i=a.id.toString(),j={id:i,text:a.text||"",icon:a.icon!==c?a.icon:!0,parent:b,parents:d,children:a.children||[],children_d:a.children_d||[],data:a.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(e in m)m.hasOwnProperty(e)&&(j.state[e]=m[e]);if(a&&a.data&&a.data.jstree&&a.data.jstree.icon&&(j.icon=a.data.jstree.icon),(j.icon===c||null===j.icon||""===j.icon)&&(j.icon=!0),a&&a.data&&(j.data=a.data,a.data.jstree))for(e in a.data.jstree)a.data.jstree.hasOwnProperty(e)&&(j.state[e]=a.data.jstree[e]);if(a&&"object"==typeof a.state)for(e in a.state)a.state.hasOwnProperty(e)&&(j.state[e]=a.state[e]);if(a&&"object"==typeof a.li_attr)for(e in a.li_attr)a.li_attr.hasOwnProperty(e)&&(j.li_attr[e]=a.li_attr[e]);if(j.li_attr.id||(j.li_attr.id=i),a&&"object"==typeof a.a_attr)for(e in a.a_attr)a.a_attr.hasOwnProperty(e)&&(j.a_attr[e]=a.a_attr[e]);for(a&&a.children&&a.children===!0&&(j.state.loaded=!1,j.children=[],j.children_d=[]),p[j.id]=j,e=0,f=j.children.length;f>e;e++)g=s(p[j.children[e]],j.id,d),h=p[g],j.children_d.push(g),h.children_d.length&&(j.children_d=j.children_d.concat(h.children_d));return delete a.data,delete a.children,p[j.id].original=a,j.state.selected&&l.push(j.id),j.id},t=function(a,b,d){d=d?d.concat():[],b&&d.unshift(b);var e,f,g,h,i,j=!1;do j="j"+n+"_"+ ++o;while(p[j]);i={id:!1,text:"string"==typeof a?a:"",icon:"object"==typeof a&&a.icon!==c?a.icon:!0,parent:b,parents:d,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(e in m)m.hasOwnProperty(e)&&(i.state[e]=m[e]);if(a&&a.id&&(i.id=a.id.toString()),a&&a.text&&(i.text=a.text),a&&a.data&&a.data.jstree&&a.data.jstree.icon&&(i.icon=a.data.jstree.icon),(i.icon===c||null===i.icon||""===i.icon)&&(i.icon=!0),a&&a.data&&(i.data=a.data,a.data.jstree))for(e in a.data.jstree)a.data.jstree.hasOwnProperty(e)&&(i.state[e]=a.data.jstree[e]);if(a&&"object"==typeof a.state)for(e in a.state)a.state.hasOwnProperty(e)&&(i.state[e]=a.state[e]);if(a&&"object"==typeof a.li_attr)for(e in a.li_attr)a.li_attr.hasOwnProperty(e)&&(i.li_attr[e]=a.li_attr[e]);if(i.li_attr.id&&!i.id&&(i.id=i.li_attr.id.toString()),i.id||(i.id=j),i.li_attr.id||(i.li_attr.id=i.id),a&&"object"==typeof a.a_attr)for(e in a.a_attr)a.a_attr.hasOwnProperty(e)&&(i.a_attr[e]=a.a_attr[e]);if(a&&a.children&&a.children.length){for(e=0,f=a.children.length;f>e;e++)g=t(a.children[e],i.id,d),h=p[g],i.children.push(g),h.children_d.length&&(i.children_d=i.children_d.concat(h.children_d));i.children_d=i.children_d.concat(i.children)}return a&&a.children&&a.children===!0&&(i.state.loaded=!1,i.children=[],i.children_d=[]),delete a.data,delete a.children,i.original=a,p[i.id]=i,i.state.selected&&l.push(i.id),i.id};if(h.length&&h[0].id!==c&&h[0].parent!==c){for(e=0,f=h.length;f>e;e++)h[e].children||(h[e].children=[]),p[h[e].id.toString()]=h[e];for(e=0,f=h.length;f>e;e++)p[h[e].parent.toString()].children.push(h[e].id.toString()),q.children_d.push(h[e].id.toString());for(e=0,f=q.children.length;f>e;e++)d=s(p[q.children[e]],i,q.parents.concat()),k.push(d),p[d].children_d.length&&(k=k.concat(p[d].children_d));for(e=0,f=q.parents.length;f>e;e++)p[q.parents[e]].children_d=p[q.parents[e]].children_d.concat(k);g={cnt:o,mod:p,sel:r,par:i,dpc:k,add:l}}else{for(e=0,f=h.length;f>e;e++)d=t(h[e],i,q.parents.concat()),d&&(j.push(d),k.push(d),p[d].children_d.length&&(k=k.concat(p[d].children_d)));for(q.children=j,q.children_d=k,e=0,f=q.parents.length;f>e;e++)p[q.parents[e]].children_d=p[q.parents[e]].children_d.concat(k);g={cnt:o,mod:p,sel:r,par:i,dpc:k,add:l}}return"undefined"!=typeof a&&"undefined"!=typeof a.document?g:void postMessage(g)},j=function(a,c){if(null!==this.element){if(this._cnt=a.cnt,this._model.data=a.mod,c){var d,f,g=a.add,h=a.sel,i=this._data.core.selected.slice(),j=this._model.data;if(h.length!==i.length||b.vakata.array_unique(h.concat(i)).length!==h.length){for(d=0,f=h.length;f>d;d++)-1===b.inArray(h[d],g)&&-1===b.inArray(h[d],i)&&(j[h[d]].state.selected=!1);for(d=0,f=i.length;f>d;d++)-1===b.inArray(i[d],h)&&(j[i[d]].state.selected=!0)}}a.add.length&&(this._data.core.selected=this._data.core.selected.concat(a.add)),this.trigger("model",{nodes:a.dpc,parent:a.par}),"#"!==a.par?(this._node_changed(a.par),this.redraw()):this.redraw(!0),a.add.length&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),e.call(this,!0)}};if(this.settings.core.worker&&a.Blob&&a.URL&&a.Worker)try{null===this._wrk&&(this._wrk=a.URL.createObjectURL(new a.Blob(["self.onmessage = "+i.toString()],{type:"text/javascript"}))),!this._data.core.working||f?(this._data.core.working=!0,g=new a.Worker(this._wrk),g.onmessage=b.proxy(function(a){j.call(this,a.data,!0);try{g.terminate(),g=null}catch(b){}this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1},this),h.par?g.postMessage(h):this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1):this._data.core.worker_queue.push([c,d,e,!0])}catch(k){j.call(this,i(h),!1),this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1}else j.call(this,i(h),!1)}},_parse_model_from_html:function(a,d,e){e=e?[].concat(e):[],d&&e.unshift(d);var f,g,h,i,j,k=this._model.data,l={id:!1,text:!1,icon:!0,parent:d,parents:e,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(h in this._model.default_state)this._model.default_state.hasOwnProperty(h)&&(l.state[h]=this._model.default_state[h]);if(i=b.vakata.attributes(a,!0),b.each(i,function(a,c){return c=b.trim(c),c.length?(l.li_attr[a]=c,void("id"===a&&(l.id=c.toString()))):!0}),i=a.children("a").first(),i.length&&(i=b.vakata.attributes(i,!0),b.each(i,function(a,c){c=b.trim(c),c.length&&(l.a_attr[a]=c)})),i=a.children("a").first().length?a.children("a").first().clone():a.clone(),i.children("ins, i, ul").remove(),i=i.html(),i=b("<div />").html(i),l.text=this.settings.core.force_text?i.text():i.html(),i=a.data(),l.data=i?b.extend(!0,{},i):null,l.state.opened=a.hasClass("jstree-open"),l.state.selected=a.children("a").hasClass("jstree-clicked"),l.state.disabled=a.children("a").hasClass("jstree-disabled"),l.data&&l.data.jstree)for(h in l.data.jstree)l.data.jstree.hasOwnProperty(h)&&(l.state[h]=l.data.jstree[h]);i=a.children("a").children(".jstree-themeicon"),i.length&&(l.icon=i.hasClass("jstree-themeicon-hidden")?!1:i.attr("rel")),l.state.icon!==c&&(l.icon=l.state.icon),(l.icon===c||null===l.icon||""===l.icon)&&(l.icon=!0),i=a.children("ul").children("li");do j="j"+this._id+"_"+ ++this._cnt;while(k[j]);return l.id=l.li_attr.id?l.li_attr.id.toString():j,i.length?(i.each(b.proxy(function(a,c){f=this._parse_model_from_html(b(c),l.id,e),g=this._model.data[f],l.children.push(f),g.children_d.length&&(l.children_d=l.children_d.concat(g.children_d))},this)),l.children_d=l.children_d.concat(l.children)):a.hasClass("jstree-closed")&&(l.state.loaded=!1),l.li_attr["class"]&&(l.li_attr["class"]=l.li_attr["class"].replace("jstree-closed","").replace("jstree-open","")),l.a_attr["class"]&&(l.a_attr["class"]=l.a_attr["class"].replace("jstree-clicked","").replace("jstree-disabled","")),k[l.id]=l,l.state.selected&&this._data.core.selected.push(l.id),l.id},_parse_model_from_flat_json:function(a,b,d){d=d?d.concat():[],b&&d.unshift(b);var e,f,g,h,i=a.id.toString(),j=this._model.data,k=this._model.default_state,l={id:i,text:a.text||"",icon:a.icon!==c?a.icon:!0,parent:b,parents:d,children:a.children||[],children_d:a.children_d||[],data:a.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(e in k)k.hasOwnProperty(e)&&(l.state[e]=k[e]);if(a&&a.data&&a.data.jstree&&a.data.jstree.icon&&(l.icon=a.data.jstree.icon),(l.icon===c||null===l.icon||""===l.icon)&&(l.icon=!0),a&&a.data&&(l.data=a.data,a.data.jstree))for(e in a.data.jstree)a.data.jstree.hasOwnProperty(e)&&(l.state[e]=a.data.jstree[e]);if(a&&"object"==typeof a.state)for(e in a.state)a.state.hasOwnProperty(e)&&(l.state[e]=a.state[e]);if(a&&"object"==typeof a.li_attr)for(e in a.li_attr)a.li_attr.hasOwnProperty(e)&&(l.li_attr[e]=a.li_attr[e]);if(l.li_attr.id||(l.li_attr.id=i),a&&"object"==typeof a.a_attr)for(e in a.a_attr)a.a_attr.hasOwnProperty(e)&&(l.a_attr[e]=a.a_attr[e]);for(a&&a.children&&a.children===!0&&(l.state.loaded=!1,l.children=[],l.children_d=[]),j[l.id]=l,e=0,f=l.children.length;f>e;e++)g=this._parse_model_from_flat_json(j[l.children[e]],l.id,d),h=j[g],l.children_d.push(g),h.children_d.length&&(l.children_d=l.children_d.concat(h.children_d));return delete a.data,delete a.children,j[l.id].original=a,l.state.selected&&this._data.core.selected.push(l.id),l.id},_parse_model_from_json:function(a,b,d){d=d?d.concat():[],b&&d.unshift(b);var e,f,g,h,i,j=!1,k=this._model.data,l=this._model.default_state;do j="j"+this._id+"_"+ ++this._cnt;while(k[j]);i={id:!1,text:"string"==typeof a?a:"",icon:"object"==typeof a&&a.icon!==c?a.icon:!0,parent:b,parents:d,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(e in l)l.hasOwnProperty(e)&&(i.state[e]=l[e]);if(a&&a.id&&(i.id=a.id.toString()),a&&a.text&&(i.text=a.text),a&&a.data&&a.data.jstree&&a.data.jstree.icon&&(i.icon=a.data.jstree.icon),(i.icon===c||null===i.icon||""===i.icon)&&(i.icon=!0),a&&a.data&&(i.data=a.data,a.data.jstree))for(e in a.data.jstree)a.data.jstree.hasOwnProperty(e)&&(i.state[e]=a.data.jstree[e]);if(a&&"object"==typeof a.state)for(e in a.state)a.state.hasOwnProperty(e)&&(i.state[e]=a.state[e]);if(a&&"object"==typeof a.li_attr)for(e in a.li_attr)a.li_attr.hasOwnProperty(e)&&(i.li_attr[e]=a.li_attr[e]);if(i.li_attr.id&&!i.id&&(i.id=i.li_attr.id.toString()),i.id||(i.id=j),i.li_attr.id||(i.li_attr.id=i.id),a&&"object"==typeof a.a_attr)for(e in a.a_attr)a.a_attr.hasOwnProperty(e)&&(i.a_attr[e]=a.a_attr[e]);if(a&&a.children&&a.children.length){for(e=0,f=a.children.length;f>e;e++)g=this._parse_model_from_json(a.children[e],i.id,d),h=k[g],i.children.push(g),h.children_d.length&&(i.children_d=i.children_d.concat(h.children_d));i.children_d=i.children_d.concat(i.children)}return a&&a.children&&a.children===!0&&(i.state.loaded=!1,i.children=[],i.children_d=[]),delete a.data,delete a.children,i.original=a,k[i.id]=i,i.state.selected&&this._data.core.selected.push(i.id),i.id},_redraw:function(){var a,b,c,d=this._model.force_full_redraw?this._model.data["#"].children.concat([]):this._model.changed.concat([]),e=l.createElement("UL"),f=this._data.core.focused;for(b=0,c=d.length;c>b;b++)a=this.redraw_node(d[b],!0,this._model.force_full_redraw),a&&this._model.force_full_redraw&&e.appendChild(a);this._model.force_full_redraw&&(e.className=this.get_container_ul()[0]?this.get_container_ul()[0].className:null,e.setAttribute("role","group"),this.element.empty().append(e)),null!==f&&(a=this.get_node(f,!0),a&&a.length&&a.children(".jstree-anchor")[0]!==l.activeElement?a.children(".jstree-anchor").focus():this._data.core.focused=null),this._model.force_full_redraw=!1,this._model.changed=[],this.trigger("redraw",{nodes:d})},redraw:function(a){a&&(this._model.force_full_redraw=!0),this._redraw()},draw_children:function(a){var b=this.get_node(a),c=!1,d=!1,e=!1,f=l;if(!b)return!1;if("#"===b.id)return this.redraw(!0);if(a=this.get_node(a,!0),!a||!a.length)return!1;if(a.children(".jstree-children").remove(),a=a[0],b.children.length&&b.state.loaded){for(e=f.createElement("UL"),e.setAttribute("role","group"),e.className="jstree-children",c=0,d=b.children.length;d>c;c++)e.appendChild(this.redraw_node(b.children[c],!0,!0));a.appendChild(e)}},redraw_node:function(a,c,d,e){var f=this.get_node(a),g=!1,h=!1,i=!1,j=!1,k=!1,n=!1,o="",p=l,q=this._model.data,r=!1,s=null,t=0,u=0;if(!f)return!1;if("#"===f.id)return this.redraw(!0);if(c=c||0===f.children.length,a=l.querySelector?this.element[0].querySelector("#"+(-1!=="0123456789".indexOf(f.id[0])?"\\3"+f.id[0]+" "+f.id.substr(1).replace(b.jstree.idregex,"\\$&"):f.id.replace(b.jstree.idregex,"\\$&"))):l.getElementById(f.id))a=b(a),d||(g=a.parent().parent()[0],g===this.element[0]&&(g=null),h=a.index()),c||!f.children.length||a.children(".jstree-children").length||(c=!0),c||(i=a.children(".jstree-children")[0]),r=a.children(".jstree-anchor")[0]===l.activeElement,a.remove();else if(c=!0,!d){if(g="#"!==f.parent?b("#"+f.parent.replace(b.jstree.idregex,"\\$&"),this.element)[0]:null,!(null===g||g&&q[f.parent].state.opened))return!1;h=b.inArray(f.id,null===g?q["#"].children:q[f.parent].children)}a=m.cloneNode(!0),o="jstree-node ";for(j in f.li_attr)if(f.li_attr.hasOwnProperty(j)){if("id"===j)continue;"class"!==j?a.setAttribute(j,f.li_attr[j]):o+=f.li_attr[j]}f.a_attr.id||(f.a_attr.id=f.id+"_anchor"),a.setAttribute("aria-selected",!!f.state.selected),a.setAttribute("aria-level",f.parents.length),a.setAttribute("aria-labelledby",f.a_attr.id),f.state.disabled&&a.setAttribute("aria-disabled",!0),f.state.loaded&&!f.children.length?o+=" jstree-leaf":(o+=f.state.opened&&f.state.loaded?" jstree-open":" jstree-closed",a.setAttribute("aria-expanded",f.state.opened&&f.state.loaded)),null!==f.parent&&q[f.parent].children[q[f.parent].children.length-1]===f.id&&(o+=" jstree-last"),a.id=f.id,a.className=o,o=(f.state.selected?" jstree-clicked":"")+(f.state.disabled?" jstree-disabled":"");for(k in f.a_attr)if(f.a_attr.hasOwnProperty(k)){if("href"===k&&"#"===f.a_attr[k])continue;"class"!==k?a.childNodes[1].setAttribute(k,f.a_attr[k]):o+=" "+f.a_attr[k]}if(o.length&&(a.childNodes[1].className="jstree-anchor "+o),(f.icon&&f.icon!==!0||f.icon===!1)&&(f.icon===!1?a.childNodes[1].childNodes[0].className+=" jstree-themeicon-hidden":-1===f.icon.indexOf("/")&&-1===f.icon.indexOf(".")?a.childNodes[1].childNodes[0].className+=" "+f.icon+" jstree-themeicon-custom":(a.childNodes[1].childNodes[0].style.backgroundImage="url("+f.icon+")",a.childNodes[1].childNodes[0].style.backgroundPosition="center center",a.childNodes[1].childNodes[0].style.backgroundSize="auto",a.childNodes[1].childNodes[0].className+=" jstree-themeicon-custom")),this.settings.core.force_text?a.childNodes[1].appendChild(p.createTextNode(f.text)):a.childNodes[1].innerHTML+=f.text,c&&f.children.length&&(f.state.opened||e)&&f.state.loaded){for(n=p.createElement("UL"),n.setAttribute("role","group"),n.className="jstree-children",j=0,k=f.children.length;k>j;j++)n.appendChild(this.redraw_node(f.children[j],c,!0));a.appendChild(n)}if(i&&a.appendChild(i),!d){for(g||(g=this.element[0]),j=0,k=g.childNodes.length;k>j;j++)if(g.childNodes[j]&&g.childNodes[j].className&&-1!==g.childNodes[j].className.indexOf("jstree-children")){s=g.childNodes[j];break}s||(s=p.createElement("UL"),s.setAttribute("role","group"),s.className="jstree-children",g.appendChild(s)),g=s,h<g.childNodes.length?g.insertBefore(a,g.childNodes[h]):g.appendChild(a),r&&(t=this.element[0].scrollTop,u=this.element[0].scrollLeft,a.childNodes[1].focus(),this.element[0].scrollTop=t,this.element[0].scrollLeft=u)}return f.state.opened&&!f.state.loaded&&(f.state.opened=!1,setTimeout(b.proxy(function(){this.open_node(f.id,!1,0)},this),0)),a},open_node:function(a,d,e){var f,g,h,i;if(b.isArray(a)){for(a=a.slice(),f=0,g=a.length;g>f;f++)this.open_node(a[f],d,e);return!0}if(a=this.get_node(a),!a||"#"===a.id)return!1;if(e=e===c?this.settings.core.animation:e,!this.is_closed(a))return d&&d.call(this,a,!1),!1;if(this.is_loaded(a))h=this.get_node(a,!0),i=this,h.length&&(e&&h.children(".jstree-children").length&&h.children(".jstree-children").stop(!0,!0),a.children.length&&!this._firstChild(h.children(".jstree-children")[0])&&this.draw_children(a),e?(this.trigger("before_open",{node:a}),h.children(".jstree-children").css("display","none").end().removeClass("jstree-closed").addClass("jstree-open").attr("aria-expanded",!0).children(".jstree-children").stop(!0,!0).slideDown(e,function(){this.style.display="",i.trigger("after_open",{node:a})})):(this.trigger("before_open",{node:a}),h[0].className=h[0].className.replace("jstree-closed","jstree-open"),h[0].setAttribute("aria-expanded",!0))),a.state.opened=!0,d&&d.call(this,a,!0),h.length||this.trigger("before_open",{node:a}),this.trigger("open_node",{node:a}),e&&h.length||this.trigger("after_open",{node:a});else{if(this.is_loading(a))return setTimeout(b.proxy(function(){this.open_node(a,d,e)},this),500);this.load_node(a,function(a,b){return b?this.open_node(a,d,e):d?d.call(this,a,!1):!1})}},_open_to:function(a){if(a=this.get_node(a),!a||"#"===a.id)return!1;var c,d,e=a.parents;for(c=0,d=e.length;d>c;c+=1)"#"!==c&&this.open_node(e[c],!1,0);return b("#"+a.id.replace(b.jstree.idregex,"\\$&"),this.element)},close_node:function(a,d){var e,f,g,h;if(b.isArray(a)){for(a=a.slice(),e=0,f=a.length;f>e;e++)this.close_node(a[e],d);return!0}return a=this.get_node(a),a&&"#"!==a.id?this.is_closed(a)?!1:(d=d===c?this.settings.core.animation:d,
g=this,h=this.get_node(a,!0),h.length&&(d?h.children(".jstree-children").attr("style","display:block !important").end().removeClass("jstree-open").addClass("jstree-closed").attr("aria-expanded",!1).children(".jstree-children").stop(!0,!0).slideUp(d,function(){this.style.display="",h.children(".jstree-children").remove(),g.trigger("after_close",{node:a})}):(h[0].className=h[0].className.replace("jstree-open","jstree-closed"),h.attr("aria-expanded",!1).children(".jstree-children").remove())),a.state.opened=!1,this.trigger("close_node",{node:a}),void(d&&h.length||this.trigger("after_close",{node:a}))):!1},toggle_node:function(a){var c,d;if(b.isArray(a)){for(a=a.slice(),c=0,d=a.length;d>c;c++)this.toggle_node(a[c]);return!0}return this.is_closed(a)?this.open_node(a):this.is_open(a)?this.close_node(a):void 0},open_all:function(a,b,c){if(a||(a="#"),a=this.get_node(a),!a)return!1;var d,e,f,g="#"===a.id?this.get_container_ul():this.get_node(a,!0);if(!g.length){for(d=0,e=a.children_d.length;e>d;d++)this.is_closed(this._model.data[a.children_d[d]])&&(this._model.data[a.children_d[d]].state.opened=!0);return this.trigger("open_all",{node:a})}c=c||g,f=this,g=this.is_closed(a)?g.find(".jstree-closed").addBack():g.find(".jstree-closed"),g.each(function(){f.open_node(this,function(a,d){d&&this.is_parent(a)&&this.open_all(a,b,c)},b||0)}),0===c.find(".jstree-closed").length&&this.trigger("open_all",{node:this.get_node(c)})},close_all:function(a,c){if(a||(a="#"),a=this.get_node(a),!a)return!1;var d,e,f="#"===a.id?this.get_container_ul():this.get_node(a,!0),g=this;if(!f.length){for(d=0,e=a.children_d.length;e>d;d++)this._model.data[a.children_d[d]].state.opened=!1;return this.trigger("close_all",{node:a})}f=this.is_open(a)?f.find(".jstree-open").addBack():f.find(".jstree-open"),b(f.get().reverse()).each(function(){g.close_node(this,c||0)}),this.trigger("close_all",{node:a})},is_disabled:function(a){return a=this.get_node(a),a&&a.state&&a.state.disabled},enable_node:function(a){var c,d;if(b.isArray(a)){for(a=a.slice(),c=0,d=a.length;d>c;c++)this.enable_node(a[c]);return!0}return a=this.get_node(a),a&&"#"!==a.id?(a.state.disabled=!1,this.get_node(a,!0).children(".jstree-anchor").removeClass("jstree-disabled").attr("aria-disabled",!1),void this.trigger("enable_node",{node:a})):!1},disable_node:function(a){var c,d;if(b.isArray(a)){for(a=a.slice(),c=0,d=a.length;d>c;c++)this.disable_node(a[c]);return!0}return a=this.get_node(a),a&&"#"!==a.id?(a.state.disabled=!0,this.get_node(a,!0).children(".jstree-anchor").addClass("jstree-disabled").attr("aria-disabled",!0),void this.trigger("disable_node",{node:a})):!1},activate_node:function(a,b){if(this.is_disabled(a))return!1;if(this._data.core.last_clicked=this._data.core.last_clicked&&this._data.core.last_clicked.id!==c?this.get_node(this._data.core.last_clicked.id):null,this._data.core.last_clicked&&!this._data.core.last_clicked.state.selected&&(this._data.core.last_clicked=null),!this._data.core.last_clicked&&this._data.core.selected.length&&(this._data.core.last_clicked=this.get_node(this._data.core.selected[this._data.core.selected.length-1])),this.settings.core.multiple&&(b.metaKey||b.ctrlKey||b.shiftKey)&&(!b.shiftKey||this._data.core.last_clicked&&this.get_parent(a)&&this.get_parent(a)===this._data.core.last_clicked.parent))if(b.shiftKey){var d,e,f=this.get_node(a).id,g=this._data.core.last_clicked.id,h=this.get_node(this._data.core.last_clicked.parent).children,i=!1;for(d=0,e=h.length;e>d;d+=1)h[d]===f&&(i=!i),h[d]===g&&(i=!i),this.is_disabled(h[d])||!i&&h[d]!==f&&h[d]!==g?this.deselect_node(h[d],!0,b):this.select_node(h[d],!0,!1,b);this.trigger("changed",{action:"select_node",node:this.get_node(a),selected:this._data.core.selected,event:b})}else this.is_selected(a)?this.deselect_node(a,!1,b):this.select_node(a,!1,!1,b);else!this.settings.core.multiple&&(b.metaKey||b.ctrlKey||b.shiftKey)&&this.is_selected(a)?this.deselect_node(a,!1,b):(this.deselect_all(!0),this.select_node(a,!1,!1,b),this._data.core.last_clicked=this.get_node(a));this.trigger("activate_node",{node:this.get_node(a)})},hover_node:function(a){if(a=this.get_node(a,!0),!a||!a.length||a.children(".jstree-hovered").length)return!1;var b=this.element.find(".jstree-hovered"),c=this.element;b&&b.length&&this.dehover_node(b),a.children(".jstree-anchor").addClass("jstree-hovered"),this.trigger("hover_node",{node:this.get_node(a)}),setTimeout(function(){c.attr("aria-activedescendant",a[0].id)},0)},dehover_node:function(a){return a=this.get_node(a,!0),a&&a.length&&a.children(".jstree-hovered").length?(a.children(".jstree-anchor").removeClass("jstree-hovered"),void this.trigger("dehover_node",{node:this.get_node(a)})):!1},select_node:function(a,c,d,e){var f,g,h;if(b.isArray(a)){for(a=a.slice(),g=0,h=a.length;h>g;g++)this.select_node(a[g],c,d,e);return!0}return a=this.get_node(a),a&&"#"!==a.id?(f=this.get_node(a,!0),void(a.state.selected||(a.state.selected=!0,this._data.core.selected.push(a.id),d||(f=this._open_to(a)),f&&f.length&&f.attr("aria-selected",!0).children(".jstree-anchor").addClass("jstree-clicked"),this.trigger("select_node",{node:a,selected:this._data.core.selected,event:e}),c||this.trigger("changed",{action:"select_node",node:a,selected:this._data.core.selected,event:e})))):!1},deselect_node:function(a,c,d){var e,f,g;if(b.isArray(a)){for(a=a.slice(),e=0,f=a.length;f>e;e++)this.deselect_node(a[e],c,d);return!0}return a=this.get_node(a),a&&"#"!==a.id?(g=this.get_node(a,!0),void(a.state.selected&&(a.state.selected=!1,this._data.core.selected=b.vakata.array_remove_item(this._data.core.selected,a.id),g.length&&g.attr("aria-selected",!1).children(".jstree-anchor").removeClass("jstree-clicked"),this.trigger("deselect_node",{node:a,selected:this._data.core.selected,event:d}),c||this.trigger("changed",{action:"deselect_node",node:a,selected:this._data.core.selected,event:d})))):!1},select_all:function(a){var b,c,d=this._data.core.selected.concat([]);for(this._data.core.selected=this._model.data["#"].children_d.concat(),b=0,c=this._data.core.selected.length;c>b;b++)this._model.data[this._data.core.selected[b]]&&(this._model.data[this._data.core.selected[b]].state.selected=!0);this.redraw(!0),this.trigger("select_all",{selected:this._data.core.selected}),a||this.trigger("changed",{action:"select_all",selected:this._data.core.selected,old_selection:d})},deselect_all:function(a){var b,c,d=this._data.core.selected.concat([]);for(b=0,c=this._data.core.selected.length;c>b;b++)this._model.data[this._data.core.selected[b]]&&(this._model.data[this._data.core.selected[b]].state.selected=!1);this._data.core.selected=[],this.element.find(".jstree-clicked").removeClass("jstree-clicked").parent().attr("aria-selected",!1),this.trigger("deselect_all",{selected:this._data.core.selected,node:d}),a||this.trigger("changed",{action:"deselect_all",selected:this._data.core.selected,old_selection:d})},is_selected:function(a){return a=this.get_node(a),a&&"#"!==a.id?a.state.selected:!1},get_selected:function(a){return a?b.map(this._data.core.selected,b.proxy(function(a){return this.get_node(a)},this)):this._data.core.selected.slice()},get_top_selected:function(a){var c,d,e,f,g=this.get_selected(!0),h={};for(c=0,d=g.length;d>c;c++)h[g[c].id]=g[c];for(c=0,d=g.length;d>c;c++)for(e=0,f=g[c].children_d.length;f>e;e++)h[g[c].children_d[e]]&&delete h[g[c].children_d[e]];g=[];for(c in h)h.hasOwnProperty(c)&&g.push(c);return a?b.map(g,b.proxy(function(a){return this.get_node(a)},this)):g},get_bottom_selected:function(a){var c,d,e=this.get_selected(!0),f=[];for(c=0,d=e.length;d>c;c++)e[c].children.length||f.push(e[c].id);return a?b.map(f,b.proxy(function(a){return this.get_node(a)},this)):f},get_state:function(){var a,b={core:{open:[],scroll:{left:this.element.scrollLeft(),top:this.element.scrollTop()},selected:[]}};for(a in this._model.data)this._model.data.hasOwnProperty(a)&&"#"!==a&&(this._model.data[a].state.opened&&b.core.open.push(a),this._model.data[a].state.selected&&b.core.selected.push(a));return b},set_state:function(a,d){if(a){if(a.core){var e,f;if(a.core.open)return b.isArray(a.core.open)&&a.core.open.length?this._load_nodes(a.core.open,function(b){this.open_node(b,!1,0),delete a.core.open,this.set_state(a,d)},!0):(delete a.core.open,this.set_state(a,d)),!1;if(a.core.scroll)return a.core.scroll&&a.core.scroll.left!==c&&this.element.scrollLeft(a.core.scroll.left),a.core.scroll&&a.core.scroll.top!==c&&this.element.scrollTop(a.core.scroll.top),delete a.core.scroll,this.set_state(a,d),!1;if(a.core.selected)return e=this,this.deselect_all(),b.each(a.core.selected,function(a,b){e.select_node(b,!1,!0)}),delete a.core.selected,this.set_state(a,d),!1;for(f in a)a.hasOwnProperty(f)&&"core"!==f&&-1===b.inArray(f,this.settings.plugins)&&delete a[f];if(b.isEmptyObject(a.core))return delete a.core,this.set_state(a,d),!1}return b.isEmptyObject(a)?(a=null,d&&d.call(this),this.trigger("set_state"),!1):!0}return!1},refresh:function(a,c){this._data.core.state=c===!0?{}:this.get_state(),c&&b.isFunction(c)&&(this._data.core.state=c.call(this,this._data.core.state)),this._cnt=0,this._model.data={"#":{id:"#",parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}}};var d=this.get_container_ul()[0].className;a||(this.element.html("<ul class='"+d+"' role='group'><li class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='treeitem' id='j"+this._id+"_loading'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),this.element.attr("aria-activedescendant","j"+this._id+"_loading")),this.load_node("#",function(a,c){c&&(this.get_container_ul()[0].className=d,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.set_state(b.extend(!0,{},this._data.core.state),function(){this.trigger("refresh")})),this._data.core.state=null})},refresh_node:function(a){if(a=this.get_node(a),!a||"#"===a.id)return!1;var c=[],d=[];this._data.core.selected.concat([]);d.push(a.id),a.state.opened===!0&&c.push(a.id),this.get_node(a,!0).find(".jstree-open").each(function(){c.push(this.id)}),this._load_nodes(d,b.proxy(function(b){this.open_node(c,!1,0),this.select_node(this._data.core.selected),this.trigger("refresh_node",{node:a,nodes:b})},this))},set_id:function(a,c){if(a=this.get_node(a),!a||"#"===a.id)return!1;var d,e,f=this._model.data;for(c=c.toString(),f[a.parent].children[b.inArray(a.id,f[a.parent].children)]=c,d=0,e=a.parents.length;e>d;d++)f[a.parents[d]].children_d[b.inArray(a.id,f[a.parents[d]].children_d)]=c;for(d=0,e=a.children.length;e>d;d++)f[a.children[d]].parent=c;for(d=0,e=a.children_d.length;e>d;d++)f[a.children_d[d]].parents[b.inArray(a.id,f[a.children_d[d]].parents)]=c;return d=b.inArray(a.id,this._data.core.selected),-1!==d&&(this._data.core.selected[d]=c),d=this.get_node(a.id,!0),d&&(d.attr("id",c).children(".jstree-anchor").attr("id",c+"_anchor").end().attr("aria-labelledby",c+"_anchor"),this.element.attr("aria-activedescendant")===a.id&&this.element.attr("aria-activedescendant",c)),delete f[a.id],a.id=c,a.li_attr.id=c,f[c]=a,!0},get_text:function(a){return a=this.get_node(a),a&&"#"!==a.id?a.text:!1},set_text:function(a,c){var d,e;if(b.isArray(a)){for(a=a.slice(),d=0,e=a.length;e>d;d++)this.set_text(a[d],c);return!0}return a=this.get_node(a),a&&"#"!==a.id?(a.text=c,this.get_node(a,!0).length&&this.redraw_node(a.id),this.trigger("set_text",{obj:a,text:c}),!0):!1},get_json:function(a,c,d){if(a=this.get_node(a||"#"),!a)return!1;c&&c.flat&&!d&&(d=[]);var e,f,g={id:a.id,text:a.text,icon:this.get_icon(a),li_attr:b.extend(!0,{},a.li_attr),a_attr:b.extend(!0,{},a.a_attr),state:{},data:c&&c.no_data?!1:b.extend(!0,{},a.data)};if(c&&c.flat?g.parent=a.parent:g.children=[],!c||!c.no_state)for(e in a.state)a.state.hasOwnProperty(e)&&(g.state[e]=a.state[e]);if(c&&c.no_id&&(delete g.id,g.li_attr&&g.li_attr.id&&delete g.li_attr.id,g.a_attr&&g.a_attr.id&&delete g.a_attr.id),c&&c.flat&&"#"!==a.id&&d.push(g),!c||!c.no_children)for(e=0,f=a.children.length;f>e;e++)c&&c.flat?this.get_json(a.children[e],c,d):g.children.push(this.get_json(a.children[e],c));return c&&c.flat?d:"#"===a.id?g.children:g},create_node:function(a,d,e,f,g){if(null===a&&(a="#"),a=this.get_node(a),!a)return!1;if(e=e===c?"last":e,!e.toString().match(/^(before|after)$/)&&!g&&!this.is_loaded(a))return this.load_node(a,function(){this.create_node(a,d,e,f,!0)});d||(d={text:this.get_string("New node")}),"string"==typeof d&&(d={text:d}),d.text===c&&(d.text=this.get_string("New node"));var h,i,j,k;switch("#"===a.id&&("before"===e&&(e="first"),"after"===e&&(e="last")),e){case"before":h=this.get_node(a.parent),e=b.inArray(a.id,h.children),a=h;break;case"after":h=this.get_node(a.parent),e=b.inArray(a.id,h.children)+1,a=h;break;case"inside":case"first":e=0;break;case"last":e=a.children.length;break;default:e||(e=0)}if(e>a.children.length&&(e=a.children.length),d.id||(d.id=!0),!this.check("create_node",d,a,e))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(d.id===!0&&delete d.id,d=this._parse_model_from_json(d,a.id,a.parents.concat()),!d)return!1;for(h=this.get_node(d),i=[],i.push(d),i=i.concat(h.children_d),this.trigger("model",{nodes:i,parent:a.id}),a.children_d=a.children_d.concat(i),j=0,k=a.parents.length;k>j;j++)this._model.data[a.parents[j]].children_d=this._model.data[a.parents[j]].children_d.concat(i);for(d=h,h=[],j=0,k=a.children.length;k>j;j++)h[j>=e?j+1:j]=a.children[j];return h[e]=d.id,a.children=h,this.redraw_node(a,!0),f&&f.call(this,this.get_node(d)),this.trigger("create_node",{node:this.get_node(d),parent:a.id,position:e}),d.id},rename_node:function(a,c){var d,e,f;if(b.isArray(a)){for(a=a.slice(),d=0,e=a.length;e>d;d++)this.rename_node(a[d],c);return!0}return a=this.get_node(a),a&&"#"!==a.id?(f=a.text,this.check("rename_node",a,this.get_parent(a),c)?(this.set_text(a,c),this.trigger("rename_node",{node:a,text:c,old:f}),!0):(this.settings.core.error.call(this,this._data.core.last_error),!1)):!1},delete_node:function(a){var c,d,e,f,g,h,i,j,k,l;if(b.isArray(a)){for(a=a.slice(),c=0,d=a.length;d>c;c++)this.delete_node(a[c]);return!0}if(a=this.get_node(a),!a||"#"===a.id)return!1;if(e=this.get_node(a.parent),f=b.inArray(a.id,e.children),l=!1,!this.check("delete_node",a,e,f))return this.settings.core.error.call(this,this._data.core.last_error),!1;for(-1!==f&&(e.children=b.vakata.array_remove(e.children,f)),g=a.children_d.concat([]),g.push(a.id),j=0,k=g.length;k>j;j++){for(h=0,i=a.parents.length;i>h;h++)f=b.inArray(g[j],this._model.data[a.parents[h]].children_d),-1!==f&&(this._model.data[a.parents[h]].children_d=b.vakata.array_remove(this._model.data[a.parents[h]].children_d,f));this._model.data[g[j]].state.selected&&(l=!0,f=b.inArray(g[j],this._data.core.selected),-1!==f&&(this._data.core.selected=b.vakata.array_remove(this._data.core.selected,f)))}for(this.trigger("delete_node",{node:a,parent:e.id}),l&&this.trigger("changed",{action:"delete_node",node:a,selected:this._data.core.selected,parent:e.id}),j=0,k=g.length;k>j;j++)delete this._model.data[g[j]];return this.redraw_node(e,!0),!0},check:function(a,c,d,e,f){c=c&&c.id?c:this.get_node(c),d=d&&d.id?d:this.get_node(d);var g=a.match(/^move_node|copy_node|create_node$/i)?d:c,h=this.settings.core.check_callback;return"move_node"!==a&&"copy_node"!==a||f&&f.is_multi||c.id!==d.id&&b.inArray(c.id,d.children)!==e&&-1===b.inArray(d.id,c.children_d)?(g&&g.data&&(g=g.data),g&&g.functions&&(g.functions[a]===!1||g.functions[a]===!0)?(g.functions[a]===!1&&(this._data.core.last_error={error:"check",plugin:"core",id:"core_02",reason:"Node data prevents function: "+a,data:JSON.stringify({chk:a,pos:e,obj:c&&c.id?c.id:!1,par:d&&d.id?d.id:!1})}),g.functions[a]):h===!1||b.isFunction(h)&&h.call(this,a,c,d,e,f)===!1||h&&h[a]===!1?(this._data.core.last_error={error:"check",plugin:"core",id:"core_03",reason:"User config for core.check_callback prevents function: "+a,data:JSON.stringify({chk:a,pos:e,obj:c&&c.id?c.id:!1,par:d&&d.id?d.id:!1})},!1):!0):(this._data.core.last_error={error:"check",plugin:"core",id:"core_01",reason:"Moving parent inside child",data:JSON.stringify({chk:a,pos:e,obj:c&&c.id?c.id:!1,par:d&&d.id?d.id:!1})},!1)},last_error:function(){return this._data.core.last_error},move_node:function(a,d,e,f,g,h,i){var j,k,l,m,n,o,p,q,r,s,t,u,v,w;if(d=this.get_node(d),e=e===c?0:e,!d)return!1;if(!e.toString().match(/^(before|after)$/)&&!g&&!this.is_loaded(d))return this.load_node(d,function(){this.move_node(a,d,e,f,!0,!1,i)});if(b.isArray(a)){if(1!==a.length){for(j=0,k=a.length;k>j;j++)(r=this.move_node(a[j],d,e,f,g,!1,i))&&(d=r,e="after");return this.redraw(),!0}a=a[0]}if(a=a&&a.id?a:this.get_node(a),!a||"#"===a.id)return!1;if(l=(a.parent||"#").toString(),n=e.toString().match(/^(before|after)$/)&&"#"!==d.id?this.get_node(d.parent):d,o=i?i:this._model.data[a.id]?this:b.jstree.reference(a.id),p=!o||!o._id||this._id!==o._id,m=o&&o._id&&l&&o._model.data[l]&&o._model.data[l].children?b.inArray(a.id,o._model.data[l].children):-1,o&&o._id&&(a=o._model.data[a.id]),p)return(r=this.copy_node(a,d,e,f,g,!1,i))?(o&&o.delete_node(a),r):!1;switch("#"===d.id&&("before"===e&&(e="first"),"after"===e&&(e="last")),e){case"before":e=b.inArray(d.id,n.children);break;case"after":e=b.inArray(d.id,n.children)+1;break;case"inside":case"first":e=0;break;case"last":e=n.children.length;break;default:e||(e=0)}if(e>n.children.length&&(e=n.children.length),!this.check("move_node",a,n,e,{core:!0,origin:i,is_multi:o&&o._id&&o._id!==this._id,is_foreign:!o||!o._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(a.parent===n.id){for(q=n.children.concat(),r=b.inArray(a.id,q),-1!==r&&(q=b.vakata.array_remove(q,r),e>r&&e--),r=[],s=0,t=q.length;t>s;s++)r[s>=e?s+1:s]=q[s];r[e]=a.id,n.children=r,this._node_changed(n.id),this.redraw("#"===n.id)}else{for(r=a.children_d.concat(),r.push(a.id),s=0,t=a.parents.length;t>s;s++){for(q=[],w=o._model.data[a.parents[s]].children_d,u=0,v=w.length;v>u;u++)-1===b.inArray(w[u],r)&&q.push(w[u]);o._model.data[a.parents[s]].children_d=q}for(o._model.data[l].children=b.vakata.array_remove_item(o._model.data[l].children,a.id),s=0,t=n.parents.length;t>s;s++)this._model.data[n.parents[s]].children_d=this._model.data[n.parents[s]].children_d.concat(r);for(q=[],s=0,t=n.children.length;t>s;s++)q[s>=e?s+1:s]=n.children[s];for(q[e]=a.id,n.children=q,n.children_d.push(a.id),n.children_d=n.children_d.concat(a.children_d),a.parent=n.id,r=n.parents.concat(),r.unshift(n.id),w=a.parents.length,a.parents=r,r=r.concat(),s=0,t=a.children_d.length;t>s;s++)this._model.data[a.children_d[s]].parents=this._model.data[a.children_d[s]].parents.slice(0,-1*w),Array.prototype.push.apply(this._model.data[a.children_d[s]].parents,r);("#"===l||"#"===n.id)&&(this._model.force_full_redraw=!0),this._model.force_full_redraw||(this._node_changed(l),this._node_changed(n.id)),h||this.redraw()}return f&&f.call(this,a,n,e),this.trigger("move_node",{node:a,parent:n.id,position:e,old_parent:l,old_position:m,is_multi:o&&o._id&&o._id!==this._id,is_foreign:!o||!o._id,old_instance:o,new_instance:this}),a.id},copy_node:function(a,d,e,f,g,h,i){var j,k,l,m,n,o,p,q,r,s,t;if(d=this.get_node(d),e=e===c?0:e,!d)return!1;if(!e.toString().match(/^(before|after)$/)&&!g&&!this.is_loaded(d))return this.load_node(d,function(){this.copy_node(a,d,e,f,!0,!1,i)});if(b.isArray(a)){if(1!==a.length){for(j=0,k=a.length;k>j;j++)(m=this.copy_node(a[j],d,e,f,g,!0,i))&&(d=m,e="after");return this.redraw(),!0}a=a[0]}if(a=a&&a.id?a:this.get_node(a),!a||"#"===a.id)return!1;switch(q=(a.parent||"#").toString(),r=e.toString().match(/^(before|after)$/)&&"#"!==d.id?this.get_node(d.parent):d,s=i?i:this._model.data[a.id]?this:b.jstree.reference(a.id),t=!s||!s._id||this._id!==s._id,s&&s._id&&(a=s._model.data[a.id]),"#"===d.id&&("before"===e&&(e="first"),"after"===e&&(e="last")),e){case"before":e=b.inArray(d.id,r.children);break;case"after":e=b.inArray(d.id,r.children)+1;break;case"inside":case"first":e=0;break;case"last":e=r.children.length;break;default:e||(e=0)}if(e>r.children.length&&(e=r.children.length),!this.check("copy_node",a,r,e,{core:!0,origin:i,is_multi:s&&s._id&&s._id!==this._id,is_foreign:!s||!s._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(p=s?s.get_json(a,{no_id:!0,no_data:!0,no_state:!0}):a,!p)return!1;if(p.id===!0&&delete p.id,p=this._parse_model_from_json(p,r.id,r.parents.concat()),!p)return!1;for(m=this.get_node(p),a&&a.state&&a.state.loaded===!1&&(m.state.loaded=!1),l=[],l.push(p),l=l.concat(m.children_d),this.trigger("model",{nodes:l,parent:r.id}),n=0,o=r.parents.length;o>n;n++)this._model.data[r.parents[n]].children_d=this._model.data[r.parents[n]].children_d.concat(l);for(l=[],n=0,o=r.children.length;o>n;n++)l[n>=e?n+1:n]=r.children[n];return l[e]=m.id,r.children=l,r.children_d.push(m.id),r.children_d=r.children_d.concat(m.children_d),"#"===r.id&&(this._model.force_full_redraw=!0),this._model.force_full_redraw||this._node_changed(r.id),h||this.redraw("#"===r.id),f&&f.call(this,m,r,e),this.trigger("copy_node",{node:m,original:a,parent:r.id,position:e,old_parent:q,old_position:s&&s._id&&q&&s._model.data[q]&&s._model.data[q].children?b.inArray(a.id,s._model.data[q].children):-1,is_multi:s&&s._id&&s._id!==this._id,is_foreign:!s||!s._id,old_instance:s,new_instance:this}),m.id},cut:function(a){if(a||(a=this._data.core.selected.concat()),b.isArray(a)||(a=[a]),!a.length)return!1;var c,d,e,f=[];for(d=0,e=a.length;e>d;d++)c=this.get_node(a[d]),c&&c.id&&"#"!==c.id&&f.push(c);return f.length?(g=f,i=this,h="move_node",void this.trigger("cut",{node:a})):!1},copy:function(a){if(a||(a=this._data.core.selected.concat()),b.isArray(a)||(a=[a]),!a.length)return!1;var c,d,e,f=[];for(d=0,e=a.length;e>d;d++)c=this.get_node(a[d]),c&&c.id&&"#"!==c.id&&f.push(c);return f.length?(g=f,i=this,h="copy_node",void this.trigger("copy",{node:a})):!1},get_buffer:function(){return{mode:h,node:g,inst:i}},can_paste:function(){return h!==!1&&g!==!1},paste:function(a,b){return a=this.get_node(a),a&&h&&h.match(/^(copy_node|move_node)$/)&&g?(this[h](g,a,b,!1,!1,!1,i)&&this.trigger("paste",{parent:a.id,node:g,mode:h}),g=!1,h=!1,void(i=!1)):!1},clear_buffer:function(){g=!1,h=!1,i=!1,this.trigger("clear_buffer")},edit:function(a,c,d){var e,f,g,h,i,j,k,l,m;return(a=this.get_node(a))?this.settings.core.check_callback===!1?(this._data.core.last_error={error:"check",plugin:"core",id:"core_07",reason:"Could not edit node because of check_callback"},this.settings.core.error.call(this,this._data.core.last_error),!1):(m=a,c="string"==typeof c?c:a.text,this.set_text(a,""),a=this._open_to(a),m.text=c,e=this._data.core.rtl,f=this.element.width(),g=a.children(".jstree-anchor"),h=b("<span>"),i=c,j=b("<div />",{css:{position:"absolute",top:"-200px",left:e?"0px":"-1000px",visibility:"hidden"}}).appendTo("body"),k=b("<input />",{value:i,"class":"jstree-rename-input",css:{padding:"0",border:"1px solid silver","box-sizing":"border-box",display:"inline-block",height:this._data.core.li_height+"px",lineHeight:this._data.core.li_height+"px",width:"150px"},blur:b.proxy(function(){var c,e=h.children(".jstree-rename-input"),f=e.val(),k=this.settings.core.force_text;""===f&&(f=i),j.remove(),h.replaceWith(g),h.remove(),i=k?i:b("<div></div>").append(b.parseHTML(i)).html(),this.set_text(a,i),c=!!this.rename_node(a,k?b("<div></div>").text(f).text():b("<div></div>").append(b.parseHTML(f)).html()),c||this.set_text(a,i),d&&d.call(this,m,c)},this),keydown:function(a){var b=a.which;27===b&&(this.value=i),(27===b||13===b||37===b||38===b||39===b||40===b||32===b)&&a.stopImmediatePropagation(),(27===b||13===b)&&(a.preventDefault(),this.blur())},click:function(a){a.stopImmediatePropagation()},mousedown:function(a){a.stopImmediatePropagation()},keyup:function(a){k.width(Math.min(j.text("pW"+this.value).width(),f))},keypress:function(a){return 13===a.which?!1:void 0}}),l={fontFamily:g.css("fontFamily")||"",fontSize:g.css("fontSize")||"",fontWeight:g.css("fontWeight")||"",fontStyle:g.css("fontStyle")||"",fontStretch:g.css("fontStretch")||"",fontVariant:g.css("fontVariant")||"",letterSpacing:g.css("letterSpacing")||"",wordSpacing:g.css("wordSpacing")||""},h.attr("class",g.attr("class")).append(g.contents().clone()).append(k),g.replaceWith(h),j.css(l),void k.css(l).width(Math.min(j.text("pW"+k[0].value).width(),f))[0].select()):!1},set_theme:function(a,c){if(!a)return!1;if(c===!0){var d=this.settings.core.themes.dir;d||(d=b.jstree.path+"/themes"),c=d+"/"+a+"/style.css"}c&&-1===b.inArray(c,j)&&(b("head").append('<link rel="stylesheet" href="'+c+'" type="text/css" />'),j.push(c)),this._data.core.themes.name&&this.element.removeClass("jstree-"+this._data.core.themes.name),this._data.core.themes.name=a,this.element.addClass("jstree-"+a),this.element[this.settings.core.themes.responsive?"addClass":"removeClass"]("jstree-"+a+"-responsive"),this.trigger("set_theme",{theme:a})},get_theme:function(){return this._data.core.themes.name},set_theme_variant:function(a){this._data.core.themes.variant&&this.element.removeClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant),this._data.core.themes.variant=a,a&&this.element.addClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant)},get_theme_variant:function(){return this._data.core.themes.variant},show_stripes:function(){this._data.core.themes.stripes=!0,this.get_container_ul().addClass("jstree-striped")},hide_stripes:function(){this._data.core.themes.stripes=!1,this.get_container_ul().removeClass("jstree-striped")},toggle_stripes:function(){this._data.core.themes.stripes?this.hide_stripes():this.show_stripes()},show_dots:function(){this._data.core.themes.dots=!0,this.get_container_ul().removeClass("jstree-no-dots")},hide_dots:function(){this._data.core.themes.dots=!1,this.get_container_ul().addClass("jstree-no-dots")},toggle_dots:function(){this._data.core.themes.dots?this.hide_dots():this.show_dots()},show_icons:function(){this._data.core.themes.icons=!0,this.get_container_ul().removeClass("jstree-no-icons")},hide_icons:function(){this._data.core.themes.icons=!1,this.get_container_ul().addClass("jstree-no-icons")},toggle_icons:function(){this._data.core.themes.icons?this.hide_icons():this.show_icons()},set_icon:function(a,d){var e,f,g,h;if(b.isArray(a)){for(a=a.slice(),e=0,f=a.length;f>e;e++)this.set_icon(a[e],d);return!0}return a=this.get_node(a),a&&"#"!==a.id?(h=a.icon,a.icon=d===!0||null===d||d===c||""===d?!0:d,g=this.get_node(a,!0).children(".jstree-anchor").children(".jstree-themeicon"),d===!1?this.hide_icon(a):d===!0||null===d||d===c||""===d?(g.removeClass("jstree-themeicon-custom "+h).css("background","").removeAttr("rel"),h===!1&&this.show_icon(a)):-1===d.indexOf("/")&&-1===d.indexOf(".")?(g.removeClass(h).css("background",""),g.addClass(d+" jstree-themeicon-custom").attr("rel",d),h===!1&&this.show_icon(a)):(g.removeClass(h).css("background",""),g.addClass("jstree-themeicon-custom").css("background","url('"+d+"') center center no-repeat").attr("rel",d),h===!1&&this.show_icon(a)),!0):!1},get_icon:function(a){return a=this.get_node(a),a&&"#"!==a.id?a.icon:!1},hide_icon:function(a){var c,d;if(b.isArray(a)){for(a=a.slice(),c=0,d=a.length;d>c;c++)this.hide_icon(a[c]);return!0}return a=this.get_node(a),a&&"#"!==a?(a.icon=!1,this.get_node(a,!0).children(".jstree-anchor").children(".jstree-themeicon").addClass("jstree-themeicon-hidden"),!0):!1},show_icon:function(a){var c,d,e;if(b.isArray(a)){for(a=a.slice(),c=0,d=a.length;d>c;c++)this.show_icon(a[c]);return!0}return a=this.get_node(a),a&&"#"!==a?(e=this.get_node(a,!0),a.icon=e.length?e.children(".jstree-anchor").children(".jstree-themeicon").attr("rel"):!0,a.icon||(a.icon=!0),e.children(".jstree-anchor").children(".jstree-themeicon").removeClass("jstree-themeicon-hidden"),!0):!1}},b.vakata={},b.vakata.attributes=function(a,c){a=b(a)[0];var d=c?{}:[];return a&&a.attributes&&b.each(a.attributes,function(a,e){-1===b.inArray(e.name.toLowerCase(),["style","contenteditable","hasfocus","tabindex"])&&null!==e.value&&""!==b.trim(e.value)&&(c?d[e.name]=e.value:d.push(e.name))}),d},b.vakata.array_unique=function(a){var b,d,e=[],f={};for(b=0,d=a.length;d>b;b++)f[a[b]]===c&&(e.push(a[b]),f[a[b]]=!0);return e},b.vakata.array_remove=function(a,b,c){var d=a.slice((c||b)+1||a.length);return a.length=0>b?a.length+b:b,a.push.apply(a,d),a},b.vakata.array_remove_item=function(a,c){var d=b.inArray(c,a);return-1!==d?b.vakata.array_remove(a,d):a};var n=l.createElement("I");n.className="jstree-icon jstree-checkbox",n.setAttribute("role","presentation"),b.jstree.defaults.checkbox={visible:!0,three_state:!0,whole_node:!0,keep_selected_style:!0,cascade:"",tie_selection:!0},b.jstree.plugins.checkbox=function(a,d){this.bind=function(){d.bind.call(this),this._data.checkbox.uto=!1,this._data.checkbox.selected=[],this.settings.checkbox.three_state&&(this.settings.checkbox.cascade="up+down+undetermined"),this.element.on("init.jstree",b.proxy(function(){this._data.checkbox.visible=this.settings.checkbox.visible,this.settings.checkbox.keep_selected_style||this.element.addClass("jstree-checkbox-no-clicked"),this.settings.checkbox.tie_selection&&this.element.addClass("jstree-checkbox-selection")},this)).on("loading.jstree",b.proxy(function(){this[this._data.checkbox.visible?"show_checkboxes":"hide_checkboxes"]()},this)),-1!==this.settings.checkbox.cascade.indexOf("undetermined")&&this.element.on("changed.jstree uncheck_node.jstree check_node.jstree uncheck_all.jstree check_all.jstree move_node.jstree copy_node.jstree redraw.jstree open_node.jstree",b.proxy(function(){this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(b.proxy(this._undetermined,this),50)},this)),this.settings.checkbox.tie_selection||this.element.on("model.jstree",b.proxy(function(a,b){var c,d,e=this._model.data,f=(e[b.parent],b.nodes);for(c=0,d=f.length;d>c;c++)e[f[c]].state.checked=e[f[c]].original&&e[f[c]].original.state&&e[f[c]].original.state.checked,e[f[c]].state.checked&&this._data.checkbox.selected.push(f[c])},this)),(-1!==this.settings.checkbox.cascade.indexOf("up")||-1!==this.settings.checkbox.cascade.indexOf("down"))&&this.element.on("model.jstree",b.proxy(function(a,c){var d,e,f,g,h,i,j=this._model.data,k=j[c.parent],l=c.nodes,m=[],n=this.settings.checkbox.cascade,o=this.settings.checkbox.tie_selection;if(-1!==n.indexOf("down"))if(k.state[o?"selected":"checked"]){for(e=0,f=l.length;f>e;e++)j[l[e]].state[o?"selected":"checked"]=!0;this._data[o?"core":"checkbox"].selected=this._data[o?"core":"checkbox"].selected.concat(l)}else for(e=0,f=l.length;f>e;e++)if(j[l[e]].state[o?"selected":"checked"]){for(g=0,h=j[l[e]].children_d.length;h>g;g++)j[j[l[e]].children_d[g]].state[o?"selected":"checked"]=!0;this._data[o?"core":"checkbox"].selected=this._data[o?"core":"checkbox"].selected.concat(j[l[e]].children_d)}if(-1!==n.indexOf("up")){for(e=0,f=k.children_d.length;f>e;e++)j[k.children_d[e]].children.length||m.push(j[k.children_d[e]].parent);for(m=b.vakata.array_unique(m),g=0,h=m.length;h>g;g++)for(k=j[m[g]];k&&"#"!==k.id;){for(d=0,e=0,f=k.children.length;f>e;e++)d+=j[k.children[e]].state[o?"selected":"checked"];if(d!==f)break;k.state[o?"selected":"checked"]=!0,this._data[o?"core":"checkbox"].selected.push(k.id),i=this.get_node(k,!0),i&&i.length&&i.attr("aria-selected",!0).children(".jstree-anchor").addClass(o?"jstree-clicked":"jstree-checked"),k=this.get_node(k.parent)}}this._data[o?"core":"checkbox"].selected=b.vakata.array_unique(this._data[o?"core":"checkbox"].selected)},this)).on(this.settings.checkbox.tie_selection?"select_node.jstree":"check_node.jstree",b.proxy(function(a,c){var d,e,f,g,h=c.node,i=this._model.data,j=this.get_node(h.parent),k=this.get_node(h,!0),l=this.settings.checkbox.cascade,m=this.settings.checkbox.tie_selection;if(-1!==l.indexOf("down"))for(this._data[m?"core":"checkbox"].selected=b.vakata.array_unique(this._data[m?"core":"checkbox"].selected.concat(h.children_d)),
d=0,e=h.children_d.length;e>d;d++)g=i[h.children_d[d]],g.state[m?"selected":"checked"]=!0,g&&g.original&&g.original.state&&g.original.state.undetermined&&(g.original.state.undetermined=!1);if(-1!==l.indexOf("up"))for(;j&&"#"!==j.id;){for(f=0,d=0,e=j.children.length;e>d;d++)f+=i[j.children[d]].state[m?"selected":"checked"];if(f!==e)break;j.state[m?"selected":"checked"]=!0,this._data[m?"core":"checkbox"].selected.push(j.id),g=this.get_node(j,!0),g&&g.length&&g.attr("aria-selected",!0).children(".jstree-anchor").addClass(m?"jstree-clicked":"jstree-checked"),j=this.get_node(j.parent)}-1!==l.indexOf("down")&&k.length&&k.find(".jstree-anchor").addClass(m?"jstree-clicked":"jstree-checked").parent().attr("aria-selected",!0)},this)).on(this.settings.checkbox.tie_selection?"deselect_all.jstree":"uncheck_all.jstree",b.proxy(function(a,b){var c,d,e,f=this.get_node("#"),g=this._model.data;for(c=0,d=f.children_d.length;d>c;c++)e=g[f.children_d[c]],e&&e.original&&e.original.state&&e.original.state.undetermined&&(e.original.state.undetermined=!1)},this)).on(this.settings.checkbox.tie_selection?"deselect_node.jstree":"uncheck_node.jstree",b.proxy(function(a,c){var d,e,f,g=c.node,h=this.get_node(g,!0),i=this.settings.checkbox.cascade,j=this.settings.checkbox.tie_selection;if(g&&g.original&&g.original.state&&g.original.state.undetermined&&(g.original.state.undetermined=!1),-1!==i.indexOf("down"))for(d=0,e=g.children_d.length;e>d;d++)f=this._model.data[g.children_d[d]],f.state[j?"selected":"checked"]=!1,f&&f.original&&f.original.state&&f.original.state.undetermined&&(f.original.state.undetermined=!1);if(-1!==i.indexOf("up"))for(d=0,e=g.parents.length;e>d;d++)f=this._model.data[g.parents[d]],f.state[j?"selected":"checked"]=!1,f&&f.original&&f.original.state&&f.original.state.undetermined&&(f.original.state.undetermined=!1),f=this.get_node(g.parents[d],!0),f&&f.length&&f.attr("aria-selected",!1).children(".jstree-anchor").removeClass(j?"jstree-clicked":"jstree-checked");for(f=[],d=0,e=this._data[j?"core":"checkbox"].selected.length;e>d;d++)-1!==i.indexOf("down")&&-1!==b.inArray(this._data[j?"core":"checkbox"].selected[d],g.children_d)||-1!==i.indexOf("up")&&-1!==b.inArray(this._data[j?"core":"checkbox"].selected[d],g.parents)||f.push(this._data[j?"core":"checkbox"].selected[d]);this._data[j?"core":"checkbox"].selected=b.vakata.array_unique(f),-1!==i.indexOf("down")&&h.length&&h.find(".jstree-anchor").removeClass(j?"jstree-clicked":"jstree-checked").parent().attr("aria-selected",!1)},this)),-1!==this.settings.checkbox.cascade.indexOf("up")&&this.element.on("delete_node.jstree",b.proxy(function(a,b){for(var c,d,e,f,g=this.get_node(b.parent),h=this._model.data,i=this.settings.checkbox.tie_selection;g&&"#"!==g.id;){for(e=0,c=0,d=g.children.length;d>c;c++)e+=h[g.children[c]].state[i?"selected":"checked"];if(e!==d)break;g.state[i?"selected":"checked"]=!0,this._data[i?"core":"checkbox"].selected.push(g.id),f=this.get_node(g,!0),f&&f.length&&f.attr("aria-selected",!0).children(".jstree-anchor").addClass(i?"jstree-clicked":"jstree-checked"),g=this.get_node(g.parent)}},this)).on("move_node.jstree",b.proxy(function(a,c){var d,e,f,g,h,i=c.is_multi,j=c.old_parent,k=this.get_node(c.parent),l=this._model.data,m=this.settings.checkbox.tie_selection;if(!i)for(d=this.get_node(j);d&&"#"!==d.id;){for(e=0,f=0,g=d.children.length;g>f;f++)e+=l[d.children[f]].state[m?"selected":"checked"];if(e!==g)break;d.state[m?"selected":"checked"]=!0,this._data[m?"core":"checkbox"].selected.push(d.id),h=this.get_node(d,!0),h&&h.length&&h.attr("aria-selected",!0).children(".jstree-anchor").addClass(m?"jstree-clicked":"jstree-checked"),d=this.get_node(d.parent)}for(d=k;d&&"#"!==d.id;){for(e=0,f=0,g=d.children.length;g>f;f++)e+=l[d.children[f]].state[m?"selected":"checked"];if(e===g)d.state[m?"selected":"checked"]||(d.state[m?"selected":"checked"]=!0,this._data[m?"core":"checkbox"].selected.push(d.id),h=this.get_node(d,!0),h&&h.length&&h.attr("aria-selected",!0).children(".jstree-anchor").addClass(m?"jstree-clicked":"jstree-checked"));else{if(!d.state[m?"selected":"checked"])break;d.state[m?"selected":"checked"]=!1,this._data[m?"core":"checkbox"].selected=b.vakata.array_remove_item(this._data[m?"core":"checkbox"].selected,d.id),h=this.get_node(d,!0),h&&h.length&&h.attr("aria-selected",!1).children(".jstree-anchor").removeClass(m?"jstree-clicked":"jstree-checked")}d=this.get_node(d.parent)}},this))},this._undetermined=function(){if(null!==this.element){var a,b,d,e,f={},g=this._model.data,h=this.settings.checkbox.tie_selection,i=this._data[h?"core":"checkbox"].selected,j=[],k=this;for(a=0,b=i.length;b>a;a++)if(g[i[a]]&&g[i[a]].parents)for(d=0,e=g[i[a]].parents.length;e>d;d++)f[g[i[a]].parents[d]]===c&&"#"!==g[i[a]].parents[d]&&(f[g[i[a]].parents[d]]=!0,j.push(g[i[a]].parents[d]));for(this.element.find(".jstree-closed").not(":has(.jstree-children)").each(function(){var h,i=k.get_node(this);if(i.state.loaded){for(a=0,b=i.children_d.length;b>a;a++)if(h=g[i.children_d[a]],!h.state.loaded&&h.original&&h.original.state&&h.original.state.undetermined&&h.original.state.undetermined===!0)for(f[h.id]===c&&"#"!==h.id&&(f[h.id]=!0,j.push(h.id)),d=0,e=h.parents.length;e>d;d++)f[h.parents[d]]===c&&"#"!==h.parents[d]&&(f[h.parents[d]]=!0,j.push(h.parents[d]))}else if(i.original&&i.original.state&&i.original.state.undetermined&&i.original.state.undetermined===!0)for(f[i.id]===c&&"#"!==i.id&&(f[i.id]=!0,j.push(i.id)),d=0,e=i.parents.length;e>d;d++)f[i.parents[d]]===c&&"#"!==i.parents[d]&&(f[i.parents[d]]=!0,j.push(i.parents[d]))}),this.element.find(".jstree-undetermined").removeClass("jstree-undetermined"),a=0,b=j.length;b>a;a++)g[j[a]].state[h?"selected":"checked"]||(i=this.get_node(j[a],!0),i&&i.length&&i.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-undetermined"))}},this.redraw_node=function(a,c,e,f){if(a=d.redraw_node.apply(this,arguments)){var g,h,i=null;for(g=0,h=a.childNodes.length;h>g;g++)if(a.childNodes[g]&&a.childNodes[g].className&&-1!==a.childNodes[g].className.indexOf("jstree-anchor")){i=a.childNodes[g];break}i&&(!this.settings.checkbox.tie_selection&&this._model.data[a.id].state.checked&&(i.className+=" jstree-checked"),i.insertBefore(n.cloneNode(!1),i.childNodes[0]))}return e||-1===this.settings.checkbox.cascade.indexOf("undetermined")||(this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(b.proxy(this._undetermined,this),50)),a},this.show_checkboxes=function(){this._data.core.themes.checkboxes=!0,this.get_container_ul().removeClass("jstree-no-checkboxes")},this.hide_checkboxes=function(){this._data.core.themes.checkboxes=!1,this.get_container_ul().addClass("jstree-no-checkboxes")},this.toggle_checkboxes=function(){this._data.core.themes.checkboxes?this.hide_checkboxes():this.show_checkboxes()},this.is_undetermined=function(a){a=this.get_node(a);var c,d,e=this.settings.checkbox.cascade,f=this.settings.checkbox.tie_selection,g=this._data[f?"core":"checkbox"].selected,h=this._model.data;if(!a||a.state[f?"selected":"checked"]===!0||-1===e.indexOf("undetermined")||-1===e.indexOf("down")&&-1===e.indexOf("up"))return!1;if(!a.state.loaded&&a.original.state.undetermined===!0)return!0;for(c=0,d=a.children_d.length;d>c;c++)if(-1!==b.inArray(a.children_d[c],g)||!h[a.children_d[c]].state.loaded&&h[a.children_d[c]].original.state.undetermined)return!0;return!1},this.activate_node=function(a,c){return this.settings.checkbox.tie_selection&&(this.settings.checkbox.whole_node||b(c.target).hasClass("jstree-checkbox"))&&(c.ctrlKey=!0),this.settings.checkbox.tie_selection||!this.settings.checkbox.whole_node&&!b(c.target).hasClass("jstree-checkbox")?d.activate_node.call(this,a,c):this.is_disabled(a)?!1:(this.is_checked(a)?this.uncheck_node(a,c):this.check_node(a,c),void this.trigger("activate_node",{node:this.get_node(a)}))},this.check_node=function(a,c){if(this.settings.checkbox.tie_selection)return this.select_node(a,!1,!0,c);var d,e,f;if(b.isArray(a)){for(a=a.slice(),e=0,f=a.length;f>e;e++)this.check_node(a[e],c);return!0}return a=this.get_node(a),a&&"#"!==a.id?(d=this.get_node(a,!0),void(a.state.checked||(a.state.checked=!0,this._data.checkbox.selected.push(a.id),d&&d.length&&d.children(".jstree-anchor").addClass("jstree-checked"),this.trigger("check_node",{node:a,selected:this._data.checkbox.selected,event:c})))):!1},this.uncheck_node=function(a,c){if(this.settings.checkbox.tie_selection)return this.deselect_node(a,!1,c);var d,e,f;if(b.isArray(a)){for(a=a.slice(),d=0,e=a.length;e>d;d++)this.uncheck_node(a[d],c);return!0}return a=this.get_node(a),a&&"#"!==a.id?(f=this.get_node(a,!0),void(a.state.checked&&(a.state.checked=!1,this._data.checkbox.selected=b.vakata.array_remove_item(this._data.checkbox.selected,a.id),f.length&&f.children(".jstree-anchor").removeClass("jstree-checked"),this.trigger("uncheck_node",{node:a,selected:this._data.checkbox.selected,event:c})))):!1},this.check_all=function(){if(this.settings.checkbox.tie_selection)return this.select_all();var a,b;this._data.checkbox.selected.concat([]);for(this._data.checkbox.selected=this._model.data["#"].children_d.concat(),a=0,b=this._data.checkbox.selected.length;b>a;a++)this._model.data[this._data.checkbox.selected[a]]&&(this._model.data[this._data.checkbox.selected[a]].state.checked=!0);this.redraw(!0),this.trigger("check_all",{selected:this._data.checkbox.selected})},this.uncheck_all=function(){if(this.settings.checkbox.tie_selection)return this.deselect_all();var a,b,c=this._data.checkbox.selected.concat([]);for(a=0,b=this._data.checkbox.selected.length;b>a;a++)this._model.data[this._data.checkbox.selected[a]]&&(this._model.data[this._data.checkbox.selected[a]].state.checked=!1);this._data.checkbox.selected=[],this.element.find(".jstree-checked").removeClass("jstree-checked"),this.trigger("uncheck_all",{selected:this._data.checkbox.selected,node:c})},this.is_checked=function(a){return this.settings.checkbox.tie_selection?this.is_selected(a):(a=this.get_node(a),a&&"#"!==a.id?a.state.checked:!1)},this.get_checked=function(a){return this.settings.checkbox.tie_selection?this.get_selected(a):a?b.map(this._data.checkbox.selected,b.proxy(function(a){return this.get_node(a)},this)):this._data.checkbox.selected},this.get_top_checked=function(a){if(this.settings.checkbox.tie_selection)return this.get_top_selected(a);var c,d,e,f,g=this.get_checked(!0),h={};for(c=0,d=g.length;d>c;c++)h[g[c].id]=g[c];for(c=0,d=g.length;d>c;c++)for(e=0,f=g[c].children_d.length;f>e;e++)h[g[c].children_d[e]]&&delete h[g[c].children_d[e]];g=[];for(c in h)h.hasOwnProperty(c)&&g.push(c);return a?b.map(g,b.proxy(function(a){return this.get_node(a)},this)):g},this.get_bottom_checked=function(a){if(this.settings.checkbox.tie_selection)return this.get_bottom_selected(a);var c,d,e=this.get_checked(!0),f=[];for(c=0,d=e.length;d>c;c++)e[c].children.length||f.push(e[c].id);return a?b.map(f,b.proxy(function(a){return this.get_node(a)},this)):f},this.load_node=function(a,c){var e,f,g,h;if(!b.isArray(a)&&!this.settings.checkbox.tie_selection&&(h=this.get_node(a),h&&h.state.loaded))for(e=0,f=h.children_d.length;f>e;e++)this._model.data[h.children_d[e]].state.checked&&(g=!0,this._data.checkbox.selected=b.vakata.array_remove_item(this._data.checkbox.selected,h.children_d[e]));return d.load_node.apply(this,arguments)},this.get_state=function(){var a=d.get_state.apply(this,arguments);return this.settings.checkbox.tie_selection?a:(a.checkbox=this._data.checkbox.selected.slice(),a)},this.set_state=function(a,c){var e=d.set_state.apply(this,arguments);if(e&&a.checkbox){if(!this.settings.checkbox.tie_selection){this.uncheck_all();var f=this;b.each(a.checkbox,function(a,b){f.check_node(b)})}return delete a.checkbox,this.set_state(a,c),!1}return e}},b.jstree.defaults.contextmenu={select_node:!0,show_at_node:!0,items:function(a,c){return{create:{separator_before:!1,separator_after:!0,_disabled:!1,label:"Create",action:function(a){var c=b.jstree.reference(a.reference),d=c.get_node(a.reference);c.create_node(d,{},"last",function(a){setTimeout(function(){c.edit(a)},0)})}},rename:{separator_before:!1,separator_after:!1,_disabled:!1,label:"Rename",action:function(a){var c=b.jstree.reference(a.reference),d=c.get_node(a.reference);c.edit(d)}},remove:{separator_before:!1,icon:!1,separator_after:!1,_disabled:!1,label:"Delete",action:function(a){var c=b.jstree.reference(a.reference),d=c.get_node(a.reference);c.is_selected(d)?c.delete_node(c.get_selected()):c.delete_node(d)}},ccp:{separator_before:!0,icon:!1,separator_after:!1,label:"Edit",action:!1,submenu:{cut:{separator_before:!1,separator_after:!1,label:"Cut",action:function(a){var c=b.jstree.reference(a.reference),d=c.get_node(a.reference);c.is_selected(d)?c.cut(c.get_top_selected()):c.cut(d)}},copy:{separator_before:!1,icon:!1,separator_after:!1,label:"Copy",action:function(a){var c=b.jstree.reference(a.reference),d=c.get_node(a.reference);c.is_selected(d)?c.copy(c.get_top_selected()):c.copy(d)}},paste:{separator_before:!1,icon:!1,_disabled:function(a){return!b.jstree.reference(a.reference).can_paste()},separator_after:!1,label:"Paste",action:function(a){var c=b.jstree.reference(a.reference),d=c.get_node(a.reference);c.paste(d)}}}}}}},b.jstree.plugins.contextmenu=function(a,d){this.bind=function(){d.bind.call(this);var a,c,e=0,f=null;this.element.on("contextmenu.jstree",".jstree-anchor",b.proxy(function(a,b){a.preventDefault(),e=a.ctrlKey?+new Date:0,(b||f)&&(e=+new Date+1e4),f&&clearTimeout(f),this.is_loading(a.currentTarget)||this.show_contextmenu(a.currentTarget,a.pageX,a.pageY,a)},this)).on("click.jstree",".jstree-anchor",b.proxy(function(a){this._data.contextmenu.visible&&(!e||+new Date-e>250)&&b.vakata.context.hide(),e=0},this)).on("touchstart.jstree",".jstree-anchor",function(d){d.originalEvent&&d.originalEvent.changedTouches&&d.originalEvent.changedTouches[0]&&(a=d.pageX,c=d.pageY,f=setTimeout(function(){b(d.currentTarget).trigger("contextmenu",!0)},750))}).on("touchmove.vakata.jstree",function(b){f&&b.originalEvent&&b.originalEvent.changedTouches&&b.originalEvent.changedTouches[0]&&(Math.abs(a-b.pageX)>50||Math.abs(c-b.pageY)>50)&&clearTimeout(f)}).on("touchend.vakata.jstree",function(a){f&&clearTimeout(f)}),b(l).on("context_hide.vakata.jstree",b.proxy(function(){this._data.contextmenu.visible=!1},this))},this.teardown=function(){this._data.contextmenu.visible&&b.vakata.context.hide(),d.teardown.call(this)},this.show_contextmenu=function(a,d,e,f){if(a=this.get_node(a),!a||"#"===a.id)return!1;var g=this.settings.contextmenu,h=this.get_node(a,!0),i=h.children(".jstree-anchor"),j=!1,k=!1;(g.show_at_node||d===c||e===c)&&(j=i.offset(),d=j.left,e=j.top+this._data.core.li_height),this.settings.contextmenu.select_node&&!this.is_selected(a)&&this.activate_node(a,f),k=g.items,b.isFunction(k)&&(k=k.call(this,a,b.proxy(function(b){this._show_contextmenu(a,d,e,b)},this))),b.isPlainObject(k)&&this._show_contextmenu(a,d,e,k)},this._show_contextmenu=function(a,c,d,e){var f=this.get_node(a,!0),g=f.children(".jstree-anchor");b(l).one("context_show.vakata.jstree",b.proxy(function(a,c){var d="jstree-contextmenu jstree-"+this.get_theme()+"-contextmenu";b(c.element).addClass(d)},this)),this._data.contextmenu.visible=!0,b.vakata.context.show(g,{x:c,y:d},e),this.trigger("show_contextmenu",{node:a,x:c,y:d})}},function(b){var c=!1,d={element:!1,reference:!1,position_x:0,position_y:0,items:[],html:"",is_visible:!1};b.vakata.context={settings:{hide_onmouseleave:0,icons:!0},_trigger:function(a){b(l).triggerHandler("context_"+a+".vakata",{reference:d.reference,element:d.element,position:{x:d.position_x,y:d.position_y}})},_execute:function(a){return a=d.items[a],a&&(!a._disabled||b.isFunction(a._disabled)&&!a._disabled({item:a,reference:d.reference,element:d.element}))&&a.action?a.action.call(null,{item:a,reference:d.reference,element:d.element,position:{x:d.position_x,y:d.position_y}}):!1},_parse:function(a,c){if(!a)return!1;c||(d.html="",d.items=[]);var e,f="",g=!1;return c&&(f+="<ul>"),b.each(a,function(a,c){return c?(d.items.push(c),!g&&c.separator_before&&(f+="<li class='vakata-context-separator'><a href='#' "+(b.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;</a></li>"),g=!1,f+="<li class='"+(c._class||"")+(c._disabled===!0||b.isFunction(c._disabled)&&c._disabled({item:c,reference:d.reference,element:d.element})?" vakata-contextmenu-disabled ":"")+"' "+(c.shortcut?" data-shortcut='"+c.shortcut+"' ":"")+">",f+="<a href='#' rel='"+(d.items.length-1)+"'>",b.vakata.context.settings.icons&&(f+="<i ",c.icon&&(f+=-1!==c.icon.indexOf("/")||-1!==c.icon.indexOf(".")?" style='background:url(\""+c.icon+"\") center center no-repeat' ":" class='"+c.icon+"' "),f+="></i><span class='vakata-contextmenu-sep'>&#160;</span>"),f+=(b.isFunction(c.label)?c.label({item:a,reference:d.reference,element:d.element}):c.label)+(c.shortcut?' <span class="vakata-contextmenu-shortcut vakata-contextmenu-shortcut-'+c.shortcut+'">'+(c.shortcut_label||"")+"</span>":"")+"</a>",c.submenu&&(e=b.vakata.context._parse(c.submenu,!0),e&&(f+=e)),f+="</li>",void(c.separator_after&&(f+="<li class='vakata-context-separator'><a href='#' "+(b.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;</a></li>",g=!0))):!0}),f=f.replace(/<li class\='vakata-context-separator'\><\/li\>$/,""),c&&(f+="</ul>"),c||(d.html=f,b.vakata.context._trigger("parse")),f.length>10?f:!1},_show_submenu:function(d){if(d=b(d),d.length&&d.children("ul").length){var e=d.children("ul"),f=d.offset().left+d.outerWidth(),g=d.offset().top,h=e.width(),i=e.height(),j=b(a).width()+b(a).scrollLeft(),k=b(a).height()+b(a).scrollTop();c?d[f-(h+10+d.outerWidth())<0?"addClass":"removeClass"]("vakata-context-left"):d[f+h+10>j?"addClass":"removeClass"]("vakata-context-right"),g+i+10>k&&e.css("bottom","-1px"),e.show()}},show:function(e,f,g){var h,i,j,k,l,m,n,o,p=!0;switch(d.element&&d.element.length&&d.element.width(""),p){case!f&&!e:return!1;case!!f&&!!e:d.reference=e,d.position_x=f.x,d.position_y=f.y;break;case!f&&!!e:d.reference=e,h=e.offset(),d.position_x=h.left+e.outerHeight(),d.position_y=h.top;break;case!!f&&!e:d.position_x=f.x,d.position_y=f.y}e&&!g&&b(e).data("vakata_contextmenu")&&(g=b(e).data("vakata_contextmenu")),b.vakata.context._parse(g)&&d.element.html(d.html),d.items.length&&(d.element.appendTo("body"),i=d.element,j=d.position_x,k=d.position_y,l=i.width(),m=i.height(),n=b(a).width()+b(a).scrollLeft(),o=b(a).height()+b(a).scrollTop(),c&&(j-=i.outerWidth()-b(e).outerWidth(),j<b(a).scrollLeft()+20&&(j=b(a).scrollLeft()+20)),j+l+20>n&&(j=n-(l+20)),k+m+20>o&&(k=o-(m+20)),d.element.css({left:j,top:k}).show().find("a").first().focus().parent().addClass("vakata-context-hover"),d.is_visible=!0,b.vakata.context._trigger("show"))},hide:function(){d.is_visible&&(d.element.hide().find("ul").hide().end().find(":focus").blur().end().detach(),d.is_visible=!1,b.vakata.context._trigger("hide"))}},b(function(){c="rtl"===b("body").css("direction");var a=!1;d.element=b("<ul class='vakata-context'></ul>"),d.element.on("mouseenter","li",function(c){c.stopImmediatePropagation(),b.contains(this,c.relatedTarget)||(a&&clearTimeout(a),d.element.find(".vakata-context-hover").removeClass("vakata-context-hover").end(),b(this).siblings().find("ul").hide().end().end().parentsUntil(".vakata-context","li").addBack().addClass("vakata-context-hover"),b.vakata.context._show_submenu(this))}).on("mouseleave","li",function(a){b.contains(this,a.relatedTarget)||b(this).find(".vakata-context-hover").addBack().removeClass("vakata-context-hover")}).on("mouseleave",function(c){b(this).find(".vakata-context-hover").removeClass("vakata-context-hover"),b.vakata.context.settings.hide_onmouseleave&&(a=setTimeout(function(a){return function(){b.vakata.context.hide()}}(this),b.vakata.context.settings.hide_onmouseleave))}).on("click","a",function(a){a.preventDefault(),b(this).blur().parent().hasClass("vakata-context-disabled")||b.vakata.context._execute(b(this).attr("rel"))===!1||b.vakata.context.hide()}).on("keydown","a",function(a){var c=null;switch(a.which){case 13:case 32:a.type="mouseup",a.preventDefault(),b(a.currentTarget).trigger(a);break;case 37:d.is_visible&&(d.element.find(".vakata-context-hover").last().closest("li").first().find("ul").hide().find(".vakata-context-hover").removeClass("vakata-context-hover").end().end().children("a").focus(),a.stopImmediatePropagation(),a.preventDefault());break;case 38:d.is_visible&&(c=d.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").prevAll("li:not(.vakata-context-separator)").first(),c.length||(c=d.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").last()),c.addClass("vakata-context-hover").children("a").focus(),a.stopImmediatePropagation(),a.preventDefault());break;case 39:d.is_visible&&(d.element.find(".vakata-context-hover").last().children("ul").show().children("li:not(.vakata-context-separator)").removeClass("vakata-context-hover").first().addClass("vakata-context-hover").children("a").focus(),a.stopImmediatePropagation(),a.preventDefault());break;case 40:d.is_visible&&(c=d.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").nextAll("li:not(.vakata-context-separator)").first(),c.length||(c=d.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").first()),c.addClass("vakata-context-hover").children("a").focus(),a.stopImmediatePropagation(),a.preventDefault());break;case 27:b.vakata.context.hide(),a.preventDefault()}}).on("keydown",function(a){a.preventDefault();var b=d.element.find(".vakata-contextmenu-shortcut-"+a.which).parent();b.parent().not(".vakata-context-disabled")&&b.click()}),b(l).on("mousedown.vakata.jstree",function(a){d.is_visible&&!b.contains(d.element[0],a.target)&&b.vakata.context.hide()}).on("context_show.vakata.jstree",function(a,b){d.element.find("li:has(ul)").children("a").addClass("vakata-context-parent"),c&&d.element.addClass("vakata-context-rtl").css("direction","rtl"),d.element.find("ul").hide().end()})})}(b),b.jstree.defaults.dnd={copy:!0,open_timeout:500,is_draggable:!0,check_while_dragging:!0,always_copy:!1,inside_pos:0,drag_selection:!0,touch:!0,large_drop_target:!1,large_drag_target:!1},b.jstree.plugins.dnd=function(a,c){this.bind=function(){c.bind.call(this),this.element.on("mousedown.jstree touchstart.jstree",this.settings.dnd.large_drag_target?".jstree-node":".jstree-anchor",b.proxy(function(a){if(this.settings.dnd.large_drag_target&&b(a.target).closest(".jstree-node")[0]!==a.currentTarget)return!0;if("touchstart"===a.type&&(!this.settings.dnd.touch||"selected"===this.settings.dnd.touch&&!b(a.currentTarget).closest(".jstree-node").children(".jstree-anchor").hasClass("jstree-clicked")))return!0;var c=this.get_node(a.target),d=this.is_selected(c)&&this.settings.dnd.drag_selection?this.get_top_selected().length:1,e=d>1?d+" "+this.get_string("nodes"):this.get_text(a.currentTarget);return this.settings.core.force_text&&(e=b.vakata.html.escape(e)),c&&c.id&&"#"!==c.id&&(1===a.which||"touchstart"===a.type)&&(this.settings.dnd.is_draggable===!0||b.isFunction(this.settings.dnd.is_draggable)&&this.settings.dnd.is_draggable.call(this,d>1?this.get_top_selected(!0):[c]))?(this.element.trigger("mousedown.jstree"),b.vakata.dnd.start(a,{jstree:!0,origin:this,obj:this.get_node(c,!0),nodes:d>1?this.get_top_selected():[c.id]},'<div id="jstree-dnd" class="jstree-'+this.get_theme()+" jstree-"+this.get_theme()+"-"+this.get_theme_variant()+" "+(this.settings.core.themes.responsive?" jstree-dnd-responsive":"")+'"><i class="jstree-icon jstree-er"></i>'+e+'<ins class="jstree-copy" style="display:none;">+</ins></div>')):void 0},this))}},b(function(){var a=!1,c=!1,d=!1,e=b('<div id="jstree-marker">&#160;</div>').hide();b(l).on("dnd_start.vakata.jstree",function(b,c){a=!1,c&&c.data&&c.data.jstree&&e.appendTo("body")}).on("dnd_move.vakata.jstree",function(f,g){if(d&&clearTimeout(d),g&&g.data&&g.data.jstree&&(!g.event.target.id||"jstree-marker"!==g.event.target.id)){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v=b.jstree.reference(g.event.target),w=!1,x=!1,y=!1;if(v&&v._data&&v._data.dnd)if(e.attr("class","jstree-"+v.get_theme()+(v.settings.core.themes.responsive?" jstree-dnd-responsive":"")),g.helper.children().attr("class","jstree-"+v.get_theme()+" jstree-"+v.get_theme()+"-"+v.get_theme_variant()+" "+(v.settings.core.themes.responsive?" jstree-dnd-responsive":"")).find(".jstree-copy").first()[g.data.origin&&(g.data.origin.settings.dnd.always_copy||g.data.origin.settings.dnd.copy&&(g.event.metaKey||g.event.ctrlKey))?"show":"hide"](),g.event.target!==v.element[0]&&g.event.target!==v.get_container_ul()[0]||0!==v.get_container_ul().children().length){if(w=v.settings.dnd.large_drop_target?b(g.event.target).closest(".jstree-node").children(".jstree-anchor"):b(g.event.target).closest(".jstree-anchor"),w&&w.length&&w.parent().is(".jstree-closed, .jstree-open, .jstree-leaf")&&(x=w.offset(),y=g.event.pageY-x.top,j=w.outerHeight(),m=j/3>y?["b","i","a"]:y>j-j/3?["a","i","b"]:y>j/2?["i","a","b"]:["i","b","a"],b.each(m,function(f,y){switch(y){case"b":h=x.left-6,i=x.top,k=v.get_parent(w),l=w.parent().index();break;case"i":t=v.settings.dnd.inside_pos,u=v.get_node(w.parent()),h=x.left-2,i=x.top+j/2+1,k=u.id,l="first"===t?0:"last"===t?u.children.length:Math.min(t,u.children.length);break;case"a":h=x.left-6,i=x.top+j,k=v.get_parent(w),l=w.parent().index()+1}for(n=!0,o=0,p=g.data.nodes.length;p>o;o++)if(q=g.data.origin&&(g.data.origin.settings.dnd.always_copy||g.data.origin.settings.dnd.copy&&(g.event.metaKey||g.event.ctrlKey))?"copy_node":"move_node",r=l,"move_node"===q&&"a"===y&&g.data.origin&&g.data.origin===v&&k===v.get_parent(g.data.nodes[o])&&(s=v.get_node(k),r>b.inArray(g.data.nodes[o],s.children)&&(r-=1)),n=n&&(v&&v.settings&&v.settings.dnd&&v.settings.dnd.check_while_dragging===!1||v.check(q,g.data.origin&&g.data.origin!==v?g.data.origin.get_node(g.data.nodes[o]):g.data.nodes[o],k,r,{dnd:!0,ref:v.get_node(w.parent()),pos:y,origin:g.data.origin,is_multi:g.data.origin&&g.data.origin!==v,is_foreign:!g.data.origin})),!n){v&&v.last_error&&(c=v.last_error());break}return"i"===y&&w.parent().is(".jstree-closed")&&v.settings.dnd.open_timeout&&(d=setTimeout(function(a,b){return function(){a.open_node(b)}}(v,w),v.settings.dnd.open_timeout)),n?(a={ins:v,par:k,pos:"i"!==y||"last"!==t||0!==l||v.is_loaded(u)?l:"last"},e.css({left:h+"px",top:i+"px"}).show(),g.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok"),c={},m=!0,!1):void 0}),m===!0))return}else{for(n=!0,o=0,p=g.data.nodes.length;p>o&&(n=n&&v.check(g.data.origin&&(g.data.origin.settings.dnd.always_copy||g.data.origin.settings.dnd.copy&&(g.event.metaKey||g.event.ctrlKey))?"copy_node":"move_node",g.data.origin&&g.data.origin!==v?g.data.origin.get_node(g.data.nodes[o]):g.data.nodes[o],"#","last",{dnd:!0,ref:v.get_node("#"),pos:"i",origin:g.data.origin,is_multi:g.data.origin&&g.data.origin!==v,is_foreign:!g.data.origin}),n);o++);if(n)return a={ins:v,par:"#",pos:"last"},e.hide(),void g.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok")}a=!1,g.helper.find(".jstree-icon").removeClass("jstree-ok").addClass("jstree-er"),e.hide()}}).on("dnd_scroll.vakata.jstree",function(b,c){c&&c.data&&c.data.jstree&&(e.hide(),a=!1,c.helper.find(".jstree-icon").first().removeClass("jstree-ok").addClass("jstree-er"))}).on("dnd_stop.vakata.jstree",function(f,g){if(d&&clearTimeout(d),g&&g.data&&g.data.jstree){e.hide().detach();var h,i,j=[];if(a){for(h=0,i=g.data.nodes.length;i>h;h++)j[h]=g.data.origin?g.data.origin.get_node(g.data.nodes[h]):g.data.nodes[h];a.ins[g.data.origin&&(g.data.origin.settings.dnd.always_copy||g.data.origin.settings.dnd.copy&&(g.event.metaKey||g.event.ctrlKey))?"copy_node":"move_node"](j,a.par,a.pos,!1,!1,!1,g.data.origin)}else h=b(g.event.target).closest(".jstree"),h.length&&c&&c.error&&"check"===c.error&&(h=h.jstree(!0),h&&h.settings.core.error.call(this,c))}}).on("keyup.jstree keydown.jstree",function(a,c){c=b.vakata.dnd._get(),c&&c.data&&c.data.jstree&&c.helper.find(".jstree-copy").first()[c.data.origin&&(c.data.origin.settings.dnd.always_copy||c.data.origin.settings.dnd.copy&&(a.metaKey||a.ctrlKey))?"show":"hide"]()})}),function(b){b.vakata.html={div:b("<div />"),escape:function(a){return b.vakata.html.div.text(a).html()},strip:function(a){return b.vakata.html.div.empty().append(b.parseHTML(a)).text()}};var c={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1};b.vakata.dnd={settings:{scroll_speed:10,scroll_proximity:20,helper_left:5,helper_top:10,threshold:5,threshold_touch:50},_trigger:function(a,c){var d=b.vakata.dnd._get();d.event=c,b(l).triggerHandler("dnd_"+a+".vakata",d)},_get:function(){return{data:c.data,element:c.element,helper:c.helper}},_clean:function(){c.helper&&c.helper.remove(),c.scroll_i&&(clearInterval(c.scroll_i),c.scroll_i=!1),c={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1},b(l).off("mousemove.vakata.jstree touchmove.vakata.jstree",b.vakata.dnd.drag),b(l).off("mouseup.vakata.jstree touchend.vakata.jstree",b.vakata.dnd.stop)},_scroll:function(a){if(!c.scroll_e||!c.scroll_l&&!c.scroll_t)return c.scroll_i&&(clearInterval(c.scroll_i),c.scroll_i=!1),!1;if(!c.scroll_i)return c.scroll_i=setInterval(b.vakata.dnd._scroll,100),!1;if(a===!0)return!1;var d=c.scroll_e.scrollTop(),e=c.scroll_e.scrollLeft();c.scroll_e.scrollTop(d+c.scroll_t*b.vakata.dnd.settings.scroll_speed),c.scroll_e.scrollLeft(e+c.scroll_l*b.vakata.dnd.settings.scroll_speed),(d!==c.scroll_e.scrollTop()||e!==c.scroll_e.scrollLeft())&&b.vakata.dnd._trigger("scroll",c.scroll_e)},start:function(d,e,f){"touchstart"===d.type&&d.originalEvent&&d.originalEvent.changedTouches&&d.originalEvent.changedTouches[0]&&(d.pageX=d.originalEvent.changedTouches[0].pageX,d.pageY=d.originalEvent.changedTouches[0].pageY,d.target=l.elementFromPoint(d.originalEvent.changedTouches[0].pageX-a.pageXOffset,d.originalEvent.changedTouches[0].pageY-a.pageYOffset)),c.is_drag&&b.vakata.dnd.stop({});try{d.currentTarget.unselectable="on",d.currentTarget.onselectstart=function(){return!1},d.currentTarget.style&&(d.currentTarget.style.MozUserSelect="none")}catch(g){}return c.init_x=d.pageX,c.init_y=d.pageY,c.data=e,c.is_down=!0,c.element=d.currentTarget,c.target=d.target,c.is_touch="touchstart"===d.type,f!==!1&&(c.helper=b("<div id='vakata-dnd'></div>").html(f).css({display:"block",margin:"0",padding:"0",position:"absolute",top:"-2000px",lineHeight:"16px",zIndex:"10000"})),b(l).on("mousemove.vakata.jstree touchmove.vakata.jstree",b.vakata.dnd.drag),b(l).on("mouseup.vakata.jstree touchend.vakata.jstree",b.vakata.dnd.stop),!1},drag:function(d){if("touchmove"===d.type&&d.originalEvent&&d.originalEvent.changedTouches&&d.originalEvent.changedTouches[0]&&(d.pageX=d.originalEvent.changedTouches[0].pageX,d.pageY=d.originalEvent.changedTouches[0].pageY,d.target=l.elementFromPoint(d.originalEvent.changedTouches[0].pageX-a.pageXOffset,d.originalEvent.changedTouches[0].pageY-a.pageYOffset)),c.is_down){if(!c.is_drag){if(!(Math.abs(d.pageX-c.init_x)>(c.is_touch?b.vakata.dnd.settings.threshold_touch:b.vakata.dnd.settings.threshold)||Math.abs(d.pageY-c.init_y)>(c.is_touch?b.vakata.dnd.settings.threshold_touch:b.vakata.dnd.settings.threshold)))return;c.helper&&(c.helper.appendTo("body"),c.helper_w=c.helper.outerWidth()),c.is_drag=!0,b.vakata.dnd._trigger("start",d)}var e=!1,f=!1,g=!1,h=!1,i=!1,j=!1,k=!1,m=!1,n=!1,o=!1;return c.scroll_t=0,c.scroll_l=0,c.scroll_e=!1,b(b(d.target).parentsUntil("body").addBack().get().reverse()).filter(function(){return/^auto|scroll$/.test(b(this).css("overflow"))&&(this.scrollHeight>this.offsetHeight||this.scrollWidth>this.offsetWidth)}).each(function(){var a=b(this),e=a.offset();
return this.scrollHeight>this.offsetHeight&&(e.top+a.height()-d.pageY<b.vakata.dnd.settings.scroll_proximity&&(c.scroll_t=1),d.pageY-e.top<b.vakata.dnd.settings.scroll_proximity&&(c.scroll_t=-1)),this.scrollWidth>this.offsetWidth&&(e.left+a.width()-d.pageX<b.vakata.dnd.settings.scroll_proximity&&(c.scroll_l=1),d.pageX-e.left<b.vakata.dnd.settings.scroll_proximity&&(c.scroll_l=-1)),c.scroll_t||c.scroll_l?(c.scroll_e=b(this),!1):void 0}),c.scroll_e||(e=b(l),f=b(a),g=e.height(),h=f.height(),i=e.width(),j=f.width(),k=e.scrollTop(),m=e.scrollLeft(),g>h&&d.pageY-k<b.vakata.dnd.settings.scroll_proximity&&(c.scroll_t=-1),g>h&&h-(d.pageY-k)<b.vakata.dnd.settings.scroll_proximity&&(c.scroll_t=1),i>j&&d.pageX-m<b.vakata.dnd.settings.scroll_proximity&&(c.scroll_l=-1),i>j&&j-(d.pageX-m)<b.vakata.dnd.settings.scroll_proximity&&(c.scroll_l=1),(c.scroll_t||c.scroll_l)&&(c.scroll_e=e)),c.scroll_e&&b.vakata.dnd._scroll(!0),c.helper&&(n=parseInt(d.pageY+b.vakata.dnd.settings.helper_top,10),o=parseInt(d.pageX+b.vakata.dnd.settings.helper_left,10),g&&n+25>g&&(n=g-50),i&&o+c.helper_w>i&&(o=i-(c.helper_w+2)),c.helper.css({left:o+"px",top:n+"px"})),b.vakata.dnd._trigger("move",d),!1}},stop:function(d){if("touchend"===d.type&&d.originalEvent&&d.originalEvent.changedTouches&&d.originalEvent.changedTouches[0]&&(d.pageX=d.originalEvent.changedTouches[0].pageX,d.pageY=d.originalEvent.changedTouches[0].pageY,d.target=l.elementFromPoint(d.originalEvent.changedTouches[0].pageX-a.pageXOffset,d.originalEvent.changedTouches[0].pageY-a.pageYOffset)),c.is_drag)b.vakata.dnd._trigger("stop",d);else if("touchend"===d.type&&d.target===c.target){var e=setTimeout(function(){b(d.target).click()},100);b(d.target).one("click",function(){e&&clearTimeout(e)})}return b.vakata.dnd._clean(),!1}}}(b),b.jstree.defaults.massload=null,b.jstree.plugins.massload=function(a,c){this.init=function(a,b){c.init.call(this,a,b),this._data.massload={}},this._load_nodes=function(a,d,e){var f=this.settings.massload;return e&&!b.isEmptyObject(this._data.massload)?c._load_nodes.call(this,a,d,e):b.isFunction(f)?f.call(this,a,b.proxy(function(b){if(b)for(var f in b)b.hasOwnProperty(f)&&(this._data.massload[f]=b[f]);c._load_nodes.call(this,a,d,e)},this)):"object"==typeof f&&f&&f.url?(f=b.extend(!0,{},f),b.isFunction(f.url)&&(f.url=f.url.call(this,a)),b.isFunction(f.data)&&(f.data=f.data.call(this,a)),b.ajax(f).done(b.proxy(function(b,f,g){if(b)for(var h in b)b.hasOwnProperty(h)&&(this._data.massload[h]=b[h]);c._load_nodes.call(this,a,d,e)},this)).fail(b.proxy(function(b){c._load_nodes.call(this,a,d,e)},this))):c._load_nodes.call(this,a,d,e)},this._load_node=function(a,d){var e=this._data.massload[a.id];return e?this["string"==typeof e?"_append_html_data":"_append_json_data"](a,"string"==typeof e?b(b.parseHTML(e)).filter(function(){return 3!==this.nodeType}):e,function(b){d.call(this,b),delete this._data.massload[a.id]}):c._load_node.call(this,a,d)}},b.jstree.defaults.search={ajax:!1,fuzzy:!1,case_sensitive:!1,show_only_matches:!1,show_only_matches_children:!1,close_opened_onclear:!0,search_leaves_only:!1,search_callback:!1},b.jstree.plugins.search=function(a,d){this.bind=function(){d.bind.call(this),this._data.search.str="",this._data.search.dom=b(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=!1,this._data.search.smc=!1,this.element.on("before_open.jstree",b.proxy(function(a,c){var d,e,f=this._data.search.res,g=[],h=b();if(f&&f.length&&(this._data.search.dom=b(this.element[0].querySelectorAll("#"+b.map(f,function(a){return-1!=="0123456789".indexOf(a[0])?"\\3"+a[0]+" "+a.substr(1).replace(b.jstree.idregex,"\\$&"):a.replace(b.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.dom.children(".jstree-anchor").addClass("jstree-search"),this._data.search.som&&this._data.search.res.length)){for(d=0,e=f.length;e>d;d++)g=g.concat(this.get_node(f[d]).parents);g=b.vakata.array_remove_item(b.vakata.array_unique(g),"#"),h=g.length?b(this.element[0].querySelectorAll("#"+b.map(g,function(a){return-1!=="0123456789".indexOf(a[0])?"\\3"+a[0]+" "+a.substr(1).replace(b.jstree.idregex,"\\$&"):a.replace(b.jstree.idregex,"\\$&")}).join(", #"))):b(),this.element.find(".jstree-node").hide().filter(".jstree-last").filter(function(){return this.nextSibling}).removeClass("jstree-last"),h=h.add(this._data.search.dom),this._data.search.smc&&this._data.search.dom.children(".jstree-children").find(".jstree-node").show(),h.parentsUntil(".jstree").addBack().show().filter(".jstree-children").each(function(){b(this).children(".jstree-node:visible").eq(-1).addClass("jstree-last")})}},this)).on("search.jstree",b.proxy(function(a,c){this._data.search.som&&c.nodes.length&&(this.element.find(".jstree-node").hide().filter(".jstree-last").filter(function(){return this.nextSibling}).removeClass("jstree-last"),this._data.search.smc&&c.nodes.children(".jstree-children").find(".jstree-node").show(),c.nodes.parentsUntil(".jstree").addBack().show().filter(".jstree-children").each(function(){b(this).children(".jstree-node:visible").eq(-1).addClass("jstree-last")}))},this)).on("clear_search.jstree",b.proxy(function(a,b){this._data.search.som&&b.nodes.length&&this.element.find(".jstree-node").css("display","").filter(".jstree-last").filter(function(){return this.nextSibling}).removeClass("jstree-last")},this))},this.search=function(a,d,e,f,g,h){if(a===!1||""===b.trim(a.toString()))return this.clear_search();f=this.get_node(f),f=f&&f.id?f.id:null,a=a.toString();var i=this.settings.search,j=i.ajax?i.ajax:!1,k=this._model.data,l=null,m=[],n=[];return this._data.search.res.length&&!g&&this.clear_search(),e===c&&(e=i.show_only_matches),h===c&&(h=i.show_only_matches_children),d||j===!1?(g||(this._data.search.str=a,this._data.search.dom=b(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=e,this._data.search.smc=h),l=new b.vakata.search(a,!0,{caseSensitive:i.case_sensitive,fuzzy:i.fuzzy}),b.each(k[f?f:"#"].children_d,function(b,c){var d=k[c];d.text&&(i.search_callback&&i.search_callback.call(this,a,d)||!i.search_callback&&l.search(d.text).isMatch)&&(!i.search_leaves_only||d.state.loaded&&0===d.children.length)&&(m.push(c),n=n.concat(d.parents))}),m.length&&(n=b.vakata.array_unique(n),this._search_open(n),g?(this._data.search.dom=this._data.search.dom.add(b(this.element[0].querySelectorAll("#"+b.map(m,function(a){return-1!=="0123456789".indexOf(a[0])?"\\3"+a[0]+" "+a.substr(1).replace(b.jstree.idregex,"\\$&"):a.replace(b.jstree.idregex,"\\$&")}).join(", #")))),this._data.search.res=b.vakata.array_unique(this._data.search.res.concat(m))):(this._data.search.dom=b(this.element[0].querySelectorAll("#"+b.map(m,function(a){return-1!=="0123456789".indexOf(a[0])?"\\3"+a[0]+" "+a.substr(1).replace(b.jstree.idregex,"\\$&"):a.replace(b.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.res=m),this._data.search.dom.children(".jstree-anchor").addClass("jstree-search")),void this.trigger("search",{nodes:this._data.search.dom,str:a,res:this._data.search.res,show_only_matches:e})):b.isFunction(j)?j.call(this,a,b.proxy(function(c){c&&c.d&&(c=c.d),this._load_nodes(b.isArray(c)?b.vakata.array_unique(c):[],function(){this.search(a,!0,e,f,g)},!0)},this),f):(j=b.extend({},j),j.data||(j.data={}),j.data.str=a,f&&(j.data.inside=f),b.ajax(j).fail(b.proxy(function(){this._data.core.last_error={error:"ajax",plugin:"search",id:"search_01",reason:"Could not load search parents",data:JSON.stringify(j)},this.settings.core.error.call(this,this._data.core.last_error)},this)).done(b.proxy(function(c){c&&c.d&&(c=c.d),this._load_nodes(b.isArray(c)?b.vakata.array_unique(c):[],function(){this.search(a,!0,e,f,g)},!0)},this)))},this.clear_search=function(){this._data.search.dom.children(".jstree-anchor").removeClass("jstree-search"),this.settings.search.close_opened_onclear&&this.close_node(this._data.search.opn,0),this.trigger("clear_search",{nodes:this._data.search.dom,str:this._data.search.str,res:this._data.search.res}),this._data.search.str="",this._data.search.res=[],this._data.search.opn=[],this._data.search.dom=b()},this._search_open=function(a){var c=this;b.each(a.concat([]),function(d,e){if("#"===e)return!0;try{e=b("#"+e.replace(b.jstree.idregex,"\\$&"),c.element)}catch(f){}e&&e.length&&c.is_closed(e)&&(c._data.search.opn.push(e[0].id),c.open_node(e,function(){c._search_open(a)},0))})}},function(a){a.vakata.search=function(b,c,d){d=d||{},d=a.extend({},a.vakata.search.defaults,d),d.fuzzy!==!1&&(d.fuzzy=!0),b=d.caseSensitive?b:b.toLowerCase();var e,f,g,h,i=d.location,j=d.distance,k=d.threshold,l=b.length;return l>32&&(d.fuzzy=!1),d.fuzzy&&(e=1<<l-1,f=function(){var a={},c=0;for(c=0;l>c;c++)a[b.charAt(c)]=0;for(c=0;l>c;c++)a[b.charAt(c)]|=1<<l-c-1;return a}(),g=function(a,b){var c=a/l,d=Math.abs(i-b);return j?c+d/j:d?1:c}),h=function(a){if(a=d.caseSensitive?a:a.toLowerCase(),b===a||-1!==a.indexOf(b))return{isMatch:!0,score:0};if(!d.fuzzy)return{isMatch:!1,score:1};var c,h,j,m,n,o,p,q,r,s=a.length,t=k,u=a.indexOf(b,i),v=l+s,w=1,x=[];for(-1!==u&&(t=Math.min(g(0,u),t),u=a.lastIndexOf(b,i+l),-1!==u&&(t=Math.min(g(0,u),t))),u=-1,c=0;l>c;c++){for(j=0,m=v;m>j;)g(c,i+m)<=t?j=m:v=m,m=Math.floor((v-j)/2+j);for(v=m,o=Math.max(1,i-m+1),p=Math.min(i+m,s)+l,q=new Array(p+2),q[p+1]=(1<<c)-1,h=p;h>=o;h--)if(r=f[a.charAt(h-1)],0===c?q[h]=(q[h+1]<<1|1)&r:q[h]=(q[h+1]<<1|1)&r|((n[h+1]|n[h])<<1|1)|n[h+1],q[h]&e&&(w=g(c,h-1),t>=w)){if(t=w,u=h-1,x.push(u),!(u>i))break;o=Math.max(1,2*i-u)}if(g(c+1,i)>t)break;n=q}return{isMatch:u>=0,score:w}},c===!0?{search:h}:h(c)},a.vakata.search.defaults={location:0,distance:100,threshold:.6,fuzzy:!1,caseSensitive:!1}}(b),b.jstree.defaults.sort=function(a,b){return this.get_text(a)>this.get_text(b)?1:-1},b.jstree.plugins.sort=function(a,c){this.bind=function(){c.bind.call(this),this.element.on("model.jstree",b.proxy(function(a,b){this.sort(b.parent,!0)},this)).on("rename_node.jstree create_node.jstree",b.proxy(function(a,b){this.sort(b.parent||b.node.parent,!1),this.redraw_node(b.parent||b.node.parent,!0)},this)).on("move_node.jstree copy_node.jstree",b.proxy(function(a,b){this.sort(b.parent,!1),this.redraw_node(b.parent,!0)},this))},this.sort=function(a,c){var d,e;if(a=this.get_node(a),a&&a.children&&a.children.length&&(a.children.sort(b.proxy(this.settings.sort,this)),c))for(d=0,e=a.children_d.length;e>d;d++)this.sort(a.children_d[d],!1)}};var o=!1;b.jstree.defaults.state={key:"jstree",events:"changed.jstree open_node.jstree close_node.jstree check_node.jstree uncheck_node.jstree",ttl:!1,filter:!1},b.jstree.plugins.state=function(a,c){this.bind=function(){c.bind.call(this);var a=b.proxy(function(){this.element.on(this.settings.state.events,b.proxy(function(){o&&clearTimeout(o),o=setTimeout(b.proxy(function(){this.save_state()},this),100)},this)),this.trigger("state_ready")},this);this.element.on("ready.jstree",b.proxy(function(b,c){this.element.one("restore_state.jstree",a),this.restore_state()||a()},this))},this.save_state=function(){var a={state:this.get_state(),ttl:this.settings.state.ttl,sec:+new Date};b.vakata.storage.set(this.settings.state.key,JSON.stringify(a))},this.restore_state=function(){var a=b.vakata.storage.get(this.settings.state.key);if(a)try{a=JSON.parse(a)}catch(c){return!1}return a&&a.ttl&&a.sec&&+new Date-a.sec>a.ttl?!1:(a&&a.state&&(a=a.state),a&&b.isFunction(this.settings.state.filter)&&(a=this.settings.state.filter.call(this,a)),a?(this.element.one("set_state.jstree",function(c,d){d.instance.trigger("restore_state",{state:b.extend(!0,{},a)})}),this.set_state(a),!0):!1)},this.clear_state=function(){return b.vakata.storage.del(this.settings.state.key)}},function(b,c){b.vakata.storage={set:function(b,c){return a.localStorage.setItem(b,c)},get:function(b){return a.localStorage.getItem(b)},del:function(b){return a.localStorage.removeItem(b)}}}(b),b.jstree.defaults.types={"#":{},"default":{}},b.jstree.plugins.types=function(a,d){this.init=function(a,b){var e,f;if(b&&b.types&&b.types["default"])for(e in b.types)if("default"!==e&&"#"!==e&&b.types.hasOwnProperty(e))for(f in b.types["default"])b.types["default"].hasOwnProperty(f)&&b.types[e][f]===c&&(b.types[e][f]=b.types["default"][f]);d.init.call(this,a,b),this._model.data["#"].type="#"},this.refresh=function(a,b){d.refresh.call(this,a,b),this._model.data["#"].type="#"},this.bind=function(){this.element.on("model.jstree",b.proxy(function(a,b){var d,e,f=this._model.data,g=b.nodes,h=this.settings.types,i="default";for(d=0,e=g.length;e>d;d++)i="default",f[g[d]].original&&f[g[d]].original.type&&h[f[g[d]].original.type]&&(i=f[g[d]].original.type),f[g[d]].data&&f[g[d]].data.jstree&&f[g[d]].data.jstree.type&&h[f[g[d]].data.jstree.type]&&(i=f[g[d]].data.jstree.type),f[g[d]].type=i,f[g[d]].icon===!0&&h[i].icon!==c&&(f[g[d]].icon=h[i].icon);f["#"].type="#"},this)),d.bind.call(this)},this.get_json=function(a,c,e){var f,g,h=this._model.data,i=c?b.extend(!0,{},c,{no_id:!1}):{},j=d.get_json.call(this,a,i,e);if(j===!1)return!1;if(b.isArray(j))for(f=0,g=j.length;g>f;f++)j[f].type=j[f].id&&h[j[f].id]&&h[j[f].id].type?h[j[f].id].type:"default",c&&c.no_id&&(delete j[f].id,j[f].li_attr&&j[f].li_attr.id&&delete j[f].li_attr.id,j[f].a_attr&&j[f].a_attr.id&&delete j[f].a_attr.id);else j.type=j.id&&h[j.id]&&h[j.id].type?h[j.id].type:"default",c&&c.no_id&&(j=this._delete_ids(j));return j},this._delete_ids=function(a){if(b.isArray(a)){for(var c=0,d=a.length;d>c;c++)a[c]=this._delete_ids(a[c]);return a}return delete a.id,a.li_attr&&a.li_attr.id&&delete a.li_attr.id,a.a_attr&&a.a_attr.id&&delete a.a_attr.id,a.children&&b.isArray(a.children)&&(a.children=this._delete_ids(a.children)),a},this.check=function(a,e,f,g,h){if(d.check.call(this,a,e,f,g,h)===!1)return!1;e=e&&e.id?e:this.get_node(e),f=f&&f.id?f:this.get_node(f);var i,j,k,l,m=e&&e.id?h&&h.origin?h.origin:b.jstree.reference(e.id):null;switch(m=m&&m._model&&m._model.data?m._model.data:null,a){case"create_node":case"move_node":case"copy_node":if("move_node"!==a||-1===b.inArray(e.id,f.children)){if(i=this.get_rules(f),i.max_children!==c&&-1!==i.max_children&&i.max_children===f.children.length)return this._data.core.last_error={error:"check",plugin:"types",id:"types_01",reason:"max_children prevents function: "+a,data:JSON.stringify({chk:a,pos:g,obj:e&&e.id?e.id:!1,par:f&&f.id?f.id:!1})},!1;if(i.valid_children!==c&&-1!==i.valid_children&&-1===b.inArray(e.type||"default",i.valid_children))return this._data.core.last_error={error:"check",plugin:"types",id:"types_02",reason:"valid_children prevents function: "+a,data:JSON.stringify({chk:a,pos:g,obj:e&&e.id?e.id:!1,par:f&&f.id?f.id:!1})},!1;if(m&&e.children_d&&e.parents){for(j=0,k=0,l=e.children_d.length;l>k;k++)j=Math.max(j,m[e.children_d[k]].parents.length);j=j-e.parents.length+1}(0>=j||j===c)&&(j=1);do{if(i.max_depth!==c&&-1!==i.max_depth&&i.max_depth<j)return this._data.core.last_error={error:"check",plugin:"types",id:"types_03",reason:"max_depth prevents function: "+a,data:JSON.stringify({chk:a,pos:g,obj:e&&e.id?e.id:!1,par:f&&f.id?f.id:!1})},!1;f=this.get_node(f.parent),i=this.get_rules(f),j++}while(f)}}return!0},this.get_rules=function(a){if(a=this.get_node(a),!a)return!1;var b=this.get_type(a,!0);return b.max_depth===c&&(b.max_depth=-1),b.max_children===c&&(b.max_children=-1),b.valid_children===c&&(b.valid_children=-1),b},this.get_type=function(a,c){return a=this.get_node(a),a?c?b.extend({type:a.type},this.settings.types[a.type]):a.type:!1},this.set_type=function(a,d){var e,f,g,h,i;if(b.isArray(a)){for(a=a.slice(),f=0,g=a.length;g>f;f++)this.set_type(a[f],d);return!0}return e=this.settings.types,a=this.get_node(a),e[d]&&a?(h=a.type,i=this.get_icon(a),a.type=d,(i===!0||e[h]&&e[h].icon!==c&&i===e[h].icon)&&this.set_icon(a,e[d].icon!==c?e[d].icon:!0),!0):!1}},b.jstree.defaults.unique={case_sensitive:!1,duplicate:function(a,b){return a+" ("+b+")"}},b.jstree.plugins.unique=function(a,d){this.check=function(a,c,e,f,g){if(d.check.call(this,a,c,e,f,g)===!1)return!1;if(c=c&&c.id?c:this.get_node(c),e=e&&e.id?e:this.get_node(e),!e||!e.children)return!0;var h,i,j="rename_node"===a?f:c.text,k=[],l=this.settings.unique.case_sensitive,m=this._model.data;for(h=0,i=e.children.length;i>h;h++)k.push(l?m[e.children[h]].text:m[e.children[h]].text.toLowerCase());switch(l||(j=j.toLowerCase()),a){case"delete_node":return!0;case"rename_node":return h=-1===b.inArray(j,k)||c.text&&c.text[l?"toString":"toLowerCase"]()===j,h||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_01",reason:"Child with name "+j+" already exists. Preventing: "+a,data:JSON.stringify({chk:a,pos:f,obj:c&&c.id?c.id:!1,par:e&&e.id?e.id:!1})}),h;case"create_node":return h=-1===b.inArray(j,k),h||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_04",reason:"Child with name "+j+" already exists. Preventing: "+a,data:JSON.stringify({chk:a,pos:f,obj:c&&c.id?c.id:!1,par:e&&e.id?e.id:!1})}),h;case"copy_node":return h=-1===b.inArray(j,k),h||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_02",reason:"Child with name "+j+" already exists. Preventing: "+a,data:JSON.stringify({chk:a,pos:f,obj:c&&c.id?c.id:!1,par:e&&e.id?e.id:!1})}),h;case"move_node":return h=c.parent===e.id&&(!g||!g.is_multi)||-1===b.inArray(j,k),h||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_03",reason:"Child with name "+j+" already exists. Preventing: "+a,data:JSON.stringify({chk:a,pos:f,obj:c&&c.id?c.id:!1,par:e&&e.id?e.id:!1})}),h}return!0},this.create_node=function(a,e,f,g,h){if(!e||e.text===c){if(null===a&&(a="#"),a=this.get_node(a),!a)return d.create_node.call(this,a,e,f,g,h);if(f=f===c?"last":f,!f.toString().match(/^(before|after)$/)&&!h&&!this.is_loaded(a))return d.create_node.call(this,a,e,f,g,h);e||(e={});var i,j,k,l,m,n=this._model.data,o=this.settings.unique.case_sensitive,p=this.settings.unique.duplicate;for(j=i=this.get_string("New node"),k=[],l=0,m=a.children.length;m>l;l++)k.push(o?n[a.children[l]].text:n[a.children[l]].text.toLowerCase());for(l=1;-1!==b.inArray(o?j:j.toLowerCase(),k);)j=p.call(this,i,++l).toString();e.text=j}return d.create_node.call(this,a,e,f,g,h)}};var p=l.createElement("DIV");if(p.setAttribute("unselectable","on"),p.setAttribute("role","presentation"),p.className="jstree-wholerow",p.innerHTML="&#160;",b.jstree.plugins.wholerow=function(a,c){this.bind=function(){c.bind.call(this),this.element.on("ready.jstree set_state.jstree",b.proxy(function(){this.hide_dots()},this)).on("init.jstree loading.jstree ready.jstree",b.proxy(function(){this.get_container_ul().addClass("jstree-wholerow-ul")},this)).on("deselect_all.jstree",b.proxy(function(a,b){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked")},this)).on("changed.jstree",b.proxy(function(a,b){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked");var c,d,e=!1;for(c=0,d=b.selected.length;d>c;c++)e=this.get_node(b.selected[c],!0),e&&e.length&&e.children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("open_node.jstree",b.proxy(function(a,b){this.get_node(b.node,!0).find(".jstree-clicked").parent().children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("hover_node.jstree dehover_node.jstree",b.proxy(function(a,b){"hover_node"===a.type&&this.is_disabled(b.node)||this.get_node(b.node,!0).children(".jstree-wholerow")["hover_node"===a.type?"addClass":"removeClass"]("jstree-wholerow-hovered")},this)).on("contextmenu.jstree",".jstree-wholerow",b.proxy(function(a){a.preventDefault();var c=b.Event("contextmenu",{metaKey:a.metaKey,ctrlKey:a.ctrlKey,altKey:a.altKey,shiftKey:a.shiftKey,pageX:a.pageX,pageY:a.pageY});b(a.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(c)},this)).on("click.jstree",".jstree-wholerow",function(a){a.stopImmediatePropagation();var c=b.Event("click",{metaKey:a.metaKey,ctrlKey:a.ctrlKey,altKey:a.altKey,shiftKey:a.shiftKey});b(a.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(c).focus()}).on("click.jstree",".jstree-leaf > .jstree-ocl",b.proxy(function(a){a.stopImmediatePropagation();var c=b.Event("click",{metaKey:a.metaKey,ctrlKey:a.ctrlKey,altKey:a.altKey,shiftKey:a.shiftKey});b(a.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(c).focus()},this)).on("mouseover.jstree",".jstree-wholerow, .jstree-icon",b.proxy(function(a){return a.stopImmediatePropagation(),this.is_disabled(a.currentTarget)||this.hover_node(a.currentTarget),!1},this)).on("mouseleave.jstree",".jstree-node",b.proxy(function(a){this.dehover_node(a.currentTarget)},this))},this.teardown=function(){this.settings.wholerow&&this.element.find(".jstree-wholerow").remove(),c.teardown.call(this)},this.redraw_node=function(a,d,e,f){if(a=c.redraw_node.apply(this,arguments)){var g=p.cloneNode(!0);-1!==b.inArray(a.id,this._data.core.selected)&&(g.className+=" jstree-wholerow-clicked"),this._data.core.focused&&this._data.core.focused===a.id&&(g.className+=" jstree-wholerow-hovered"),a.insertBefore(g,a.childNodes[0])}return a}},l.registerElement&&Object&&Object.create){var q=Object.create(HTMLElement.prototype);q.createdCallback=function(){var a,c={core:{},plugins:[]};for(a in b.jstree.plugins)b.jstree.plugins.hasOwnProperty(a)&&this.attributes[a]&&(c.plugins.push(a),this.getAttribute(a)&&JSON.parse(this.getAttribute(a))&&(c[a]=JSON.parse(this.getAttribute(a))));for(a in b.jstree.defaults.core)b.jstree.defaults.core.hasOwnProperty(a)&&this.attributes[a]&&(c.core[a]=JSON.parse(this.getAttribute(a))||this.getAttribute(a));b(this).jstree(c)};try{l.registerElement("vakata-jstree",{prototype:q})}catch(r){}}}}),d.TreeView=function(a){this.mainPane=a,this.mainPane||(this.mainPane=$("body"));var b=this;this.treeView=$('<div id = "plugin_tree_view_id" class="black-font-color"></div>'),this.treeView.on("changed.jstree",function(a,c){b.clickNode(a,c)}).on("hover_node.jstree",function(a,c){b.mouseover(a,c)}).jstree({core:{data:[],themes:{theme:"default",dots:!1,icons:!0}}}),this.treePane=$('<div id="tree-content" class="scroll-class" style="height:300px;overflow:auto; position: relative;display: block;top:15px"></div>'),this.treePane.append(this.treeView),this.mainPane.append(this.treePane),this.dataSet=null,this.clickNodeFunction=null,this.mouseoverNodeFunction=null,this.sortFunction=null},mono.extend(d.TreeView,Object,{isClick:function(a){return!0},clickNode:function(a,b){if(b.selected.length){var c=b.instance.get_node(b.selected[0]);if(c.select_flag)return void delete c.select_flag;c.original&&this.clickNodeFunction&&this.clickNodeFunction(c.original,b)}},mouseover:function(a,b){if(b&&b.node&&b.node.original){this.mouseoverNodeFunction&&this.mouseoverNodeFunction(b.node.original);var c=b.node.original.text;c&&(c=c.replace("<label color=#F00>",""),c=c.replace("</label>",""),$("#"+b.node.id).prop("title",c))}},sort:function(a,b){return this.sortFunction?this.sortFunction(a,b):0},setData:function(a,c){if((this.dataSet||a)&&(this.dataSet=a,this.treeView.jstree(!1)&&this.treeView.jstree(!1)._model&&this.treeView.jstree(!1)._model.data&&(this.treeView.jstree(!1)._model.data={}),this.treeView.data("jstree",!1).empty(),a)){var d=!0;c!=b&&(d=c);var e=this;this.treeView.data("jstree",!1).empty().jstree({core:{data:a,themes:{theme:"default",dots:!0,icons:d}},plugins:["sort"],sort:function(a,b){var c=this.get_node(a)?this.get_node(a).original:null,d=this.get_node(b)?this.get_node(b).original:null;return e.sort(c,d)}})}},setSelectNode:function(a){if(a){var b=this.treeView.jstree(!0),c=b.get_node(a);c&&(c.select_flag=!0),b.deselect_all(),b.select_node(a),this.scrollTreeByNodeId(a)}},getNodeById:function(a){if(a){var b=this.treeView.jstree(!0);return b.get_node(a)}},clearTreeData:function(){this.treeView.data("jstree",!1).empty()},show:function(){this.treeView.show()},hidden:function(){this.treeView.hide()},open:function(a){},close:function(a){},scrollTreeByNodeId:function(a){if(a){var b=$("#"+a);if(b&&!(b.length<1)){var c=0;this.treePane.parent()&&this.treePane.parent().height()>0&&(c=this.treePane.parent().height()-this.treePane.height());var d=this.treePane,e=d[0].clientHeight;e||(e=400);var f=0;if(b.offset()&&(f=b.offset().top),c>f){var g=d.scrollTop()-(c-f);g&&d.scrollTop(g)}else if(f>e+c){var g=d.scrollTop()+(f-(e+c)+70);g&&d.scrollTop(g)}}}},setTreeHeight:function(a){a&&a>15&&this.treePane.height(a-15)}}),d.OrganizeTreeManager=function(a,b){a||console.log("dataManager can not be null"),this.dataManager=a,this.dataType=b},mono.extend(d.OrganizeTreeManager,Object,{includeParent:function(a){return!0},getDataByNode:function(a){return a&&a.id?this.getDataById(a.id):null},getDataById:function(a){return a?this.dataType&&"link"===this.dataType?this.dataManager.getLinkById(a):this.dataManager.getDataById(a):null},isOpen:function(a){return!0},createLabel:function(a){return a?a.getId():""},getParentIdByData:function(a){return a?a instanceof d.Link?null:a.getParentId():null},createNode:function(a,b){if(a){var c={id:a.getId(),text:this.createLabel(a),parentId:this.getParentIdByData(a)};if(b?c.children=b:c.children=[],this.isOpen(a)){var d=c.state;d?d.opened=!0:c.state={opened:!0}}return c}return null},addChild:function(a,b){if(!a||!b)return a;var c=this.getChildren(a);return c?c.push(b):a.children=[b],a},getChildren:function(a){return a.children},organizeTree:function(a){if(!a||a.length<1)return null;for(var b={},c=0;c<a.length;c++){var e=a[c];if(e){var f=this.createNode(e);b[e.getId()]=f}}var g=[],h=d.Util.clone(b);for(var i in b){var f=h[i];this.organizeParent(f,g,h)}return g},organizeParent:function(a,b,c){if(!a)return null;var d=a.parentId;if(!d)return b.push(a),a;var e=c[d];if(e)this.addChild(e,a);else if(this.includeParent(a.data)){var f=this.getDataById(d);if(f){var g=this.createNode(f,[a]);c[f.getId()]=g,this.organizeParent(g,b,c,this)}else b.push(a)}else{var h=this.getAncestorInTreeMap(d,c);h?this.addChild(h,a):b.push(a)}},getAncestorInTreeMap:function(a,b){if(!a||!b)return null;if(b[a])return b[a];var c=this.getDataById(a);return c&&this.getParentIdByData(c)?this.getAncestorInTreeMap(this.getParentIdByData(c),b,this):null}});var H=function(){this.diagramPane=$('<div class="diagram"></div>'),this.diagramContentPane=$('<div class="diagram-content"></div>');var a=$("#itv-main");a.append(this.diagramPane),this.serialNumColorMap={},this.num=1,this.hideDiagram()};mono.extend(H,Object,{setData:function(a,b){if(a&&!(a.length<1)){this.diagramPane.empty(),this.diagramContentPane.empty(),this.diagramPane.show(),b||(b="连续可用空间图例");var c=$('<div class="title">'+b+"</div>");if(this.diagramPane.append(c),this.diagramPane.append(this.diagramContentPane),a instanceof Array)for(var d=0;d<a.length;d++){var e=a[d];this.createItem(e)}}},createItem:function(a){if(a){var b=a.value,c=a.color;if(b&&c){var d=$('<div class="diagram-item"></div>'),e=$('<div class="cl"></div>');e.css("background-color",c),d.append(e);var f=$('<label class="lb">'+b+"</label>");d.append(f),this.diagramContentPane.append(d)}}},showSerialDiagram:function(a){var b=[];this.serialNumColorMap={},a=parseInt(a),a||(a=1),this.num=a;var c=Math.floor(47/a),d=Math.floor(c/4),e=this.getCapacityColor(null,.1),f={color:e,value:3*d+1+"-"+c};if(4>=c)f.value=c,this.serialNumColorMap[c]=e;else for(var g=3*d+1;c>=g;g++)this.serialNumColorMap[g]=e;if(b.push(f),e=this.getCapacityColor(null,.3),f={color:e,value:2*d+1+"-"+3*d},c>1&&4>=c)f.value=c-1,this.serialNumColorMap[c-1]=e;else for(var g=2*d+1;3*d>=g;g++)this.serialNumColorMap[g]=e;if(c>1&&b.push(f),e=this.getCapacityColor(null,.6),f={color:e,value:d+1+"-"+2*d},c>2&&4>=c)f.value=c-2,this.serialNumColorMap[c-2]=e;else for(var g=d+1;2*d>=g;g++)this.serialNumColorMap[g]=e;if(c>2&&b.push(f),e=this.getCapacityColor(null,.8),f={color:e,value:"1-"+d},c>3&&4>=c)f.value=c-3,this.serialNumColorMap[c-3]=e;else for(var g=1;d>=g;g++)this.serialNumColorMap[g]=e;c>3&&b.push(f),this.setData(b,"连续可用空间图例")},showTotalSpaceDiagram:function(){var a=[];this.num=1;var b=this.getCapacityColor(null,.1),c={color:b,value:"1-25%"};a.push(c),b=this.getCapacityColor(null,.3),c={color:b,value:"25-50%"},a.push(c),b=this.getCapacityColor(null,.6),c={color:b,value:"50-75%"},a.push(c),b=this.getCapacityColor(null,.8),c={color:b,value:"75-100%"},a.push(c),this.setData(a,"非连续可用空间图例")},hideDiagram:function(){this.diagramPane.empty(),this.diagramPane.hide()},getCapacityColor:function(a,b){return b?.25>=b?"#5DBDE0":.5>=b?"#6FD772":.75>=b?"#FFC95A":"#Fd674F":"#5DBDE0"}}),d.Diagram=H,d.SearchManager=function(a,b,c,d){this.sceneManager=a,this.itSearchManager=null,this.spaceSearchManager=null,this.itSearchInputPanel=b,this.spaceSearchInputPanel=c,this.showModel="",this.spaceMode=d||1,this.init()},mono.extend(d.SearchManager,Object,{init:function(){this.spaceSearchManager=new d.SpaceSearchManager(this.sceneManager,this.spaceSearchInputPanel,this.spaceMode),this.itSearchManager=new d.ITSearchManager(this.sceneManager,this.itSearchInputPanel),this.itSearchManager.clearAll(),this.itSearchManager.clearAllVirtual(),this.itSearchManager.hide(),this.spaceSearchManager.clearAll(),this.spaceSearchManager.clearAllVirtual(),this.spaceSearchManager.hide()},showITSearch:function(){this["switch"](!1)},hideITSearch:function(){this.itSearchManager&&(this.itSearchManager.clearAll(),this.itSearchManager.clearAllVirtual(),this.itSearchManager.hide())},showSpaceSearch:function(){this["switch"](!0)},hideSpaceSearch:function(){this.spaceSearchManager&&(this.spaceSearchManager.clearAll(),this.spaceSearchManager.clearAllVirtual(),this.spaceSearchManager.hide())},"switch":function(a){a?(this.showModel="S",this.itSearchManager.clearAll(),this.itSearchManager.clearAllVirtual(),this.itSearchManager.hide(),this.spaceSearchManager.virtualAllNodes(),this.spaceSearchManager.setupInit(),this.spaceSearchManager.show()):(this.showModel="IT",this.spaceSearchManager.clearAll(),this.spaceSearchManager.clearAllVirtual(),this.spaceSearchManager.clearInit(),this.spaceSearchManager.hide(),this.itSearchManager.show())},getITSearchTree:function(){return this.itSearchManager?this.itSearchManager.getTreeView():null},getSpaceSearchTree:function(){return this.spaceSearchManager?this.spaceSearchManager.getTreeView():null},getITSearchOrganizeTreeManager:function(){return this.itSearchManager?this.itSearchManager.getOrganizeTreeManager():null},getSpaceSearchOrganizeTreeManager:function(){return this.spaceSearchManager?this.spaceSearchManager.getOrganizeTreeManager():null},setPanelLocation:function(a){this.setITSearchPanelLocation(a),this.setSpaceSearchPanelLocation(a)},setITSearchPanelLocation:function(a){var c=this.itSearchManager.searPanel;a&&(c.css("left","auto"),c.css("right","auto"),c.css("bottom","auto"),c.css("top","auto"),null!=a.left&&a.left!=b&&c.css("left",parseInt(a.left)+"px"),null!=a.right&&a.right!=b&&c.css("right",parseInt(a.right)+"px"),null!=a.bottom&&a.bottom!=b&&c.css("bottom",parseInt(a.bottom)+"px"),null!=a.top&&a.top!=b&&c.css("top",parseInt(a.top)+"px"))},setSpaceSearchPanelLocation:function(a){var c=this.spaceSearchManager.searPanel;a&&(c.css("left","auto"),c.css("right","auto"),c.css("bottom","auto"),c.css("top","auto"),null!=a.left&&a.left!=b&&c.css("left",parseInt(a.left)+"px"),null!=a.right&&a.right!=b&&c.css("right",parseInt(a.right)+"px"),null!=a.bottom&&a.bottom!=b&&c.css("bottom",parseInt(a.bottom)+"px"),null!=a.top&&a.top!=b&&c.css("top",parseInt(a.top)+"px"))},getItSearchPane:function(){return this.itSearchManager.searPanel},getSpaceSearchPane:function(){return this.spaceSearchManager.searPanel},setParent:function(a){a&&$(a)?(a=$(a),a.append(this.itSearchManager.searPanel),a.append(this.spaceSearchManager.searPanel)):($("body").append(this.itSearchManager.searPanel),$("body").append(this.spaceSearchManager.searPanel))}}),d.BaseSearch=function(a,b){if(!a)return void console.error("agument sceneManager can not be null");this.sceneManager=a,this.dataManager=this.sceneManager.dataManager,this.dataFinder=new d.DataFinder(this.sceneManager.dataManager);var c=this;this.dataFinder.filter=function(a){
return c.filter(a)},this.virtualManager=this.getVirtualManager()||new d.VirtualManager(a),this.virtualManager.isDealWithFunction=function(a){return a?a instanceof d.Data&&a.getDataTypeId()&&a.getDataTypeId().indexOf("room")>=0?!1:!0:!1},this.sceneManager.viewManager3d.addMaterialFilter(this.virtualManager),this.treeView=null,this.orgTreeManager=new d.OrganizeTreeManager(this.sceneManager.dataManager),this.defaultEventHandler=a.viewManager3d.getDefaultEventHandler(),this.inputPane=b||this.createInputPane(),this.searPanel=null,this.clearAllFunction=null,this.initSearchPane()},mono.extend(d.BaseSearch,Object,{createInputPane:function(){return new d.BasePanel},getVirtualManager:function(){return new d.VirtualManager(this.sceneManager)},removeVirtualManager:function(){this.sceneManager.viewManager3d.removeMaterialFilter(this.virtualManager)},filter:function(a){return!0},clearAllVirtual:function(){this.virtualManager.clearAll()},initSearchPane:function(){this.searPanel=$(".search-main-pane");var a=0;this.searPanel&&this.searPanel.length>0&&(a=this.searPanel.length),this.searPanel=$('<div id = "search-main-pane_'+a+'" class="search-main-pane"></div>'),this.searPanel.append(this.inputPane.getContentPane()),this.treeView=new d.TreeView(this.searPanel);var b=this;this.treeView.clickNodeFunction=function(a){b.clickTreeNode(a)},this.treeView.mouseoverNodeFunction=function(a){b.mouseOverTreeNode(a)},this.inputPane.doClickFunction=function(a){b.beforeDoClick(),b.setData(a);var c=b.searPanel.height()-b.inputPane.getContentPane().height();b.treeView.setTreeHeight(c)},this.inputPane.doClearFunction=function(){b.clearSearch()}},beforeDoClick:function(){},show:function(){this.searPanel.show()},beforHide:function(){},hide:function(){this.beforHide(),this.searPanel.hide()},setData:function(a){var b=this.dataFinder.find(a),c=null;!b||b.length<1?this.treeView.clearTreeData():(c=this.orgTreeManager.organizeTree(b),this.treeView.setData(c,!1)),this.setResult(b,c)},setResult:function(a,b){},clearSearch:function(){this.treeView.setData(null),this.clearSearchData(),this.sceneManager.network3d.dirtyNetwork()},clearSearchData:function(){},clearAll:function(){this.treeView.setData(null),this.inputPane.clearInput&&this.inputPane.clearInput(),this.clearAllFunction?this.clearAllFunction():this.clearSearchData()},getRootDataBySceneAndData:function(a,b,c){if(!a||!b)return null;c=c||this;var d=this.sceneManager.dataManager.getDataTypeForData(b);if(d&&d.getCategoryId()===a.getCategoryId())return b;if(b.getParentId()){var e=this.sceneManager.dataManager.getDataById(b.getParentId());if(e)return c.getRootDataBySceneAndData(a,e,c)}return null},clickTreeNode:function(a){var b=a.id;if(b){var c=this.sceneManager.dataManager.getDataById(b);if(c&&this.treeView.isClick(c)){var d=this.sceneManager.dataNodeMap[b];if(!this.sceneManager.isCurrentSceneInstance(c)){var e=this.sceneManager.getSceneAndRootByData(c);e&&(this.sceneManager.gotoScene(e.scene,e.rootData),e.rootData!=c?(d=this.sceneManager.dataNodeMap[b],d||this.sceneManager.loadLazyData(c)):d=null)}var f=this.sceneManager.network3d.getDataBox();d&&f.getDataById(d.getId())||(this.sceneManager.loadLazyData(c),d||(d=this.sceneManager.dataNodeMap[c.getId()])),this.defaultEventHandler&&this.defaultEventHandler.lookAt(d)}}},mouseOverTreeNode:function(a){var b=a.id;if(b){var c=this.sceneManager.dataNodeMap[b];c&&(this.sceneManager.network3d.getDataBox().getSelectionModel().clearSelection(),c.setSelected(!0))}},getTreeView:function(){return this.treeView},getOrganizeTreeManager:function(){return this.orgTreeManager}}),d.ITSearchManager=function(a,b){d.ITSearchManager.superClass.constructor.call(this,a,b),this._assetImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADEAAAA6CAYAAAAZW7HfAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAdzSURBVHja3JptaFvXGcd/5+pKsixZdmIvbbO81XlxlqZlXZxC20E32IdQ0pQsDDIYKWWBlRXGMkZhNHthTdmHQfNhjDLYCGwjhTKadgmhJNB2tM26Js4KKZnTpFkdh2Rx/SLbsmTp3vM8+yBbkR3JvnpxnE3mfJB1zznP//z//+c8595rVJX/9Y9b8Zeenz0B7AO2AolFii8NnAZeYssvj1W6yJRjQk//9ABjF583Q2dgoh8kvzgQnAjEV6HtWyC5/kWz9YX9gUDoh/u3M37xqOk/CjZ7Z+glFENXPAHJ9TvMQweOzisnFf2RGewpAphMhbjyQYLsjTjGhDHGgDELS4BrSdyd5e4HR4i2+oVYhnrQxLp9BuYHgUi3yfQDkB0Jcf71dmKxJO33tBBtbiIUCoFZ4JVXsNYy1DNBx9ZeIi15TKYfFekOZGwVbZn2wNV/JIjFknQs7yDRliAcCWMcc1sUpKJ4+TjZ/kkimz4ByRdiK8dcuc7Tn8yNOMmlLSTaEkSaIrcNAIBxDJGmCGH5YtnY5pPTzYFMmGhzE+FIuPooYgmcbXswK9ajVy8ib/4Rsumqhwm7TWVjm4eJUhCGUChUEwPOtj2YlV1gHMzKLpxte2pmpFxsgeWEMTWZ2HRtKQAo/d/KLkzXlrp9EkxOVkALkasqqoKqBAfQtgznsV1QZhN1HtuF/U8fmhqoMnpzM7bAclKmmoJoQYsBmkm2E9r5LESbywcTbSa081lMsj3wmJTEE1xO00yoAVVUJFBjzX04u38MLUvmXtWWJYXr1twXfOypeLQCE25Z3c2Wk9g55RP66g6crql9KEBVbKLNuE8+g1w4g33vr/PLazqeoJ5QKyDcBDG9GsU6xsXctRpneSdO52bMqo1gDLUU9KarG3fDFvRKL3L5Y+TaZfRGH1h/VtoviS2osbWIXEAsOjWo03k/4cefhnjrLOT1nUnMqo2EVm0kBDAxinf8EHL5XMnwtRhbDIgpMGFtsbnb90I8SYnzG9/iSdzte2fMW4xHpBo5makNUgrN2mJhxu04CCo354RiPBqYCWtnZSeLio+Kj/fuEfQ2/HnvHinOqeKXZCdbPRMqcpNSIH/qGKZjOe6DX1swEvx/vkP+1LGZPpuHibnlpIKIRUqyRfbIyzS3LSO05ksNB2A/+xfZIy/D7AqhejmVGFsUtTLDZOp7ZF/7bTFjNcwG1i+M63sz5ys1djVMqDhTqU0KurShmSs20I939m3C3d9oGAjv7NvYgf4KhZ9TOxOUY2Kq5U4db2hqzZ06XnaeGpmws1LsTE8UZXqlFxkdxkkurZsFGRvGu9JbedMseqKW7FTc7JzymaSvl8jmh+vPSH29qD+Hx2rLTk6gAtAOXUcbsPvZoetzFpnM44mA+0T5453msg3ZwTWXrSiV2pjwLVoqJ9GKNYuJtzakDjHx1opzzMhOfkBPYAWmV161UMVKpcmTjbk9E0/OLafpFF+LnFCdAlK+s3x+7daMooJ3+Tx+/yfIyABqfUzIxVmyDHflBsKdm8A4t44zBxM1GNuWGHva3OUlM3HyMO66Bwiv7sK/0c/k+8eY/PtxZDxV+VZOSxtNDz9O06Pbce9aidd3gYmTh5nzOUnR2DWk2Hnze2qQkV/trW5PGE+ROXGYzInDVXSqowAMuYbFfo5kHFNfAdjWEUFEWcwnYpGEO2/ZUQ7EuIiLisPqDQl8Ad8uDgoTMiSWxVBxEAmhVtJBT3Zn8hIBMTQ3h7n3/iU4sTC+cNsYMY4h2hJh6ZokbqTARF6iqLWng3riYJrmr4fxcRBisTCxta2LpycBwSFNM4ocLAu6XGr77HvdB2Lkn4+bSaJ4LJa9FUOOMGltYpLIi2t+d2Z/YBAA/977lR3AD4GHgDhAwuRY4mQWNOiUxEhrtLgVAR8CB+/9/dmjFeUX9GH85ae/bIDDSSe/u82ZXBAQI9LEuER+3Xnoo+eq6ecEvbDz0EeqVr476rk9o36k5PTXmJbyoox57ptq5SdVJ4JqX4v49DubVwA97a63LO7YhjAwbkOM2PAloHvtnz8eXXAQAJe+velR4K17Il4kYuozfVYcBjx3FHhk3Svnz9cyhlNLp3WvnH9frXx/LO8UbvbW2KwYbkw6qlaeqhVAzSAA1r/a+4dxT38znKsdRCpvUJFfrH+194162HTqSomi+0bz+tZITqu+SzOcU0bz+pqKvlD3Dl/v+04XnlzbAXzQ0eSsTYaDrcloXhjKyTngka43Pk3XC8KpdwAVGVSRnZ9n/PGMP/9T1glPGMz6wyryTRVJNyK7NQCEoqLnVHTPtXFPfanMrCfK9bRnVXS3il5SaUw5UzeIkke1ryPy85Fs5ZtgqawPIs8hcrLY7w5iYrodSGW8vwymvVuuG0x7pDLen1T0pdI+jfi4DfDEzBoOnhqeyG1wjD6wNB4BYHgiz/BE/gzwzELUXG79crplNTPAjsGx3Omw43wBlMGx3ACwc+q3Ow9EBUn0Ad+6Npw5MfV9F3B1oUr4+pmovM/8DfjBlMTeW9Dj7P/Dy73/HQANrcExejPxoAAAAABJRU5ErkJggg=="},mono.extend(d.ITSearchManager,d.BaseSearch,{createInputPane:function(){return new d.ITSearchPanel},clearSearchData:function(){this.clearBillboard()},setResult:function(a,b){if(this.clearBillboard(),this.virtualManager.addAll(),b)for(var c=0;c<b.length;c++){var d=b[c];this.showData(d)}},showData:function(a){var b=this.orgTreeManager.getDataByNode(a);if(b){this.showBillboard(b)&&this.addDataBillBoard(b),this.virtualManager.remove(b);var c=this.orgTreeManager.getChildren(a);if(c&&c.length>0)for(var d=0;d<c.length;d++){var e=c[d];e&&this.showData(e,this)}}},showBillboard:function(a){if(!a)return!1;var b=a.getDataTypeId();if(b){if(b.indexOf("equipment")>=0)return!1;if(b.indexOf("room")>=0)return!1;if(b.indexOf("floor")>=0)return!1}return!0},clearBillboard:function(){if(this.sceneManager.dataNodeMap)for(var a in this.sceneManager.dataNodeMap){var b=this.sceneManager.dataNodeMap[a];if(b&&b.getClient("asset_billboard")){var c=b.getClient("asset_billboard");c.setParent(null),this.sceneManager.network3d.getDataBox().remove(c)}}this.virtualManager.clearAll()},addDataBillBoard:function(a){if(a){var b=this.sceneManager.dataNodeMap[a.getId()];if(b){var c=this.sceneManager.network3d.getDataBox();if(c.getDataById(b.getId())){var d=new mono.Billboard;d.setPosition(0,b.getBoundingBox().max.y+20,0),d.setStyle("m.alignment",mono.BillboardAlignment.bottomCenter),d.setStyle("m.transparent",!0),d.setStyle("m.texture.image",this._assetImage),d.setStyle("m.alignment",mono.BillboardAlignment.bottomCenter),d.setScale(40,50,1),d.setParent(b),d.setClient("it_data",a),c.add(d),b.setClient("asset_billboard",d)}}}}}),d.SpaceSearchVirtualManager=function(a,b){d.VirtualManager.call(this,a),this.spaceManager=b},mono.extend(d.SpaceSearchVirtualManager,d.VirtualManager,{filterMaterial:function(a,b,c){var d=this.sceneManager,e=this.spaceManager;this.materialMap;if(d.getNodeData(c))return b;if(e.isSpaceNode(c)){var f=c.getParent();e.isSpaceNode(f)&&(f=f.getParent());var g=!1;if(f){var h=this.getDataByNode(f);h&&(i=this.getBId(h),this._global_tmap[i]?g=this._global_tmap[i]:this._tmap[i]&&(g=this._tmap[i]))}if(!g)return b;var i=a.getUniqueCode(),j=this.materialMap[i];return j||(j=a.clone(),this.materialMap[i]=j,j.transparent=!0,j.opacity=.05),j}}}),d.SpaceSearchManager=function(a,b,c){d.BaseSearch.call(this,a,b),this.spaceManager=new d.SpaceManager(this.dataManager,this.sceneManager),this.diagram=new d.Diagram,this.isVirtualFunction=null,this.virtualNode=[],this.spaceMap={},this.mode=c||1,this.spaceManager.spaceNodeColorFunction=function(a){return a?.25>=a?"#5DBDE0":.5>=a?"#6FD772":.75>=a?"#FFC95A":"#Fd674F":"#5DBDE0"},this.spaceManager.spaceNodeFrameColorFunction=function(a){return a?.25>=a?"#018ABD":.5>=a?"#1A920A":.75>=a?"#E68D00":"#CE3118":"#018ABD"},this.resetTreeLabel(),this.virtualAllNodes(),this.clearAllFunction=function(){this.clearSpaceNode()};var e=this;this.sceneChangeListener=function(a){a.data&&a.data.getCategoryId()&&"floor"==a.data.getCategoryId().toLowerCase()&&e.showSpaceNode()}},mono.extend(d.SpaceSearchManager,d.BaseSearch,{setupInit:function(){this.sceneManager.addSceneChangeListener(this.sceneChangeListener),this.visOrVirtFilter||(this.visOrVirtFilter=this.setVisibleOrVirtualData(this.sceneManager),this.visOrVirtFilter&&(this.visOrVirtFilter instanceof d.VisibleManager?this.sceneManager.viewManager3d.addVisibleFilter(this.visOrVirtFilter):this.visOrVirtFilter instanceof d.VirtualManager&&this.sceneManager.viewManager3d.addMaterialFilter(this.visOrVirtFilter)),this.setupDoOther(this.sceneManager))},clearInit:function(){this.sceneManager.removeSceneChangeListener(this.sceneChangeListener),this.visOrVirtFilter&&(this.visOrVirtFilter instanceof d.VisibleManager?this.sceneManager.viewManager3d.removeVisibleFilter(this.visOrVirtFilter):this.visOrVirtFilter instanceof d.VirtualManager&&this.sceneManager.viewManager3d.removeMaterialFilter(this.visOrVirtFilter)),this.clearDoOther(this.sceneManager)},invisibleOrVirtualData:function(a,b){if(!a&&!b)return!1;var c=this.sceneManager.dataManager.getCategoryForDataType(a);return c&&c.getId()&&c.getId().toLowerCase().indexOf("channel")>=0?!0:!1},setVisibleOrVirtualData:function(a){var b=new d.VisibleManager(a),c=this.dataManager._dataTypeDatas;if(c)for(var e in c)if(this.invisibleOrVirtualData(e)){var f=c[e];if(f)for(var g in f)b.setVisible(f[g],!1)}return b},setupDoOther:function(a){},clearDoOther:function(a){},createInputPane:function(){return this.inputPane=new d.SpaceSearchPanel,this.inputPane},getVirtualManager:function(){return new d.SpaceSearchVirtualManager(this.sceneManager,new d.SpaceManager(this.dataManager,this.sceneManager))},resetTreeLabel:function(){var a=this;this.orgTreeManager.createLabel=function(b){return a.setLabel(b)}},getUNumber:function(a){return this.inputPane?parseInt(this.inputPane.getUNumber()):1},setLabel:function(a){if(!a||!a.getId())return null;var b=a.getId(),c=this.spaceMap[b],d=this.getUNumber();if(c&&d){var e=0,f=c.getEmptyList();if(f&&f.length>0)for(var g=0;g<f.length;g++){var h=f[g];h.total>=d&&(e+=Math.floor(h.total/d))}return b+"("+e+"个)"}return b},setResult:function(a,b){if(this.clearSpaceNode(),this.virtualManager.addAll(),a){for(var c=0;c<a.length;c++){var d=a[c],e=this.sceneManager.dataNodeMap[d.getId()];this.virtualManager.remove(d),e&&this._dealWithOneNode(e)}this.showSpaceNode()}},beforHide:function(){this.diagram.hideDiagram()},clearSearchData:function(){this.initAllNodes(),this.showSpaceNode(),this.virtualManager.clearAll()},clearSpaceNode:function(){var a=this.getAllNodes();this.spaceManager.remove1DSpaceNodeForNodes(a),this.spaceManager.hideSpaceMode(),this.diagram.showSerialDiagram(1)},virtualAllNodes:function(){this.initAllNodes(),this.showSpaceNode()},showSpaceNode:function(){var a=this.getSceneNodes();a&&a.length>0?this.diagram.showSerialDiagram(this.getUNumber()):this.diagram.hideDiagram(),this.spaceManager.create1DSpaceNodeForNodes(a,this.mode),this.spaceManager.showSpaceMode()},isDealwith:function(a){if(!a)return!1;if(this.isVirtualFunction)return this.isVirtualFunction(a);var b=this.sceneManager.getNodeData(a);if(!b)return!1;var c=this.sceneManager.dataManager.getDataTypeForData(b);return c?c._model.indexOf(".rack")>0?!0:void 0:!1},_dealWithOneNode:function(a){if(a&&this.isDealwith(a)){var b=this.sceneManager.getNodeData(a);if(!b)return;var c=this.spaceManager.computeSpace(b);if(c&&c instanceof d.Space1){this.spaceMap[d.SceneManager.getNodeDataId(a)]=c;var e=0,f=c.getTotal()-c.getOccupation(),g=c.getEmptyList();if(g&&g.length>0)for(var h=0;h<g.length;h++){var i=g[h];i.total>e&&(e=i.total)}b.setUserData("dyna_user_data_maxSerSpace",e),b.setUserData("dyna_user_data_totalEmpSpace",f),this.virtualNode.push(a)}}},getAllNodes:function(){var a=this.sceneManager.dataNodeMap;if(!a)return null;var b=[];for(var c in a){var e=a[c];if(e&&this.isDealwith(e)){var f=this.sceneManager.getNodeData(e);if(!f)return;var g=this.spaceManager.computeSpace(f);g&&g instanceof d.Space1&&b.push(e)}}return b},getSceneNodes:function(){var a=[],b=this.sceneManager.getSceneDatas();if(b){var c=this.sceneManager.dataNodeMap;for(var e in b){var f=c[e],g=b[e];if(f&&g&&this.isDealwith(f)){var h=this.spaceManager.computeSpace(g);h&&h instanceof d.Space1&&(this._dealWithOneNode(f),a.push(f))}}}return a},initAllNodes:function(){var a=this.sceneManager.dataNodeMap;if(!a)return null;this.virtualNode=[];for(var b in a){var c=a[b];this._dealWithOneNode(c)}return this.virtualNode}}),d.Tab=function(){},mono.extend(d.Tab,Object,{_getTargetLi:function(a){return a?a.tagName&&"LI"==a.tagName.toUpperCase()?a:a.parentElement?arguments.callee(a.parentElement):null:null},_onclick:function(a){a.preventDefault&&a.preventDefault();var b=this._getTargetLi(a.originalEvent.target),c=b.getAttribute("href");if(c||(c=b.childNodes[0].getAttribute("href")),c&&c.length>0){var d=c.substring(1,c.length);$("#"+d)[0]&&$("#"+d)[0].children&&$("#"+d)[0].children.length>0&&(this._clearHover(),b.className="hover",$(".contentbox div.tab-pane").hide(),$("#"+d).show())}},_clearHover:function(){var a=$(".property-pane-tab .menu ul li");if(a&&a.length>0)for(var b=0;b<a.length;b++){var c=a[b];c&&c.className&&(c.className="")}},initAll:function(){var a=this;$(".property-pane-tab .menu ul li").click(function(b){a._onclick(b)})}}),d.PropertyPane=function(a){this.propertyPane=$("<div class='property-pane it-shadow'></div>"),this.propertyTab=$("<div class='property-pane-tab'></div>"),this.propertyItemsDiv=$("<div class='menu'></div>"),this.propertyItemsPane=$("<ul></ul>"),this.propertyTabContent=$('<div class="contentbox scroll-class">'),this.propertyItemsDiv.append(this.propertyItemsPane),this.propertyTab.append(this.propertyItemsDiv),this.propertyTab.append(this.propertyTabContent),this.propertyPane.append(this.propertyTab),a||(a=document.body),a.appendChild(this.propertyPane[0]),this.closeDiv=$('<div class="it-property-title"></div>'),this.propertyPane.prepend(this.closeDiv),this.isvisible,this.tab=new d.Tab,this.hide()},mono.extend(d.PropertyPane,Object,{_createTitle:function(a){a||(a="资产属性");var b=$("<span>"+a+"</span>"),c=$('<div class="close"></div>'),d=this;c.click(function(a){d.hide()}),this.closeDiv.append(b),this.closeDiv.append(c)},clear:function(){this.propertyItemsPane.empty(),this.propertyTabContent.empty(),this.closeDiv.empty()},setData:function(a,b){if(this.clear(),this._createTitle(b),a&&a.items&&!(a.items<1)){for(var c=a.items,d=0;d<c.length;d++){var e=c[d];if(e){var f="tab_"+d,g=e.title,h=e.className,i=e.onclick,j=e.properties,k=e.isGrop;0==d?this.addTab(f,g,j,h,!0,k,i):this.addTab(f,g,j,h,!1,k,i)}}this.showTooltip({id:".menu ul li a",parent:this.propertyPane,offsetY:10}),this.tab.initAll()}},addTab:function(a,b,c,d,e,f,g){var h=$('<li ><a href="#'+a+'" rel = "'+b+'" class= '+d+" ></a></li>");e&&(h.show(),h.attr("class","hover")),g&&h.click(g),this.propertyItemsPane.append(h);var i=$('<div class="tab-pane" id="'+a+'"></div>');e&&i.show(),i.append(this.createTableItemContentByObj(c,f)),this.propertyTabContent.append(i)},createTableItemContentByObj:function(a,b){if(a){var c=$('<form class="form-horizontal" role="form"></form>');if(a instanceof Array){if(a.length>0){if(a.title){var d=this._createTableRow(a.title);d&&c.append(d)}for(var e=0;e<a.length;e++){var f=a[e];if(f){var g=f.callback,h=f.mousemove;if(f.values){var i=f.values,j=this._createTableRow(i,e+1,g,h);j&&c.append(j)}else if(f.name){var k=f.name,l=f.value,j=this._createKeyValueRow(k,l,b,e+1,g,h);j&&c.append(j)}}}}}else for(var m in a)if("function"!=typeof a[m]){var l=a[m],j=this._createKeyValueRow(m,l,b);j&&c.append(j)}return c}},_createTableHead:function(a){if(a){var b=$('<div class="form-group-no-margin"></div>');if(a instanceof Array&&a.length>0){var c=Math.floor(12/a.length);if(c>1){for(var d="col-sm-"+c+" table-label-min label-inline-block",e=0;e<a.length;e++){var f=a[e];if(f){var g=$('<label class="'+d+'">'+f+"</label>");b.append(g)}}return b}}}},_createKeyValueRow:function(a,c,d,e,f,g){if(!a)return null;var h="form-group-no-margin";a+=":";var i="col-sm-4 label-min label-inline-block",j=$('<div class="'+h+'"> </div>'),k=$('<label class="'+i+'">'+a+"</label>");this.propertyPane.width()>300&&k.css("max-width","100px"),j.append(k),(d==b||null==d)&&(d=!0);var l="contral-width label-inline-block";if(c instanceof Array&&c.length>0){var m=$('<div class = "col-sm-8 multi-label-value"></div>');if(this.propertyPane.width()>300&&m.css("width",parseInt(this.propertyPane.width())-120),d)for(var n=2,e=0;e<c.length;e+=n){var o=c[e];if(o){var p=c[e],q=c[e+1],r=$('<div class = "row"></div>'),s=$('<div class = "col-xs-6 col-sm-6"></div>'),t=$('<div class = "col-xs-6 col-sm-6"></div>');p&&r.append(s),q&&r.append(t),m.append(r);var u=$('<label class="'+l+'">'+c[e]+"</label>");s.append(u);var u=$('<label class="'+l+'">'+c[e+1]+"</label>");t.append(u)}}else for(var e=0;e<c.length;e++){var o=c[e];if(o){var v=$('<label class="'+l+'">'+o+"</label>");m.append(v)}}j.append(m)}else{var v=$('<label class="col-sm-8 label-value label-inline-block">'+c+"</label>");this.propertyPane.width()>300&&v.css("width",parseInt(this.propertyPane.width())-120),j.append(v)}return f&&j.click(f),g&&j.mousemove(g),j},_createTableRow:function(a,c,d,e){if(!a||a.length<=0)return null;if(a instanceof Array){var f="form-group-no-margin",g=Math.floor(12/a.length);if(!(0>=g)){f=c&&c%2==1?"form-group-table-margin t-odd":"form-group-table-margin";for(var h=$('<div class="'+f+'"> </div>'),i=0;i<a.length;i++){var j=a[i];if(j){var k=j,l=g;j.c_width&&parseInt(j.c_width)&&(l=parseInt(j.c_width)),j.text!=b&&(k=j.text);var m="col-sm-"+l+" table-label-min label-inline-block",n=$('<label class="'+m+'">'+k+"</label>");h.append(n)}}return d&&h.click(d),e&&h.mousemove(e),h}}},show:function(a,c,d){if(d){if(this.propertyPane.css("left","auto"),this.propertyPane.css("right","auto"),this.propertyPane.css("top","auto"),this.propertyPane.css("bottom","auto"),null!=d.left&&d.left!=b&&this.propertyPane.css("left",parseInt(d.left)+"px"),null!=d.right&&d.right!=b)if(this.propertyPane.parent()&&this.propertyPane.parent().css("width")){var e=parseInt(this.propertyPane.parent().css("width"))-parseInt(this.propertyPane.css("width"))-d.right;this.propertyPane.css("left",e+"px")}else this.propertyPane.css("right",parseInt(d.right)+"px");if(null!=d.bottom&&d.bottom!=b)if(this.propertyPane.parent()&&this.propertyPane.parent().css("height")){var f=parseInt(this.propertyPane.parent().css("height"))-parseInt(this.propertyPane.css("height"))-d.bottom;this.propertyPane.css("top",f+"px")}else this.propertyPane.css("bottom",parseInt(d.bottom)+"px");null!=d.top&&d.top!=b&&this.propertyPane.css("top",parseInt(d.top)+"px")}this.setData(a,c),this.propertyPane.show(),this.isvisible=!0},hide:function(){this.propertyPane.hide(),this.isvisible=!1},showTooltip:function(a){if(a&&a.parent){var b=a.offsetY?a.offsetY:0,c=a.offsetX?a.offsetX:0;if(a.id)$(a.id).mouseover(function(d){var e=d.target.rel,f=$("<div id='tooltip' class='tap-tooltip-content it-shadow'>"+e+"</div>");a.parent.append(f);var g=d.target.offsetTop-d.target.offsetHeight+b,h=d.target.offsetLeft+d.target.offsetWidth+c;f.css("top",g),f.css("left",h)}).mouseout(function(){$("#tooltip").remove()});else if(a.selector){if(!a.text)return;a.selector.mouseover(function(d){var e=$("<div id='tooltip' class='tap-tooltip-content it-shadow'>"+a.text+"</div>");a.parent.append(e);var f=d.target.offsetTop-d.target.offsetHeight+b,g=d.target.offsetLeft+d.target.offsetWidth+c;e.css("top",f),e.css("left",g)}).mouseout(function(){$("#tooltip").remove()})}}},setWidthForPropertyPane:function(a){var a=a||"23%";this.propertyPane.css("width",a)},setHeightForPropertyPane:function(a){var a=a||"30%";this.propertyPane.css("height",a)}}),d.PropertyManager=function(a){this.sceneManager=null,this.dataManager=null;var b=null!=a&&null!=a.network3d?a.network3d.getRootView():null;this.propertyPane=new d.PropertyPane(b),this.setSceneManager(a),this.getContentFunction=null,this.nodeInfoFunction=null,this.mouseoverDevFunction=null,this.devClickFunction=null,this.devListSortFunction=null,this.devTableRule={},this.dataInfoRule={},this.statInfoRule={},this.otherInfoRule={},this.width,this.height},mono.extend(d.PropertyManager,Object,{setDefaultRackRule:function(a){if(a&&!(a.length<1)){a instanceof Array||(a=[a]);for(var b=this,c=[{label:"资产编号",property:function(a){return a.getId()}},{label:"用户Id",property:"userId"},{label:"制造商",property:"制造商"}],e=[{header:"设备编号",width:"5",property:function(a){return a.getId()}},{header:"类型",width:3,property:function(a){var c=b.dataManager.getDataTypeForData(a);return c&&c.getDescription()?c.getDescription():c&&c.getModel()?c.getModel():void 0}},{header:"位置",width:4,property:function(a){var c="",d=b.dataManager.getDataTypeForData(a),e=1;return d&&d.getSize()&&d.getSize().ySize&&(e=d.getSize().ySize),a.getLocation()&&a.getLocation().y&&(c=a.getLocation().y+"U-"+(a.getLocation().y+e)+"U("+e+"U)"),c}}],f={value:function(a){var c=new d.SpaceManager(b.dataManager,b.sceneManager),e=c.computeSpace(a);if(e&&e instanceof d.Space1){var f=[];if(e._emptyList&&e._emptyList.length>0)for(var g=0;g<e._emptyList.length;g++){var h=e._emptyList[g];f.push(h.start+"U-"+h.end+"U("+h.total+"U)")}var i={};return i.已用U数=e._occupation+"U",i.还剩U数=e._total-e._occupation+"U",i.空余明细=f,i}}},g=0;g<a.length;g++){var h=a[g];h&&(this.dataInfoRule[h]=c,this.devTableRule[h]=e,this.statInfoRule[h]=f)}}},setDefaultEquipmentRule:function(a){if(a&&!(a.length<1)){a instanceof Array||(a=[a]);for(var b=this,c=[{label:"资产编号",property:function(a){return a.getId()}},{label:"尺寸",property:function(a){var c=b.dataManager.getDataTypeForData(a),d=1;return c&&c.getSize()&&c.getSize().ySize&&(d=c.getSize().ySize),d}},{label:"制造商",property:"制造商"}],d=0;d<a.length;d++){var e=a[d];e&&(this.dataInfoRule[e]=c)}}},show:function(a){if(a){var b=null,c=null;a instanceof d.Data?b=a:a instanceof d.Link?c=this.sceneManager.getLinkNodeById(a):b=this.dataManager.getDataById(a),c||(c=this.sceneManager.getNodeByDataOrId(b));var e=this.getContentByNode(c),f=this.getTitleByNode(a),g=this.getOffset(c);this.propertyPane.show({items:e},f,g)}},setSceneManager:function(a){if(a){this.sceneManager=a,this.dataManager=a.dataManager;var b=this.defaultEventHandler=a.viewManager3d.getDefaultEventHandler();if(b){var c=this;b.afterLookAtFunction=function(a){var b=c.getContentByNode(a);if(b&&b.length>0){var d=c.getTitleByNode(a),e=c.getOffset(a);c.propertyPane.show({items:b},d,e)}else c.propertyPane.hide()}}var e=new d.EventHandler;e.shouldHandleDoubleClickElement=function(){return!0},e.handleDoubleClickElement=function(a,b,d,e){var f=c.getContentByNode(a);if(f&&f.length>0){var g=c.getTitleByNode(d),h=c.getOffset(a);c.propertyPane.show({items:f},g,h)}else c.propertyPane.hide()},this.sceneManager.viewManager2d.addEventHandler(e)}},setPropertyPaneSize:function(a,b){this.width=a,this.height=b},getContentByNode:function(a){if(this.getContentFunction){var b=this.getContentFunction(a);return b instanceof Array?b:[b]}var c=null;c=a instanceof twaver.Element?this.sceneManager.network2d.getView():this.sceneManager.network3d.getRootView(),c&&c.appendChild(this.propertyPane.propertyPane[0]);var e=this.sceneManager.getLinkData(a);return e&&e instanceof d.Link?(this.propertyPane.setWidthForPropertyPane("30%"),this.createDefaultLinkContent(a)):(this.width&&parseInt(this.width)&&this.propertyPane.setWidthForPropertyPane(parseInt(this.width)+"px"),this.height&&parseInt(this.height)&&this.propertyPane.setHeightForPropertyPane(parseInt(this.height)+"px"),this.createDefaultDataContent(a))},getTitleByNode:function(a){var b="";return a?(a instanceof d.Data?b=":"+a.getId():this.sceneManager&&this.sceneManager.getNodeData(a)&&(b=":"+this.sceneManager.getNodeData(a).getId()),"资产编号"+b):""},getOffset:function(a){return{left:100,top:100}},createDefaultDataContent:function(a){var b=this.getGeneralInfo(a),c=this.getDevListInfo(a),d=this.getStatInfo(a),e=this.getOthers(a),f=[];if(b&&f.push(b),c&&f.push(c),d&&f.push(d),e)if(e instanceof Array)for(var g=0;g<e.length;g++)f.push(e[g]);else f.push(e);return f},createDefaultLinkContent:function(a){var b=null;if(b=a instanceof d.Link?a:a instanceof mono.Element?this.sceneManager.getLinkData(a):this.dataManager.getLinkById(a),!b)return null;var c=b.getFromId(),e=b.getToId(),f=this.dataManager.getDataTypeForData(c),g=this.dataManager.getDataTypeForData(e),h=f?f.getDescription():"",i=g?g.getDescription():"",j={};j.线袋编号=b.getName(),j.线袋类型=b.getType(),j.A=c||"",j.B=e||"",j.连接设备1="设备编号:"+(c||"")+"  设备类型:"+h+" 端口编号:",j.连接设备2="设备编号:"+(e||"")+"  设备类型:"+i+" 端口编号:";var k={title:"线袋信息",properties:j,className:"it-property-basic",onclick:function(a){}},l={title:"标签",properties:null,className:"it-property-equip"};return[k,l]},getGeneralInfo:function(a){if(!a)return null;var b=a.getClient(d.SceneManager.CLIENT_IT_DATA);if(!b)return null;var c={};if(this.nodeInfoFunction&&this.nodeInfoFunction(a))c=this.nodeInfoFunction(a);else{var e=this.dataManager.getDataTypeForData(b);if(!e||!e.getCategoryId())return null;var f=this.dataInfoRule[e.getCategoryId()];if(!f||f.length<1)return null;for(var g=0;g<f.length;g++){var h=f[g];if(h){var i=h.label,j="";h.property&&(j="function"==typeof h.property?h.property(b):b.getUserData(h.property)),c[i]=j||""}}}var k={title:"基本",properties:c,className:"it-property-basic",onclick:function(a){}};return k},getDevListInfo:function(a){if(!a||!this.dataManager)return null;var b=a.getClient(d.SceneManager.CLIENT_IT_DATA);if(!b)return null;var c=b.getChildren(),e=[],f=this.dataManager.getDataTypeForData(b);if(!f||!f.getCategoryId())return null;var g=this.devTableRule[f.getCategoryId()];if(!g)return null;if(e.title=this.createTableHeaderByRuleInfo(g),c&&c.size()>0){var h=this;c.forEach(function(a){if(a){var b=h.createTableRowByRuleInfo(g,a),c={values:b,callback:function(){if(h.devClickFunction)return h.devClickFunction(a);if(h.defaultEventHandler&&h.sceneManager){var b=h.sceneManager.dataNodeMap[a.getId()];b&&h.defaultEventHandler.lookAt(b)}},mousemove:function(){h.mouseoverDevFunction&&h.mouseoverDevFunction(a)}};e.push(c)}})}if(this.devListSortFunction){var h=this;e.sort(function(a,b){return h.devListSortFunction(a,b)})}var i={title:"设备列表",properties:e,className:"it-property-equip"};return i},createTableHeaderByRuleInfo:function(a){var b=[];if(a&&a instanceof Array)for(var c=0;c<a.length;c++){var d=a[c];if(d){var e={};d.width&&(e.c_width=d.width),d.header&&(e.text=d.header),b.push(e)}}return b},createTableRowByRuleInfo:function(a,b){if(!b)return null;var c=[];if(a&&a instanceof Array)for(var d=0;d<a.length;d++){var e=a[d];if(e){var f={};e.width&&(f.c_width=e.width),e.property&&"function"==typeof e.property&&(f.text=e.property(b)),c.push(f)}}return c},getStatInfo:function(a){if(!a)return null;var b=a.getClient(d.SceneManager.CLIENT_IT_DATA);if(!b)return null;var c=this.dataManager.getDataTypeForData(b);if(!c||!c.getCategoryId())return null;var e=this.statInfoRule[c.getCategoryId()],f=null;if(e&&e.value&&(f="function"==typeof e.value?e.value(b):e.value),f){var g={title:"统计",
properties:f,isGrop:!1,className:"it-property-chart"};return g}},getOthers:function(a){if(!a)return null;var b=a.getClient(d.SceneManager.CLIENT_IT_DATA);if(!b)return null;var c=this.dataManager.getDataTypeForData(b);if(!c||!c.getCategoryId())return null;var e=this.otherInfoRule[c.getCategoryId()];return e}});var I=function(a){a=a||{},this.xSize=a.x,this.ySize=a.y,this.zSize=a.z,this.xPadding=a.xPadding||[0,0],this.yPadding=a.yPadding||[0,0],this.zPadding=a.zPadding||[0,0],this.xGap=0,this.yGap=0,this.zGap=0};mono.extend(I,Object,{__accessor:["xSize","ySize","zSize","xPadding","yPadding","zPadding"],parse:function(){}}),d.Size=I;var J=function(a){this.parse(a)};d.Location=J;var K=d.Location.Align={};K.pos_neg=-1,K.center_neg=-2,K.neg_neg=-3,K.center=-4,K.pos_pos=-5,K.center_pos=-6,K.neg_pos=-7,mono.extend(J,Object,{set:function(a,b){var c=b;"string"==typeof b&&(c=d.Location.Align[b],c||(c=b)),this[a]=c},setX:function(a){this.set("x",a)},setY:function(a){this.set("y",a)},setZ:function(a){this.set("z",a)},getX:function(){return this.x},getY:function(){return this.y},getZ:function(){return this.z},parse:function(a){if(a){if(!d.defaultLocatonParser)throw"it.defaultLocatonParser is null";var b=d.defaultLocatonParser.parse(a);if(!(null!=b&&b instanceof d.Location))throw"it.defaultLocatonParser.parse() does not return a it.Location";this.location=b,this.x=b.x,this.y=b.y,this.z=b.z}}}),J.getAlignName=function(a){for(var b in K)if(K[b]===a)return b},d.LocationParser=function(){},mono.extend(d.LocationParser,Object,{parse:function(a){return null}}),d.DefaultLocatonParser=function(){d.LocationParser.call(this)},mono.extend(d.DefaultLocatonParser,d.LocationParser,{parse:function(a){var c=new d.Location;return a instanceof d.Location?(c.x=a.x,c.y=a.y,c.z=a.z):a.x!==b||a.y!==b||a.z!==b?(c.setX(a.x),c.setY(a.y),c.setZ(a.z)):"string"==typeof a&&(c=this.parseText(a)),c},parseText:function(a){var a=JSON.parse(a);if(!a)return null;if(a.x!==b||a.y!==b||a.z!==b){var c=new d.Location;return c.setX(a.x),c.setY(a.y),c.setZ(a.z),c}return null},charToNum:function(a){return a&&a.toUpperCase&&a.length?(a=a.toUpperCase(),a.chartCodeAt(0)-96):void 0}}),d.defaultLocatonParser=new d.DefaultLocatonParser;var L=function(a){this.sceneManager=a,this.dataManager=a.dataManager,this._positionFunctionMap={},this._rotationFunctionMap={}};mono.extend(L,Object,{registerPositionFunction:function(a,b,c){var d=b+"&"+a;this._positionFunctionMap[d]=c},registerRotationFunction:function(a,b,c){var d=b+"&"+a;this._rotationFunctionMap[d]=c},computePosition:function(a,b,c,e){var f=this.dataManager,g=f.getCategoryForData(a),h=f.getCategoryForData(b),i=g?g.getId():"",j=h?h.getId():"",k=this._positionFunctionMap,l=k[j+"&"+i];if(l){var m=l(a,b,c,e);if(m!==!1)return}if(!b)return void c.p(a.getPosition());var n=a.getLocation();if(!n)return void c.p(a.getPosition());if(c instanceof mono.Billboard)return void c.p(a.getPosition());if(e){var o=f.getDataTypeForData(a),p=f.getDataTypeForData(b),q=this.dataManager.getCategoryForDataType(p),r=o.getSize(),s=p.getChildrenSize()||new d.Size,t=c.getBoundingBox(),u=e.getBoundingBox(),v=o.getPositionExp()||{},w=n.getX(),x=n.getY(),y=n.getZ(),z={x:w,y:x,z:y,dataType:o,parentDataType:p,parentCategory:q,data:a,parentData:b,bb:t,pbb:u};if(v.x){var A=new Function("x","y","z","data","return "+v.x);w=A.call(this,w,x,y,z)||w}if(v.z){var A=new Function("x","y","z","data","return "+v.z);y=A.call(this,w,x,y,z)||y}if(v.y){var A=new Function("x","y","z","data","return "+v.y);x=A.call(this,w,x,y,z)||x}var B=this._computeOneAxisPosition("x",w,r.getXSize(),s.getXSize(),s.getXPadding(),t,u)||a.getPosition().x,C=this._computeOneAxisPosition("z",y,r.getZSize(),s.getZSize(),s.getZPadding(),t,u)||a.getPosition().z,D=n.getY(),E=null;this._isAlignment(D)&&(E=this._findFloor(e),u=E.getBoundingBox());var F=this._computeOneAxisPosition("y",x,r.getYSize(),s.getYSize(),s.getYPadding(),t,u)||a.getPosition().y,G=new mono.Vec3(B,F,C);c.p(G)}},_findFloor:function(a){return a},_computeOneAxisPosition:function(a,b,c,d,e,f,g){if(b=parseInt(b),Number.isNaN(b))return null;if(d&&!this._isAlignment(b)){e=e||[0,0];var h=g.max[a]-g.min[a]-e[0]-e[1],i=h/d;return g.min[a]-f.min[a]+i*(b-1)+e[0]}return this._isAlignment(b)?this._getAlignPosition(f,g,b,e,a):void 0},_isAlignment:function(a){return!!d.Location.getAlignName(a)},_getAlignPosition:function(a,b,c,d,e){return c===K.pos_neg?b.min[e]-a.max[e]+d[0]:c===K.center_neg?b.min[e]:c===K.neg_neg?b.min[e]-a.min[e]+d[0]:c===K.center?b.center()[e]:c===K.pos_pos?b.max[e]-a.max[e]-d[1]:c===K.center_pos?b.max[e]:c===K.neg_pos?b.max[e]-a.min[e]-d[1]:void 0},isNull:function(a){return a==b?!0:"string"==typeof a&&""==a.trim()?!0:!1},translateRotation:function(a){if(!a)return a;var b=new mono.Vec3;return a.x?b.setX(Math.PI*a.x/180):b.setX(a.x),a.y?b.setY(Math.PI*a.y/180):b.setY(a.y),a.z?b.setZ(Math.PI*a.z/180):b.setZ(a.z),b},computeRotation:function(a,b,c,d){var e=this.dataManager,f=a.getLocation(),g=e.getDataTypeForData(a),h=g.getRotationExp(),i=this.translateRotation(a.getRotation());if(!(!i||this.isNull(i.x)&&this.isNull(i.y)&&this.isNull(i.z)))return void c.setRotation(i);if(f&&h){var j=f.getX(),k=f.getY(),l=f.getZ(),m={x:j,y:k,z:l,data:a,dataType:g,parentData:b,location:f},n=a.getPosition(),o=(n.x,n.y,n.z,0),p=0,q=0;if(h.x){var r=new Function("x","y","z","data","return "+h.x);o=r.call(this,j,k,l,m)||0}if(h.y){var r=new Function("x","y","z","data","return "+h.y);p=r.call(this,j,k,l,m)||0}if(h.z){var r=new Function("x","y","z","data","return "+h.z);q=r.call(this,j,k,l,m)||0}c.setRotation(o,p,q)}}}),d.LocationManager=L,d.Space1=function(a,b){this._spaceArray=a||[],this._axis=b,this.init(),this.compute()},mono.extend(d.Space1,Object,{setSpaceArray:function(a){this._spaceArray=a,this.init(),this.compute()},getSpaceArray:function(){return this._spaceArray},getTotal:function(){return this._total},getPercent:function(){return this._percent},getOccupation:function(){return this._occupation},getOccupationList:function(){return this._occupationList},getEmptyList:function(){return this._emptyList},getAxis:function(){return this._axis},isAvailableAt:function(a,b){if(1>a&&a>this._total)return!1;b=b||1;var c=a,d=a+b-1;if(d>this._total)return!1;for(var e,f=0,g=this._occupationList.length;g>f;f++)if(e=this._occupationList[f],c>=e.start&&c<=e.end||d>=e.start&&d<=e.end)return!1;return!0},isValid:function(){return this._total>0},_addStatistic:function(a,b,c){(1===a||0===a)&&(b.end=c,b.occupation?this._occupationList.push(b):this._emptyList.push(b),b.total=b.end-b.start+1,delete b.occupation)},getCountForSize:function(a){for(var b=0,c=0;c<this._emptyList.length;c++){var d=this._emptyList[c];b+=parseInt(d.total/a)}return b},init:function(){this._total=0,this._percent=0,this._occupation=0,this._occupationList=[],this._emptyList=[]},compute:function(){var a,b=this._spaceArray,c=b.length,d=null;this._total=c;for(var e=0;c>e;e++){var f=b[e];1==f&&this._occupation++,(0==e||d!=f)&&(this._addStatistic(d,a,e),a={start:e+1,occupation:f}),d=f,e==c-1&&this._addStatistic(d,a,e+1)}this._total>0&&(this._percent=this._occupation/this._total)}}),d.Space2=function(a,b,c){this._spaceArray=a||[[]],this._axis=b,this._mainAxis=c,this.init(),this.compute()},mono.extend(d.Space2,Object,{setSpaceArray:function(a){this._spaceArray=a,this.init(),this.compute()},getSpaceArray:function(){return this._spaceArray},getAxis:function(){return this._axis},getMainAxis:function(){return this._mainAxis},init:function(){this._total=0,this._percent=0,this._occupation=0},compute:function(){for(var a,b=0,c=this._spaceArray.length;c>b;b++)a=this._spaceArray[b],this._total+=a.getTotal(),this._occupation+=a.getOccupation();this._total>0&&(this._percent=this._occupation/this._total)},getCountForSize:function(a){for(var b,c=0,d=this._spaceArray.length,e=0;d>c;c++)b=this._spaceArray[c],e+=b.getCountForSize(a);return e}});var M=function(a,b){this.dataManager=a,this.sceneManager=b,this.nodeMap={},this.spaceNodeColorFunction=null,this.spaceNodeFrameColorFunction=null,this.spaceVisibleFilter=new d.SpaceVisibleFilter(b,this),this.spaceMaterialFilter=new d.SpaceMaterialFilter(b,this)};mono.extend(M,Object,{_initArray:function(a,b){b=b||0;for(var c=[],d=0;a>d;d++)c.push(b);return c},_initArray2:function(a,b,c){c=c||0;for(var d=[],e=0;a>e;e++){for(var f=[],g=0;b>g;g++)f.push(0);d.push(f)}return d},initSpaceArray:function(a,b,c){},computeSpace:function(a,b){var c,e=this.dataManager,f=e.getDataTypeForData(a),g=f.getChildrenSize(),h=a.getChildren(),i=g.getXSize(),j=g.getYSize(),k=g.getZSize(),l=0,m=[],n="",o="";if(i&&(l++,m.push({axis:"x",size:i}),n+="x",n!==b&&(o="x")),j&&(l++,m.push({axis:"y",size:j}),n+="y",n!==b&&(o=n)),k&&(l++,n+="z",m.push({axis:"z",size:k}),n!==b&&(o="z")),l>2)return void console.error("Only support 1 or 2 dimension");if(2==l&&!b)return void console.error("Main Axis is needed for 2 dimension");var p=null;if(1==l){p=this._initArray(m[0].size);for(var q=0;q<h.size();q++){var c=h.get(q),r=e.getDataTypeForData(c),s=r.getSize(),t=c.getLocation();this.computeOneDimesion(p,s["get"+n.toUpperCase()+"Size"](),t["get"+n.toUpperCase()]())}var u=new d.Space1(p,n);return u}if(2==l){for(var v=g["get"+o.toUpperCase()+"Size"](),w=g["get"+b.toUpperCase()+"Size"](),x=[],y=0;v>y;y++){for(var p=this._initArray(w),q=0;q<h.size();q++){var c=h.get(q),r=e.getDataTypeForData(c),s=r.getSize(),t=c.getLocation();t["get"+o.toUpperCase()]()==y+1&&this.computeOneDimesion(p,s["get"+b.toUpperCase()+"Size"](),t["get"+b.toUpperCase()]())}var z=new d.Space1(p,b);x.push(z)}var A=new d.Space2(x,n,b);return A}return null},computeOneDimesion:function(a,b,c){if(a&&b&&c>0){for(var d=0;b>d;d++)a[c-1+d]=1;return a}},getSpaceNodeColor:function(a){if(this.spaceNodeColorFunction){var b=this.spaceNodeColorFunction(a);return b}var b=null;return b="orange"},getSpaceNodeFrameColor:function(a){if(this.spaceNodeFrameColorFunction){var b=this.spaceNodeFrameColorFunction(a);return b}return this.getSpaceNodeColor(a)},showSpaceMode:function(){this.sceneManager.viewManager3d.addVisibleFilter(this.spaceVisibleFilter),this.sceneManager.viewManager3d.addMaterialFilter(this.spaceMaterialFilter)},hideSpaceMode:function(){this.sceneManager.viewManager3d.removeVisibleFilter(this.spaceVisibleFilter),this.sceneManager.viewManager3d.removeMaterialFilter(this.spaceMaterialFilter)},getModelParent:function(a){if(null==a)return null;var b=a.getClient("modelParent");return null==b?this.getModelParent(a.getParent()):b},remove1DSpaceNodeForNodes:function(a){a instanceof mono.List&&(a=a.toArray());for(var b,c,d=this.sceneManager.network3d.getDataBox(),e=0,f=0;e<a.length;e++){b=a[e];var g=b.getChildren().toArray();for(f=0;f<g.length;f++)c=g[f],(this.isSpaceNode(c)||this.isSpaceChildrenNode(c))&&(d.removeByDescendant(c),c.setParent(null))}},create1DSpaceNodeForNodes:function(a,b){b=b||1,a instanceof mono.List&&(a=a.toArray());for(var c,d,e,f,g,h=this.sceneManager.network3d.getDataBox(),i=0,j=0;i<a.length;i++){c=a[i];var k=c.getChildren().toArray();for(j=0;j<k.length;j++){var l=k[j];(this.isSpaceNode(l)||this.isSpaceChildrenNode(l))&&(h.removeByDescendant(l),l.setParent(null))}if(d=this.sceneManager.getNodeData(c)){if(e=1==b?this.create1DSpaceNode(d):this.create1DSpaceNode2(d),!e)continue;for(e.setClient("modelParent",c),e.setParent(c),h.addByDescendant(e),f=this.create1DChildrenSpaceNodes(d),j=0;j<f.length;j++)g=f[j],g.setParent(c),h.addByDescendant(g)}}},isSpaceNode:function(a){return a.getClient("spaceNode")},hasSpaceNode:function(a){if(!a)return!1;var b=a.getChildren();if(b&&b.size()>0)for(var c=0;c<b._as.length;c++){var d=b._as[c];if(this.isSpaceNode(d))return!0}return!1},hasSpaceChildrenNode:function(a){if(!a)return!1;var b=a.getChildren();if(b&&b.size()>0)for(var c=0;c<b._as.length;c++){var d=b._as[c];if(this.isSpaceChildrenNode(d))return!0}return!1},isSpaceChildrenNode:function(a){return a.getClient("spaceChildrenNode")},create1DSpaceNode:function(a,b){var c=this.computeSpace(a);if(c instanceof d.Space1){var e=this.dataManager,f=this.sceneManager,g=e.getDataTypeForData(a),h=(g.getChildrenSize(),f.getNodeForDataOrId(a));if(h){var i=c.getPercent();0==i&&(i=.01);var j=this.getSpaceNodeColor(i),k=(this.getSpaceNodeFrameColor(i)||j,h.getBoundingBox()),l=k.max.x-k.min.x,m=k.max.y-k.min.y,n=k.max.z-k.min.z,o=1;l-=4,m-=4;var p=new mono.Cube(l+o,m+o,n+o);p.setClient("spaceNode",!0),p.s({"m.wireframe":!0,"m.transparent":!0,"m.opacity":.3});var q=c.getAxis();"x"===q&&(l*=i),"y"===q&&(m*=i),"z"===q&&(n*=i);var r=new mono.Cube(l,m,n);r.setClient("spaceNode",!0),r.setParent(p);var s=r.getBoundingBox();"x"===q?r.setX(k.min.x-s.min.x):"y"===q?r.setY(k.min.y-s.min.y):r.setY(k.min.z-s.min.z);var t="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAeAB4AAD/4QBwRXhpZgAATU0AKgAAAAgABQMBAAUAAAABAAAASgMCAAIAAAAWAAAAUlEQAAEAAAABAQAAAFERAAQAAAABAAASdFESAAQAAAABAAASdAAAAAAAAYagAACxjlBob3Rvc2hvcCBJQ0MgcHJvZmlsZQD/4gxYSUNDX1BST0ZJTEUAAQEAAAxITGlubwIQAABtbnRyUkdCIFhZWiAHzgACAAkABgAxAABhY3NwTVNGVAAAAABJRUMgc1JHQgAAAAAAAAAAAAAAAAAA9tYAAQAAAADTLUhQICAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABFjcHJ0AAABUAAAADNkZXNjAAABhAAAAGx3dHB0AAAB8AAAABRia3B0AAACBAAAABRyWFlaAAACGAAAABRnWFlaAAACLAAAABRiWFlaAAACQAAAABRkbW5kAAACVAAAAHBkbWRkAAACxAAAAIh2dWVkAAADTAAAAIZ2aWV3AAAD1AAAACRsdW1pAAAD+AAAABRtZWFzAAAEDAAAACR0ZWNoAAAEMAAAAAxyVFJDAAAEPAAACAxnVFJDAAAEPAAACAxiVFJDAAAEPAAACAx0ZXh0AAAAAENvcHlyaWdodCAoYykgMTk5OCBIZXdsZXR0LVBhY2thcmQgQ29tcGFueQAAZGVzYwAAAAAAAAASc1JHQiBJRUM2MTk2Ni0yLjEAAAAAAAAAAAAAABJzUkdCIElFQzYxOTY2LTIuMQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWFlaIAAAAAAAAPNRAAEAAAABFsxYWVogAAAAAAAAAAAAAAAAAAAAAFhZWiAAAAAAAABvogAAOPUAAAOQWFlaIAAAAAAAAGKZAAC3hQAAGNpYWVogAAAAAAAAJKAAAA+EAAC2z2Rlc2MAAAAAAAAAFklFQyBodHRwOi8vd3d3LmllYy5jaAAAAAAAAAAAAAAAFklFQyBodHRwOi8vd3d3LmllYy5jaAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABkZXNjAAAAAAAAAC5JRUMgNjE5NjYtMi4xIERlZmF1bHQgUkdCIGNvbG91ciBzcGFjZSAtIHNSR0IAAAAAAAAAAAAAAC5JRUMgNjE5NjYtMi4xIERlZmF1bHQgUkdCIGNvbG91ciBzcGFjZSAtIHNSR0IAAAAAAAAAAAAAAAAAAAAAAAAAAAAAZGVzYwAAAAAAAAAsUmVmZXJlbmNlIFZpZXdpbmcgQ29uZGl0aW9uIGluIElFQzYxOTY2LTIuMQAAAAAAAAAAAAAALFJlZmVyZW5jZSBWaWV3aW5nIENvbmRpdGlvbiBpbiBJRUM2MTk2Ni0yLjEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHZpZXcAAAAAABOk/gAUXy4AEM8UAAPtzAAEEwsAA1yeAAAAAVhZWiAAAAAAAEwJVgBQAAAAVx/nbWVhcwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAo8AAAACc2lnIAAAAABDUlQgY3VydgAAAAAAAAQAAAAABQAKAA8AFAAZAB4AIwAoAC0AMgA3ADsAQABFAEoATwBUAFkAXgBjAGgAbQByAHcAfACBAIYAiwCQAJUAmgCfAKQAqQCuALIAtwC8AMEAxgDLANAA1QDbAOAA5QDrAPAA9gD7AQEBBwENARMBGQEfASUBKwEyATgBPgFFAUwBUgFZAWABZwFuAXUBfAGDAYsBkgGaAaEBqQGxAbkBwQHJAdEB2QHhAekB8gH6AgMCDAIUAh0CJgIvAjgCQQJLAlQCXQJnAnECegKEAo4CmAKiAqwCtgLBAssC1QLgAusC9QMAAwsDFgMhAy0DOANDA08DWgNmA3IDfgOKA5YDogOuA7oDxwPTA+AD7AP5BAYEEwQgBC0EOwRIBFUEYwRxBH4EjASaBKgEtgTEBNME4QTwBP4FDQUcBSsFOgVJBVgFZwV3BYYFlgWmBbUFxQXVBeUF9gYGBhYGJwY3BkgGWQZqBnsGjAadBq8GwAbRBuMG9QcHBxkHKwc9B08HYQd0B4YHmQesB78H0gflB/gICwgfCDIIRghaCG4IggiWCKoIvgjSCOcI+wkQCSUJOglPCWQJeQmPCaQJugnPCeUJ+woRCicKPQpUCmoKgQqYCq4KxQrcCvMLCwsiCzkLUQtpC4ALmAuwC8gL4Qv5DBIMKgxDDFwMdQyODKcMwAzZDPMNDQ0mDUANWg10DY4NqQ3DDd4N+A4TDi4OSQ5kDn8Omw62DtIO7g8JDyUPQQ9eD3oPlg+zD88P7BAJECYQQxBhEH4QmxC5ENcQ9RETETERTxFtEYwRqhHJEegSBxImEkUSZBKEEqMSwxLjEwMTIxNDE2MTgxOkE8UT5RQGFCcUSRRqFIsUrRTOFPAVEhU0FVYVeBWbFb0V4BYDFiYWSRZsFo8WshbWFvoXHRdBF2UXiReuF9IX9xgbGEAYZRiKGK8Y1Rj6GSAZRRlrGZEZtxndGgQaKhpRGncanhrFGuwbFBs7G2MbihuyG9ocAhwqHFIcexyjHMwc9R0eHUcdcB2ZHcMd7B4WHkAeah6UHr4e6R8THz4faR+UH78f6iAVIEEgbCCYIMQg8CEcIUghdSGhIc4h+yInIlUigiKvIt0jCiM4I2YjlCPCI/AkHyRNJHwkqyTaJQklOCVoJZclxyX3JicmVyaHJrcm6CcYJ0kneierJ9woDSg/KHEooijUKQYpOClrKZ0p0CoCKjUqaCqbKs8rAis2K2krnSvRLAUsOSxuLKIs1y0MLUEtdi2rLeEuFi5MLoIuty7uLyQvWi+RL8cv/jA1MGwwpDDbMRIxSjGCMbox8jIqMmMymzLUMw0zRjN/M7gz8TQrNGU0njTYNRM1TTWHNcI1/TY3NnI2rjbpNyQ3YDecN9c4FDhQOIw4yDkFOUI5fzm8Ofk6Njp0OrI67zstO2s7qjvoPCc8ZTykPOM9Ij1hPaE94D4gPmA+oD7gPyE/YT+iP+JAI0BkQKZA50EpQWpBrEHuQjBCckK1QvdDOkN9Q8BEA0RHRIpEzkUSRVVFmkXeRiJGZ0arRvBHNUd7R8BIBUhLSJFI10kdSWNJqUnwSjdKfUrESwxLU0uaS+JMKkxyTLpNAk1KTZNN3E4lTm5Ot08AT0lPk0/dUCdQcVC7UQZRUFGbUeZSMVJ8UsdTE1NfU6pT9lRCVI9U21UoVXVVwlYPVlxWqVb3V0RXklfgWC9YfVjLWRpZaVm4WgdaVlqmWvVbRVuVW+VcNVyGXNZdJ114XcleGl5sXr1fD19hX7NgBWBXYKpg/GFPYaJh9WJJYpxi8GNDY5dj62RAZJRk6WU9ZZJl52Y9ZpJm6Gc9Z5Nn6Wg/aJZo7GlDaZpp8WpIap9q92tPa6dr/2xXbK9tCG1gbbluEm5rbsRvHm94b9FwK3CGcOBxOnGVcfByS3KmcwFzXXO4dBR0cHTMdSh1hXXhdj52m3b4d1Z3s3gReG54zHkqeYl553pGeqV7BHtje8J8IXyBfOF9QX2hfgF+Yn7CfyN/hH/lgEeAqIEKgWuBzYIwgpKC9INXg7qEHYSAhOOFR4Wrhg6GcobXhzuHn4gEiGmIzokziZmJ/opkisqLMIuWi/yMY4zKjTGNmI3/jmaOzo82j56QBpBukNaRP5GokhGSepLjk02TtpQglIqU9JVflcmWNJaflwqXdZfgmEyYuJkkmZCZ/JpomtWbQpuvnByciZz3nWSd0p5Anq6fHZ+Ln/qgaaDYoUehtqImopajBqN2o+akVqTHpTilqaYapoum/adup+CoUqjEqTepqaocqo+rAqt1q+msXKzQrUStuK4trqGvFq+LsACwdbDqsWCx1rJLssKzOLOutCW0nLUTtYq2AbZ5tvC3aLfguFm40blKucK6O7q1uy67p7whvJu9Fb2Pvgq+hL7/v3q/9cBwwOzBZ8Hjwl/C28NYw9TEUcTOxUvFyMZGxsPHQce/yD3IvMk6ybnKOMq3yzbLtsw1zLXNNc21zjbOts83z7jQOdC60TzRvtI/0sHTRNPG1EnUy9VO1dHWVdbY11zX4Nhk2OjZbNnx2nba+9uA3AXcit0Q3ZbeHN6i3ynfr+A24L3hROHM4lPi2+Nj4+vkc+T85YTmDeaW5x/nqegy6LzpRunQ6lvq5etw6/vshu0R7ZzuKO6070DvzPBY8OXxcvH/8ozzGfOn9DT0wvVQ9d72bfb794r4Gfio+Tj5x/pX+uf7d/wH/Jj9Kf26/kv+3P9t////2wBDAAIBAQIBAQICAgICAgICAwUDAwMDAwYEBAMFBwYHBwcGBwcICQsJCAgKCAcHCg0KCgsMDAwMBwkODw0MDgsMDAz/2wBDAQICAgMDAwYDAwYMCAcIDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAz/wAARCAEAAQADASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD93KKCwWmmZRQA6iozOfSmmRj3oAmzTTIo71DmigCYzKPWm+f7VHRQA/z29qTzW9abRQAE7jRRRQAUUUUAFFFFABRRRQAUUUUAFAO00UUAO81vWl89vamUUASef7U4TKfWoaKAJhIp707NV6M0AWKKhEjDvThOfSgCSimiZTTgwagCvRRRQAUUUUAFFFFABRRmjdQAUUm8Um+gB1FN8yjfQA6im76TcaAH0UzcaNxoAfRTNxo3GgB9FM3Gl30AOopu+jzKAHUU3fS7xQAtFG6jNABRRRQAUUUUAFFFFABRmmFiaTNAD9wpPMptFADt5pu40UUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABuNO3mm0UAO8yl3CmUUASZoqPNKGIoAZvo31Fu5pS9AEm+jfURalD4oAk30b6jLZpN9AEu+jfUW+lL0ASeZRvqPdSbqAJN5o3Go99G6gB+6jdTA/FAagB+c0UzfmlD80AOozimb6UvmgB26jdTQ9JuoAk3Gjeaj3Ypd1AEnmUeZUQbIo3YoAl30b6i3UobFAEnmUb6i3c0Bs0AS76N9R7qN1AEnmUb6iDUu/NAEIegPUXmUB+KAJd3FAeovMxRvoAl35oL1F5nNG7mgCUvRvxUW/mk30ATb6N9Q76UPxQBLvyaN1Rb6C/NAEu+jfUW/IpN9AEwejfmot3FHmUATb+aTfxUW+gvxQBKXzS781CHo34oAlLUb+Kj38UhegCXdml31EGpN/FAEu/FG6o99JvoAlD8UbsCofMp2/igCTfRuqLfRvoAl30b6i30u+gCDzKXfVcyUeZQBN5lG+ofMoMlAE4kyaQyVD5lAegCffRvqDzKBJQBPvpN9Qh80GSgCfzKPMqASUb6AJ9+KPMqDzOKPM4oAnEmaPMqDzKPMoAn30B6gElHmUAT76C+f51B5lHm0ATeZmlElQeZmjzM0ATeZRv5qHzKPM5oAm30u+oPMoElAE2+l34qDzKPM5oAn8yk8zFQmSjzKAJ99IXqHzOaPMoAg83mkElVxJzR5vNAFjzOaPM4qDzOKPNzQBOZKPMqAS0nm0AWPMo8yq+/NBk4oAseZR5uagMlJ5tAFgyUeZioPMpBLQBYEnFKJareZS+ZmgCcyYo8yoPN4pDJQBY82jzKr+bS+ZQBYEtJ5lVxJS+bzQBP5nFHm8VB5maPM5oAnEnFL5nFV/Mo8ygCcSZoElQebR5lAE/mUeZk1B5tBlzQBPvzS+ZVcS0nmUAWN9L5mKr+ZR5uDQBW83ijzar+bigzUAWPNoMuKr+bR5tAFkS5pPNqv5uKPNoAsebR5tV/N4o82gCx5nFL5uKrebR5tAFjzMUebVcy0eZQBZ82k86q/mUebQBY83ijzear+bR5uTQBY82l83Aqt5vNHm5oAsCSjzeKr+ZxR5uaALHmUebxVfzcCgS8UAWPNo8yq/m0GWgCwJaPNzVcyUeZQBY83NL53FVhLR52KALHm8UebVfzeKPNoAsebmgTVX83NHm8UAVhJR5uarebR5tAFgS0vnZqt5uaPOoAs+bR5tVvNo83igCz5tAkqt5tHnUAWvNpBLVbzaPNoAtebim+bVfzcUebQBZ8yjzKredmjzPegCz5vvR5vFVvNo83FAFnzaUS1V82jzeaALPm5o82q3mcUCWgCyZeaPNqt53NHm0AWfNpPNqv5tHnUAWfNzS+bVXzaPNzQBZ82jzMVWMtHm80AWfNo86q3m0ebzQBZEtHm81W83FHnUAVvNzSebkVX8yk86gCz5uKUS+9VjNzQZqALHnUebxVczUebQBY82jzqr+dzR5vvQBZ82k87iq5lxR5vFAFjzuaXzcGq3m0CXBoAsCWjzaredS+bQBY87FL5vFVfNo82gCz51AlzVcSUeZQBZM1Hnc1WE1Hm5FAFnzcUnm81XE1J5tAFnzcUCXiq/m0edQBY86gS81X83igzUAWPMo82q/nUedQBZ82k86q5loEtAFgSUebgVXEuaPNxQBV83mgy1WE1J5tAFrzeKPOxVYS0ebQBZ83mjzeKredg0nm0AWvNo82qolpfNxQBZ86jzearebzSeZigC15uaPOyareZkUnm0AWhNR5tVjLxR5tAFnzaBNmqvm0vm470AWfOzR5tVvNpPOoAtGajzc1V83NL52BQBZ83ijzearebR5nNAFnzuaBNVXzqXzaALPm80edVbzKPNoAs+bR5tVvNxR5uKALPn0edVYS0CagCyJqPNqsZfek86gCv5vFHm8VWMvNHm4oAs+dQJarebR5uKALJlzQJar+ZSCWgCz5tAkqr5tL5tAFnzeaPMqt5tBloAsiXijzarGXA60vm4oAsCWjzOKrCXmgS4FAFnzKPNwaqmWl8ygCz5tHmVW83NHnUAWfNzR5vNVfO5pfN4oAs+bijzs1WEmaPM4oAs+bR5vFVvNxR5vFAFkS8UCX3qt5tBloAs+bQJarGXigTUAWfNzR5uDVYy0ebQBZ8zmjzarCX3o82gCt5lHmVXMuDR5lAFjzeKPNqv5maBLQBY8zIo82q/m0ebigCx5maPN5qv5tHm0AWPNxR5vFVxLijzcUAWPN4o82q/m0eZzQBY83ijzariSjzeaALHmUCSq4koMtAFgSUGbmq/mc0eZzQBY8yjzMiq/m5o83mgCwJcUebVcS4NHmUAWPNo8zmq/mUeZmgCx5tBkqv5tHmZoAsebQJear+ZQZaALHmYFHm1XEnNHmUAWBLxR5tV/MoEvFAFcS0eZUHmYo8zNAE/mUeZUPmUhkxQBOZeaPMqDzOaDLzQBP5tBkwKh8zFJvoAnMtHmZqDzc0eZQBP5lAkqDfRv4oAn8zFHmc1B5lBk4oAn8ygy8VD5lJ5lAE/mYo82oPMo8ygCfzKPN4qHfigycUATeZmjzKg8yjzaAJ/Mo8zFQeZxR5lAE/mcUCSoBJR5mKAJ9+KN+Kr+bS+ZQBP5tG/NQCSjzKAJxJR5nNQeZzS76AK++gPzUIegSUATeZR5mah8zj8KPMoAm8zmjzKh34o380ATb6N9Ql+aPM+agCbfijzKh34NBegCYPzQXqESUbuaAJ/MxSB6h8ygPQBMHo8yoQ9G6gCYPRvqHfzR5maAJjJR5lQ+ZR5lAE3mUGTmoQ9Hmc0ATGSjfmod/ejfg0ATb6BJUJegvigCbzOaN/NQ+ZzRvxQBN5nNG/AqLfmk30ATeZmjfzUO/FHmZNAEJejfg1Hu5o3YoAk38Uu6og1LuoAkL8Ubqi3Yo38UASl8GgPiot2KA1AEm+l381Fuo30ASb8Uu/NRb8GjfQBKGyaN9RbqN9AEpekD5NRl6N9AEm/mgvxUe+gtQBJvpd/NRb8GjdQBLupN+aj380F6AJN+TS7uai3cUBqAJN9LuxUW7mjdQBKW4pN9R7uaN1AEu6gtxUW/NG+gCTdTt+ah3UFqAP/9k=",u=new mono.Color(j);return u.lerp(u,.5),r.s({"m.type":"phong","m.color":u,"m.ambient":u,"m.specularStrength":20,"left.m.lightmap.image":t,"right.m.lightmap.image":t,"back.m.lightmap.image":t,"front.m.lightmap.image":t}),p}}},removeSpaceNode:function(a){var b=this.sceneManager;b.removeNodeChildren(a,function(a){return a.getClient("spaceNode")})},create1DSpaceNode2:function(a,b){var c=this.create1DChildrenSpaceNodes2(a,b);return c},removeSpaceChildrenNode:function(a){var b=this.sceneManager;b.removeNodeChildren(a,function(a){return a.getClient("spaceChildrenNode")})},create1DChildrenSpaceNodes2:function(a,b){var c=this.computeSpace(a);if(!(!c instanceof d.Space1)){var e=this.dataManager,f=this.sceneManager,g=f.getNodeForDataOrId(a),h=e.getDataTypeForData(a),i=h.getChildrenSize();if(g){var j=c.getAxis();if(j){var k=g.getBoundingBox(),l=k.size(),m=c.getEmptyList(),n=c.getOccupationList(),o=new mono.Cube(l.x-2,l.y,l.z-2);o.setClient("spaceNode",!0),o.setParent(g);for(var p,q=[],r=0;r<m.length;r++){p=m[r];var s=this.create1DChildrenSpaceNode2(k,i,p,j,!0);s.setParent(o),q.push(s)}for(var r=0;r<n.length;r++){p=n[r];var s=this.create1DChildrenSpaceNode2(k,i,p,j,!1);s.setParent(o),q.push(s)}return o.s({"m.transparent":!0,"m.opacity":.1}),o}}}},create1DChildrenSpaceNode2:function(a,b,c,d,e){var f=c.total,g=c.start,h=(c.end,a.size()),i=h.x,j=h.y,k=h.z,l=(b.getXPadding()||[0,0],b.getYPadding()||[0,0],b.getZPadding()||[0,0],0),m=1;"x"===d?(i=f*i/b.getXSize(),i-=m,l=f/b.getXSize()):"y"===d?(j=f*j/b.getYSize(),j-=m,l=f/b.getYSize()):"z"===d&&(k=f*k/b.getZSize(),k-=m,l=f/b.getZSize());var n=new mono.Cube(i-2,j-2,k-2),o=n.getBoundingBox(),p=0,q=0,r=0;"x"===d?p=a.min.x-o.min.x+h.x/b.getXSize()*(g-1)+m/2:"y"===d?q=a.min.y-o.min.y+h.y/b.getYSize()*(g-1)+m/2:"z"===d&&(r=a.min.z-o.min.z+h.z/b.getZSize()+m/2),n.p(p,q,r);var s=emtpy?this.getSpaceNodeColor(l):"#A4A4A4";return n.s({"m.type":"phong","m.specularStrength":50,"m.color":s,"m.ambient":s}),e&&n.s({"m.transparent":!0,"m.opacity":.6}),n.setClient("spaceNode",!0),n},create1DChildrenSpaceNodes:function(a,b){var c=this.computeSpace(a);if(c instanceof d.Space1){var e=this.dataManager,f=this.sceneManager,g=e.getDataTypeForData(a),h=g.getChildrenSize(),i=f.getNodeForDataOrId(a);if(i){var j=c.getAxis();if(j){for(var k,l=i.getBoundingBox(),m=l.size(),n=m.x,o=m.y,p=m.z,q=c.getEmptyList(),r=[],s=0,t=c.getPercent();s<q.length;s++)k=q[s],r.push(this.createEmptyNode(k,n,o,p,j,h,l,t));return r}}}},createEmptyNode:function(a,b,c,d,e,f,g,h){var i=a.total,j=a.start,k=(a.end,f.getXPadding()||[0,0]),l=f.getYPadding()||[0,0],m=f.getZPadding()||[0,0];b-=k[0]+k[1],c-=l[0]+l[1],d-=m[0]+m[1];var n=1;"x"===e?b=i*b/f.getXSize():"y"===e?c=i*c/f.getYSize():"z"===e&&(d=i*d/f.getZSize());var o=new mono.Cube(b-n,c-n,d-n),p=o.getBoundingBox(),q=0,r=0,s=0;"x"===e?q=g.min.x-p.min.x+k[0]+b/i*(j-1)+n/2:"y"===e?r=g.min.y-p.min.y+l[0]+c/i*(j-1)+n/2:"z"===e&&(s=g.min.z-p.min.z+m[0]+d/i*(j-1)+n/2),o.p(q,r,s);var t=this.getSpaceNodeColor(h);return o.setClient("spaceChildrenNode",!0),o.s({"m.color":t,"m.transparent":!0,"m.opacity":.2}),o}}),d.SpaceManager=M;var N=function(a,b){this.sceneManager=a,this.spaceManager=b,this.visibleMap={};var c=this;this.sceneManager.viewManager3d.addPropertyChangeListener(function(a){"focusNode"==a.property&&(c.visibleMap={})})};mono.extend(N,z,{isVisible:function(a,c,d){var e=a.getId();if(this.visibleMap[e]!=b)return this.visibleMap[e];var f=this.sceneManager,g=this.spaceManager,h=f.dataManager,i=f.viewManager3d.getFocusNode(),j=a.getClient("modelParent")||a;if(g.isSpaceNode(a)&&j==a&&(j=a.getParent().getClient("modelParent")||j),a instanceof mono.Billboard)return this.visibleMap[e]=!1,!1;if(i===a)return this.visibleMap[e]=!0,!0;if(g.isSpaceNode(a))return i==j?(this.visibleMap[e]=!1,!1):(this.visibleMap[e]=!0,!0);if(g.isSpaceChildrenNode(a))return i==a.getParent()?(this.visibleMap[e]=!0,!0):(this.visibleMap[e]=!1,!1);if((a===j||f.getMainNode(a)===j)&&g.hasSpaceNode(j))return i==j?(this.visibleMap[e]=!0,!0):(this.visibleMap[e]=!1,!1);if(c){var k=f.getParentNode(c),l=h.getParent(c);if(k&&l){var m=this.isVisible(k,l,d);if(!m)return this.visibleMap[e]=!1,!1}}return this.visibleMap[e]=!0,!0}}),d.SpaceVisibleFilter=N;var O=function(a,b){this.sceneManager=a,this.spaceManager=b,this.materialMap={}};mono.extend(O,y,{filterMaterial:function(a,b,c){var d=this.sceneManager,e=d.viewManager3d,f=this.spaceManager,g=e.getFocusNode();this.materialMap;if(d.getNodeData(c))return b;if(f.isSpaceNode(c)&&g){if(c.isDescendantOf(g))return b;var h=a.getUniqueCode(),i=this.materialMap[h];return i||(i=a.clone(),this.materialMap[h]=i,i.transparent=!0,i.opacity=.05),i}}}),d.SpaceMaterialFilter=O;var P=function(a){var a=a||{};this.sceneManager=a.sceneManager,this.box3D=this.sceneManager.network3d.getDataBox(),this.defaultMaterialFilter=this.sceneManager.viewManager3d.getDefaultVirtualMaterialFilter(),this.defaultEventHandler=this.sceneManager.viewManager3d.getDefaultEventHandler(),this._flagLink=null,this.animates={},this.linkBillboard={},this.init()};mono.extend(P,s,{init:function(){this.sceneManager.viewManager3d.addEventHandler(this);var a=this;setInterval(function(){var b=a.linkBillboard;if(b)for(var c in b){var e=a.sceneManager.dataManager.getLinkById(c);if(e){var f=b[c],g="#5B8505",h=e._userDataMap.flow||0;f.setStyle("m.texture.image",d.Util.getSpecialTextBillboard(h.toFixed(2),"流量:","M/s",g))}}},1e4)},clearAllLink:function(){for(var a in this.sceneManager.linkMap)this.clearLinkById(a)},clearLinkById:function(a,b){var c=a;a instanceof d.Link&&(c=a.getId());var e=this.sceneManager,f=e.dataManager.getLinkById(c);if(f){var g=e.linkMap[c];if(g){if(this.animates&&this.animates[c]&&(this.animates[c].stop(),delete this.animates[c]),g&&g.isVisible()&&this.box3D.getDataById(g.getId())){var h=f.getFromId(),i=f.getToId(),j=e.dataManager.getDataById(h),k=e.dataManager.getDataById(i);if(j&&k){var l=e.getSceneAndRootByData(j),m=e.getSceneAndRootByData(k),n=!0;if(l&&!m?n=!1:!l&&m?n=!1:l&&m&&(l.scene!=m.scene||l.rootData!=m.rootData)&&(n=!1),!n){var o=e.getNodeByDataOrId(l.rootData),p=e.getNodeByDataOrId(m.rootData);!b||b!=j&&b!=k?(l&&l.rootData&&o!=e.getCurrentRootNode()&&this.box3D.removeByDescendant(o),m&&m.rootData&&p!=e.getCurrentRootNode()&&this.box3D.removeByDescendant(p)):b==j?(this.box3D.removeByDescendant(p),(e._currentScene!=l.scene||e._currentRootNode!=o)&&(e._currentScene=l.scene,e._currentRootNode=o,e._sceneChangeDispather.fire({kind:"changeScene",data:l.scene}),this.defaultEventHandler.lookAt(e.getNodeByDataOrId(b)))):(this.box3D.removeByDescendant(o),(e._currentScene!=m.scene||e._currentRootNode!=p)&&(e._currentScene=m.scene,e._currentRootNode=p,e._sceneChangeDispather.fire({kind:"changeScene",data:m.scene}),this.defaultEventHandler.lookAt(e.getNodeByDataOrId(b))))}}}g.setVisible(!1);var q=this.linkBillboard[c];q&&q.setVisible(!1)}}},clearLinksByData:function(a,b){var c=null,e=this.sceneManager;if(c=a instanceof d.Data?a:this.sceneManager.dataManager.getDataById(a)){var f=c.getAllLinks();if(f){for(var g in f)this.clearLinkById(g);if(b){var h=this.sceneManager.getSceneAndRootByData(b),i=!0,j=e.getNodeByDataOrId(b),k=null;h&&h.rootData&&(k=e.getNodeByDataOrId(h.rootData)),h&&!e._currentScene?i=!1:!h&&e._currentScene?i=!1:(h.scene!=e._currentScene||e._currentRootNode!=k)&&(i=!1),i||(this.box3D.removeByDescendant(e._currentRootNode),this.box3D.addByDescendant(k),this.box3D.addByDescendant(j),e._currentScene=h.scene,e._currentRootNode=k,e._sceneChangeDispather.fire({kind:"changeScene",data:h.scene}),this.defaultEventHandler.lookAt(j))}}}},showLinksByData:function(a,b){var c=null;if(this.clearAllLink(),c=a instanceof d.Data?a:this.sceneManager.dataManager.getDataById(a)){var e=c.getAllLinks(),f=[];if(e){var g=[];for(var h in e){this.showLinkByLinkId(h,b,!1);var i=this.sceneManager.linkMap[h];g.push(i);var j=e[h];if(j){var k=this.sceneManager.getNodeByDataOrId(j.getFromId()),l=this.sceneManager.getNodeByDataOrId(j.getToId());f.push(k),f.push(l)}}if(1===g.length)return void this.defaultEventHandler.lookAt(g[0]);this.defaultEventHandler.lookAtElements(f)}else{var m=this.sceneManager.getNodeByDataOrId(c);m&&this.defaultEventHandler.lookAt(m)}}},showAllLinks:function(a){var b=this.sceneManager.dataManager.getLinkMap();if(b)for(var c in b)this.showLinkByLinkId(c,a,!1)},showLinkByLinkId:function(a,c,e){var f=a,g=!0;if(e!=b&&null!=e&&(g=e),g&&this.clearAllLink(),a instanceof d.Link&&(f=a.getId()),f){var h=this.sceneManager.dataManager.getLinkById(f),i=h.getFromId(),j=h.getToId(),k=this.sceneManager.dataNodeMap[i],l=this.sceneManager.dataNodeMap[j],m=null,n=this.sceneManager.linkMap[f];if(n||this.reloadLink(f)&&(n=this.sceneManager.linkMap[f],k=this.sceneManager.dataNodeMap[i],l=this.sceneManager.dataNodeMap[j]),n&&(n.getFromNode()||n.setFromNode(k),n.getToNode()||n.setToNode(l),n.setVisible(!0),this.box3D.getDataById(n.getId())||this.box3D.add(n),c&&(m=this.resetPathByLink(f))),k&&l){this.defaultMaterialFilter.removeByDescendant(k),this.defaultMaterialFilter.removeByDescendant(l),this.box3D.getDataById(k.getId())||this.box3D.addByDescendant(k),this.box3D.getDataById(l.getId())||this.box3D.addByDescendant(l);var o=this.getNodeRootNodeByNode(k),p=this.sceneManager.getNodeData(o),q=this;o&&!this.box3D.getDataById(o.getId())&&this.box3D.addByDescendant(o,function(a){var b=q.sceneManager.getNodeData(a);return b&&b==p?!0:!1});var r=this.getNodeRootNodeByNode(l),s=this.sceneManager.getNodeData(r);r&&!this.box3D.getDataById(r.getId())&&this.box3D.addByDescendant(r,function(a){var b=q.sceneManager.getNodeData(a);return b&&b==s?!0:!1})}var t=(this.createBillboard(h),this.sceneManager.dataManager.getDataTypeById(h.getDataTypeId()));t&&t.getModelParameters()&&t.getModelParameters().flow&&this.doFlow(h)}},getNodeRootNodeByNode:function(a){if(!a)return null;var b=this.sceneManager.getNodeData(a),c=this.sceneManager.getSceneAndRootByData(b);return c&&c.rootData?this.sceneManager.getNodeByDataOrId(c.rootData):null},createBillboard:function(a){if(a){var b=this.sceneManager.linkMap[a.getId()];if(b){var c,e,f,g=b.getControls();if(g&&g.length>4){var h=g[3];c=h.x,e=h.y,f=h.z}var i=this.linkBillboard[a.getId()];if(i)i.setVisible(!0),this.box3D.getDataById(i.getId())||this.box3D.add(i);else{var i=d.Util.createSpecailTextBillboard("text");i.setPosition(c,e,f);var j="#5B8505",k=a._userDataMap.flow||0;i.setStyle("m.texture.image",d.Util.getSpecialTextBillboard(k.toFixed(2),"流量:","M/s",j)),this.box3D.add(i),this.linkBillboard[a.getId()]=i}}}},reloadLink:function(a){if(!a)return!1;var b=null;if(b=a instanceof d.Link?a:this.sceneManager.dataManager.getLinkById(a),!b)return!1;var c=this.sceneManager.linkMap[b.getId()];
if(c)return!1;var e=b.getFromId(),f=b.getToId(),g=this.sceneManager.dataNodeMap[e];if(!g){if(!this.sceneManager.dataManager.getDataById(e))return!1;main.sceneManager.loadLazyData(e)}var h=this.sceneManager.dataNodeMap[f];if(!h){if(!this.sceneManager.dataManager.getDataById(f))return!1;main.sceneManager.loadLazyData(f)}return this.sceneManager.loadLink(b),!0},resetPathByLink:function(a){if(!a)return null;var b=a;a instanceof d.Link&&(b=a.getId());var c=this.sceneManager.linkMap[b];if(!c)return null;var e=this.generateContrals(c,200);return e&&c.setControls(e),e},resetPathByData:function(a){},getRelatePosition:function(a){var b=this.sceneManager.getCurrentRootNode();if(!b||!a)return null;var c=new mono.Mat4;c.setPosition(a);var d,e;d=(new mono.Mat4).getInverse(b.worldMatrix.clone()),e=(new mono.Mat4).multiplyMatrices(d,c);var f=(new mono.Vec3).getPositionFromMatrix(e);return f},generateContrals:function(a,b){if(!a)return null;var c=a.getFromNode(),d=a.getToNode();if(!c||!d)return null;var e=c.getBoundingBox(),f=d.getBoundingBox(),g=20,h=Math.max(e.max.y,f.max.y)+20,i=c.frontWorldPosition(e.max.z+g),j=d.frontWorldPosition(f.max.z+g),k=c.getWorldPosition(),l=d.getWorldPosition(),m=[];m.push(i);var n=i.clone().add(new mono.Vec3(0,h,0));m.push(n),n=k.clone().add(new mono.Vec3(0,h,0)),m.push(n);var o=Math.max(k.y,l.y);m.push(new mono.Vec3(k.x,o+b,k.z)),m.push(new mono.Vec3(k.x,o+b,l.z)),m.push(new mono.Vec3(l.x,o+b,l.z));var p=j.clone().add(new mono.Vec3(0,h,0));return m.push(l.clone().add(new mono.Vec3(0,h,0))),m.push(p),m.push(j),m},handleMouseMoveElement:function(a,b,c,d,e){var f=this.sceneManager.getLinkData(a);if(f){if(!a.org_radius&&a.setRadius){var g=a.getRadius()||1;a.org_radius=a.getRadius(),a.setRadius(g+1)}this._flagLink=a}},handleMouseMoveBackground:function(a,b){this._flagLink&&this._flagLink.org_radius&&(this._flagLink.setRadius(this._flagLink.org_radius),delete this._flagLink.org_radius,this._flagLink=null)},doFlow:function(a,b){if(a){var c=null,e=a;if(a instanceof mono.Element){c=a;var f=this.sceneManager.getLinkData(c);e=f.getId()}else a instanceof d.Link&&(e=a.getId()),c=this.sceneManager.linkMap[e];if(c){var g=!0;if(0==b&&(g=!1),!c.styleMap["m.texture.image"])return;c.setStyle("m.texture.flipX",g);var h=this.animates[e];h||(h=new mono.Animate({from:0,to:1,type:"number",dur:500,repeat:Number.POSITIVE_INFINITY,reverse:!1,onUpdate:function(a){c.s({"m.texture.offset":new mono.Vec2(a,0)})}}),this.animates[e]=h),h.play()}}},clearFlow:function(a){if(a){var b=a;a instanceof d.Link&&(b=a.getId());var c=this.animates[b];c&&(c.stop(),delete this.animates[b])}},clearAllFlow:function(){if(this.animates)for(var a in this.animates){var b=this.animates[a];b&&(b.stop(),delete this.animates[a])}}}),d.GCSManager=P,d.TooltipRule=function(a){a=a||{},this._id=a.id||this.randomId(),this._categoryId=a.categoryId||"",this._dataTypeId=a.dataTypeId||"",this._sceneId=a.sceneId||"",this._propertiesDesc=a.propertiesDesc||"",this._extInfo=a.extInfo||{},this._mul=a.mul||!1},mono.extend(d.TooltipRule,d.Base,{___accessor:["categoryId","mul","dataTypeId","sceneId","propertiesDesc","extInfo"],getId:function(){return this._id},randomId:function(){return mono.id("tooltipRule")}}),d.TooltipManager=function(a){this.sceneManager=a,this.dataManager=a.dataManager,this._tooltipRules=[],this._tooltipRuleMap={},this._lastData=null,this._tooltipDivCreator=new d.TooltipDivCreator,this.tooltipContentFunction=null,this.toolTipMap=[],this.network3d=this.sceneManager.network3d,this.box3D=this.network3d.getDataBox(),this.textNodeMap={},this.init()},mono.extend(d.TooltipManager,d.EventHandler,{init:function(){var a=this;this.sceneManager.addSceneManagerChangeListener(function(b){"add"==b.kind&&b.data instanceof mono.Element&&a.createTextNodeForFloor(b.data)}),this.sceneManager.addSceneChangeListener(function(b){a.sceneChangeListener()})},_createTooltipDiv:function(a){var b=this._tooltipDivCreator.createTooltipDiv(a);return b.style.position="absolute",b.style.display="none",b},setTooltipDivCreator:function(a){null!=a&&this._tooltipDivCreator!==a&&(this._tooltipDivCreator=a,this.destoryTooltipDiv())},getTooltipDivCreator:function(){return this._tooltipDivCreator},destoryTooltipDiv:function(){this._tooltipDiv=null},getTooltipDiv:function(){if(null==this._tooltipDiv){this._tooltipDiv=this._createTooltipDiv();var a=this.sceneManager.network3d;this._tooltipDivCreator.addToNetwork(a,this._tooltipDiv)}return this._tooltipDiv},hideToolTipDiv:function(){var a=this.getTooltipDiv();a.style.display="none"},showTooltipDiv:function(a,b){var c=this.getTooltipDiv();c.style.display="",this._tooltipDivCreator.setTooltipData(a,c),this.computeTooltipDivPosition(b)},onRenderCallback:function(a){this.computeTooltipDivPosition()},generateTooltipPosition:function(a,b,c,d){if(!a)return new mono.Vec3(b,c,d);var e=this.sceneManager.getNodeData(a);if(!e)return new mono.Vec3(b,c,d);var f=this.dataManager.getDataTypeForData(e),g=this.dataManager.getCategoryForDataType(f),h=a.getPosition();if(g&&g.getId().indexOf("floor")>=0){if(!e.getPosition())return new mono.Vec3(b,c,d);var i=e.getPosition().y,j=this.dataManager.getDataById(e.getParentId());if(j){var k=j.getChildren();if(k&&k.size()>0){var l=0,m=0;if(k.forEach(function(a){var b=a.getPosition().y;l>b&&(l=b),b>m&&(m=b)}),l!=m){var n,o,p,q=(a.getBoundingBox().max.z-a.getBoundingBox().min.y)/2;p=h.z+q;var r=a.getBoundingBox().max.x-a.getBoundingBox().min.x,s=r/(k.size()+1);return n=parseInt((i-l)/((m-l)/k.size()))*s+s/2-r/2,o=h.y-250,new mono.Vec3(n,o,p)}}}}return new mono.Vec3(b,c,d)},computeTooltipDivPosition:function(a,b){var c=b||this.getTooltipDiv();if(a=a||this._lastData,c&&a){var d=this.sceneManager,f=d.getNodeForDataOrId(a),g=f.getBoundingBox(),h=f.getWorldPosition(),i=h.x+g.center().x,j=h.y+g.max.y,k=h.z+g.center().z,l=this.generateTooltipPosition(f,i,j,k);l&&(i=l.x||i,j=l.y||j,k=l.z||k);var m=this.sceneManager.network3d.getViewPosition(new mono.Vec3(i,j,k)),n=m.x,o=m.y,p=e.getComputedStyle(c);n-=parseInt(p.width)/2,o=o-parseInt(p.height)-10,c.style.left=n+"px",c.style.top=o+"px"}},getTooltipContent:function(a,b){if(this.tooltipContentFunction)return this.tooltipContentFunction(a);if(a&&!(a instanceof mono.Billboard&&a.getStyle("m.opacity")&&a.getStyle("m.opacity")<.3)){var c=this.sceneManager,d=this.dataManager,e=c.getNodeData(a);if(e){var f=d.getCategoryForData(e),g=d.getDataTypeForData(e);if(null!=g){for(var h,i,j,k,l=f?f.getId():"",m=g.getId(),n=0;n<this._tooltipRules.length;n++)k=this._tooltipRules[n],(!b||k.getMul())&&(b||!k.getMul())&&(k.getDataTypeId()!==m||h||(h=k),l&&k.getCategoryId()===l&&!i&&(i=k),k.getDataTypeId()||k.getCategoryId()||(j=k));return h?this._getTooltipContent(a,e,h):i?this._getTooltipContent(a,e,i):j?this._getTooltipContent(a,e,j):void 0}}}},_getDataFieldValue:function(a,b,c){return b.getValue(c)},_getTooltipContent:function(a,b,c){var d={},f=c.getPropertiesDesc(),g=f.split("@@");if(g.length)for(var h=0;h<g.length;h++){var i=g[h],j=i.split(":");if(2===j.length){var k=j[0],l=j[1],m=this._getDataFieldValue(a,b,l);d[k]=m||""}}var n=c.getExtInfo();if(n=e.translateJson(n))for(var o in n)d[o]=n[o];return d.tooltipRule=c,d},addTooltipRule:function(a){var b=a.getId();this._tooltipRuleMap[b]||(this._tooltipRules.push(a),this._tooltipRuleMap[b]=a)},removeTooltipRule:function(a){var b=a.getId();if(this_tooltipRuleMap[b]){var c=this._tooltipRules.indexOf(a);c&&this._tooltipRules.splice(c,1),delete this._tooltipRuleMap[b]}},handleMouseMoveElement:function(a,b,c,d,e){if(!e._mousedown){var f=this.getTooltipContent(a);if(null==f)return this._lastData=null,void this.hideToolTipDiv();var g=this;this._lastData!=c&&(clearTimeout(this._tooltipTimer),this._tooltipTimer=setTimeout(function(){g._lastData=c,g.showTooltipDiv(f,c)},200))}},handleMouseMoveBackground:function(a,b){this.hideToolTipDiv(),this._lastData=null},createToolTipForNode:function(a){if(a){var b=null;if(b=a instanceof d.Data?a:this.sceneManager.getNodeData(a)){var c=this.getTooltipContent(a,!0);if(c){var e="tooltip"+b.getId();this.toolTipMap.push({id:e,rule:c.tooltipRule});var f=this._createTooltipDiv(e);this._tooltipDivCreator.setTooltipData(c,f),this._tooltipDivCreator.addToNetwork(this.sceneManager.network3d,f),this.computeTooltipDivPosition(b,f)}}}},cameraChangeListener:function(){if(this.toolTipMap&&!(this.toolTipMap.length<1))for(var a=0;a<this.toolTipMap.length;a++){var b=this.toolTipMap[a];if(b){var c=b.id,d=b.rule;if(c.startsWith("tooltip")){var e=c.substring(7,c.length),f=this.dataManager.getDataById(e),g=this.sceneManager.getNodeByDataOrId(f);if(!f||!g)continue;var h=document.getElementById(c);if(!h)continue;var i=this.sceneManager.getCurrentScene();if(d.getSceneId()&&i&&d.getSceneId()!=i.getId()){h.style.display="none";continue}if(!g||!this.sceneManager.viewManager3d.isVisible(g)||!this.box3D.getDataById(g.getId())){h.style.display="none";continue}h.style.display="",this.computeTooltipDivPosition(f,h)}}}},getRuleByData:function(a,b){if(a){var c=(this.sceneManager,this.dataManager),e=null;if(e=a instanceof d.Data?a:a instanceof d.Link?a:c.getDataById(a)){var f=c.getCategoryForData(e),g=c.getDataTypeForData(e);if(null!=g){for(var h,i,j,k,l=f?f.getId():"",m=g.getId(),n=0;n<this._tooltipRules.length;n++)k=this._tooltipRules[n],(!b||k.getMul())&&(b||!k.getMul())&&(k.getDataTypeId()!==m||h||(h=k),l&&k.getCategoryId()===l&&!i&&(i=k),k.getDataTypeId()||k.getCategoryId()||(j=k));return h?h:i?i:j?j:null}}}},computeTextNodePosition:function(a,b){if(!a)return null;var c=this.sceneManager.getNodeData(a);this.sceneManager.setParentRelationShip(c),this.sceneManager.translatePosition(c);var b=b||0,e=a.getBoundingBox(),f=d.Util.getNodeCenterPosition(a),g=f.x,h=f.y,i=f.z;e&&(g=g+(e.max.x-e.min.x)/2-b,i=i+(e.max.z-e.min.z)/2+5);var j=e.max.y-e.min.y;h=j/2;var k=i+50,l=this.getElementsByPosition(g,h,k);if(l&&l.length>0){for(var m=null,n=0;n<l.length;n++){var o=l[n];o&&o.distance&&(!m||m>o.distance)&&(m=o.distance)}m&&(i=k-m)}return{x:g,y:h,z:i}},getElementsByPosition:function(a,b,c){var d=new mono.Vec3(a,b,c),e=new mono.Vec3(0,1,0),f=new mono.Vec3(a,b,-1),g=this.network3d.getCamera(),h=new mono.Picking(d,f.sub(d).normalize(),e,g.getNear(),g.getFar(),this.network3d),i=new mono.List;i.addAll(this.box3D.getNodes());var j=h.intersectObjects(i.toArray(),!0,!1);return j},getTextNodeOffset:function(a){return null},createTextNodeForFloor:function(a){if(a){var b=null;if(b=a instanceof d.Data?a:this.sceneManager.getNodeData(a)){var c=this.sceneManager.dataManager.getCategoryForData(b);if(c&&!(c.getId().toLowerCase().indexOf("floor")<0)){var e=this.getRuleByData(b,!0);if(e){var f=b.getId(),g=this.textNodeMap[f];if(!g&&f){var g=new mono.TextNode(f,null,100,"helvetiker","bold");g.setStyle("m.texture.image","../images/yellow.png"),g.setStyle("m.type","phong");var h=1;g.setScale(h,h,.1*h),g.setSelectable(!1),g.setParent(a);var i=a.getBoundingBox(),j=a.getPositionX(),k=a.getPositionZ(),l=a.getPositionY(),m=0,n=0,o=g.getBoundingBox();o&&(m=o.max.x-o.min.x,n=o.max.y-o.min.y),i&&(j=i.max.x-m,k=i.max.z+5);var p=i.max.y-i.min.y;l=p/2;var q=this.getTextNodeOffset(b);q&&(q.x&&(j+=q.x),q.y&&(l+=q.y));var r=k+50,s=this.getElementsByPosition(j,l,r);if(s&&s.length>0){for(var t=null,u=0;u<s.length;u++){var v=s[u];v&&v.distance&&(!t||t>v.distance)&&(t=v.distance)}t&&(k=r-t)}q&&q.z&&q.z&&(k+=q.z),g.setPosition(j,l,k),this.textNodeMap[f]=g,g.setVisible(!1),this.box3D.add(g),g.rule=e}}}}}},sceneChangeListener:function(){if(this.textNodeMap)for(var a in this.textNodeMap){var b=this.textNodeMap[a],c=b.rule,d=this.sceneManager.getCurrentScene();if(c.getSceneId()&&d&&c.getSceneId()!=d.getId())b.setVisible(!1);else{var e=this.sceneManager.getNodeByDataOrId(a);e&&this.sceneManager.viewManager3d.isVisible(e)&&this.box3D.getDataById(e.getId())?(this.box3D.getDataById(b.getId())||this.box3D.add(b),b.setVisible(!0)):b.setVisible(!1)}}this._tooltipTimer&&clearTimeout(this._tooltipTimer),this.hideToolTipDiv()}}),d.TooltipDivCreator=function(a){},mono.extend(d.TooltipDivCreator,Object,{createTooltipDiv:function(a){var b=document.createElement("DIV");return b.className="tooltip-panel",a&&(b.id=a),b},addToNetwork:function(a,b){a.getRootView().appendChild(b)},setTooltipData:function(a,b){if(this._removeAllChildren(b),a){delete a.tooltipRule;var c=document.createElement("table"),d=document.createElement("tbody");b.appendChild(c),c.appendChild(d);for(var e in a){var f=this._createRow(e,a[e]);d.appendChild(f)}}},_createRow:function(a,b){var c=document.createElement("tr"),d=document.createElement("td");d.className="tooltip-key",d.innerHTML=a+":";var e=document.createElement("td");return e.className="tooltip-value",e.innerHTML=b,c.appendChild(d),c.appendChild(e),c},_removeAllChildren:function(a){for(;a.hasChildNodes();)a.removeChild(a.lastChild)}}),function(a){var b,c,d,e,f,g,h,i,j,k,l=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};i=function(){var b,c,d,e;return null!=a.WebGLRenderingContext?(e=["WEBKIT","MOZ","MS","O"],d=/^WEBKIT_(.*)|MOZ_(.*)|MS_(.*)|O_(.*)/,b=WebGLRenderingContext.prototype.getExtension,WebGLRenderingContext.prototype.getExtension=function(a){var c,f,g,h,i;if(f=a.match(d),null!==f&&(a=f[1]),c=b.call(this,a),null===c){for(h=0,i=e.length;i>h;h++)if(g=e[h],c=b.call(this,g+"_"+a),null!==c)return c;return null}return c},c=WebGLRenderingContext.prototype.getSupportedExtensions,WebGLRenderingContext.prototype.getSupportedExtensions=function(){var a,b,e,f,g,h;for(f=c.call(this),e=[],g=0,h=f.length;h>g;g++)a=f[g],b=a.match(d),null!==b&&(a=b[1]),l.call(e,a)<0&&e.push(a);return e}):void 0},j=function(){var b,c,d,e,f,g,h,i,j,k,m,n,o,p;if(f=function(){var a,b,c;return a=document.createElement("canvas"),a.width=2,a.height=2,b=a.getContext("2d"),c=b.getImageData(0,0,2,2),c.data.set(new Uint8ClampedArray([0,0,0,0,255,255,255,255,0,0,0,0,255,255,255,255])),b.putImageData(c,0,0),a},f(),c=function(a,b){var c,d,e,g,h,i,j,k,l,m,n,o,p,q;if(i=a.createProgram(),p=a.createShader(a.VERTEX_SHADER),a.attachShader(i,p),a.shaderSource(p,"attribute vec2 position;\nvoid main(){\n    gl_Position = vec4(position, 0.0, 1.0);\n}"),a.compileShader(p),!a.getShaderParameter(p,a.COMPILE_STATUS))throw a.getShaderInfoLog(p);if(e=a.createShader(a.FRAGMENT_SHADER),a.attachShader(i,e),a.shaderSource(e,"uniform sampler2D source;\nvoid main(){\n    gl_FragColor = texture2D(source, vec2(1.0, 1.0));\n}"),a.compileShader(e),!a.getShaderParameter(e,a.COMPILE_STATUS))throw a.getShaderInfoLog(e);if(a.linkProgram(i),!a.getProgramParameter(i,a.LINK_STATUS))throw a.getProgramInfoLog(i);return a.useProgram(i),d=function(){return a.deleteShader(e),a.deleteShader(p),a.deleteProgram(i),a.deleteBuffer(c),a.deleteTexture(l),a.deleteTexture(o),a.deleteFramebuffer(g),a.bindBuffer(a.ARRAY_BUFFER,null),a.useProgram(null),a.bindTexture(a.TEXTURE_2D,null),a.bindFramebuffer(a.FRAMEBUFFER,null)},o=a.createTexture(),a.bindTexture(a.TEXTURE_2D,o),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,2,2,0,a.RGBA,a.UNSIGNED_BYTE,null),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),g=a.createFramebuffer(),a.bindFramebuffer(a.FRAMEBUFFER,g),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,o,0),m=f(),l=a.createTexture(),a.bindTexture(a.TEXTURE_2D,l),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,b,m),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),q=new Float32Array([1,1,-1,1,-1,-1,1,1,-1,-1,1,-1]),c=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,c),a.bufferData(a.ARRAY_BUFFER,q,a.STATIC_DRAW),h=a.getAttribLocation(i,"position"),n=a.getUniformLocation(i,"source"),a.enableVertexAttribArray(h),a.vertexAttribPointer(h,2,a.FLOAT,!1,0,0),a.uniform1i(n,0),a.drawArrays(a.TRIANGLES,0,6),j=new Uint8Array(16),a.readPixels(0,0,2,2,a.RGBA,a.UNSIGNED_BYTE,j),k=Math.abs(j[0]-127)<10,d(),k},e=function(a,b){var c;return c=a.createTexture(),a.bindTexture(a.TEXTURE_2D,c),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,2,2,0,a.RGBA,b,null),0===a.getError()?(a.deleteTexture(c),!0):(a.deleteTexture(c),!1)},b=function(a,b){var c,d,e;return e=a.createTexture(),a.bindTexture(a.TEXTURE_2D,e),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,2,2,0,a.RGBA,b,null),d=a.createFramebuffer(),a.bindFramebuffer(a.FRAMEBUFFER,d),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,e,0),c=a.checkFramebufferStatus(a.FRAMEBUFFER),a.deleteTexture(e),a.deleteFramebuffer(d),a.bindTexture(a.TEXTURE_2D,null),a.bindFramebuffer(a.FRAMEBUFFER,null),c===a.FRAMEBUFFER_COMPLETE?!0:!1},j=[],k={},m=[],d=function(){var a,d,f,g,h,i,l;a=document.createElement("canvas"),f=null;try{f=a.getContext("experimental-webgl"),null===f&&(f=a.getContext("webgl"))}catch(n){}return null!=f&&(i=f.getExtension("OES_texture_float"),null===i?e(f,f.FLOAT)?(l=!0,j.push("OES_texture_float"),k.OES_texture_float={shim:!0}):(l=!1,m.push("OES_texture_float")):e(f,f.FLOAT)?(l=!0,j.push("OES_texture_float")):(l=!1,m.push("OES_texture_float")),l&&(d=f.getExtension("WEBGL_color_buffer_float"),null===d?b(f,f.FLOAT)?(j.push("WEBGL_color_buffer_float"),k.WEBGL_color_buffer_float={shim:!0,RGBA32F_EXT:34836,RGB32F_EXT:34837,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT:33297,UNSIGNED_NORMALIZED_EXT:35863}):m.push("WEBGL_color_buffer_float"):b(f,f.FLOAT)?j.push("WEBGL_color_buffer_float"):m.push("WEBGL_color_buffer_float"),d=f.getExtension("OES_texture_float_linear"),null===d?c(f,f.FLOAT)?(j.push("OES_texture_float_linear"),k.OES_texture_float_linear={shim:!0}):m.push("OES_texture_float_linear"):c(f,f.FLOAT)?j.push("OES_texture_float_linear"):m.push("OES_texture_float_linear")),g=f.getExtension("OES_texture_half_float"),null===g?e(f,36193)?(h=!0,j.push("OES_texture_half_float"),g=k.OES_texture_half_float={HALF_FLOAT_OES:36193,shim:!0}):(h=!1,m.push("OES_texture_half_float")):e(f,g.HALF_FLOAT_OES)?(h=!0,j.push("OES_texture_half_float")):(h=!1,m.push("OES_texture_half_float")),h)?(d=f.getExtension("EXT_color_buffer_half_float"),null===d?b(f,g.HALF_FLOAT_OES)?(j.push("EXT_color_buffer_half_float"),k.EXT_color_buffer_half_float={shim:!0,RGBA16F_EXT:34842,RGB16F_EXT:34843,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT:33297,UNSIGNED_NORMALIZED_EXT:35863}):m.push("EXT_color_buffer_half_float"):b(f,g.HALF_FLOAT_OES)?j.push("EXT_color_buffer_half_float"):m.push("EXT_color_buffer_half_float"),d=f.getExtension("OES_texture_half_float_linear"),null===d?c(f,g.HALF_FLOAT_OES)?(j.push("OES_texture_half_float_linear"),k.OES_texture_half_float_linear={shim:!0}):m.push("OES_texture_half_float_linear"):c(f,g.HALF_FLOAT_OES)?j.push("OES_texture_half_float_linear"):m.push("OES_texture_half_float_linear")):void 0},null!=a.WebGLRenderingContext){for(d(),n={},o=0,p=m.length;p>o;o++)i=m[o],n[i]=!0;return g=WebGLRenderingContext.prototype.getExtension,WebGLRenderingContext.prototype.getExtension=function(a){var b;return b=k[a],void 0===b?n[a]?null:g.call(this,a):b},h=WebGLRenderingContext.prototype.getSupportedExtensions,WebGLRenderingContext.prototype.getSupportedExtensions=function(){var a,b,c,d,e,f,g;for(c=h.call(this),b=[],d=0,f=c.length;f>d;d++)a=c[d],void 0===n[a]&&b.push(a);for(e=0,g=j.length;g>e;e++)a=j[e],l.call(b,a)<0&&b.push(a);return b},WebGLRenderingContext.prototype.getFloatExtension=function(a){var b,c,d,e,f,g,h,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B;for(null==a.prefer&&(a.prefer=["half"]),null==a.require&&(a.require=[]),null==a["throws"]&&(a["throws"]=!0),p=this.getExtension("OES_texture_float"),g=this.getExtension("OES_texture_half_float"),n=this.getExtension("WEBGL_color_buffer_float"),e=this.getExtension("EXT_color_buffer_half_float"),o=this.getExtension("OES_texture_float_linear"),f=this.getExtension("OES_texture_half_float_linear"),m={texture:null!==p,filterable:null!==o,renderable:null!==n,score:0,precision:"single",half:!1,single:!0,type:this.FLOAT},d={texture:null!==g,filterable:null!==f,renderable:null!==e,score:0,precision:"half",half:!0,single:!1,type:null!=(z=null!=g?g.HALF_FLOAT_OES:void 0)?z:null},c=[],m.texture&&c.push(m),d.texture&&c.push(d),l=[],r=0,u=c.length;u>r;r++){for(b=c[r],q=!0,A=a.require,s=0,v=A.length;v>s;s++)i=A[s],b[i]===!1&&(q=!1);q&&l.push(b)}for(t=0,w=l.length;w>t;t++)for(b=l[t],B=a.prefer,h=y=0,x=B.length;x>y;h=++y)k=B[h],j=Math.pow(2,a.prefer.length-h-1),b[k]&&(b.score+=j);if(l.sort(function(a,b){return a.score===b.score?0:a.score<b.score?1:a.score>b.score?-1:void 0}),0===l.length){if(a["throws"])throw"No floating point texture support that is "+a.require.join(", ");return null}return l=l[0],{filterable:l.filterable,renderable:l.renderable,type:l.type,precision:l.precision}}}},i(),j(),e=function(){function a(a,b){var c,d;this.gl=a,d=b.vertex,c=b.fragment,this.program=this.gl.createProgram(),this.vs=this.gl.createShader(this.gl.VERTEX_SHADER),this.fs=this.gl.createShader(this.gl.FRAGMENT_SHADER),this.gl.attachShader(this.program,this.vs),this.gl.attachShader(this.program,this.fs),this.compileShader(this.vs,d),this.compileShader(this.fs,c),this.link(),this.value_cache={},this.uniform_cache={},this.attribCache={}}return a.prototype.attribLocation=function(a){var b;return b=this.attribCache[a],void 0===b&&(b=this.attribCache[a]=this.gl.getAttribLocation(this.program,a)),b},a.prototype.compileShader=function(a,b){if(this.gl.shaderSource(a,b),this.gl.compileShader(a),!this.gl.getShaderParameter(a,this.gl.COMPILE_STATUS))throw"Shader Compile Error: "+this.gl.getShaderInfoLog(a)},a.prototype.link=function(){if(this.gl.linkProgram(this.program),!this.gl.getProgramParameter(this.program,this.gl.LINK_STATUS))throw"Shader Link Error: "+this.gl.getProgramInfoLog(this.program)},a.prototype.use=function(){return this.gl.useProgram(this.program),this},a.prototype.uniformLoc=function(a){var b;return b=this.uniform_cache[a],void 0===b&&(b=this.uniform_cache[a]=this.gl.getUniformLocation(this.program,a)),b},a.prototype["int"]=function(a,b){var c,d;return c=this.value_cache[a],c!==b&&(this.value_cache[a]=b,d=this.uniformLoc(a),d&&this.gl.uniform1i(d,b)),this},a.prototype.vec2=function(a,b,c){var d;return d=this.uniformLoc(a),d&&this.gl.uniform2f(d,b,c),this},a.prototype["float"]=function(a,b){var c,d;return c=this.value_cache[a],c!==b&&(this.value_cache[a]=b,d=this.uniformLoc(a),d&&this.gl.uniform1f(d,b)),this},a}(),b=function(){function a(a){this.gl=a,this.buffer=this.gl.createFramebuffer()}return a.prototype.destroy=function(){return this.gl.deleteFRamebuffer(this.buffer)},a.prototype.bind=function(){return this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.buffer),this},a.prototype.unbind=function(){return this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this},a.prototype.check=function(){var a;switch(a=this.gl.checkFramebufferStatus(this.gl.FRAMEBUFFER)){case this.gl.FRAMEBUFFER_UNSUPPORTED:throw"Framebuffer is unsupported";case this.gl.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:throw"Framebuffer incomplete attachment";case this.gl.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:throw"Framebuffer incomplete dimensions";case this.gl.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:throw"Framebuffer incomplete missing attachment"}return this},a.prototype.color=function(a){return this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,a.target,a.handle,0),this.check(),this},a.prototype.depth=function(a){return this.gl.framebufferRenderbuffer(this.gl.FRAMEBUFFER,this.gl.DEPTH_ATTACHMENT,this.gl.RENDERBUFFER,a.id),this.check(),this},a.prototype.destroy=function(){return this.gl.deleteFramebuffer(this.buffer)},a}(),f=function(){function a(a,b){var c,d;switch(this.gl=a,null==b&&(b={}),this.channels=this.gl[(null!=(c=b.channels)?c:"rgba").toUpperCase()],"number"==typeof b.type?this.type=b.type:this.type=this.gl[(null!=(d=b.type)?d:"unsigned_byte").toUpperCase()],this.channels){case this.gl.RGBA:this.chancount=4;break;case this.gl.RGB:this.chancount=3;break;case this.gl.LUMINANCE_ALPHA:this.chancount=2;break;default:this.chancount=1}this.target=this.gl.TEXTURE_2D,this.handle=this.gl.createTexture()}return a.prototype.destroy=function(){return this.gl.deleteTexture(this.handle)},a.prototype.bind=function(a){if(null==a&&(a=0),a>15)throw"Texture unit too large: "+a;return this.gl.activeTexture(this.gl.TEXTURE0+a),this.gl.bindTexture(this.target,this.handle),this},a.prototype.setSize=function(a,b){return this.width=a,this.height=b,this.gl.texImage2D(this.target,0,this.channels,this.width,this.height,0,this.channels,this.type,null),this},a.prototype.upload=function(a){return this.width=a.width,this.height=a.height,this.gl.texImage2D(this.target,0,this.channels,this.channels,this.type,a),this},a.prototype.linear=function(){return this.gl.texParameteri(this.target,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.target,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this},a.prototype.nearest=function(){return this.gl.texParameteri(this.target,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.target,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this},a.prototype.clampToEdge=function(){return this.gl.texParameteri(this.target,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.target,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this},a.prototype.repeat=function(){return this.gl.texParameteri(this.target,this.gl.TEXTURE_WRAP_S,this.gl.REPEAT),this.gl.texParameteri(this.target,this.gl.TEXTURE_WRAP_T,this.gl.REPEAT),this},a}(),d=function(){function a(a,c,d){var e;this.gl=a,this.width=c,this.height=d,e=this.gl.getFloatExtension({require:["renderable"]}),this.texture=new f(this.gl,{type:e.type}).bind(0).setSize(this.width,this.height).nearest().clampToEdge(),this.fbo=new b(this.gl).bind().color(this.texture).unbind()}return a.prototype.use=function(){return this.fbo.bind()},a.prototype.bind=function(a){return this.texture.bind(a)},a.prototype.end=function(){return this.fbo.unbind()},a.prototype.resize=function(a,b){return this.width=a,this.height=b,this.texture.bind(0).setSize(this.width,this.height)},a}(),k="attribute vec4 position;\nvarying vec2 texcoord;\nvoid main(){\n    texcoord = position.xy*0.5+0.5;\n    gl_Position = position;\n}",h="#ifdef GL_FRAGMENT_PRECISION_HIGH\n      precision highp int;\n    precision highp float;\n#else\n    precision mediump int;\n    precision mediump float;\n#endif\nuniform sampler2D source;\nvarying vec2 texcoord;",c=function(){function a(a,b,c,f){var g,i,j;for(this.heatmap=a,this.gl=b,this.width=c,this.height=f,this.shader=new e(this.gl,{vertex:"attribute vec4 position, intensity;\nvarying vec2 off, dim;\nvarying float vIntensity;\nuniform vec2 viewport;\n\nvoid main(){\n    dim = abs(position.zw);\n    off = position.zw;\n    vec2 pos = position.xy + position.zw;\n    vIntensity = intensity.x;\n    gl_Position = vec4((pos/viewport)*2.0-1.0, 0.0, 1.0);\n}",fragment:"#ifdef GL_FRAGMENT_PRECISION_HIGH\n    precision highp int;\n    precision highp float;\n#else\n    precision mediump int;\n    precision mediump float;\n#endif\n varying vec2 off, dim;\n varying float vIntensity;\nvoid main(){\n    float falloff = (1.0 - smoothstep(0.0, 1.0, length(off/dim)));\n    float intensity = falloff*vIntensity;\n     gl_FragColor = vec4(intensity,0.0,0,1.0);\n }"}),this.clampShader=new e(this.gl,{vertex:k,fragment:h+"uniform float low, high;\nvoid main(){\n    gl_FragColor = vec4(clamp(texture2D(source, texcoord).rgb, low, high), 1.0);\n}"}),this.multiplyShader=new e(this.gl,{vertex:k,fragment:h+"uniform float value;\nvoid main(){\n    gl_FragColor = vec4(texture2D(source, texcoord).rgb*value, 1.0);\n}"}),this.blurShader=new e(this.gl,{vertex:k,fragment:h+"uniform vec2 viewport;\nvoid main(){\n    vec4 result = vec4(0.0);\n    for(int x=-1; x<=1; x++){\n        for(int y=-1; y<=1; y++){\n            vec2 off = vec2(x,y)/viewport;\n            //float factor = 1.0 - smoothstep(0.0, 1.5, length(off));\n            float factor = 1.0;\n            result += vec4(texture2D(source, texcoord+off).rgb*factor, factor);\n        }\n    }\n    gl_FragColor = vec4(result.rgb/result.w, 1.0);\n}"}),this.nodeBack=new d(this.gl,this.width,this.height),this.nodeFront=new d(this.gl,this.width,this.height),this.vertexBuffer=this.gl.createBuffer(),this.vertexSize=8,this.maxPointCount=10240,this.vertexBufferData=new Float32Array(this.maxPointCount*this.vertexSize*6),this.vertexBufferViews=[],g=i=0,j=this.maxPointCount;j>=0?j>i:i>j;g=j>=0?++i:--i)this.vertexBufferViews.push(new Float32Array(this.vertexBufferData.buffer,0,g*this.vertexSize*6));this.bufferIndex=0,this.pointCount=0}return a.prototype.resize=function(a,b){return this.width=a,this.height=b,this.nodeBack.resize(this.width,this.height),this.nodeFront.resize(this.width,this.height)},a.prototype.update=function(){var a,b;return this.pointCount>0?(this.gl.enable(this.gl.BLEND),this.nodeFront.use(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.vertexBufferViews[this.pointCount],this.gl.STREAM_DRAW),b=this.shader.attribLocation("position"),a=this.shader.attribLocation("intensity"),this.gl.enableVertexAttribArray(1),this.gl.vertexAttribPointer(b,4,this.gl.FLOAT,!1,32,0),this.gl.vertexAttribPointer(a,4,this.gl.FLOAT,!1,32,16),this.shader.use().vec2("viewport",this.width,this.height),this.gl.drawArrays(this.gl.TRIANGLES,0,6*this.pointCount),this.gl.disableVertexAttribArray(1),this.pointCount=0,this.bufferIndex=0,this.nodeFront.end(),this.gl.disable(this.gl.BLEND)):void 0},a.prototype.clear=function(){return this.nodeFront.use(),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.nodeFront.end()},a.prototype.clamp=function(a,b){return this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.heatmap.quad),this.gl.vertexAttribPointer(0,4,this.gl.FLOAT,!1,0,0),this.nodeFront.bind(0),this.nodeBack.use(),this.clampShader.use()["int"]("source",0)["float"]("low",a)["float"]("high",b),this.gl.drawArrays(this.gl.TRIANGLES,0,6),this.nodeBack.end(),this.swap()},a.prototype.multiply=function(a){return this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.heatmap.quad),this.gl.vertexAttribPointer(0,4,this.gl.FLOAT,!1,0,0),this.nodeFront.bind(0),this.nodeBack.use(),this.multiplyShader.use()["int"]("source",0)["float"]("value",a),this.gl.drawArrays(this.gl.TRIANGLES,0,6),this.nodeBack.end(),this.swap()},a.prototype.blur=function(){return this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.heatmap.quad),this.gl.vertexAttribPointer(0,4,this.gl.FLOAT,!1,0,0),this.nodeFront.bind(0),this.nodeBack.use(),this.blurShader.use()["int"]("source",0).vec2("viewport",this.width,this.height),this.gl.drawArrays(this.gl.TRIANGLES,0,6),this.nodeBack.end(),this.swap()},a.prototype.swap=function(){var a;return a=this.nodeFront,this.nodeFront=this.nodeBack,this.nodeBack=a},a.prototype.addVertex=function(a,b,c,d,e){return this.vertexBufferData[this.bufferIndex++]=a,this.vertexBufferData[this.bufferIndex++]=b,this.vertexBufferData[this.bufferIndex++]=c,this.vertexBufferData[this.bufferIndex++]=d,this.vertexBufferData[this.bufferIndex++]=e,this.vertexBufferData[this.bufferIndex++]=e,this.vertexBufferData[this.bufferIndex++]=e,this.vertexBufferData[this.bufferIndex++]=e},a.prototype.addPoint=function(a,b,c,d){var e,f;return null==c&&(c=50),null==d&&(d=.2),this.pointCount>=this.maxPointCount-1&&this.update(),b=this.height-b,e=c/2,f=c/2,this.addVertex(a,b,-e,-f,d),this.addVertex(a,b,+e,-f,d),this.addVertex(a,b,-e,+f,d),this.addVertex(a,b,-e,+f,d),this.addVertex(a,b,+e,-f,d),this.addVertex(a,b,+e,+f,d),this.pointCount+=1},a}(),g=function(){function b(b){var d,g,i,j,l,m,n,o,p,q,r,s,t,u;s=null!=b?b:{},this.canvas=s.canvas,this.width=s.width,this.height=s.height,o=s.intensityToAlpha,m=s.gradientTexture,g=s.alphaRange,u=s.bgColor,this.canvas||(this.canvas=document.createElement("canvas"));try{if(this.gl=this.canvas.getContext("experimental-webgl",{depth:!1,antialias:!1,preserveDrawingBuffer:!0}),null===this.gl&&(this.gl=this.canvas.getContext("webgl",{depth:!1,antialias:!1,preserveDrawingBuffer:!0}),null===this.gl))throw"WebGL not supported"}catch(v){throw j=v,"WebGL not supported"}null!=a.WebGLDebugUtils&&(console.log("debugging mode"),
this.gl=WebGLDebugUtils.makeDebugContext(this.gl,function(a,b,c){throw WebGLDebugUtils.glEnumToString(a)+" was caused by call to: "+b})),this.gl.enableVertexAttribArray(0),this.gl.blendFunc(this.gl.ONE,this.gl.ONE),m?(r=this.gradientTexture=new f(this.gl,{channels:"rgba"}).bind(0).setSize(2,2).nearest().clampToEdge(),"string"==typeof m?(n=new Image,n.onload=function(){return r.bind().upload(n)},n.src=m):m.width>0&&m.height>0?r.upload(m):m.onload=function(){return r.upload(m)},l="uniform sampler2D gradientTexture;\nvec3 getColor(float intensity){\n    return texture2D(gradientTexture, vec2(intensity, 0.0)).rgb;\n}"):(r=null,l="vec3 getColor(float intensity){\n",l+=u?" vec3 blue = vec3("+parseInt(u.r||0)+", "+parseInt(u.g||0)+", "+parseInt(u.b||0)+");\n":"    vec3 blue = vec3(0.0, 0.0, 1.0);\n",l+="    vec3 cyan = vec3(0.0, 1.0, 1.0);\n    vec3 green = vec3(0.0, 1.0, 0.0);\n    vec3 yellow = vec3(1.0, 1.0, 0.0);\n    vec3 red = vec3(1.0, 0.0, 0.0);\n\n    vec3 color = (\n        fade(-0.25, 0.25, intensity)*blue +\n        fade(0.0, 0.5, intensity)*cyan +\n        fade(0.25, 0.75, intensity)*green +\n        fade(0.5, 1.0, intensity)*yellow +\n        smoothstep(0.75, 1.0, intensity)*red\n    );\n    return color;\n}"),null==o&&(o=!0),o?(t=null!=g?g:[0,1],i=t[0],d=t[1],p="vec4 alphaFun(vec3 color, float intensity){\n    float alpha = smoothstep("+i.toFixed(8)+", "+d.toFixed(8)+", intensity);\n    return vec4(color*alpha, alpha);\n }"):p="vec4 alphaFun(vec3 color, float intensity){\n    return vec4(color, 1.0);\n }",this.shader=new e(this.gl,{vertex:k,fragment:h+("float linstep(float low, float high, float value){\n    return clamp((value-low)/(high-low), 0.0, 1.0);\n}\n\n float fade(float low, float high, float value){\n    float mid = (low+high)*0.5;\n    float range = (high-low)*0.5;\n    float x = 1.0 - clamp(abs(mid-value)/range, 0.0, 1.0);\n    return smoothstep(0.0, 1.0, x);\n}\n\n"+l+"\n"+p+"\n\n void main(){\n     float intensity = smoothstep(0.0, 1.0, texture2D(source, texcoord).r);\n    vec3 color = getColor(intensity);\n     gl_FragColor = alphaFun(color, intensity);\n }")}),null==this.width&&(this.width=this.canvas.offsetWidth||2),null==this.height&&(this.height=this.canvas.offsetHeight||2),this.canvas.width=this.width,this.canvas.height=this.height,this.gl.viewport(0,0,this.width,this.height),this.quad=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.quad),q=new Float32Array([-1,-1,0,1,1,-1,0,1,-1,1,0,1,-1,1,0,1,1,-1,0,1,1,1,0,1]),this.gl.bufferData(this.gl.ARRAY_BUFFER,q,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.heights=new c(this,this.gl,this.width,this.height)}return b.prototype.adjustSize=function(){var a,b;return b=this.canvas.offsetWidth||2,a=this.canvas.offsetHeight||2,this.width!==b||this.height!==a?(this.gl.viewport(0,0,b,a),this.canvas.width=b,this.canvas.height=a,this.width=b,this.height=a,this.heights.resize(this.width,this.height)):void 0},b.prototype.display=function(){return this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.quad),this.gl.vertexAttribPointer(0,4,this.gl.FLOAT,!1,0,0),this.heights.nodeFront.bind(0),this.gradientTexture&&this.gradientTexture.bind(1),this.shader.use()["int"]("source",0)["int"]("gradientTexture",1),this.gl.drawArrays(this.gl.TRIANGLES,0,6)},b.prototype.update=function(){return this.heights.update()},b.prototype.clear=function(){return this.heights.clear()},b.prototype.clamp=function(a,b){return null==a&&(a=0),null==b&&(b=1),this.heights.clamp(a,b)},b.prototype.multiply=function(a){return null==a&&(a=.95),this.heights.multiply(a)},b.prototype.blur=function(){return this.heights.blur()},b.prototype.addPoint=function(a,b,c,d){return this.heights.addPoint(a,b,c,d)},b.prototype.addPoints=function(a){var b,c,d,e;for(e=[],c=0,d=a.length;d>c;c++)b=a[c],e.push(this.addPoint(b.x,b.y,b.size,b.intensity));return e},b}(),a.createWebGLHeatmap=function(a){return new g(a)}}(a);var Q=function(a){a||(a={}),this.radius=a.radius||10,this.maxValue=a.maxValue||1,this.minValue=a.minValue||0,this.width=a.width||100,this.height=a.height||100,this.intensityToAlpha=a.intensityToAlpha||!1,this.alphaRange=a.alphaRange||[0,1],this.gradientTexture=a.gradientTexture,this.canvasHeight=100,this.canvasWidth=parseInt(this.canvasHeight*this.width/this.height),this.positionX=a.positionX==b?this.width/2:parseFloat(a.positionX),this.positionY=a.positionY==b?this.height/2:parseFloat(a.positionY),this.heatmap=createWebGLHeatmap({canvas:null,width:this.canvasWidth,height:this.canvasHeight,intensityToAlpha:this.intensityToAlpha,alphaRange:this.alphaRange,gradientTexture:this.gradientTexture,bgColor:a.bgColor})};mono.extend(Q,Object,{createHeatMap:function(){},_getOriginal:function(){var a=this.positionX-this.width/2,b=this.height/2+this.positionY;return{x:a,y:b}},_getOriginalX:function(){return this.positionX-this.width/2},_getOriginalY:function(){return this.height/2+this.positionY},_transPositionX:function(a){return(parseFloat(a)-this._getOriginalX())*(this.canvasWidth/this.width)},_transPositionY:function(a){return(this._getOriginalY()-parseFloat(a))*(this.canvasHeight/this.height)},_transWidth:function(a){var b=parseFloat(a);return 0>=b?0:b*this.canvasWidth/this.width},_transHeight:function(a){var b=parseFloat(a);return 0>=b?0:b*this.canvasHeight/this.height},_generateNearPointsForArea:function(a,b,c,d,e){if(c&&d){var f=3*parseInt(c*d),g=a-c/2,h=b-d/2;if(!(0>g||0>h))for(var i=0,j=5;f>i;){var k=(2*Math.random()-1)*(j+c/2),l=(2*Math.random()-1)*(j+d/2),m=0,n=0;m=a+k,n=b+l,m>g&&g+c>m&&n>h&&h+d>n||(this.heatmap.addPoint(m,n,this.radius/2,e/30),i++)}}},addPointWithArea:function(a){if(a)if(a instanceof Array&&a.length>0)for(var b=0;b<a.length;b++)arguments.callee(a[b]);else a.type&&"circle"===a.type?this._createCircleCloud(a):this._createRectCloud(a)},_createCircleCloud:function(a){if(a){parseFloat(a.x)||0,parseFloat(a.y)||0,parseFloat(a.radius)||0}},_createRectCloud:function(a){if(a){var b=parseFloat(a.x)||0,c=parseFloat(a.y)||0,d=parseFloat(a.w)||0,e=parseFloat(a.l)||0,f=parseFloat(a.value)||0,g=a.axis;if(d=this._transWidth(d),e=this._transHeight(e),g&&"z"==g){var h=e;e=d,d=h}if(!d&&!e)return void this.addPoint(b,c,f);e||(e=d),d||(d=e);var i=this._transPositionX(b),j=this._transPositionY(c);this._generatePointsForArea(i,j,d,e,f)}},_generatePointsForArea:function(a,b,c,d,e){if(c&&d)for(var f=a-c/2,g=b-d/2,h=0,i=parseInt(c*d),j=1,k=1;i>h&&(j>=c&&(j=1,k++),!(j>=c&&k>=d));){var l=f+j,m=g+k;this.heatmap.addPoint(l,m,this.radius,e/20),j++,h++}},_generatePointsForArea_for_random:function(a,b,c,d,e){if(c&&d){c+=5,d+=5;for(var f=a-c/2,g=b-d/2,h=0,i=parseInt(c*d);i>h;){var j=f+Math.random()*c,k=g+Math.random()*d;this.heatmap.addPoint(j,k,this.radius,e/30),h++}}},_paintAtCoord:function(a,b,c){for(var d=0;d<2*this.radius;){var e=2*Math.random()-1,f=2*Math.random()-1,g=e*e+f*f;if(!(g>1)){var h=Math.sqrt(g);e/=h,f/=h,e*=1-g,f*=1-g,d+=1,this.heatmap.addPoint(a+e*this.radius*2,b+f*this.radius*2,this.radius,c/10)}}},addPoint:function(a,b,c,d){a=this._transPositionX(a),b=this._transPositionY(b);for(var e=0;20>e;){var f=2*Math.random()-1,g=2*Math.random()-1,h=f*f+g*g;if(!(h>1)){var i=Math.sqrt(h);f/=i,g/=i,f*=1-h,g*=1-h,e+=1,this.heatmap.addPoint(a+10*f,b+5*g,this.radius,c/20)}}},addPoint1:function(a,c,d,e){a=this._transPositionX(a),c=this._transPositionY(c),null!=d&&d!=b&&(d=(parseFloat(d)-this.minValue)/(this.maxValue-this.minValue),0>d&&(d=0)),e?this.heatmap.addPoint(a,c,e,d):this._paintAtCoord(a,c,d)},update:function(){this.heatmap.adjustSize(),this.heatmap.update(),this.heatmap.display()},refresh:function(b){var c=a.requestAnimationFrame||a.mozRequestAnimationFrame||a.webkitRequestAnimationFrame||a.msRequestAnimationFrame,d=this;c(function(){document.body.appendChild(d.heatmap.canvas),d.update(),b&&b()})},clear:function(){this.heatmap.clear()},getCanvas:function(){return this.heatmap.canvas},getImage:function(){return this.heatmap.canvas?this.heatmap.canvas.toDataURL():void console.log("getImage error!")},getTemperatureBoard:function(){var a=new mono.Plane(this.width,this.height);a.setStyle("m.texture.repeat",new mono.Vec2(1,1)).setStyle("m.type","basic").setStyle("m.side","both"),a.setRotation(90*Math.PI/180,0,0);var b=this;return this.refresh(function(){a.setStyle("m.texture.image",b.getImage()),document.body.removeChild(b.heatmap.canvas)}),a.setPositionX(this.positionX),a.setPositionZ(this.positionY),a}}),d.HeatMap3D=Q;var R=function(a){if(this.defaultOptions={gradientColors:["rgba(0, 102, 255, 0.9)","cyan","lime","yellow","red"],minAlpha:.05,valueScale:1,opacity:1,positionX:null,positionY:null,width:500,height:500,canvasHeight:500,blurSize:30,withBg:!1},this.option=a,a)for(var c in this.defaultOptions)a[c]!==b?this.option[c]=a[c]:this.option[c]=this.defaultOptions[c];else this.option=this.defaultOptions;this.datas=[],this.heatMapCanvas=document.createElement("canvas"),this.width=this.option.width,this.height=this.option.height,this.canvasHeight=this.option.canvasHeight,this.canvasWidth=this.option.canvasWidth=parseInt(this.canvasHeight*this.width/this.height),this.positionX=this.option.positionX==b?this.width/2:parseFloat(this.option.positionX),this.positionY=this.option.positionY==b?this.height/2:parseFloat(this.option.positionY),this.BRUSH_SIZE=40*this.canvasHeight/this.height,this.GRADIENT_LEVELS=256,this.withBg=this.option.withBg};mono.extend(R,Object,{addPoint:function(a,b,c){if(1===arguments.length&&arguments[0]instanceof Array){var d=arguments[0];a=d[0],b=d[1],c=d[2]}a=this._transPositionX(a),b=this._transPositionY(b),this.datas.push([a,b,c])},addPointWithArea:function(a){if(a)if(a instanceof Array&&a.length>0)for(var b=0;b<a.length;b++)arguments.callee(a[b]);else this._createRectCloud(a)},_createRectCloud:function(a){if(a){var b=parseFloat(a.x)||0,c=parseFloat(a.y)||0,d=parseFloat(a.w)||0,e=parseFloat(a.l)||0,f=parseFloat(a.value)||0,g=a.axis;if(d=this._transWidth(d),e=this._transHeight(e),g&&"z"==g){var h=e;e=d,d=h}if(!d&&!e)return void this.addPoint(b,c,f);e||(e=d),d||(d=e);var i=this._transPositionX(b),j=this._transPositionY(c);this._generatePointsForArea(i,j,d,e,f)}},_generatePointsForArea:function(a,b,c,d,e){if(c&&d){var f=this.BRUSH_SIZE,g=parseInt(c/f),h=parseInt(d/f);g%2===0&&(g+=1),h%2===0&&(h+=1);var i=0,j=0;g>5&&(i=1,g+=i),h>5&&(j=1,h+=j);for(var k=a,l=b,m=0;h>m;m++)for(var n=l+Math.pow(-1,m)*m/2*f,o=0;g>o;o++){var p=k+Math.pow(-1,o)*o/2*f;0===o&&(p=k);var q=1;(i>=g-o||j>h-m)&&(q=.3),this.datas.push([p,n,e*q*Math.random()])}}},getCanvas:function(){var a=this.datas,b=this.canvasWidth,c=this.canvasHeight,d=this._createBrush(),e=this._createGradient(),f=this.BRUSH_SIZE+this.option.blurSize,g=this.heatMapCanvas;g.width=b,g.height=c;for(var h=g.getContext("2d"),i=a.length,j=0;i>j;++j){var k=a[j],l=k[0],m=k[1],n=k[2],o=Math.min(1,Math.max(n*this.option.valueScale||this.option.minAlpha,this.option.minAlpha));h.globalAlpha=o,h.drawImage(d,l-f,m-f)}for(var p=h.getImageData(0,0,g.width,g.height),q=p.data,i=q.length/4;i--;){var r=4*i+3,o=q[r]/256,s=Math.floor(o*(this.GRADIENT_LEVELS-1));q[r-3]=e[4*s],q[r-2]=e[4*s+1],q[r-1]=e[4*s+2],this.withBg?q[r]=190:q[r]*=this.option.opacity}return h.putImageData(p,0,0),g},_createBrush:function(){if(!this._brushCanvas){this._brushCanvas=document.createElement("canvas");var a=this.BRUSH_SIZE+this.option.blurSize,b=2*a;this._brushCanvas.width=b,this._brushCanvas.height=b;var c=this._brushCanvas.getContext("2d");c.shadowOffsetX=b,c.shadowBlur=this.option.blurSize,c.shadowColor="black",c.beginPath(),c.arc(-a,a,this.BRUSH_SIZE,0,2*Math.PI,!0),c.closePath(),c.fill()}return this._brushCanvas},_createGradient:function(){if(!this._gradientPixels){var a=this.GRADIENT_LEVELS,b=document.createElement("canvas");b.width=1,b.height=a;for(var c=b.getContext("2d"),d=c.createLinearGradient(0,0,0,a),e=this.option.gradientColors.length,f=0;e>f;++f)"string"==typeof this.option.gradientColors[f]?d.addColorStop((f+1)/e,this.option.gradientColors[f]):d.addColorStop(this.option.gradientColors[f].offset,this.option.gradientColors[f].color);c.fillStyle=d,c.fillRect(0,0,1,a),this._gradientPixels=c.getImageData(0,0,1,a).data}return this._gradientPixels},_getOriginal:function(){var a=this.positionX-this.width/2,b=this.height/2+this.positionY;return{x:a,y:b}},_getOriginalX:function(){return this.positionX-this.width/2},_getOriginalY:function(){return this.height/2+this.positionY},_transPositionX:function(a){return(parseFloat(a)-this._getOriginalX())*(this.canvasWidth/this.width)},_transPositionY:function(a){return(this._getOriginalY()-parseFloat(a))*(this.canvasHeight/this.height)},_transWidth:function(a){var b=parseFloat(a);return 0>=b?0:b*this.canvasWidth/this.width},_transHeight:function(a){var b=parseFloat(a);return 0>=b?0:b*this.canvasHeight/this.height},clear:function(){this.datas=[]},refresh:function(b){var c=a.requestAnimationFrame||a.mozRequestAnimationFrame||a.webkitRequestAnimationFrame||a.msRequestAnimationFrame,d=this;c(function(){document.body.appendChild(d.getCanvas()),b&&b()})},getImage:function(){return this.heatMapCanvas?this.heatMapCanvas.toDataURL():void console.log("getImage error!")},getTemperatureBoard:function(){var a=new mono.Plane(this.width,this.height);a.setStyle("m.texture.repeat",new mono.Vec2(1,1)).setStyle("m.type","basic").setStyle("m.side","both"),this.withBg||(a.setStyle("m.transparent",!0),a.setStyle("m.type","phong")),a.setRotation(90*Math.PI/180,0,0);var b=this;return this.refresh(function(){a.setStyle("m.texture.image",b.getImage()),document.body.removeChild(b.heatMapCanvas)}),a.setPositionX(this.positionX),a.setPositionZ(this.positionY),a}}),d.HeatMap=R,d.PopMenuManager=function(a){this.sceneManager=a,this.getMenuItemsFunction=null,this._initPopMenu()},mono.extend(d.PopMenuManager,Object,{_initPopMenu:function(){function a(){var a,e;c.getDataBox();d.onMenuShowing=function(f){e=f;var g=c.getFirstElementByMouseEvent(f,!1,function(a){var b=a.getClient("mainVisible"),c=Utils.isNotNull(b);return!c}),h=[];if(g){a=g.element;var i=main.sceneManager.getNodeData(a);h=b.getMenuItems(a,i,e,g)}else h=b.getMenuItems(null,null,e,null);return h&&h.length>0?(d.setMenuItems(h),!0):!1}}var b=this,c=this.sceneManager.network3d,d=this._popupMenu=new twaver.controls.PopupMenu(c.getRootView());d.setBackground("#90C3D4"),d.setBorder("2px solid #90C3D4");var e=d.show;d.show=function(a){e.call(this,a);var b=this._view,c=b.style;c.left=parseInt(c.left)+1+"px",c.top=parseInt(c.top)+1+"px"},a()},getPopupMenu:function(){return this._popupMenu},getMenuItems:function(a,b,c,d){return this.getMenuItemsFunction?this.getMenuItemsFunction(a,b,c,d):[]}})}(window);